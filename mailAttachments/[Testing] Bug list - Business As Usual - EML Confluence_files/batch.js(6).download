WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(h,e){AJS.log("add-handler.property-panel: panel name \x3d "+e.name);"macro"==e.name&&e.registerButtonHandler("view-in-jira",function(a,c){if(AJS.Editor.JiraConnector.servers){a=AJS.Editor.JiraConnector.servers;c=AJS.$(c);var b=c.attr("data-macro-default-parameter");c=c.attr("data-macro-parameters")||"";var f=Confluence.MacroParameterSerializer.deserialize(c);(b=b||f.jqlQuery||f.key)||(b=c.indexOf("|"),b=0<=b?c.substring(0,b):c);c=b;b=f.server;var e=f.serverId;
f=c.match(/=|!=|~|>|<|!~| is | in /i);for(var g=null,d=0;d<a.length;d++){if(e&&a[d].id==e){g=a[d];break}if(b&&a[d].name==b||!b&&a[d].selected){g=a[d];break}}null!=g&&(a="undefined"!==typeof g.displayUrl?g.displayUrl:g.url,"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),b=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId,(f?window.open(a+"/secure/IssueNavigator.jspa?reset\x3dtrue\x26jqlQuery\x3d"+encodeURIComponent(c),b):window.open(a+"/browse/"+encodeURIComponent(c),b)).opener=
null)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){function a(a,d,c){if(c=AJS.$.grep(d,function(a){return"show-summary"==a.parameterName})[0])b(a)?"false"==AJS.SummaryHelper.getParam(a,"showSummary")?c.text="Show summary":c.text="Hide summary":c.className+=" hidden";else{AJS.logError("Jira Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var e in d)AJS.logError(d[e].text)}}function b(a){var b=
AJS.$(a).attr("src");if(!b)return!0;a=AJS.SummaryHelper.getParam(a,"count");return-1==b.indexOf("confluence.extra.jira/jira-table")&&"true"!=a?!0:!1}AJS.Confluence||AJS.Confluence.PropertyPanel||AJS.Confluence.PropertyPanel.Macro?(AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jira"),AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jiraissues")):AJS.logError("Jira Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined")});
AJS.bind("add-handler.property-panel",function(a,b){"macro"==b.name&&b.registerButtonHandler("show-summary",function(a,b){a=AJS.SummaryHelper.getParam(b,"showSummary");AJS.SummaryHelper.updateMacro("jira",b,"showSummary","false"==a?"true":"false")})});
AJS.SummaryHelper=function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,b){a=AJS.$(a);return AJS.SummaryHelper.getCurrentParams(a)[b]},updateMacro:function(a,b,e,d){b=AJS.$(b);AJS.Rte.getEditor().selection.select(b[0]);AJS.Rte.BookmarkManager.storeBookmark();var c=AJS.SummaryHelper.getCurrentParams(b);c[e]=d;a={contentId:Confluence.Editor.getContentId(),macro:{name:a,params:c,defaultParameterValue:b.attr("data-macro-default-parameter")}};
tinymce.confluence.MacroUtils.insertMacro(a)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="3" id="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field" data-name="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>' + soy.$$escapeHtml(opt_data.value) + '</textarea>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'select'})) : jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'value', value: 'None'})));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.radioField = function(opt_data, opt_ignored) {
  return '' + aui.form.radioField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.radioField.soyTemplateName = 'jiraIntegration.templates.fields.radioField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent}) + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.checkboxField = function(opt_data, opt_ignored) {
  return '' + aui.form.checkboxField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.checkboxField.soyTemplateName = 'jiraIntegration.templates.fields.checkboxField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" class="medium-field" name="' + soy.$$escapeHtml(opt_data.name) + '" data-name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>';
  var optionList112 = opt_data.options;
  var optionListLen112 = optionList112.length;
  for (var optionIndex112 = 0; optionIndex112 < optionListLen112; optionIndex112++) {
    var optionData112 = optionList112[optionIndex112];
    output += '<option value="' + soy.$$escapeHtml(optionData112.value) + '" ' + ((optionData112.selected) ? 'selected' : '') + ' data-icon-url="' + soy.$$escapeHtml(optionData112.iconUrl) + '">' + soy.$$escapeHtml(optionData112.text) + '</option>';
  }
  output += '</select>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (New label)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy150 = '' + soy.$$escapeHtml(opt_data.displayName) + ((! opt_data.isSystemOption) ? ' - (' + soy.$$escapeHtml(opt_data.name) + ')' : '');
  output += '<span data-value="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$filterNoAutoescape(userOption__soy150) + '">' + soy.$$filterNoAutoescape(userOption__soy150) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}


jiraIntegration.templates.fields.sprintSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '<span class="sprint-detail">' + ((opt_data.state == 'FUTURE') ? soy.$$escapeHtml(AJS.format('(Future sprint in {0})',opt_data.board)) : '') + ((opt_data.state == 'ACTIVE') ? soy.$$escapeHtml(AJS.format('(Active sprint in {0})',opt_data.board)) : '') + '</span></span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.sprintSelect.soyTemplateName = 'jiraIntegration.templates.fields.sprintSelect';
}


jiraIntegration.templates.fields.epicSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + ' (' + soy.$$escapeHtml(opt_data.key) + ')">' + soy.$$escapeHtml(opt_data.name) + ((opt_data.key) ? '<span class="epic-detail">' + soy.$$escapeHtml(opt_data.key) + '</span>' : '') + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.epicSelect.soyTemplateName = 'jiraIntegration.templates.fields.epicSelect';
}


jiraIntegration.templates.fields.errors = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.errorTexts) {
    var errorList195 = opt_data.errorTexts;
    var errorListLen195 = errorList195.length;
    for (var errorIndex195 = 0; errorIndex195 < errorListLen195; errorIndex195++) {
      var errorData195 = errorList195[errorIndex195];
      output += '<div class="error">' + soy.$$escapeHtml(errorData195) + '</div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.errors.soyTemplateName = 'jiraIntegration.templates.fields.errors';
}


jiraIntegration.templates.fields.fieldWithExtraAttributes = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type=' + soy.$$escapeHtml(opt_data.jiraType) + '>' + aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: '' + soy.$$escapeHtml(opt_data.labelText)});
  switch (opt_data.type) {
    case 'select':
      output += aui.form.select({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
      break;
    case 'value':
      output += aui.form.value({id: opt_data.name, content: '' + soy.$$escapeHtml(opt_data.value)});
      break;
    default:
      output += aui.form.input({id: opt_data.name, name: opt_data.name, type: 'text', value: opt_data.value, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
  }
  output += jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.fieldWithExtraAttributes.soyTemplateName = 'jiraIntegration.templates.fields.fieldWithExtraAttributes';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
window.jiraIntegration=window.jiraIntegration||{};window.jiraIntegration.fields=(function(V,aq){var t=window.jiraIntegration;var o="YYYY-MM-DD";var k={template:t.templates.fields.stringField,getContext:E,getValue:N};var ah={template:t.templates.fields.stringField,getContext:ai,getValue:N};var Y={template:t.templates.fields.stringField,getContext:u,getInternalValue:y,getValue:w,behavior:j};var I={template:t.templates.fields.stringField,getContext:u,getValue:Q,behavior:r};var D={template:t.templates.fields.arrayField,getContext:l,getValue:M,behavior:m};var B={template:t.templates.fields.textareaField,getContext:E,getValue:N};var S={template:t.templates.fields.numberField,getContext:aj,getValue:P};var e={template:t.templates.fields.arrayField,getContext:l,getValue:M};var an={template:t.templates.fields.allowedValuesField,getContext:i,getValue:aq.bind(c,null,"id"),behavior:ap};var ac={template:t.templates.fields.allowedValuesField,getContext:i,getValue:aq.bind(c,null,"id")};var ab={template:t.templates.fields.timeTrackingField,getContext:ao,getValue:h};var X={template:t.templates.fields.dateField,getContext:J,getValue:x,behavior:H};var n={template:t.templates.fields.select2WithIconField,getContext:U,getValue:aq.bind(c,null,"id"),behavior:b};var v={template:t.templates.fields.unrenderableTypeField,getContext:f,};var ar={template:t.templates.fields.stringField,getContext:E,getInternalValue:y,getValue:P,behavior:Z,};var z={template:t.templates.fields.stringField,getContext:E,getInternalValue:y,getValue:aa,behavior:ag,};var af={template:t.templates.fields.checkboxField,getContext:ae,getValue:L,};var W={template:t.templates.fields.radioField,getContext:ae,getValue:d,};var p={"com.pyxis.greenhopper.jira:gh-epic-label":k,string:k,summary:k,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":k,"com.atlassian.jira.plugin.system.customfieldtypes:url":ah,environment:B,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":B,description:B,"com.atlassian.jira.plugin.system.customfieldtypes:float":S,array:e,"com.atlassian.jira.plugin.system.customfieldtypes:labels":e,labels:D,priority:n,resolution:an,fixVersions:an,versions:an,components:an,security:an,"com.atlassian.jira.plugin.system.customfieldtypes:version":an,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":an,"com.atlassian.jira.plugin.system.customfieldtypes:project":an,assignee:Y,reporter:I,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":I,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":I,timetracking:ab,duedate:X,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":X,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":ac,"com.atlassian.jira.plugin.system.customfieldtypes:select":ac,"com.pyxis.greenhopper.jira:gh-sprint":ar,"com.pyxis.greenhopper.jira:gh-epic-link":z,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":af,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":W,};var F={ignoreFieldsWithDefaultValue:false};function A(az,aC,aD,aA){var at=aC.schema.system||"customfield_"+aC.schema.customId;var au=aC.schema.system||aC.schema.custom||aC.schema.customId;var av=p[au];var aB=Boolean(av&&(!av.canRender||av.canRender(aC)));var ay=Boolean(aC.operations&&aC.operations.length);var aE=aB&&ay?av:v;var ax=aC.required&&{"data-aui-validation-field":"",required:true};var aw={labelText:aC.name,name:at,isRequired:aC.required,value:aD[at],errorTexts:aA[at],jiraType:au,isRenderable:aB,hasOperations:ay,handler:aE,extraAttributes:ax};return aE.getContext(aw,aC,az,aD)}function f(av,at,au){if(!av.isRenderable){av.reasonContent=au?AJS.format("{0}Edit{1} this field in Jira.",'<a href="'+au.url+'">',"</a>"):AJS.escapeHtml("Edit this field in Jira after creation.")}else{if(!av.hasOperations){av.reasonContent=au?AJS.format("{0}Edit{1} this field in Jira.",'<a href="'+au.url+'">',"</a>"):AJS.escapeHtml("Edit this field in Jira after creation.")}else{av.reasonContent=null}}return av}function E(aw,at,au){var av=aw.name;aw.value=(V.isPlainObject(aw.value)?aw.value.name:aw.value)||(au&&au.fields[av])||(at&&at.defaultValue)||"";return aw}function N(at){return at.val()}function ai(av,at,au){var aw={"data-aui-validation-field":"",pattern:"([a-zA-Z][a-zA-Z0-9-+.]*://.+)|^$","data-aui-validation-pattern-msg":"Enter a valid URL scheme"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function J(av,at,au){var aw={"data-aui-validation-field":"",pattern:"^([0-9]{2,4}-(0?[1-9]|10|11|12)-([0-2]?[1-9]|10|20|30|31))$|^$","data-aui-validation-pattern-msg":"Enter a valid date"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function x(at){var au=at.val();if(au===""){return null}else{return au}}function aj(av,at,au){var aw={"data-aui-validation-field":"",pattern:"(([0-9]*[.])?[0-9]+)|^$","data-aui-validation-pattern-msg":"Enter a valid number"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function P(at){var au=at.val();if(C(au)){return Number(au)}return au||null}function H(at){var av=at.find("input");if(!!navigator.userAgent.match(/Trident/)&&AJS.version<"5.3.5"){var au="placeholder" in document.createElement("input");av.attr("placeholder",o);if(!au){av.on("focus",function(){if(av.val()===av.attr("placeholder")){av.val("")}}).on("blur",function(){if(av.val()===""){av.val(av.attr("placeholder"))}}).blur()}}else{WRM.require("wr!com.atlassian.auiplugin:aui-date-picker").done(function(){av.datePicker({overrideBrowserDefault:true})})}}function l(aw,at,au){var av=aw.name;aw.value=(aw.value&&aw.value.join(","))||(au&&au.fields[av]&&au.fields[av].join(","))||(at&&at.defaultValue&&at.defaultValue.join(" "));return aw}function M(at){return aq.map(at.val().split(","),V.trim)}function i(au,aA,az){var at=au.name;var aB=au.value;var av=az&&az.fields[at];var aw=aA&&aA.defaultValue;var ay;function ax(aC){if(Array.isArray(aC)){return aC.map(function(aD){return aD.name||aD.id})}else{return[aC.name||aC.id]}}if(aB){ay=ax(aB)}else{if(av){ay=ax(av)}else{if(aw){ay=ax(aw)}else{ay=[]}}}au.options=aq.map(aA.allowedValues,function(aC){return{value:aC.id,text:aC.name||aC.value,selected:aq.contains(ay,aC.name||aC.id)}});if(!aA.required&&aA.schema.type==="option"){au.options.unshift({value:-1,text:"None"})}au.isMultiple=aq.contains(aA.operations,"add");delete au.value;return au}function c(aw,au){var ax=au.val();var at=au.attr("multiple");var av=function(az){var ay={};ay[aw]=az;return ay};if(at){return Array.isArray(ax)?aq.map(ax,av):[av(ax)]}return av(ax)}function ap(at){at.find("select[multiple]").auiSelect2()}function u(aw,at,au){var av=aw.name;aw.value=(aw.value&&aw.value.name)||(au&&au.fields[av]&&au.fields[av].name)||(R(at)==="assignee"?-1:"")||(at&&at.defaultValue&&at.defaultValue.name);aw.extraClasses=at.schema.type==="array"?"multi-user-picker":"single-user-picker";return aw}function Q(au){var av=function(ax){return{name:ax}};var aw=au.val();var at=au.closest(".jira-field").is(".multi-user-picker");if(!aw){return at?[]:null}return at?aq.map(aw.split(","),av):av(aw)}function w(at){var au=at.val();if(au==="-1"){return undefined}return{name:au}}function ae(av,at,au){var aw=av.value||(au&&au.fields[av.name])||(at&&at.defaultValue);av.fields=aq.map(at.allowedValues,function(ax){return{value:ax.id,labelText:ax.name||ax.value,isChecked:Array.isArray(aw)?aw.some(function(ay){return ay.id===ax.id}):aw&&aw.id===ax.id,}});delete av.value;return av}function L(at){return at.find("input:checked").toArray().map(function(av){var au=V(av);return{id:au.attr("value"),value:au.parent().find("label").text()}})}function d(au){var at=L(au);return at.length===1?at[0]:null}function am(aA,at,ax,az,au){var ay=aA.find("input");var aB=aA.attr("name");ay.removeClass("text").removeClass("long-field").addClass("medium-long-field");var av={minimumInputLength:1,id:aB,name:aB,query:function(aD){function aC(aE){aD.callback({results:aE})}q(at,ax,aD.term,az).done(aC)}};ay.auiSelect2(V.extend(av,au));var aw=ay.auiSelect2("data");if(aw&&aw.id!==-1){ay.auiSelect2("val",aw.id)}aA.find("div.aui-select2-container").addClass("jira-select2-drop-box")}function r(at,ax,aw,av){var au=(at.find(".long-field").attr("value"))||"";var ay={formatInputTooShort:function(){return "Find users..."},initSelection:al(ax,{id:-1,text:au,isSystemOption:false}),};O(at,ax,aw,av,ay)}function O(at,ax,av,au,aw){var ay=V.extend({},aw,{multiple:av==="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker",formatResult:function(az){return t.templates.fields.userOptionSelect({name:az.id,displayName:az.text,isSystemOption:!!az.isSystemOption})}});am(at,ax,av,au,ay)}function j(at,aw,av,au){var ax={minimumInputLength:0,initSelection:al(aw,{id:-1,text:"Automatic",isSystemOption:true}),query:function(az){function ay(aA){if(az.page===1){if(!az.element.prop("required")){aA.unshift({id:"",text:"Unassigned",isSystemOption:true})}aA.unshift({id:-1,text:"Automatic",isSystemOption:true})}az.callback({results:aA})}if(az.term.length>0){q(aw,av,az.term,au).done(ay)}else{ay([])}},};O(at,aw,av,au,ax)}function m(at,aw,av,au){var ax=at.find("input");t.fields._labelPicker.build(ax,function(ay){return q(aw,av,ay,au)})}function q(ax,av,aw,au){var at=V.extend({restType:av,issueKey:(au&&au.key)||"",term:aw},ax);return V.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",data:JSON.stringify(at)})}function ao(av,at,au){var aw={"data-aui-validation-field":"",pattern:"(([0-9]+w|[0-9]+d|[0-9]+m|[0-9]+h|[0-9]+)\\s*)*","data-aui-validation-pattern-msg":"Enter a valid time estimate (eg. 3w 4d 12h)"};av.value=(av.value&&av.value.remainingEstimate)||(au&&au.fields[name]&&au.fields[name].remainingEstimate)||"";return V.extend(true,{},av,{extraAttributes:aw})}function h(at){return{remainingEstimate:at.val()}}function U(ax,at,au){var aw=ax.name;var ay=(ax.value&&ax.value.id)||(at&&at.defaultValue&&at.defaultValue.id)||"";var av=(ax.value&&ax.value.name)||(au&&au.fields&&au.fields[aw]&&au.fields[aw].name)||(at&&at.defaultValue&&at.defaultValue.id)||"";delete ax.value;ax.options=aq.map(at.allowedValues,function(az){return{value:az.id,text:az.name,selected:av===az.name||ay===az.id,iconUrl:az.iconUrl}});return ax}function K(au){var at;if(au.id){at=V(au.element).attr("data-icon-url")}return t.templates.fields.select2WithIconOption({optionValue:au.text,iconUrl:at})}function b(ax,aw,au,at){if(!V.fn.auiSelect2){AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.");return}var av=ax.find("select");av.addClass("jira-select2-drop-box");av.auiSelect2({hasAvatar:true,minimumResultsForSearch:-1,formatSelection:K,formatResult:K})}function Z(at,ax,av,au){var aw={minimumInputLength:0,formatResult:function(ay){return t.templates.fields.sprintSelect({name:ay.text,state:ay.state,board:ay.board})},query:function(ay){q(ax,av,ay.term,au).done(function(aB){var aA=aq.groupBy(aB,function(aC){return aC.suggestion?"suggestions":"all"});var az=["suggestions","all"].filter(function(aC){return aA[aC]&&aA[aC].length>0}).map(function(aC){return{text:aC==="suggestions"?"Suggestions":"All sprints",children:aA[aC]}});ay.callback({results:aq.compact(az)})})},initSelection:al(ax,{id:-1,text:"Select a sprint"}),};return am(at,ax,av,au,aw)}function ag(at,ax,av,au){var aw={minimumInputLength:0,formatResult:function(ay){return t.templates.fields.epicSelect({name:ay.text,key:ay.id})},query:function(ay){q(ax,av,ay.term,au).done(function(aA){var az=aq.uniq(aA.map(function(aB){return aB.list})).map(function(aB){return{text:aB,children:aA.filter(function(aC){return aC.list===aB})}});ay.callback({results:az})})},initSelection:al(ax,{id:-1,text:"Select an epic"}),};return am(at,ax,av,au,aw)}function aa(at){var au=N(at);return au&&au!==""?au:undefined}function y(at){var au=at.auiSelect2("data");return au&&au.id===-1?undefined:au}function s(au,at){if(aq.has(p,au)&&console&&console.warn){console.warn("Redefining handler for type "+au+".")}p[au]=at}function R(at){return at.schema?(at.schema.system||at.schema.custom||at.schema.customId):at}function ak(at){return p[R(at)]}function G(at){var au=g(at);return au&&ak(au)}function g(at){return at.closest(".jira-field").attr("data-jira-type")}function T(au,at){return V.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+au.serverId+"/projects/"+au.projectKey+"/issue-types/"+au.issueType+"/fields-meta"}).pipe(function(aw){var av=[];aq.each(aw.fields,function(ay){var ax=R(ay);if(ay.required&&!aq.contains(at.excludedFields,ax)){av.push(ay)}});return av})}function C(at){return/\d/.test(at)&&/^-?\d*\.?\d*$/.test(at)}function a(au,av,at){var ax=g(au);var aw=ax&&ak(ax);var ay=aw&&aw.behavior;if(ay){ay(au,av,ax,at)}}function ad(at){var au=G(at);return au&&au.getValue&&au.getValue(at)}function al(au,at){return function(av,ax){var aw=au[av.attr("id")];ax(aw||at)}}return{addFieldHandler:s,getFieldHandler:ak,getFieldType:R,isKnownRestType:function(at){return p.hasOwnProperty(at)},canRender:function(at){var av=R(at);var au=p[av];if(!au){return false}return at.operations&&at.operations.length&&(!au.canRender||au.canRender(at))},getContext:function(au,at,av,aw){return A(au,at,av||{},aw||{})},renderField:function(au,at,av,ax){var aw=A(au,at,av||{},ax||{});return aw.handler.template(aw)},getInternalJSON:function(at){var au=G(at);return au&&au.getInternalValue&&au.getInternalValue(at)||ad(at)},getJSON:ad,attachFieldBehavior:a,attachFieldBehaviors:function(av,au,at){av.find(".jira-field").each(function(ay,ax){var aw=V(ax);a(aw,au,at)})},setFieldError:function(au,aw){var at=au.find(".error");at.remove();if(!aw){return}var av=t.templates.fields.errors({errorTexts:aw});au.append(av)},renderCreateRequiredFields:function(ax,aw,av,au,at){au=aq.extend({},F,au);function ay(az){if(au.ignoreFieldsWithDefaultValue){az=aq.filter(az,function(aB){return !aB.hasDefaultValue})}var aA=aq.filter(az,function(aB){return !t.fields.canRender(aB)});if(aA.length){if(at){at(aA)}return}ax.html(aq.map(az,function(aB){return t.fields.renderField(null,aB,null,null)}).join(""));t.fields.attachFieldBehaviors(ax,{serverId:av.serverId,projectKey:av.projectKey},null)}if(au.requiredFields){ay(au.requiredFields)}else{T(av,au).done(ay)}}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.fields=jiraIntegration.fields||{};jiraIntegration.fields._labelPicker=function(a){var b=function(d,c){d.auiSelect2({tags:true,multiple:true,tokenSeparators:[","," "],createSearchChoice:function(e){if(!e){return null}return{id:e,text:e,isNew:true}},query:function(f){var e=function(g){f.callback({results:g})};c(f.term).done(e)},formatResult:function(e){return jiraIntegration.templates.fields.labelFieldResult({label:{labelName:e.text,isNew:e.isNew}})},initSelection:function(e,g){var f=d.auiSelect2("val").map(function(h){return{id:h,text:h,}});g(f)}})};return{build:b}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.e8173e0382', location = 'aui.chunk.10365490b33e8667d951--4610a7b1389f903b4690.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.e8173e0382"],{"3vMk":function(n,t,i){"use strict";i.r(t);i("rSV2"),i("YQ7q"),i("6fSn"),i("Nu/Z"),i("U8Ze")},U8Ze:function(n,t,i){"use strict";i.d(t,"c",(function(){return j})),i.d(t,"b",(function(){return T})),i.d(t,"a",(function(){return v})),i.d(t,"d",(function(){return y}));var a=i("+x/D"),o=i("TmQU"),r=i("4dFR"),c=(i("tYoR"),i("bPPT"));const e="_aui-form-notification-initialised",u="data-aui-notification-wait",f="data-aui-notification-info",s="data-aui-notification-error",d=[s,"data-aui-notification-success",u,f];function l(n){p(n)||(!function(n){n.addClass(e),v(n)}(n),b(n))}function p(n){return n.hasClass(e)}function v(n,t){t=t||m(n),h(n)===f&&n.after(function(n){if(n.length>1){let t=n.map((n=>"<li>".concat(n,"</li>"))).join("");return'<div class="description"><ul>'.concat(t,"</ul></div>")}return'<div class="description">'.concat(n,"</div>")}(t))}function m(n){var t=h(n),i=t?n.attr(t):"";return""===i?i:function(n){var t;try{t=JSON.parse(n)}catch(i){t=[n]}return t}(i)}function h(n){var t;return d.some((function(i){if(n.is("["+i+"]"))return t=i,!0})),t}function b(n){const t=Object(a.a)(n);if(!p(t))return;const i=h(t);y(t,i===u);const o=m(t);o&&i===s?T(t,o):n.constructor.prototype.hasOwnProperty("jquery")||n.hasAttribute(s)||t.parent().find(".error").remove()}function T(n,t){let i=j(n,"error");i.length>0&&i.remove(),n.after(function(n){let t=n.map((n=>'<li><span class="aui-icon aui-icon-small aui-iconfont-error aui-icon-notification">'.concat(n,"</span>").concat(n,"</li>"))).join("");return'<div class="error"><ul>'.concat(t,"</ul></div>")}(t))}function j(n,t){return n.parent().find(".".concat(t))}function y(n,t){t&&!function(n){return n.next("aui-spinner").length>0}(n)?n.after('<aui-spinner class="form-notification-spinner" size="small"></aui-spinner>'):n.parent().find("aui-spinner").remove()}const O=Object(c.c)("data-aui-notification-field attribute",{deprecationType:"ATTRIBUTE",alternativeName:"HTML markup"});Object(r.a)("data-aui-notification-field",{attached:function(n){O(),l(Object(a.a)(n))},attributes:function(){const n={};return d.forEach((function(t){n[t]=b})),n}(),type:r.a.type.ATTRIBUTE}),Object(o.a)("aui/form-notification")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form-validation', location = 'aui.chunk.5101173500cb1b10a54f--480af40879b4417ab44e.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form-validation"],{defA:function(a,e,t){"use strict";t.r(e);t("3vMk");var i=t("+x/D"),n=t("U8Ze"),r=t("TmQU"),u=(t("uDDF"),t("HH5i")),c=t("JFi+"),s=["displayfield","watchfield","when","novalidate","state"],o=[];var l={register:function(a,e){var t;if("string"==typeof a)t=a;else{var n=function(a){var e=!1;return a.some((function(a){var t=-1!==i.a.inArray(a,s);return t&&(e=a),t})),e}(a);if(n)return c.c('Validators cannot be registered with the argument "'+n+'", as it is a reserved argument.'),!1;t="[data-aui-validation-"+a.join("],[data-aui-validation-")+"]"}var r={validatorFunction:e,validatorTrigger:t};return o.push(r),r},validators:function(){return o}};Object(r.a)("aui/form-validation/validator-register",l);var d=l;function v(a){var e=a.el.value.length;let t=0===e;var i=parseInt(a.args("minlength"),10),n=parseInt(a.args("maxlength"),10);if(i&&n&&i===n&&!t&&e!==i){const e=b("exactlength",a.args,[i]);a.invalidate(e)}else if(i&&e<i&&!t){const e=b("minlength",a.args);a.invalidate(e)}else if(n&&e>n){const e=b("maxlength",a.args);a.invalidate(e)}else a.validate()}function f(a){return"password"===a.getAttribute("type")}function g(a,e){var t=a.match(e);return!!t&&a===t[0]}function m(a){var e=b("pattern",a.args);g(a.el.value,new RegExp(a.args("pattern")))?a.validate():a.invalidate(e)}function h(a){var e=b("required",a.args);a.el.value?a.validate():a.invalidate(e)}function p(a){var e=b("validnumber",a.args),t=parseInt(a.el.value,10);if(isNaN(t))a.invalidate(e);else{var i=a.args("min"),n=a.args("max");i&&t<parseInt(i,10)?a.invalidate(b("min",a.args)):n&&t>parseInt(n,10)?a.invalidate(b("max",a.args)):a.validate()}}function b(a,e,t){var i;i=void 0!==u.a.keys?u.a.keys["aui.validation.message."+a]:k[a];var n=t;t||(n=[e(a)]);var r,c=e(a+"-msg");return r=c?[c].concat(n):[i].concat(n),AJS.format.apply(null,r)}d.register(["maxlength","minlength"],v),d.register("[maxlength],[minlength]",v),d.register(["matchingfield"],(function(a){var e=a.el.value,t=document.getElementById(a.args("matchingfield")),i=t.value,n=b("matchingfield",a.args,[e,i]);(f(a.el)||f(t))&&(n=b("matchingfield-novalue",a.args)),e&&i&&i!==e?a.invalidate(n):a.validate()})),d.register(["doesnotcontain"],(function(a){var e=b("doesnotcontain",a.args);-1===a.el.value.indexOf(a.args("doesnotcontain"))?a.validate():a.invalidate(e)})),d.register(["pattern"],m),d.register("[pattern]",m),d.register(["required"],h),d.register("[required]",h),d.register(["min","max"],p),d.register("[min],[max]",p),d.register(["dateformat"],(function(a){var e=a.args("dateformat"),t=b("dateformat",a.args),i={Y:"[0-9]{4}",y:"[0-9]{2}",m:"(0?[1-9]|10|11|12)",M:"[Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec]",D:"[Mon|Tue|Wed|Thu|Fri|Sat|Sun]",d:"([0-2]?[1-9]|10|20|30|31)"},n=e.split(""),r="";n.forEach((function(a){var e=i.hasOwnProperty(a);r+=e?i[a]:a}));var u=new RegExp(r+"$","i");g(a.el.value,u)?a.validate():a.invalidate(t)})),d.register(["minchecked","maxchecked"],(function(a){var e=Object(i.a)(a.el).find(":checked").length,t=!a.args("minchecked")||e>=a.args("minchecked"),n=!a.args("maxchecked")||e<=a.args("maxchecked"),r=b("minchecked",a.args),u=b("maxchecked",a.args);t&&n?a.validate():t?n||a.invalidate(u):a.invalidate(r)}));var k={minlength:u.a.getText("aui.validation.message.minlength"),maxlength:u.a.getText("aui.validation.message.maxlength"),exactlength:u.a.getText("aui.validation.message.exactlength"),matchingfield:u.a.getText("aui.validation.message.matchingfield"),"matchingfield-novalue":u.a.getText("aui.validation.message.matchingfield-novalue"),doesnotcontain:u.a.getText("aui.validation.message.doesnotcontain"),pattern:u.a.getText("aui.validation.message.pattern"),required:u.a.getText("aui.validation.message.required"),validnumber:u.a.getText("aui.validation.message.validnumber"),min:u.a.getText("aui.validation.message.min"),max:u.a.getText("aui.validation.message.max"),dateformat:u.a.getText("aui.validation.message.dateformat"),minchecked:u.a.getText("aui.validation.message.minchecked"),maxchecked:u.a.getText("aui.validation.message.maxchecked")};Object(r.a)("aui/form-validation/basic-validators");var x=t("bPPT"),O=t("KloK"),T=t("4dFR");const w="data-aui-notification-",j="invalid",y="valid",A="validating",D="unvalidated",I="_aui-form-validation-initialised",E="_aui-internal-field-state-changed";function J(a){(function(a){return a.hasClass(I)})(a)||(!function(a){a.addClass(I),Object(n.a)(a)}(a),function(a){(function(a){var e,t=function(){a.trigger("aui-stop-typing")};a.on("keyup",(function(){clearTimeout(e),e=setTimeout(t,1500)}))})(a),function(a){var e=S(a,"when"),t=S(a,"watchfield");(t?a.add("#"+t):a).on(e,(function(){F(a)}))}(a)}(a),q(a,D))}function F(a){if(!S(a,"novalidate"))return function(a){!function(a){M(R(a),"none")}(a);var e=function(a){var e=[];return N().forEach((function(t,i){var n=t.validatorTrigger;a.is(n)&&e.push(i)})),e}(a);q(a,A);var t=function(a,e){var t=[];return e.forEach((function(e){var n=N()[e].validatorFunction,r=new i.a.Deferred;n(function(a,e){var t={validate:function(){e.resolve()},invalidate:function(t){q(a,j,t),e.reject()},args:_(a),el:a[0],$el:a};return x.d(t,"$el",{sinceVersion:"5.9.0",removeInVersion:"10.0.0",alternativeName:"el",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-3263."}),t}(a,r)),t.push(r)})),t}(a,e),n=i.a.when.apply(i.a,t);return n.done((function(){q(a,y)})),n}(a);q(a,y)}function S(a,e){var t=a.attr("data-aui-validation-"+e);return t||(t={when:"change"}[e]),t}function N(){return d.validators()}function _(a){return function(e){return a.attr("data-aui-validation-"+e)||a.attr(e)}}function q(a,e,t){if(a.attr("data-aui-validation-state",e),e!==D){a.trigger(i.a.Event(E));var r=R(a),u={validating:"wait",invalid:"error",valid:"success"},c=u[e];e===A?function(a){setTimeout((function(){U(a)===A&&(M(a,"wait"),Object(n.d)(a,!0))}),500)}(a):M(r,c,t)}}function M(a,e,t){const i=function(a){return a.is("[data-aui-notification-wait]")}(a);!function(a){P(a,"wait"),Object(n.d)(a,!1),P(a,"success")}(a);var r,u;if(!("success"===e&&!i))if("none"===e)P(a,"error");else{const i=a.attr(w+e)||"[]",c=t?(r=t,u=i,JSON.parse(u).concat([r])):[];a.attr(w+e,JSON.stringify(c)),"error"===e&&Object(n.b)(a,c)}}function P(a,e){a.removeAttr(w+e),"error"===e&&Object(n.c)(a,e).remove()}function R(a){var e=S(a,"displayfield");return void 0===e?a:Object(i.a)("#"+e)}function U(a){return a.attr("data-aui-validation-state")}function V(a,e){e.preventDefault(),a.one(E,(function(){a.trigger("submit")}))}function $(a,e){var t="[data-aui-validation-state="+e+"]";return a.find(t)}Object(i.a)(document).on("submit",(function(a){var e=a.target,t=Object(i.a)(e),n=function(a){return u=a.find("."+I),e=i.a.map(u,(function(a){return U(Object(i.a)(a))})),t=-1!==e.indexOf(j),n=-1!==e.indexOf(D),r=-1!==e.indexOf(A),t?j:n?D:r?A:y;var e,t,n,r;var u}(t);if(n===D)V(t,a),function(a){$(a,D).each((function(a,e){B.validate(Object(i.a)(e))}))}(t);else if(n===A)V(t,a);else if(n===j)a.preventDefault(),function(a){$(a,j).first().focus()}(t);else if(n===y){var r=i.a.Event("aui-valid-submit");t.trigger(r),r.isDefaultPrevented()&&a.preventDefault()}}));const B={register:d.register,validate:function(a){F(a=Object(i.a)(a))}};Object(T.a)("data-aui-validation-field",{attached:function(a){a.form&&a.form.setAttribute("novalidate","novalidate"),J(Object(i.a)(a)),T.a.init(a)},type:T.a.type.ATTRIBUTE}),Object(r.a)("aui/form-validation",B),Object(O.a)("formValidation",B)}},[["defA","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--be1eb78c1a","aui.splitchunk.vendors--23f50a6f00","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.be1eb78c1a","aui.splitchunk.23f50a6f00","aui.splitchunk.e8173e0382"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
window.jiraIntegration=window.jiraIntegration||{};window.jiraIntegration.JiraCreateIssueForm=(function(d,a){b.defaults={allowUnsupportedFields:false,ignoreFieldsWithDefaultValue:true,excludedField:["project","issuetype","reporter"],formClass:"jira-interation-create-issue-form",requiredFieldsOnly:true,renderSummaryAndDescription:false,get$unsupportedFieldMessage:function(f,g){return d(jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:f,createIssueUrl:g}))},get$unexpectedError:function(f){return d(aui.message.error({content:AJS.escapeHtml(f)}))},get$communicationError:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage({message:f}))},get$unauthorizeMessage:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:f}))},get$unsupportedServerMessage:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:f}))},get$unrenderableRequiredFieldsMessage:function(g,f){var h=g.map(function(i){return AJS.escapeHtml(i.name)}).join(", ");return d(jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage({names:h,count:g.length,serverUrl:f}))},ajax:function(f){alert("JiraCreateIssueForm requires the option 'ajax(options)' to be specified and respond like jQuery.ajax.\nThis method should handle response status codes other than 200 and 500 (those are handled by us).")}};function b(f){this.configuration=a.extend({},b.defaults,f);if(this.configuration.renderSummaryAndDescription){this.configuration.excludedField.push("summary","description")}this._init()}b.prototype._trigger=function(f,g){var h=this.configuration[f];if(h){h.apply(this,Array.prototype.slice.call(arguments,1))}};b.prototype._selectServer=function(f,h){var g=this;if(this.currentServerId===f&&!h){return}this.currentServerId=f;this.formIsLoading(this.defaultFields.server);jiraIntegration.JiraCreateIssueForm.Data.isIssueCreationSupported(f,this.configuration.ajax).done(function(i){if(i){g._loadProjectData(f);g.formLoadingCompleted(g.defaultFields.server)}else{var j=jiraIntegration.JiraCreateIssueForm.Data.getServerById(f).displayUrl;g._handleUnsupportedServer(j)}}).fail(function(i){if(i[0]&&i[0].authenticationUri){g._handleAuthorizeError(i[0])}else{g._handleAjaxError(i)}})};b.prototype._bindEventListener=function(){var f=this;this.defaultFields.server.on("change",function(h){f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());f.resetForm(true);var g=this.value;if(g){f._selectServer(g)}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(f.defaultFields.project);f.defaultFields.project.trigger("change")}f._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){var h=this.value||d(this).select2("data").value;var g=d(f.defaultFields.issueType).select2("data");f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());if(h){d('option[value=""]',f.defaultFields.project).remove();f._loadIssueType(f.currentServerId,h,g)}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(f.defaultFields.issueType)}f.defaultFields.issueType.trigger("change");f._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());f.resetForm(true);if(this.value){f._loadFields(f.fieldValues)}else{f.$containerRequireField&&f.$containerRequireField.html("");c(this.$form)}f._trigger("onTypeChanged",this.value)})};b.prototype._getFieldValues=function(){return this._getJSON({getFieldJSON:jiraIntegration.fields.getInternalJSON,$form:this.$form,})};b.prototype._init=function(){this.container=d(this.configuration.container);this.fieldValues={};if(this.container.length){this._renderForm();this._bindEventListener();this._loadServerData()}else{throw new Error("container property should be defined.")}};b.prototype._renderForm=function(){var f=this;this.$form=d(jiraIntegration.templates.jiraCreateIssueForm.form({formClass:this.configuration.formClass})).on("aui-valid-submit",function(g){if(f.configuration.onSubmit){g.preventDefault();f.configuration.onSubmit()}}).on("focus",".fake-tabbable",function(){const g=this.parentElement.children[1].getElementsByTagName("input")[0];d(g).focus()});if(this.configuration.renderSummaryAndDescription){this._renderSummaryAndDescription()}this.container.append(this.$form);this.defaultFields=this._getDefaultFields();a.each(this.defaultFields,a.bind(function(g){this.createSelect2WithIcon(d(g))},this));this.$containerRequireField=d(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var f=d(".create-issue-default-fields",this.$form);f.append(aui.form.textField({labelContent:"Summary",isRequired:true,name:"summary",value:this._getSummaryFromConfiguration()}));f.append(aui.form.textareaField({labelContent:"Description",name:"description"}))};b.prototype._getDefaultFields=function(){return{server:d(".server-select",this.$form),project:d(".project-select",this.$form),issueType:d(".issuetype-select",this.$form)}};b.prototype._loadServerData=function(){var f=this;this.formIsLoading(this.defaultFields.server);jiraIntegration.JiraCreateIssueForm.Data.loadServers(f.configuration.ajax).then(function(g){f.formLoadingCompleted(f.defaultFields.server);f._loadServerDataComplete(g)})};b.prototype._loadFields=function(g){var h=this;var f=a.extend({},this.getContextJSON(),g);this.formIsLoading(this.defaultFields.issueType);var i=jiraIntegration.JiraCreateIssueForm.Data.getFieldMetadata(f,h.configuration.ajax);i.done(function(n){var j=h._filterFields(n.fields);if(h.configuration.renderSummaryAndDescription){var k=n.fields.description;var m=!!(k&&k.required);h._setDescriptionAsRequiredField(m)}var l=h._unrenderableRequiredFields(j);if(l.length===0){h._renderFields(j,f);h._trigger("onFieldsRendered")}else{h._handleUnrenderableRequiredFields(l)}h._fieldTypeAnalytics(j);h.formLoadingCompleted(h.defaultFields.issueType)}).fail(a.bind(h._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(f){if(f.length){if(f.length===1){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}this._hasMultiServer=f.length>1;jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.server,f,this.configuration.serverId||f[0].id);this._selectServer(this.configuration.serverId||f[0].id)}else{this._handlerUnexpectedError("Don\u0027t have any Jira server, please check the application link configuration.")}};b.prototype._loadProjectData=function(f){var g=this;this.formIsLoading(this.defaultFields.project);var h=jiraIntegration.JiraCreateIssueForm.Data.loadProjects(f,g.configuration.ajax);h.then(function(i){if(i.errors&&i.errors.length){var j=i.errors[0];if(j.authenticationUri){g._handleAuthorizeError(j)}else{g._handlerUnexpectedError(j.message)}}else{if(i.length){jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(g.defaultFields.project,i,g.configuration.projectId)}else{g._handlerUnexpectedError("You do not have permission to create issues on this Jira server.")}}g.formLoadingCompleted(g.defaultFields.project)},a.bind(g._handleAjaxError,this))};b.prototype._loadIssueType=function(g,f,h){var i=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypes(g,f,this.configuration.ajax);jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.issueType,i,h&&h.id)};b.prototype._fieldTypeAnalytics=function(f){var h=f.map(function(j){var i=jiraIntegration.fields.getFieldType(j);return{required:j.required,restType:i,knownRestType:jiraIntegration.fields.isKnownRestType(i),}});var g=h.reduce(function(i,j){if(j.knownRestType){i[j.required?"requiredFields":"otherFields"].push(j.restType)}else{i[j.required?"unknownRequiredFieldsCount":"unknownOtherFieldsCount"]++}return i},{requiredFields:[],otherFields:[],unknownRequiredFieldsCount:0,unknownOtherFieldsCount:0});g=Object.keys(g).reduce(function(k,m){var n=g[m];if(!Array.isArray(n)){k[m]=n;return k}var j=n.length;k[m+".size"]=j;for(var l=0;l<j;l++){k[m+"["+l+"]"]=n[l]}return k},{});AJS.trigger("analytics",{name:"jira.integration.issue.create.form.displayed",data:g,})};b.prototype._renderFields=function(f,g){this.$containerRequireField.html("");var h=a.reject(f,jiraIntegration.fields.canRender);if(!this.configuration.allowUnsupportedFields&&h.length){this._handleUnsupportedFields(h)}else{this.$containerRequireField.html(a.map(f,function(i){return jiraIntegration.fields.renderField(null,i,g,null)}).join(""));jiraIntegration.fields.attachFieldBehaviors(this.$containerRequireField,g,null);this._trigger("onRequiredFieldsRendered",f,h)}};b.prototype._setError=function(f){c(this.$form);this.$form.prepend(f);this.formLoadingCompleted();this.formHasError()};b.prototype._handleCommunicationError=function(g){var f=this.configuration.get$communicationError(g);this._setError(f)};b.prototype._handlerUnexpectedError=function(g){var f=this.configuration.get$unexpectedError(g);this._setError(f)};b.prototype._handleUnsupportedFields=function(f){f=a.map(f,function(h){return AJS.escapeHtml(h.name)});var g=this.configuration.get$unsupportedFieldMessage(f,this._getCreateJiraIssueUrl());c(this.$form);this.$form.prepend(g);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(f){var g=this.configuration.get$unsupportedServerMessage(f);this._setError(g)};b.prototype._handleAjaxError=function(i){var h=this;if(i.status>=500&&i.status<600){var f=(i.responseJSON.errors&&i.responseJSON.errors[0]);var g=f&&f.exceptionName;if(g&&g==="com.atlassian.integration.jira.JiraCommunicationException"){this._handleCommunicationError(f.message)}else{h._handlerUnexpectedError(AJS.format("Could not communicate with Jira (HTTP error {0})",i.status))}}else{h._handlerUnexpectedError("An unexpected response was received from Jira.")}h.formHasError()};b.prototype._handleAuthorizeError=function(h){var g=this;this.formHasError();var f=this.configuration.get$unauthorizeMessage(h.applicationName);this.$form.append(f);d(".applink-authenticate",f).on("click",function(i){AppLinks.authenticateRemoteCredentials(h.authenticationUri,function(){g.resetForm();g._selectServer(g.currentServerId,true)},function(){g._handlerUnexpectedError(AJS.format("You have refused to permit access to {0}.",h.applicationName))});i.preventDefault()})};b.prototype._handleUnrenderableRequiredFields=function(f){var g=this.configuration.get$unrenderableRequiredFieldsMessage(f,this._getCreateJiraIssueUrl());c(this.$form);this.$form.append(g);this.formLoadingCompleted()};b.prototype._getCreateJiraIssueUrl=function(){var h=this.defaultFields.project.find("option:selected").val();var i=this.defaultFields.issueType.find("option:selected").val();var j=jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId).displayUrl;j=j+"/secure/CreateIssueDetails!Init.jspa?pid="+h+"&issuetype="+i;var g=this._getFieldValue("summary");if(g.length){j=j+"&summary="+encodeURIComponent(g)}var f=this._getFieldValue("description");if(f.length){j=j+"&description="+encodeURIComponent(f)}return j};b.prototype._filterFields=function(f){var g=this;return a.filter(f,function(j){var i=j.schema?(j.schema.system||j.schema.custom||j.schema.customId):j;var h=a.contains(g.configuration.excludedField,i)||(g.configuration.ignoreFieldsWithDefaultValue&&j.hasDefaultValue)||(g.configuration.requiredFieldsOnly&&!j.required);return !h})};b.prototype._unrenderableRequiredFields=function(f){return f.filter(function(g){return g.required&&!jiraIntegration.fields.canRender(g)})};b.prototype._getFieldValue=function(g){var f=d("[name='"+g+"']",this.$form);return(f)?d.trim(f.val()):""};b.prototype._setDescriptionAsRequiredField=function(f){var g=d('.field-group [name="description"]',this.$form).prev("label");g.find(".aui-icon.aui-icon-required").remove();if(f){g.append(aui.icons.icon({icon:"required"}))}};b.prototype._getSummaryFromConfiguration=function(){var f=this.configuration.initialSummary;delete this.configuration.initialSummary;return f};b.prototype._getJSON=function(f){if(!f.verbose){return e(f.$form,function(l,j,k){return f.getFieldJSON(l)})}var h=jiraIntegration.JiraCreateIssueForm.Data.getCachedFieldMetadataEntry(this.getContextJSON()).value;var g=Object.keys(h.fields).reduce(function(k,j){var i=h.fields[j];k[j]=jiraIntegration.fields.getContext(null,i,null,null);return k},{});return e(this.$form,function(m,j,l){var k=g[j];return{name:j,jiraType:k.jiraType,required:k.isRequired,label:k.labelText,value:f.getFieldJSON(m),index:l}})};b.prototype.resetForm=function(f){c(this.$form);d(".field-group",this.$form).show();if(this.configuration.renderSummaryAndDescription){this._setDescriptionAsRequiredField(false)}if(!this._hasMultiServer){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}this.$containerRequireField.html("");this.fieldValues=f?this.fieldValues:{}};b.prototype.formHasError=function(){d(".field-group",this.$form).hide();this.$containerRequireField.html("");if(this._hasMultiServer){jiraIntegration.JiraCreateIssueForm.FieldHelper.showField(this.defaultFields.server)}jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(d(".insert-issue-button"),true);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(f){if(f){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(f,true)}var g=d(":input",d(this.$form));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(g,true)};b.prototype.formLoadingCompleted=function(f){if(f){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(f,false)}else{d(".aui-icon.aui-icon-wait",this.$form).remove()}var g=d(":input",d(this.$form));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(g,false)};b.prototype.createSelect2WithIcon=function(f){if(f.is(".server-select")){f.auiSelect2({minimumResultsForSearch:-1})}else{var g=f.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,extraAttributes:this.defaultFields};f.auiSelect2(g)}f.auiSelect2("val","")};b.prototype.projectSelectFormat=function(h){var g=this.extraAttributes.server.select2("data").id;var f=jiraIntegration.JiraCreateIssueForm.Data.getProjectIconUrl(g,h.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:h.text,iconUrl:f,isProject:true})};b.prototype.issueTypeSelectFormat=function(i){var h=this.extraAttributes.server.select2("data").id;var f=this.extraAttributes.project.select2("data").id;var g=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypeIconUrl(h,f,i.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:i.text,iconUrl:g,isProject:false})};b.prototype.getContextJSON=function(){var f=this.defaultFields.project.val()||d(this.defaultFields.project).select2("data").value;return{serverId:this.currentServerId,projectId:f,projectKey:jiraIntegration.JiraCreateIssueForm.Data.getProjectById(this.currentServerId,f).key,issueTypeId:this.defaultFields.issueType.val(),summary:this._getSummaryFromConfiguration()}};b.prototype.getJSON=function(f){return b.prototype._getJSON({getFieldJSON:jiraIntegration.fields.getJSON,verbose:f,$form:this.$form,})};b.prototype.renderErrors=function(f){e(this.$form,function(g,j){var k=g.closest(".jira-field");var i=function(l){return l.indexOf(j)===0};var h;if(f.hasOwnProperty(j)||Object.keys(f).some(i)){if(!f.hasOwnProperty(j)){j=Object.keys(f).filter(i)[0]}h=Array.isArray(f[j])?f[j]:[f[j]]}jiraIntegration.fields.setFieldError(k,h)})};b.prototype.submit=function(){this.$form.submit()};function e(f,h){var g={};f.find(".create-issue-required-fields").find("input, select, textarea, fieldset").not(".select2-input, .select2-focusser").each(function(k){var l=d(this);var j=l.attr("data-name");if(j){g[j]=h(l,j,k)}});return g}function c(f){d(".aui-message",f).remove()}return b})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
window.jiraIntegration=window.jiraIntegration||{};var jiraIntegration=window.jiraIntegration;jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.Data=(function(d){var j={};var l={};var q=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId={0}&iconType={1}&{2}";var m=[];var p=function(s,t){return s({dataType:"json",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers"+(t||"")})};function o(s){return p(s,"").done(function(t){t.forEach(function(u){j[u.id]=u})})}function i(s,u){var t=j[s]&&j[s].projects;if(t){return d.Deferred().resolve(t)}return p(u,"/"+s+"/projects").done(function(v){if(v.length){v.forEach(function(z){var y=z.issuetypes.filter(function(A){return !A.subtask});z.issueTypes=y;var w={};y.forEach(function(A){w[A.id]=A.iconUrl});var x=z.avatarUrls["16x16"].split("/secure/projectavatar?")[1];if(x.indexOf("pid=")===-1){x=x+"&pid="+z.id}m[e(s,z.id)]={iconUrl:AJS.format(q,s,"project",x),issueTypes:w}});j[s].projects=v}})}function r(t,s){var u=h(t).filter(function(v){return v.id===s})[0];return u?u.issueTypes:[]}function f(s,t){var u=b(s);if(u.value){return d.Deferred().resolve(u.value)}return p(t,"/"+s.serverId+"/projects/"+s.projectKey+"/issue-types/"+s.issueTypeId+"/fields-meta").done(function(v){l[u.key]=v})}function b(t){var s=e(t.serverId,t.projectKey,t.issueTypeId);return{key:s,value:l[s]}}function n(s){return j[s]}function g(s,t){if(!j[s]){throw new Error("Can only be called after server is loaded.")}if("issueCreationSupported" in j[s]){return d.Deferred().resolve(j[s].issueCreationSupported)}return p(t,"/"+s+"/features").then(function(u){if(u.errors){return d.Deferred().reject(u.errors)}else{if(!Array.isArray(u)){return d.Deferred().reject("Unexpected response from Jira")}}j[s].issueCreationSupported=u.indexOf("CREATE_ISSUE")!==-1;return j[s].issueCreationSupported})}function h(s){if(!j[s]){throw new Error("Can only be called after server is loaded.")}return j[s].projects}function k(u,t){var w=h(u);if(!w){return null}for(var v=0,s=w.length;v<s;v++){var x=w[v];if(x.id===t){return x}}return null}function a(t,s){var u=e(t,s);return m[u]?m[u].iconUrl:""}function c(u,t,v){var w=e(u,t);var s=m[w];return(s&&s.issueTypes[v])?s.issueTypes[v]:""}function e(t,s,u){return t+(s?"-"+s:"")+(u?"-"+u:"")}return{loadServers:o,loadProjects:i,getIssueTypes:r,getFieldMetadata:f,getCachedFieldMetadataEntry:b,getServerById:n,getProjectIconUrl:a,getIssueTypeIconUrl:c,getProjects:h,getProjectById:k,isIssueCreationSupported:g}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.FieldHelper=(function(b,h){function d(j,m,k){var n=[];var l;m.forEach(function(p){var o={value:AJS.escapeHtml(p.id),text:p.name,iconUrl:p.iconUrl?p.iconUrl:(p.avatarUrls?p.avatarUrls["16x16"]:"")};if(k===p.id){o.selected=true;l=p}n.push(aui.form.optionOrOptgroup(o))});if(l){l.text=l.name;j.html(n.join(""));j.auiSelect2("data",l).trigger("change")}else{n.unshift(e(j));j.html(n.join(""));j.auiSelect2("val","").trigger("change")}}function a(j){j.html(e(j));j.auiSelect2("val","").trigger("change")}function e(j){var k=j.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:k,iconUrl:""})}function i(j){j.parent().hide()}function c(j){j.parent().show()}function f(k,j){j?b.fn.disable?k.disable():k.prop("disabled",true):b.fn.enable?k.enable():k.prop("disabled",false)}function g(k,j){return j?k.after(aui.icons.icon({icon:"wait"})):k.next(".aui-icon.aui-icon-wait").remove()}return{fillSelectData:d,resetSelectField:a,hideField:i,showField:c,setFieldDisabled:f,setIsLoading:g}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({extraClasses: (opt_data.formClass ? opt_data.formClass + ' ' : '') + 'jira-create-form', method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="fake-tabbable" tabindex="0" /><div class="field-group" data-jira-type="server"><label>' + soy.$$escapeHtml('Server') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select medium-long-field" name="server" data-placeholder="' + soy.$$escapeHtml('Select a server') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a server') + '</option></select></div><div class="field-group" data-jira-type="project"><label>' + soy.$$escapeHtml('Project') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select medium-long-field" name="project" data-placeholder="' + soy.$$escapeHtml('Select a project') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a project') + '</option></select></div><div class="field-group" data-jira-type="issuetype"><label>' + soy.$$escapeHtml('Issue Type') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('Select an issue type') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select an issue type') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param28 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy31 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param28 += soy.$$filterNoAutoescape(AJS.format('The required field {0} is not available in this form. You will need to',field__soy31));
  } else {
    var fieldList__soy38 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param28 += soy.$$filterNoAutoescape(AJS.format('The required fields {0} are not available in this form. You will need to',fieldList__soy38));
  }
  param28 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('create your issue directly in Jira') + '</a>.';
  var output = '' + aui.message.warning({content: param28});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy50 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('and') + ' ' : ', ');
  var fieldList58 = opt_data.fields;
  var fieldListLen58 = fieldList58.length;
  for (var fieldIndex58 = 0; fieldIndex58 < fieldListLen58; fieldIndex58++) {
    var fieldData58 = fieldList58[fieldIndex58];
    output += ((! (fieldIndex58 == 0)) ? soy.$$escapeHtml(joinText__soy50) : '') + '<strong>' + soy.$$escapeHtml(fieldData58) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy67 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}Log in and approve{1} to retrieve data from {2}','<a class="oauth-init applink-authenticate" href="#">','</a>',applicationNameEscaped__soy67))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The version of selected Jira server is not supported. You may want to upgrade to at least version 5.x or {0}create issue in Jira{1}.','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The required {1,choice,1#field|1\x3cfields} \x3cstrong\x3e{0}\x3c/strong\x3e {1,choice,1#is|1\x3care} not available in this dialog. You will need to {2}create your issue directly in Jira{3}.',opt_data.names,opt_data.count,'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.error({titleContent: '' + soy.$$escapeHtml('Unfortunately, we\x27ve encountered problems connecting to Jira'), content: '<p>' + soy.$$escapeHtml(opt_data.message) + '</p>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-soy', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model",["backbone","confluence/legacy","confluence/api/constants","ajs"],function(e,c,f,d){return e.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.findMetadata();this.findVersion();this.findContainer();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());
this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"application/pdf"===(this.get("niceType")||"").toLocaleLowerCase()||
this.isImage()},getFileName:function(){return this.get("fileName")||this.get("title")||""},getDestinationUrl:function(){return d.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(a+=(a.indexOf("?")+1?"&":"?")+"nonce="+b);return a},getRelativeUrl:function(a){var b=a;if(!a)return a;0===a.indexOf(c.getBaseUrl())&&(b=a.replace(c.getBaseUrl(),
""));return f.CONTEXT_PATH+b},_findThumbnailUrl:function(){var a=this.get("_links");!this.get("thumbnailUrl")&&(a&&a.thumbnail)&&this.set("thumbnailUrl",this.getRelativeUrl(a.thumbnail))},_findDownloadUrl:function(){var a=this.get("_links");!this.get("downloadUrl")&&a&&this.set("downloadUrl",this.getRelativeUrl(a.download))},findMetadata:function(){var a=this.get("metadata");!this.get("contentType")&&a&&(this.set("niceType",a.mediaType),this.set("contentType",a.mediaType))},findVersion:function(){var a=
this.get("version");!this.get("versionNumber")&&a&&this.set("versionNumber",a.number)},findContainer:function(){var a=this.get("container");a&&(-1===this.get("ownerId")&&this.set("ownerId",a.id),this.get("parentTitle")||this.set("parentTitle",a.title))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){return d.Confluence.FileTypesUtils.getAUIIconFromExt(this._getFileExtension(a))}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,e,j,d){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),c=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?c+" ("+b.name+")":c,highlightedImageNameContent:a.highlight(c),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.get("container").title):null};this.$el=d(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",e.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("versionNumber")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b={viewMode:"simple",openPreviewCallback:function(){d("#insert-image-dialog").hide();d(".aui-blanket").hide()},closePreviewCallback:function(){d("#insert-image-dialog").show();d(".aui-blanket").show()}},c=e.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},
this);this.dfd?this.dfd.done(e.partial(c,a,b)):this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources",e.partial(c,a,b))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view confluence/api/constants jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;
if(a.eventListener){this.eventListener=a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",
function(){this.context.setSelectItems(this.collection.getAllSelectItems())});this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this;c.get(j.CONTEXT_PATH+"/rest/api/content/"+b+"?expand=version,container,space").done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?
d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));
b.shouldClearSelection&&this.collection.clearSelection();this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||
a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===
a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=
a;this.contextOptions=this.context.options}},_checkError:function(a){(a=a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");
a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");require("confluence/legacy").Editor.FileDialog.eventListener=b.extend({},a.Events)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon aui-icon aui-icon-small aui-iconfont-upload">' + soy.$$escapeHtml('Upload files') + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml('Upload files') + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml('Image uploading...') + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml('Loading...') + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/legacy confluence/api/constants ajs confluence/meta underscore window jquery".split(" "),function(n,i,o,j,k,p,l,e,h,m,f,g){return j.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",
cssContainer:"#attached-files",textNoFileMessage:"There are no files attached to this page.",textPanelTitle:"Attached to this page",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new o;this.fileListView=new n({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();
this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["You\u0027ll need to ask permission to insert files here."],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var c=0;c<b.length;c++){var d=
b[c].id,e=a.collection.get(d);e&&a.collection.removeFile(e);g.get(l.CONTEXT_PATH+"/rest/api/content/"+d+"?expand=version,container,space").done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return p.AttachmentUploader({baseElement:this.getPanelElement()},
m.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,c=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,d=this.xhrCount=this.xhrCount+1;e.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:c,errorMessage:this.textErrorRetrieving,successCallback:function(c){if(d===b.xhrCount){a.data=c;b._onSuccessLoadFiles(a)}},errorCallback:m.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.results,
a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1)},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,
b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(c){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(f.File&&f.FileReader&&f.FileList&&f.Blob){var c=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<b){var d=new FileReader;d.onload=function(){c._addFilePlaceHolderToCollection(a,d.result)};d.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,
null)}},_addFilePlaceHolderToCollection:function(a,b){var c=null,d=this.collection.findWhere({fileName:a.name});if(d){this.collection.removeFile(d);d.get("isFilePlaceHolder")?d.get("previousUploadedFile")&&(c=d.get("previousUploadedFile")):c=d}c=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b||"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b||"",previousUploadedFile:c});this.collection.addFile(c)},_isImageType:function(a){return e.Confluence.FileTypesUtils.isImage(a)},
_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),10);return l.CONTEXT_PATH+"/rest/api/content/"+a+"/child/attachment?expand=version,container,space"},focus:function(){this.collection.clearSelection()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml('Image URL:') + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml('Preview') + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml('This image couldn\x27t be loaded for preview. Please check the URL.') + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml('All Spaces') + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml('Searching...') + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter confluence/api/constants underscore ajs jquery".split(" "),function(n,h,i,d,j,e,k,l,m,f,g,c){return d.extend({id:"search",panelId:"",cssPanel:".search-panel",
cssContainer:"#searched-images",template:j.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){d.prototype.initialize.call(this);this.context=null;this.collection=new i;this.fileListView=new h({collection:this.collection})},getPanel:function(){this.$el=c(this.template({spaceKey:e.get("space-key"),spaceName:e.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("Search on other pages",
this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){this.clearContainer();this.collection.reset();this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){var a=this.getForm().find(".search-space").val(),b=this._getQuery(),
b='(title ~ "'+b+'*" OR parent.title ~ "'+b+'*") AND type = attachment';a&&a!==""&&(b=b+(" AND space.key = "+a));return c.ajax({type:"GET",dataType:"json",url:m.CONTEXT_PATH+"/rest/api/search",data:{cql:b,expand:"content.version,content.container,content.space",limit:k.maxResults}})},_onSuccessLoadFiles:function(a){a=a.results.map(function(a){return a.content});this.fileListView.highlighter=new l(this._getQuery().split(" "));this.fileListView.resetFileList(a,{shouldClearSelection:true})},_onErrorLoadFiles:function(){var a=
this.getContainer();a.find(".loading-message").addClass("hidden");a.append(c("<p class='warning'>"+c(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return c("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-713/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(j,e,k,f,d,i,l){return j.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;this.beforeShowListeners=a.beforeShowListeners;this.panelComponents=a.panelComponents},render:function(){this._createDialog();
this.clearSelection();d(i).on("keydown.insert-image",f.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new e.Dialog(this.width,this.height,this.dialogId),m="Insert files and images",b="Insert";this.dialog=a;a.addHeader(m);a.addButton(b,f.bind(this._submitDialog,this),"insert");a.addCancel("Close",f.bind(this._killDialog,this));this.el=a.popup.element;this.$el=d(this.el);this.baseElement=this.el;
this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");d("#"+this.dialogId+" .dialog-components .dialog-title").prepend(k.File.helpLink());this.$el.find(".dialog-button-panel").append(d("<div></div>").addClass("dialog-tip").html("Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 in the Editor to insert attached images on the page."));this._createPanels();d(i).on("hideLayer",f.bind(function(c,b,d){if(b==="popup"&&d===a.popup){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},
this));e.bind("remove.dialog",f.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;d.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)});e.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");d.each(this.beforeShowListeners,function(){typeof this==="function"&&this()})},teardown:function(){d(i).unbind(".insert-image");d(".tipsy").remove();this.undelegateEvents()},
_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a={url:this.urlExternalImg,contentId:e.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();typeof this.submitCallback==="function"&&this.submitCallback(a)},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>
0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!d("#"+
this.dialog.id).is(":hidden")){var e=this.dialog.getCurrentPanel().body,b=e.find(".attached-file");if(!(b.length===0||d(i.activeElement).is("input[type=text], select, button"))){var c=l.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var f=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var j=b.length,h={};h[c.LEFT]=-1;h[c.RIGHT]=1;h[c.UP]=-4;h[c.DOWN]=4;c=g+(h[f]?h[f]:0);b=b.eq(c<0||c>=j?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");
b.addClass("current");b.length&&e.find(".scroll-wrapper").simpleScrollTo(b);a.stopPropagation();return false;case c.SPACEBAR:e.find("li.attached-file.current").click();a.stopPropagation();return false;case c.ENTER:this.insert();a.stopPropagation();return false}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dictionary', location = '/includes/js/api/dictionary.js' */
define("confluence/api/dictionary",[],function(){return function(){var a={};return{get:function(b){return a[b]},put:function(b,c){return a[b]=c},reset:function(){a={}},elements:function(){return a}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:macro-js-overrides', location = '/includes/js/macro-js-overrides.js' */
define("confluence/macro-js-overrides",["confluence/api/dictionary","underscore"],function(f,e){var a=new f;return e.extend(a,{getFunction:function(b,c){var d=a.get(b);if(d&&"function"===typeof d[c])return d[c]},assignFunction:function(b,c){a.put(b,e.extend({},a.get(b),c))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(d,k,a){function m(b){return d.map(b,function(b){return"spaceKey\x3d"+encodeURI(b)}).join("\x26")}function f(b,a){var c="undefined"===typeof a;a=d.escape(c?b:a);return{id:b,text:a,idOnly:c}}var l={conf_all:"All spaces",conf_current:"Current space",conf_favorites:"Favorite spaces",
conf_global:"Site spaces",conf_personal:"Personal spaces"},g=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:function(b,g){var c={},h=[];d.each(b,function(a){var b=l[a];b?c[a]=f(a,b):h.push(a)});if(h.length){var e=a.contextPath()+"/rest/api/space?"+m(h);e=k.getJSON(e)}else e=new k.Deferred,e.resolve({results:[]});e.done(function(a){d.each(a.results,
function(a){c[a.key]=f(a.key,a.name)});a=d.map(b,function(a){return c[a]||f(a)});g(a)})},getSpaceCategoryDisplayName:function(a){return l[a]},getSpaceTypeKeys:function(){return g}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(d,f,g,k){function q(a){var b=r(),c=t(a);return function(a,h,e){if(2>a.term.length)return c(a);"function"===typeof h&&(a.term=h(a.term));m=u(e);return b(a)}}function n(a,b,c){var l=[];a.forEach(function(a){if(a.children){var e=n(a.children,b,c);e.length&&l.push(g.extend({},a,{children:e}))}else if(e="undefined"!==typeof a.id&&d.contains(k.getSpaceTypeKeys(),
a.id),b&&e||!b&&!e)d.contains(c,a.id)||l.push(a)});return l}function p(a,b){if(!a.length||!b.length)return a;var c=0<d.intersection(b,k.getSpaceTypeKeys()).length;a=n(a,c,b);a.length||a.push({text:"Can\u0027t filter by space types AND spaces",disabled:!0});return a}function v(a){var b=g(".select2-container-active").next("input").val().trim();b=""!==b?b.split(","):[];return p(a,b)}var w={data:null,suggestCategories:null},u=function(a){return function(b){b={id:b.spaceKey,
text:b.spaceName};return"function"===typeof a?a(b):b}},m,x=function(a){return function(b,c){b=g(b).val();""!==b&&(b=b.split(","),k.getSpaceDisplayItems(b,function(b){a.multiple||(b=b[0]);c(b)}))}},t=function(a){var b;if(a.suggestCategories)var c={text:"Select a suggestion or type to search",children:d.map(a.suggestCategories,function(a){return{id:a,text:k.getSpaceCategoryDisplayName(a)}})};return function(a){b?a.callback(b):g.getJSON(f.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(h){var e=
{results:[]};c&&e.results.push(c);0<h.length&&e.results.push({text:"Suggested spaces",children:d.map(h,function(a){return{id:a.key,text:d.escape(a.name)}})});b=e;a.callback(b)}).fail(function(){f.log("Couldn't fetch recent spaces");var b={results:[]};c&&b.results.push(c);a.callback(b)})}},r=function(){return window.Select2.query.ajax({url:f.contextPath()+"/rest/quicknav/1/search?type\x3dspacedesc\x26type\x3dpersonalspacedesc",data:function(a){return{query:a,
maxPerCategory:25}},quietMillis:250,results:function(a){a=a.contentNameMatches;if(1>=a.length)return{results:[]};a=d.map(a[0],m);return{results:[{text:"Search results",children:a}]}}})};return{build:function(a){a=d.extend({},w,a);var b={placeholder:"Select a space",formatResult:function(a,b,d){b.attr("title",g("\x3cdiv/\x3e").html(a.text).text());return g.fn.select2.defaults.formatResult.apply(this,
arguments)},escapeMarkup:function(a){return a},multiple:!0===a.multiple,containerCssClass:"space-picker-container"};a.disableMixedSpaceTypes&&(b.sortResults=v);return a.data?d.extend(b,{data:a.data}):d.extend(b,{initSelection:x(a),query:q(a)})},filterMixedTypesForValues:p}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");require("ajs").deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/amd/shim/aui-datepicker-amd.js' */
define("aui/datepicker",function(){return AJS.DatePicker});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/date-picker-localisation.js' */
require(["aui/datepicker"],function(a){var b="";a&&(a.prototype.localisations.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday",
"Saturday"],a.prototype.localisations.dayNamesMin=["Sun","Mon","Tue","Wed","Thu","Fri",
"Sat"],a.prototype.localisations.firstDay="0",a.prototype.localisations.isRTL="true"==="false",a.prototype.localisations.monthNames=["January","February","March",
"April","May","June","July","August","September","October","November",
"December"],a.prototype.localisations.showMonthAfterYear="true"==="false",a.prototype.localisations.yearSuffix=b&&"null"!==b?b:"")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
define("confluence-ui-components/js/space-page-picker",["underscore","ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(e,g,F,f){function G(a,b,c){a=e.map(a,function(a){return b[a]});return c?a:0<a.length?a[0]:null}function B(a){return 0===a.indexOf("page:")?"data-item-id":"data-item-key"}function v(a,b,c,d){c=c?c:0===a.indexOf("~")?"content-type-personalspacedesc":"content-type-spacedesc";return m("space",a,b,"",c,d)}function C(a){var b=H[a];return m("space-cat",a,b,"",
"content-type-space-category",b)}function D(a){var b=I[a];return m("content-function",a,b,"","content-type-page",b)}function w(a,b,c,d,e){return m("page",a,b,c,d,e)}function m(a,b,c,d,e,g){return{id:J(a,b),text:c?c:b,subText:d,className:g?e:e+" content-not-found",disabled:g?!1:!0}}function J(){return Array.prototype.slice.apply(arguments).join(":")}function K(a){return(!a.contentType||0===a.contentType.length||0<=a.contentType.indexOf("space"))&&!1!==a.showRecentlyViewedSpaces}function L(a){return(!a.contentType||
0===a.contentType.length||0<=a.contentType.indexOf("page"))&&!1!==a.showRecentlyViewedPages}function M(a,b){b=u("SpaceCat",a,b.inputSpaceCatId,b.inputSpaceCatName?b.inputSpaceCatName:b.inputSpaceCatId);return h(a,b.id,b.name)}function N(a,b){var c=b.inputContentFunctionId||"legacy-macro-param-content-funcs";b=u("ContentFunction",a,c,b.inputContentFunctionName||c);return h(a,b.id,b.name)}function O(a,b){b=u("Space",a,b.inputSpaceId,b.inputSpaceName?b.inputSpaceName:b.inputSpaceId);return h(a,b.id,
b.name)}function P(a,b){b=u("Page",a,b.inputPageId,b.inputPageName?b.inputPageName:b.inputPageId);return h(a,b.id,b.name)}function u(a,b,c,d){if(!c){var e=b.attr("id");if(!e)return null;c=e+a}d||(d=(b.attr("name")||e)+a);return{id:c,name:d}}function h(a,b,c){var d=f("#"+b);0===d.length&&(d=f(F.Components().hiddenField({id:b,name:c})),a.after(d));return d}function k(a,b,c){a&&(b=e.filter(b,function(a){return 0===a.indexOf(c)}),b=e.map(b,function(a){return a.substring(c.length,a.length)}),a.val(b.join(",")))}
function y(a,b,c,d){c=c?e.isArray(c)?c:c.split(","):[];d=d?d.split(","):[];c=e.union(c,d);c=e.map(c,function(a){return b+a});d=(d=a.val())?d.split(","):[];c=e.union(d,c);0<c.length&&a.val(c.join(","))}function E(a,b,c){var d=b.data("select2").opts,x=d.placeholder||b.data("placeholder"),n=M(b,d),p=N(b,d),z=O(b,d),A=P(b,d);b.on("change",function(a){k(n,a.val,"space-cat:");k(p,a.val,"content-function:");k(z,a.val,"space:");k(A,a.val,"page:")});b.val("");var Q="SELECT"===b["0"].tagName?b.context.multiple:
d.multiple,m=[],q=[],r=[],u=[],t={},l=a?a.split(","):[];l=e.filter(l,function(a){a=a.split(":");if(2===a.length)return!0;(0>a.length||3<=a.length||1===a.length&&"SPACE-PAGE-TRIGGER-VALUE"!==a[0]&&a[0]!==x)&&g.debug("Error value: "+a)});a=l.join(",");b.val(a);y(b,"space-cat:",d.spaceCatKeys,n?n.val():"");y(b,"content-function:",d.pageCatKeys,p?p.val():"");y(b,"space:",d.spaceKeys,z?z.val():"");y(b,"page:",d.pageIds,A?A.val():"");l=(a=b.val())?a.split(","):[];k(n,l,"space-cat:");k(p,l,"content-function:");
k(z,l,"space:");k(A,l,"page:");if(0!==l.length){e.each(l,function(a,b){b=a.split(":");2===b.length&&(a=b[0],b=b[1],"space-cat"===a?m.push(b):"content-function"===a?r.push(b):"space"===a?q.push(b):"page"===a&&u.push(b))});e.each(m,function(a){t["space-cat:"+a]=C(a)});e.each(r,function(a){t["content-function:"+a]=D(a)});var h=[];0<q.length&&(a=f.getJSON(g.contextPath()+"/rest/prototype/1/space",{spaceKey:q}).done(function(a){var b=[];e.each(a.space,function(a){t["space:"+a.key]=v(a.key,e.escape(a.name),
null,!0);b.push(a.key)});a=e.difference(q,b);e.each(a,function(a){t["space:"+a]=v(a,a,null,!1)})}).fail(function(){g.debug("Couldn't resolve spaceKeys:",q);e.each(q,function(a){t["space:"+a]=v(a,a,null,!1)})}),h.push(a));e.each(u,function(a){var b=f.getJSON(g.contextPath()+"/rest/api/content/"+a,{expand:"space"}).done(function(a){t["page:"+a.id]=w(a.id,e.escape(a.title),e.escape(a.space.name),"content-type-page",!0)}).fail(function(){g.debug("Couldn't resolve pageId:",a);t["page:"+a]=w(a,a,"",
"content-type-page",!1)});h.push(b)});f.when.apply(f,e.map(h,function(a){var b=new f.Deferred;a.always(function(){b.resolve()});return b.promise()})).done(function(){c(G(l,t,Q))})}}var H={conf_all:"All spaces",conf_favorites:"Favorite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces",
conf_current:"Current space"},I={"currentContent()":"Current page"},R={data:null,suggestCategories:null},S={placeholder:"Select a space or page",multiple:!0,formatInputTooShort:function(){return "Start typing to search"},formatResult:function(a,b,c){if(a.children)return b.addClass("space-page-picker-result-category"),
f.fn.select2.defaults.formatResult.apply(this,arguments);if(a.id){b.attr("title",a.text);b.addClass("space-page-picker-result-label-with-icon");var d=f("\x3cspan/\x3e").addClass(a.className+" item-text").html(f.fn.select2.defaults.formatResult.apply(this,arguments)),e=a.subText?f("\x3cspan/\x3e").addClass("space-name").html(a.subText):f("");d=f("\x3cspan/\x3e").attr(B(a.id),a.id).append(d).append(e);return f("\x3cspan/\x3e").append(d)}b.addClass(a.className);return f.fn.select2.defaults.formatResult.apply(this,
arguments)},formatSelection:function(a,b){b.addClass("space-page-picker-selected-item");b.attr("title",a.text);var c=f("\x3cspan/\x3e").attr(B(a.id),a.id).addClass(a.className+" item-text").text(f.fn.select2.defaults.formatSelection.apply(this,arguments));b.append(c)},escapeMarkup:function(a){return a},formatResultCssClass:function(a){return a.children||a.id?"":"select2-result-space-page-separator"},containerCssClass:"space-page-picker-container",dropdownCssClass:"space-page-picker-drop"},T=function(a,
b){!0!==a.data("select2").opts.manualInit&&E(a.val(),a,b)},U=function(a){var b;if(a.suggestCategories)var c={text:"Suggested categories",children:e.map(a.suggestCategories,function(a){return C(a)})};if(a.suggestedContentFunctions)var d=e.map(a.suggestedContentFunctions,function(a){return D(a)});return function(x){if(b)x.callback(b);else{var n=[];b={results:[]};if(K(a)){var p=f.getJSON(g.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(a){var d=
c?[c]:[];0<a.length&&d.push({text:"Suggested spaces",children:e.map(a,function(a){return v(a.key,e.escape(a.name),null,!0)})});0<d.length&&(b.results=b.results.concat(d))}).fail(function(){g.debug("Couldn't fetch recent spaces");var a=c?[c]:[];0<a.length&&(b.results=b.results.concat(a))});n.push(p)}L(a)&&(p=f.getJSON(g.contextPath()+"/rest/recentlyviewed/1.0/recent/pages",{noTrashedContent:!0}).done(function(a){if(0<a.length||d){var c=[];
d&&(c=c.concat(d));0<a.length&&(c=c.concat(e.map(a,function(a){return w(a.id,e.escape(a.title),e.escape(a.space),"content-type-page",!0)})));b.results.push({text:"Suggested pages",children:c})}}).fail(function(){g.debug("Couldn't fetch recent pages")}),n.push(p));f.when.apply(f,e.map(n,function(a){var b=f.Deferred();a.always(function(){b.resolve()});return b})).done(function(){0===b.results.length&&(b.results=[{text:"",children:[]}]);x.callback(b)})}}},
V=function(a){var b="";if(!a||2===a.length&&0<=a.indexOf("space")&&0<=a.indexOf("page"))b="type\x3dspacedesc\x26type\x3dpersonalspacedesc\x26type\x3dpage";else if(1===a.length&&"space"===a[0])b="type\x3dspacedesc\x26type\x3dpersonalspacedesc";else if(1===a.length&&"page"===a[0])b="type\x3dpage";else return;return window.Select2.query.ajax({url:g.contextPath()+"/rest/quicknav/1/search?"+b,data:function(a,b){return{query:a,maxPerCategory:25}},quietMillis:250,results:function(a,b){a=a.contentNameMatches;
if(1>=a.length)return{results:[]};b=[];for(var c=0;c<a.length-1;c++){for(var d=[],e=0;e<a[c].length;e++){var f=a[c][e];var h=void 0,k=f.spaceName,m=f.id,q=f.name,r=f.className;"content-type-spacedesc"===r||"content-type-personalspacedesc"===r?h=v(f.spaceKey,k,r,!0):"content-type-page"===r&&(h=w(m,q,k,r,!0));(f=h)&&d.push(f)}0<d.length&&(b=b.concat(d),b.push({id:"",text:"",subText:"",className:"",disabled:!0}))}return{results:[{text:"Search results",
children:b}]}}})},W=function(a){var b=V(a.contentType),c=U(a);return function(a){2>a.term.length?c(a):b(a)}};return{build:function(a){var b=e.extend({},R,S,a);a.data||(b=e.extend({},{initSelection:T,query:W(b)},b));a=f(b.orgElement);if(!a||1!==a.length)return b;a.val()||b.manualInit||a.val("SPACE-PAGE-TRIGGER-VALUE");a.addClass("select2-input");return b},setValue:function(a,b){E(a,b,function(a){b.auiSelect2("data",a)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/internal/space-page-picker-legacy.js' */
window.Confluence.UI.Components.SpacePagePicker=require("confluence-ui-components/js/space-page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/space-page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
define("confluence-ui-components/js/page-picker",["ajs","confluence-ui-components/js/space-page-picker"],function(b,c){return{build:function(a){a.placeholder="Select a page";a.contentType=["page"];a.showRecentlyViewedSpaces=!1;a.spaceCatKeys=[];a.spaceKeys=[];return c.build(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/internal/page-picker-legacy.js' */
window.Confluence.UI.Components.PagePicker=require("confluence-ui-components/js/page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.PagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define("confluence-ui-components/js/label-picker",["ajs","confluence-ui-components/js/internal/soy-templates","jquery","underscore"],function(c,e,f,d){function l(a){return{id:a.name,text:a.name}}function g(a){if(!a||!a.length)return null;a=d.map(a,l);return d.sortBy(a,function(a){return a.text.toLowerCase()})}function h(a){return function(b){return f.extend({query:b,ignoreRelated:!0,maxResults:10},a)}}var k=/[;,\.\?&\[\(\)#\^\*@!<>\]]/g,m={placeholder:"Add labels",
multiple:!0,minimumInputLength:1,maximumSelectionSize:20,tokenSeparators:[" ",","],formatInputTooShort:function(a,b){return "Start typing to search for a label"},formatSelectionTooBig:function(a){return c.format("You can only input {0} labels",a)},formatResult:function(a){return e.LabelPicker().labelResult({label:{labelName:a.text,isNew:a.isNew}})},formatNoMatches:function(a){var b=d.uniq(a.match(k)).join(" ");return b?e.LabelPicker().labelInvalid({inputValue:a,
invalidCharacters:b}):this.noMatches},createSearchChoice:function(a){return!a||d.uniq(a.match(k)).join(" ")?null:{id:a,text:a,isNew:!0}},ajax:{data:h(),dataType:"json",url:c.contextPath()+"/labels/autocompletelabel.action",results:function(a){var b=a.contentNameMatches;a=g(b[0]);b=g(b[1]);a=a&&b?[{text:"Suggested",children:a},{text:"Other",children:b}]:a||b||[];return{results:a}},quietMillis:300},
dropdownCssClass:"labels-dropdown",containerCssClass:"labels-autocomplete",initSelection:function(a,b){a=a.val().split(",");a=d.map(a,function(a){return{id:a,text:a}});b(a)}};return{build:function(a){var b=f.extend({},m,a);a&&a.queryOpts&&(b.ajax.data=h(a.queryOpts),delete b.queryOpts);a&&a.noMatches||(b.noMatches=b.placeholder);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/internal/label-picker-legacy.js' */
window.Confluence.UI.Components.LabelPicker=require("confluence-ui-components/js/label-picker");AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker,"build",{sinceVersion:"1.4.18",extraInfo:"Use require('confluence-ui-components/js/label-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - add a new label',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format('{0} contains invalid characters {1}',inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,e){function g(a){var b=a.charAt(0);e.contains(["-"],b)?(c=b,a=a.substring(1)):c="";return a}function f(a){a=d.extend({},a);a.children?a.children=e.map(a.children,f):(a.id=c+a.id,a.text=c+a.text);return a}function h(a){return function(b){b=g(b);return a(b)}}function k(a){return function(b){b=a?a(b):b;c&&(b.results=e.map(b.results,f));return b}}function l(a){return function(b){return a(b,g,f)}}function m(a){if("-"===
a.text.charAt(0))return"select2-search-choice-subtle"}var c="";return{build:function(a){a=d.extend({formatSelectionCssClass:m},a);a.query?a.query=l(a.query):(a.ajax=d.extend({},a.ajax),a.ajax.data=h(a.ajax.data),a.ajax.results=k(a.ajax.results));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define("confluence-ui-components/js/user-group-select2",["ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(c,f,d){return{bind:function(e){e=e||document.body;var l=function(){var b=d(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+c.escapeHtml("No matches found")+"\x3c/li\x3e")};d("input.autocomplete-multiusergroup[data-autocomplete-bound !\x3d 'true']",
e).each(function(){var b=d(this);b.attr("data-autocomplete-bound","true");var e=b.attr("data-include-groups");b.auiSelect2({multiple:!0,minimumInputLength:2,formatInputTooShort:function(){return e?"Start typing to search for a user or group":"Start typing to search for a user"},ajax:{transport:function(a){var c=a.success;delete a.success;return d.ajax.apply(d.ajax,arguments).done(c).done(l)},data:function(a){return{"max-results":6,
query:a}},dataType:"json",url:c.contextPath()+"/rest/prototype/1/search/user"+(e?"-or-group":"")+".json",results:function(a){var b=[];d.each(a.result,function(){"user"===this.type?b.push({id:this.username,text:`${this.title} (${this.username})`,imgSrc:this.thumbnailLink.href,entity:this}):b.push({id:this.name,text:this.name,imgSrc:c.contextPath()+"/images/icons/avatar_group_48.png",entity:this})});return{results:b}},quietMillis:300},formatResult:function(a){return f.UserGroupSelect2().avatarWithName({size:"small",
displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return f.UserGroupSelect2().avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var g=c.Meta.get("remote-user"),h=c.Meta.get("current-user-fullname"),k=c.Meta.get("current-user-avatar-uri-reference");g&&h&&k&&b.auiSelect2("data",
[{id:g,text:h,imgSrc:k}])}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/soy/user-group-select2.soy' */
// This file was automatically generated from user-group-select2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserGroupSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserGroupSelect2 == 'undefined') { Confluence.UI.Components.UserGroupSelect2 = {}; }


Confluence.UI.Components.UserGroupSelect2.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserGroupSelect2.avatarWithName.soyTemplateName = 'Confluence.UI.Components.UserGroupSelect2.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Remove filter') + '"></span>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Add a filter') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a href="#" role="button" data-value="">' + soy.$$escapeHtml('Any date') + '</a></li role="button"><li><a href="#" role="button" data-value="now(\'-1d\')">' + soy.$$escapeHtml('Last 24 hours') + '</a></li><li><a href="#" role="button" data-value="now(\'-1w\')">' + soy.$$escapeHtml('Last week') + '</a></li><li><a href="#" role="button" data-value="now(\'-1M\')">' + soy.$$escapeHtml('Last month') + '</a></li><li><a href="#" role="button" data-value="now(\'-1y\')">' + soy.$$escapeHtml('Last year') + '</a></li><li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a href="#" role="button" data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">Search archived spaces</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-soy-templates.js' */
define("confluence-ui-components/js/cql/internal/cql-soy-templates",[],function(){return{CQL:function(){return Confluence.UI.Components.CQL.Templates},Filters:function(){return Confluence.UI.Components.CQLFilters.Templates},FilterSelect:function(){return Confluence.UI.Components.CQL.FilterSelect.Templates},SpaceField:function(){return Confluence.UI.Components.CQL.SpaceField.templates},TypePicker:function(){return Confluence.UI.Components.CQL.TypePicker.templates}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(b){function d(a){return"search-screen"===a?b.omit(c,"conf_current"):c}var c={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"},e=b.invert(c);return{getMap:d,getKeys:function(a){return b.keys(d(a))},getUIValue:function(a){return e[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(b,d,e){var c;return{getFields:function(){c||(c=b.Deferred(),b.getJSON(e.contextPath()+"/rest/cql/fields?filter\x3dwithUiSupport").done(function(a){a=d.values(a);if(!a.length)throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");a=d.union.apply(d,a);a=d.sortBy(a,"fieldName");c.resolve(a)}).fail(function(){c.reject()}));return c.promise()},parseClauses:function(a){return b.getJSON(e.contextPath()+
"/rest/cql/expressions?cql\x3d"+encodeURIComponent(a))},getTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dall")},getContentTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dcontent")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery","confluence-ui-components/js/internal/soy-templates"],function(b,g,m){return{build:function(n){var c=g(m.DatePicker().input()),d=c.find(".aui-nav li"),h=c.find(".absolute-date-pickers").hide(),e=c.find(".from-date-picker"),f=c.find(".to-date-picker"),k=function(){};this.onChange=function(a){k=a;e.change(a);f.change(a)};c.on("click",".aui-nav a",function(a){a.preventDefault();a=d.filter("li.aui-nav-selected");var b=g(this).closest("li");
a[0]!==b[0]&&(d.not(b).removeClass("aui-nav-selected"),b.addClass("aui-nav-selected"),k());"custom"===g(this).data("value")?h.slideDown("fast"):h.slideUp("fast")});var l={overrideBrowserDefault:!0};b.DatePicker(e,l);b.DatePicker(f,l);e.attr("placeholder","From");e.attr("aria-label","From");f.attr("placeholder","To");f.attr("aria-label",
"To");n.replaceWith(c);return{getSelectedOption:function(){return d.filter(".aui-nav-selected").find("a").data("value")},selectOption:function(a){d.find('a[data-value\x3d"'+a+'"]').click()},getFromDate:function(){return e.val()},getToDate:function(){return f.val()},setFromDate:function(a){e.val(a);d.find("a[data-value\x3d'custom']").click()},setToDate:function(a){f.val(a);d.find("a[data-value\x3d'custom']").click()}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/include-exclude-picker".split(" "),function(m,c,n,p,r,t,u){function v(a){g=c.map(a,function(a){return{id:a.type,text:a.label}})}function q(a,e){return 0===a.length?"":1===a.length&&c.contains(c.pluck(e,"type"),a[0])?
a[0]:"custom"}var e,g=[];return{build:function(a,w){var f,h,k,l=[];e||(e=w?p.getContentTypes():p.getTypes(),e.done(v));e.done(function(){if(a.length){var b=c.pluck(g,"id");l=[].concat(g);a.forEach(function(d){""===d.type||c.contains(b,d.type)||l.push({id:d.type,text:d.label})})}else l=g});var x={query:function(b,d,a){e.done(function(){d(b.term);window.Select2.query.local({results:c.map(l,a)})(b)})},initSelection:function(a,d){a=a.val().split(",");var b="",f=c.map(a,function(a){return"-"===a.charAt(0)?
(b="-",a.substring(1)):a});e.done(function(){var a=c.filter(l,function(a){return c.contains(f,a.id)});d(c.map(a,function(a){return{id:b+a.id,text:b+a.text}}))})},multiple:!0,placeholder:"All content types"};return{setupInput:function(b){f=b;if(n.trace)f.on("change",function(){n.trace("type.field.changed")});a.length&&(b=m(t.TypePicker().suggestions({types:a})),h=b.find(".aui-nav li"),f.before(b),b.on("click",".aui-nav a",function(a){a.preventDefault();
a=m(this).closest("li");var b=h.filter(".aui-nav-selected");a[0]!==b[0]&&(b.removeClass("aui-nav-selected"),a.addClass("aui-nav-selected"),a=m(this).attr("data-value"),"custom"===a?k.slideDown("fast"):k.hide(),f.select2("val",[a],!0))}));f.auiSelect2(u.build(x));a.length&&(k=f.closest(".cql-filter").find(".select2-container"),k.hide())},setValues:function(b){if(h){var d=q(b,a),c=h.find('[data-value\x3d"'+d+'"]').parent();h.not(c).removeClass("aui-nav-selected");c.addClass("aui-nav-selected");"custom"===
d&&k.show()}var g=m.Deferred();e.done(function(){r.setValues(f,b).done(function(){g.resolve()})});return g}}},_clearCache:function(){e=null;g=[]},_getPicklistKey:q}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){return{getLabel:function(a){return a.uiSupport.label.translation}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(d,e){return{convertFunctionValues:function(a){var b=a.functionValues;if(!b||!b.length)return a;var c=[];d.each(b,function(a){if("currentSpace"===a.functionName)c.push(e.getUIValue("currentSpace()"));else throw Error(a.functionName+" is not a known function");});a.values=c.concat(a.values);return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,b,k,l){function e(a){return{query:a,searchContext:JSON.stringify({spaceKey:b.Meta.get("space-key"),contentId:b.Meta.get("content-id")})}}function f(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")?a:b.contextPath()+a}var h={placeholder:"Start typing to search",
multiple:!0,tokenSeparators:[" ",","],createSearchChoice:function(a){return a?{id:a,text:"New result: "+a,isNew:!0}:null},createSearchChoicePosition:"bottom",ajax:{data:e,results:function(a){var c=a.suggestedResults;a=a.searchResults;c=c.length?a.length?[{text:"Suggestions",children:c},{text:"Search results",children:a}]:c:a;return{results:c}},quietMillis:300},initSelection:function(a,
c){a=a.val().split(",").map(function(a){return{id:a,text:a}});c(a)}};return{build:function(a){var c;return{setupInput:function(g){c=g;var b=d.extend({},h.ajax,{url:f(a.uiSupport.dataUri)});b=d.extend({},h,{ajax:b});g.auiSelect2(b)},asCqlFunc:function(){var a=this.input.val().trim();if(a)return k.buildEqualityExpressionFromValuesString(this.fieldName,a)},setValues:function(a){return l.setValues(c,a.values)}}},_getUrl:f,_ajaxData:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(k,d,e,f){function g(b){return"page:"+b}function h(b){return"content-function:"+b.functionName+"()"}function c(b){return b.values.map(g).concat(b.functionValues.map(h))}return{build:function(){var b;return{setupInput:function(a){b=
a;a.auiSelect2(d.build({multiple:"parent"!==this.fieldName,suggestedContentFunctions:["currentContent()"]}))},asCqlFunc:function(){var a=this.input.val().trim();if(a)return a=a.replace(/[a-z\-]+:/g,""),e.buildEqualityExpressionFromValuesString(this.fieldName,a)},_addValuePrefixes:c,setValues:function(a){a=c(a);return f.setValues(b,a)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(a){var b=[{type:"",label:"All content"},{type:"page",label:"Pages"},{type:"blogpost",label:"Blog Posts"},{type:"attachment",label:"Attachments"},{type:"space",
label:"Spaces"}];return{getList:function(){return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence/dark-features","confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(f,g,h){return{build:function(k){var a;return{setupInput:function(b,c){var d=[],e=!0;if("search-screen"===c.environment&&"all"===c.searchType||f.isEnabled("cql.force.full.search.mode"))d=h.getList(),e=!1;a=g.build(d,e);a.setupInput(b)},setValues:function(b){return a.setValues(b.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(d,h,k){return{build:function(l){var f=l.fieldName,b;return{setupInput:function(a){b=k.build.call(this,a)},setValues:function(a){b?(a=a.expressions,1>a.length||2<a.length?d.warn("Can't set date value with expressions.length: "+a.length):1===a.length&&1===a[0].functionValues.length&&"now"===a[0].functionValues[0].functionName?"\x3e\x3d"!==
a[0].operator?d.warn("Unsupported date picker relative date operator: "+a[0].operator):b.selectOption("now('"+a[0].functionValues[0].parameters[0]+"')"):h.each(a,function(a){if(1===a.values.length){var c=a.values[0];"\x3e\x3d"===a.operator?b.setFromDate(c):"\x3c\x3d"===a.operator&&b.setToDate(c)}})):d.warn("DatePicker not set yet, can't set values")},asCqlFunc:function(){if(b){var a=b.getSelectedOption();if(!a)return"";if("custom"===a){a=b.getFromDate();var g=b.getToDate(),c,e;a&&(c=f+' \x3e\x3d "'+
a+'"');g&&(e=f+' \x3c\x3d "'+g+'"');return c&&e?c+" and "+e:c||e||""}return f+" \x3e\x3d "+a}d.warn("DatePicker not set yet, can't get CQL")}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field",["jquery","ajs","confluence-ui-components/js/label-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,e,f,g,h){return{build:function(){var c;return{setupInput:function(a,b){c=a;b=d.extend({},b.select2CustomOptions,{noMatches:"No matching labels found"});a.auiSelect2(g.build(f.build(b)))},
setValues:function(a){return h.setValues(c,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","jquery confluence-ui-components/js/space-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-special-spaces confluence-ui-components/js/cql/internal/cql-space-expression-adjuster confluence-ui-components/js/cql/internal/cql-space-expression-builder confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(e,f,g,h,k,l,m,n){return{build:function(){var b;return{setupInput:function(a,c){b=a;a.auiSelect2(g.build(f.build({multiple:!0,suggestCategories:h.getKeys(c.environment),disableMixedSpaceTypes:!0})));if("search-screen"===c.environment){var d=e(n.SpaceField().archivedSpacesOption());b.after(d);this.onChange=function(a){d.find("#search-filter-include-archived").change(a);b.change(a)}}},asCqlFunc:function(){return l.buildExpressionFromValuesString(this.input.val())},setValues:function(a){k.convertFunctionValues(a);
return m.setValues(b,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(b,e,f){return{build:function(){function g(a){a=a[0].result[0];return{id:a.username,text:a.title,imgSrc:a.thumbnailLink.href}}var c;return{setupInput:function(a){c=a;a.addClass("select2-input autocomplete-multiusergroup");f.bind(a.parent())},setValues:function(a){if((a=a.values)&&a[0]){var d=a.map(function(a){return b.getJSON(e.contextPath()+
"/rest/prototype/1/search/user.json?query\x3d"+encodeURI(a))});return b.when.apply(b,d).done(function(){var a=(1<d.length?arguments:[arguments]).map(g);c.auiSelect2("data",a)})}}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs","confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field".split(" "),
function(d,e,f,g,h,k,l){var c={contentId:e,contentType:f,date:g,label:h,space:k,user:l};return{getConfig:function(a){var b=a.uiSupport;return b.dataUri?d.build(a):c[b.valueType]?c[b.valueType].build(a):{}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-expression-builder confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(e,f,q,g,h,k,l){function m(b){var d=g.getLabel(b);d=e(n().baseFilterField({label:d,field:b,counter:p++}));var c=d.find("input");d.data("fieldName",
b.fieldName);return e.extend({input:c,element:d,onChange:function(a){c.change(a)}},b)}var n=l.Filters,p=0;return{build:function(b,d){var c=b.fieldName;if(!b.uiSupport.valueType)throw Error("Can't create filter without valueType.");if(!c)throw Error("Can't create filter without fieldName.");c=k.getConfig(b);var a=m(b);a.asCql=f.bind(c.asCqlFunc||function(){return h.buildExpression(a,this.input.val())},a);var e=a.element.find("input");"function"===typeof c.setupInput&&(a.setupInput=c.setupInput,a.setupInput(e,
d.context));a.setValues=c.setValues||function(a){e.val(a.values.join(","))};a.element.find(".aui-iconfont-remove").click(function(){a.element.remove();d.removeField(a)});return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(h,c,b,r,k,l){var t=l.FilterSelect;return{build:function(f){function l(a){a.added&&(g.auiSelect2("val",""),n(a.added),b.debug("CQL Field selection made"),m.addClass("hidden"),d.show())}var p=f.cqlContainer,q=p.find(".cql-fields"),
n=f.onSelection;if(!n)throw Error("An onSelection callback must be provided to the FilterSelect.");var e=h(t().container()),d=e.children("button"),m=e.find(".input-wrapper"),g=e.find("input");d.click(function(a){a.preventDefault();m.removeClass("hidden");d.hide();e.find(".select2-choice").mousedown()});g.bind("select2-close",function(){b.debug("CQL Field selector closed");m.addClass("hidden");d.show();setTimeout(function(){b.log("Checking CQL Field selector focus");h(document.activeElement).closest(".cql-filter").length||
(b.debug("Setting CQL Field selector focus"),d.focus())},1)});p.append(e);r.getFields().done(function(a){"search-screen"===f.context.environment||b.DarkFeatures.isEnabled("cql.search.screen")||(a=c.reject(a,function(a){return"date"===a.type}));a=c.reject(a,function(a){return c.contains(f.ignoredFields,a.fieldName)});g.auiSelect2({id:"fieldName",data:function(){if(!q[0])throw Error("Why no cql-container?");var b=q.find(".cql-filter").map(function(){return h(this).data("fieldName")});return{results:c.reject(a,
function(a){return c.contains(b,a.fieldName)&&!c.contains(["label"],a.fieldName)}),text:k.getLabel}},formatResult:k.getLabel,formatSelection:k.getLabel,placeholder:"Add a filter"}).change(l)}).fail(function(){b.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")});return g}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(k,d,e,f){return{buildExpressionFromValuesString:function(a){if(a=a.trim()){a=a.split(",");var g=e.getKeys(),c=[],b=[];d.each(a,function(a){"conf_current"===a?c.push("currentSpace()"):d.contains(g,a)?b.push(a):c.push(a)});a=[];if(b.length){var h=e.getMap();b=d.map(b,
function(a){return h[a]});a.push(f.buildEqualityExpressionFromValuesArray("space.type",b))}c.length&&a.push(f.buildEqualityExpressionFromValuesArray("space",c));return 1===a.length?a[0]:"("+a.join(" or ")+")"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(p,c){function e(b){return c.contains(["currentContent()","currentSpace()"],b)?b:'"'+b.replace(/"/g,'\\"')+'"'}function f(b){var a={"+":[],"-":[],"":[]};c.each(b,function(b){var d=b.charAt(0);"+"===d?a["+"].push(b.substring(1)):"-"===d?a["-"].push(b.substring(1)):a[""].push(b)});return a}function g(b,a){return c.map(a,function(a){return b+" \x3d "+e(a)}).join(" AND ")}function h(b,a,d){if(0===
a.length)return"";a=c.map(a,e);if(1===a.length)return b+(d?" \x3d ":" !\x3d ")+a[0];a=a.join(",");return b+(d?" in ":" not in ")+"("+a+")"}function k(b,a){return h(b,a,!1)}function l(b,a){return h(b,a,!0)}function m(b,a){var d=f(a);a=[];var c=g(b,d["+"]);c&&a.push(c);(c=l(b,d[""]))&&a.push(c);(b=k(b,d["-"]))&&a.push(b);return a.join(" AND ")}function n(b,a){if(a=a.trim())return a=a.split(","),a=c.map(a,function(a){return a.trim()}),m(b,a)}return{buildExpression:function(b,a){if("equality"===b.type)return n(b.fieldName,
a);if("text"===b.type)return b=b.fieldName,a=(a=a.trim())?b+" ~ "+e(a):void 0,a;throw Error("buildExpression does not yet support type: "+b.type);},buildEqualityExpressionFromValuesString:n,buildEqualityExpressionFromValuesArray:m,makeValueMap:f,makePlusCql:g,makeMinusCql:k,makeRegularCql:l}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,d){return{convert:function(c,a){a=b.clone(a);var e=b.map(c.values,d.getUIValue);return{field:a,values:e,negate:c.negate}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(d,g){function f(a,b){a.values=a.values.concat(b.values);return a}return{aggregate:function(a,b){var c=d.filter(a,function(a){return"space.type"===a.field.fieldName});if(0===c.length)return a;if(1<c.length)throw Error("Only a single space.type expression is supported.");b=g.convert(c[0],b);var e=d.filter(a,function(a){return"space"===
a.field.fieldName});a=d.difference(a,c);e.length?e[0]=f(e[0],b):a.push(b);return a},combineSpaceExpressions:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(c){return{setValues:function(a,d){var b=c.Deferred();a.on("change",function(){b.resolve()});a.select2("val",d,!0);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(f){return{aggregate:function(e){var b=[],c={};e.forEach(function(a){var d=a.field.fieldName;"date"!==a.field.type?b.push(a):c[d]?c[d].expressions.push(a):(a={field:a.field,expressions:[a]},c[d]=a,b.push(a))});return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["jquery","underscore"],function(c,d){function b(a){a.values=d.map(a.values,function(a){return"-"+a})}return{convert:function(a){a=c.extend({},a);"equality"===a.field.type&&("!\x3d"===a.operator?(a.operator="\x3d",b(a)):"notin"===a.operator&&(a.operator="in",b(a)));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(e,k){function l(c,a){if(!a.length)return c;var b=c[0];b||(b=a[0],a=e.rest(a));a.forEach(function(a){b.values=b.values.concat(a.values)});"\x3d"===b.operator&&1<b.values.length&&(b.operator="in");return[b].concat(e.rest(c))}return{aggregate:function(c){var a=[],b={},f={};c.forEach(function(g){var d=g.field.fieldName;e.contains(a,d)||(a.push(d),
b[d]=[],f[d]=[]);var c=k.convert(g);c.operator!==g.operator?f[d].push(c):b[d].push(c)});var h=[];a.forEach(function(a){a=l(b[a],f[a]);h=h.concat(a)});return h}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function c(a,b,c){b&&(a=a.filter(function(a){return-1<b.indexOf(a.field.fieldName)?c:!c}));return a}return{removeFieldsByName:function(a,b){return c(a,b,!1)},getFieldsByName:function(a,b){return c(a,b,!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-filter-field confluence-ui-components/js/cql/internal/cql-filter-select confluence-ui-components/js/cql/internal/cql-space-expression-aggregator confluence-ui-components/js/cql/internal/cql-date-expression-aggregator confluence-ui-components/js/cql/internal/cql-negation-aggregator confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(d,h,f,r,C,D,E,F,G,t,k){function H(c){var d=[];h.each(c,function(c){c.forEach(function(c){c&&(c=c.asCql())&&d.push(c)})});return d.join(" and ")}function v(c,d){return h.find(c,function(c){return c.fieldName===d})}var I=k.CQL;return{build:function(c){function m(a){var b=C.build(a,w);b.onChange(x);a=a.fieldName;e[a]=e[a]||[];e[a].push(b);g.trigger("cql-field-adding",b);a=y.find(".cql-field-"+a+":last");a.length?a.after(b.element):y.append(b.element);return b}function k(a){var b=d.Deferred();
if(!a)return b.resolve(),b;var f={},g=h.findWhere(l,{fieldName:"space"});a=E.aggregate(a,g);a=F.aggregate(a);a=G.aggregate(a);z=t.getFieldsByName(a,c.ignoredFields);a=t.removeFieldsByName(a,c.ignoredFields);var k=[];h.each(a,function(a){var b=a.field.fieldName,c=v(l,b),d=f[b];f[b]="number"===typeof d?d+1:0;b=f[b];d=c.fieldName;(a=(e[d]&&e[d][b||0]||m(c)).setValues(a))&&k.push(a)});d.when.apply(d,k).then(function(){b.resolve()});return b}function u(a){if(a){var b=h.escape(a);a="We can\u0027t load your filters";
b=f.format("Curses! We had trouble with \u0022{0}\u0022. Try refreshing the page, but you may need to re-enter your macro parameters.",b)}else a="We couldn\u0027t load the macro",b="If you refresh your page, we\u0027ll give it another shot.";f.messages.error(".cql-error-container",{title:a,body:b,closeable:!0})}function J(a){a=d.extend({},a,{fixed:!1});a=m(a);if(0===a.element.find(".aui-nav-selected").length)if(0!==a.element.find(".select2-container-multi").length){var b=a.element.find("input.select2-input");
b.focus().click()}else b=a.element.find("a.select2-choice.select2-default"),b.length||(b=d(":input:visible",a.element).first()),b.length||f.log("Unable to focus CQL field: "+a.fieldName),b.focus().mousedown()}var A=c.context||{environment:"macro-browser"},n=c.defaultFieldNames;n||(n=c.defaultFields?c.defaultFields.split(","):[]);var g=d(I().container());c.container&&d(c.container).append(g);var y=g.find(".cql-fields"),B=c.value||c.defaultValue;if(B)var p=r.parseClauses(B);else p=new d.Deferred,p.resolve();
var e={},z={},q=new d.Deferred,x=c.onChange||function(){},w={element:g,loading:q,context:c.context||{environment:"macro-browser",searchType:"content",select2CustomOptions:c.select2CustomOptions||{}},getValue:function(){return H(e)},getIgnoredFields:function(){return z},removeField:function(a){var b=a.fieldName;e[b]=h.without(e[b],a);0===e[b].length&&(delete e[b],x())},fieldArrays:e,fieldRegistry:e},l;r.getFields().done(function(a){l=a;n.forEach(function(a){var b=v(l,a);if(!b)throw Error("Unknown fieldname: "+
a);a=d.extend({fixed:!0},b);m(a)});D.build({onSelection:J,cqlContainer:g,context:A,ignoredFields:c.ignoredFields});p.done(function(a){k(a).done(function(){q.resolve()})}).fail(function(){"search-screen"===A.environment?f.log("Error parsing CQL param from search screen URL: "+c.value):u(c.value);q.resolve()})}).fail(function(){u()});return w}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/user-multiselect.js' */
Confluence.Binder.autocompleteMultiUser=function(c){c=c||document.body;var d=AJS.$,g=function(){var b=d(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+AJS.escapeHtml("No matches found")+"\x3c/li\x3e")};d("input.autocomplete-multiuser[data-autocomplete-bound !\x3d 'true']",c).each(function(){var b=d(this);b.auiSelect2({multiple:!0,minimumInputLength:2,
formatInputTooShort:function(){return "Start typing to search for a user"},ajax:{transport:function(a){var b=a.success;delete a.success;return d.ajax.apply(d.ajax,arguments).done(b).done(g)},data:function(a){return{"max-results":6,query:a}},dataType:"json",url:Confluence.getContextPath()+"/rest/prototype/1/search/user.json",results:function(a){var b=[];d.each(a.result,function(){b.push({id:this.username,userKey:this.userKey,text:this.title,imgSrc:this.thumbnailLink.href})});
return{results:b}},quietMillis:300},formatResult:function(a){return CreateContent.avatar.avatarWithName({size:"small",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return CreateContent.avatar.avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var c=AJS.Meta.get("remote-user"),
h=AJS.Meta.get("remote-user-key"),e=AJS.Meta.get("current-user-fullname"),f=AJS.Meta.get("current-user-avatar-url");c&&e&&f&&b.auiSelect2("data",[{id:c,userKey:h,text:e,imgSrc:AJS.contextPath()+f}])}})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function e(d){return d.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")}return{serialize:function(d){var a=[],b;for(b in d)a.push(e(b)+"="+e(d[b]));return a.join("|")},deserialize:function(d){function a(f,d){for(var c=[],b=[],a,f=f||"",g=0,e=f.length;g<e;g++)a=f[g],"\\"==a?c.push(a+(g+1!=f.length?f[++g]:"")):a==d?(b.push(c.join("")),c=[]):c.push(a);b.push(c.join(""));return b}var b={};h.each(a(d||"",
"|"),function(d,e){var c=a(e,"=");2===c.length&&c[0]&&(b[c[0].replace(/\\(.)/g,"$1")]=c[1].replace(/\\(.)/g,"$1"))});return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields",["ajs","jquery","underscore","confluence/legacy"],function(g,e,o,i){function n(j,h,l){return function(k,b){if(k.multiple)return j.string(k,b);var a=e(i.Templates.MacroBrowser.macroParameterSelect()),c=e("select",a),b=b||{};b.setValue=b.setValue||function(a){var b=!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(e("<option></option>").attr("value",a).text(a+" ("+"Not found"+
")")),c.tempValue=a);try{c.val(a)}catch(m){g.logError(m)}c.change()};a=h(a,c,b);a.updateDependencies=l;a.getData=function(a){if(a.title&&a.spaceKey||a.pageId||a.draftId){var f=c.tempValue||c.val();b.fileTypes&&(a.fileTypes=b.fileTypes);var m=g.contextPath()+(a.draftId?"/json/draftattachmentsearch.action":"/json/attachmentsearch.action");e.getJSON(m,a,function(a){if(!a.error){e("option",c).remove();a=a.attachments;if(!a||!a.length){c.append(e("<option></option>").attr("value","").html("No appropriate attachments"));
c.tempValue&&b.setValue(c.tempValue)}else{for(var d=0,m=a.length;d<m;d++)c.append(e("<option></option>").attr("value",a[d].name).text(a[d].name));f=f||c.tempValue;b.setValue(f||a[0].name)}c.attr("style","")}})}else g.log("Not enough parameters to send attachmentsearch request")};return a}}return function(j){var h=function(b,a,c){var c=c||{},d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||j.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},
l=function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)j.fields[a[d]]&&j.fields[a[d]].dependencyUpdated(b,c)},k={updateDependencies:l,username:function(b,a){var a=a||{},c=b.multiple?"autocomplete-multiuser":"autocomplete-user",d=e(i.Templates.MacroBrowser.macroParameter()),f=e("input[type='text']",d);f.addClass(c).attr("data-none-message","Not found");b.required&&f.keyup(j.processRequiredParameters);b.multiple?(i.Binder.autocompleteMultiUser(d),a.setValue=
function(a){f.val(a);for(var a=a.split(","),b=[],c=[],d=0,h=a.length;d<h;d++)b.push(function(a){return e.getJSON(g.contextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&c.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(b){g.logError("Cannot parse user data for macro browser field with: "+b);c.push({id:a,text:g.format("Unknown User ({0})",a),imgSrc:g.contextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,o.map(b,function(a){var b=
e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){c.length&&f.auiSelect2("data",c)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(l(b.name,a.dependencies,f.val()),"function"===typeof a.onchange&&a.onchange.apply(f))}),g.Confluence.Binder.autocompleteUserOrGroup(d));return h(d,f,a)},spacekey:function(b,a){if(b.multiple)return k.string(b,a);var a=a||{},c=e(i.Templates.MacroBrowser.macroParameter()),
d=e("input[type='text']",c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&d.keyup(j.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(l(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});g.Confluence.Binder.autocompleteSpace(c);return h(c,d)},attachment:n(k,
h,l),full_attachment:n(k,h,l),"confluence-content":function(b,a){if(b.multiple)return k.string(b,a);a=a||{};b.options=b.options||{};var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input[type='text']",c).attr("data-none-message","Not found").attr("data-template","");b.required&&d.keyup(j.processRequiredParameters);a.onchange=a.onchange||function(){var c=d.val();l(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&
a.onchange.apply(d)};d.bind("selected.autocomplete-content",function(c,e){var f="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var h=e.content.space&&e.content.space.key,i=h&&h!=g.Meta.get("space-key");-1!==e.content.title.indexOf(":")&&(i=!0);f=(i?h+":":"")+f+e.content.title;d.val(f);if(a.onselect)a.onselect(e.selection);else a.setValue(f,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&
(b.options.spaceKey=g.Meta.get("space-key")),d.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"===typeof f)if("page"==f)d.addClass("autocomplete-page"),g.Confluence.Binder.autocompletePage(c);else if("blogpost"==f)d.addClass("autocomplete-blogpost"),g.Confluence.Binder.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),g.Confluence.Binder.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),
g.Confluence.Binder.autocompleteConfluenceContent(c);return h(c,d,a)},string:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(j.processRequiredParameters);return h(c,d,a)},"boolean":function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterBoolean()),d=e("input",c),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return h(c,d,a)},"enum":function(b,a){if(b.multiple)return k.string(b,
a);var c=e(i.Templates.MacroBrowser.macroParameterSelect()),d=e("select",c);!b.required&&!b.defaultValue&&d.append(e("<option></option>").attr("value",""));e(b.enumValues).each(function(a,c){var g=c;if(b.enumToI18nKeyMapping){var h=[b.pluginKey,b.macroName,"param",b.name,this,"desc"].join(".");b.enumToI18nKeyMapping[c]!==h&&(g=b.enumToI18nKeyMapping[c])}d.append(e("<option></option>").attr("value",this).html(""+g))});return h(c,d,a)},_hidden:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterHidden()).hide(),
d=e("input",c);return h(c,d,a)}};return{Field:h,ParameterFields:k}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs","confluence/macro-js-overrides"],function(c,f){return function(h,d){var e=function(a){this.fileTypes=a};e.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+
":"+a.page);return a};e.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};e.prototype.fields={attachment:function(a){a=d.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=
function(a,g){c.debug("attachment:dependencyUpdated called: "+a+", "+g);var d=e.prototype.fields._parsePageLink(g);this.getData(d)};return a},full_attachment:function(a){a=d.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){c.debug("attachment:dependencyUpdated called: "+a+", "+d);var f=e.prototype.fields._parsePageLink(d);this.getData(f)};return a},"confluence-content":function(a){return d["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b=
{},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(c.params.newPage?b.draftId=c.Meta.get("content-id"):b.pageId=c.params.pageId);return b}};h.activateSmartFieldsAttachmentsOnPage=function(a,b){f.put(a,new e(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(i,g,m,n,d){function j(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue,select2CustomOptions:b.cqlSelect2CustomOptions})}function k(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=k(b),e=b.container;e.append(a);e.bind("cql-field-adding",
function(b,c){c.element.addClass("macro-param-div");c.element.find(".cql-field-input").addClass("macro-param-input")});e.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"Show":"Hide";
b.text(a)});var f,h={param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields"),cqlSelect2CustomOptions:b.cqlSelect2CustomOptions},h=j(h);f=n.build(h);e.data("cqlComponent",f);var l=d.Deferred();f.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");g.each(f.fieldRegistry||f.fieldArrays,function(a){var d=!1;g.each(a,function(a){!d&&g.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}e.removeClass("loading");
l.resolve()});return{elements:a,loading:l}},_makeCqlComponentOptions:j,_renderCqlSections:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<h4 class="cql-render-heading"><span>' + soy.$$escapeHtml('Options') + '</span>' + aui.buttons.button({type: 'link', text: 'Show', extraAttributes: {type: 'button'}}) + '</h4><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor","ajs jquery confluence/legacy confluence-macro-browser/macro-browser-cql confluence/macro-js-overrides underscore".split(" "),function(r,e,q,v,s,t){return function(k){function o(d){var a=e("#macro-insert-container").find(".macro-name").val(),b,c=k,f={},g;g={};for(var h=0,l=d.formDetails.parameters.length;h<l;h++){var j=d.formDetails.parameters[h],i;if(j.type&&j.type.name==="cql")i=e(".macro-input-fields form").data("cqlComponent").getValue();
else{i=e("#macro-param-"+j.name);var n=i.val();i.attr("type")=="checkbox"&&(n=""+i.prop("checked"));i=n}if(i){j.shared&&(f[j.name]=i);if(j.hidden||!j.defaultValue||j.defaultValue!=i)g[j.name]=i}}g[""]&&(b=g[""]);e.extend(g,c.unknownParams);(h=s.getFunction(a,"beforeParamsRetrieved"))&&(g=h(g,d,f));return{name:a,bodyHtml:c.getMacroBody(),params:g,defaultParameterValue:b}}function w(d,a,b){a.pluginKey=d.pluginKey;a.macroName=d.macroName;var c=k,f,g=a.type.name;if(b){var h=b.fields&&b.fields[g];h&&typeof h!==
"function"&&(h=h[a.name]);typeof h==="function"&&(f=h.call(b,a))}if(!f){g in c.ParameterFields&&typeof c.ParameterFields[g]==="function"||(g="string");f=c.ParameterFields[g](a)}c.fields[a.name]=f;b=f.paramDiv;c=f.input;f="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);c.addClass("macro-param-input").attr("id",f);a.hidden&&b.hide();c=d.pluginKey;if(a.displayName==k.Utils.makeDefaultKey(c,d.macroName,"param",a.name,"label"))a.displayName=a.name;if(a.description==k.Utils.makeDefaultKey(c,
d.macroName,"param",a.name,"desc"))a.description="";e("label",b).attr("for",f).text(a.displayName);a.required&&u(b);a.description&&b.append(q.Templates.MacroBrowser.macroParameterDesc({description:a.description}));return b}function u(d){var a=d.find("label"),b=a.text()+" *";a.text(b);d.addClass("required")}return{loadMacroInBrowser:function(d){if(!d||!d.formDetails){r.trigger("analytics",{name:"macro-browser.unknown-macro-error"});alert("Could not load unknown macro in the macro browser.")}else{var a=
require("tinymce"),b=k,c=d.formDetails,f=c.macroName,g=s.get(f),h=b.settings.selectedMacro,l=a.confluence.macrobrowser.editedMacroDiv;if(g&&typeof g.opener==="function"){b.close();g.opener({name:f})}else{var a=c.parameters,j=t.find(a,function(a){return a.type.name==="cql"});e("#save-warning-span").addClass("hidden");e("#macro-insert-container .macro-name").val(f);var i=e("#macro-insert-container .macro-input-fields form");i.empty();var n=d.extendedDescription||d.description;if(j)c.documentationLink&&
b.UI.setHelpLink(b.dialog,{href:c.documentationLink});else if(n||c.documentationLink){n=e(q.Templates.MacroBrowser.macroDescription({descriptionHtml:n,documentationLink:c.documentationLink}));i.append(n)}if(c.body&&c.body.bodyType!="NONE"&&l&&e(l).hasClass("editor-inline-macro")){l=d.pluginKey;if(c.body.label==k.Utils.makeDefaultKey(l,f,"body","label"))c.body.label="";if(c.body.description==k.Utils.makeDefaultKey(l,f,"body","desc"))c.body.description="";c=c.body;l=b.selectedMacroDefinition;n=k;f=
e(q.Templates.MacroBrowser.macroBody());l=l?l.body:n.settings.selectedText;e("textarea",f).val(l||"");c.label&&e("label",f).text(c.label);c.description&&f.append(q.Templates.MacroBrowser.macroParameterDesc({description:c.description}));c.hidden&&f.hide();f&&i.append(f)}var m=h?e.extend({},h.params):{},o=i;if(j){var p;g&&g.fields&&(p=e.extend({},g.fields.cqlSelect2CustomOptions));a=t.without(a,j);p=v.build({cqlParam:j,renderParams:a,cqlValue:m.cql,container:i,flagRequiredParam:u,paramChanged:k.paramChanged,
cqlSelect2CustomOptions:p});delete m.cql;o=p.elements.filter(".cql-render-fields");p.loading.done(function(){k.paramChanged();k.Preview.previewMacro(d,h);k.UI.focusOnMacroDetailsFirstInput()})}e(a).each(function(){o.append(w(d,this,g))});g&&typeof g.beforeParamsSet==="function"&&(m=g.beforeParamsSet(m,!h));e(a).each(function(){var a;a=this.name==""?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];a!=null?delete m[this.name]:e(this.aliases).each(function(){if(m[this]){a=
m[this];delete m[this]}});if(a==null)a=this.defaultValue;a!=null&&b.fields[this.name].setValue(a)});b.unknownParams=m;e("a",i).click(function(){var a=window.open(this.href,"_blank");a.focus();a.opener=null;return false});e("#macro-browser-dialog:visible").length||b.showBrowserDialog();a={};e.extend(true,a,d);if(!a.formDetails)a.formDetails={};if(!a.formDetails.body)a.formDetails.body={};b.dialog.activeMetadata=a;a.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:a.formDetails.body.bodyType&&
a.formDetails.body.bodyType.toLowerCase()==="plain_text"?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return o(d).params},getMacroDefinitionFromForm:o,processRequiredParameters:function(){if(e(".macro-input-fields form").is(".loading")){r.log("Form still loading - cannot processRequiredParameters");return false}var d=e("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=e(this).val();
return a===null||a===""}).length===0,a=d?"":"disabled",b=a?"addClass":"removeClass";e("#macro-browser-dialog button.ok").prop("disabled",a);e("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",a)[b]("disabled");return d}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/legacy","confluence/macro-js-overrides"],function(e,b,m,n){return function(d){function h(){return e("#macro-insert-container .macro-preview")}function l(){h().html("")}function i(b){b?(d.UI.showPreviewSpinner(!0),f.disable()):(d.UI.showPreviewSpinner(!1),f.enable())}var f={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};
return{previewMacro:function(j,g){var k=d;l();if(!d.Editor.processRequiredParameters())return b.trigger("analytics",{name:"macro-browser.missing-params-error"}),b.log("previewMacro: missing required params"),!1;"object"!==typeof g&&(g=d.Editor.getMacroDefinitionFromForm(j));var a=g.params,f=n.getFunction(j.macroName,"updateMacroParametersForPreview");f&&(a=f(a));a[""]&&delete a[""];k={contentId:m.getContentId(),macroName:j.macroName,params:a,body:k.getMacroBody(),defaultParameterValue:g.defaultParameterValue,
successCallback:function(a){var c=h().find("iframe")[0],c=c.contentDocument||c.contentWindow.document;c.write(a);c.close();e(c).ready(function(){b.trigger("macro-browser.preview-ready")});e("div.error span.error",c).length&&b.logError("Error rendering macro definition : ");setTimeout(function(){i(!1)},1E3)},errorCallback:function(a){b.logError(a);i(!1)}};a=b.params.staticResourceUrlPrefix+"/blank.html";h().html('<iframe src="'+a+'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');
i(!0);d.Rest.fetchMacroPreviewData(k)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["ajs"],function(h){return function(f){function g(a){a.title==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g,
" ")||"";b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=f;b.metadataList=[];b.aliasMap={};for(var d=0,i=a.length;d<i;d++){var c=a[d],c=g(c);if(c.aliases)for(var e=0,j=c.aliases.length;e<j;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else h.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:g}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm","confluence/api/constants"],function(b,f,g,d){function c(a){f.logError(a)}var h=g.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=h;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros.action",
data:a.data,success:a.successCallback,error:a.errorCallback||c}).promise()},fetchMacroMetadataDetails:function(a){var e={id:a.id};a.alternateId&&(e.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros-details.action",data:e,success:a.successCallback,error:a.errorCallback||c})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||c)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:(a.context||d.CONTEXT_PATH)+"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||c})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI",["jquery","ajs","confluence/legacy","confluence/api/constants"],function(d,e,j,o){return function(k){function m(a){return d(j.Templates.MacroBrowser.macroSummaryList({category:a}))}function p(a,b){var g=d(j.Templates.MacroBrowser.macroSummaryItem());a.icon?g.prepend("<img src='"+((a.icon.relative?e.params.staticResourceUrlPrefix:"")+a.icon.location)+"' alt='icon' width='"+a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>"):g.prepend("<span class='macro-icon-holder icon-"+
a.macroName+"'></span>");d(".macro-title",g).text(a.title);d(".macro-desc",g).prepend(a.description);if("gadget"==a.macroName){var f=a.gadgetUrl;f&&(f.match("^https?://.*")||(f=o.CONTEXT_PATH+"/"+f),d(".macro-title",g).after(j.Templates.MacroBrowser.gadgetLink({url:f})))}g.click(function(d){b(d,a)});return g}function q(a,b){var d;d=b?j.Templates.Dialog.helpLink(b):j.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(d)}return{createDialog:function(a){for(var b=
a.macros,g=a.onClickMacroSummary,f={all:m("all")},h=0,r=b.length;h<r;h++){var i=b[h];if(i.hidden)if(k.isHiddenMacroShown(i))i.categories.push("hidden-macros");else continue;f.all.append(p(i,g).attr("id",i.id));for(var n=0,s=i.categories.length;n<s;n++){var l=i.categories[n];f[l]=f[l]||m(l);f[l].append(p(i,g).attr("id",l+"-"+i.id))}}var c=e.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});c.popup.element.on("keydown",".aui-button",
function(a){a.stopPropagation()});c.getPage(0).element.attr("id","select-macro-page");c.addHeader(a.title);c.addPanel("All",f.all,"all","category-button-all").getPanel(0).setPadding(0);b=0;for(g=a.categories.length;b<g;b++)h=a.categories[b],c.addPanel(h.displayName,f[h.name]||m(h.name),h.name,"category-button-"+h.name).getPanel(b+1).setPadding(0);c.addCancel("Cancel",a.onCancel);q(c);"VANILLA"==e.Meta.get("confluence-flavour")?c.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'></span>{1}</a>",
[o.CONTEXT_PATH+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","Find more macros..."]):c.addHelpText("Hint: type \u0022\u003cstrong\u003e{\u003c/strong\u003e\u0022 in the Editor to insert macros on the page.");f=d(j.Templates.MacroBrowser.insertMacroPanel());f.find("form").submit(function(a){k.complete();a.stopPropagation();return!1});d("#macro-browser-preview-link",f).click(function(a){d(this).prop("disabled")||k.previewMacro(c.activeMetadata);a.stopPropagation();return!1});c.addPage().addPanel("X",
f,"macro-input-panel").addLink("Select macro",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){k.complete()},"ok").addCancel("Cancel",function(){return a.onCancel()}).getPanel(0).setPadding(0);c.getPage(1).element.attr("id","macro-details-page");d("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'></span>");c.searcher=j.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",
formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var e=null;if(""!=b){c.getCurrentPanel()!=c.getPanel(0)&&c.gotoPanel(0);var f=k.searchSummaries(b),e={};d.each(f,function(){e[this.id]=this})}a.each(function(){!e||this.id in e?d(this).show():d(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});c.page[0].header.append(c.searcher.form);c.page[0].ontabchange=function(a){a!=c.getPanel(0,0)&&c.searcher.reset()};f=d(j.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:e.Meta.getBoolean("is-admin")}));
c.addPage().addPanel("No macro metadata",f,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});c.gotoPage(2);c.addHeader("No macro metadata");c.gotoPanel(0,0);c.ready=!0;return c},showBrowserSpinner:function(a){var b=d("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},
showPreviewSpinner:function(a){var b=d("#macro-browser-preview");a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var b=d("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?b.text("Save"):b.text("Insert")},enableSaveButton:function(a){d("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=d("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();
if(a.length){if(a.hasClass("select2-input")){var b=a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof b.select2){e.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");return}b.select2("open");b.select2("close")}else a.focus();!k.selectedMacroDefinition&&""!==a.val()&&a.select()}else e.log("No input to focus")},setHelpLink:q}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields confluence-macro-browser/macro-parameter-serializer confluence/macro-js-overrides underscore".split(" "),
function(k,h,e,r,s,l,t,u,v,w,x,y,i){var a={},l=l(a);a.ParameterFields=l.ParameterFields;a.Field=l.Field;x(a,a.ParameterFields);a.Utils=r;a.Editor=s(a);a.Preview=u(a);a.Model=t(a);a.Rest=v;a.UI=w(a);var f,g=function(b,c){var d={id:b.macroName,successCallback:function(b){if(b&&b.details)b.details=a.Model.transformMetaDataDefault(b.details);a.Editor.loadMacroInBrowser(b.details,c);g.displayDetails();a.Preview.previewMacro(b.details)},errorCallback:function(){e.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});
k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");g.displayDetails()}};if(b.alternateId)d.alternateId=b.alternateId;g.setUI(c,b.title);a.Rest.fetchMacroMetadataDetails(d)};g.setUI=function(b,c){var d=b=="edit"?a.editTitle:a.insertTitle;h("#macro-insert-container").hide();a.UI.updateButtonText(b);a.UI.enableSaveButton(false);a.dialog.gotoPage(1).addHeader(d.replace(/\{0\}/,c));a.dialog.show();a.UI.showBrowserSpinner(true)};g.displayDetails=function(){a.UI.showBrowserSpinner(false);a.UI.enableSaveButton(false);
h("#macro-insert-container").show();a.UI.focusOnMacroDetailsFirstInput()};a.reset=function(){f&&f.resolve&&f.resolve();f=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};i.reset();a.Macros=i.elements()};a.getMacroJsOverride=i.get;a.setMacroJsOverride=i.put;a.Macros=i.elements();a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=
function(){a.Editor.processRequiredParameters()};a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=i.getFunction(a.dialog.activeMetadata.macroName,"postPreview");c&&c(h("#macro-preview-iframe")[0],a.dialog.activeMetadata);e.Editor.disableFrame(b);
h(b).click(function(a){if(a.target.tagName.toLowerCase()==="a"){if((a=h(a.target).attr("href"))&&a.indexOf("#")!=0&&a.indexOf(k.location)==-1){a=k.open(a,"_blank");a.focus();a.opener=null}return false}})};a.getMacroMetadata=function(b){for(var c=0,d=a.metadataList.length;c<d;c++){var j=a.metadataList[c];if(j.macroName==b)return j}return null};a.getMetadataPromise=function(){return f};a.open=function(b){if(!b){b={};e.log("No settings to open the macro browser.")}var c=b.selectedMacro;!c&&b.presetMacroMetadata&&
(c={name:b.presetMacroMetadata.macroName});if(c&&c.name){var d=i.getFunction(c.name,"opener");if(d){d(c);return}}if(!a.hasInit){e.debug("init macro browser");a.UI.showBrowserSpinner(true);if(a.initData!==null&&h.isEmptyObject(a.initData)){e.trigger("analytics",{name:"macro-browser.init-reattempt"});e.logError("Macro browser preload failed. Trying again...");a.initMacroBrowserAfterRequest=b;a.preLoadMacro();return}if(a.initData)a.initBrowser();else{e.trigger("analytics",{name:"macro-browser.init-overlap"});
e.debug("Waiting for macro browser preloading...");a.initMacroBrowserAfterRequest=b;return}}a.openMacroBrowser(b)};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;if(b.presetMacroName)b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName);var d=b.presetMacroMetadata;if(!d){var j=b.selectedMacro;if(j){var c=j.name.toLowerCase(),c=a.aliasMap[c]||c,f=i.getFunction(c,"updateSelectedMacro"),
g=i.getFunction(c,"getMacroDetailsFromSelectedMacro");f&&f(j);g&&(d=g(a.metadataList,j));d||(d=a.getMacroMetadata(c))}}j=h("#macro-browser-dialog").find("button.back");if(d){e.debug("Open macro browser to edit macro: "+d.macroName);j.hide();a.replicateSelectMacro(d,b.mode||"edit")}else if(c){j.show();a.dialog.overrideLastTab();a.dialog.gotoPage(2);a.showBrowserDialog()}else{j.show();if(b.selectedCategory){c=h("#select-macro-page .dialog-page-menu button").index(h("#category-button-"+b.selectedCategory));
c<0&&(c=0);a.dialog.overrideLastTab();a.dialog.gotoPanel(0,c)}else a.dialog.gotoPage(0);a.showBrowserDialog();a.dialog.searcher.focusAndSearch(b.searchText)}};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(false)};a.complete=function(){if(h("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var b=a.dialog.activeMetadata,c=i.getFunction(b.macroName,"manipulateMarkup");c&&c(b);b=a.Editor.getMacroDefinitionFromForm(b);a.close();if(a.settings.onComplete)a.settings.onComplete(b)}};
a.cancel=function(){a.close();if(typeof a.settings.onCancel==="function")a.settings.onCancel();return false};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog.hide()};a.replicateSelectMacro=function(a,c){g(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||!a.metadataList.length){e.trigger("analytics",{name:"macro-browser.init-browser-error"});k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");a.UI.showBrowserSpinner(false);
return false}a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=h.map(b.categories,function(a){if(a.name=="hidden-macros"){c=a;return null}return a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&e.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();g(b,"insert")},onSubmit:a.complete,
onCancel:a.cancel});return a.hasInit=true};a.searchSummaries=function(b,c){var c=h.extend({splitRegex:/[\s-]+/},c),d;d=a.metadataList;var e,f,i,g,m,k,l,p,n,o,q;if(b){e=c&&c.keywordsField||"keywords";f=c&&c.ignoreForCamelCase?"i":"";i=c&&c.matchBoundary?"\\b":"";g=c&&c.splitRegex||/\s+/;g=b.split(g);m=[];g.forEach(function(a){k=[RegExp(i+a,"i")];if(/^([A-Z][a-z]*) {2,}$/.test(this)){l=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");k.push(RegExp(l,f))}m.push(k)});p=[];d.forEach(function(a){for(n=0;n<m.length;n++){q=
false;for(o=0;o<m[n].length;o++)if(m[n][o].test(a[e])){q=true;break}if(!q)return}p.push(a)});d=p}else d=[];return d};a.getMacroBody=function(){var b="";if(h("#macro-insert-container .macro-body-div textarea").length)b=h("#macro-insert-container .macro-body-div textarea").val();else if(a.selectedMacroDefinition){if(a.selectedMacroDefinition.body)b=a.selectedMacroDefinition.body}else if(a.dialog.activeMetadata)b=a.dialog.activeMetadata.formDetails.body.content;return b};a.getMacroParams=function(a){return y.deserialize(a.getAttribute("data-macro-parameters"))};
a.getMacroName=function(a){return!a.hasAttribute("data-macro-name")?void 0:a.getAttribute("data-macro-name")};a.isHiddenMacroShown=function(a){return e.params.showHiddenUserMacros&&a.pluginKey=="_-user-macro-_"};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.preLoadMacro=function(){a.initData=null;if(f&&f.state()==="pending")return f;f=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:false},successCallback:function(b){a.initData=
b;a.Model.loadMacros(b.macros);if(a.initMacroBrowserAfterRequest){a.initBrowser();a.openMacroBrowser(a.initMacroBrowserAfterRequest)}},errorCallback:function(b){e.trigger("analytics",{name:"macro-browser.preload-error"});e.logError("Error requesting macro browser metadata:");e.logError(b);a.initData={}}})};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('Documentation') + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml('Refresh') + '</a></li></ul><span>' + soy.$$escapeHtml('Preview') + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + 'There is no metadata configured for this macro which means no configuration screen can be presented here.' + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format('If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.',"" + '/admin/usermacros.action') + '</p>' : '<p>' + 'You must contact an administrator to configure metadata for this macro.' + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml('Body text') + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-713/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml('Gadget URL') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~moment', location = 'vendors~moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[31],{107:function(e,t,n){(function(e){e.exports=function(){"use strict";var t,n;function s(){return t.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){return void 0===e}function o(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function l(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var n in t)h(t,n)&&(e[n]=t[n]);return h(t,"toString")&&(e.toString=t.toString),h(t,"valueOf")&&(e.valueOf=t.valueOf),e}function c(e,t,n,s){return St(e,t,n,s,!0).utc()}function f(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function m(e){if(null==e._isValid){var t=f(e),s=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&s);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function _(e){var t=c(NaN);return null!=e?d(f(t),e):f(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var y=s.momentProperties=[];function g(e,t){var n,s,i;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=f(t)),a(t._locale)||(e._locale=t._locale),y.length>0)for(n=0;n<y.length;n++)a(i=t[s=y[n]])||(e[s]=i);return e}var p=!1;function w(e){g(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===p&&(p=!0,s.updateOffset(this),p=!1)}function v(e){return e instanceof w||null!=e&&null!=e._isAMomentObject}function M(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=M(t)),n}function S(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function D(e){!1===s.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function Y(e,t){var n=!0;return d((function(){if(null!=s.deprecationHandler&&s.deprecationHandler(null,e),n){for(var i,r=[],a=0;a<arguments.length;a++){if(i="","object"==typeof arguments[a]){for(var o in i+="\n["+a+"] ",arguments[0])i+=o+": "+arguments[0][o]+", ";i=i.slice(0,-2)}else i=arguments[a];r.push(i)}D(e+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var O,T={};function b(e,t){null!=s.deprecationHandler&&s.deprecationHandler(e,t),T[e]||(D(t),T[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function P(e,t){var n,s=d({},e);for(n in t)h(t,n)&&(r(e[n])&&r(t[n])?(s[n]={},d(s[n],e[n]),d(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)h(e,n)&&!h(t,n)&&r(e[n])&&(s[n]=d({},s[n]));return s}function W(e){null!=e&&this.set(e)}s.suppressDeprecationWarnings=!1,s.deprecationHandler=null,O=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)h(e,t)&&n.push(t);return n};var C={};function H(e,t){var n=e.toLowerCase();C[n]=C[n+"s"]=C[t]=e}function R(e){return"string"==typeof e?C[e]||C[e.toLowerCase()]:void 0}function U(e){var t,n,s={};for(n in e)h(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function N(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var G=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,V=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,E={},I={};function A(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(I[e]=i),t&&(I[t[0]]=function(){return N(i.apply(this,arguments),t[1],t[2])}),n&&(I[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function j(e,t){return e.isValid()?(t=Z(t,e.localeData()),E[t]=E[t]||function(e){var t,n,s,i=e.match(G);for(t=0,n=i.length;t<n;t++)I[i[t]]?i[t]=I[i[t]]:i[t]=(s=i[t]).match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"");return function(t){var s,r="";for(s=0;s<n;s++)r+=x(i[s])?i[s].call(t,e):i[s];return r}}(t),E[t](e)):e.localeData().invalidDate()}function Z(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(V.lastIndex=0;n>=0&&V.test(e);)e=e.replace(V,s),V.lastIndex=0,n-=1;return e}var z=/\d/,$=/\d\d/,J=/\d{3}/,q=/\d{4}/,B=/[+-]?\d{6}/,Q=/\d\d?/,X=/\d\d\d\d?/,K=/\d\d\d\d\d\d?/,ee=/\d{1,3}/,te=/\d{1,4}/,ne=/[+-]?\d{1,6}/,se=/\d+/,ie=/[+-]?\d+/,re=/Z|[+-]\d\d:?\d\d/gi,ae=/Z|[+-]\d\d(?::?\d\d)?/gi,oe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ue={};function le(e,t,n){ue[e]=x(t)?t:function(e,s){return e&&n?n:t}}function he(e,t){return h(ue,e)?ue[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,s,i){return t||n||s||i}))))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ce={};function fe(e,t){var n,s=t;for("string"==typeof e&&(e=[e]),o(t)&&(s=function(e,n){n[t]=k(e)}),n=0;n<e.length;n++)ce[e[n]]=s}function me(e,t){fe(e,(function(e,n,s,i){s._w=s._w||{},t(e,s._w,s,i)}))}function _e(e,t,n){null!=t&&h(ce,e)&&ce[e](t,n._a,n,e)}function ye(e){return ge(e)?366:365}function ge(e){return e%4==0&&e%100!=0||e%400==0}A("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),A(0,["YY",2],0,(function(){return this.year()%100})),A(0,["YYYY",4],0,"year"),A(0,["YYYYY",5],0,"year"),A(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),le("Y",ie),le("YY",Q,$),le("YYYY",te,q),le("YYYYY",ne,B),le("YYYYYY",ne,B),fe(["YYYYY","YYYYYY"],0),fe("YYYY",(function(e,t){t[0]=2===e.length?s.parseTwoDigitYear(e):k(e)})),fe("YY",(function(e,t){t[0]=s.parseTwoDigitYear(e)})),fe("Y",(function(e,t){t[0]=parseInt(e,10)})),s.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)};var pe,we=ve("FullYear",!0);function ve(e,t){return function(n){return null!=n?(ke(this,e,n),s.updateOffset(this,t),this):Me(this,e)}}function Me(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function ke(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ge(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Se(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Se(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?ge(e)?29:28:31-s%7%2}pe=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},A("M",["MM",2],"Mo",(function(){return this.month()+1})),A("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),A("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),H("month","M"),L("month",8),le("M",Q),le("MM",Q,$),le("MMM",(function(e,t){return t.monthsShortRegex(e)})),le("MMMM",(function(e,t){return t.monthsRegex(e)})),fe(["M","MM"],(function(e,t){t[1]=k(e)-1})),fe(["MMM","MMMM"],(function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[1]=i:f(n).invalidMonth=e}));var De=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ye="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Oe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Te(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=c([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=pe.call(this._shortMonthsParse,a))?i:null:-1!==(i=pe.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=pe.call(this._shortMonthsParse,a))||-1!==(i=pe.call(this._longMonthsParse,a))?i:null:-1!==(i=pe.call(this._longMonthsParse,a))||-1!==(i=pe.call(this._shortMonthsParse,a))?i:null}function be(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!o(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Se(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function xe(e){return null!=e?(be(this,e),s.updateOffset(this,!0),this):Me(this,"Month")}var Pe=oe,We=oe;function Ce(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=c([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function He(e,t,n,s,i,r,a){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,s,i,r,a),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,s,i,r,a),o}function Re(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Ue(e,t,n){var s=7+t-n;return-(7+Re(e,0,s).getUTCDay()-t)%7+s-1}function Fe(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ue(e,s,i);return o<=0?a=ye(r=e-1)+o:o>ye(e)?(r=e+1,a=o-ye(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Le(e,t,n){var s,i,r=Ue(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ne(i=e.year()-1,t,n):a>Ne(e.year(),t,n)?(s=a-Ne(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ne(e,t,n){var s=Ue(e,t,n),i=Ue(e+1,t,n);return(ye(e)-s+i)/7}function Ge(e,t){return e.slice(t,7).concat(e.slice(0,t))}A("w",["ww",2],"wo","week"),A("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),le("w",Q),le("ww",Q,$),le("W",Q),le("WW",Q,$),me(["w","ww","W","WW"],(function(e,t,n,s){t[s.substr(0,1)]=k(e)})),A("d",0,"do","day"),A("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),A("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),A("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),A("e",0,0,"weekday"),A("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),le("d",Q),le("e",Q),le("E",Q),le("dd",(function(e,t){return t.weekdaysMinRegex(e)})),le("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),le("dddd",(function(e,t){return t.weekdaysRegex(e)})),me(["dd","ddd","dddd"],(function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:f(n).invalidWeekday=e})),me(["d","e","E"],(function(e,t,n,s){t[s]=k(e)}));var Ve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ee="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ie="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Ae(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=c([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=pe.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=pe.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._shortWeekdaysParse,a))||-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=pe.call(this._shortWeekdaysParse,a))||-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._minWeekdaysParse,a))?i:null:-1!==(i=pe.call(this._minWeekdaysParse,a))||-1!==(i=pe.call(this._weekdaysParse,a))||-1!==(i=pe.call(this._shortWeekdaysParse,a))?i:null}var je=oe,Ze=oe,ze=oe;function $e(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=c([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Je(){return this.hours()%12||12}function qe(e,t){A(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Be(e,t){return t._meridiemParse}A("H",["HH",2],0,"hour"),A("h",["hh",2],0,Je),A("k",["kk",2],0,(function(){return this.hours()||24})),A("hmm",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)})),A("hmmss",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)})),A("Hmm",0,0,(function(){return""+this.hours()+N(this.minutes(),2)})),A("Hmmss",0,0,(function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)})),qe("a",!0),qe("A",!1),H("hour","h"),L("hour",13),le("a",Be),le("A",Be),le("H",Q),le("h",Q),le("k",Q),le("HH",Q,$),le("hh",Q,$),le("kk",Q,$),le("hmm",X),le("hmmss",K),le("Hmm",X),le("Hmmss",K),fe(["H","HH"],3),fe(["k","kk"],(function(e,t,n){var s=k(e);t[3]=24===s?0:s})),fe(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),fe(["h","hh"],(function(e,t,n){t[3]=k(e),f(n).bigHour=!0})),fe("hmm",(function(e,t,n){var s=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s)),f(n).bigHour=!0})),fe("hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s,2)),t[5]=k(e.substr(i)),f(n).bigHour=!0})),fe("Hmm",(function(e,t,n){var s=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s))})),fe("Hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=k(e.substr(0,s)),t[4]=k(e.substr(s,2)),t[5]=k(e.substr(i))}));var Qe,Xe=ve("Hours",!0),Ke={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Ye,monthsShort:Oe,week:{dow:0,doy:6},weekdays:Ve,weekdaysMin:Ie,weekdaysShort:Ee,meridiemParse:/[ap]\.?m?\.?/i},et={},tt={};function nt(e){return e?e.toLowerCase().replace("_","-"):e}function st(t){var n=null;if(!et[t]&&void 0!==e&&e&&e.exports)try{n=Qe._abbr,!function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}(),it(n)}catch(e){}return et[t]}function it(e,t){var n;return e&&((n=a(t)?at(e):rt(e,t))?Qe=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Qe._abbr}function rt(e,t){if(null!==t){var n,s=Ke;if(t.abbr=e,null!=et[e])b("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=et[e]._config;else if(null!=t.parentLocale)if(null!=et[t.parentLocale])s=et[t.parentLocale]._config;else{if(null==(n=st(t.parentLocale)))return tt[t.parentLocale]||(tt[t.parentLocale]=[]),tt[t.parentLocale].push({name:e,config:t}),null;s=n._config}return et[e]=new W(P(s,t)),tt[e]&&tt[e].forEach((function(e){rt(e.name,e.config)})),it(e),et[e]}return delete et[e],null}function at(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Qe;if(!i(e)){if(t=st(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=nt(e[r]).split("-")).length,n=(n=nt(e[r+1]))?n.split("-"):null;t>0;){if(s=st(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&S(i,n,!0)>=t-1)break;t--}r++}return Qe}(e)}function ot(e){var t,n=e._a;return n&&-2===f(e).overflow&&(t=n[1]<0||n[1]>11?1:n[2]<1||n[2]>Se(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,f(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),f(e)._overflowWeeks&&-1===t&&(t=7),f(e)._overflowWeekday&&-1===t&&(t=8),f(e).overflow=t),e}function ut(e,t,n){return null!=e?e:null!=t?t:n}function lt(e){var t,n,i,r,a,o=[];if(!e._d){for(i=function(e){var t=new Date(s.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ut(t.GG,e._a[0],Le(Dt(),1,4).year),s=ut(t.W,1),((i=ut(t.E,1))<1||i>7)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Le(Dt(),r,a);n=ut(t.gg,e._a[0],l.year),s=ut(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(u=!0)):i=r}s<1||s>Ne(n,r,a)?f(e)._overflowWeeks=!0:null!=u?f(e)._overflowWeekday=!0:(o=Fe(n,s,i,r,a),e._a[0]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(a=ut(e._a[0],i[0]),(e._dayOfYear>ye(a)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),n=Re(a,0,e._dayOfYear),e._a[1]=n.getUTCMonth(),e._a[2]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?Re:He).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(f(e).weekdayMismatch=!0)}}var ht=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ct=/Z|[+-]\d\d(?::?\d\d)?/,ft=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],mt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_t=/^\/?Date\((\-?\d+)/i;function yt(e){var t,n,s,i,r,a,o=e._i,u=ht.exec(o)||dt.exec(o);if(u){for(f(e).iso=!0,t=0,n=ft.length;t<n;t++)if(ft[t][1].exec(u[1])){i=ft[t][0],s=!1!==ft[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=mt.length;t<n;t++)if(mt[t][1].exec(u[3])){r=(u[2]||" ")+mt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!ct.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),Mt(e)}else e._isValid=!1}var gt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function pt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}var wt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function vt(e){var t,n,s,i,r,a,o,u=gt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){var l=(t=u[4],n=u[3],s=u[2],i=u[5],r=u[6],a=u[7],o=[pt(t),Oe.indexOf(n),parseInt(s,10),parseInt(i,10),parseInt(r,10)],a&&o.push(parseInt(a,10)),o);if(!function(e,t,n){return!e||Ee.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(f(n).weekdayMismatch=!0,n._isValid=!1,!1)}(u[1],l,e))return;e._a=l,e._tzm=function(e,t,n){if(e)return wt[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(u[8],u[9],u[10]),e._d=Re.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function Mt(e){if(e._f!==s.ISO_8601)if(e._f!==s.RFC_2822){e._a=[],f(e).empty=!0;var t,n,i,r,a,o=""+e._i,u=o.length,l=0;for(i=Z(e._f,e._locale).match(G)||[],t=0;t<i.length;t++)r=i[t],(n=(o.match(he(r,e))||[])[0])&&((a=o.substr(0,o.indexOf(n))).length>0&&f(e).unusedInput.push(a),o=o.slice(o.indexOf(n)+n.length),l+=n.length),I[r]?(n?f(e).empty=!1:f(e).unusedTokens.push(r),_e(r,n,e)):e._strict&&!n&&f(e).unusedTokens.push(r);f(e).charsLeftOver=u-l,o.length>0&&f(e).unusedInput.push(o),e._a[3]<=12&&!0===f(e).bigHour&&e._a[3]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[3]=function(e,t,n){var s;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),lt(e),ot(e)}else vt(e);else yt(e)}function kt(e){var t=e._i,n=e._f;return e._locale=e._locale||at(e._l),null===t||void 0===n&&""===t?_({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),v(t)?new w(ot(t)):(u(t)?e._d=t:i(n)?function(e){var t,n,s,i,r;if(0===e._f.length)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Mt(t),m(t)&&(r+=f(t).charsLeftOver,r+=10*f(t).unusedTokens.length,f(t).score=r,(null==s||r<s)&&(s=r,n=t));d(e,n||t)}(e):n?Mt(e):function(e){var t=e._i;a(t)?e._d=new Date(s.now()):u(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=_t.exec(e._i);null===t?(yt(e),!1===e._isValid&&(delete e._isValid,vt(e),!1===e._isValid&&(delete e._isValid,s.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):i(t)?(e._a=l(t.slice(0),(function(e){return parseInt(e,10)})),lt(e)):r(t)?function(e){if(!e._d){var t=U(e._i);e._a=l([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),lt(e)}}(e):o(t)?e._d=new Date(t):s.createFromInputFallback(e)}(e),m(e)||(e._d=null),e))}function St(e,t,n,s,a){var o,u={};return!0!==n&&!1!==n||(s=n,n=void 0),(r(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||i(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=a,u._l=n,u._i=e,u._f=t,u._strict=s,(o=new w(ot(kt(u))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function Dt(e,t,n,s){return St(e,t,n,s,!1)}s.createFromInputFallback=Y("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),s.ISO_8601=function(){},s.RFC_2822=function(){};var Yt=Y("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:_()})),Ot=Y("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Dt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:_()}));function Tt(e,t){var n,s;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Dt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var bt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function xt(e){var t=U(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,h=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===pe.call(bt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<bt.length;++s)if(e[bt[s]]){if(n)return!1;parseFloat(e[bt[s]])!==k(e[bt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+h+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=at(),this._bubble()}function Pt(e){return e instanceof xt}function Wt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ct(e,t){A(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+N(~~(e/60),2)+t+N(~~e%60,2)}))}Ct("Z",":"),Ct("ZZ",""),le("Z",ae),le("ZZ",ae),fe(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=Rt(ae,e)}));var Ht=/([\+\-]|\d\d)/gi;function Rt(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Ht)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Ut(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(v(e)||u(e)?e.valueOf():Dt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),s.updateOffset(n,!1),n):Dt(e).local()}function Ft(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Lt(){return!!this.isValid()&&this._isUTC&&0===this._offset}s.updateOffset=function(){};var Nt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Gt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vt(e,t){var n,s,i,r,a,u,l=e,d=null;return Pt(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:o(e)?(l={},t?l[t]=e:l.milliseconds=e):(d=Nt.exec(e))?(n="-"===d[1]?-1:1,l={y:0,d:k(d[2])*n,h:k(d[3])*n,m:k(d[4])*n,s:k(d[5])*n,ms:k(Wt(1e3*d[6]))*n}):(d=Gt.exec(e))?(n="-"===d[1]?-1:1,l={y:Et(d[2],n),M:Et(d[3],n),w:Et(d[4],n),d:Et(d[5],n),h:Et(d[6],n),m:Et(d[7],n),s:Et(d[8],n)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(r=Dt(l.from),a=Dt(l.to),i=r.isValid()&&a.isValid()?(a=Ut(a,r),r.isBefore(a)?u=It(r,a):((u=It(a,r)).milliseconds=-u.milliseconds,u.months=-u.months),u):{milliseconds:0,months:0},(l={}).ms=i.milliseconds,l.M=i.months),s=new xt(l),Pt(e)&&h(e,"_locale")&&(s._locale=e._locale),s}function Et(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function It(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function At(e,t){return function(n,s){var i;return null===s||isNaN(+s)||(b(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=s,s=i),jt(this,Vt(n="string"==typeof n?+n:n,s),e),this}}function jt(e,t,n,i){var r=t._milliseconds,a=Wt(t._days),o=Wt(t._months);e.isValid()&&(i=null==i||i,o&&be(e,Me(e,"Month")+o*n),a&&ke(e,"Date",Me(e,"Date")+a*n),r&&e._d.setTime(e._d.valueOf()+r*n),i&&s.updateOffset(e,a||o))}Vt.fn=xt.prototype,Vt.invalid=function(){return Vt(NaN)};var Zt=At(1,"add"),zt=At(-1,"subtract");function $t(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Jt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=at(e))&&(this._locale=t),this)}s.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",s.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var qt=Y("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function Bt(){return this._locale}function Qt(e,t){return(e%t+t)%t}function Xt(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-126227808e5:new Date(e,t,n).valueOf()}function Kt(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-126227808e5:Date.UTC(e,t,n)}function en(e,t){A(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Le(this,s,i).year:(t>(r=Ne(e,s,i))&&(t=r),nn.call(this,e,t,n,s,i))}function nn(e,t,n,s,i){var r=Fe(e,t,n,s,i),a=Re(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}A(0,["gg",2],0,(function(){return this.weekYear()%100})),A(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),le("G",ie),le("g",ie),le("GG",Q,$),le("gg",Q,$),le("GGGG",te,q),le("gggg",te,q),le("GGGGG",ne,B),le("ggggg",ne,B),me(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,s){t[s.substr(0,2)]=k(e)})),me(["gg","GG"],(function(e,t,n,i){t[i]=s.parseTwoDigitYear(e)})),A("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),le("Q",z),fe("Q",(function(e,t){t[1]=3*(k(e)-1)})),A("D",["DD",2],"Do","date"),H("date","D"),L("date",9),le("D",Q),le("DD",Q,$),le("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),fe(["D","DD"],2),fe("Do",(function(e,t){t[2]=k(e.match(Q)[0])}));var sn=ve("Date",!0);A("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),le("DDD",ee),le("DDDD",J),fe(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=k(e)})),A("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),le("m",Q),le("mm",Q,$),fe(["m","mm"],4);var rn=ve("Minutes",!1);A("s",["ss",2],0,"second"),H("second","s"),L("second",15),le("s",Q),le("ss",Q,$),fe(["s","ss"],5);var an,on=ve("Seconds",!1);for(A("S",0,0,(function(){return~~(this.millisecond()/100)})),A(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),A(0,["SSS",3],0,"millisecond"),A(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),A(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),A(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),A(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),A(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),A(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),H("millisecond","ms"),L("millisecond",16),le("S",ee,z),le("SS",ee,$),le("SSS",ee,J),an="SSSS";an.length<=9;an+="S")le(an,se);function un(e,t){t[6]=k(1e3*("0."+e))}for(an="S";an.length<=9;an+="S")fe(an,un);var ln=ve("Milliseconds",!1);A("z",0,0,"zoneAbbr"),A("zz",0,0,"zoneName");var hn=w.prototype;function dn(e){return e}hn.add=Zt,hn.calendar=function(e,t){var n=e||Dt(),i=Ut(n,this).startOf("day"),r=s.calendarFormat(this,i)||"sameElse",a=t&&(x(t[r])?t[r].call(this,n):t[r]);return this.format(a||this.localeData().calendar(r,this,Dt(n)))},hn.clone=function(){return new w(this)},hn.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Ut(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=$t(this,s)/12;break;case"month":r=$t(this,s);break;case"quarter":r=$t(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:M(r)},hn.endOf=function(e){var t;if(void 0===(e=R(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Kt:Xt;switch(e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-Qt(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-Qt(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-Qt(t,1e3)-1}return this._d.setTime(t),s.updateOffset(this,!0),this},hn.format=function(e){e||(e=this.isUtc()?s.defaultFormatUtc:s.defaultFormat);var t=j(this,e);return this.localeData().postformat(t)},hn.from=function(e,t){return this.isValid()&&(v(e)&&e.isValid()||Dt(e).isValid())?Vt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},hn.fromNow=function(e){return this.from(Dt(),e)},hn.to=function(e,t){return this.isValid()&&(v(e)&&e.isValid()||Dt(e).isValid())?Vt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},hn.toNow=function(e){return this.to(Dt(),e)},hn.get=function(e){return x(this[e=R(e)])?this[e]():this},hn.invalidAt=function(){return f(this).overflow},hn.isAfter=function(e,t){var n=v(e)?e:Dt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},hn.isBefore=function(e,t){var n=v(e)?e:Dt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},hn.isBetween=function(e,t,n,s){var i=v(e)?e:Dt(e),r=v(t)?t:Dt(t);return!!(this.isValid()&&i.isValid()&&r.isValid())&&("("===(s=s||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===s[1]?this.isBefore(r,n):!this.isAfter(r,n))},hn.isSame=function(e,t){var n,s=v(e)?e:Dt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},hn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},hn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},hn.isValid=function(){return m(this)},hn.lang=qt,hn.locale=Jt,hn.localeData=Bt,hn.max=Ot,hn.min=Yt,hn.parsingFlags=function(){return d({},f(this))},hn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort((function(e,t){return e.priority-t.priority})),t}(e=U(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},hn.startOf=function(e){var t;if(void 0===(e=R(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Kt:Xt;switch(e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Qt(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=Qt(t,6e4);break;case"second":t=this._d.valueOf(),t-=Qt(t,1e3)}return this._d.setTime(t),s.updateOffset(this,!0),this},hn.subtract=zt,hn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},hn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},hn.toDate=function(){return new Date(this.valueOf())},hn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?j(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",j(n,"Z")):j(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},hn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},hn.toJSON=function(){return this.isValid()?this.toISOString():null},hn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},hn.unix=function(){return Math.floor(this.valueOf()/1e3)},hn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},hn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},hn.year=we,hn.isLeapYear=function(){return ge(this.year())},hn.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},hn.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},hn.quarter=hn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},hn.month=xe,hn.daysInMonth=function(){return Se(this.year(),this.month())},hn.week=hn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},hn.isoWeek=hn.isoWeeks=function(e){var t=Le(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},hn.weeksInYear=function(){var e=this.localeData()._week;return Ne(this.year(),e.dow,e.doy)},hn.isoWeeksInYear=function(){return Ne(this.year(),1,4)},hn.date=sn,hn.day=hn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},hn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},hn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},hn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},hn.hour=hn.hours=Xe,hn.minute=hn.minutes=rn,hn.second=hn.seconds=on,hn.millisecond=hn.milliseconds=ln,hn.utcOffset=function(e,t,n){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Rt(ae,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Ft(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!t||this._changeInProgress?jt(this,Vt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,s.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Ft(this)},hn.utc=function(e){return this.utcOffset(0,e)},hn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ft(this),"m")),this},hn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Rt(re,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},hn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Dt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},hn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},hn.isLocal=function(){return!!this.isValid()&&!this._isUTC},hn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},hn.isUtc=Lt,hn.isUTC=Lt,hn.zoneAbbr=function(){return this._isUTC?"UTC":""},hn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},hn.dates=Y("dates accessor is deprecated. Use date instead.",sn),hn.months=Y("months accessor is deprecated. Use month instead",xe),hn.years=Y("years accessor is deprecated. Use year instead",we),hn.zone=Y("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),hn.isDSTShifted=Y("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(g(e,this),(e=kt(e))._a){var t=e._isUTC?c(e._a):Dt(e._a);this._isDSTShifted=this.isValid()&&S(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var cn=W.prototype;function fn(e,t,n,s){var i=at(),r=c().set(s,t);return i[n](r,e)}function mn(e,t,n){if(o(e)&&(t=e,e=void 0),e=e||"",null!=t)return fn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=fn(e,s,n,"month");return i}function _n(e,t,n,s){"boolean"==typeof e?(o(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,o(t)&&(n=t,t=void 0),t=t||"");var i,r=at(),a=e?r._week.dow:0;if(null!=n)return fn(t,(n+a)%7,s,"day");var u=[];for(i=0;i<7;i++)u[i]=fn(t,(i+a)%7,s,"day");return u}cn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},cn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])},cn.invalidDate=function(){return this._invalidDate},cn.ordinal=function(e){return this._ordinal.replace("%d",e)},cn.preparse=dn,cn.postformat=dn,cn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},cn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},cn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},cn.months=function(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||De).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone},cn.monthsShort=function(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[De.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},cn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return Te.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=c([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},cn.monthsRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||Ce.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=We),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},cn.monthsShortRegex=function(e){return this._monthsParseExact?(h(this,"_monthsRegex")||Ce.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=Pe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},cn.week=function(e){return Le(e,this._week.dow,this._week.doy).week},cn.firstDayOfYear=function(){return this._week.doy},cn.firstDayOfWeek=function(){return this._week.dow},cn.weekdays=function(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ge(n,this._week.dow):e?n[e.day()]:n},cn.weekdaysMin=function(e){return!0===e?Ge(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},cn.weekdaysShort=function(e){return!0===e?Ge(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},cn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return Ae.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=c([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},cn.weekdaysRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=je),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},cn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ze),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},cn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ze),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},cn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},cn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},it("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),s.lang=Y("moment.lang is deprecated. Use moment.locale instead.",it),s.langData=Y("moment.langData is deprecated. Use moment.localeData instead.",at);var yn=Math.abs;function gn(e,t,n,s){var i=Vt(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function pn(e){return e<0?Math.floor(e):Math.ceil(e)}function wn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function Mn(e){return function(){return this.as(e)}}var kn=Mn("ms"),Sn=Mn("s"),Dn=Mn("m"),Yn=Mn("h"),On=Mn("d"),Tn=Mn("w"),bn=Mn("M"),xn=Mn("Q"),Pn=Mn("y");function Wn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Cn=Wn("milliseconds"),Hn=Wn("seconds"),Rn=Wn("minutes"),Un=Wn("hours"),Fn=Wn("days"),Ln=Wn("months"),Nn=Wn("years"),Gn=Math.round,Vn={ss:44,s:45,m:45,h:22,d:26,M:11};function En(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}var In=Math.abs;function An(e){return(e>0)-(e<0)||+e}function jn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=In(this._milliseconds)/1e3,s=In(this._days),i=In(this._months);e=M(n/60),t=M(e/60),n%=60,e%=60;var r=M(i/12),a=i%=12,o=s,u=t,l=e,h=n?n.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var c=d<0?"-":"",f=An(this._months)!==An(d)?"-":"",m=An(this._days)!==An(d)?"-":"",_=An(this._milliseconds)!==An(d)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||h?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(h?_+h+"S":"")}var Zn=xt.prototype;return Zn.isValid=function(){return this._isValid},Zn.abs=function(){var e=this._data;return this._milliseconds=yn(this._milliseconds),this._days=yn(this._days),this._months=yn(this._months),e.milliseconds=yn(e.milliseconds),e.seconds=yn(e.seconds),e.minutes=yn(e.minutes),e.hours=yn(e.hours),e.months=yn(e.months),e.years=yn(e.years),this},Zn.add=function(e,t){return gn(this,e,t,1)},Zn.subtract=function(e,t){return gn(this,e,t,-1)},Zn.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"quarter"===e||"year"===e)switch(t=this._days+s/864e5,n=this._months+wn(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},Zn.asMilliseconds=kn,Zn.asSeconds=Sn,Zn.asMinutes=Dn,Zn.asHours=Yn,Zn.asDays=On,Zn.asWeeks=Tn,Zn.asMonths=bn,Zn.asQuarters=xn,Zn.asYears=Pn,Zn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},Zn._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*pn(vn(o)+a),a=0,o=0),u.milliseconds=r%1e3,e=M(r/1e3),u.seconds=e%60,t=M(e/60),u.minutes=t%60,n=M(t/60),u.hours=n%24,a+=M(n/24),i=M(wn(a)),o+=i,a-=pn(vn(i)),s=M(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},Zn.clone=function(){return Vt(this)},Zn.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},Zn.milliseconds=Cn,Zn.seconds=Hn,Zn.minutes=Rn,Zn.hours=Un,Zn.days=Fn,Zn.weeks=function(){return M(this.days()/7)},Zn.months=Ln,Zn.years=Nn,Zn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var s=Vt(e).abs(),i=Gn(s.as("s")),r=Gn(s.as("m")),a=Gn(s.as("h")),o=Gn(s.as("d")),u=Gn(s.as("M")),l=Gn(s.as("y")),h=i<=Vn.ss&&["s",i]||i<Vn.s&&["ss",i]||r<=1&&["m"]||r<Vn.m&&["mm",r]||a<=1&&["h"]||a<Vn.h&&["hh",a]||o<=1&&["d"]||o<Vn.d&&["dd",o]||u<=1&&["M"]||u<Vn.M&&["MM",u]||l<=1&&["y"]||["yy",l];return h[2]=t,h[3]=+e>0,h[4]=n,En.apply(null,h)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Zn.toISOString=jn,Zn.toString=jn,Zn.toJSON=jn,Zn.locale=Jt,Zn.localeData=Bt,Zn.toIsoString=Y("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jn),Zn.lang=qt,A("X",0,0,"unix"),A("x",0,0,"valueOf"),le("x",ie),le("X",/[+-]?\d+(\.\d{1,3})?/),fe("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))})),fe("x",(function(e,t,n){n._d=new Date(k(e))})),s.version="2.24.0",t=Dt,s.fn=hn,s.min=function(){var e=[].slice.call(arguments,0);return Tt("isBefore",e)},s.max=function(){var e=[].slice.call(arguments,0);return Tt("isAfter",e)},s.now=function(){return Date.now?Date.now():+new Date},s.utc=c,s.unix=function(e){return Dt(1e3*e)},s.months=function(e,t){return mn(e,t,"months")},s.isDate=u,s.locale=it,s.invalid=_,s.duration=Vt,s.isMoment=v,s.weekdays=function(e,t,n){return _n(e,t,n,"weekdays")},s.parseZone=function(){return Dt.apply(null,arguments).parseZone()},s.localeData=at,s.isDuration=Pt,s.monthsShort=function(e,t){return mn(e,t,"monthsShort")},s.weekdaysMin=function(e,t,n){return _n(e,t,n,"weekdaysMin")},s.defineLocale=rt,s.updateLocale=function(e,t){if(null!=t){var n,s,i=Ke;null!=(s=st(e))&&(i=s._config),t=P(i,t),(n=new W(t)).parentLocale=et[e],et[e]=n,it(e)}else null!=et[e]&&(null!=et[e].parentLocale?et[e]=et[e].parentLocale:null!=et[e]&&delete et[e]);return et[e]},s.locales=function(){return O(et)},s.weekdaysShort=function(e,t,n){return _n(e,t,n,"weekdaysShort")},s.normalizeUnits=R,s.relativeTimeRounding=function(e){return void 0===e?Gn:"function"==typeof e&&(Gn=e,!0)},s.relativeTimeThreshold=function(e,t){return void 0!==Vn[e]&&(void 0===t?Vn[e]:(Vn[e]=t,"s"===e&&(Vn.ss=t-1),!0))},s.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},s.prototype=hn,s.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},s}()}).call(this,n(384)(e))},384:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_moment', location = 'moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[19],{383:function(a,e,n){"use strict";n.r(e);var c=n(107),s=n.n(c),d=n(13),t=n.n(d),o=n(12);t.a.moment=s.a,Object(o.a)("moment",()=>s.a)}},[[383,0,1,3,4,31,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:collaborative-helper', location = 'loader/collaborative-helper.js' */
define("confluence-editor/loader/collaborative-helper",["jquery","ajs","confluence/meta","confluence/legacy"],function(g,h,d,i){function b(a){var c=a||{},a=c.id||i.getContentId(),b=c.type||d.get("content-type"),c=c.editMode||d.get("edit-mode");return"collaborative"===c&&("page"===b||"blogpost"===b)&&a&&"0"!==a}var e,f=g.Deferred();return{registerPlugin:function(a){e=a;f.resolve()},isCollaborativeEditingAvailable:b,getEditorContent:function(){return f.pipe(function(){return b()&&"fake"!==d.get("collaborative-editor-status")?
e.getSynchronisedEditorContent():{content:h.Rte.getEditor().getContent()}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-message.js' */
define("confluence-editor/editor/page-editor-message",["jquery","ajs","aui/flag","document","underscore"],function(f,i,g,h,d){var b=Object.create(null),e=Object.create(null);h.addEventListener("aui-flag-close",function(a){a&&a.target&&(b=d.filter(Object.keys(b),function(c){return!f(a.target).find("span").hasClass(c)}))});return{handleMessage:function(a,c,d){b[a]||(e[a]?delete e[a]:c&&(b[a]=g({title:c.title?c.title:"",type:c.type,close:c.close?c.close:"manual",persistent:!1,body:"<span class='"+a+
"'>"+c.message+"</span>"}),d&&d()))},closeMessages:function(a){d.each(a,function(a){b[a]&&(b[a].close(),delete b[a])})},isDisplayed:function(a){return a in b},displayedErrors:function(){return Object.keys(b)},suppressMessage:function(a){e[a]={}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs confluence/legacy jquery document window confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/aui-overrides".split(" "),function(d,c,b,j,O,f,n,k,m){function B(){var a=f.getBoolean("shared-drafts"),e=f.get("content-type")==="page"||f.get("content-type")==="blogpost",b=d.params.pageId!=="0";return e&&(b||a)}function C(a){b("#editpageform").find("input[name='atl_token']").val(a);f.set("atl-token",a);f.set("atlassian-token",
a);b("#atlassian-token").attr("content",a)}var u=d.DarkFeatures.isEnabled("editor.ajax.save")&&!d.DarkFeatures.isEnabled("editor.ajax.save.disable")&&f.get("remote-user")!=="",o=[],p=[],q=[],D=false,l=1,v=false,r,E=function(a){c.Editor.UI.setButtonState(a,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(a,c.Editor.UI.previewButton);c.Editor.UI.setButtonState(a,c.Editor.UI.cancelButton);b("#rte-show-changes").size()>0&&c.Editor.UI.setButtonState(a,b("#rte-show-changes"));b("#rte-show-revert").size()>
0&&c.Editor.UI.setButtonState(a,b("#rte-show-revert"))},s=function(a){var a=a||{},e=a.messageKey||"editor-error-message",c=a.message||"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.",c={title:a.title,type:"error",message:c};a.close&&b.extend(c,{close:a.close});k.handleMessage(e,c,function(){a.disablePublish&&E(false)})},F=function(){return f.get("edit-mode")==="limited"},Q=function(a){var e=true;k.closeMessages(["offline-before-save-error"]);for(var b=0;b<p.length;b++){p[b](a)===false&&(e=false);if(a.isImmediatePropagationStopped())break}if(!e||
a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();G(a).done(w).fail(P)},P=function(a){var e=a||{};s({messageKey:e.messageKey||"offline-before-save-error",message:e.disablePublish?"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.":"Unable to communicate with server. Saving is not possible at the moment.",disablePublish:e.disablePublish});a&&d.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause});c.Editor.UI.toggleSavebarBusy(false);c.Editor.Drafts.bindUnloadMessage()},G=function(a){var e=
b.Deferred();e.resolve(a);return e.promise()},H=function(){var a=function(){v=true;b(c.Editor.getCurrentForm()).submit();d.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}})},e=c.Editor.Drafts.getDraftSavingPromise();e?e.always(a):a()},w=H;d.bind("rte-ready",function(){d.Meta.getBoolean("collaborative-content")||b('meta[name="ajs-collaborative-editor-status"]').attr("content","off");c.Editor.UI.saveButton.bind("click",Q)});d.bind("editor.error.message",function(a,
e){s(e)});d.bind("dismiss.editor.error.message",function(a,e){k.closeMessages([e.messageKey]);e.enablePublish&&E(true)});var R=function(){var a;for(a=0;a<o.length;a++)c.Editor.UI.cancelButton.click(o[a]);var e=b(c.Editor.getCurrentForm());for(a=0;a<q.length;a++)e.submit(q[a]);b.unbind("init.rte",this)},I=function(a,e,c,h){h.push(c);if(d.Rte&&d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())a.bind(e,c);else if(!D){D=true;b.bind("init.rte",R)}},x=function(a,e,b){var c=null;d.Rte&&(d.Rte.BootstrapManager&&
d.Rte.BootstrapManager.isInitComplete())&&(c=function(a,e,b){a.unbind(e,b)});for(var f=b.pop();f;){c&&c(a,e,f);f=b.pop()}},J=function(a){if(g!==a){g&&g.clear();a.start(c.Editor.heartbeat);g=a}},g,K=f.getNumber("heartbeat-interval")||3E4,y,L;y={start:function(a){d.debug("Changing heartbeat to the normal scheduler");L=setInterval(a,K)},clear:function(){clearInterval(L)}};var M,N=Math.max(K/5,5E3),z,A;M={start:function(a){d.debug("Changing heartbeat to the recovery scheduler");A=0;var e=function(){a();
var b=N*Math.pow(2,A);z=setTimeout(e,Math.min(b,3E5));A++};z=setTimeout(e,N)},clear:function(){clearTimeout(z)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isPublishing:function(a){typeof a!=="undefined"&&(v=a);return v},isLimitedModeEnabled:F,overrideBeforeSave:function(a){G=a},overrideSave:function(a){w=a},restoreDefaultSave:function(){w=H},getNumConcurrentEditors:function(){return l},
addCancelHandler:function(a){I(c.Editor.UI.cancelButton,"click",a,o)},addSaveHandler:function(a){p.push(a)},addSubmitHandler:function(a){I(b(c.Editor.getCurrentForm()),"submit",a,q)},removeAllCancelHandlers:function(){x(c.Editor.UI.cancelButton,"click",o)},removeAllSaveHandlers:function(){x(c.Editor.UI.saveButton,"click",p)},removeAllSubmitHandlers:function(){x(b(c.Editor.getCurrentForm()),"submit",q)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?
false:this.editorHasContentChanged()},editorHasContentChanged:function(){if(d.Rte.getEditor()==null){d.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return d.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(d.Rte.getEditor().getContent()).text();return!b.trim(a)},getResumeDraftUrl:function(){var a=[];a.push(n.CONTEXT_PATH);a.push("/pages/"+(d.params.newPage?"create":"edit")+d.params.draftType+".action");a.push("?useDraft=true");
a.push("&pageId="+d.params.pageId);a.push("&contentChanged="+this.hasContentChanged());this.getCurrentForm().spaceKey&&a.push("&spaceKey="+f.get("space-key"));return a.join("")},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){(F()||!c.Editor.Drafts.isSharedDraftsEnabled())&&c.Editor.Drafts.unBindUnloadMessage();b(".editable-title #content-title").prop("disabled",true);return true},metadataSyncRequired:B,heartbeat:function(){var a={dataType:"json",
contentId:f.get("content-id"),draftType:f.get("content-type"),spaceKey:d.params.spaceKey,contributorsHash:f.get("contributors-hash")};r=d.safe.post(n.CONTEXT_PATH+"/json/startheartbeatactivity.action",a,function(a){if(!B()&&a){C(a.atlToken);d.Meta.set("shared-drafts",a.editMode!=="legacy");d.trigger("rte.heartbeat",a)}else if(!a||!a.atlToken||!(a.activityResponses instanceof Array)){d.trigger("rte.heartbeat-error","Invalid server response");d.logError("Unexpected server response for heartbeat:");
d.log(a)}else{f.set("contributors-hash",a.contributorsHash);d.Meta.set("shared-drafts",a.editMode!=="legacy");var i=a.activityResponses;C(a.atlToken);c.Editor.heartbeatType.normal();d.trigger("rte.heartbeat",i);l=(i.length||0)+1;if(l>1){var h=!u?b("#other-users-span"):b("#reliable-other-users-span").length===0?b("<span id='reliable-other-users-span'></span>"):b("#reliable-other-users-span");h.empty();for(var t=0;t<l-1;++t){t>0&&h.append(", ");var g=i[t];h.append(b("<a></a>").attr("href",n.CONTEXT_PATH+
"/display/~"+encodeURIComponent(g.userName)).text(g.fullName));g.lastEditMessage!=null&&h.append(" ").append(b("<span></span>").addClass("smalltext").text(g.lastEditMessage))}u&&!k.isDisplayed(["heartBeat"])&&h.html().trim()!==""&&k.handleMessage("heartBeat",{type:"info",message:d.format("This page is also being edited by {0}. Your changes will be merged with theirs when you save.","<span id='reliable-other-users-span'>"+h.html()+"</span>")});b("#heartbeat-div").hasClass("hidden")&&d.Confluence.Analytics.publish("rte.notification.concurrent-editing",{numEditors:l,
pageId:d.params.pageId,draftType:d.params.draftType})}u&&l<=1&&k.closeMessages(["heartBeat"]);m.setVisible("#heartbeat-div",l>1);b(j).trigger("resize.resizeplugin");d.trigger("editor-heartbeat",a);a=a.editMode;if(a!==f.get("edit-mode")&&!(a==="collaborative"&&f.get("edit-mode")!=="limited")){f.set("edit-mode",a);a=a==="collaborative"?"Collaborative editing was switched off, but it\u0027s back in business. Copy your changes and refresh the page to keep editing.":"Copy any changes you want to keep, then refresh the page to continue editing.";s({messageKey:"edit-mode-transition",message:a,disablePublish:true})}}},
"json").fail(function(a,b,f){(a.status>=500||a.status===0)&&c.Editor.heartbeatType.recovery();if(a.status===403||a.status===401)d.logError("Heartbeat error: Unauthorized");else if(a.status===405)d.logError("Heartbeat error: Method not allowed");else{d.logError("Server error on heartbeat request:");d.log(f)}d.trigger("rte.heartbeat-error",a)})},heartbeatType:{normal:function(){J(y)},recovery:function(){J(M)},reset:function(){g&&g.clear();g=y;g.start(c.Editor.heartbeat)},cleanup:function(){if(g){g.clear();
g=null}r&&r.abort&&r.abort()}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){var a=b(this),c=a.attr("href");a.unbind();if(c&&c.charAt(0)!=="#"){a.attr("target","_top");a.bind("click",function(b){b.preventDefault();a.blur()})}});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,e){var i=require("tinymce");c.Editor.setMode(c.Editor.MODE_PREVIEW);i.activeEditor.setProgressState(false);
c.Editor.disableFrame(a);b(".tipsy").remove();var h=b("#main",a)[0];if(f.get("content-type")!=="comment"&&b(h).find("#main-header").length===0){var g=b("#title-heading"),k=g.attr("class");b(h).prepend('<div id="preview-header"><div id="title-heading" class="'+k+'">'+g.html()+"</div></div>")}if(b(d.Rte.getEditor().getBody()).hasClass("resizable")){var n=b(e||"#previewArea iframe"),l=0,m=0,o,p=n.height();h&&function S(){var a;if(b("#editor-preview-iframe").length){a=b(h).outerHeight(true);if(l!==a){a!==
n.height()&&n.height(0).height(Math.max(a,p));l=a;m=0}else m++;m<500&&(o=setTimeout(S,500))}}();b(j).one("mode-changed.resize-editor",function(a,b){b!==c.Editor.MODE_PREVIEW&&o&&clearTimeout(o)})}else if(i.isIE||i.isOpera){i=b(O).height();g=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();k=b("#savebar-container").height();b("#preview iframe").height(i-g-k-4);b("#content.edit").height("auto")}},showRichText:function(a){var e=require("tinymce");m.setVisible("#wysiwyg",
a);b(".toolbar-group-preview").toggleClass("assistive",!a);b(".toolbar-group-edit").toggleClass("assistive",a);b("#main").toggleClass("active-richtext",a);e.isGecko&&a&&d.Rte.fixEditorFocus(c.Editor.bookmark)},showPreview:function(a){if(f.get("content-type")!=="comment"){var c=b("#content-title");if(c.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(c.val());b("#title-text").text(c.val())}}m.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",
a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main").toggleClass("active-preview",a);b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},setMode:function(a){d.debug("Set mode: "+a);if(a===c.Editor.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false)}else if(a===c.Editor.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);c.Editor.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");
a.height(0);a.height();a.height("auto")},1);this.currentEditMode=a;b(j).trigger("mode-changed",[a])},getContentId:function(){return c.getContentId()},addErrorMessage:function(a,c,f){var h=b("#"+a),f=f?"#any-messages":"#editor-messages";h.length?h.empty():h=b("<div></div>").attr("id",a).appendTo(f);d.messages.error(h,{closeable:true,body:c})},changeMode:function(a,e){var i=require("tinymce");d.debug("Change mode: "+a);e=e||{};if(this.inRichTextMode()&&!d.Rte.BootstrapManager.isInitComplete()||this.currentEditMode===
a)return false;var h=this.currentEditMode;d.trigger("rte-changeMode",a);if(a===c.Editor.MODE_PREVIEW){var g=d.Rte.getEditor();if(i.isGecko&&h===c.Editor.MODE_RICHTEXT&&!c.Editor.bookmark)c.Editor.bookmark=i.activeEditor.selection.getBookmark();this.currentEditMode=a;i={contentId:c.getContentId(),contentType:f.get("content-type"),spaceKey:f.get("space-key"),xHtml:g.getContent(),outputType:c.Editor.PREVIEW_OUTPUT_TYPE};d.safe.ajax({type:"POST",url:n.CONTEXT_PATH+"/pages/rendercontent.action",data:i,
success:c.Editor.replysetPreviewArea,timeout:2E4,error:function(){d.trigger("rte-preview-action-selected");d.trigger("rte.preview.error",{status:0});k.closeMessages(["server-offline"]);s({messageKey:"server-offline",message:"Can\u0027t reach the server. Check you\u0027re connected to the internet and Confluence is up and running.",disablePublish:false});c.Editor.currentEditMode=h;e.errorCallback&&e.errorCallback()}}).always(function(){f.getBoolean("shared-drafts")&&(f.get("content-type")==="page"||f.get("content-type")==="blogpost")&&c.Editor.Drafts.save({skipErrorHandler:true})})}else this.setMode(a);
a===c.Editor.MODE_RICHTEXT&&b(j).trigger("resize.resizeplugin");if(h===c.Editor.MODE_PREVIEW)if(i=j.getElementById("editor-preview-iframe")){g=i.contentDocument||i.contentWindow.document;g.removeChild(g.documentElement);b(i).remove()}return false},replysetPreviewArea:function(a){var c=require("tinymce");d.trigger("rte-preview-action-selected");b("#preview-error").remove();c.activeEditor.setProgressState(true);var c=b("#previewArea"),f=b('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');
c.html(f);c=f[0].contentDocument||f[0].contentWindow.document;c.open();c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode===c.Editor.MODE_RICHTEXT},isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){c.Editor.setMode(c.Editor.MODE_RICHTEXT);d.Rte.getEditor().on("click",function(){var a=c.Editor.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return d.Rte.getEditor().formElement},
setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>0||b("#preview:visible").length>0}}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(d){var c=require("confluence/legacy"),b=require("jquery"),j=require("ajs");c.Editor=b.extend(c.Editor||{},d);j.toInit(function(b){b(document).ajaxError(function(b,c){if(405===c.status)try{var d=JSON.parse(c.responseText).reason;"undefined"!==typeof d&&"READ_ONLY"===d&&(j.log("*** READ_ONLY mode detected ***"),j.trigger("rte.heartbeat-error",null,c))}catch(m){j.logError("Cannot parse xhr.responseText: "+
m)}});j.bind("init.rte",c.Editor.onInit)});j.Editor=c.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
define("confluence-editor/editor/page-editor-ui","jquery confluence/templates ajs confluence/meta confluence/legacy window moment document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog confluence/form-state-control".split(" "),function(b,f,c,e,d,m,r,h,t,u,n,o){return function(){var a={},k=false,j=function(c,b){for(var b=b||a.buttons,d=0;d<b.length;d++)l(c,b[d])},l=function(a,b){if(b)if(a){b.removeAttr("aria-disabled");b.removeClass("disabled");
b.is("button")&&b.removeAttr("disabled")}else{b.attr("aria-disabled","true");b.addClass("disabled");b.is("button")&&b.attr("disabled","disabled")}},p=function(a){return a.length&&a.attr("aria-disabled")!=="true"},g=function(){return e.get("new-page")},q=function(){var a="";g()||(a="Edit"+" - ");return a};a.spinner=b("#rte-spinner");var i;i=f.Editor.Page.saveButton({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()});b("#rte-button-publish").replaceWith(i);
i=b("#rte-button-publish");a.saveButton=i;a.overwriteButton=b("#rte-button-overwrite");a.editButton=b("#rte-button-edit");a.previewButton=b("#rte-button-preview");a.cancelButton=b("#rte-button-cancel");a.versionCommentInput=b("#versionComment");a.watchPageCheckbox=b("#watchPage");a.watchPageToolbarGroup=b(".toolbar-group-watch-page");a.buttons=[a.saveButton,a.overwriteButton,a.editButton,a.previewButton,a.cancelButton];c.bind("editor-shared-drafts-published",function(){var b=/\(.+\)/g.exec(a.saveButton.data("tooltip"))[0];
a.saveButton.text(f.Editor.Page.saveButtonText({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})).attr("title",f.Editor.Page.saveButtonTitle({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})+b).tooltip({gravity:"s"})});c.bind("synchrony.history.evicted",function(){k=true;l(false,a.versionCommentInput);try{c.Rte.getEditor().plugins.customtoolbar.disableToolbar(true);c.Rte.getEditor().plugins.customtoolbar.toggleToolbarButtons(true,
true,true)}catch(d){}try{c.Rte.getEditor().setMode("readonly")}catch(e){}try{c.Rte.getEditor().plugins.pagelayoutplugin.disableContent()}catch(h){}try{b("input#content-title").attr("disabled","true")}catch(v){}});a.setButtonsState=j;a.setButtonState=l;a.isButtonEnabled=p;a.registerFormButton=function(b,c){a[b]=c;a.buttons.push(c)};a.postingDatePicker=null;a.isFormEnabled=function(){for(var b=0;b<a.buttons.length;b++)if(p(a.buttons[b]))return true;return false};a.toggleSavebarBusy=function(b){if(k!==
true)if(b){if(!a.isFormEnabled())return false;a.spinner.addClass("aui-icon-wait");j(false)}else{a.spinner.removeClass("aui-icon-wait");j(true)}return true};a.init=function(){function f(){b("#rte-ellipsis-menu").is(":visible")&&b("#rte-button-ellipsis").trigger("aui-button-invoke")}n.init();d.Editor.addSaveHandler(function(b){if(a.isButtonEnabled(a.saveButton)){a.toggleSavebarBusy(true);c.trigger("confluence.editor.on.save")}else{b.stopImmediatePropagation();b.preventDefault()}});c.trigger("rte.init.ui");
d.Editor.isNewPage()&&b("#content-title").focus().select();d.Editor.addCancelHandler(function(b){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType});if(e.getBoolean("shared-drafts")&&(e.get("content-type")==="page"||e.get("content-type")==="blogpost"))if(a.isButtonEnabled(a.cancelButton))a.toggleSavebarBusy(true);else{b.stopImmediatePropagation();
b.preventDefault()}n.process(b)});e.get("content-type")==="comment"&&d.Editor.addSaveHandler(function(){var b=require("confluence/editor-notifications");if(c.Rte.Content.isEmpty()){b.notify("warning","Comment text is empty. Cannot create empty comments.");a.toggleSavebarBusy(false);return false}});(e.get("content-type")==="comment"||e.get("content-type")==="template")&&d.Editor.addCancelHandler(function(b){if(a.isFormEnabled()&&d.Editor.hasContentChanged()&&!d.Editor.isEmpty()){var s=e.get("content-type")==="comment"?"Your comment will be lost.":
"Your unsaved template changes will be lost.";if(!m.confirm(s)){b.stopImmediatePropagation();return false}}});a.versionCommentInput.on("keypress",function(a){a.keyCode===13&&n.process(a)});d.Editor.addSaveHandler(function(){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType})});d.Editor.addSubmitHandler(function(a){return d.Editor.contentFormSubmit(a)});
this.currentEditMode=this.MODE_RICHTEXT;a.editButton.click(function(b){var e=require("tinymce");if(a.isFormEnabled()){d.Editor.changeMode(d.Editor.MODE_RICHTEXT);setTimeout(function(){c.Rte.getEditor().focus();e.isGecko&&d.Editor.bookmark&&c.Rte.getEditor().selection.moveToBookmark(d.Editor.bookmark)},0);k!==true&&o.enableElement(a.cancelButton)}b.preventDefault()});a.previewButton.click(function(b){b.preventDefault();if(k!==true){b=require("tinymce");if(a.isFormEnabled()&&d.Editor.currentEditMode!==
d.Editor.MODE_PREVIEW){f();j(false);a.spinner.addClass("aui-icon-wait");if(b.isGecko&&!d.Editor.bookmark)d.Editor.bookmark=b.activeEditor.selection.getBookmark();d.Editor.changeMode(d.Editor.MODE_PREVIEW,{errorCallback:function(){j(true);a.spinner.removeClass("aui-icon-wait")}});e.get("content-type")==="comment"||e.get("content-type")==="template"?o.disableElement(a.cancelButton):o.enableElement(a.cancelButton)}}});b("#rte-button-labels").bind("updateLabel",function(){var a=+e.get("num-labels")||
0,d="Labels";a===1?d=c.format("{0} Label",a):a>1&&(d=c.format("{0} Labels",a));b("#rte-button-labels").attr("data-tooltip",d)});b("#draft-status-lozenge").length&&b("#draft-status-lozenge").tooltip();var g=b("#PostingDate");if(g.length){g.attr("max",r().format("YYYY-MM-DD"));a.postingDatePicker=g.datePicker({overrideBrowserDefault:true});a.postingDatePicker.hide()}b("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",
function(){c.Rte.getEditor().focus()});b(m).bind("render-content-loaded",function(c,e){var f=b("#previewArea iframe");if(f.contents().find("body")[0]==e){d.Editor.previewFrameOnload(e,f);[a.saveButton,a.overwriteButton,a.editButton,a.previewButton].forEach(function(a){l(true,a)});f.focus();m.focus();b(h).trigger("iframeAppended",f)}});if(e.get("heartbeat")){d.Editor.heartbeat();d.Editor.heartbeatType.normal();c.bind("rte-destroyed",d.Editor.heartbeatType.cleanup)}c.bind("watchpage.pageoperation",
function(){a.toggleWatchPage(false)});c.bind("unwatchpage.pageoperation",function(){a.toggleWatchPage(true)});if(e.get("new-page")&&e.get("form-name")==="inlinecommentform")h.title="Edit"+h.title;var i=h.title;if(e.get("new-page")&&b.trim(b("input#content-title").val()))h.title=q()+b("input#content-title").val()+" - "+e.get("space-name")+" - "+e.get("site-title");b("input#content-title").on("change input",function(){if(e.get("content-type")!=="template"){var a=q();h.title=b.trim(this.value)?
a+this.value+" - "+e.get("space-name")+" - "+e.get("site-title"):i}});b("body",b("#wysiwygTextarea_ifr").contents()).click(f);c.trigger("init.rte-control")};a.toggleWatchPage=function(b){if(b&&e.get("content-type")==="comment"){a.watchPageToolbarGroup.show();if(a.watchPageCheckbox.length)a.watchPageCheckbox[0].checked=false}else a.watchPageToolbarGroup.hide()};return a}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-ui",function(b){var f=require("confluence/legacy");require("confluence/api/event").bind("init.rte",function(){var c=b();f.Editor.UI=c;c.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.InsertWiki.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog';
}


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_ignored) {
  return '<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.previewWikiIframeContent.soyTemplateName = 'Confluence.Templates.InsertWiki.previewWikiIframeContent';
}


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<p id="insert-wiki-info-title">' + soy.$$escapeHtml('Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.') + '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">' + soy.$$escapeHtml('Insert') + '</span><span id="insert-wiki-preview-title">' + soy.$$escapeHtml('Preview') + '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiMarkupDialog';
}


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_ignored) {
  return '<p class=\'warning\'>' + soy.$$escapeHtml(opt_data.warningMessage) + '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>' + soy.$$escapeHtml(opt_data.exceptionMessage) + '</span></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiErrorSubDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiErrorSubDialog';
}


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_ignored) {
  var output = '<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="' + soy.$$escapeHtml(opt_data.DEFAULT.val) + '">' + soy.$$escapeHtml(opt_data.DEFAULT.label) + '</option>';
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output += (opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '';
  }
  output += '</select></form></span>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiParserSelector.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiParserSelector';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
define("confluence-editor/insert-image-dialog/insert-image-dialog",["jquery","ajs","underscore","confluence/legacy"],function(c,f,e,h){var g={beforeShowListeners:[],panelComponent:[],sizeToFit:function(){this.each(function(){var a=this,b=c(this).parent(),d=b.height();b.children().each(function(){this!==a&&c(this).is(":visible")&&(d-=c(this).outerHeight())});b=c(this).outerHeight()-c(this).height();c(this).css("height",Math.max(0,d-b)+"px")});return this},defaultInsertImageDialog:function(){f.Rte.BookmarkManager.storeBookmark();
g.insertImageDialog(function(a){var b=require("tinymce");f.Rte.BookmarkManager.restoreBookmark();var d={};if(a.url)d={url:a.url,filename:a.url,contentId:a.contentId},b.confluence.ImageUtils.insertFromProperties(d);else{var i=!0,h=1<a.selectItems.length;e.each(a.selectItems,function(a){a.isImage()?(d={filename:a.getFileName(),contentId:a.get("ownerId")},b.confluence.ImageUtils.insertFromProperties(d,h)):(i=!1,f.MacroBrowser.getMacroMetadata("view-file")?g._insertFilePlaceholderToEditor(a):g._insertLinkToEditor(a))});
require(["confluence-drag-and-drop/analytics/files-upload-analytics"],function(b){b.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,i)})}c("#comments-section").length&&f.Rte.fixEditorFocus()},function(){f.Rte.BookmarkManager.restoreBookmark()})},findPanelComponentById:function(a){for(var b=h.Editor.ImageDialog.panelComponent,d=0,c=b.length;d<c;d++)if(b[d].id==a)return b[d]},insertImageDialog:function(a,b){var d=new h.Editor.FileDialog.FileDialogView({submitCallback:a,cancelCallback:b,
beforeShowListeners:g.beforeShowListeners,panelComponents:g.panelComponent});d.render();return d},_insertLinkToEditor:function(a){var b=h.Link.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");b.insert()},_insertFilePlaceholderToEditor:function(a){var b={name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert-utils"],
function(a){a.insertFilePlaceholder(b)})}};return g});
require("confluence/module-exporter").safeRequire("confluence-editor/insert-image-dialog/insert-image-dialog",function(c){var f=require("jquery"),e=require("confluence/legacy");f.fn.sizeToFit=c.sizeToFit;e.Editor.ImageDialog=c;e.Editor.defaultInsertImageDialog=c.defaultInsertImageDialog;e.Editor.ImageDialog.findPanelComponentById=c.findPanelComponentById;e.Editor.insertImageDialog=c.insertImageDialog;e.Editor.ImageDialog._insertLinkToEditor=c._insertLinkToEditor;e.Editor.ImageDialog._insertFilePlaceholderToEditor=
c._insertFilePlaceholderToEditor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
define("confluence-editor/panel-components/panel-components-init",["confluence/legacy","confluence/meta"],function(a,d){return function(){if(a.Editor&&a.Editor.ImageDialog&&a.Editor.ImageDialog.panelComponent){var b=a.Editor.FileDialog.eventListener,e=a.Editor.FileDialog.ExternalPanelView,f=a.Editor.FileDialog.SearchPanelView,g=a.Editor.FileDialog.AttachmentsPanelView,c=a.Editor.ImageDialog.panelComponent;"template"!==d.get("content-type")&&(b=new g({eventListener:b}),c.push(b));c.push(new e);c.push(new f)}}});
require("confluence/module-exporter").safeRequire("confluence-editor/panel-components/panel-components-init",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
define("confluence-editor/page-editor-drafts","jquery ajs confluence/meta confluence/legacy confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/loader/collaborative-helper".split(" "),function(d,a,g,b,n,s,t){var o=false,l=false,h=false,p=null,u=g.get("remote-user")!=="",v=a.DarkFeatures.isEnabled("editor.ajax.save")&&!a.DarkFeatures.isEnabled("editor.ajax.save.disable"),q=false,m=false,i=function(a,b,g){d("<input>").attr({type:"hidden",name:a,value:b}).appendTo(g)},
k=function(){return g.getBoolean("shared-drafts")};a.bind("editor-shared-drafts-published editor-shared-drafts-discarded",function(){l=o=false});a.bind("synchrony.history.evicted",function(){q=true});a.bind("synchrony.connected",function(){m=true});return{isDraftSaved:function(){return o},isDraftManuallySaved:function(){return l},isDraftBlank:function(){return a.Rte.Content.isEmpty()&&!d.trim(b.Editor.getCurrentTitle())},isNewContent:function(){return a.Rte.getEditor()&&g.getBoolean("new-page")===
true},isDraftDirty:function(){return b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()},unloadMessage:function(){var e=function(){b.Editor.Drafts.isDraftBlank()&&!k()?b.Editor.Drafts.discardDraft(g.get("draft-id")):b.Editor.Drafts.save({skipErrorHandler:true})};if(typeof seleniumAlert!=="undefined")e();else if(b.Editor.isLimitedModeEnabled()||!k()){if(b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()){e();
return "A draft will be saved. You can resume editing this draft the next time you open the editor or view all your drafts in your profile."}}else{e();if(m&&(h||b.Editor.hasContentChanged()||q))return "We haven\u0027t finished saving your changes. If you leave before seeing the \u0027Draft saved\u0027 message, you might lose your changes."}},hasPendingChanges:function(){return h},setPendingChanges:function(a){h=a},isSharedDraftsEnabled:k,bindUnloadMessage:function(){if(!b.Editor.isLimitedModeEnabled()&&k()){a.bind("synchrony.entity.ack",function(a,b){b.pendingChanges||(h=false)});a.bind("editor.local.change",function(){h=true})}d(window).bind("beforeunload",b.Editor.Drafts.unloadMessage)},
unBindUnloadMessage:function(){d(window).unbind("beforeunload")},useDraft:function(){var e=g.get("existing-draft-id");b.Editor.Drafts.unBindUnloadMessage();var c=b.Editor.getCurrentForm();i("useDraft","true",c);i("contentChanged",""+b.Editor.hasContentChanged(),c);i("pageId",a.params.pageId,c);d("#draftId",b.Editor.getCurrentForm()).val(e);c.spaceKey||i("spaceKey",g.get("space-key"),c);c.action=n.CONTEXT_PATH+"/pages/"+(a.params.newPage?"create":"edit")+a.params.draftType+".action";c.submit()},discardDraft:function(b){return a.safe.ajax({url:n.CONTEXT_PATH+
"/rest/api/content/"+b+"?status=draft",type:"DELETE",dataType:"json",data:{},contentType:"application/json",success:function(){d("#draft-messages").remove();a.messages.success("#editor-messages",{body:"Your draft has been discarded."})},error:function(b){a.messages.error({title:"Error",body:b.errors||"An unknown error has occurred. Please check your logs."})}})},save:function(e){e=e||{};if(!q)if(b.Editor.isPublishing()||!b.Editor.editorHasContentChanged()&&!e.forceSave){a.debug("skipping draft save because:");
b.Editor.isPublishing()?a.debug("The user is publishing the page already."):!b.Editor.editorHasContentChanged()&&!e.forceSave&&a.debug("The content hasn't changed and a forceSave wasn't requested in the options.")}else{a.debug("preparing to save editor draft");var c=d("#content-title"),h=d("#newSpaceKey"),i=d("#originalVersion"),m=b.Editor.inRichTextMode(),r={draftId:g.get("draft-id"),pageId:g.get("page-id"),parentPageId:g.get("parent-page-id"),type:a.params.draftType,title:c.hasClass("placeholded")?
"":c.val(),spaceKey:h.length?h.val():encodeURIComponent(g.get("space-key"))};t.getEditorContent().pipe(function(c){d.extend(r,c);if(i.length)r.pageVersion=parseInt(i.val(),10);p=d.ajax({type:"POST",url:n.CONTEXT_PATH+"/rest/tinymce/1/drafts"+(e.ignoreRelations?"?ignoreRelations=true":""),data:d.toJSON(r),contentType:"application/json",dataType:"text json",success:function(c){if(c!=null&&(!(u&&c.draftId===0)||!v)){b.Editor.contentHasChangedSinceLastSave=false;m&&a.Rte.Content.editorResetContentChanged();
o=true;l=!!e.manualSave;g.set("draft-id",c.draftId+"");d("#draftId",b.Editor.getCurrentForm()).val(c.draftId);d("#draft-error").remove();if(!g.get("collaborative-content")){var h=d("#draft-status"),f;if(!(f=c.time)){var j=new Date;f=j.getHours();var j=j.getMinutes(),i=f>11?"PM":"AM";f=f%12;f=(f==0?"12":f)+":"+(j<10?"0":"")+j+" "+i}j=l?a.format("Draft saved at {0}",f):a.format("Draft autosaved at {0}",f);i=a.params.newPage?j:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+
j+"</a>";h.attr("data-tooltip",j);h.html(i)}if(d.isFunction(e.onSuccessHandler))e.onSuccessHandler(c);b.Editor.Drafts.lastSaveTime=f;a.trigger("rte-draft-saved",{draftId:c.draftId})}},error:function(c,g){var f;f=function(){b.Editor.addErrorMessage("draft-error",b.Editor.Drafts.lastSaveTime?a.format("Error saving draft. Last draft saved at {0}",b.Editor.Drafts.lastSaveTime):"Error saving draft. No draft has been saved.",true)};if(!e.skipErrorHandler&&!k()){if(c.status===400)if(c.responseText.indexOf("Legacy drafts deprecated")>=
0)s.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."});else if(c.responseText.indexOf("Unsupported character found in content: ")>=0){f=c.responseJSON.message.split("Unsupported character found in content: ")[1];s.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",f)})}else f();else f();if(d.isFunction(e.onErrorHandler))e.onErrorHandler(g)}},
timeout:3E4}).always(function(){p=null})})}},getDraftSavingPromise:function(){return p}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/page-editor-drafts","Confluence.Editor.Drafts");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
define("confluence-editor/editor/page-editor-permissions",["ajs","jquery"],function(a,d){var c={updateEditPageRestrictions:function(c,b,f,i){var e=d("#rte-button-restrictions"),j=e.find(".icon"),g="",h="";c||b?(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass(c?"aui-iconfont-locked icon-red":"aui-iconfont-unlocked icon-red"),g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass("aui-iconfont-unlocked"),
f?(g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(g="Unrestricted",h="Edit page restrictions. Current status: Unrestricted"));e.attr("data-tooltip",g);e.attr("aria-label",h);e.data("explicit-restrictions",c);e.data("inherited-restrictions",b);e.data("restrictionsHash",i)},handleHeartbeat:function(k,b){if("undefined"!==typeof b.restrictionsHash){var f=d("#rte-button-restrictions");if(f.data("restrictionsHash")!==
b.restrictionsHash)if(d("#update-page-restrictions-dialog").is(":visible")&&a.PagePermissions.updateRestrictionsDialog)a.PagePermissions.updateRestrictionsDialog(),f.data("restrictionsHash",b.restrictionsHash);else{var i=""!==b.restrictionsHash,e=b.hasViewRestrictions,f=!!f.data("inherited-restrictions");c.updateEditPageRestrictions(e,f,i,b.restrictionsHash)}}},init:function(){a.bind("editor-heartbeat",c.handleHeartbeat);a.bind("edit-page-restrictions-updated",function(a,b){c.updateEditPageRestrictions(b.hasExplicitRestrictions,
b.hasInheritedRestrictions,b.hasAnyExplicitRestrictions,b.restrictionsHash)})}};return c});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-permissions",function(a){var d=require("ajs"),c=require("jquery");d.PagePermissions=d.PagePermissions||{};c.extend(d.PagePermissions,{updateEditPageRestrictions:a.updateEditPageRestrictions});d.toInit(a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
define("confluence/draft-changes","jquery ajs window confluence/legacy confluence/api/ajax confluence/api/event confluence/api/logger confluence/analytics-support confluence/dark-features confluence/meta confluence/aui-overrides wrm/context-path".split(" "),function(b,d,q,c,v,r,n,k,s,j,t,l){return{init:function(){var a,p=function(a){var c="Are you sure you want to discard these unpublished changes?",f=b("#draft-"+a),h;if(confirm(c)){c=l()+"/rest/api/content/"+a+"?status=draft";h=b.ajax;h({url:c,type:"DELETE",data:{draftId:a},
contentType:"application/json",dataType:"json",success:function(a){if(a&&a.actionErrors){for(var b=["<ul>"],a=a.actionErrors,c=0;c<a.length;c++){n.log("error: "+a[c]);b.push("<li>"+a[c]+"</li>")}b.push("</ul>");d.messages.error("#errors",{title:"Error",body:"There were errors discarding your draft."+" "+b.join("\n")})}else{b=f.closest("table");a=b.closest(".drafts-container");f.remove();b.find("tbody tr").length===0&&a.append('<span id="no-drafts-message">'+
"No drafts found."+"</span>")}},error:function(a){d.messages.error("#errors",{title:"There were errors discarding your draft.",body:a.errors||"An unknown error has occurred. Please check your logs."})}});return true}return false};b("body").on("click",".view-diff-link",function(u){var o=this.id,f=b(this);if(!a){var h=o==="view-diff-link-notification";a=new d.Dialog(860,530,"view-diff-draft-dialog");var e="Unpublished Changes for \u0027{0}\u0027";a.addHeader(e.replace(/\{0\}/,""));e=b(c.Templates.DraftChanges.dialogContent());
a.addPanel("Diff",e);if(h){a.addButton("Edit",function(){a.hide();c.Editor&&c.Editor.Drafts?c.Editor.Drafts.useDraft():q.location=b(this).attr("data-href")},"resume-diff-link");a.addButton("Discard",function(){if(s.isEnabled("editor.ajax.save")&&j.get("remote-user")!==""){c.Editor.SafeSave.Draft.discardDraft(d.params.pageId,j.get("existing-draft-id")).done(c.Editor.SafeSave.Draft.onSuccessDiscardDraft).fail(c.Editor.SafeSave.Draft.onErrorDiscardDraft);a.hide()}else if(c.Editor&&
c.Editor.Drafts){a.hide();c.Editor.Drafts.discardDraft(j.get("existing-draft-id"));k.publish("rte.notification.draft.discard")}else{var g=b(this).data("draftid");p(g)&&a.hide()}},"discard-diff-link")}a.addCancel("Close",function(){a.hide();return false});e.removeClass("hidden")}a.addHeader("Loading");b("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var m,e=f.attr("class"),i=/draftPageId:([^ ]*)/.exec(e),f=i?i[1]:j.get("page-id"),
h=(i=/username:([^ ]*)/.exec(e))?i[1]:j.get("remote-user");m=(i=/draftId:([^ ]*)/.exec(e))?i[1]:null;b.ajax({url:l()+"/draftchanges/viewdraftchanges.action",type:"GET",dataType:"json",data:{pageId:f,username:h},success:function(g){if(g.actionErrors){for(var e="",g=g.actionErrors,f=0;f<g.length;f++){n.log("error: "+g[f]);e=e+"<div>"+g[f]+"</div>"}b("#diff-view").html(e)}else{b("#diff-view").html(g.htmlDiff);e=d.format("Unpublished Changes for \u0027\u0027{0}\u0027\u0027",d.escapeHtml(g.title));a.addHeader(e);a.popup.element.find(".dialog-title").prepend(c.Templates.DraftChanges.helpLink());
b(".resume-diff-link").attr("data-href",l()+"/pages/resumedraft.action?draftId="+m);b(".discard-diff-link").data("draftid",m);t.setVisible("#merge-warning",g.isMergeRequired)}},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";b("#diff-view").html(a)}});a.show();r.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:o}});u.stopPropagation();return false});b(".drafts-by-space li.draft-actions-list-item").on("click",".discard-draft-link",
function(a){a.preventDefault();k.publish("confluence.draft-list.discard");a=b(this).data("draftid");p(a)}).on("click",".resume-draft-link",function(){k.publish("confluence.drafts.referrer",{referrerPage:"drafts",lozengeType:"Draft"})})}}});require("confluence/module-exporter").safeRequire("confluence/draft-changes",function(b){require("ajs").toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DraftChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_ignored) {
  return '<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.dialogContent.soyTemplateName = 'Confluence.Templates.DraftChanges.dialogContent';
}


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-713/Drafts#viewchange"});
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.helpLink.soyTemplateName = 'Confluence.Templates.DraftChanges.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.processData)a.appId?a.data=AJS.$.extend(a.data||{},{appId:a.appId}):a.appType&&(a.data=AJS.$.extend(a.data||{},{appType:a.appType})),a.data=AJS.$.extend(a.data||{},{path:a.url});else{var c=a.url;a=AJS.$.extend(a,{beforeSend:function(b){a.appId?b.setRequestHeader("X-AppId",a.appId):a.appType&&b.setRequestHeader("X-AppType",a.appType);b.setRequestHeader("X-AppPath",c)}})}a=AJS.$.extend(a,{url:b+
"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(a){var b="";a.includeContext&&(b=contextPath||AJS.contextPath());b+="/plugins/servlet/applinks/proxy";if(a.appId)b+="?appId\x3d"+encodeURIComponent(a.appId);else if(a.appType)b+="?appType\x3d"+encodeURIComponent(a.appType);else return AJS.log("You need to specify an appType or appId"),"";a.path&&(b+="\x26path\x3d"+encodeURIComponent(a.path));return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=function(){var m=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i,h=/\s*([A-Z][A-Z]+)-[0-9]+\s*/,n=/(issue|searchrequest)-xml/i,k=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i,p=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,l=/(jqlQuery|jql)\s*=([^&]+)/i,e=/(\?|&)(requestId|filter)=([^&]+)/i,f=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i,q=/=|!=|~|>|<|!~| is | in | was | changed /i,g=function(a){var b=
"",c=k.exec(a);c?b="key\x3d"+c[2]:(c=l.exec(a))?b=c[2]:(a=h.exec(a))&&(b="key\x3d"+a[0]);return b=b.replace(/\+/g," ")},r=function(a,b){var c;a=decodeURIComponent(a);AJS.JQLHelper.getJqlQueryFromJiraFilter(a,b,function(a){a.jql&&(c=a.jql)});return c};return{isSingleKeyJQLExp:function(a){return m.exec(a)},isMultipleSingleKeyJQLExp:function(a){a=a.split(",");for(var b in a){var c=AJS.$.trim(a[b]);if(!AJS.JQLHelper.isSingleKeyJQLExp(c))return!1}return!0},isIssueUrlOrXmlUrl:function(a){return k.test(a)||
n.test(a)||l.test(a)||p.test(a)?!0:!1},isFilterUrl:function(a){return e.test(a)||f.test(a)},getFilterFromFilterUrl:function(a){if(e.test(a))return a=e.exec(a),a[2]+"\x3d"+a[3];if(f.test(a))return"filter\x3d"+f.exec(a)[2]},getJqlQueryFromJiraFilter:function(a,b,c,d){a=(e.exec(a)||f.exec(a))[2];b="/rest/jiraanywhere/1.0/jira/appLink/"+b+"/filter/"+a;AJS.$.ajax({async:!1,dataType:"json",url:Confluence.getContextPath()+b,success:c,error:d})},findServerIndexFromUrl:function(a,b){if("undefined"!==typeof b||
0<b.length)for(var c=a.toLowerCase(),d=0;d<b.length;d++)if(0==c.indexOf(b[d].url.toLowerCase())&&"/"==a.charAt(b[d].url.length))return d;return-1},getJqlQueryFromUrl:g,getJqlAndServerIndexFromUrl:function(a,b){var c={};c.serverIndex=this.findServerIndexFromUrl(a,b);c.jqlQuery=g(a);return c},checkQueryType:function(a){if(AJS.Editor.JiraAnalytics&&a&&0!=AJS.$.trim(a).length)return 0!=a.indexOf("http")?AJS.Editor.JiraAnalytics.linkTypes.jqlDirect:-1!=a.indexOf("jira.issueviews:searchrequest-xml")||-1!=
a.indexOf("jira.issueviews:issue-xml")?AJS.Editor.JiraAnalytics.linkTypes.xml:-1!=a.indexOf("jira.issueviews:searchrequest-rss")?AJS.Editor.JiraAnalytics.linkTypes.rss:-1!=a.indexOf("filter\x3d")||-1!=a.indexOf("filter\\\x3d")?AJS.Editor.JiraAnalytics.linkTypes.filter:AJS.Editor.JiraAnalytics.linkTypes.jql},convertToJQL:function(a,b){if(""!==AJS.$.trim(a))if(0===a.indexOf("http")&&this.isFilterUrl(a))var c=r(a,b);else 0===a.indexOf("http")&&this.isIssueUrlOrXmlUrl(a)?(a=g(decodeURIComponent(a)),0<
a.length&&(c=a)):c=0!==a.indexOf("http")&&a.match(q)?a:a.match(h)?"key\x3d"+a:'summary ~ "'+a+'" OR description ~ "'+a+'"';return c}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.components:editor-notifications', location = '/includes/js/editor-notifications.js' */
define("confluence/editor-notifications",[],function(){var a;return{notify:function(b,c,d){var e=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();void 0===d&&(d="error"===b?"manual":"auto");a=e({type:b,body:c,close:d})}}});require("confluence/module-exporter").safeRequire("confluence/editor-notifications",function(a){var b=require("confluence/api/event"),c=require("confluence/legacy");b.bind("init.rte",function(){c.EditorNotification=a})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = '/includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence-editor/legacy",["confluence/legacy"],function(a){"undefined"===typeof a&&(a={});"undefined"===typeof a.Editor&&(a.Editor={});return a.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert-utils",["underscore","confluence/meta","jquery"],function(c,b,d){return{insertFilePlaceholder:function(a,e,f){var g=require("tinymce");a.height="comment"===b.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.get("content-id")||"0",macro:{name:"view-file",params:a}};g.confluence.MacroUtils.insertMacro(a,
e).done(function(a){f&&d(a).click()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/utils/attachments-insert-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-internationalisation', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"The browser has blocked a popup opened by the Editor.",ctrl_key:"Ctrl",shift_key:"Shift",Close:"Close",searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},searchreplace_dlg:{allreplacedplural:"{0} replacements were made",
allreplacedsingular:"1 replacement was made",notfound:"No replacements were made",findlabel:"Find",replacelabel:"Replace",findnext:"Next",findprevious:"Previous",replace:"Replace",replaceall:"Replace all",
close:"Close"},advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"Emoticons"},emotions_dlg:{title:"Insert emoticon",desc:"Emoticons",smile:"Smile :)",sad:"Sad :(",tongue:"Tongue :p",biggrin:"Big grin :D",
wink:"Wink ;)",thumbs_up:"Thumbs up (y)",thumbs_down:"Thumbs down (n)",information:"Info (i)",check:"Tick (/)",error:"Error (x)",warning:"Warning (!)",add:"Plus (+)",forbidden:"Minus (-)",help_16:"Question mark (?)",
lightbulb_on:"Lightbulb on (on)",lightbulb:"Lightbulb off (off)",star_yellow:"Yellow star (*y)",star_red:"Red star (*r)",star_green:"Green star (*g)",star_blue:"Blue star (*b)",heart:"Heart \u003c3",broken_heart:"Broken heart \u003c/3"},confluence:{conf_macro_browser:"Macro",
conf_macro_browser_desc:"Insert macro",conf_image:"Image",confimage_desc:"Insert image",conf_file:"Files and images",confifile_desc:"Insert files and images",conf_link:"Link",conflink_desc:"Insert link",conf_table:"Table",
conf_wikimarkup:"Markup",conf_wikimarkup_desc:"Insert markup",conf_wikimarkup_errors:"Wiki markup conversion errors",conf_wikimarkup_timeout:"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.",conf_wikimarkup_hint:"Hint: you can also enter wiki markup directly in the editor, where it will be formatted as you type.",conf_wikimarkup_markdown_label:"Markdown",
conf_wikimarkup_confluence_label:"Confluence wiki",conf_shortcuts_help_desc:"Keyboard shortcuts help",conf_insert_button_title:"Insert"},table:{desc:"Insert table",row_before_desc:"Insert row above",row_after_desc:"Insert row below",delete_row_desc:"Delete row",
numbering_column_desc:"Insert numbering column",responsive:"Responsive",responsive_tooltip:"Table columns get wider as you add content. Drag column borders to set width relative to each other and the page.",fixed_width:"Fixed width",fixed_width_tooltip:"Drag column borders to set width. The table always appears at the width you set.",col_before_desc:"Insert column left",col_after_desc:"Insert column right",col_copy_desc:"Copy column",
col_paste_desc:"Paste column left",col_cut_desc:"Cut column",delete_col_desc:"Delete column",split_cells_desc:"Split merged cells",merge_cells_desc:"Merge cells",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"Paste row above",
paste_row_after_desc:"Paste row after",cut_row_desc:"Cut row",copy_row_desc:"Copy row",del:"Delete table",row:"Row",col:"Column",cell:"Cell",row_highlight:"Heading row",col_highlight:"Heading column",selection_highlight:"Change cell color",
invalid_table_field:"Rows and columns must both be numbers greater than zero.",table_more_heading:"Table settings",cell_background_color:"Background color : {0}",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",
row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"Format",paragraph:"Paragraph",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",
h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",blockquote:"Quote",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"Bold",italic_desc:"Italic",underline_desc:"Underline",
striketrough_desc:"Strikethrough",justifyleft_desc:"Align left",justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Bullet list",numlist_desc:"Numbered list",tasklist_desc:"Task list",
outdent_desc:"Outdent",indent_desc:"Indent",undo_desc:"Undo",redo_desc:"Redo",link_desc:"tinymce.advanced.link_desc",unlink_desc:"Unlink",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",
sub_desc:"Subscript",sup_desc:"Superscript",hr_desc:"Horizontal rule",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"Select text color",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"Symbol",visualaid_desc:"tinymce.advanced.visualaid_desc",
anchor_desc:"tinymce.advanced.anchor_desc",cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"Help",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",
newdocument:"tinymce.advanced.newdocument",toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",
h5_shortcut:"Ctrl+5",h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},
colorpicker:{more_colors:"More colors",title:"Select a color",picker_tab:"Picker",picker_title:"Color picker",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"Color",name:"tinymce.colorpicker.name",
apply:"tinymce.colorpicker.apply"},hints:{drafts:"Hint: Confluence saves drafts automatically. If you ever lose a window, recover your work from the \u0022Username -\u003e Drafts\u0022 menu.",dnd:"Hint: you can drag and drop images and Office files from your computer right into this editor.",insert_link_recently_viewed:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 to see a list of suggested pages and insert a link.",insert_link_search:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and part of a page title to find and link to that page.",insert_link_end:"Hint: press \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e after a word to find and link to relevant pages. Press it again for more suggestions.",insert_link_newpage:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and the title of a new page you wish to create, to see an insert link suggestion.",insert_link_user_mention:"Hint: you can mention somebody in Confluence by typing \u0022\u003cstrong\u003e@\u003c/strong\u003e\u0022 and then their name.",
insert_image_on_page:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 to see images attached to the page and insert one of them.",insert_image_search:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 and part of an image name to find and insert the image.",insert_image_end:"Hint: press \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e after a word to find and insert relevant images.",insert_wikimarkup:"Hint: the Editor will automatically convert wiki markup as you type it.",insert_wikimarkup_dialog:"Hint: press \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e to open the Wiki Markup dialog.",insert_link:"Hint: press \u003cstrong\u003eCtrl+K\u003c/strong\u003e to open the link browser.",insert_image:"Hint: press \u003cstrong\u003eCtrl+M\u003c/strong\u003e to open the image browser.",insert_macro:"Hint: press \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e to open the macro browser.",
insert_macro_toc:"Hint: Let Confluence generate you a table of contents for this page. Use \u0022Insert -\u003e Table of contents\u0022",insert_bullet_list:"Hint: press \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e to start a bullet list.",insert_numbered_list:"Hint: press \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e to start a numbered list.",insert_heading:"Hint: press \u003cstrong\u003eCtrl+1\u003c/strong\u003e to create a heading level 1, \u003cstrong\u003eCtrl+2\u003c/strong\u003e for heading level 2 and so on.",insert_table:"Hint: press \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e to insert a table.",table_rows_copy:"Hint: press \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e to copy a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",table_rows_cut:"Hint: press \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e to cut a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",insert_newline:"Hint: Type \u003cstrong\u003eShift+Enter\u003c/strong\u003e to insert a new paragraph without spacing",
autoformat_heading1:"Hint: Type \u0022\u003cstrong\u003eh1. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 1.",autoformat_heading3:"Hint: Type \u0022\u003cstrong\u003eh3. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 3.",autoformat_code:"Hint: Type \u0022\u003cstrong\u003e{{code}}\u003c/strong\u003e\u0022 to quickly insert monospaced text."},auiwindowmanager:{cancel:"Cancel",ok:"OK"},propertypanel:{links_goto:"Go to link",links_edit:"Edit",links_unlink:"Unlink",
links_goto_disabled_tooltip:"This link goes to content on the page you are editing",links_edit_tooltip:"Edit link in a dialogue",links_unlink_tooltip:"Replace link with the text it contains",images_small:"Small",images_medium:"Medium",images_large:"Large",images_original:"Original",
images_border:"Border",images_link_create:"Link",images_link_edit:"Edit link",images_link_remove:"Unlink",images_link_create_tooltip:"Link this image to other content",images_link_edit_tooltip:"Edit the link for this image",images_link_remove_tooltip:"Remove the link for this image",
images_sizing_tooltip:"Resize image to a specific width",images_small_tooltip:"Resize image to small and link to the original",images_medium_tooltip:"Resize image to medium and link to the original",images_large_tooltip:"Resize image to large and link to the original",images_original_tooltip:"Reset image size to original",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",
images_border_tooltip:"Display a border around image"},toolbar:{insert_files_shortcut_tooltip:"Ctrl+M"},a11ychecker:{btn_tooltip:"Check accessibility"}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~react~react-dom~table-styles-editor', location = 'vendors~react~react-dom~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[5],{148:function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;function c(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,f=c(e),l=1;l<arguments.length;l++){for(var a in r=Object(arguments[l]))o.call(r,a)&&(f[a]=r[a]);if(n){i=n(r);for(var s=0;s<i.length;s++)u.call(r,i[s])&&(f[i[s]]=r[i[s]])}}return f}},386:function(e,t,r){"use strict";
/** @license React v16.8.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(148),o="function"==typeof Symbol&&Symbol.for,u=o?Symbol.for("react.element"):60103,c=o?Symbol.for("react.portal"):60106,i=o?Symbol.for("react.fragment"):60107,f=o?Symbol.for("react.strict_mode"):60108,l=o?Symbol.for("react.profiler"):60114,a=o?Symbol.for("react.provider"):60109,s=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.concurrent_mode"):60111,y=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,v=o?Symbol.for("react.memo"):60115,m=o?Symbol.for("react.lazy"):60116,b="function"==typeof Symbol&&Symbol.iterator;function h(e,t,r,n,o,u,c,i){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,n,o,u,c,i],l=0;(e=Error(t.replace(/%s/g,(function(){return f[l++]})))).name="Invariant Violation"}throw e.framesToPop=1,e}}function g(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);h(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function w(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}function j(){}function k(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&g("85"),this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},j.prototype=w.prototype;var O=k.prototype=new j;O.constructor=k,n(O,w.prototype),O.isPureReactComponent=!0;var $={current:null},x={current:null},C=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var n=void 0,o={},c=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(c=""+t.key),t)C.call(t,n)&&!P.hasOwnProperty(n)&&(o[n]=t[n]);var f=arguments.length-2;if(1===f)o.children=r;else if(1<f){for(var l=Array(f),a=0;a<f;a++)l[a]=arguments[a+2];o.children=l}if(e&&e.defaultProps)for(n in f=e.defaultProps)void 0===o[n]&&(o[n]=f[n]);return{$$typeof:u,type:e,key:c,ref:i,props:o,_owner:x.current}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===u}var A=/\/+/g,I=[];function q(e,t,r,n){if(I.length){var o=I.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function M(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>I.length&&I.push(e)}function U(e,t,r){return null==e?0:function e(t,r,n,o){var i=typeof t;"undefined"!==i&&"boolean"!==i||(t=null);var f=!1;if(null===t)f=!0;else switch(i){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case u:case c:f=!0}}if(f)return n(o,t,""===r?"."+F(t,0):r),1;if(f=0,r=""===r?".":r+":",Array.isArray(t))for(var l=0;l<t.length;l++){var a=r+F(i=t[l],l);f+=e(i,a,n,o)}else if(null===t||"object"!=typeof t?a=null:a="function"==typeof(a=b&&t[b]||t["@@iterator"])?a:null,"function"==typeof a)for(t=a.call(t),l=0;!(i=t.next()).done;)f+=e(i=i.value,a=r+F(i,l++),n,o);else"object"===i&&g("31","[object Object]"===(n=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return f}(e,"",t,r)}function F(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function L(e,t){e.func.call(e.context,t,e.count++)}function N(e,t,r){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?T(e,n,r,(function(e){return e})):null!=e&&(R(e)&&(e=function(e,t){return{$$typeof:u,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+r)),n.push(e))}function T(e,t,r,n,o){var u="";null!=r&&(u=(""+r).replace(A,"$&/")+"/"),U(e,N,t=q(t,u,n,o)),M(t)}function V(){var e=$.current;return null===e&&g("307"),e}var D={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return T(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;U(e,L,t=q(null,null,t,r)),M(t)},count:function(e){return U(e,(function(){return null}),null)},toArray:function(e){var t=[];return T(e,t,null,(function(e){return e})),t},only:function(e){return R(e)||g("143"),e}},createRef:function(){return{current:null}},Component:w,PureComponent:k,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:y,render:e}},lazy:function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return V().useCallback(e,t)},useContext:function(e,t){return V().useContext(e,t)},useEffect:function(e,t){return V().useEffect(e,t)},useImperativeHandle:function(e,t,r){return V().useImperativeHandle(e,t,r)},useDebugValue:function(){},useLayoutEffect:function(e,t){return V().useLayoutEffect(e,t)},useMemo:function(e,t){return V().useMemo(e,t)},useReducer:function(e,t,r){return V().useReducer(e,t,r)},useRef:function(e){return V().useRef(e)},useState:function(e){return V().useState(e)},Fragment:i,StrictMode:f,Suspense:d,createElement:E,cloneElement:function(e,t,r){null==e&&g("267",e);var o=void 0,c=n({},e.props),i=e.key,f=e.ref,l=e._owner;if(null!=t){void 0!==t.ref&&(f=t.ref,l=x.current),void 0!==t.key&&(i=""+t.key);var a=void 0;for(o in e.type&&e.type.defaultProps&&(a=e.type.defaultProps),t)C.call(t,o)&&!P.hasOwnProperty(o)&&(c[o]=void 0===t[o]&&void 0!==a?a[o]:t[o])}if(1===(o=arguments.length-2))c.children=r;else if(1<o){a=Array(o);for(var s=0;s<o;s++)a[s]=arguments[s+2];c.children=a}return{$$typeof:u,type:e.type,key:i,ref:f,props:c,_owner:l}},createFactory:function(e){var t=E.bind(null,e);return t.type=e,t},isValidElement:R,version:"16.8.1",unstable_ConcurrentMode:p,unstable_Profiler:l,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:$,ReactCurrentOwner:x,assign:n}},W={default:D},z=W&&D||W;e.exports=z.default||z},66:function(e,t,r){"use strict";e.exports=r(386)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~table-styles-editor', location = 'vendors~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[34],{2:function(t,e,n){!function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var r="default"in n?n.default:n;function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){for(var o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];var l=0,u={};i=i.map((function(t){if(n.isValidElement(t)){var e="!PLACEHOLDER_".concat(++l,"!");return u[e]=t,e}return t}));var f=e.apply(void 0,[t].concat(a(i))).split(/(!PLACEHOLDER_\d+!)/g);if(1===f.length)return f.join("");var d=f.map((function(t,e){return r.createElement(n.Fragment,{key:e},e%2?u[t]:t)}));return r.createElement(n.Fragment,null,d)}var i={getText:function(){return console.warn('Call to "getText" function was not replaced with either raw translation or call to "format" function. Have you included the "jsI18n" transformation in Web Resource Manager?'),o.apply(void 0,arguments)}};t.I18n=i,t.format=o,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(393),n(66))}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_table-styles-editor', location = 'table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[23],{393:function(e,t){e.exports=WRM.format},394:function(e,t,l){},395:function(e,t,l){},403:function(e,t,l){"use strict";l.r(t);var c=l(12),f=l(2);const a={"000000":"Black 100%","172b4d":"Dark grey 100%","42526e":"Medium grey 100%","7a869a":"Medium grey 85%",c1c7d0:"Medium grey 45%",f4f5f7:"Light grey 100%",clear:"Clear fill",bf2600:"Dark red 100%",de350b:"Dark red 85%",ff5630:"Medium red 100%",ff7452:"Medium red 85%",ff8f73:"Medium red 65%",ffbdad:"Light red 100%",ffebe6:"Light red 35%",ff8b00:"Dark orange 100%",ff991f:"Dark orange 85%",ffab00:"Medium orange 100%",ffc400:"Medium yellow 100%",ffe380:"Medium yellow 45%",fff0b3:"Light yellow 100%",fffae6:"Light yellow 35%","006644":"Dark green 100%","00875a":"Dark green 85%","36b37e":"Medium green 100%","57d9a3":"Medium green 65%","79f2c0":"Medium green 45%",abf5d1:"Light green 100%",e3fcef:"Light green 35%","008da6":"Dark teal 100%","00a3bf":"Dark teal 85%","00b8d9":"Medium teal 100%","00c7e6":"Medium teal 85%","79e2f2":"Medium teal 45%",b3f5ff:"Light teal 100%",e6fcff:"Light teal 35%","0747a6":"Dark blue 100%","0052cc":"Dark blue 85%","0065ff":"Medium blue 100%","2684ff":"Medium blue 85%","4c9aff":"Medium blue 65%",b3d4ff:"Light blue 100%",deebff:"Light blue 35%",403294:"Dark purple 100%","5243aa":"Dark purple 85%","6554c0":"Medium purple 100%","8777d9":"Medium purple 85%","998dd9":"Medium purple 65%",c0b6f2:"Light purple 100%",eae6ff:"Light purple 35%"},n=["bf2600","ff8b00","006644","008da6","0747a6","403294","000000","de350b","ff991f","00875a","00a3bf","0052cc","5243aa","172b4d","ff5630","ffab00","36b37e","00b8d9","0065ff","6554c0","42526e","ff7452","ffc400","57d9a3","00c7e6","2684ff","8777d9","7a869a","ff8f73","ffe380","79f2c0","79e2f2","4c9aff","998dd9","c1c7d0","ffbdad","fff0b3","abf5d1","b3f5ff","b3d4ff","c0b6f2","f4f5f7","ffebe6","fffae6","e3fcef","e6fcff","deebff","eae6ff","clear"];l(394),l(395);Object(c.a)("confluence/table-color-names",()=>({colorNames:a,colorValues:n}))}},[[403,0,3,5,34,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_locale', location = 'locale.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[18],{150:function(e,r){e.exports=require("confluence/meta")},402:function(e,r,t){"use strict";t.r(r);var n={};t.r(n),t.d(n,"getUserLocale",(function(){return i}));var c=t(12),o=t(150),a=t.n(o);const i=()=>a.a.get("user-locale").replace("_","-").match(/^([a-zA-Z]{2,5}(-[a-zA-Z]+)?)/)[0];function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object(c.a)("confluence/locale",()=>function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},n))}},[[402,0,3,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-v4:editor-resources-v4', location = 'build/editor.js' */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="","undefined"!=typeof AJS&&(n.p=AJS.contextPath()+"/download/resources/com.atlassian.confluence.plugins.confluence-editor-v4:assets-06b4af98-771d-4f0b-b324-3bac839993ec/"),n(n.s=0)}({"./node_modules/@atlassian/aui-template/src/template.js":function(e,t,n){var r;"undefined"!=typeof self&&self,void 0===(r=function(){return function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r,o){var i=r;return n.replace(t,(function(e,t,n,r,a){t=t||r,i&&(t+":html"in i?(i=i[t+":html"],o=!0):t in i&&(i=i[t]),a&&"function"==typeof i&&(i=i()))})),null!=i&&i!==r||(i=e),i=String(i),o||(i=a.escape(i)),i},r=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t,!0)})),this},o=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t)})),this},i=function(){return this.template},a=function(e){function t(){return t.template}return t.template=String(e),t.toString=t.valueOf=i,t.fill=o,t.fillHtml=r,t},c={},u=[];a.load=function(e){if(e=String(e),!c.hasOwnProperty(e)){u.length>=1e3&&delete c[u.shift()],u.push(e);var t=function(e){return document.querySelector('script[title="'+e+'"]')}(e);t&&(c[e]=t.text)}return this(c[e])};var l={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#96;"},s=new RegExp("["+Object.keys(l).join("")+"]","g");return a.escape=function(e){return String(e||"").replace(s,(function(e){return l[e]}))},a}()}.call(t,n,t,e))||(e.exports=r)},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/a11ychecker/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation]{outline:2px dashed;transition:outline-width .1s ease-in-out,background-color .1s ease-in-out}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=info]{outline-color:#0747a6;background-color:#deebff}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=warning]{outline-color:#ff8b00;background-color:#fffae6}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=error]{outline-color:#bf2600;background-color:#ffebe6}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#charmap-picker{border:0;font-size:16px;font-family:Arial,Helvetica,FreeSans,sans-serif;padding:2px;text-align:center}#charmap-view{padding-right:1em;text-align:left;vertical-align:top}#charmap-info{text-align:center;vertical-align:top;width:100%}#charmap-info>table{border:0;height:100px;padding:0;width:100%}#code-value{font-size:3em}#code-name{font-size:13px}#code-name,#code-value{color:#666;text-align:center}.charmap a:active,.charmap a:hover,.charmap a:link,.charmap a:visited{color:#326ca6;text-decoration:none}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:transparent;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,'.aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,"monospace";margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}',""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"body.ios{min-height:150px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon{background-color:#42526e}#property-panel a.macro-property-panel-Green span.icon{background-color:#00875a}#property-panel a.macro-property-panel-Red span.icon{background-color:#bf2600}#property-panel a.macro-property-panel-Yellow span.icon{background-color:#ff991f}#property-panel a.macro-property-panel-Blue span.icon{background-color:#0052cc}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".mce-content-body .mce-visual-caret{background-color:#000;background-color:currentColor;position:absolute}.mce-content-body .mce-visual-caret-hidden{display:none}.mce-content-body [data-mce-caret]{left:-1000px;margin:0;padding:0;position:absolute;right:auto;top:0}.mce-offscreen-selection{left:-2000000px;max-width:1000000px;position:absolute}",""])},"./node_modules/css-loader/dist/runtime/api.js":function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),i=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(i).concat([o]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},"./node_modules/process/browser.js":function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],s=!1,f=-1;function d(){s&&u&&(s=!1,u.length?l=u.concat(l):f=-1,l.length&&m())}function m(){if(!s){var e=c(d);s=!0;for(var t=l.length;t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||s||c(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/querystring-es3/decode.js":function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var c=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var s=0;s<l;++s){var f,d,m,p,g=e[s].replace(c,"%20"),h=g.indexOf(n);h>=0?(f=g.substr(0,h),d=g.substr(h+1)):(f=g,d=""),m=decodeURIComponent(f),p=decodeURIComponent(d),r(a,m)?o(a[m])?a[m].push(p):a[m]=[a[m],p]:a[m]=p}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"./node_modules/querystring-es3/encode.js":function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var c=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[a]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"./node_modules/querystring-es3/index.js":function(e,t,n){"use strict";t.decode=t.parse=n("./node_modules/querystring-es3/decode.js"),t.encode=t.stringify=n("./node_modules/querystring-es3/encode.js")},"./node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,c,u=1,l={},s=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return l[u]=o,r(u),u++},d.clearImmediate=m}function m(e){delete l[e]}function p(e){if(s)setTimeout(p,0,e);else{var t=l[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{m(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/style-loader/lib/addStyles.js":function(e,t,n){var r,o,i={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=r.apply(this,arguments)),o}),c=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=c.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),l=null,s=0,f=[],d=n("./node_modules/style-loader/lib/urls.js");function m(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(y(r.parts[a],t))}else{var c=[];for(a=0;a<r.parts.length;a++)c.push(y(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:c}}}}function p(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function g(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),f.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=u(e.insertAt.before,n);n.insertBefore(t,o)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return b(t,e.attrs),g(e,t),t}function b(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,r,o,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var a=s++;n=l||(l=v(t)),r=x.bind(null,n,a,!1),o=x.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",b(t,e.attrs),g(e,t),t}(t),r=S.bind(null,n,t),o=function(){h(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),r=k.bind(null,n),o=function(){h(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return m(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o];(c=i[a.id]).refs--,r.push(c)}e&&m(p(e,t),t);for(o=0;o<r.length;o++){var c;if(0===(c=r[o]).refs){for(var u=0;u<c.parts.length;u++)c.parts[u]();delete i[c.id]}}}};var w,C=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function x(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=C(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function k(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function S(e,t,n){var r=n.css,o=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(r=d(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(a),c&&URL.revokeObjectURL(c)}},"./node_modules/style-loader/lib/urls.js":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},"./node_modules/timers-browserify/main.js":function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("./node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/tinymce/plugins/lists/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/lists/plugin.js")},"./node_modules/tinymce/plugins/lists/plugin.js":function(e,t){!function(){"use strict";var e,t,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(){},a=function(e){return function(){return e}},c=function(e){return function(t){return!e(t)}},u=a(!1),l=a(!0),s=function(){return f},f=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e};return{fold:function(e,t){return e()},is:u,isSome:u,isNone:l,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:n,orThunk:t,map:s,each:i,bind:s,exists:u,forall:l,filter:s,equals:e,equals_:e,toArray:function(){return[]},toString:a("none()")}}(),d=function(e){var t=a(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return o},m={some:d,none:s,from:function(e){return null==e?f:d(e)}},p=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},g=function(e){return function(t){return typeof t===e}},h=p("string"),v=p("array"),b=g("boolean"),y=g("function"),w=g("number"),C=Array.prototype.slice,x=Array.prototype.push,k=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},S=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},T=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},E=function(e,t,n){return S(e,(function(e){n=t(n,e)})),n},_=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return m.some(i);if(n(i,r))break}return m.none()},A=function(e,t){return _(e,t,u)},N=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!v(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);x.apply(t,e[n])}return t}(k(e,t))},R=function(e){var t=C.call(e,0);return t.reverse(),t},O=function(e,t){return t>=0&&t<e.length?m.some(e[t]):m.none()},D=function(e){return O(e,0)},I=function(e){return O(e,e.length-1)},P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B=function(){return M(0,0)},M=function(e,t){return{major:e,minor:t}},L={nu:M,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?B():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return M(r(1),r(2))}(e,n)},unknown:B},F=function(e,t){var n=String(t).toLowerCase();return A(e,(function(e){return e.search(n)}))},j=function(e,t){return F(e,t).map((function(e){var n=L.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},H=function(e,t){return F(e,t).map((function(e){var n=L.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},U=function(e,t){return-1!==e.indexOf(t)},z=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,W=function(e){return function(t){return U(t,e)}},q=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return U(e,"edge/")&&U(e,"chrome")&&U(e,"safari")&&U(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,z],search:function(e){return U(e,"chrome")&&!U(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return U(e,"msie")||U(e,"trident")}},{name:"Opera",versionRegexes:[z,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:W("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:W("firefox")},{name:"Safari",versionRegexes:[z,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(U(e,"safari")||U(e,"mobile/"))&&U(e,"applewebkit")}}],V=[{name:"Windows",search:W("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return U(e,"iphone")||U(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:W("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:W("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:W("linux"),versionRegexes:[]},{name:"Solaris",search:W("sunos"),versionRegexes:[]},{name:"FreeBSD",search:W("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:W("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],$={browsers:a(q),oses:a(V)},K=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},J={unknown:function(){return K({current:void 0,version:L.unknown()})},nu:K,edge:a("Edge"),chrome:a("Chrome"),ie:a("IE"),opera:a("Opera"),firefox:a("Firefox"),safari:a("Safari")},G=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},X={unknown:function(){return G({current:void 0,version:L.unknown()})},nu:G,windows:a("Windows"),ios:a("iOS"),android:a("Android"),linux:a("Linux"),osx:a("OSX"),solaris:a("Solaris"),freebsd:a("FreeBSD"),chromeos:a("ChromeOS")},Y=function(e,t){var n=$.browsers(),r=$.oses(),o=j(n,e).fold(J.unknown,J.nu),i=H(r,e).fold(X.unknown,X.nu),c=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,c=e.isiOS()||e.isAndroid(),u=c||r("(pointer:coarse)"),l=o||!i&&c&&r("(min-device-width:768px)"),s=i||c&&!l,f=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!s&&!l&&!f;return{isiPad:a(o),isiPhone:a(i),isTablet:a(l),isPhone:a(s),isTouch:a(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:a(f),isDesktop:a(d)}}(i,o,e,t);return{browser:o,os:i,deviceType:c}},Q=function(e){return window.matchMedia(e).matches},Z=(e=function(){return Y(navigator.userAgent,Q)},n=!1,function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}),ee=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},te={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ee(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return ee(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return ee(n)},fromDom:ee,fromPoint:function(e,t,n){return m.from(e.dom.elementFromPoint(t,n)).map(ee)}},ne=function(e,t){return e.dom===t.dom},re=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},oe=function(e,t){return Z().browser.isIE()?re(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ie=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ae=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),ce=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ue=tinymce.util.Tools.resolve("tinymce.util.VK"),le=Object.keys,se=function(e,t){for(var n=le(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},fe=function(e,t){var n={};return function(e,t,n,r){se(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),i),n},de=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),me=(r=1,function(e){return function(e){return e.dom.nodeType}(e)===r}),pe=function(e,t){var n=e.dom;se(t,(function(e,t){!function(e,t,n){if(!(h(n)||b(n)||w(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(n,t,e)}))},ge=function(e){return E(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},he=function(e){return m.from(e.dom.parentNode).map(te.fromDom)},ve=function(e){return k(e.dom.childNodes,te.fromDom)},be=function(e,t){var n=e.dom.childNodes;return m.from(n[t]).map(te.fromDom)},ye=function(e){return be(e,0)},we=function(e){return be(e,e.dom.childNodes.length-1)},Ce=function(e,t){he(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},xe=function(e,t){e.dom.appendChild(t.dom)},ke=function(e,t){S(t,(function(t){xe(e,t)}))},Se=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Te=function(e){return function(e,t){return te.fromDom(e.dom.cloneNode(t))}(e,!0)},Ee=function(e,t){var n=function(e,t){var n=te.fromTag(t),r=ge(e);return pe(n,r),n}(e,t);Ce(e,n);var r=ve(e);return ke(n,r),Se(e),n},_e=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ae=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ne=function(e){return function(t){return t&&t.nodeName.toLowerCase()===e}},Re=function(e){return function(t){return t&&e.test(t.nodeName)}},Oe=function(e){return e&&3===e.nodeType},De=Re(/^(OL|UL|DL)$/),Ie=Re(/^(OL|UL)$/),Pe=Ne("ol"),Be=Re(/^(LI|DT|DD)$/),Me=Re(/^(DT|DD)$/),Le=Re(/^(TH|TD)$/),Fe=Ne("br"),je=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},He=function(e,t){return e&&e.nodeName in t},Ue=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},ze=function(e,t){return e.isChildOf(t,e.getRoot())},We=function(e,t){var n,r,o,i=e.dom,a=e.schema.getBlockElements(),c=i.createFragment(),u=function(e){var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t}(e);if(u&&((r=i.create(u)).tagName===u.toUpperCase()&&i.setAttribs(r,function(e){return e.getParam("forced_root_block_attrs",{})}(e)),He(t.firstChild,a)||c.appendChild(r)),t)for(;n=t.firstChild;){var l=n.nodeName;o||"SPAN"===l&&"bookmark"===n.getAttribute("data-mce-type")||(o=!0),He(n,a)?(c.appendChild(n),r=null):u?(r||(r=i.create(u),c.appendChild(r)),r.appendChild(n)):c.appendChild(n)}return u?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):c.appendChild(i.create("br")),c},qe=_e.DOM,Ve=function(e,t){ie(t,"dd")?Ee(t,"dt"):ie(t,"dt")&&he(t).each((function(n){return function(e,t,n){var r=qe.select('span[data-mce-type="bookmark"]',t),o=We(e,n),i=qe.createRng();i.setStartAfter(n),i.setEndAfter(t);for(var a,c=i.extractContents(),u=c.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){qe.remove(u);break}e.dom.isEmpty(c)||qe.insertAfter(c,t),qe.insertAfter(o,t),Ue(e.dom,n.parentNode)&&(a=n.parentNode,Ae.each(r,(function(e){a.parentNode.insertBefore(e,n.parentNode)})),qe.remove(a)),qe.remove(n),Ue(e.dom,t)&&qe.remove(t)}(e,n.dom,t.dom)}))},$e=function(e){ie(e,"dt")&&Ee(e,"dd")},Ke=function(e,t){if(Oe(e))return{container:e,offset:t};var n=ae.getNode(e,t);return Oe(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Oe(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Oe(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},Je=function(e){var t=e.cloneRange(),n=Ke(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Ke(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},Ge=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Xe=function(e,t){var n=t||e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",Ze(e,n))},Ye=function(e){var t=Xe(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return Ae.grep(e.querySelectorAll("ol,ul,dl"),(function(e){return De(e)}))}(t):Ae.grep(n,(function(e){return De(e)&&t!==e}))},Qe=function(e){var t=e.selection.getSelectedBlocks();return Ae.grep(function(e,t){var n=Ae.map(t,(function(t){var n=e.dom.getParent(t,"li,dd,dt",Ze(e,t));return n||t}));return Ge.unique(n)}(e,t),(function(e){return Be(e)}))},Ze=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},et=function(e,t){var n=e.dom.getParents(t,"ol,ul",Ze(e,t));return I(n)},tt=function(e){var t=function(e){var t=et(e,e.selection.getStart()),n=T(e.selection.getSelectedBlocks(),Ie);return t.toArray().concat(n)}(e);return nt(e,t)},nt=function(e,t){var n=k(t,(function(t){return et(e,t).getOr(t)}));return Ge.unique(n)},rt=function(e,t,n){return e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none()},ot=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},it=function(e,t,n){if(!h(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(function(e){return void 0!==e.style&&y(e.style.getPropertyValue)})(e)&&e.style.setProperty(t,n)},at=function(e,t){xe(e.item,t.list)},ct=function(e,t){var n={list:te.fromTag(t,e),item:te.fromTag("li",e)};return xe(n.list,n.item),n},ut=function(e,t,n){var r=t.slice(0,n.depth);return I(r).each((function(t){!function(e,t){xe(e.list,t),e.item=t}(t,function(e,t,n){var r=te.fromTag("li",e);return pe(r,t),ke(r,n),r}(e,n.itemAttributes,n.content)),function(e,t){de(e.list)!==t.listType&&(e.list=Ee(e.list,t.listType)),pe(e.list,t.listAttributes)}(t,n)})),r},lt=function(e,t,n){var r,o=function(e,t,n){for(var r=[],o=0;o<n;o++)r.push(ct(e,t.listType));return r}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)at(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item,o="list-style-type",i="none",a=void 0,a=r.dom,it(a,o,i);var r,o,i,a;I(e).each((function(e){pe(e.list,t.listAttributes),pe(e.item,t.itemAttributes),ke(e.item,t.content)}))}(o,n),r=o,rt(I(t),D(r),at),t.concat(o)},st=function(e){return ie(e,"OL,UL")},ft=function(e){return ye(e).map(st).getOr(!1)},dt=function(e){return e.depth>0},mt=function(e){return e.isSelected},pt=function(e){var t=ve(e),n=we(e).map(st).getOr(!1)?t.slice(0,-1):t;return k(n,Te)},gt=function(e){return S(e,(function(t,n){(function(e,t){var n=e[t].depth,r=function(e){return e.depth===n&&!e.dirty},o=function(e){return e.depth<n};return _(R(e.slice(0,t)),r,o).orThunk((function(){return _(e.slice(t+1),r,o)}))})(e,n).fold((function(){t.dirty&&function(e){e.listAttributes=fe(e.listAttributes,(function(e,t){return"start"!==t}))}(t)}),(function(e){return r=e,(n=t).listType=r.listType,void(n.listAttributes=P({},r.listAttributes));var n,r}))})),e},ht=function(e,t,n,r){return ye(r).filter(st).fold((function(){t.each((function(e){ne(e.start,r)&&n.set(!0)}));var o=function(e,t,n){return he(e).filter(me).map((function(r){return{depth:t,dirty:!1,isSelected:n,content:pt(e),itemAttributes:ge(e),listAttributes:ge(r),listType:de(r)}}))}(r,e,n.get());t.each((function(e){ne(e.end,r)&&n.set(!1)}));var i=we(r).filter(st).map((function(r){return vt(e,t,n,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return vt(e,t,n,r)}))},vt=function(e,t,n,r){return N(ve(r),(function(r){return(st(r)?vt:ht)(e+1,t,n,r)}))},bt=function(e,t){var n=gt(t);return k(n,(function(t){var n,r,o,i=(n=t.content,o=(r||document).createDocumentFragment(),S(n,(function(e){o.appendChild(e.dom)})),te.fromDom(o));return te.fromDom(We(e,i.dom))}))},yt=function(e,t){var n=gt(t);return function(e,t){var n=E(t,(function(t,n){return n.depth>t.length?lt(e,t,n):ut(e,t,n)}),[]);return D(n).map((function(e){return e.list}))}(e.contentDocument,n).toArray()},wt=function(e,t,n){var r=function(e,t){var n,r=(n=!1,{get:function(){return n},set:function(e){n=e}});return k(e,(function(e){return{sourceList:e,entries:vt(0,t,r,e)}}))}(t,function(e){var t=k(Qe(e),te.fromDom);return rt(A(t,c(ft)),A(R(t),c(ft)),(function(e,t){return{start:e,end:t}}))}(e));S(r,(function(t){!function(e,t){S(T(e,mt),(function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0}(t,e)}))}(t.entries,n);var r,o=function(e,t){return N(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r}(t,dt),(function(t){return D(t).map(dt).getOr(!1)?yt(e,t):bt(e,t)}))}(e,t.entries);S(o,(function(t){ot(e,"Indent"===n?"IndentList":"OutdentList",t.dom)})),r=t.sourceList,S(o,(function(e){Ce(r,e)})),Se(t.sourceList)}))},Ct=function(e,t){var n=k(tt(e),te.fromDom),r=k(function(e){return T(Qe(e),Me)}(e),te.fromDom),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();wt(e,n,t),function(e,t,n){S(n,"Indent"===t?$e:function(t){return Ve(e,t)})}(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(Je(e.selection.getRng())),e.nodeChanged(),o=!0}return o},xt=function(e){return Ct(e,"Indent")},kt=function(e){return Ct(e,"Outdent")},St=function(e){return Ct(e,"Flatten")},Tt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),Et=_e.DOM,_t=function(e){var t={},n=function(n){var r,o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(r=Et.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):Et.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=i};return n(!0),e.collapsed||n(),t},At=function(e){function t(t){var n,r,o;n=o=e[t?"startContainer":"endContainer"],r=e[t?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(n),n=n.parentNode,Et.remove(o),!n.hasChildNodes()&&Et.isBlock(n)&&n.appendChild(Et.create("br"))),e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=r)}t(!0),t();var n=Et.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),Je(n)},Nt=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Rt=function(e){return/\btox\-/.test(e.className)},Ot=function(e,t,n){var r=function(e){var r=_(e.parents,De,Le).filter((function(e){return e.nodeName===t&&!Rt(e)})).isSome();n(r)},o=e.dom.getParents(e.selection.getNode());return r({parents:o}),e.on("NodeChange",r),function(){return e.off("NodeChange",r)}},Dt=function(e,t){Ae.each(t,(function(t,n){e.setAttribute(n,t)}))},It=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){Dt(t,n["list-attributes"]),Ae.each(e.select("li",t),(function(e){Dt(e,n["list-item-attributes"])}))}(e,t,n)},Pt=function(e,t,n,r){var o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&Fe(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(je(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Bt=function(e,t,n){void 0===n&&(n={});var r=e.selection.getRng(),o="LI",i=Ze(e,e.selection.getStart(!0)),a=e.dom;if("false"!==a.getContentEditable(e.selection.getNode())){"DL"===(t=t.toUpperCase())&&(o="DT");var c=_t(r);Ae.each(function(e,t,n){for(var r,o=[],i=e.dom,a=Pt(e,t,!0,n),c=Pt(e,t,!1,n),u=[],l=a;l&&(u.push(l),l!==c);l=l.nextSibling);return Ae.each(u,(function(t){if(je(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||Fe(t))return Fe(t)&&i.remove(t),void(r=null);var a=t.nextSibling;Tt.isBookmarkNode(t)&&(je(e,a)||!a&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,r,i),(function(r){var i,c=r.previousSibling;c&&De(c)&&c.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(a,c,n)?(i=c,r=a.rename(r,o),c.appendChild(r)):(i=a.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=a.rename(r,o)),function(e,t,n){Ae.each(n,(function(n){var r;return e.setStyle(t,((r={})[n]="",r))}))}(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),It(a,i,n),Lt(e.dom,i)})),e.selection.setRng(At(c))}},Mt=function(e,t,n){return function(e,t){return e&&t&&De(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},Lt=function(e,t){var n,r;if(n=t.nextSibling,Mt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,Mt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},Ft=function(e,t,n,r,o){if(t.nodeName!==r||jt(o)){var i=_t(e.selection.getRng(!0));Ae.each([t].concat(n),(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);It(e.dom,o,r),ot(e,Nt(n),o)}else It(e.dom,t,r),ot(e,Nt(n),t)}(e,t,r,o)})),e.selection.setRng(At(i))}else St(e)},jt=function(e){return"list-style-type"in e},Ht=function(e,t,n){var r=Xe(e),o=Ye(e);n=n||{},r&&o.length>0?Ft(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||jt(r)||Rt(t)){var o=_t(e.selection.getRng(!0));It(e.dom,t,r);var i=e.dom.rename(t,n);Lt(e.dom,i),e.selection.setRng(At(o)),ot(e,Nt(n),i)}else St(e);else Bt(e,n,r),ot(e,Nt(n),t)}(e,r,t,n)},Ut=_e.DOM,zt=function(e,t){Ae.each(Ae.grep(e.select("ol,ul",t)),(function(t){!function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),Ue(e,r)&&Ut.remove(r)):Ut.setStyle(r,"listStyleType","none")),De(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)}(e,t)}))},Wt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(Oe(o)&&(n?i<o.data.length:i>0))return o;var a=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ae.getNode(o,i));var c=new ce(o,r);for(n&&function(e,t){return!!Fe(t)&&(e.isBlock(t.nextSibling)&&!Fe(t.previousSibling))}(e.dom,o)&&c.next();o=c[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(a[o.nodeName])return o;if(Oe(o)&&o.data.length>0)return o}},qt=function(e,t){var n=t.childNodes;return 1===n.length&&!De(n[0])&&e.isBlock(n[0])},Vt=function(e,t,n){var r,o=qt(e,n)?n.firstChild:n;if(function(e,t){qt(e,t)&&e.remove(t.firstChild,!0)}(e,t),!Ue(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},$t=function(e,t,n){var r,o=t.parentNode;if(ze(e,t)&&ze(e,n)){De(n.lastChild)&&(r=n.lastChild),o===n.lastChild&&Fe(o.previousSibling)&&e.remove(o.previousSibling);var i=n.lastChild;i&&Fe(i)&&t.hasChildNodes()&&e.remove(i),Ue(e,n,!0)&&e.$(n).empty(),Vt(e,t,n),r&&n.appendChild(r);var a=oe(te.fromDom(n),te.fromDom(t))?e.getParents(t,De,n):[];e.remove(t),S(a,(function(t){Ue(e,t)&&t!==e.getRoot()&&e.remove(t)}))}},Kt=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),$t(e.dom,t,n),e.selection.setCursorLocation(n)}(e,n,r);else{var i=_t(t);$t(o,n,r),e.selection.setRng(At(i))}},Jt=function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=Ze(e,o),a=n.getParent(r.getStart(),"LI",i);if(a){var c=a.parentNode;if(c===e.getBody()&&Ue(n,c))return!0;var u=Je(r.getRng()),l=n.getParent(Wt(e,u,t,i),"LI",i);if(l&&l!==a)return e.undoManager.transact((function(){var n;t?Kt(e,u,l,a):(n=a).parentNode.firstChild===n?kt(e):function(e,t,n,r){var o=_t(t);$t(e.dom,n,r);var i=At(o);e.selection.setRng(i)}(e,u,a,l)})),!0;if(!l&&!t&&0===u.startOffset&&0===u.endOffset)return e.undoManager.transact((function(){St(e)})),!0}return!1},Gt=function(e,t){return Jt(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=Ze(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var a=Je(e.selection.getRng()),c=n.getParent(Wt(e,a,t,o),"LI",o);if(c)return e.undoManager.transact((function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),Lt(n,c.parentNode),e.selection.select(c,!0),e.selection.collapse(t)})),!0}return!1}(e,t)},Xt=function(e,t){return e.selection.isCollapsed()?Gt(e,t):function(e){var t=e.selection.getStart(),n=Ze(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||Qe(e).length>0)&&(e.undoManager.transact((function(){e.execCommand("Delete"),zt(e.dom,e.getBody())})),!0)}(e)},Yt=function(e){var t=e.dom,n=Xe(e);Pe(n)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:t.getAttrib(n,"start")||"1"},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(n){var r=n.getData();e.undoManager.transact((function(){t.setAttrib(Xe(e),"start","1"===r.start?"":r.start)})),n.close()}})},Qt=function(e,t){return function(){var n=e.dom.getParent(e.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===t}},Zt=function(e){(function(e){return e.getParam("lists_indent_on_tab",!0)})(e)&&function(e){e.on("keydown",(function(t){t.keyCode!==ue.TAB||ue.metaKeyPressed(t)||e.undoManager.transact((function(){(t.shiftKey?kt(e):xt(e))&&t.preventDefault()}))}))}(e),function(e){e.on("keydown",(function(t){t.keyCode===ue.BACKSPACE?Xt(e,!1)&&t.preventDefault():t.keyCode===ue.DELETE&&Xt(e,!0)&&t.preventDefault()}))}(e)};o.add("lists",(function(e){return!1===e.hasPlugin("rtc",!0)&&(Zt(e),function(e){e.on("BeforeExecCommand",(function(t){var n=t.command.toLowerCase();"indent"===n?xt(e):"outdent"===n&&kt(e)})),e.addCommand("InsertUnorderedList",(function(t,n){Ht(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Ht(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Ht(e,"DL",n)})),e.addCommand("RemoveList",(function(){St(e)})),e.addCommand("mceListProps",(function(){Yt(e)})),e.addQueryStateHandler("InsertUnorderedList",Qt(e,"UL")),e.addQueryStateHandler("InsertOrderedList",Qt(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",Qt(e,"DL"))}(e)),function(e){var t=function(t){return function(){return e.execCommand(t)}};e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return Ot(e,"OL",t.setActive)}}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return Ot(e,"UL",t.setActive)}}))}(e),function(e){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return Yt(e)},onSetup:function(t){return Ot(e,"OL",(function(e){return t.setDisabled(!e)}))}};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:function(t){var n=Xe(e,t);return Pe(n)?["listprops"]:[]}})}(e),function(e){return{backspaceDelete:function(t){Xt(e,t)}}}(e)}))}()},"./node_modules/tinymce/plugins/paste/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/paste/plugin.js")},"./node_modules/tinymce/plugins/paste/plugin.js":function(e,t){!function(){"use strict";var e,t,n,r,o=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(){},c=function(e){return function(){return e}},u=c(!1),l=c(!0),s=function(){return f},f=(e=function(e){return e.isNone()},{fold:function(e,t){return e()},is:u,isSome:u,isNone:l,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:n,orThunk:t,map:s,each:a,bind:s,exists:u,forall:l,filter:s,equals:e,equals_:e,toArray:function(){return[]},toString:c("none()")}),d=function(e){var t=c(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return o},m={some:d,none:s,from:function(e){return null==e?f:d(e)}},p=function(e){return!function(e){return null==e}(e)},g=(r="function",function(e){return typeof e===r}),h=Array.prototype.slice,v=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},b=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},y=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},w=g(Array.from)?Array.from:function(e){return h.call(e)},C=function(){var e=o(m.none());return{clear:function(){return e.set(m.none())},set:function(t){return e.set(m.some(t))},isSet:function(){return e.get().isSome()},on:function(t){return e.get().each(t)}}},x=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},k=tinymce.util.Tools.resolve("tinymce.Env"),S=tinymce.util.Tools.resolve("tinymce.util.Delay"),T=tinymce.util.Tools.resolve("tinymce.util.Promise"),E=tinymce.util.Tools.resolve("tinymce.util.VK"),_=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},A=tinymce.util.Tools.resolve("tinymce.util.Tools"),N=function(e){return e.getParam("paste_data_images",!1)},R=function(e){return e.getParam("paste_merge_formats",!0)},O=function(e){return e.getParam("paste_retain_style_properties")},D=function(e){return e.getParam("validate")},I=function(e){return e.getParam("allow_html_data_urls",!1,"boolean")},P=function(e){return e.getParam("paste_data_images",!1,"boolean")},B=function(e){return A.explode(e.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},M=function(e){return-1!==e.indexOf("\x3c!-- x-tinymce/html --\x3e")},L=tinymce.util.Tools.resolve("tinymce.html.Entities"),F=function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n,r=[],o="<"+e;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&r.push(n+'="'+L.encodeAllRaw(t[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"}(t,n),i="</"+t+">",a=A.map(r,(function(e){return e.split(/\n/).join("<br />")}));return 1===a.length?a[0]:A.map(a,(function(e){return o+e+i})).join("")},j=tinymce.util.Tools.resolve("tinymce.html.DomParser"),H=tinymce.util.Tools.resolve("tinymce.html.Serializer"),U=tinymce.util.Tools.resolve("tinymce.html.Node"),z=tinymce.util.Tools.resolve("tinymce.html.Schema");function W(e,t){return A.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e}function q(e){return e=W(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?"":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function V(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function $(e){var t;return e=e.replace(/^[\u00a0 ]+/,""),A.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(n){if(n.test(e))return t=!0,!1})),t}function K(e){var t,n,r=1;function o(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t}function i(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0}function a(e,o,a){var c=e._listLevel||r;c!==r&&(c<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new U(o,1),a>1&&t.attr("start",""+a),e.wrap(t)),e.name="li",c>r&&n&&n.lastChild.append(t),r=c,function e(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)do{e(t)}while(t=t.next)}(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)}for(var c=[],u=e.firstChild;null!=u;)if(c.push(u),null!==(u=u.walk()))for(;void 0!==u&&u.parent!==e;)u=u.walk();for(var l=0;l<c.length;l++)if("p"===(e=c[l]).name&&e.firstChild){var s=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(s)){a(e,"ul");continue}if($(s)){var f=/([0-9]+)\./.exec(s),d=1;f&&(d=parseInt(f[1],10)),a(e,"ol",d);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}function J(e,t,n,r){var o,i={},a=e.dom.parseStyle(r);return A.each(a,(function(a,c){switch(c){case"mso-list":(o=/\w+ \w+([0-9]+)/i.exec(r))&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":c="text-align";break;case"vert-align":c="vertical-align";break;case"font-color":case"mso-foreground":c="color";break;case"mso-background":case"mso-highlight":c="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(i[c]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove()}0!==c.indexOf("mso-comment")?0!==c.indexOf("mso-")&&("all"===O(e)||t&&t[c])&&(i[c]=a):n.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new U("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new U("i",1))),(i=e.dom.serializeStyle(i,n.name))||null}var G,X,Y=function(e,t){return function(e){return e.getParam("paste_enable_default_filters",!0)}(e)?function(e,t){var n,r=O(e);r&&(n=A.makeMap(r.split(/[, ]/))),t=W(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,""],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(""):""}]]);var o=function(e){return e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}(e),i=z({valid_elements:o,valid_children:"-li[p]"});A.each(i.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=j({},i);a.addAttributeFilter("style",(function(t){for(var r,o=t.length;o--;)(r=t[o]).attr("style",J(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()})),a.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),a.addNodeFilter("a",(function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var c=a.parse(t);return function(e){return e.getParam("paste_convert_word_fake_lists",!0)}(e)&&K(c),t=H({validate:D(e)},i).serialize(c)}(e,t):t},Q=function(e,t){return{content:e,cancelled:t}},Z=function(e,t,n,r){var o=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})}(e,t,n,r),i=function(e,t){var n=j({},e.schema);n.addNodeFilter("meta",(function(e){A.each(e,(function(e){e.remove()}))}));var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return H({validate:D(e)},e.schema).serialize(r)}(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),i=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})}(e,o,n,r);return Q(i.node.innerHTML,i.isDefaultPrevented())}(e,i,n,r):Q(i,o.isDefaultPrevented())},ee=function(e,t){return e.insertContent(t,{merge:R(e),paste:!0}),!0},te=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},ne=function(e,t){return te(t)&&v(B(e),(function(e){return x(n=t,r="."+e,n.length-r.length);var n,r}))},re=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!te(t))&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0}(e,t,n)},oe=function(e,t,n){return!!ne(e,t)&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0}(e,t,n)},ie=function(e,t,n){n||!1===function(e){return e.getParam("smart_paste",!0)}(e)?ee(e,t):function(e,t){A.each([re,oe,ee],(function(n){return!0!==n(e,t,ee)}))}(e,t)},ae=function(e){return"\n"===e||"\r"===e},ce=function(e,t){var n,r,o=(n=" ",(r=function(e){return e.getParam("paste_tab_spaces",4,"number")}(e))<=0?"":new Array(r+1).join(n)),i=t.replace(/\t/g,o);return function(e,t,n){return y(e,(function(e){n=t(n,e)})),n}(i,(function(e,t){return function(e){return-1!==" \f\t\v".indexOf(e)}(t)||""===t?e.pcIsSpace||""===e.str||e.str.length===i.length-1||function(e,t){return t<e.length&&t>=0&&ae(e[t])}(i,e.str.length+1)?{pcIsSpace:!1,str:e.str+""}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:ae(t),str:e.str+t}}),{pcIsSpace:!1,str:""}).str},ue=function(e,t,n,r){var o=function(e,t,n){var r=V(t),o=r?Y(e,t):t;return Z(e,o,n,r)}(e,t,n);!1===o.cancelled&&ie(e,o.content,r)},le=function(e,t,n){var r=n||M(t);ue(e,function(e){return e.replace("\x3c!-- x-tinymce/html --\x3e","")}(t),r,!1)},se=function(e,t){var n=e.dom.encode(t).replace(/\r\n/g,"\n"),r=function(e,t,n){return t?F(e,!0===t?"p":t,n):function(e){return e.replace(/\r?\n/g,"<br>")}(e)}(ce(e,n),function(e){return e.getParam("forced_root_block")}(e),function(e){return e.getParam("forced_root_block_attrs")}(e));ue(e,r,!1,!0)},fe=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var r=0;r<e.types.length;r++){var o=e.types[r];try{t[o]=e.getData(o)}catch(e){t[o]=""}}}return t},de=function(e,t){return t in e&&e[t].length>0},me=function(e){return de(e,"text/html")||de(e,"text/plain")},pe=(G="mceclip",X=0,function(){return G+X++}),ge=function(e,t){var n,r,o=(n=t.uri,(r=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n))?{type:r[1],data:decodeURIComponent(r[2])}:{type:null,data:null}),i=o.data,a=o.type,c=pe(),u=t.blob,l=new Image;if(l.src=t.uri,function(e,t){var n=function(e){return e.getParam("images_dataimg_filter")}(e);return!n||n(t)}(e,l)){var s=e.editorUpload.blobCache,f=void 0,d=s.getByData(i,a);if(d)f=d;else{var m=function(e){return e.getParam("images_reuse_filename")}(e)&&p(u.name),g=m?function(e,t){var n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return p(n)?e.dom.encode(n[1]):null}(e,u.name):c,h=m?u.name:void 0;f=s.create(c,u,i,g,h),s.add(f)}le(e,'<img src="'+f.blobUri()+'">',!1)}else le(e,'<img src="'+t.uri+'">',!1)},he=function(e){return T.all(b(e,(function(e){return new T((function(t){var n=function(e){return p(e.getAsFile)}(e)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)}))})))},ve=function(e){var t=B(e);return function(e){return function(e,t){return x(e,t,0)}(e.type,"image/")&&v(t,(function(t){return n=t,r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},(A.hasOwn(r,n)?"image/"+r[n]:"image/"+n)===e.type;var n,r}))}},be=function(e,t,n){var r="paste"===t.type?t.clipboardData:t.dataTransfer;if(P(e)&&r){var o=function(e,t){var n=t.items?b(w(t.items),(function(e){return e.getAsFile()})):[],r=t.files?w(t.files):[];return function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}(n.length>0?n:r,ve(e))}(e,r);if(o.length>0)return t.preventDefault(),he(o).then((function(t){n&&e.selection.setRng(n),y(t,(function(t){ge(e,t)}))})),!0}return!1},ye=function(e){return E.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},we=function(e,t,n){var r,o=C(),i=C();function a(e,n,r,o,i){var a;de(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),i=i||M(a),t.isDefaultContent(a)&&(o=!0)),a=q(a),t.remove();var c=!1===i&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a),u=ne(e,a);(!a.length||c&&!u)&&(o=!0),(o||u)&&(a=de(n,"text/plain")&&c?n["text/plain"]:function(e){var t=z(),n=j({},t),r="",o=t.getShortEndedElements(),i=A.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements();return e=W(e,[/<!\[[^\]]+\]>/g]),function e(t){var n=t.name,c=t;if("br"!==n){if("wbr"!==n)if(o[n]&&(r+=" "),i[n])r+=" ";else{if(3===t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))do{e(t)}while(t=t.next);a[n]&&c.next&&(r+="\n","p"===n&&(r+="\n"))}}else r+="\n"}(n.parse(e)),r}(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?se(e,a):le(e,a,i)}e.on("keyup",i.clear),e.on("keydown",(function(n){var a=function(e){ye(e)&&!e.isDefaultPrevented()&&t.remove()};if(ye(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&k.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o.set(n),i.set(!0),k.ie&&r)return n.preventDefault(),void function(e,t){e.fire("paste",{ieFake:t})}(e,!0);t.remove(),t.create(),e.once("keyup",a),e.once("paste",(function(){e.off("keyup",a)}))}}));e.on("paste",(function(c){var u=o.isSet()||i.isSet();u&&o.clear();var l=function(e,t){return fe(t.clipboardData||e.getDoc().dataTransfer)}(e,c),s="text"===n.get()||r,f=de(l,"x-tinymce/html");r=!1,c.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(c)?t.remove():me(l)||!be(e,c,t.getLastRng()||e.selection.getRng())?(u||c.preventDefault(),!k.ie||u&&!c.ieFake||de(l,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),l["text/html"]=t.getHtml()),de(l,"text/html")?(c.preventDefault(),f||(f=M(l["text/html"])),a(e,l,u,s,f)):S.setEditorTimeout(e,(function(){a(e,l,u,s,f)}),0)):t.remove()}))},Ce=function(e){return k.ie&&e.inline?document.body:e.getBody()},xe=function(e,t,n){(function(e){return Ce(e)!==e.getBody()})(e)&&e.dom.bind(t,"paste keyup",(function(t){Te(e,n)||e.fire("paste")}))},ke=function(e){return e.dom.get("mcepastebin")},Se=function(e,t){return t===e},Te=function(e,t){var n,r=ke(e);return(n=r)&&"mcepastebin"===n.id&&Se(t,r.innerHTML)},Ee=function(e){var t=o(null);return{create:function(){return function(e,t,n){var r=e.dom,o=e.getBody();t.set(e.selection.getRng());var i=e.dom.add(Ce(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n);(k.ie||k.gecko)&&r.setStyle(i,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(i,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),xe(e,i,n),i.focus(),e.selection.select(i,!0)}(e,t,"%MCEPASTEBIN%")},remove:function(){return function(e,t){if(ke(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(e,t)},getEl:function(){return ke(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=A.grep(Ce(e).childNodes,(function(e){return"mcepastebin"===e.id})),r=n.shift();A.each(n,(function(e){t(r,e)}));for(var o=e.dom.select("div[id=mcepastebin]",r),i=o.length-1;i>=0;i--){var a=e.dom.create("div");r.insertBefore(a,o[i]),t(a,o[i])}return r?r.innerHTML:""}(e)},getLastRng:function(){return function(e){return e.get()}(t)},isDefault:function(){return Te(e,"%MCEPASTEBIN%")},isDefaultContent:function(e){return Se("%MCEPASTEBIN%",e)}}},_e=function(e,t){var n=Ee(e);return e.on("PreInit",(function(){return function(e,t,n){var r;we(e,t,n),e.parser.addNodeFilter("img",(function(t,n,o){var i=function(e){e.attr("data-mce-object")||r===k.transparentSrc||e.remove()},a=function(e){return 0===e.indexOf("webkit-fake-url")},c=function(e){return 0===e.indexOf("data:")};if(!P(e)&&function(e){return e.data&&!0===e.data.paste}(o))for(var u=t.length;u--;)(r=t[u].attr("src"))&&(a(r)||!I(e)&&c(r))&&i(t[u])}))}(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return le(e,t,n)},pasteText:function(t){return se(e,t)},pasteImageData:function(t,n){return be(e,t,n)},getDataTransferItems:fe,hasHtmlOrText:me,hasContentType:de}},Ae=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){!function(e,t){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),_(e,!1)):(t.pasteFormat.set("text"),_(e,!0)),e.focus()}(e,t)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},Ne=function(e,t,n){if(!function(e){return!1===k.iOS&&"function"==typeof(null==e?void 0:e.setData)}(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData("x-tinymce/html",t),!0}catch(e){return!1}},Re=function(e,t,n,r){Ne(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},Oe=function(e){return function(t,n){var r=function(e){return"\x3c!-- x-tinymce/html --\x3e"+e}(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var a=e.selection.getRng();i.focus();var c=e.dom.createRng();c.selectNodeContents(i),e.selection.setRng(c),S.setTimeout((function(){e.selection.setRng(a),o.parentNode.removeChild(o),n()}),0)}},De=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},Ie=function(e){return!e.selection.isCollapsed()||function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())}(e)},Pe=function(e){e.on("cut",function(e){return function(t){Ie(e)&&Re(t,De(e),Oe(e),(function(){if(k.browser.isChrome()||k.browser.isFirefox()){var t=e.selection.getRng();S.setEditorTimeout(e,(function(){e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))}}(e)),e.on("copy",function(e){return function(t){Ie(e)&&Re(t,De(e),Oe(e),(function(){}))}}(e))},Be=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Me=function(e,t){return Be.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},Le=function(e,t){e.focus(),e.selection.setRng(t)};function Fe(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))}function je(e,t){if(!V(t))return t;var n=[];return A.each(e.schema.getBlockElements(),(function(e,t){n.push(t)})),t=W(t,[[new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g"),"$1"]]),t=W(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function He(e,t,n,r){if(r||n)return t;var o,i=function(e){return e.getParam("paste_webkit_styles")}(e);if(!1===function(e){return e.getParam("paste_remove_styles_if_webkit",!0)}(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var a=e.dom,c=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var i=a.parseStyle(a.decode(n)),u={};if("none"===o)return t+r;for(var l=0;l<o.length;l++){var s=i[o[l]],f=a.getStyle(c,o[l],!0);/color/.test(o[l])&&(s=a.toHex(s),f=a.toHex(f)),f!==s&&(u[o[l]]=s)}return(u=a.serializeStyle(u,"span"))?t+' style="'+u+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r}))}function Ue(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))}var ze=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}};i.add("paste",(function(e){if(!1===function(e){return!!e.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)}(e)){var t=o(!1),n=o(function(e){return e.getParam("paste_as_text",!1)}(e)?"text":"html"),r=_e(e,n),i=function(e){k.webkit&&Fe(e,He),k.ie&&(Fe(e,je),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,Ue))}(e);return function(e,t){e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return e.execCommand("mceTogglePlainTextPaste")},onSetup:ze(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:function(){return e.execCommand("mceTogglePlainTextPaste")},onSetup:ze(e,t)})}(e,r),Ae(e,r),function(e){var t=e.plugins.paste,n=function(e){return e.getParam("paste_preprocess")}(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=function(e){return e.getParam("paste_postprocess")}(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))}(e),Pe(e),function(e,t,n){(function(e){return e.getParam("paste_block_drop",!1)})(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),N(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var o=Me(e,r);if(!r.isDefaultPrevented()&&!n.get()){var i,a=t.getDataTransferItems(r.dataTransfer),c=t.hasContentType(a,"x-tinymce/html");if((t.hasHtmlOrText(a)&&(!(i=a["text/plain"])||0!==i.indexOf("file://"))||!t.pasteImageData(r,o))&&o&&function(e){return e.getParam("paste_filter_drop",!0)}(e)){var u=a["mce-internal"]||a["text/html"]||a["text/plain"];u&&(r.preventDefault(),S.setEditorTimeout(e,(function(){e.undoManager.transact((function(){a["mce-internal"]&&e.execCommand("Delete"),Le(e,o),u=q(u),a["text/html"]?t.pasteHtml(u,c):t.pasteText(u)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){N(e)&&!1===n.get()&&(t.preventDefault(),Le(e,Me(e,t))),"dragend"===t.type&&n.set(!1)}))}(e,r,t),function(e,t){return{clipboard:e,quirks:t}}(r,i)}}))}()},"./node_modules/tinymce/plugins/table/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/table/plugin.js")},"./node_modules/tinymce/plugins/table/plugin.js":function(e,t){!function(){"use strict";var e=function(){},t=function(e){return function(){return e}},n=function(e){return e};function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var o,i=function(e){return function(t){return!e(t)}},a=t(!1),c=t(!0),u=function(){return l},l=function(){var n=function(e){return e.isNone()},r=function(e){return e()},o=function(e){return e};return{fold:function(e,t){return e()},is:a,isSome:a,isNone:c,getOr:o,getOrThunk:r,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:o,orThunk:r,map:u,each:e,bind:u,exists:a,forall:c,filter:u,equals:n,equals_:n,toArray:function(){return[]},toString:t("none()")}}(),s=function(e){var n=t(e),r=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:r,orThunk:r,map:function(t){return s(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:l},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(a,(function(t){return n(e,t)}))}};return i},f={some:s,none:u,from:function(e){return null==e?l:s(e)}},d=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},m=function(e){return function(t){return typeof t===e}},p=d("string"),g=d("object"),h=d("array"),v=m("boolean"),b=(o=void 0,function(e){return o===e}),y=function(e){return!function(e){return null==e}(e)},w=m("function"),C=m("number"),x=Array.prototype.slice,k=Array.prototype.indexOf,S=Array.prototype.push,T=function(e,t){return function(e,t){return k.call(e,t)}(e,t)>-1},E=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},_=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},A=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},N=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},R=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},O=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}}(e,(function(e){n=t(n,e)})),n},D=function(e,t,n){return N(e,(function(e){n=t(n,e)})),n},I=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return f.some(i);if(n(i,r))break}return f.none()}(e,t,a)},P=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return f.some(n)}return f.none()},B=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!h(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);S.apply(t,e[n])}return t},M=function(e,t){return B(A(e,t))},L=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},F=function(e){return[e]},j=function(e,t){return t>=0&&t<e.length?f.some(e[t]):f.none()},H=function(e){return j(e,e.length-1)},U=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return f.none()},z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function W(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}var q=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},V=function(){return $(0,0)},$=function(e,t){return{major:e,minor:t}},K={nu:$,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?V():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return $(r(1),r(2))}(e,n)},unknown:V},J=function(e,t){var n=String(t).toLowerCase();return I(e,(function(e){return e.search(n)}))},G=function(e,t){return J(e,t).map((function(e){var n=K.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},X=function(e,t){return J(e,t).map((function(e){var n=K.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Y=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},Q=function(e,t){return-1!==e.indexOf(t)},Z=function(e,t){return Y(e,t,0)},ee=function(e,t){return Y(e,t,e.length-t.length)},te=function(e){return function(t){return t.replace(e,"")}}(/^\s+|\s+$/g),ne=function(e){return e.length>0},re=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,oe=function(e){return function(t){return Q(t,e)}},ie=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Q(e,"edge/")&&Q(e,"chrome")&&Q(e,"safari")&&Q(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,re],search:function(e){return Q(e,"chrome")&&!Q(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Q(e,"msie")||Q(e,"trident")}},{name:"Opera",versionRegexes:[re,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:oe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:oe("firefox")},{name:"Safari",versionRegexes:[re,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Q(e,"safari")||Q(e,"mobile/"))&&Q(e,"applewebkit")}}],ae=[{name:"Windows",search:oe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Q(e,"iphone")||Q(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:oe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:oe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:oe("linux"),versionRegexes:[]},{name:"Solaris",search:oe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:oe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:oe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ce={browsers:t(ie),oses:t(ae)},ue=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},le={unknown:function(){return ue({current:void 0,version:K.unknown()})},nu:ue,edge:t("Edge"),chrome:t("Chrome"),ie:t("IE"),opera:t("Opera"),firefox:t("Firefox"),safari:t("Safari")},se=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},fe={unknown:function(){return se({current:void 0,version:K.unknown()})},nu:se,windows:t("Windows"),ios:t("iOS"),android:t("Android"),linux:t("Linux"),osx:t("OSX"),solaris:t("Solaris"),freebsd:t("FreeBSD"),chromeos:t("ChromeOS")},de=function(e,n){var r=ce.browsers(),o=ce.oses(),i=G(r,e).fold(le.unknown,le.nu),a=X(o,e).fold(fe.unknown,fe.nu),c=function(e,n,r,o){var i=e.isiOS()&&!0===/ipad/i.test(r),a=e.isiOS()&&!i,c=e.isiOS()||e.isAndroid(),u=c||o("(pointer:coarse)"),l=i||!a&&c&&o("(min-device-width:768px)"),s=a||c&&!l,f=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),d=!s&&!l&&!f;return{isiPad:t(i),isiPhone:t(a),isTablet:t(l),isPhone:t(s),isTouch:t(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:t(f),isDesktop:t(d)}}(a,i,e,n);return{browser:i,os:a,deviceType:c}},me=function(e){return window.matchMedia(e).matches},pe=q((function(){return de(navigator.userAgent,me)})),ge=function(){return pe()},he=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},ve={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return he(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return he(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return he(n)},fromDom:he,fromPoint:function(e,t,n){return f.from(e.dom.elementFromPoint(t,n)).map(he)}},be=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ye=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},we=function(e,t){return e.dom===t.dom},Ce=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},xe=function(e,t){return ge().browser.isIE()?Ce(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ke=be,Se=Object.keys,Te=Object.hasOwnProperty,Ee=function(e,t){for(var n=Se(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},_e=function(e,t){return Ae(e,(function(e,n){return{k:n,v:t(e,n)}}))},Ae=function(e,t){var n={};return Ee(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},Ne=function(t,n){var r={};return function(e,t,n,r){Ee(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(t,n,function(e){return function(t,n){e[n]=t}}(r),e),r},Re=function(e){return function(e,t){var n=[];return Ee(e,(function(e,r){n.push(t(e,r))})),n}(e,(function(e){return e}))},Oe=function(e,t){return De(e,t)?f.from(e[t]):f.none()},De=function(e,t){return Te.call(e,t)},Ie=["tfoot","thead","tbody","colgroup"],Pe=function(e,t,n){return{element:e,rowspan:t,colspan:n}},Be=function(e,t,n){return{element:e,cells:t,section:n}},Me=function(e,t){return{element:e,isNew:t}},Le=function(e,t){return{cells:e,section:t}},Fe=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),je=function(e){return e.dom.nodeType},He=function(e){return function(t){return je(t)===e}},Ue=function(e){return 8===je(e)||"#comment"===Fe(e)},ze=He(1),We=He(3),qe=He(9),Ve=He(11),$e=function(e){return ve.fromDom(e.dom.ownerDocument)},Ke=function(e){return qe(e)?e:$e(e)},Je=function(e){return f.from(e.dom.parentNode).map(ve.fromDom)},Ge=function(e,t){for(var n=w(t)?t:a,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,c=ve.fromDom(i);if(o.push(c),!0===n(c))break;r=i}return o},Xe=function(e){return f.from(e.dom.previousSibling).map(ve.fromDom)},Ye=function(e){return f.from(e.dom.nextSibling).map(ve.fromDom)},Qe=function(e){return A(e.dom.childNodes,ve.fromDom)},Ze=function(e,t){var n=e.dom.childNodes;return f.from(n[t]).map(ve.fromDom)},et=w(Element.prototype.attachShadow)&&w(Node.prototype.getRootNode),tt=t(et),nt=et?function(e){return ve.fromDom(e.dom.getRootNode())}:Ke,rt=function(e){var t=nt(e);return Ve(t)?f.some(t):f.none()},ot=function(e){return ve.fromDom(e.dom.host)},it=function(e){if(tt()&&y(e.target)){var t=ve.fromDom(e.target);if(ze(t)&&at(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return j(n,0)}}return f.from(e.target)},at=function(e){return y(e.dom.shadowRoot)},ct=function(e){var t=We(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return rt(ve.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=ct,r=ot,function(e){return n(r(e))}))},ut=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return ve.fromDom(t)},lt=function(e,t){var n=[];return N(Qe(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(lt(e,t))})),n},st=function(e,t,n){return function(e,t,n){return R(Ge(e,n),t)}(e,(function(e){return be(e,t)}),n)},ft=function(e,t){return function(e,t){return R(Qe(e),t)}(e,(function(e){return be(e,t)}))},dt=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return ye(n)?[]:A(n.querySelectorAll(e),ve.fromDom)}(t,e)};function mt(e,t,n,r,o){return e(n,r)?f.some(n):w(o)&&o(n)?f.none():t(n,r,o)}var pt=function(e,t,n){for(var r=e.dom,o=w(n)?n:a;r.parentNode;){r=r.parentNode;var i=ve.fromDom(r);if(t(i))return f.some(i);if(o(i))break}return f.none()},gt=function(e,t,n){return pt(e,(function(e){return be(e,t)}),n)},ht=function(e,t){return function(e,t){return I(e.dom.childNodes,(function(e){return t(ve.fromDom(e))})).map(ve.fromDom)}(e,(function(e){return be(e,t)}))},vt=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return ye(n)?f.none():f.from(n.querySelector(e)).map(ve.fromDom)}(t,e)},bt=function(e,t,n){return mt((function(e,t){return be(e,t)}),gt,e,t,n)},yt=function(e,t,n){if(!(p(n)||v(n)||C(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},wt=function(e,t,n){yt(e.dom,t,n)},Ct=function(e,t){var n=e.dom;Ee(t,(function(e,t){yt(n,t,e)}))},xt=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},kt=function(e,t){return f.from(xt(e,t))},St=function(e,t){e.dom.removeAttribute(t)},Tt=function(e){return D(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Et=function(e){return void 0!==e.style&&w(e.style.getPropertyValue)},_t=function(e,t,n){if(!p(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Et(e)&&e.style.setProperty(t,n)},At=function(e,t,n){var r=e.dom;_t(r,t,n)},Nt=function(e,t){var n=e.dom;Ee(t,(function(e,t){_t(n,t,e)}))},Rt=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||ct(e)?r:Ot(n,t)},Ot=function(e,t){return Et(e)?e.style.getPropertyValue(t):""},Dt=function(e,t){var n=e.dom,r=Ot(n,t);return f.from(r).filter((function(e){return e.length>0}))},It=function(e,t){!function(e,t){Et(e)&&e.style.removeProperty(t)}(e.dom,t),kt(e,"style").map(te).is("")&&St(e,"style")},Pt=function(e,t,n){return void 0===n&&(n=0),kt(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},Bt=function(e,t){return Pt(e,t,1)},Mt=function(e){return Bt(e,"colspan")>1},Lt=function(e){return Bt(e,"rowspan")>1},Ft=function(e,t){return parseInt(Rt(e,t),10)},jt=t(10),Ht=t(10),Ut=function(e,t){return zt(e,t,c)},zt=function(e,t,n){return M(Qe(e),(function(e){return be(e,t)?n(e)?[e]:[]:zt(e,t,n)}))},Wt=function(e,t){return function(e,t,n){if(void 0===n&&(n=a),n(t))return f.none();if(T(e,Fe(t)))return f.some(t);return gt(t,e.join(","),(function(e){return be(e,"table")||n(e)}))}(["td","th"],e,t)},qt=function(e){return Ut(e,"th,td")},Vt=function(e){return be(e,"colgroup")?ft(e,"col"):M(Jt(e),(function(e){return ft(e,"col")}))},$t=function(e,t){return bt(e,"table",t)},Kt=function(e){return Ut(e,"tr")},Jt=function(e){return $t(e).fold(t([]),(function(e){return ft(e,"colgroup")}))},Gt=function(e,t){return A(e,(function(e){if("colgroup"===Fe(e)){var n=A(Vt(e),(function(e){var t=Pt(e,"span",1);return Pe(e,1,t)}));return Be(e,n,"colgroup")}n=A(qt(e),(function(e){var t=Pt(e,"rowspan",1),n=Pt(e,"colspan",1);return Pe(e,t,n)}));return Be(e,n,t(e))}))},Xt=function(e){return Je(e).map((function(e){var t=Fe(e);return function(e){return T(Ie,e)}(t)?t:"tbody"})).getOr("tbody")},Yt=function(e){var t=Kt(e),n=W(Jt(e),t);return Gt(n,Xt)},Qt=function(e,t){return e+","+t},Zt=function(e,t){var n=M(e.all,(function(e){return e.cells}));return R(n,t)},en=function(e){var t={},n=[],r={},o=0,i=0,a=0;return N(e,(function(e){if("colgroup"===e.section)r=function(e){var t={},n=0;return N(e.cells,(function(e){var r=e.colspan;_(r,(function(o){var i=n+o;t[i]=function(e,t,n){return{element:e,colspan:t,column:n}}(e.element,r,i)})),n+=r})),t}(e);else{var c=[];N(e.cells,(function(e){for(var n=0;void 0!==t[Qt(a,n)];)n++;for(var r=function(e,t,n,r,o){return{element:e,rowspan:t,colspan:n,row:r,column:o}}(e.element,e.rowspan,e.colspan,a,n),o=0;o<e.colspan;o++)for(var u=0;u<e.rowspan;u++){var l=n+o,s=Qt(a+u,l);t[s]=r,i=Math.max(i,l+1)}c.push(r)})),o++,n.push(Be(e.element,c,e.section)),a++}})),{grid:function(e,t){return{rows:e,columns:t}}(o,i),access:t,all:n,columns:r}},tn={fromTable:function(e){var t=Yt(e);return en(t)},generate:en,getAt:function(e,t,n){var r=e.access[Qt(t,n)];return void 0!==r?f.some(r):f.none()},findItem:function(e,t,n){var r=Zt(e,(function(e){return n(t,e.element)}));return r.length>0?f.some(r[0]):f.none()},filterItems:Zt,justCells:function(e){return M(e.all,(function(e){return e.cells}))},justColumns:function(e){return Re(e.columns)},hasColumns:function(e){return Se(e.columns).length>0},getColumnAt:function(e,t){return f.from(e.columns[t])}},nn=function(e,t){var n=t.column,r=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&i>=e.startRow},rn=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},on=function(e,t,n){var r=tn.findItem(e,t,we),o=tn.findItem(e,n,we);return r.bind((function(e){return o.map((function(t){return n=e,r=t,o=Math.min(n.row,r.row),i=Math.min(n.column,r.column),a=Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),c=Math.max(n.column+n.colspan-1,r.column+r.colspan-1),{startRow:o,startCol:i,finishRow:a,finishCol:c};var n,r,o,i,a,c}))}))},an=function(e,t,n){return on(e,t,n).bind((function(t){return function(e,t){for(var n=!0,o=r(rn,t),i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++)n=n&&tn.getAt(e,i,a).exists(o);return n?f.some(t):f.none()}(e,t)}))},cn=function(e,t,n){return on(e,t,n).map((function(t){var n=tn.filterItems(e,r(nn,t));return A(n,(function(e){return e.element}))}))},un=function(e,t){return tn.findItem(e,t,(function(e,t){return xe(t,e)})).map((function(e){return e.element}))},ln=function(e,t,n){return $t(e).bind((function(r){return function(e,t,n,r){return tn.findItem(e,t,we).bind((function(t){var o=n>0?t.row+t.rowspan-1:t.row,i=r>0?t.column+t.colspan-1:t.column;return tn.getAt(e,o+n,i+r).map((function(e){return e.element}))}))}(dn(r),e,t,n)}))},sn=function(e,t,n){var r=dn(e);return cn(r,t,n)},fn=function(e,t,n,r,o){var i=dn(e),a=we(e,n)?f.some(t):un(i,t),c=we(e,o)?f.some(r):un(i,r);return a.bind((function(e){return c.bind((function(t){return cn(i,e,t)}))}))},dn=tn.fromTable,mn=function(e,t){Je(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},pn=function(e,t){Ye(e).fold((function(){Je(e).each((function(e){hn(e,t)}))}),(function(e){mn(e,t)}))},gn=function(e,t){(function(e){return Ze(e,0)})(e).fold((function(){hn(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},hn=function(e,t){e.dom.appendChild(t.dom)},vn=function(e,t){mn(e,t),hn(t,e)},bn=function(e,t){N(t,(function(n,r){var o=0===r?e:t[r-1];pn(o,n)}))},yn=function(e,t){N(t,(function(t){hn(e,t)}))},wn=function(e){e.dom.textContent="",N(Qe(e),(function(e){Cn(e)}))},Cn=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},xn=function(e){var t,n=Qe(e);n.length>0&&(t=e,N(n,(function(e){mn(t,e)}))),Cn(e)};var kn=function(e,t){var n=function(t){return e(t)?f.from(t.dom.nodeValue):f.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(We,"text"),Sn=function(e){return kn.get(e)},Tn=function(e){return kn.getOption(e)},En=function(e,t){return kn.set(e,t)},_n=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function An(){return{up:t({selector:gt,closest:bt,predicate:pt,all:Ge}),down:t({selector:dt,predicate:lt}),styles:t({get:Rt,getRaw:Dt,set:At,remove:It}),attrs:t({get:xt,set:wt,remove:St,copyTo:function(e,t){var n=Tt(e);Ct(t,n)}}),insert:t({before:mn,after:pn,afterAll:bn,append:hn,appendAll:yn,prepend:gn,wrap:vn}),remove:t({unwrap:xn,remove:Cn}),create:t({nu:ve.fromTag,clone:function(e){return ve.fromDom(e.dom.cloneNode(!1))},text:ve.fromText}),query:t({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:Xe,nextSibling:Ye}),property:t({children:Qe,name:Fe,parent:Je,document:function(e){return Ke(e).dom},isText:We,isComment:Ue,isElement:ze,getText:Sn,setText:En,isBoundary:function(e){return!!ze(e)&&("body"===Fe(e)||T(_n,Fe(e)))},isEmptyTag:function(e){return!!ze(e)&&T(["br","img","hr","input"],Fe(e))},isNonEditable:function(e){return ze(e)&&"false"===xt(e,"contenteditable")}}),eq:we,is:ke}}var Nn=function(e,t,n,r){var o=t(e,n);return O(r,(function(n,r){var o=t(e,r);return Rn(e,n,o)}),o)},Rn=function(e,t,n){return t.bind((function(t){return n.filter(r(e.eq,t))}))},On=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,Nn):f.none()},Dn=function(e,t,n,o){void 0===o&&(o=a);var i=[t].concat(e.up().all(t)),c=[n].concat(e.up().all(n)),u=function(e){return P(e,o).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},l=u(i),s=u(c),f=I(l,(function(t){return E(s,function(e,t){return r(e.eq,t)}(e,t))}));return{firstpath:l,secondpath:s,shared:f}},In=An(),Pn=function(e,t){return On(In,(function(t,n){return e(n)}),t)},Bn=function(e){return gt(e,"table")},Mn=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||we(t,e)}};return we(e,t)?f.some({boxes:f.some([e]),start:e,finish:t}):Bn(e).bind((function(o){return Bn(t).bind((function(i){if(we(o,i))return f.some({boxes:sn(o,e,t),start:e,finish:t});if(xe(o,i)){var a=(c=st(t,"td,th",r(o))).length>0?c[c.length-1]:t;return f.some({boxes:fn(o,e,o,t,i),start:e,finish:a})}if(xe(i,o)){var c,u=(c=st(e,"td,th",r(i))).length>0?c[c.length-1]:e;return f.some({boxes:fn(i,e,o,t,i),start:e,finish:u})}return function(e,t,n){return Dn(In,e,t,n)}(e,t).shared.bind((function(a){return bt(a,"table",n).bind((function(n){var a=st(t,"td,th",r(n)),c=a.length>0?a[a.length-1]:t,u=st(e,"td,th",r(n)),l=u.length>0?u[u.length-1]:e;return f.some({boxes:fn(n,e,o,t,i),start:l,finish:c})}))}))}))}))},Ln=function(e,t){var n=dt(e,t);return n.length>0?f.some(n):f.none()},Fn=function(e,t,n){return vt(e,t).bind((function(t){return vt(e,n).bind((function(e){return Pn(Bn,[t,e]).map((function(n){return{first:t,last:e,table:n}}))}))}))},jn=function(e,t,n,r,o){return function(e,t){return I(e,(function(e){return be(e,t)}))}(e,o).bind((function(e){return ln(e,t,n).bind((function(e){return function(e,t){return gt(e,"table").bind((function(n){return vt(n,t).bind((function(t){return Mn(t,e).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}))}(e,r)}))}))},Hn=function(e,t){return Ln(e,t)},Un=function(e,t,n){return Fn(e,t,n).bind((function(t){var n=function(t){return we(e,t)},r=gt(t.first,"thead,tfoot,tbody,table",n),o=gt(t.last,"thead,tfoot,tbody,table",n);return r.bind((function(e){return o.bind((function(n){return we(e,n)?function(e,t,n){var r=dn(e);return an(r,t,n)}(t.table,t.first,t.last):f.none()}))}))}))},zn=function(e){if(!h(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return N(e,(function(r,o){var i=Se(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!h(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var u=function(e){var n=Se(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!L(t,(function(e){return T(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},Wn=zn([{none:[]},{multiple:["elements"]},{single:["element"]}]),qn=function(e,t,n,r){return e.fold(t,n,r)},Vn=Wn.none,$n=Wn.multiple,Kn=Wn.single,Jn=tinymce.util.Tools.resolve("tinymce.PluginManager"),Gn=function(e,t,n){var r=e[n].element,o=ve.fromTag("td");hn(o,ve.fromTag("br")),(t?hn:gn)(r,o)},Xn=function(e,t){var n=function(e){return be(e.element,t)},r=Yt(e),o=tn.generate(r),i=function(e,t){var n=e.grid.columns,r=e.grid.rows,o=n,i=0,a=0;return Ee(e.access,(function(e){if(t(e)){var n=e.row,c=n+e.rowspan-1,u=e.column,l=u+e.colspan-1;n<r?r=n:c>i&&(i=c),u<o?o=u:l>a&&(a=l)}})),function(e,t,n,r){return{minRow:e,minCol:t,maxRow:n,maxCol:r}}(r,o,i,a)}(o,n),a="th:not("+t+"),td:not("+t+")",c=zt(e,"th,td",(function(e){return be(e,a)}));return N(c,Cn),function(e,t,n,r){for(var o=t.grid.columns,i=t.grid.rows,a=0;a<i;a++)for(var c=!1,u=0;u<o;u++){if(!(a<n.minRow||a>n.maxRow||u<n.minCol||u>n.maxCol))tn.getAt(t,a,u).filter(r).isNone()?Gn(e,c,a):c=!0}}(r,o,i,n),function(e,t){var n=R(Ut(e,"tr"),(function(e){return 0===e.dom.childElementCount}));N(n,Cn),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||N(Ut(e,"th,td"),(function(e){St(e,"rowspan"),St(e,"colspan")})),St(e,"width"),St(e,"height"),It(e,"width"),It(e,"height")}(e,i),e},Yn=function(e){return"img"===Fe(e)?1:Tn(e).fold((function(){return Qe(e).length}),(function(e){return e.length}))},Qn=["img","br"],Zn=function(e){return Tn(e).filter((function(e){return 0!==e.trim().length||e.indexOf("")>-1})).isSome()||T(Qn,Fe(e))},er=function(e){return t=Zn,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=ve.fromDom(e.childNodes[r]);if(t(o))return f.some(o);var i=n(e.childNodes[r]);if(i.isSome())return i}return f.none()})(e.dom);var t,n},tr=function(e){return nr(e,Zn)},nr=function(e,t){var n=function(e){for(var r=Qe(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return f.some(i);var a=n(i);if(a.isSome())return a}return f.none()};return n(e)},rr=function(e,t){return ve.fromDom(e.dom.cloneNode(t))},or=function(e){return rr(e,!1)},ir=function(e){return rr(e,!0)},ar=function(e,t){var n=function(e,t){var n=ve.fromTag(t),r=Tt(e);return Ct(n,r),n}(e,t),r=Qe(ir(e));return yn(n,r),n},cr={scope:["row","col"]},ur=function(){var e=ve.fromTag("td");return hn(e,ve.fromTag("br")),e},lr=function(){return ve.fromTag("col")},sr=function(){return ve.fromTag("colgroup")},fr=function(e,t,n){var r=ar(e,t);return Ee(n,(function(e,t){null===e?St(r,t):wt(r,t,e)})),r},dr=function(e){return e},mr=function(e){return function(){return ve.fromTag("tr",e.dom)}},pr=function(e,t,n){var r=function(e,t){var n,r,o,i;n=e.element,r=t,o=n.dom,i=r.dom,Et(o)&&Et(i)&&(i.style.cssText=o.style.cssText),It(t,"height"),1!==e.colspan&&It(e.element,"width")};return{col:function(t){var n=$e(t.element),o=ve.fromTag(Fe(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:sr,row:mr(t),cell:function(t){var o=$e(t.element),i=ve.fromTag(Fe(t.element),o.dom),a=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=a.length>0?function(e,t,n){return er(e).map((function(r){var o=n.join(","),i=st(r,o,(function(t){return we(t,e)}));return O(i,(function(e,t){var n=or(t);return St(n,"contenteditable"),hn(e,n),n}),t)})).getOr(t)}(t.element,i,a):i;return hn(c,ve.fromTag("br")),r(t,i),function(e,t){Ee(cr,(function(n,r){return kt(e,r).filter((function(e){return T(n,e)})).each((function(e){return wt(t,r,e)}))}))}(t.element,i),e(t.element,i),i},replace:fr,gap:ur}},gr=function(e){return{col:lr,colgroup:sr,row:mr(e),cell:ur,replace:dr,gap:ur}},hr=function(e){return A(e,ve.fromDom)},vr=function(e){return qn(e.get(),t([]),n,F)},br=function(e){var t=function(e,t){return kt(e,t).exists((function(e){return parseInt(e,10)>1}))},n=vr(e);return n.length>0&&L(n,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?f.some(n):f.none()},yr=function(e,t,n){return qn(t.get(),f.none,(function(t){return t.length<=1?f.none():Un(e,n.firstSelectedSelector,n.lastSelectedSelector).map((function(e){return{bounds:e,cells:t}}))}),f.none)},wr={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Cr=function(e){return{element:e,mergable:f.none(),unmergable:f.none(),selection:[e]}},xr=function(e,t,n){return{element:n,mergable:yr(t,e,wr),unmergable:br(e),selection:vr(e)}},kr=function(t,n,r,o){t.on("BeforeGetContent",(function(r){!0===r.selection&&qn(n.get(),e,(function(e){r.preventDefault(),function(e){return $t(e[0]).map(ir).map((function(e){return[Xn(e,"[data-mce-selected]")]}))}(e).each((function(e){r.content="text"===r.format?function(e){return A(e,(function(e){return e.dom.innerText})).join("")}(e):function(e,t){return A(t,(function(t){return e.selection.serializer.serialize(t.dom,{})})).join("")}(t,e)}))}),e)})),t.on("BeforeSetContent",(function(e){!0===e.selection&&!0===e.paste&&f.from(t.dom.getParent(t.selection.getStart(),"th,td")).each((function(n){var i=ve.fromDom(n);$t(i).each((function(n){var a,c,u,l,s=R((a=e.content,(u=(c||document).createElement("div")).innerHTML=a,Qe(ve.fromDom(u))),(function(e){return"meta"!==Fe(e)}));if(1===s.length&&(l=s[0],"table"===Fe(l))){e.preventDefault();var f=ve.fromDom(t.getDoc()),d=gr(f),m=function(e,t,n){return{element:e,clipboard:t,generators:n}}(i,s[0],d);r.pasteCells(n,m).each((function(e){t.selection.setRng(e),t.focus(),o.clear(n)}))}}))}))}))},Sr=zn([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Tr=z({},Sr),Er=function(e,n,r,o,i){var a=e.slice(0),c=function(e,t){return 0===e.length?Tr.none():1===e.length?Tr.only(0):0===t?Tr.left(0,1):t===e.length-1?Tr.right(t-1,t):t>0&&t<e.length-1?Tr.middle(t-1,t,t+1):Tr.none()}(e,n),u=t(A(a,t(0)));return c.fold(u,(function(e){return o.singleColumnWidth(a[e],r)}),(function(e,t){return i.calcLeftEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}),(function(e,t,n){return i.calcMiddleDeltas(a,e,t,n,r,o.minCellWidth(),o.isRelative)}),(function(e,t){return i.calcRightEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}))},_r=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t};function Ar(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Rt(n,e);return parseFloat(o)||0}return r},r=function(e,t){return D(t,(function(t,n){var r=Rt(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!C(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Et(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}var Nr,Rr,Or,Dr=Ar("width",(function(e){return e.dom.offsetWidth})),Ir=function(e){return Dr.get(e)},Pr=function(e){return Dr.getOuter(e)},Br=function(e){var t=e.grid,r=_(t.columns,n),o=_(t.rows,n);return A(r,(function(t){return Mr((function(){return M(o,(function(n){return tn.getAt(e,n,t).filter((function(e){return e.column===t})).toArray()}))}),(function(e){return 1===e.colspan}),(function(){return tn.getAt(e,0,t)}))}))},Mr=function(e,t,n){var r=e();return I(r,t).orThunk((function(){return f.from(r[0]).orThunk(n)})).map((function(e){return e.element}))},Lr=function(e){var r=e.grid,o=_(r.rows,n),i=_(r.columns,n);return A(o,(function(n){return Mr((function(){return M(i,(function(r){return tn.getAt(e,n,r).filter((function(e){return e.row===n})).fold(t([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return tn.getAt(e,n,0)}))}))},Fr=function(e,t){if(t<0||t>=e.length-1)return f.none();var n=e[t].fold((function(){var n=function(e){var t=x.call(e,0);return t.reverse(),t}(e.slice(0,t));return U(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return U(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},jr=function(e,t){return function(n){return"rtl"===Hr(n)?t:e}},Hr=function(e){return"rtl"===Rt(e,"direction")?"rtl":"ltr"},Ur=Ar("height",(function(e){var t=e.dom;return ct(e)?t.getBoundingClientRect().height:t.offsetHeight})),zr=function(e){return Ur.get(e)},Wr=function(e){return Ur.getOuter(e)},qr=function(e,t){return{left:e,top:t,translate:function(n,r){return qr(e+n,t+r)}}},Vr=qr,$r=function(e,t){return void 0!==e?e:void 0!==t?t:0},Kr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Vr(n.offsetLeft,n.offsetTop);var i=$r(null==r?void 0:r.pageYOffset,o.scrollTop),a=$r(null==r?void 0:r.pageXOffset,o.scrollLeft),c=$r(o.clientTop,n.clientTop),u=$r(o.clientLeft,n.clientLeft);return Jr(e).translate(a-u,i-c)},Jr=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Vr(n.offsetLeft,n.offsetTop):ct(e)?function(e){var t=e.getBoundingClientRect();return Vr(t.left,t.top)}(t):Vr(0,0)},Gr=function(e,t){return{row:e,y:t}},Xr=function(e,t){return{col:e,x:t}},Yr=function(e){return Kr(e).left+Pr(e)},Qr=function(e){return Kr(e).left},Zr=function(e,t){return Xr(e,Qr(t))},eo=function(e,t){return Xr(e,Yr(t))},to=function(e){return Kr(e).top},no=function(e,t){return Gr(e,to(t))},ro=function(e,t){return Gr(e,to(t)+Wr(t))},oo=function(e,t,n){if(0===n.length)return[];var r=A(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])},io={delta:n,positions:function(e){return oo(no,ro,e)},edge:to},ao=jr({delta:n,edge:Qr,positions:function(e){return oo(Zr,eo,e)}},{delta:function(e){return-e},edge:Yr,positions:function(e){return oo(eo,Zr,e)}}),co={delta:function(e,t){return ao(t).delta(e,t)},positions:function(e,t){return ao(t).positions(e,t)},edge:function(e){return ao(e).edge(e)}},uo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},lo=(Rr=["Infinity","[0-9]+\\."+(Nr=function(e){return"(?:"+e+")?"})("[0-9]+")+Nr("[eE][+-]?[0-9]+"),"\\.[0-9]+"+Nr("[eE][+-]?[0-9]+"),"[0-9]+"+Nr("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+Rr+"))(.*)$")),so=function(e,t){return f.from(lo.exec(e)).bind((function(e){var n=Number(e[1]),r=e[2];return function(e,t){return E(t,(function(t){return E(uo[t],(function(t){return e===t}))}))}(r,t)?f.some({value:n,unit:r}):f.none()}))},fo=function(){var e=ge().browser;return e.isIE()||e.isEdge()},mo=function(e,t,n){return function(e,t){var n=parseFloat(e);return isNaN(n)?t:n}(Rt(e,t),n)},po=function(e){return fo()?function(e){var t=e.dom.getBoundingClientRect().height;return"border-box"===Rt(e,"box-sizing")?t:t-mo(e,"padding-top",0)-mo(e,"padding-bottom",0)-(mo(e,"border-top-width",0)+mo(e,"border-bottom-width",0))}(e):mo(e,"height",zr(e))},go=function(e){return fo()?function(e){var t=e.dom.getBoundingClientRect().width;return"border-box"===Rt(e,"box-sizing")?t:t-mo(e,"padding-left",0)-mo(e,"padding-right",0)-(mo(e,"border-left-width",0)+mo(e,"border-right-width",0))}(e):mo(e,"width",Ir(e))},ho=/(\d+(\.\d+)?)%/,vo=/(\d+(\.\d+)?)px|em/,bo=function(e,t){var n,r=(n=e,f.from(n.dom.offsetParent).map(ve.fromDom)).getOr(ut($e(e)));return t(e)/t(r)*100},yo=function(e,t){At(e,"width",t+"px")},wo=function(e,t){At(e,"width",t+"%")},Co=function(e,t){At(e,"height",t+"px")},xo=function(e,t,n,r){var o=parseInt(e,10);return ee(e,"%")&&"table"!==Fe(t)?function(e,t,n,r){var o=$t(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,o),o}(t,o,n,r):o},ko=function(e){var t=function(e){return Dt(e,"height").getOrThunk((function(){return po(e)+"px"}))}(e);return t?xo(t,e,zr,Co):zr(e)},So=function(e){return Dt(e,"width").fold((function(){return f.from(xt(e,"width"))}),(function(e){return f.some(e)}))},To=function(e,t){return e/t.pixelWidth()*100},Eo=function(e,t){return So(e).fold((function(){var n=Ir(e);return To(n,t)}),(function(n){return function(e,t,n){var r=ho.exec(t);if(null!==r)return parseFloat(r[1]);var o=go(e);return To(o,n)}(e,n,t)}))},_o=function(e,t){return So(e).fold((function(){return go(e)}),(function(n){return function(e,t,n){var r=vo.exec(t);if(null!==r)return parseInt(r[1],10);var o=ho.exec(t);return null!==o?function(e,t){return e/100*t.pixelWidth()}(parseFloat(o[1]),n):go(e)}(e,n,t)}))},Ao=function(e){return function(e,t,n){return n(e)/Bt(e,t)}(e,"rowspan",ko)},No=function(e,t,n){At(e,"width",t+n)},Ro=function(e){return bo(e,Ir)+"%"},Oo=t(ho),Do=t(vo),Io=(Or="col",function(e){return ze(e)&&Fe(e)===Or}),Po=function(e,t,n){return Dt(e,t).fold((function(){return n(e)+"px"}),(function(e){return e}))},Bo=function(e,t){return Po(e,"width",(function(e){return Io(e)?Ir(e):_o(e,t)}))},Mo=function(e){return Po(e,"height",Ao)},Lo=function(e,t,n,r,o,i){return e.filter(r).fold((function(){return i(Fr(n,t))}),(function(e){return o(e)}))},Fo=function(e,t,r,o,a){var c=Br(e),u=tn.hasColumns(e)?function(e){return A(tn.justColumns(e),(function(e){return f.from(e.element)}))}(e):c,l=[f.some(co.edge(t))].concat(A(co.positions(c,t),(function(e){return e.map((function(e){return e.x}))}))),s=i(Mt);return A(u,(function(e,t){return Lo(e,t,l,s,(function(e){if(function(e){return!Io(e)||Dt(e,"width").isSome()}(e))return r(e,a);var i,u,d=(i=c[t],u=n,null!=i?u(i):f.none());return Lo(d,t,l,s,(function(e){return o(f.some(Ir(e)))}),o)}),o)}))},jo=function(e){return e.map((function(e){return e+"px"})).getOr("")},Ho=function(e,t,n){return Fo(e,t,_o,(function(e){return e.getOrThunk(n.minCellWidth)}),n)},Uo=function(e,t,n,r,o){var a=Lr(e),c=[f.some(n.edge(t))].concat(A(n.positions(a,t),(function(e){return e.map((function(e){return e.y}))})));return A(a,(function(e,t){return Lo(e,t,c,i(Lt),r,o)}))},zo=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Wo=function(e,t){var n=tn.justCells(e);return A(n,(function(e){var n=zo(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}}))},qo=function(e,t){return tn.hasColumns(e)?function(e,t){var n=tn.justColumns(e);return A(n,(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}(e,t):function(e,t){var n=tn.justCells(e);return A(n,(function(e){var n=zo(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))}(e,t)},Vo=function(e,t,n){var r=qo(e,t);N(r,(function(e){n.setElementWidth(e.element,e.width)}))},$o=function(e,t,n,r,o){var i=tn.fromTable(e),a=o.getCellDelta(t),c=o.getWidths(i,o),u=n===i.grid.columns-1,l=r.clampTableDelta(c,n,a,o.minCellWidth(),u),s=Er(c,n,l,o,r),f=A(s,(function(e,t){return e+c[t]}));Vo(i,f,o),r.resizeTable(o.adjustTableWidth,l,u)},Ko=function(e,t,n,r){var o=tn.fromTable(e),i=function(e,t,n){return Uo(e,t,n,Ao,(function(e){return e.getOrThunk(Ht)}))}(o,e,r),a=A(i,(function(e,r){return n===r?Math.max(t+e,Ht()):e})),c=Wo(o,a),u=function(e,t){return A(e.all,(function(e,n){return{element:e.element,height:t[n]}}))}(o,a);N(u,(function(e){Co(e.element,e.height)})),N(c,(function(e){Co(e.element,e.height)}));var l=O(a,(function(e,t){return e+t}),0);Co(e,l)},Jo=function(e){return A(e,t(0))},Go=function(e,t,n,r,o){return o(e.slice(0,t)).concat(r).concat(o(e.slice(n)))},Xo=function(e){return function(t,n,r,o){if(e(r)){var i=Math.max(o,t[n]-Math.abs(r)),a=Math.abs(i-t[n]);return r>=0?a:-a}return r}},Yo=Xo((function(e){return e<0})),Qo=Xo(c),Zo=function(){var e=function(e,t,n,r){var o=(100+n)/100,i=Math.max(r,(e[t]+n)/o);return A(e,(function(e,n){return(n===t?i:e/o)-e}))},t=function(t,n,r,o,i,a){return a?e(t,n,o,i):function(e,t,n,r,o){var i=Yo(e,t,r,o);return Go(e,t,n+1,[i,0],Jo)}(t,n,r,o,i)};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Yo,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,o,i,a,c){return t(e,r,o,i,a,c)},calcRightEdgeDeltas:function(t,n,r,o,i,a){if(a)return e(t,r,o,i);var c=Yo(t,r,o,i);return Jo(t.slice(0,r)).concat([c])}}},ei=function(e,n){var r=f.from(e.dom.documentElement).map(ve.fromDom).getOr(e);return{parent:t(r),view:t(e),origin:t(Vr(0,0)),isResizable:n}},ti=function(e,n,r){return{parent:t(n),view:t(e),origin:t(Vr(0,0)),isResizable:r}},ni=zn([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),ri=function(e,t,n){var r=n.substring(0,n.length-e.length),o=parseFloat(r);return r===o.toString()?t(o):ni.invalid(n)},oi=z(z({},ni),{from:function(e){return ee(e,"%")?ri("%",ni.percent,e):ee(e,"px")?ri("px",ni.pixels,e):ni.invalid(e)}}),ii=function(e,t,n){return e.fold((function(){return t}),(function(e){return function(e,t,n){var r=n/t;return A(e,(function(e){return oi.from(e).fold((function(){return e}),(function(e){return e*r+"px"}),(function(e){return e/100*n+"px"}))}))}(t,n,e)}),(function(e){return function(e,t){return A(e,(function(e){return oi.from(e).fold((function(){return e}),(function(e){return e/t*100+"%"}),(function(e){return e+"%"}))}))}(t,n)}))},ai=function(e,n,r){var o=oi.from(r),i=L(e,(function(e){return"0px"===e}))?function(e,n){var r=e.fold((function(){return t("")}),(function(e){return t(e/n+"px")}),(function(){return t(100/n+"%")}));return _(n,r)}(o,e.length):ii(o,e,n);return li(i)},ci=function(e,r){return 0===e.length?r:O(e,(function(e,r){return oi.from(r).fold(t(0),n,n)+e}),0)},ui=function(e,n){return oi.from(e).fold(t(e),(function(e){return e+n+"px"}),(function(e){return e+n+"%"}))},li=function(e){if(0===e.length)return e;var t=O(e,(function(e,t){var n=oi.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return function(e,t){var n=Math.floor(e);return{value:n+t,remainder:e-n}}(e,"px")}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([ui(n[n.length-1],Math.round(t.remainder))])},si=oi.from,fi=function(e){return si(e).fold(t("px"),t("px"),t("%"))},di=function(e,t,n,r){var o=tn.fromTable(e),i=o.all,a=tn.justCells(o),c=tn.justColumns(o);t.each((function(t){var n=fi(t),i=Ir(e),u=function(e,t,n){return Fo(e,t,Bo,jo,n)}(o,e,r),l=ai(u,i,t);tn.hasColumns(o)?function(e,t,n){N(t,(function(t,r){var o=ci([e[r]],jt());At(t.element,"width",o+n)}))}(l,c,n):function(e,t,n){N(t,(function(t){var r=e.slice(t.column,t.colspan+t.column),o=ci(r,jt());At(t.element,"width",o+n)}))}(l,a,n),At(e,"width",t)})),n.each((function(t){var n=fi(t),r=zr(e),c=function(e,t,n){return Uo(e,t,n,Mo,jo)}(o,e,io);!function(e,t,n,r){N(n,(function(t){var n=e.slice(t.row,t.rowspan+t.row),o=ci(n,Ht());At(t.element,"height",o+r)})),N(t,(function(t,n){At(t.element,"height",e[n])}))}(ai(c,r,t),i,a,n),At(e,"height",t)}))},mi=function(e){return So(e).exists((function(e){return ho.test(e)}))},pi=function(e){return So(e).exists((function(e){return vo.test(e)}))},gi=function(e){return So(e).isNone()},hi=Ro,vi=function(e){return tn.fromTable(e).grid},bi=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=R(t,(function(t){return t!==e}))},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};N(e,(function(e,t){o[e]=n[t]})),N(t,(function(e){e(o)}))}}},yi=function(e){return{registry:_e(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:_e(e,(function(e){return e.trigger}))}},wi=function(e){return e.slice(0).sort()},Ci=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(e,t){if(!h(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");N(t,(function(t){if(!p(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))}("required",t),r=wi(t),I(r,(function(e,t){return t<r.length-1&&e===r[t+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Se(r);L(t,(function(e){return T(o,e)}))||function(e,t){throw new Error("All required keys ("+wi(e).join(", ")+") were not specified. Specified keys were: "+wi(t).join(", ")+".")}(t,o),e(t,o);var i=R(t,(function(e){return!n.validate(r[e],e)}));return i.length>0&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+wi(e).join(", ")+") were not.")}(i,n.label),r}},xi=function(e,t){var n=R(t,(function(t){return!T(e,t)}));n.length>0&&function(e){throw new Error("Unsupported keys for object: "+wi(e).join(", "))}(n)},ki=function(e){return function(e,t){return Ci(e,t,{validate:w,label:"function"})}(xi,e)},Si=ki(["compare","extract","mutate","sink"]),Ti=ki(["element","start","stop","destroy"]),Ei=ki(["forceDrop","drop","move","delayDrop"]);function _i(){var e=f.none(),t=yi({move:bi(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=f.some(n),r})(r,n).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=f.none()},events:t.registry}}function Ai(){var t={onEvent:e,reset:e},n=_i(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}}var Ni=function(e,t,n){var r,o,i,a=!1,c=yi({start:bi([]),stop:bi([])}),u=Ai(),l=function(){d.stop(),u.isOn()&&(u.off(),c.trigger.stop())},s=(r=l,o=200,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==i&&clearTimeout(i),i=setTimeout((function(){r.apply(null,e),i=null}),o)}});u.events.move.bind((function(n){t.mutate(e,n.info)}));var f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a&&e.apply(null,t)}},d=t.sink(Ei({forceDrop:l,drop:f(l),move:f((function(e){s.cancel(),u.onEvent(e,t)})),delayDrop:f(s.throttle)}),n);return{element:d.element,go:function(e){d.start(e),u.on(),c.trigger.start()},on:function(){a=!0},off:function(){a=!1},destroy:function(){d.destroy()},events:c.registry}},Ri=function(e){var t,n,r=ve.fromDom(it(e).getOr(e.target)),o=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},a=(t=i,n=o,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return function(e,t,n,r,o,i,a){return{target:e,x:t,y:n,stop:r,prevent:o,kill:i,raw:a}}(r,e.clientX,e.clientY,o,i,a,e)},Oi=function(e,t,n,o,i){var a=function(e,t){return function(n){e(n)&&t(Ri(n))}}(n,o);return e.dom.addEventListener(t,a,i),{unbind:r(Di,e,t,a,i)}},Di=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Ii=c,Pi=function(e,t,n){return function(e,t,n,r){return Oi(e,t,n,r,!1)}(e,t,Ii,n)},Bi=Ri,Mi=function(e,t){var n=xt(e,t);return void 0===n||""===n?[]:n.split(" ")},Li=function(e){return void 0!==e.dom.classList},Fi=function(e,t){return function(e,t,n){var r=Mi(e,t).concat([n]);return wt(e,t,r.join(" ")),!0}(e,"class",t)},ji=function(e,t){Li(e)?e.dom.classList.add(t):Fi(e,t)},Hi=function(e,t){return Li(e)&&e.dom.classList.contains(t)},Ui=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},zi=Ui("ephox-dragster"),Wi=zi.resolve,qi=Si({compare:function(e,t){return Vr(t.left-e.left,t.top-e.top)},extract:function(e){return f.some(Vr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=z({layerClass:Wi("blocker")},e),n=ve.fromTag("div");wt(n,"role","presentation"),Nt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ji(n,Wi("blocker")),ji(n,t.layerClass);return{element:function(){return n},destroy:function(){Cn(n)}}}(t),r=Pi(n.element(),"mousedown",e.forceDrop),o=Pi(n.element(),"mouseup",e.drop),i=Pi(n.element(),"mousemove",e.move),a=Pi(n.element(),"mouseout",e.delayDrop);return Ti({element:n.element,start:function(e){hn(e,n.element())},stop:function(){Cn(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),a.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),Vi=function(e){return"true"===xt(e,"contenteditable")},$i=Ui("ephox-snooker"),Ki=$i.resolve,Ji=function(){var e=yi({drag:bi(["xDelta","yDelta","target"])}),t=f.none(),n=function(){var e=yi({drag:bi(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))}));return{assign:function(e){t=f.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}},Gi=Ki("resizer-bar"),Xi=Ki("resizer-rows"),Yi=Ki("resizer-cols"),Qi=function(e){var t=dt(e.parent(),"."+Gi);N(t,Cn)},Zi=function(e,t,n){var r=e.origin();N(t,(function(t){t.each((function(t){var o=n(r,t);ji(o,Gi),hn(e.parent(),o)}))}))},ea=function(e,t,n,r){Zi(e,t,(function(e,t){var o,i,a,c,u,l,s=(o=t.col,i=t.x-e.left,a=n.top-e.top,c=7,u=r,l=ve.fromTag("div"),Nt(l,{position:"absolute",left:i-c/2+"px",top:a+"px",height:u+"px",width:c+"px"}),Ct(l,{"data-column":o,role:"presentation"}),l);return ji(s,Yi),s}))},ta=function(e,t,n,r){Zi(e,t,(function(e,t){var o=function(e,t,n,r,o){var i=ve.fromTag("div");return Nt(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Ct(i,{"data-row":e,role:"presentation"}),i}(t.row,n.left-e.left,t.y-e.top,r,7);return ji(o,Xi),o}))},na=function(e,t,n,r,o){var i=Kr(n),a=t.isResizable,c=r.length>0?io.positions(r,n):[],u=c.length>0?function(e,t){return M(e.all,(function(e,n){return t(e.element)?[n]:[]}))}(e,a):[],l=R(c,(function(e,t){return E(u,(function(e){return t===e}))}));ta(t,l,i,Pr(n));var s=o.length>0?co.positions(o,n):[],f=s.length>0?function(e,t){var n=[];return _(e.grid.columns,(function(r){tn.getColumnAt(e,r).map((function(e){return e.element})).forall(t)&&n.push(r)})),R(n,(function(n){var r=tn.filterItems(e,(function(e){return e.column===n}));return L(r,(function(e){return t(e.element)}))}))}(e,a):[],d=R(s,(function(e,t){return E(f,(function(e){return t===e}))}));ea(t,d,i,Wr(n))},ra=function(e,t){if(Qi(e),e.isResizable(t)){var n=tn.fromTable(t),r=Lr(n),o=Br(n);na(n,e,t,r,o)}},oa=function(e,t){var n=dt(e.parent(),"."+Gi);N(n,t)},ia=function(e){oa(e,(function(e){At(e,"display","none")}))},aa=function(e){oa(e,(function(e){At(e,"display","block")}))},ca=Ki("resizer-bar-dragging"),ua=function(e){var t=Ji(),n=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:qi;return Ni(e,n,t)}(t,{}),o=f.none(),i=function(e,t){return f.from(xt(e,t))};t.events.drag.bind((function(e){i(e.target,"data-row").each((function(t){var n=Ft(e.target,"top");At(e.target,"top",n+e.yDelta+"px")})),i(e.target,"data-column").each((function(t){var n=Ft(e.target,"left");At(e.target,"left",n+e.xDelta+"px")}))}));var a=function(e,t){return Ft(e,t)-Pt(e,"data-initial-"+t,0)};n.events.stop.bind((function(){t.get().each((function(t){o.each((function(n){i(t,"data-row").each((function(e){var r=a(t,"top");St(t,"data-initial-top"),m.trigger.adjustHeight(n,r,parseInt(e,10))})),i(t,"data-column").each((function(e){var r=a(t,"left");St(t,"data-initial-left"),m.trigger.adjustWidth(n,r,parseInt(e,10))})),ra(e,n)}))}))}));var c=function(r,o){m.trigger.startAdjust(),t.assign(r),wt(r,"data-initial-"+o,Ft(r,o)),ji(r,ca),At(r,"opacity","0.2"),n.go(e.parent())},u=Pi(e.parent(),"mousedown",(function(e){var t;t=e.target,Hi(t,Xi)&&c(e.target,"top"),function(e){return Hi(e,Yi)}(e.target)&&c(e.target,"left")})),l=function(t){return we(t,e.view())},s=function(e){return bt(e,"table",l).filter((function(e){return function(e,t){return bt(e,"[contenteditable]",t)}(e,l).exists(Vi)}))},d=Pi(e.view(),"mouseover",(function(t){s(t.target).fold((function(){ct(t.target)&&Qi(e)}),(function(t){o=f.some(t),ra(e,t)}))})),m=yi({adjustHeight:bi(["table","delta","row"]),adjustWidth:bi(["table","delta","column"]),startAdjust:bi([])});return{destroy:function(){u.unbind(),d.unbind(),n.destroy(),Qi(e)},refresh:function(t){ra(e,t)},on:n.on,off:n.off,hideBars:r(ia,e),showBars:r(aa,e),events:m.registry}},la=function(e,t,n){var r=io,o=co,i=ua(e),a=yi({beforeResize:bi(["table","type"]),afterResize:bi(["table","type"]),startDrag:bi([])});return i.events.adjustHeight.bind((function(e){var t=e.table;a.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);Ko(t,n,e.row,r),a.trigger.afterResize(t,"row")})),i.events.startAdjust.bind((function(e){a.trigger.startDrag()})),i.events.adjustWidth.bind((function(e){var r=e.table;a.trigger.beforeResize(r,"col");var i=o.delta(e.delta,r),c=n(r);$o(r,i,e.column,t,c),a.trigger.afterResize(r,"col")})),{on:i.on,off:i.off,hideBars:i.hideBars,showBars:i.showBars,destroy:i.destroy,events:a.registry}},sa=function(e,t){return e.fire("newrow",{node:t})},fa=function(e,t){return e.fire("newcell",{node:t})},da=function(e,t,n){e.fire("TableModified",z(z({},n),{table:t}))},ma={"border-collapse":"collapse",width:"100%"},pa={border:"1"},ga=function(e){return e.getParam("table_sizing_mode","auto")},ha=function(e){return e.getParam("table_responsive_width")},va=function(e){return e.getParam("table_default_attributes",pa,"object")},ba=function(e){return e.getParam("table_default_styles",function(e){if(Sa(e)){var t=e.getBody().offsetWidth;return z(z({},ma),{width:t+"px"})}return Ta(e)?Ne(ma,(function(e,t){return"width"!==t})):ma}(e),"object")},ya=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},wa=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Ca=function(e){return e.getParam("table_advtab",!0,"boolean")},xa=function(e){return e.getParam("table_style_by_css",!1,"boolean")},ka=function(e){return"relative"===ga(e)||!0===ha(e)},Sa=function(e){return"fixed"===ga(e)||!1===ha(e)},Ta=function(e){return"responsive"===ga(e)},Ea=function(e){return e.getParam("table_use_colgroups",!1,"boolean")},_a=function(e){var t=e.getParam("table_header_type","section","string");return T(["section","cells","sectionCells","auto"],t)?t:"section"},Aa=function(e){var t=e.getParam("table_column_resizing","preservetable","string");return I(["preservetable","resizetable"],(function(e){return e===t})).getOr("preservetable")},Na=function(e){return"preservetable"===Aa(e)},Ra=function(e){var t=e.getParam("table_clone_elements");return p(t)?f.some(t.split(/[ ,]/)):Array.isArray(t)?f.some(t):f.none()},Oa=function(e){return e.nodeName.toLowerCase()},Da=function(e){return ve.fromDom(e.getBody())},Ia=function(e){return e.getBoundingClientRect().width},Pa=function(e){return e.getBoundingClientRect().height},Ba=function(e){return function(t){return we(t,Da(e))}},Ma=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},La=function(e){St(e,"data-mce-style");var t=function(e){return St(e,"data-mce-style")};N(qt(e),t),N(Vt(e),t)},Fa=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return f.from(n).filter(ne)},ja=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},Ha=function(e){return ve.fromDom(e.selection.getStart())},Ua=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},za=function(n){var r=function(){return Ir(n)},o=t(0);return{width:r,pixelWidth:r,getWidths:function(e,t){return Ho(e,n,t)},getCellDelta:o,singleColumnWidth:t([0]),minCellWidth:o,setElementWidth:e,adjustTableWidth:e,isRelative:!0,label:"none"}},Wa=function(e,t){var n=Ua(parseFloat(e)),r=Ua(Ir(t));return{width:n.get,pixelWidth:r.get,getWidths:function(e,n){return function(e,t,n){return Fo(e,t,Eo,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}),n)}(e,t,n)},getCellDelta:function(e){return e/r.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return jt()/r.get()*100},setElementWidth:wo,adjustTableWidth:function(e){var o=n.get(),i=o+e/100*o;wo(t,i),n.set(i),r.set(Ir(t))},isRelative:!0,label:"percent"}},qa=function(e,t){var r=Ua(e),o=r.get;return{width:o,pixelWidth:o,getWidths:function(e,n){return Ho(e,t,n)},getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(jt(),e+t)-e]},minCellWidth:jt,setElementWidth:yo,adjustTableWidth:function(e){var n=o()+e;yo(t,n),r.set(n)},isRelative:!1,label:"pixel"}},Va=function(e){return So(e).fold((function(){return za(e)}),(function(t){return function(e,t){var n=Oo().exec(t);if(null!==n)return Wa(n[1],e);var r=Do().exec(t);if(null!==r){var o=parseInt(r[1],10);return qa(o,e)}var i=Ir(e);return qa(i,e)}(e,t)}))},$a=qa,Ka=Wa,Ja=function(e,t){if(ka(e)){var n=Fa(e,t.dom).filter(ja).getOrThunk((function(){return hi(t)}));return Ka(n,t)}return Sa(e)?$a(Ir(t),t):Va(t)},Ga=function(e){St(e,"width")},Xa=function(e,t){var n=function(e){return Ir(e)+"px"}(e);di(e,f.some(n),f.none(),t),Ga(e)},Ya=function(e,t){!function(e,t){var n=Ro(e);di(e,f.some(n),f.none(),t),Ga(e)}(t,Ja(e,t))},Qa=function(e,t){var n=Ja(e,t);Xa(t,n)},Za=function(e){It(e,"width");var t=Vt(e),n=t.length>0?t:qt(e);N(n,(function(e){It(e,"width"),Ga(e)})),Ga(e)},ec=function(){var e=ve.fromTag("div");return Nt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),hn(ut(ve.fromDom(document)),e),e},tc=function(e){return"false"!==xt(e,"data-mce-resize")},nc=function(e){var n,r,o=f.none(),i=f.none(),a=f.none(),c=function(e){return"TABLE"===e.nodeName},u=function(){return i},l=function(t){return Ja(e,t)},s=function(){return Na(e)?{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){if(o){if(n>=0)return n;var i=D(e,(function(e,t){return e+t-r}),0);return Math.max(-i,n)}return Yo(e,t,n,r)},calcLeftEdgeDeltas:n=function(e,t,n,r,o){var i=Qo(e,r>=0?n:t,r,o);return Go(e,t,n+1,[i,-i],Jo)},calcMiddleDeltas:function(e,t,r,o,i,a){return n(e,r,o,i,a)},calcRightEdgeDeltas:function(e,n,r,o,i,a){if(a)return Jo(e);var c=o/e.length;return A(e,t(c))}}:Zo();var n},d=function(t,o,i){var a=ee(o,"e");if(""===r&&Ya(e,t),i!==n&&""!==r){At(t,"width",r);var c=s(),u=l(t),f=Na(e)||a?function(e){return vi(e).columns}(t)-1:0;$o(t,i-n,f,c,u)}else if(ja(r)){var d=parseFloat(r.replace("%",""));At(t,"width",i*d/n+"%")}(function(e){return/^(\d+(\.\d+)?)px$/.test(e)})(r)&&function(e){var t=tn.fromTable(e);tn.hasColumns(t)||N(qt(e),(function(e){var t=Rt(e,"width");At(e,"width",t),St(e,"width")}))}(t)};return e.on("init",(function(){var t=function(e,t){return e.inline?ti(Da(e),ec(),t):ei(ve.fromDom(e.getDoc()),t)}(e,tc);if(a=f.some(t),function(e){var t=e.getParam("object_resizing",!0);return p(t)?"table"===t:t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var n=s(),r=la(t,n,l);r.on(),r.events.startDrag.bind((function(t){o=f.some(e.selection.getRng())})),r.events.beforeResize.bind((function(t){var n=t.table.dom;!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(e,n,Ia(n),Pa(n),"bar-"+t.type)})),r.events.afterResize.bind((function(t){var n=t.table,r=n.dom;La(n),o.each((function(t){e.selection.setRng(t),e.focus()})),function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(e,r,Ia(r),Pa(r),"bar-"+t.type),e.undoManager.add()})),i=f.some(r)}})),e.on("ObjectResizeStart",(function(t){var o=t.target;if(c(o)){var i=ve.fromDom(o);N(e.dom.select(".mce-clonedresizable"),(function(t){e.dom.addClass(t,"mce-"+Aa(e)+"-columns")})),!pi(i)&&Sa(e)?Qa(e,i):!mi(i)&&ka(e)&&Ya(e,i),gi(i)&&Z(t.origin,"bar-")&&Ya(e,i),n=t.width,r=Ta(e)?"":Fa(e,o).getOr("")}})),e.on("ObjectResized",(function(t){var n=t.target;if(c(n)){var r=ve.fromDom(n),o=t.origin;Z(o,"corner-")&&d(r,o,t.width),La(r),da(e,r.dom)}})),e.on("SwitchMode",(function(){u().each((function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:u,lazyWire:function(){return a.getOr(ei(ve.fromDom(e.getBody()),tc))},destroy:function(){i.each((function(e){e.destroy()})),a.each((function(t){!function(e,t){e.inline&&Cn(t.parent())}(e,t)}))}}},rc=function(e,t){return{element:e,offset:t}},oc=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return oc(e,t,n).orThunk((function(){return f.some(t)}))})):f.none()},ic=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},ac=function(e,t){var n=oc(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return rc(n,ic(e,n));var r=e.property().children(n);return r.length>0?ac(e,r[r.length-1]):rc(n,ic(e,n))},cc=ac,uc=An(),lc=function(e,t){(function(e){return So(e).bind((function(e){return so(e,["fixed","relative","empty"])}))})(e).each((function(n){var r=n.value/2;No(e,r,n.unit),No(t,r,n.unit)}))},sc=function(e,t,n){e.cells[t]=n},fc=function(e,t){return Le(t,e.section)},dc=function(e,t){var n=e.cells,r=A(n,t);return Le(r,e.section)},mc=function(e,t){return e.cells[t]},pc=function(e,t){return mc(e,t).element},gc=function(e){return e.cells.length},hc=function(e){var t=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}}(e,(function(e){return"colgroup"===e.section}));return{rows:t.fail,cols:t.pass}},vc=function(e,t,n,r){n===r?St(e,t):wt(e,t,n)},bc=function(e,t,n){H(ft(e,t)).fold((function(){return gn(e,n)}),(function(e){return pn(e,n)}))},yc=function(e,t){var n=[],r=[],o=function(e){return A(e,(function(e){e.isNew&&n.push(e.element);var t=e.element;return wn(t),N(e.cells,(function(e){e.isNew&&r.push(e.element),vc(e.element,"colspan",e.colspan,1),vc(e.element,"rowspan",e.rowspan,1),hn(t,e.element)})),t}))},i=function(e){return M(e,(function(e){return A(e.cells,(function(e){return vc(e.element,"span",e.colspan,1),e.element}))}))},a=function(t,n){var r=function(e,t){var n=ht(e,t).getOrThunk((function(){var n=ve.fromTag(t,$e(e).dom);return"thead"===t?bc(e,"caption,colgroup",n):"colgroup"===t?bc(e,"caption",n):hn(e,n),n}));return wn(n),n}(e,n),a=("colgroup"===n?i:o)(t);yn(r,a)},c=function(t,n){t.length>0?a(t,n):function(t){ht(e,t).each(Cn)}(n)},u=[],l=[],s=[],f=[];return N(t,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":l.push(e);break;case"tfoot":s.push(e);break;case"colgroup":f.push(e)}})),c(f,"colgroup"),c(u,"thead"),c(l,"tbody"),c(s,"tfoot"),{newRows:n,newCells:r}},wc=function(e,t){if(0===e.length)return 0;var n=e[0];return P(e,(function(e){return!t(n.element,e.element)})).fold((function(){return e.length}),(function(e){return e}))},Cc=function(e,t,n,r){var o=function(e,t){return e[t]}(e,t).cells.slice(n),i=wc(o,r),a=function(e,t){return A(e,(function(e){return mc(e,t)}))}(e,n).slice(t);return{colspan:i,rowspan:wc(a,r)}},xc=function(e,t){var n=A(e,(function(e){return A(e.cells,a)}));return A(e,(function(r,o){return function(e,t){return{details:e,section:t}}(M(r.cells,(function(r,i){if(!1===n[o][i]){var a=Cc(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var a=t;a<t+o;a++)n[i][a]=!0}(o,i,a.rowspan,a.colspan),[(c=r.element,u=a.rowspan,l=a.colspan,s=r.isNew,{element:c,rowspan:u,colspan:l,isNew:s})]}return[];var c,u,l,s})),r.section)}))},kc=function(e,t,n){var r=[];if(tn.hasColumns(e)){var o=A(tn.justColumns(e),(function(e){return Me(e.element,n)}));r.push(Le(o,"colgroup"))}for(var i=0;i<e.grid.rows;i++){for(var a=[],c=0;c<e.grid.columns;c++){var u=tn.getAt(e,i,c).map((function(e){return Me(e.element,n)})).getOrThunk((function(){return Me(t.gap(),!0)}));a.push(u)}var l=Le(a,e.all[i].section);r.push(l)}return r},Sc=function(e,t){return A(e,(function(e){var n=function(e){return U(e,(function(e){return Je(e.element).map((function(e){var t=Je(e).isNone();return Me(e,t)}))})).getOrThunk((function(){return Me(t.row(),!0)}))}(e.details);return function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}}(n.element,e.details,e.section,n.isNew)}))},Tc=function(e,t){var n=xc(e,we);return Sc(n,t)},Ec=function(e,t){return U(e.all,(function(e){return I(e.cells,(function(e){return we(t,e.element)}))}))},_c=function(e,t,n,r,o){return function(i,a,c,u,l){var s=tn.fromTable(a);return t(s,c).map((function(t){var n=function(e,t){return kc(e,t,!1)}(s,u),r=e(n,t,we,o(u));return{grid:Tc(r.grid,u),cursor:r.cursor}})).fold((function(){return f.none()}),(function(e){var t=yc(a,e.grid),o=f.from(l).getOrThunk((function(){return Va(a)}));return n(a,e.grid,o),r(a),ra(i,a),f.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},Ac=function(e,t){return Wt(t.element).bind((function(t){return Ec(e,t)}))},Nc=function(e,t){var n=A(t.selection,(function(t){return Wt(t).bind((function(t){return Ec(e,t)}))})),r=_r(n);return r.length>0?f.some({cells:r,generators:t.generators,clipboard:t.clipboard}):f.none()},Rc=function(e,t){var n=A(t.selection,(function(t){return Wt(t).bind((function(t){return Ec(e,t)}))})),r=_r(n);return r.length>0?f.some(r):f.none()},Oc=function(e,t,n,r){for(var o=hc(e).rows,i=!0,a=0;a<o.length;a++)for(var c=0;c<gc(o[0]);c++){var u=n(pc(o[a],c),t);!0===u&&!1===i?sc(o[a],c,Me(r(),!0)):!0===u&&(i=!1)}return e},Dc=function(e,t,n,r){var o=hc(e).rows;if(t>0&&t<o.length){var i=function(e,t){return D(e,(function(e,n){return E(e,(function(e){return t(e.element,n.element)}))?e:e.concat([n])}),[])}(o[t-1].cells,n);N(i,(function(e){for(var i=f.none(),a=function(t){for(var a=function(a){var c=o[t].cells[a];n(c.element,e.element)&&(i.isNone()&&(i=f.some(r())),i.each((function(e){sc(o[t],a,Me(e,!0))})))},c=0;c<gc(o[0]);c++)a(c)},c=t;c<o.length;c++)a(c)}))}return e},Ic=function(e){return{is:function(t){return e===t},isValue:c,isError:a,getOr:t(e),getOrThunk:t(e),getOrDie:t(e),or:function(t){return Ic(e)},orThunk:function(t){return Ic(e)},fold:function(t,n){return n(e)},map:function(t){return Ic(t(e))},mapError:function(t){return Ic(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return f.some(e)}}},Pc=function(t){return{is:a,isValue:a,isError:c,getOr:n,getOrThunk:function(e){return e()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return Pc(t)},mapError:function(e){return Pc(e(t))},each:e,bind:function(e){return Pc(t)},exists:a,forall:c,toOptional:f.none}},Bc={value:Ic,error:Pc,fromOption:function(e,t){return e.fold((function(){return Pc(t)}),Ic)}},Mc=function(e,t){return{rowDelta:0,colDelta:gc(e[0])-gc(t[0])}},Lc=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Fc=function(e,t,n){var r="colgroup"===t.section?n.col:n.cell;return A(e,(function(){return Me(r(),!0)}))},jc=function(e,t,n){return e.concat(_(t,(function(){var t=e[e.length-1];return fc(t,Fc(t.cells,t,n))})))},Hc=function(e,t,r){return A(e,(function(e){var o=Fc(_(t,n),e,r);return fc(e,e.cells.concat(o))}))},Uc=function(e,t,r){var o=t.colDelta<0?Hc:n;return(t.rowDelta<0?jc:n)(o(e,Math.abs(t.colDelta),r),Math.abs(t.rowDelta),r)},zc=function(e,t,n,o){var i=r(o,mc(e[t],n).element),a=e[t];return e.length>1&&gc(a)>1&&(n>0&&i(pc(a,n-1))||n<a.cells.length-1&&i(pc(a,n+1))||t>0&&i(pc(e[t-1],n))||t<e.length-1&&i(pc(e[t+1],n)))},Wc=function(e,t,n,r,o){return function(e,t,n){if(e.row>=t.length||e.column>gc(t[0]))return Bc.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),o=r[0].cells.slice(e.column),i=gc(n[0]),a=n.length;return Bc.value({rowDelta:r.length-a,colDelta:o.length-i})}(e,t,n).map((function(i){var a=Uc(t,i,r);return function(e,t,n,r,o){for(var i=e.row,a=e.column,c=i+n.length,u=a+gc(n[0]),l=i;l<c;l++)for(var s=a;s<u;s++){zc(t,l,s,o)&&Oc(t,pc(t[l],s),o,r.cell);var f=pc(n[l-i],s-a),d=r.replace(f);sc(t[l],s,Me(d,!0))}return t}(e,a,n,r,o)}))},qc=function(e,t,n,r,o){!function(e,t,n,r){t>0&&t<e[0].cells.length&&N(e,(function(e){var o=e.cells[t-1],i=e.cells[t];n(i.element,o.element)&&sc(e,t,Me(r(),!0))}))}(t,e,o,r.cell);var i=Lc(n,t),a=Uc(n,i,r),c=Lc(t,a),u=Uc(t,c,r);return A(u,(function(t,n){var r=t.cells.slice(0,e).concat(a[n].cells).concat(t.cells.slice(e,t.cells.length));return fc(t,r)}))},Vc=function(e,t,n,r,o){Dc(t,e,o,r.cell);var i=Mc(n,t),a=Uc(n,i,r),c=Mc(t,a),u=Uc(t,c,r),l=hc(u),s=l.cols,f=l.rows;return s.concat(f.slice(0,e)).concat(a).concat(f.slice(e,f.length))},$c=function(e,t,n,r,o){var i=hc(e),a=i.rows,c=i.cols,u=a.slice(0,t),l=a.slice(t),s=dc(a[n],(function(e,n){return t>0&&t<a.length&&r(pc(a[t-1],n),pc(a[t],n))?mc(a[t],n):Me(o(e.element,r),!0)}));return c.concat(u).concat([s]).concat(l)},Kc=function(e,t,n,r,o){return A(e,(function(e){var i=t>0&&t<gc(e)&&r(pc(e,t-1),pc(e,t)),a=function(e,t,n,r,o,i,a){return"colgroup"!==n&&r?mc(e,t):Me(a(pc(e,o),i),!0)}(e,t,e.section,i,n,r,o);return function(e,t,n){var r=e.cells,o=r.slice(0,t),i=r.slice(t),a=o.concat([n]).concat(i);return fc(e,a)}(e,t,a)}))},Jc=function(e,t,n,r){return A(e,(function(e){return dc(e,(function(e){return function(e){return E(t,(function(t){return n(e.element,t.element)}))}(e)?Me(r(e.element,n),!0):e}))}))},Gc=function(e,t,n,r){return void 0!==pc(e[t],n)&&t>0&&r(pc(e[t-1],n),pc(e[t],n))},Xc=function(e,t,n){return t>0&&n(pc(e,t-1),pc(e,t))},Yc=function(e,t,n,r){var o=M(e,(function(r,o){return Gc(e,o,t,n)||Xc(r,t,n)?[]:[mc(r,t)]}));return Jc(e,o,n,r)},Qc=function(e,t,n,r){var o=hc(e).rows,i=o[t],a=M(i.cells,(function(e,r){return Gc(o,t,r,n)||Xc(i,r,n)?[]:[e]}));return Jc(e,a,n,r)},Zc=ki(["cell","row","replace","gap","col","colgroup"]),eu=function(e){return{element:e,colspan:Pt(e,"colspan",1),rowspan:Pt(e,"rowspan",1)}},tu=function(e,t){void 0===t&&(t=eu),Zc(e);var n=Ua(f.none()),r=function(n){return function(t){switch(Fe(t.element)){case"col":return e.col(t);default:return e.cell(t)}}(t(n))},o=function(e){var t=r(e);return n.get().isNone()&&n.set(f.some(t)),i=f.some({item:e,replacement:t}),t},i=f.none();return{getOrInit:function(e,t){return i.fold((function(){return o(e)}),(function(n){return t(e,n.item)?n.replacement:o(e)}))},cursor:n.get}},nu=function(e,t){return function(n){var r=Ua(f.none());Zc(n);var o=[],i=function(i){var a={scope:e},c=n.replace(i,t,a);return o.push({item:i,sub:c}),r.get().isNone()&&r.set(f.some(c)),c};return{replaceOrInit:function(e,t){return function(e,t){return I(o,(function(n){return t(n.item,e)}))}(e,t).fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.sub:i(e)}))},cursor:r.get}}},ru=function(e){Zc(e);var t=Ua(f.none());return{combine:function(n){return t.get().isNone()&&t.set(f.some(n)),function(){var t=e.cell({element:n,colspan:1,rowspan:1});return It(t,"width"),It(n,"width"),t}},cursor:t.get}},ou=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],iu=An(),au=function(e){return function(e,t){var n=e.property().name(t);return T(ou,n)}(iu,e)},cu=function(e){return function(e,t){var n=e.property().name(t);return T(["ol","ul"],n)}(iu,e)},uu=function(e){return function(e,t){return T(["br","img","hr","input"],e.property().name(t))}(iu,e)},lu=function(e){var t,n=function(e){return"br"===Fe(e)},r=function(e){return tr(e).bind((function(t){var r=Ye(t).map((function(e){return!!au(e)||!!uu(e)&&"img"!==Fe(e)})).getOr(!1);return Je(t).map((function(o){return!0===r||function(e){return"li"===Fe(e)||pt(e,cu).isSome()}(o)||n(t)||au(o)&&!we(e,o)?[]:[ve.fromTag("br")]}))})).getOr([])},o=0===(t=M(e,(function(e){var t=Qe(e);return function(e){return L(e,(function(e){return n(e)||We(e)&&0===Sn(e).trim().length}))}(t)?[]:t.concat(r(e))}))).length?[ve.fromTag("br")]:t;wn(e[0]),yn(e[0],o)},su=function(e){0===qt(e).length&&Cn(e)},fu=function(e,t){return{grid:e,cursor:t}},du=function(e,t,n){var r=hc(e).rows;return mu(r,t,n).orThunk((function(){return mu(r,0,0)}))},mu=function(e,t,n){return f.from(e[t]).bind((function(e){return f.from(e.cells[n]).bind((function(e){return f.from(e.element)}))}))},pu=function(e,t,n){var r=hc(e).rows;return fu(e,mu(r,t,n))},gu=function(e){return D(e,(function(e,t){return E(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))},hu=function(e){return D(e,(function(e,t){return E(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))},vu=function(e,t,n){var r,o,i=(r=e,o=n.section,Gt(r,(function(){return o}))),a=tn.generate(i);return kc(a,t,!0)},bu=function(e,t){var n=R(e,t);return 0===n.length?f.some("td"):n.length===e.length?f.some("th"):f.none()},yu=function(e,t,n){var r=tn.generate(t),o=n.getWidths(r,n);Vo(r,o,n)},wu=_c((function(e,t,n,r){var o=t[0].row,i=t[0].row,a=gu(t),c=D(a,(function(e,t){return $c(e,i,o,n,r.getOrInit)}),e);return pu(c,i,t[0].column)}),Rc,e,e,tu),Cu=_c((function(e,t,n,r){var o=gu(t),i=o[o.length-1].row,a=o[o.length-1].row+o[o.length-1].rowspan,c=D(o,(function(e,t){return $c(e,a,i,n,r.getOrInit)}),e);return pu(c,a,t[0].column)}),Rc,e,e,tu),xu=_c((function(e,t,n,r){var o=hu(t),i=o[0].column,a=o[0].column,c=D(o,(function(e,t){return Kc(e,a,i,n,r.getOrInit)}),e);return pu(c,t[0].row,a)}),Rc,yu,e,tu),ku=_c((function(e,t,n,r){var o=t[t.length-1].column,i=t[t.length-1].column+t[t.length-1].colspan,a=hu(t),c=D(a,(function(e,t){return Kc(e,i,o,n,r.getOrInit)}),e);return pu(c,t[0].row,i)}),Rc,yu,e,tu),Su=_c((function(e,t,n,r){var o=hu(t),i=function(e,t,n){var r=A(e,(function(e){var r=e.cells.slice(0,t).concat(e.cells.slice(n+1));return Le(r,e.section)}));return R(r,(function(e){return e.cells.length>0}))}(e,o[0].column,o[o.length-1].column),a=du(i,t[0].row,t[0].column);return fu(i,a)}),Rc,yu,su,tu),Tu=_c((function(e,t,n,r){var o=gu(t),i=function(e,t,n){var r=hc(e),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(n+1))}(e,o[0].row,o[o.length-1].row),a=du(i,t[0].row,t[0].column);return fu(i,a)}),Rc,e,su,tu),Eu=(_c((function(e,t,n,r){var o=Yc(e,t.column,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu("row","th")),_c((function(e,t,n,r){var o=hu(t),i=D(o,(function(e,t){return Yc(e,t.column,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu("row","th"))),_u=(_c((function(e,t,n,r){var o=Yc(e,t.column,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu(null,"td")),_c((function(e,t,n,r){var o=hu(t),i=D(o,(function(e,t){return Yc(e,t.column,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu(null,"td"))),Au=(_c((function(e,t,n,r){var o=Qc(e,t.row,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu("col","th")),_c((function(e,t,n,r){var o=gu(t),i=D(o,(function(e,t){return Qc(e,t.row,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu("col","th")),_c((function(e,t,n,r){var o=Qc(e,t.row,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu(null,"td")),_c((function(e,t,n,r){var o=gu(t),i=D(o,(function(e,t){return Qc(e,t.row,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu(null,"td")),_c((function(e,n,r,o){var i=n.cells;lu(i);var a=function(e,t,n,r){var o=hc(e).rows;if(0===o.length)return e;for(var i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++)sc(o[i],a,Me(r(),!1));return e}(e,n.bounds,0,t(i[0]));return fu(a,f.from(i[0]))}),(function(e,t){return t.mergable}),e,e,ru)),Nu=_c((function(e,t,n,r){var o=O(t,(function(e,t){return Oc(e,t,n,r.combine(t))}),e);return fu(o,f.from(t[0]))}),(function(e,t){return t.unmergable}),yu,e,ru),Ru=_c((function(e,t,n,r){var o=function(e,t){var n=tn.fromTable(e);return kc(n,t,!0)}(t.clipboard,t.generators),i=function(e,t){return{row:e,column:t}}(t.row,t.column);return Wc(i,e,o,t.generators,n).fold((function(){return fu(e,f.some(t.element))}),(function(e){var n=du(e,t.row,t.column);return fu(e,n)}))}),(function(e,t){return Wt(t.element).bind((function(n){return Ec(e,n).map((function(e){return z(z({},e),{generators:t.generators,clipboard:t.clipboard})}))}))}),yu,e,tu),Ou=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[0].column,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=qc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Du=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=qc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Iu=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[0].row,a=o[i],c=vu(t.clipboard,t.generators,a),u=Vc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Pu=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=Vc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Bu=function(e,t){var n=tn.fromTable(e);return Rc(n,t).bind((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=B(A(n.all,(function(e){return R(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return bu(i,(function(e){return"th"===Fe(e.element)}))})).getOr("")},Mu=function(e){return Oa(e.parentNode)},Lu=function(e,t){var n="thead"===Mu(t),r=!E(t.cells,(function(e){return"th"!==Oa(e)}));return n||r?f.some({thead:n,ths:r}):f.none()},Fu=function(e,t){return"thead"===(n=Lu(0,t).fold((function(){return Mu(t)}),(function(e){return"thead"})))?"header":"tfoot"===n?"footer":"body";var n},ju=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=Oa(o);if(n!==i){var a=e.select(n,r)[0];if(!a){a=e.create(n);var c=r.firstChild;"thead"===n?H(ft(ve.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(a,c)}),(function(t){return e.insertAfter(a,t.dom)})):r.appendChild(a)}"tbody"===n&&"thead"===i&&a.firstChild?a.insertBefore(t,a.firstChild):a.appendChild(t),o.hasChildNodes()||e.remove(o)}},Hu=function(e,t,n,r){var o=e.dom,i=function(e,t,n){if(y(n)&&Oa(t)!==n){var r=e.dom.rename(t,n);return fa(e,r),r}return t}(e,t,n);return b(r)||o.setAttrib(i,"scope",r),i},Uu=function(e,t,n,r){return N(t,(function(t){return Hu(e,t,n,r)}))},zu=function(e,t,n){var r,o=e.dom;if("header"===n){var i=_a(e),a="auto"===i?(r=$t(ve.fromDom(t.cells[0])).map((function(e){return Kt(e)})).getOr([]),U(r,(function(e){return Lu(0,e.dom)})).map((function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"})).getOr("section")):i;Uu(e,t.cells,"section"===a?"td":"th","col"),ju(o,t,"cells"===a?"tbody":"thead")}else Uu(e,t.cells,"td",null),ju(o,t,"footer"===n?"tfoot":"tbody")},Wu=function(e){return function(t){var n=Fe(t),r="col"===n||"colgroup"===n?function(e){return $t(e).bind((function(e){return Hn(e,wr.firstSelectedSelector)})).fold((function(){return e}),(function(e){return e[0]}))}(t):t;return bt(r,e)}},qu=Wu("th,td"),Vu=Wu("th,td,caption"),$u=function(e,t){return qu(e).map((function(e){return vr(t)})).getOr([])},Ku=function(e,t){var n,r,o,i=qu(e),a=i.bind((function(e){return $t(e)})).map((function(e){return Kt(e)}));return(n=i,r=a,o=function(e,n){return R(n,(function(n){return E(hr(n.dom.cells),(function(n){return"1"===xt(n,t)||we(n,e)}))}))},n.isSome()&&r.isSome()?f.some(o(n.getOrDie(),r.getOrDie())):f.none()).getOr([])},Ju=function(t,n,r){var o=function(e){return"table"===Fe(Da(e))},i=Ra(t),a=function(e,n,r,o){return function(a,c){La(a);var u=o(),l=ve.fromDom(t.getDoc()),s=pr(r,l,i),d=Ja(t,a);return n(a)?e(u,a,c,s,d).bind((function(e){return N(e.newRows,(function(e){sa(t,e.dom)})),N(e.newCells,(function(e){fa(t,e.dom)})),e.cursor.map((function(e){var n=cc(uc,e),r=t.dom.createRng();return r.setStart(n.element.dom,n.offset),r.setEnd(n.element.dom,n.offset),r}))})):f.none()}},u=a(Tu,(function(e){return!1===o(t)||vi(e).rows>1}),e,n),l=a(Su,(function(e){return!1===o(t)||vi(e).columns>1}),e,n),s=a(wu,c,e,n),d=a(Cu,c,e,n),m=a(xu,c,lc,n),p=a(ku,c,lc,n),g=a(Au,c,e,n),h=a(Nu,c,e,n),v=a(Ou,c,e,n),b=a(Du,c,e,n),y=a(Iu,c,e,n),w=a(Pu,c,e,n),C=a(Ru,c,e,n),x=function(e,t){return Oe(e,"type").filter((function(e){return T(t,e)}))};return{deleteRow:u,deleteColumn:l,insertRowsBefore:s,insertRowsAfter:d,insertColumnsBefore:m,insertColumnsAfter:p,mergeCells:g,unmergeCells:h,pasteColsBefore:v,pasteColsAfter:b,pasteRowsBefore:y,pasteRowsAfter:w,pasteCells:C,setTableCellType:function(e,t){return x(t,["td","th"]).each((function(t){var n=A($u(Ha(e),r),(function(e){return e.dom}));Uu(e,n,t,null)}))},setTableRowType:function(e,t){return x(t,["header","body","footer"]).each((function(t){A(Ku(Ha(e),wr.selected),(function(n){return zu(e,n.dom,t)}))}))},makeColumnsHeader:a(Eu,c,e,n),unmakeColumnsHeader:a(_u,c,e,n),getTableRowType:function(e){var t=Ku(Ha(e),wr.selected);if(t.length>0){var n=A(t,(function(e){return Fu(0,e.dom)})),r=T(n,"header"),o=T(n,"footer");if(r||o){var i=T(n,"body");return!r||i||o?r||i||!o?"":"footer":"header"}return"body"}},getTableCellType:function(e){return bu($u(Ha(e),r),(function(e){return"th"===Fe(e)})).getOr("")},getTableColType:Bu}},Gu={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Xu=function(e){var t=ve.fromTag("colgroup");return _(e,(function(){return hn(t,ve.fromTag("col"))})),t},Yu=function(e,t,n,r){return _(e,(function(e){return function(e,t,n,r){for(var o=ve.fromTag("tr"),i=0;i<e;i++){var a=r<t||i<n?ve.fromTag("th"):ve.fromTag("td");i<n&&wt(a,"scope","row"),r<t&&wt(a,"scope","col"),hn(a,ve.fromTag("br")),hn(o,a)}return o}(t,n,r,e)}))},Qu=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},Zu=function(e,t,n,o,i){var a=ba(e),c={styles:a,attributes:va(e),colGroups:Ea(e)};return e.undoManager.ignore((function(){var r=function(e,t,n,r,o,i){void 0===i&&(i=Gu);var a=ve.fromTag("table"),c="cells"!==o;Nt(a,i.styles),Ct(a,i.attributes),i.colGroups&&hn(a,Xu(t));var u=Math.min(e,n);if(c&&n>0){var l=ve.fromTag("thead");hn(a,l);var s=Yu(n,t,"sectionCells"===o?u:0,r);yn(l,s)}var f=ve.fromTag("tbody");hn(a,f);var d=Yu(c?e-u:e,t,c?0:n,r);return yn(f,d),a}(n,t,i,o,_a(e),c);wt(r,"data-mce-id","__mce");var a=function(e){var t=ve.fromTag("div"),n=ve.fromDom(e.dom.cloneNode(!0));return hn(t,n),function(e){return e.dom.innerHTML}(t)}(r);e.insertContent(a),e.addVisual()})),vt(Da(e),'table[data-mce-id="__mce"]').map((function(t){return Sa(e)?Qa(e,t):Ta(e)?Za(t):(ka(e)||function(e){return p(e)&&-1!==e.indexOf("%")}(a.width))&&Ya(e,t),La(t),St(t,"data-mce-id"),function(e,t){N(dt(t,"tr"),(function(t){sa(e,t.dom),N(dt(t,"th,td"),(function(t){fa(e,t.dom)}))}))}(e,t),function(e,t){vt(t,"td,th").each(r(Qu,e))}(e,t),t.dom})).getOr(null)},el=function(e,t,n,r,o){void 0===r&&(r={});var i=function(e){return C(e)&&e>0};if(i(t)&&i(n)){var a=r.headerRows||0,c=r.headerColumns||0;return Zu(e,n,t,c,a)}return console.error(o),null},tl=function(e){return function(){return e().fold((function(){return[]}),(function(e){return A(e,(function(e){return e.dom}))}))}},nl=function(e){return function(t){var n=t.length>0?f.some(hr(t)):f.none();e(n)}},rl=function(e){return function(t,n,r){void 0===r&&(r={});var o=el(e,n,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),o}},ol=function(e,t,n){var r=Pt(e,t,1);1===n||r<=1?St(e,t):wt(e,t,Math.min(n,r))},il=function(e,t){var n=tn.fromTable(e);return Rc(n,t).map((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan;return W(function(e,t,n){if(tn.hasColumns(e)){var r=R(tn.justColumns(e),(function(e){return e.column>=t&&e.column<n})),o=A(r,(function(e){var r=ir(e.element);return ol(r,"span",n-t),r})),i=ve.fromTag("colgroup");return yn(i,o),[i]}return[]}(n,r,o),function(e,t,n){return A(e.all,(function(e){var r=R(e.cells,(function(e){return e.column>=t&&e.column<n})),o=A(r,(function(e){var r=ir(e.element);return ol(r,"colspan",n-t),r})),i=ve.fromTag("tr");return yn(i,o),i}))}(n,r,o))}))},al=function(e,t,n){var r=tn.fromTable(e);return Rc(r,t).map((function(e){var t=kc(r,n,!1),o=hc(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan);return function(e){return A(e,(function(e){var t=or(e.element);return N(e.cells,(function(e){var n=ir(e.element);vc(n,"colspan",e.colspan,1),vc(n,"rowspan",e.rowspan,1),hn(t,n)})),t}))}(Tc(o,n))}))},cl=tinymce.util.Tools.resolve("tinymce.util.Tools"),ul=function(e,t,n){return function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(void 0,e.select("td,th",t))},ll=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},sl=function(e,t){cl.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},fl=function(e){return function(e,t){return De(e,t)&&void 0!==e[t]&&null!==e[t]}(e,"menu")},dl=function(e,t){return function(e,t){return t.concat(A(e,(function(e){var t=e.text||e.title;return fl(e)?{text:t,items:dl(e.menu)}:{text:t,value:e.value}})))}(e,t||[])},ml=function(e){return function(t){return Z(t,"rgb")?e.toHex(t):t}},pl=function(e,t){var n=ve.fromDom(t);return{borderwidth:Dt(n,"border-width").getOr(""),borderstyle:Dt(n,"border-style").getOr(""),bordercolor:Dt(n,"border-color").map(ml(e)).getOr(""),backgroundcolor:Dt(n,"background-color").map(ml(e)).getOr("")}},gl=function(e){var t=e[0],n=e.slice(1);return N(n,(function(e){N(Se(t),(function(n){Ee(e,(function(e,r){var o=t[n];""!==o&&n===r&&o!==e&&(t[n]="")}))}))})),t},hl=function(e){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},vl=function(e,t,n,r){return I(e,(function(e){return n.formatter.matchNode(r,t+e)})).getOr("")},bl=r(vl,["left","center","right"],"align"),yl=r(vl,["top","middle","bottom"],"valign"),wl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Cl=function(e){return wl.concat(function(e){var t=dl(function(e){return e.getParam("table_cell_class_list",[],"array")}(e));return t.length>0?f.some({name:"class",type:"listbox",label:"Class",items:t}):f.none()}(e).toArray())},xl=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,o){e&&!o||r.setAttrib(n,t,o)},setStyle:function(t,o){e&&!o||r.setStyle(n,t,o)},setFormat:function(r,o){e&&!o||(""===o?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:o},n))}}}},kl={normal:xl(!1),ifTruthy:xl(!0)},Sl=function(e){return $t(e[0]).map((function(t){var n=tn.fromTable(t),r=tn.justCells(n),o=R(r,(function(t){return E(e,(function(e){return we(t.element,e)}))}));return A(o,(function(e){return{element:e.element.dom,column:tn.getColumnAt(n,e.column).map((function(e){return e.element.dom}))}}))}))},Tl=function(e,t,n){var r=1===t.length;if(t.length>=1){var o=$t(t[0]);Sl(t).each((function(t){N(t,(function(t){var o=Hu(e,t.element,n.celltype),i=r?kl.normal(e,o):kl.ifTruthy(e,o);!function(e,t,n){e.setAttrib("scope",n.scope),e.setAttrib("class",n.class),e.setStyle("height",Ma(n.height)),t.setStyle("width",Ma(n.width))}(i,t.column.map((function(t){return r?kl.normal(e,t):kl.ifTruthy(e,t)})).getOr(i),n),ya(e)&&function(e,t){e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",Ma(t.borderwidth))}(i,n),r&&(sl(e,o),function(e,t){cl.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))}(e,o)),n.halign&&ll(e,o,n.halign),n.valign&&function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)}(e,o,n.valign)}))})),o.each((function(t){return da(e,t.dom)}))}},El=function(e,t,n){var r=n.getData();n.close(),e.undoManager.transact((function(){Tl(e,t,r),e.focus()}))},_l=function(e,t){var n=Sl(t).map((function(t){return A(t,(function(t){return function(e,t,n,r){var o=e.dom,i=r.getOr(t),a=function(e,t){return o.getStyle(e,t)||o.getAttrib(e,t)};return z({width:a(i,"width"),height:a(t,"height"),scope:o.getAttrib(t,"scope"),celltype:Oa(t),class:o.getAttrib(t,"class",""),halign:bl(e,t),valign:yl(e,t)},n?pl(o,t):{})}(e,t.element,ya(e),t.column)}))}));return gl(n.getOrDie())},Al=function(e,t){var n=$u(Ha(e),t);if(0!==n.length){var o=_l(e,n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Cl(e)},hl("cell")]},a={type:"panel",items:[{type:"grid",columns:2,items:Cl(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:ya(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(El,e,n)})}},Nl=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Rl=function(e){return Nl.concat(function(e){var t=dl(function(e){return e.getParam("table_row_class_list",[],"array")}(e));return t.length>0?f.some({name:"class",type:"listbox",label:"Class",items:t}):f.none()}(e).toArray())},Ol=function(e,t,n,r){var o=1===t.length;N(t,(function(t){r.type!==Oa(t.parentNode)&&zu(e,t,r.type);var i=o?kl.normal(e,t):kl.ifTruthy(e,t);!function(e,t){e.setAttrib("scope",t.scope),e.setAttrib("class",t.class),e.setStyle("height",Ma(t.height))}(i,r),wa(e)&&function(e,t){e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)}(i,r),r.align!==n.align&&(sl(e,t),ll(e,t,r.align))})),$t(ve.fromDom(t[0])).each((function(t){return da(e,t.dom)}))},Dl=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){Ol(e,t,n,o),e.focus()}))},Il=function(e){var t=Ku(Ha(e),wr.selected);if(0!==t.length){var n=A(t,(function(t){return function(e,t,n){var r=e.dom;return z({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),class:r.getAttrib(t,"class",""),type:Fu(0,t),align:bl(e,t)},n?pl(r,t):{})}(e,t.dom,wa(e))})),o=gl(n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Rl(e)},hl("row")]},a={type:"panel",items:[{type:"grid",columns:2,items:Rl(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:wa(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(Dl,e,A(t,(function(e){return e.dom})),o)})}},Pl=tinymce.util.Tools.resolve("tinymce.Env"),Bl=function(e,t,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(e){return e.getParam("table_appearance_options",!0,"boolean")}(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},Ml=function(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)p(n)?e.setStyle(t,n,r):e.setStyle(t,n);else if(t.children)for(var o=0;o<t.children.length;o++)Ml(e,t.children[o],n,r)},Ll=function(e,t,n){var r,o=e.dom,i=n.getData();n.close(),""===i.class&&delete i.class,e.undoManager.transact((function(){if(!t){var n=parseInt(i.cols,10)||1,a=parseInt(i.rows,10)||1;t=Zu(e,n,a,0,0)}!function(e,t,n){var r,o=e.dom,i={},a={};if(i.class=n.class,a.height=Ma(n.height),o.getAttrib(t,"width")&&!xa(e)?i.width=(r=n.width)?r.replace(/px$/,""):"":a.width=Ma(n.width),xa(e)?(a["border-width"]=Ma(n.border),a["border-spacing"]=Ma(n.cellspacing)):(i.border=n.border,i.cellpadding=n.cellpadding,i.cellspacing=n.cellspacing),xa(e)&&t.children)for(var c=0;c<t.children.length;c++)Ml(o,t.children[c],{"border-width":Ma(n.border),padding:Ma(n.cellpadding)}),Ca(e)&&Ml(o,t.children[c],{"border-color":n.bordercolor});Ca(e)&&(a["background-color"]=n.backgroundcolor,a["border-color"]=n.bordercolor,a["border-style"]=n.borderstyle),i.style=o.serializeStyle(z(z({},ba(e)),a)),o.setAttribs(t,z(z({},va(e)),i)),da(e,t)}(e,t,i),(r=o.select("caption",t)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=Pl.ie?"":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),""===i.align?sl(e,t):ll(e,t,i.align),e.focus(),e.addVisual()}))},Fl=function(e,t){var n,o=e.dom,i=function(e,t){var n,r,o,i,a=ba(e),c=va(e),u=t?(n=e.dom,{borderstyle:Oe(a,"border-style").getOr(""),bordercolor:ml(n)(Oe(a,"border-color").getOr("")),backgroundcolor:ml(n)(Oe(a,"background-color").getOr(""))}):{};return z(z(z(z(z(z({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),c),u),(i=a["border-width"],xa(e)&&i?{border:i}:Oe(c,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(r=Oe(a,"border-spacing").or(Oe(c,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),o=Oe(a,"border-padding").or(Oe(c,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),z(z({},r),o)))}(e,Ca(e));!1===t?(n=o.getParent(e.selection.getStart(),"table"))?i=function(e,t,n){var r=e.dom;return z({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"cellpadding")||ul(e.dom,t,"padding"),border:function(t,n){var r=Dt(ve.fromDom(n),"border-width");return xa(e)&&r.isSome()?r.getOr(""):t.getAttrib(n,"border")||ul(e.dom,n,"border-width")||ul(e.dom,n,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:bl(e,t)},n?pl(r,t):{})}(e,n,Ca(e)):Ca(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor=""):(i.cols="1",i.rows="1",Ca(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor=""));var a=dl(function(e){return e.getParam("table_class_list",[],"array")}(e));a.length>0&&i.class&&(i.class=i.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:Bl(e,a,t)},u=Ca(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},hl("table")]}:{type:"panel",items:[c]};e.windowManager.open({title:"Table Properties",size:"normal",body:u,onSubmit:r(Ll,e,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i})},jl=function(e){return Vu(Ha(e))},Hl=function(e){return qu(Ha(e))},Ul=function(t,n,o,a,c){var u=Ba(t),l=function(e){return $t(e,u)},s=function(e){return function(n){t.selection.setRng(n),t.focus(),o.clear(e),La(e),da(t,e.dom)}},d=function(e){return Hl(t).each((function(t){l(t).each((function(n){var r=xr(a,n,t);e(n,r).each(s(n))}))}))},m=function(){return Hl(t).map((function(n){return l(n).bind((function(r){var o=xr(a,r,n),i=pr(e,ve.fromDom(t.getDoc()),f.none());return al(r,o,i)}))}))},h=function(){return Hl(t).map((function(e){return l(e).bind((function(t){var n=xr(a,t,e);return il(t,n)}))}))},v=function(e,n){return n().each((function(n){var r=A(n,(function(e){return ir(e)}));Hl(t).each((function(n){return l(n).each((function(n){var o=gr(ve.fromDom(t.getDoc())),i=function(e,t,n,r){return{selection:vr(e),clipboard:n,generators:r}}(a,0,r,o);e(n,i).each(s(n))}))}))}))};Ee({mceTableSplitCells:function(){return d(n.unmergeCells)},mceTableMergeCells:function(){return d(n.mergeCells)},mceTableInsertRowBefore:function(){return d(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return d(n.insertRowsAfter)},mceTableInsertColBefore:function(){return d(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return d(n.insertColumnsAfter)},mceTableDeleteCol:function(){return d(n.deleteColumn)},mceTableDeleteRow:function(){return d(n.deleteRow)},mceTableCutCol:function(e){return h().each((function(e){c.setColumns(e),d(n.deleteColumn)}))},mceTableCutRow:function(e){return m().each((function(e){c.setRows(e),d(n.deleteRow)}))},mceTableCopyCol:function(e){return h().each((function(e){return c.setColumns(e)}))},mceTableCopyRow:function(e){return m().each((function(e){return c.setRows(e)}))},mceTablePasteColBefore:function(e){return v(n.pasteColsBefore,c.getColumns)},mceTablePasteColAfter:function(e){return v(n.pasteColsAfter,c.getColumns)},mceTablePasteRowBefore:function(e){return v(n.pasteRowsBefore,c.getRows)},mceTablePasteRowAfter:function(e){return v(n.pasteRowsAfter,c.getRows)},mceTableDelete:function(){return jl(t).each((function(e){$t(e,u).filter(i(u)).each((function(e){var n=ve.fromText("");if(pn(e,n),Cn(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom,0),r.setEnd(n.dom,0),t.selection.setRng(r),t.nodeChanged()}}))}))},mceTableSizingMode:function(e,n){return function(e){return jl(t).each((function(n){Ta(t)||Sa(t)||ka(t)||$t(n,u).each((function(n){"relative"!==e||mi(n)?"fixed"!==e||pi(n)?"responsive"!==e||gi(n)||Za(n):Qa(t,n):Ya(t,n),La(n),da(t,n.dom)}))}))}(n)}},(function(e,n){return t.addCommand(n,e)}));var b=function(e,t){t.each((function(t){da(e,t.dom)}))};Ee({mceTableCellType:function(e,r){var o=$t(Ha(t),u);n.setTableCellType(t,r),b(t,o)},mceTableRowType:function(e,r){var o=$t(Ha(t),u);n.setTableRowType(t,r),b(t,o)}},(function(e,n){return t.addCommand(n,e)})),t.addCommand("mceTableColType",(function(e,t){return Oe(t,"type").each((function(e){return d("th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader)}))})),Ee({mceTableProps:r(Fl,t,!1),mceTableRowProps:r(Il,t),mceTableCellProps:r(Al,t,a)},(function(e,n){return t.addCommand(n,(function(){return e()}))})),t.addCommand("mceInsertTable",(function(e,n){g(n)&&Se(n).length>0?el(t,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Fl(t,!0)})),t.addCommand("mceTableApplyCellStyle",(function(e,n){var r=function(e){return"tablecell"+e.toLowerCase().replace("-","")};if(g(n)){var o=$u(Ha(t),a);if(0!==o.length){var i=Ne(n,(function(e,n){return t.formatter.has(r(n))&&p(e)}));(function(e){for(var t in e)if(Te.call(e,t))return!1;return!0})(i)||(Ee(i,(function(e,n){N(o,(function(o){kl.normal(t,o.dom).setFormat(r(n),e)}))})),l(o[0]).each((function(e){return da(t,e.dom,{structure:!1,style:!0})})))}}}))},zl=function(e,t,n){var r=Ba(e);Ee({mceTableRowType:function(){return t.getTableRowType(e)},mceTableCellType:function(){return t.getTableCellType(e)},mceTableColType:function(){return qu(Ha(e)).bind((function(e){return function(e){return $t(e,r)}(e).map((function(r){var o=xr(n,r,e);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,n){return e.addQueryValueHandler(n,t)}))},Wl={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},ql=zn([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Vl=z(z({},ql),{none:function(e){return void 0===e&&(e=void 0),ql.none(e)}}),$l=function(e,t){return $t(e,t).bind((function(t){var n=qt(t);return P(n,(function(t){return we(e,t)})).map((function(e){return{index:e,all:n}}))}))},Kl=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Jl=zn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Gl={before:Jl.before,on:Jl.on,after:Jl.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(n,n,n)}},Xl=zn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Yl={domRange:Xl.domRange,relative:Xl.relative,exact:Xl.exact,exactFromRange:function(e){return Xl.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=function(e){return e.match({domRange:function(e){return ve.fromDom(e.startContainer)},relative:function(e,t){return Gl.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return t=n,ve.fromDom(Ke(t).dom.defaultView)},range:Kl},Ql=function(e,t){return e.selectNodeContents(t.dom)},Zl=function(e,t,n){var r,o=e.document.createRange();return r=o,t.fold((function(e){r.setStartBefore(e.dom)}),(function(e,t){r.setStart(e.dom,t)}),(function(e){r.setStartAfter(e.dom)})),function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))}(o,n),o},es=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},ts=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},ns=zn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),rs=function(e,t,n){return t(ve.fromDom(n.startContainer),n.startOffset,ve.fromDom(n.endContainer),n.endOffset)},os=function(e,n){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return ns.rtl(ve.fromDom(e.endContainer),e.endOffset,ve.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return rs(0,ns.ltr,n)})):rs(0,ns.ltr,n)}(0,function(e,n){return n.match({domRange:function(e){return{ltr:t(e),rtl:f.none}},relative:function(t,n){return{ltr:q((function(){return Zl(e,t,n)})),rtl:q((function(){return f.some(Zl(e,n,t))}))}},exact:function(t,n,r,o){return{ltr:q((function(){return es(e,t,n,r,o)})),rtl:q((function(){return f.some(es(e,r,o,t,n))}))}}})}(e,n))},is=function(e,t){return os(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,n),i}})},as=(ns.ltr,ns.rtl,function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}),cs=function(e,t,n,r,o){var i=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},a=Sn(t).length,c=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,a=1;a<o;a++){var c=e(a),u=Math.abs(t-c.left);if(n<=c.bottom){if(n<c.top||u>i)return a-1;i=u}}return 0}((function(e){return i(e).getBoundingClientRect()}),n,r,o.right,a);return i(c)},us=function(e,t,n,r){return We(t)?function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects();return U(i,(function(e){return as(e,n,r)?f.some(e):f.none()})).map((function(o){return cs(e,t,n,r,o)}))}(e,t,n,r):function(e,t,n,r){var o=e.dom.createRange(),i=Qe(t);return U(i,(function(t){return o.selectNode(t.dom),as(o.getBoundingClientRect(),n,r)?us(e,t,n,r):f.none()}))}(e,t,n,r)},ls=function(e,t){return t-e.left<e.right-t},ss=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},fs=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=ls(o,n);return(!0===i?er:tr)(t).map((function(t){return ss(e,t,i)}))},ds=function(e,t,n){var r=t.dom.getBoundingClientRect(),o=ls(r,n);return f.some(ss(e,t,o))},ms=function(e,t,n){return f.from(e.dom.caretPositionFromPoint(t,n)).bind((function(t){if(null===t.offsetNode)return f.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),f.some(n)}))},ps=function(e,t,n){return f.from(e.dom.caretRangeFromPoint(t,n))},gs=function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),a=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return us(e,t,a,c)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},hs=function(e,t,n){return ve.fromPoint(e,t,n).bind((function(r){var o=function(){return function(e,t,n){return(0===Qe(t).length?ds:fs)(e,t,n)}(e,r,t)};return 0===Qe(r).length?o():gs(e,r,t,n).orThunk(o)}))},vs=document.caretPositionFromPoint?ms:document.caretRangeFromPoint?ps:hs,bs=function(e,t){var n=Fe(e);return"input"===n?Gl.after(e):T(["br","img"],n)?0===t?Gl.before(e):Gl.after(e):Gl.on(e,t)},ys=function(e,t){var n=e.fold(Gl.before,bs,Gl.after),r=t.fold(Gl.before,bs,Gl.after);return Yl.relative(n,r)},ws=function(e,t,n,r){var o=bs(e,t),i=bs(n,r);return Yl.relative(o,i)},Cs=function(e,t,n,r){var o=function(e,t,n,r){var o=$e(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o}(e,t,n,r),i=we(e,n)&&t===r;return o.collapsed&&!i},xs=function(e){return f.from(e.getSelection())},ks=function(e,t){xs(e).each((function(e){e.removeAllRanges(),e.addRange(t)}))},Ss=function(e,t,n,r,o){var i=es(e,t,n,r,o);ks(e,i)},Ts=function(e,t){return os(e,t).match({ltr:function(t,n,r,o){Ss(e,t,n,r,o)},rtl:function(t,n,r,o){xs(e).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,r.dom,o);else if(i.extend)try{!function(e,t,n,r,o,i){t.collapse(n.dom,r),t.extend(o.dom,i)}(0,i,t,n,r,o)}catch(i){Ss(e,r,o,t,n)}else Ss(e,r,o,t,n)}))}})},Es=function(e,t,n,r,o){var i=ws(t,n,r,o);Ts(e,i)},_s=function(e,t,n){var r=ys(t,n);Ts(e,r)},As=function(e){var t=Yl.getWin(e).dom,n=function(e,n,r,o){return es(t,e,n,r,o)},r=function(e){return e.match({domRange:function(e){var t=ve.fromDom(e.startContainer),n=ve.fromDom(e.endContainer);return ws(t,e.startOffset,n,e.endOffset)},relative:ys,exact:ws})}(e);return os(t,r).match({ltr:n,rtl:n})},Ns=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return f.some(Kl(ve.fromDom(t.startContainer),t.startOffset,ve.fromDom(n.endContainer),n.endOffset))}return f.none()},Rs=function(e){if(null===e.anchorNode||null===e.focusNode)return Ns(e);var t=ve.fromDom(e.anchorNode),n=ve.fromDom(e.focusNode);return Cs(t,e.anchorOffset,n,e.focusOffset)?f.some(Kl(t,e.anchorOffset,n,e.focusOffset)):Ns(e)},Os=function(e,t){var n=function(e,t){var n=e.document.createRange();return Ql(n,t),n}(e,t);ks(e,n)},Ds=function(e){return function(e){return xs(e).filter((function(e){return e.rangeCount>0})).bind(Rs)}(e).map((function(e){return Yl.exact(e.start,e.soffset,e.finish,e.foffset)}))},Is=function(e,t){return function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?f.some(n).map(ts):f.none()}(is(e,t))},Ps=function(e,t,n){return function(e,t,n){var r=ve.fromDom(e.document);return vs(r,t,n).map((function(e){return Kl(ve.fromDom(e.startContainer),e.startOffset,ve.fromDom(e.endContainer),e.endOffset)}))}(e,t,n)},Bs=tinymce.util.Tools.resolve("tinymce.util.VK"),Ms=function(e,t,n,r){return js(e,t,function(e,t){return $l(e,t).fold((function(){return Vl.none(e)}),(function(t){return t.index+1<t.all.length?Vl.middle(e,t.all[t.index+1]):Vl.last(e)}))}(n),r)},Ls=function(e,t,n,r){return js(e,t,function(e,t){return $l(e,t).fold((function(){return Vl.none()}),(function(t){return t.index-1>=0?Vl.middle(e,t.all[t.index-1]):Vl.first(e)}))}(n),r)},Fs=function(e,t){var n=Yl.exact(t,0,t,0);return As(n)},js=function(e,t,n,r){return n.fold(f.none,f.none,(function(e,t){return er(t).map((function(e){return Fs(0,e)}))}),(function(n){return $t(n,t).bind((function(t){var o=Cr(n);return e.undoManager.transact((function(){r.insertRowsAfter(t,o)})),function(e,t){var n=dt(t,"tr");return H(n).bind((function(e){return vt(e,"td,th").map((function(e){return Fs(0,e)}))}))}(0,t)}))}))},Hs=["table","li","dl"],Us=function(e,t){return{selection:e,kill:t}},zs=function(e,t,n,r){return{start:Gl.on(e,t),finish:Gl.on(n,r)}},Ws=function(e,t){var n=is(e,t);return Kl(ve.fromDom(n.startContainer),n.startOffset,ve.fromDom(n.endContainer),n.endOffset)},qs=zs,Vs=function(e,t,n,r,o){return we(n,r)?f.none():Mn(n,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>0?(o(e,r,t.start,t.finish),f.some(Us(f.some(qs(n,0,n,Yn(n))),!0))):f.none()}))},$s=function(e,t){return{item:e,mode:t}},Ks=function(e,t,n,r){return void 0===r&&(r=Js),e.property().parent(t).map((function(e){return $s(e,r)}))},Js=function(e,t,n,r){return void 0===r&&(r=Gs),n.sibling(e,t).map((function(e){return $s(e,r)}))},Gs=function(e,t,n,r){void 0===r&&(r=Gs);var o=e.property().children(t);return n.first(o).map((function(e){return $s(e,r)}))},Xs=[{current:Ks,next:Js,fallback:f.none()},{current:Js,next:Gs,fallback:f.some(Ks)},{current:Gs,next:Gs,fallback:f.some(Js)}],Ys=function(e,t,n,r,o){return void 0===o&&(o=Xs),I(o,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Ys(e,t,n,r)}))}))}))},Qs=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?f.some(e[e.length-1]):f.none()}}},Zs=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?f.some(e[0]):f.none()}}},ef=function(e,t,n,r,o,i){return Ys(e,t,r,o).bind((function(t){return i(t.item)?f.none():n(t.item)?f.some(t.item):ef(e,t.item,n,t.mode,o,i)}))},tf=function(e){return function(t){return 0===e.property().children(t).length}},nf=function(e,t,n,r){return ef(e,t,n,Js,Qs(),r)},rf=function(e,t,n,r){return ef(e,t,n,Js,Zs(),r)},of=An(),af=function(e,t){return function(e,t,n){return nf(e,t,tf(e),n)}(of,e,t)},cf=function(e,t){return function(e,t,n){return rf(e,t,tf(e),n)}(of,e,t)},uf=zn([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),lf=function(e){return bt(e,"tr")},sf=z(z({},uf),{verify:function(e,t,n,r,o,i,a){return bt(r,"td,th",a).bind((function(n){return bt(t,"td,th",a).map((function(t){return we(n,t)?we(r,n)&&Yn(n)===o?i(t):uf.none("in same cell"):Pn(lf,[n,t]).fold((function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?uf.success():i(t)}),(function(e){return i(t)}))}))})).getOr(uf.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)}}),ff=function(e,t){return P(e,r(we,t))},df=function(e){return"br"===Fe(e)},mf=function(e,t,n){return t(e,n).bind((function(e){return We(e)&&0===Sn(e).trim().length?mf(e,t,n):f.some(e)}))},pf=function(e,t,n,r){return function(e,t){return Ze(e,t).filter(df).orThunk((function(){return Ze(e,t-1).filter(df)}))}(t,n).bind((function(t){return r.traverse(t).fold((function(){return mf(t,r.gather,e).map(r.relative)}),(function(e){return function(e){return Je(e).bind((function(t){var n=Qe(t);return ff(n,e).map((function(r){return function(e,t,n,r){return{parent:e,children:t,element:n,index:r}}(t,n,e,r)}))}))}(e).map((function(e){return Gl.on(e.parent,e.index)}))}))}))},gf=function(e,t,n,r){return(df(t)?function(e,t,n){return n.traverse(t).orThunk((function(){return mf(t,n.gather,e)})).map(n.relative)}(e,t,r):pf(e,t,n,r)).map((function(e){return{start:e,finish:e}}))},hf=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},vf=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},bf=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},yf=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},wf=function(e,t){return f.some(e.getRect(t))},Cf=function(e,t,n){return ze(t)?wf(e,t).map(yf):We(t)?function(e,t,n){return n>=0&&n<Yn(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):f.none()}(e,t,n).map(yf):f.none()},xf=function(e,t){return ze(t)?wf(e,t).map(yf):We(t)?e.getRangedRect(t,0,t,Yn(t)).map(yf):f.none()},kf=zn([{none:[]},{retry:["caret"]}]),Sf=function(e,t,n){return(r=t,o=au,mt((function(e,t){return t(e)}),pt,r,o,i)).fold(a,(function(t){return xf(e,t).exists((function(e){return function(e,t){return e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right}(n,e)}))}));var r,o,i},Tf={point:function(e){return e.bottom},adjuster:function(e,t,n,r,o){var i=hf(o,5);return Math.abs(n.bottom-r.bottom)<1||n.top>o.bottom?kf.retry(i):n.top===o.bottom?kf.retry(hf(o,1)):Sf(e,t,o)?kf.retry(bf(i,5,0)):kf.none()},move:hf,gather:cf},Ef=function(e,t,n,r,o){return 0===o?f.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===Fe(e)})).isSome()}(e,r.left,t.point(r))?function(e,t,n,r,o){return Ef(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left,t.point(r)).bind((function(i){return i.start.fold(f.none,(function(i){return xf(e,i).bind((function(a){return t.adjuster(e,i,a,n,r).fold(f.none,(function(r){return Ef(e,t,n,r,o-1)}))})).orThunk((function(){return f.some(r)}))}),f.none)}))},_f=function(e,t,n){var r=e.move(n,5),o=Ef(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?f.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?f.some(-e.point(t)):f.none()}(e,o,t).fold((function(){return t.situsFromPoint(o.left,e.point(o))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left,e.point(o)-n)}))},Af={tryUp:r(_f,{point:function(e){return e.top},adjuster:function(e,t,n,r,o){var i=vf(o,5);return Math.abs(n.top-r.top)<1||n.bottom<o.top?kf.retry(i):n.bottom===o.top?kf.retry(vf(o,1)):Sf(e,t,o)?kf.retry(bf(i,5,0)):kf.none()},move:vf,gather:af}),tryDown:r(_f,Tf),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:t(5)},Nf=function(e,t,n){return e.getSelection().bind((function(r){return gf(t,r.finish,r.foffset,n).fold((function(){return f.some(rc(r.finish,r.foffset))}),(function(o){var i=e.fromSitus(o);return function(e){return sf.cata(e,(function(e){return f.none()}),(function(){return f.none()}),(function(e){return f.some(rc(e,0))}),(function(e){return f.some(rc(e,Yn(e)))}))}(sf.verify(e,r.finish,r.foffset,i.finish,i.foffset,n.failure,t))}))}))},Rf=function(e,t,n,r,o,i){return 0===i?f.none():If(e,t,n,r,o).bind((function(a){var c=e.fromSitus(a),u=sf.verify(e,n,r,c.finish,c.foffset,o.failure,t);return sf.cata(u,(function(){return f.none()}),(function(){return f.some(a)}),(function(a){return we(n,a)&&0===r?Of(e,n,r,vf,o):Rf(e,t,a,0,o,i-1)}),(function(a){return we(n,a)&&r===Yn(a)?Of(e,n,r,hf,o):Rf(e,t,a,Yn(a),o,i-1)}))}))},Of=function(e,t,n,r,o){return Cf(e,t,n).bind((function(t){return Df(e,o,r(t,Af.getJumpSize()))}))},Df=function(e,t,n){var r=ge().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):f.none()},If=function(e,t,n,r,o){return Cf(e,n,r).bind((function(t){return Df(e,o,t)}))},Pf=function(e,t){return pt(e,(function(e){return Je(e).exists((function(e){return we(e,t)}))}),n).isSome();var n},Bf=function(e,t,n,r,o){return bt(r,"td,th",t).bind((function(r){return bt(r,"table",t).bind((function(i){return Pf(o,i)?function(e,t,n){return Nf(e,t,n).bind((function(r){return Rf(e,t,r.element,r.offset,n,20).map(e.fromSitus)}))}(e,t,n).bind((function(e){return bt(e.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:e}}))})):f.none()}))}))},Mf=function(e,t,n,r,o,i){return ge().browser.isIE()?f.none():i(r,t).orThunk((function(){return Bf(e,t,n,r,o).map((function(e){var t=e.range;return Us(f.some(qs(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Lf=function(e,t){return bt(e,"tr",t).bind((function(e){return bt(e,"table",t).bind((function(n){var r=dt(n,"tr");return we(e,r[0])?function(e,t,n){return nf(of,e,t,n)}(n,(function(e){return tr(e).isSome()}),t).map((function(e){var t=Yn(e);return Us(f.some(qs(e,t,e,t)),!0)})):f.none()}))}))},Ff=function(e,t){return bt(e,"tr",t).bind((function(e){return bt(e,"table",t).bind((function(n){var r=dt(n,"tr");return we(e,r[r.length-1])?function(e,t,n){return rf(of,e,t,n)}(n,(function(e){return er(e).isSome()}),t).map((function(e){return Us(f.some(qs(e,0,e,0)),!0)})):f.none()}))}))},jf=function(e,t,n,r,o,i,a){return Bf(e,n,r,o,i).bind((function(e){return Vs(t,n,e.start,e.finish,a)}))},Hf=function(e,t){return bt(e,"td,th",t)};function Uf(e,t,n,r){var o,i=(o=Ua(f.none()),{clear:function(){return o.set(f.none())},set:function(e){return o.set(f.some(e))},isSet:function(){return o.get().isSome()},on:function(e){return o.get().each(e)}}),a=i.clear;return{clearstate:a,mousedown:function(e){r.clear(t),Hf(e.target,n).each(i.set)},mouseover:function(o){i.on((function(i){r.clearBeforeUpdate(t),Hf(o.target,n).each((function(o){Mn(i,o,n).each((function(n){var a=n.boxes.getOr([]);(a.length>1||1===a.length&&!we(i,o))&&(r.selectRange(t,a,n.start,n.finish),e.selectContents(o))}))}))}))},mouseup:function(e){a()}}}var zf={traverse:Ye,gather:cf,relative:Gl.before,otherRetry:Af.tryDown,ieRetry:Af.ieTryDown,failure:sf.failedDown},Wf={traverse:Xe,gather:af,relative:Gl.before,otherRetry:Af.tryUp,ieRetry:Af.ieTryUp,failure:sf.failedUp},qf=function(e){return function(t){return t===e}},Vf=qf(38),$f=qf(40),Kf=function(e){return e>=37&&e<=40},Jf={isBackward:qf(37),isForward:qf(39)},Gf={isBackward:qf(39),isForward:qf(37)},Xf=function(e){return{elementFromPoint:function(t,n){return ve.fromPoint(ve.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Yl.exact(t,n,r,o);return Is(e,i)},getSelection:function(){return Ds(e).map((function(t){return Ws(e,t)}))},fromSitus:function(t){var n=Yl.relative(t.start,t.finish);return Ws(e,n)},situsFromPoint:function(t,n){return Ps(e,t,n).map((function(e){return zs(e.start,e.soffset,e.finish,e.foffset)}))},clearSelection:function(){!function(e){xs(e).each((function(e){return e.removeAllRanges()}))}(e)},collapseSelection:function(t){void 0===t&&(t=!1),Ds(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var o=t?n:r;_s(e,o,o)}),(function(n,r,o,i){var a=t?n:o,c=t?r:i;Es(e,a,c,a,c)}))}))},setSelection:function(t){Es(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){_s(e,t,n)},selectContents:function(t){Os(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,o;return(t=ve.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop,Vr(r,o)).top},scrollBy:function(t,n){!function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollBy(e,t)}(t,n,ve.fromDom(e.document))}}},Yf=function(e,t){return{rows:e,cols:t}},Qf=function(e,t,n,o){var i=Xf(e),a=function(){return o.clear(t),f.none()};return{keydown:function(e,c,u,l,s,d){var m=e.raw,p=m.which,g=!0===m.shiftKey;return Ln(t,o.selectedSelector).fold((function(){return $f(p)&&g?r(jf,i,t,n,zf,l,c,o.selectRange):Vf(p)&&g?r(jf,i,t,n,Wf,l,c,o.selectRange):$f(p)?r(Mf,i,n,zf,l,c,Ff):Vf(p)?r(Mf,i,n,Wf,l,c,Lf):f.none}),(function(e){var n=function(n){return function(){return U(n,(function(n){return function(e,t,n,r,o){return jn(r,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){return o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes}))}(n.rows,n.cols,t,e,o)})).fold((function(){return Fn(t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){var n=$f(p)||d.isForward(p)?Gl.after:Gl.before;return i.setRelativeSelection(Gl.on(e.first,0),n(e.table)),o.clear(t),Us(f.none(),!0)}))}),(function(e){return f.some(Us(f.none(),!0))}))}};return $f(p)&&g?n([Yf(1,0)]):Vf(p)&&g?n([Yf(-1,0)]):d.isBackward(p)&&g?n([Yf(0,-1),Yf(-1,0)]):d.isForward(p)&&g?n([Yf(0,1),Yf(1,0)]):Kf(p)&&!1===g?a:f.none}))()},keyup:function(e,r,i,a,c){return Ln(t,o.selectedSelector).fold((function(){var u=e.raw,l=u.which;return!1===(!0===u.shiftKey)?f.none():Kf(l)?function(e,t,n,r,o,i,a){return we(n,o)&&r===i?f.none():bt(n,"td,th",t).bind((function(n){return bt(o,"td,th",t).bind((function(r){return Vs(e,t,n,r,a)}))}))}(t,n,r,i,a,c,o.selectRange):f.none()}),f.none)}}},Zf=function(e,t,n){var r=function(t){St(t,e.selected),St(t,e.firstSelected),St(t,e.lastSelected)},o=function(t){wt(t,e.selected,"1")},i=function(e){a(e),n()},a=function(t){var n=dt(t,e.selectedSelector);N(n,r)};return{clearBeforeUpdate:a,clear:i,selectRange:function(n,r,a,c){i(n),N(r,o),wt(a,e.firstSelected,"1"),wt(c,e.lastSelected,"1"),t(r,a,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},ed=function(e,t,n){var r=tn.fromTable(e);return Rc(r,t).map((function(e){var t=kc(r,n,!1);return{upOrLeftCells:function(e,t,n){var r=e.slice(0,t[t.length-1].row+1),o=Tc(r,n);return M(o,(function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return A(n,(function(e){return e.element}))}))}(t,e,n),downOrRightCells:function(e,t,n){var r=e.slice(t[0].row+t[0].rowspan-1,e.length),o=Tc(r,n);return M(o,(function(e){var n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return A(n,(function(e){return e.element}))}))}(t,e,n)}}))},td=function(e){return!1===Hi(ve.fromDom(e.target),"ephox-snooker-resizer-bar")};function nd(t,n,r){var o=Zf(wr,(function(n,o,i){r.targets().each((function(r){$t(o).each((function(a){var c=Ra(t),u=pr(e,ve.fromDom(t.getDoc()),c),l=ed(a,r,u);!function(e,t,n,r,o){e.fire("TableSelectionChange",{cells:t,start:n,finish:r,otherCells:o})}(t,n,o,i,l)}))}))}),(function(){return function(e){e.fire("TableSelectionClear")}(t)}));return t.on("init",(function(r){var i=t.getWin(),a=Da(t),c=Ba(t),u=function(e,t,n,r){var o=Uf(Xf(e),t,n,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(i,a,c,o),l=Qf(i,a,c,o),s=function(e,t,n,r){var o=Xf(e);return function(e,i){r.clearBeforeUpdate(t),Mn(e,i,n).each((function(e){var n=e.boxes.getOr([]);r.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()}))}}(i,a,c,o);t.on("TableSelectorChange",(function(e){return s(e.start,e.finish)}));var f,d,m=function(e,n){(function(e){return!0===e.raw.shiftKey})(e)&&(n.kill&&e.kill(),n.selection.each((function(e){var n=Yl.relative(e.start,e.finish),r=is(i,n);t.selection.setRng(r)})))},p=function(e){return 0===e.button},g=(f=Ua(ve.fromDom(a)),d=Ua(0),{touchEnd:function(e){var t=ve.fromDom(e.target);if("td"===Fe(t)||"th"===Fe(t)){var n=f.get(),r=d.get();we(n,t)&&e.timeStamp-r<300&&(e.preventDefault(),s(t,t))}f.set(t),d.set(e.timeStamp)}});t.on("dragstart",(function(e){u.clearstate()})),t.on("mousedown",(function(e){p(e)&&td(e)&&u.mousedown(Bi(e))})),t.on("mouseover",(function(e){var t;(void 0===(t=e).buttons||Pl.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&td(e)&&u.mouseover(Bi(e))})),t.on("mouseup",(function(e){p(e)&&td(e)&&u.mouseup(Bi(e))})),t.on("touchend",g.touchEnd),t.on("keyup",(function(e){var n=Bi(e);if(n.raw.shiftKey&&Kf(n.raw.which)){var r=t.selection.getRng(),o=ve.fromDom(r.startContainer),i=ve.fromDom(r.endContainer);l.keyup(n,o,r.startOffset,i,r.endOffset).each((function(e){m(n,e)}))}})),t.on("keydown",(function(e){var r=Bi(e);n().each((function(e){return e.hideBars()}));var o=t.selection.getRng(),i=ve.fromDom(o.startContainer),a=ve.fromDom(o.endContainer),c=jr(Jf,Gf)(ve.fromDom(t.selection.getStart()));l.keydown(r,i,o.startOffset,a,o.endOffset,c).each((function(e){m(r,e)})),n().each((function(e){return e.showBars()}))})),t.on("NodeChange",(function(){var n=t.selection,r=ve.fromDom(n.getStart()),i=ve.fromDom(n.getEnd());Pn($t,[r,i]).fold((function(){return o.clear(a)}),e)}))})),{clear:o.clear}}var rd=function(e,t){var n=Ua(f.none()),r=Ua([]),o=function(){return Vu(Ha(e)).bind((function(e){var n=$t(e);return n.map((function(n){return"caption"===Fe(e)?Cr(e):xr(t,n,e)}))}))},i=function(){n.set(q(o)()),N(r.get(),(function(e){return e()}))},a=function(e,t){var o=function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))};return o(),r.set(r.get().concat([o])),function(){r.set(R(r.get(),(function(e){return e!==o})))}};return e.on("NodeChange ExecCommand TableSelectorChange",i),{onSetupTable:function(e){return a(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return a(e,(function(e){return"caption"===Fe(e.element)}))},onSetupPasteable:function(e){return function(t){return a(t,(function(t){return"caption"===Fe(t.element)||e().isNone()}))}},onSetupMergeable:function(e){return a(e,(function(e){return e.mergable.isNone()}))},onSetupUnmergeable:function(e){return a(e,(function(e){return e.unmergable.isNone()}))},resetTargets:i,targets:function(){return n.get()}}};function od(e){var t=function(e,t,n){return{get:function(){return Hn(e(),n).fold((function(){return t().map(Kn).getOrThunk(Vn)}),(function(e){return $n(e)}))}}}((function(){return Da(e)}),(function(){return Vu(Ha(e))}),wr.selectedSelector),n=rd(e,t),r=nc(e),o=nd(e,r.lazyResize,n),i=Ju(e,r.lazyWire,t),a=function(){var e=Ua(f.none()),t=Ua(f.none()),n=function(e){e.set(f.none())};return{getRows:e.get,setRows:function(r){e.set(r),n(t)},clearRows:function(){return n(e)},getColumns:t.get,setColumns:function(r){t.set(r),n(e)},clearColumns:function(){return n(t)}}}();return Ul(e,i,o,t,a),zl(e,i,t),kr(e,t,i,o),function(e,t,n){var r=function(t){return function(){return e.execCommand(t)}},o=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},i={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)});e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)});e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",i),e.ui.registry.addMenuItem("deletetable",a),e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(e){return"caption"===Fe(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(e,n,a),function(e,t,n){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(e,n,a),function(e){var t=function(e){return e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},items:t,scope:"node",position:"node"})}(e),e.on("PreInit",(function(){e.serializer.addTempAttr(wr.firstSelected),e.serializer.addTempAttr(wr.lastSelected),function(e){e.formatter.register(Wl)}(e)})),function(e){return e.getParam("table_tab_navigation",!0,"boolean")}(e)&&e.on("keydown",(function(t){!function(e,t,n){if(e.keyCode===Bs.TAB){var r=Da(t),o=function(e){var t=Fe(e);return we(e,r)||T(Hs,t)},i=t.selection.getRng();if(i.collapsed){var a=ve.fromDom(i.startContainer);Wt(a,o).each((function(r){e.preventDefault(),(e.shiftKey?Ls:Ms)(t,o,r,n).each((function(e){t.selection.setRng(e)}))}))}}}(t,e,i)})),e.on("remove",(function(){r.destroy()})),function(e,t,n,r){return{insertTable:rl(e),setClipboardRows:nl(t.setRows),getClipboardRows:tl(t.getRows),setClipboardCols:nl(t.setColumns),getClipboardCols:tl(t.getColumns),resizeHandler:n,selectionTargets:r}}(e,a,r,n)}Jn.add("table",od)}()},"./node_modules/tinymce/tinymce.js":function(e,t,n){(function(t,n){!function(){"use strict";var r=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},o=function(e){return{eq:e}},i=o((function(e,t){return e===t})),a=function(e){return o((function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e.eq(t[o],n[o]))return!1;return!0}))},c=function(e,t){return function(e,t){return o((function(n,r){return e.eq(t(n),t(r))}))}(a(e),(function(e){return function(e,t){return Array.prototype.slice.call(e).sort(t)}(e,t)}))},u=function(e){return o((function(t,n){var r=Object.keys(t),o=Object.keys(n);if(!c(i).eq(r,o))return!1;for(var a=r.length,u=0;u<a;u++){var l=r[u];if(!e.eq(t[l],n[l]))return!1}return!0}))},l=o((function(e,t){if(e===t)return!0;var n=r(e);return n===r(t)&&(function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)}(n)?e===t:"array"===n?a(l).eq(e,t):"object"===n&&u(l).eq(e,t))})),s=function(){},f=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},d=function(e){return function(){return e}},m=function(e){return e};function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var g=function(e){return function(t){return!e(t)}},h=function(e){return function(){throw new Error(e)}},v=function(e){e()},b=d(!1),y=d(!0),w=function(){return C},C=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e};return{fold:function(e,t){return e()},is:b,isSome:b,isNone:y,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:n,orThunk:t,map:w,each:s,bind:w,exists:b,forall:y,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:d("none()")}}(),x=function(e){var t=d(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:y,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return x(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(b,(function(t){return n(e,t)}))}};return o},k={some:x,none:w,from:function(e){return null==e?C:x(e)}},S=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},T=function(e){return function(t){return typeof t===e}},E=function(e){return function(t){return e===t}},_=S("string"),A=S("object"),N=S("array"),R=E(null),O=T("boolean"),D=E(void 0),I=function(e){return null==e},P=function(e){return!I(e)},B=T("function"),M=T("number"),L=Array.prototype.slice,F=Array.prototype.indexOf,j=Array.prototype.push,H=function(e,t){return F.call(e,t)},U=function(e,t){return H(e,t)>-1},z=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},W=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},q=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},V=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}},$=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},K=function(e,t,n){return V(e,(function(e){n=t(n,e)})),n},J=function(e,t,n){return q(e,(function(e){n=t(n,e)})),n},G=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return k.some(i);if(n(i,r))break}return k.none()}(e,t,b)},X=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return k.some(n)}return k.none()},Y=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!N(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);j.apply(t,e[n])}return t}(W(e,t))},Q=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},Z=function(e){var t=L.call(e,0);return t.reverse(),t},ee=function(e,t){return $(e,(function(e){return!U(t,e)}))},te=function(e,t){return t>=0&&t<e.length?k.some(e[t]):k.none()},ne=function(e){return te(e,0)},re=function(e){return te(e,e.length-1)},oe=B(Array.from)?Array.from:function(e){return L.call(e)},ie=Object.keys,ae=Object.hasOwnProperty,ce=function(e,t){for(var n=ie(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},ue=function(e,t){return le(e,(function(e,n){return{k:n,v:t(e,n)}}))},le=function(e,t){var n={};return ce(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},se=function(e){return function(t,n){e[n]=t}},fe=function(e,t,n,r){return ce(e,(function(e,o){(t(e,o)?n:r)(e,o)})),{}},de=function(e,t){var n={},r={};return fe(e,t,se(n),se(r)),{t:n,f:r}},me=function(e,t){var n={};return fe(e,t,se(n),s),n},pe=function(e){return function(e,t){var n=[];return ce(e,(function(e,r){n.push(t(e,r))})),n}(e,(function(e){return e}))},ge=function(e,t){return he(e,t)?k.from(e[t]):k.none()},he=function(e,t){return ae.call(e,t)},ve=function(e,t){return he(e,t)&&void 0!==e[t]&&null!==e[t]},be=Array.isArray,ye=function(e,t,n){var r,o;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return!1;return!0},we=function(e,t){var n=[];return ye(e,(function(r,o){n.push(t(r,o,e))})),n},Ce=function(e,t){var n=[];return ye(e,(function(r,o){t&&!t(r,o,e)||n.push(r)})),n},xe=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},ke=function(e,t,n,r){for(var o=D(n)?e[0]:n,i=0;i<e.length;i++)o=t.call(r,o,e[i],i);return o},Se=function(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},Te=function(e){return e[e.length-1]},Ee=function(){return(Ee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function _e(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}var Ae=function(){return Ne(0,0)},Ne=function(e,t){return{major:e,minor:t}},Re={nu:Ne,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Ae():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Ne(r(1),r(2))}(e,n)},unknown:Ae},Oe=function(e,t){var n=String(t).toLowerCase();return G(e,(function(e){return e.search(n)}))},De=function(e,t){return Oe(e,t).map((function(e){var n=Re.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Ie=function(e,t){return Oe(e,t).map((function(e){var n=Re.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Pe=function(e,t){return-1!==e.indexOf(t)},Be=function(e,t){return function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t}(e,t,0)},Me=function(e){return function(t){return t.replace(e,"")}},Le=Me(/^\s+|\s+$/g),Fe=Me(/^\s+/g),je=Me(/\s+$/g),He=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ue=function(e){return function(t){return Pe(t,e)}},ze=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Pe(e,"edge/")&&Pe(e,"chrome")&&Pe(e,"safari")&&Pe(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,He],search:function(e){return Pe(e,"chrome")&&!Pe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Pe(e,"msie")||Pe(e,"trident")}},{name:"Opera",versionRegexes:[He,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ue("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ue("firefox")},{name:"Safari",versionRegexes:[He,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Pe(e,"safari")||Pe(e,"mobile/"))&&Pe(e,"applewebkit")}}],We=[{name:"Windows",search:Ue("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Pe(e,"iphone")||Pe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ue("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ue("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ue("linux"),versionRegexes:[]},{name:"Solaris",search:Ue("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ue("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ue("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],qe={browsers:d(ze),oses:d(We)},Ve=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},$e={unknown:function(){return Ve({current:void 0,version:Re.unknown()})},nu:Ve,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d("Firefox"),safari:d("Safari")},Ke=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},Je={unknown:function(){return Ke({current:void 0,version:Re.unknown()})},nu:Ke,windows:d("Windows"),ios:d("iOS"),android:d("Android"),linux:d("Linux"),osx:d("OSX"),solaris:d("Solaris"),freebsd:d("FreeBSD"),chromeos:d("ChromeOS")},Ge=function(e,t){var n=qe.browsers(),r=qe.oses(),o=De(n,e).fold($e.unknown,$e.nu),i=Ie(r,e).fold(Je.unknown,Je.nu),a=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||r("(pointer:coarse)"),u=o||!i&&a&&r("(min-device-width:768px)"),l=i||a&&!u,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!l&&!u&&!s;return{isiPad:d(o),isiPhone:d(i),isTablet:d(u),isPhone:d(l),isTouch:d(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:d(s),isDesktop:d(f)}}(i,o,e,t);return{browser:o,os:i,deviceType:a}},Xe=function(e){return window.matchMedia(e).matches},Ye=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}}((function(){return Ge(navigator.userAgent,Xe)})),Qe=function(){return Ye()},Ze=navigator.userAgent,et=Qe(),tt=et.browser,nt=et.os,rt=et.deviceType,ot=/WebKit/.test(Ze)&&!tt.isEdge(),it="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,at=-1!==Ze.indexOf("Windows Phone"),ct={opera:tt.isOpera(),webkit:ot,ie:!(!tt.isIE()&&!tt.isEdge())&&tt.version.major,gecko:tt.isFirefox(),mac:nt.isOSX()||nt.isiOS(),iOS:rt.isiPad()||rt.isiPhone(),android:nt.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:tt.isIE()?document.documentMode||7:10,fileApi:it,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!tt.isIE(),desktop:rt.isDesktop(),windowsPhone:at,browser:{current:tt.current,version:tt.version,isChrome:tt.isChrome,isEdge:tt.isEdge,isFirefox:tt.isFirefox,isIE:tt.isIE,isOpera:tt.isOpera,isSafari:tt.isSafari},os:{current:nt.current,version:nt.version,isAndroid:nt.isAndroid,isChromeOS:nt.isChromeOS,isFreeBSD:nt.isFreeBSD,isiOS:nt.isiOS,isLinux:nt.isLinux,isOSX:nt.isOSX,isSolaris:nt.isSolaris,isWindows:nt.isWindows},deviceType:{isDesktop:rt.isDesktop,isiPad:rt.isiPad,isiPhone:rt.isiPhone,isPhone:rt.isPhone,isTablet:rt.isTablet,isTouch:rt.isTouch,isWebView:rt.isWebView}},ut=/^\s*|\s*$/g,lt=function(e){return null==e?"":(""+e).replace(ut,"")},st=function(e,t){return t?!("array"!==t||!be(e))||typeof e===t:void 0!==e},ft=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),ye(e,(function(e,o){if(!1===t.call(r,e,o,n))return!1;ft(e,t,n,r)})))},dt={trim:lt,isArray:be,is:st,toArray:function(e){if(be(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:ye,map:we,grep:Ce,inArray:xe,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o=t[r];for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];void 0!==a&&(e[i]=a)}}return e},create:function(e,t,n){var r,o,i,a=0,c=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],u=this.createNS(e[3].replace(/\.\w+$/,""),n);if(!u[c]){if("static"===e[2])return u[c]=t,void(this.onCreate&&this.onCreate(e[2],e[3],u[c]));t[c]||(t[c]=function(){},a=1),u[c]=t[c],this.extend(u[c].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,o=e[5].match(/\.(\w+)$/i)[1],i=u[c],u[c]=a?function(){return r[o].apply(this,arguments)}:function(){return this.parent=r[o],i.apply(this,arguments)},u[c].prototype[c]=u[c],this.each(r,(function(e,t){u[c].prototype[t]=r[t]})),this.each(t,(function(e,t){r[t]?u[c].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==c&&(u[c].prototype[t]=e)}))),this.each(t.static,(function(e,t){u[c][t]=e}))}},walk:ft,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||st(e,"array")?e:we(e.split(t||","),lt)},_addCacheSuffix:function(e){var t=ct.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},mt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},pt={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return mt(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return mt(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return mt(n)},fromDom:mt,fromPoint:function(e,t,n){return k.from(e.dom.elementFromPoint(t,n)).map(mt)}},gt=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},ht=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},vt=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},bt=function(e,t){return e.dom===t.dom},yt=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},wt=function(e,t){return Qe().browser.isIE()?yt(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},Ct=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),xt=function(e){return e.dom.nodeType},kt=function(e){return function(t){return xt(t)===e}},St=kt(1),Tt=kt(3),Et=kt(9),_t=kt(11),At=function(e){return pt.fromDom(e.dom.ownerDocument)},Nt=function(e){return Et(e)?e:At(e)},Rt=function(e){return pt.fromDom(Nt(e).dom.defaultView)},Ot=function(e){return k.from(e.dom.parentNode).map(pt.fromDom)},Dt=function(e){return k.from(e.dom.previousSibling).map(pt.fromDom)},It=function(e){return k.from(e.dom.nextSibling).map(pt.fromDom)},Pt=function(e){return Z(gt(e,Dt))},Bt=function(e){return gt(e,It)},Mt=function(e){return W(e.dom.childNodes,pt.fromDom)},Lt=function(e,t){var n=e.dom.childNodes;return k.from(n[t]).map(pt.fromDom)},Ft=function(e){return Lt(e,0)},jt=function(e){return Lt(e,e.dom.childNodes.length-1)},Ht=function(e){return _t(e)},Ut=B(Element.prototype.attachShadow)&&B(Node.prototype.getRootNode),zt=d(Ut),Wt=Ut?function(e){return pt.fromDom(e.dom.getRootNode())}:Nt,qt=function(e){return Ht(e)?e:function(e){var t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return pt.fromDom(t)}(Nt(e))},Vt=function(e){return pt.fromDom(e.dom.host)},$t=function(e){return P(e.dom.shadowRoot)},Kt=function(e,t){Ot(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},Jt=function(e,t){It(e).fold((function(){Ot(e).each((function(e){Xt(e,t)}))}),(function(e){Kt(e,t)}))},Gt=function(e,t){Ft(e).fold((function(){Xt(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Xt=function(e,t){e.dom.appendChild(t.dom)},Yt=function(e,t){q(t,(function(t){Xt(e,t)}))},Qt=function(e){e.dom.textContent="",q(Mt(e),(function(e){Zt(e)}))},Zt=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},en=function(e){var t,n=Mt(e);n.length>0&&(t=e,q(n,(function(e){Kt(t,e)}))),Zt(e)},tn=function(e){var t=Tt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return function(e){var t=Wt(e);return Ht(t)?k.some(t):k.none()}(pt.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=tn,r=Vt,function(e){return n(r(e))}))},nn=function(e,t){return{left:e,top:t,translate:function(n,r){return nn(e+n,t+r)}}},rn=nn,on=function(e,t){return void 0!==e?e:void 0!==t?t:0},an=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?rn(n.offsetLeft,n.offsetTop):tn(e)?function(e){var t=e.getBoundingClientRect();return rn(t.left,t.top)}(t):rn(0,0)},cn=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return rn(n,r)},un=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},ln=function(e,t){Qe().browser.isSafari()&&B(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},sn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},fn=function(e){var t=void 0===e?window:e,n=t.document,r=cn(pt.fromDom(n));return function(e){var t=void 0===e?window:e;return k.from(t.visualViewport)}(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,o=e.clientHeight;return sn(r.left,r.top,n,o)}),(function(e){return sn(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},dn=function(e){return function(t){return!!t&&t.nodeType===e}},mn=function(e){return!!e&&!Object.getPrototypeOf(e)},pn=dn(1),gn=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return U(t,n)}return!1}},hn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){var r;if(pn(t))for(r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},vn=function(e){return function(t){return pn(t)&&t.hasAttribute(e)}},bn=function(e){return pn(e)&&e.hasAttribute("data-mce-bogus")},yn=function(e){return pn(e)&&"TABLE"===e.tagName},wn=function(e){return function(t){if(pn(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},Cn=gn(["textarea","input"]),xn=dn(3),kn=dn(8),Sn=dn(9),Tn=dn(11),En=gn(["br"]),_n=gn(["img"]),An=wn("true"),Nn=wn("false"),Rn=gn(["td","th"]),On=gn(["video","audio","object","embed"]),Dn=function(e){return void 0!==e.style&&B(e.style.getPropertyValue)},In=function(e,t,n){if(!(_(n)||O(n)||M(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Pn=function(e,t,n){In(e.dom,t,n)},Bn=function(e,t){var n=e.dom;ce(t,(function(e,t){In(n,t,e)}))},Mn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Ln=function(e,t){return k.from(Mn(e,t))},Fn=function(e,t){e.dom.removeAttribute(t)},jn=function(e,t){var n=e.dom;ce(t,(function(e,t){!function(e,t,n){if(!_(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Dn(e)&&e.style.setProperty(t,n)}(n,t,e)}))},Hn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||tn(e)?r:Un(n,t)},Un=function(e,t){return Dn(e)?e.style.getPropertyValue(t):""},zn=function(e,t){var n=e.dom,r=Un(n,t);return k.from(r).filter((function(e){return e.length>0}))},Wn=function(e){var t={},n=e.dom;if(Dn(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},qn=Qe().browser,Vn=function(e){return G(e,St)},$n=function(e,t){return e.children&&U(e.children,t)},Kn=function(e,t,n){var r,o,i=0,a=0,c=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Hn(pt.fromDom(e),"position"))return{x:i=(o=t.getBoundingClientRect()).left+(c.documentElement.scrollLeft||e.scrollLeft)-c.documentElement.clientLeft,y:a=o.top+(c.documentElement.scrollTop||e.scrollTop)-c.documentElement.clientTop};for(r=t;r&&r!==n&&r.nodeType&&!$n(r,n);)i+=r.offsetLeft||0,a+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!==n&&r.nodeType&&!$n(r,n);)i-=r.scrollLeft||0,a-=r.scrollTop||0,r=r.parentNode;a+=function(e){return qn.isFirefox()&&"table"===Ct(e)?Vn(Mt(e)).filter((function(e){return"caption"===Ct(e)})).bind((function(e){return Vn(Bt(e)).map((function(t){var n=t.dom.offsetTop,r=e.dom.offsetTop,o=e.dom.offsetHeight;return n<=r?-o:0}))})).getOr(0):0}(pt.fromDom(t))}return{x:i,y:a}},Jn={},Gn={exports:Jn};!function(e,n,r,o){!function(o){if("object"==typeof n&&void 0!==r)r.exports=o();else if("function"==typeof e&&e.amd)e([],o);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).EphoxContactWrapper=o()}}((function(){return function e(t,n,r){function i(c,u){if(!n[c]){if(!t[c]){var l="function"==typeof o&&o;if(!u&&l)return l(c,!0);if(a)return a(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[c]={exports:{}};t[c][0].call(f.exports,(function(e){return i(t[c][1][e]||e)}),f,f.exports,e,t,n,r)}return n[c].exports}for(var a="function"==typeof o&&o,c=0;c<r.length;c++)i(r[c]);return i}({1:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var l,s=[],f=!1,d=-1;function m(){f&&l&&(f=!1,l.length?s=l.concat(s):d=-1,s.length&&p())}function p(){if(!f){var e=u(m);f=!0;for(var t=s.length;t;){for(l=s,s=[];++d<t;)l&&l[d].run();d=-1,t=s.length}l=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||f||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){!function(n){var r=setTimeout;function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void u(t.promise,e)}c(t.promise,r)}else(1===e._state?c:u)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void f((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){u(e,t)}var r,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(e){if(n)return;n=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return a(this,new s(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i((function(e,n){if(0===t.length)return e([]);var r=t.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}t[i]=a,0==--r&&e(t)}catch(e){n(e)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},i._immediateFn="function"==typeof e?function(t){e(t)}:function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){var o=e("process/browser.js").nextTick,i=Function.prototype.apply,a=Array.prototype.slice,c={},u=0;function l(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate="function"==typeof t?t:function(e){var t=u++,r=!(arguments.length<2)&&a.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate="function"==typeof r?r:function(e){delete c[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))}(void 0,Jn,Gn,void 0);var Xn=Gn.exports.boltExport,Yn=function(e){var t=k.none(),n=[],r=function(e){o()?a(e):n.push(e)},o=function(){return t.isSome()},i=function(e){q(e,a)},a=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e((function(e){o()||(t=k.some(e),i(n),n=[])})),{get:r,map:function(e){return Yn((function(t){r((function(n){t(e(n))}))}))},isReady:o}},Qn={nu:Yn,pure:function(e){return Yn((function(t){t(e)}))}},Zn=function(e){setTimeout((function(){throw e}),0)},er=function(e){var t=function(t){e().then(t,Zn)};return{map:function(t){return er((function(){return e().then(t)}))},bind:function(t){return er((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return er((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return Qn.nu(t)},toCached:function(){var t=null;return er((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},tr=function(e){return er((function(){return new Xn(e)}))},nr=function(e,t){return t((function(t){var n=[],r=0;0===e.length?t([]):q(e,(function(o,i){o.get(function(o){return function(i){n[o]=i,++r>=e.length&&t(n)}}(i))}))}))},rr=function(e){return{is:function(t){return e===t},isValue:y,isError:b,getOr:d(e),getOrThunk:d(e),getOrDie:d(e),or:function(t){return rr(e)},orThunk:function(t){return rr(e)},fold:function(t,n){return n(e)},map:function(t){return rr(t(e))},mapError:function(t){return rr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return k.some(e)}}},or=function(e){return{is:b,isValue:b,isError:y,getOr:m,getOrThunk:function(e){return e()},getOrDie:function(){return h(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return or(e)},mapError:function(t){return or(t(e))},each:s,bind:function(t){return or(e)},exists:b,forall:y,toOptional:k.none}},ir={value:rr,error:or,fromOption:function(e,t){return e.fold((function(){return or(t)}),rr)}},ar=function(e){if(!N(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return q(e,(function(r,o){var i=ie(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!N(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var u=function(e){var n=ie(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!Q(t,(function(e){return U(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},cr=(ar([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e){return e.fold(m,m)});function ur(e,t,n,r,o){return e(n,r)?k.some(n):B(o)&&o(n)?k.none():t(n,r,o)}var lr,sr=function(e,t,n){for(var r=e.dom,o=B(n)?n:b;r.parentNode;){r=r.parentNode;var i=pt.fromDom(r);if(t(i))return k.some(i);if(o(i))break}return k.none()},fr=function(e,t,n){return ur((function(e,t){return t(e)}),sr,e,t,n)},dr=function(e,t){return G(e.dom.childNodes,(function(e){return t(pt.fromDom(e))})).map(pt.fromDom)},mr=function(e,t,n){return sr(e,(function(e){return ht(e,t)}),n)},pr=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return vt(n)?k.none():k.from(n.querySelector(e)).map(pt.fromDom)}(t,e)},gr=function(e,t,n){return ur((function(e,t){return ht(e,t)}),mr,e,t,n)},hr=window.Promise?window.Promise:function(){function e(e,t){return function(){e.apply(t,arguments)}}var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],s(t,e(a,this),e(c,this))},o=r.immediateFn||"function"==typeof n&&n||function(e){setTimeout(e,1)};function i(e){var t=this;null!==this._state?o((function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void e.reject(t)}e.resolve(r)}else(t._state?e.resolve:e.reject)(t._value)})):this._deferreds.push(e)}function a(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void s(e(n,t),e(a,this),e(c,this))}this._state=!0,this._value=t,u.call(this)}catch(e){c.call(this,e)}}function c(e){this._state=!1,this._value=e,u.call(this)}function u(){for(var e=0,t=this._deferreds.length;e<t;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function l(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function s(e,t,n){var r=!1;try{e((function(e){r||(r=!0,t(e))}),(function(e){r||(r=!0,n(e))}))}catch(e){if(r)return;r=!0,n(e)}}return r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=this;return new r((function(r,o){i.call(n,new l(e,t,r,o))}))},r.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&t(arguments[0])?arguments[0]:arguments);return new r((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}e[i]=a,0==--r&&t(e)}catch(e){n(e)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r((function(t){t(e)}))},r.reject=function(e){return new r((function(t,n){n(e)}))},r.race=function(e){return new r((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},r}(),vr=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},br=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},yr=function(e,t){var n,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=vr((function(){e.apply(this,r)}),t)};return r.stop=function(){clearTimeout(n)},r},wr={requestAnimationFrame:function(e,t){lr?lr.then(e):lr=new hr((function(e){t||(t=document.body),function(e,t){var n,r=window.requestAnimationFrame,o=["ms","moz","webkit"];for(n=0;n<o.length&&!r;n++)r=window[o[n]+"RequestAnimationFrame"];r||(r=function(e){window.setTimeout(e,0)}),r(e,t)}(e,t)})).then(e)},setTimeout:vr,setInterval:br,setEditorTimeout:function(e,t,n){return vr((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r=br((function(){e.removed?clearInterval(r):t()}),n);return r},debounce:yr,throttle:yr,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}};function Cr(e,t){void 0===t&&(t={});var n=0,r={},o=pt.fromDom(e),i=Nt(o),a=t.maxLoadTime||5e3,c=function(c,u,l){var s,f=dt._addCacheSuffix(c),d=function(e){return ge(r,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))}(f);r[f]=d,d.count++;var m=function(e,t){for(var n=e.length;n--;)e[n]();d.status=t,d.passed=[],d.failed=[],s&&(s.onload=null,s.onerror=null,s=null)},p=function(){return m(d.passed,2)},g=function(){return m(d.failed,3)},h=function(){var t;t=h,function(){for(var t=e.styleSheets,n=t.length;n--;){var r=t[n].ownerNode;if(r&&r.id===s.id)return p(),!0}return!1}()||(Date.now()-y<a?wr.setTimeout(t):g())};if(u&&d.passed.push(u),l&&d.failed.push(l),1!==d.status)if(2!==d.status)if(3!==d.status){d.status=1;var v=pt.fromTag("link",i.dom);Bn(v,{rel:"stylesheet",type:"text/css",id:d.id});var b,y=Date.now();t.contentCssCors&&Pn(v,"crossOrigin","anonymous"),t.referrerPolicy&&Pn(v,"referrerpolicy",t.referrerPolicy),(s=v.dom).onload=h,s.onerror=g,b=v,Xt(qt(o),b),Pn(v,"href",f)}else g();else p()},u=function(e){return tr((function(t){c(e,f(t,d(ir.value(e))),f(t,d(ir.error(e))))}))},l=function(e){var t=dt._addCacheSuffix(e);ge(r,t).each((function(e){var n,i;0===--e.count&&(delete r[t],n=e.id,i=qt(o),pr(i,"#"+n).each(Zt))}))};return{load:c,loadAll:function(e,t,n){var r;(r=W(e,u),nr(r,tr)).get((function(e){var r=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}}(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(cr)):t(r.pass.map(cr))}))},unload:l,unloadAll:function(e){q(e,(function(e){l(e)}))},_setReferrerPolicy:function(e){t.referrerPolicy=e}}}var xr,kr,Sr=function(){var e=new WeakMap;return{forElement:function(t,n){var r=Wt(t).dom;return k.from(e.get(r)).getOrThunk((function(){var t=Cr(r,n);return e.set(r,t),t}))}}}(),Tr=function(){function e(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return e.prototype.current=function(){return this.node},e.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},e.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},e.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},e.prototype.findSibling=function(e,t,n,r){var o,i;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(o=e[n])return o;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(o=i[n])return o}}},e.prototype.findPreviousNode=function(e,t,n,r){var o,i,a;if(e){if(o=e[n],this.rootNode&&o===this.rootNode)return;if(o){if(!r)for(a=o[t];a;a=a[t])if(!a[t])return a;return o}if((i=e.parentNode)&&i!==this.rootNode)return i}},e}(),Er=function(e){var t;return function(n){return(t=t||function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,y)).hasOwnProperty(Ct(n))}},_r=Er(["h1","h2","h3","h4","h5","h6"]),Ar=Er(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Nr=function(e){return St(e)&&!Ar(e)},Rr=function(e){return St(e)&&"br"===Ct(e)},Or=Er(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Dr=Er(["ul","ol","dl"]),Ir=Er(["li","dd","dt"]),Pr=Er(["thead","tbody","tfoot"]),Br=Er(["td","th"]),Mr=Er(["pre","script","textarea","style"]),Lr=function(e){return"\ufeff"===e},Fr=function(e){return e.replace(/\uFEFF/g,"")},jr=pn,Hr=xn,Ur=function(e){return Hr(e)&&(e=e.parentNode),jr(e)&&e.hasAttribute("data-mce-caret")},zr=function(e){return Hr(e)&&Lr(e.data)},Wr=function(e){return Ur(e)||zr(e)},qr=function(e){return e.firstChild!==e.lastChild||!En(e.firstChild)},Vr=function(e){var t=e.container();return!!xn(t)&&("\ufeff"===t.data.charAt(e.offset())||e.isAtStart()&&zr(t.previousSibling))},$r=function(e){var t=e.container();return!!xn(t)&&("\ufeff"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&zr(t.nextSibling))},Kr=function(e,t,n){var r,o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var i=t.parentNode;return n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o),o},Jr=function(e){return Hr(e)&&"\ufeff"===e.data[0]},Gr=function(e){return Hr(e)&&"\ufeff"===e.data[e.data.length-1]},Xr=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),n=t[t.length-1],bn(n)&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},Yr=An,Qr=Nn,Zr=En,eo=xn,to=gn(["script","style","textarea"]),no=gn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),ro=gn(["table"]),oo=Wr,io=function(e){return!oo(e)&&(eo(e)?!to(e.parentNode):no(e)||Zr(e)||ro(e)||ao(e))},ao=function(e){return!1===function(e){return pn(e)&&"true"===e.getAttribute("unselectable")}(e)&&Qr(e)},co=function(e,t){return io(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(ao(e))return!1;if(Yr(e))return!0}return!0}(e,t)},uo=/^[ \t\r\n]*$/,lo=function(e){return uo.test(e)},so=function(e,t){var n,r,o,i=pt.fromDom(t),a=pt.fromDom(e);return n=a,r="pre,code",o=p(bt,i),mr(n,r,o).isSome()},fo=function(e,t){return io(e)&&!1===function(e,t){return xn(e)&&lo(e.data)&&!1===so(e,t)}(e,t)||function(e){return pn(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))}(e)||mo(e)},mo=vn("data-mce-bookmark"),po=vn("data-mce-bogus"),go=(xr="data-mce-bogus",kr="all",function(e){return pn(e)&&e.getAttribute(xr)===kr}),ho=function(e,t){return void 0===t&&(t=!0),function(e,t){var n,r=0;if(fo(e,e))return!1;if(!(n=e.firstChild))return!0;var o=new Tr(n,e);do{if(t){if(go(n)){n=o.next(!0);continue}if(po(n)){n=o.next();continue}}if(En(n))r++,n=o.next();else{if(fo(n,e))return!1;n=o.next()}}while(n);return r<=1}(e.dom,t)},vo=function(e,t){return P(e)&&(fo(e,t)||Nr(pt.fromDom(e)))},bo=function(e){return function(e){return"span"===e.nodeName.toLowerCase()}(e)&&"bookmark"===e.getAttribute("data-mce-type")},yo=function(e,t){return xn(e)&&e.data.length>0&&function(e,t){var n=new Tr(e,t).prev(!1),r=new Tr(e,t).next(!1),o=D(n)||vo(n,t),i=D(r)||vo(r,t);return o&&i}(e,t)},wo=function(e,t,n){var r=n||t;if(pn(t)&&bo(t))return t;for(var o=t.childNodes,i=o.length-1;i>=0;i--)wo(e,o[i],r);if(pn(t)){var a=t.childNodes;1===a.length&&bo(a[0])&&t.parentNode.insertBefore(a[0],t)}return function(e){return Tn(e)||Sn(e)}(t)||fo(t,r)||function(e){return!!pn(e)&&e.childNodes.length>0}(t)||yo(t,r)||e.remove(t),t},Co=dt.makeMap,xo=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ko=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,So=/[<>&\"\']/g,To=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Eo={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},_o={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Ao={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},No=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),_o[r]||(o="&"+e[n+1]+";",i[r]=o,i[o]=r);return i}},Ro=No("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Oo=function(e,t){return e.replace(t?xo:ko,(function(e){return _o[e]||e}))},Do=function(e,t){return e.replace(t?xo:ko,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":_o[e]||"&#"+e.charCodeAt(0)+";"}))},Io=function(e,t,n){return n=n||Ro,e.replace(t?xo:ko,(function(e){return _o[e]||n[e]||e}))},Po={encodeRaw:Oo,encodeAllRaw:function(e){return(""+e).replace(So,(function(e){return _o[e]||e}))},encodeNumeric:Do,encodeNamed:Io,getEncodeFunc:function(e,t){var n=No(t)||Ro,r=Co(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?xo:ko,(function(e){return void 0!==_o[e]?_o[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:r.named?t?function(e,t){return Io(e,t,n)}:Io:r.numeric?Do:Oo},decode:function(e){return e.replace(To,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Eo[t]||String.fromCharCode(t):Ao[e]||Ro[e]||function(e){var t=pt.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e}(e)}))}},Bo={},Mo={},Lo=dt.makeMap,Fo=dt.each,jo=dt.extend,Ho=dt.explode,Uo=dt.inArray,zo=function(e,t){return(e=dt.trim(e))?e.split(t||" "):[]},Wo=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),Fo(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?Lo(e,/[, ]/):Ho(e,/[, ]/)}))),n};function qo(e){var t={},n={},r=[],o={},i={},a=function(t,n,r){var o=e[t];return o?o=Lo(o,/[, ]/,Lo(o.toUpperCase(),/[, ]/)):(o=Bo[t])||(o=Lo(n," ",Lo(n.toUpperCase()," ")),o=jo(o,r),Bo[t]=o),o},c=function(e){var t,n,r,o,i,a,c={},u=function(e,n,r){var o,i,a,u=function(e,t){var n,r,o={};for(n=0,r=e.length;n<r;n++)o[e[n]]=t||{};return o};n=n||"","string"==typeof(r=r||[])&&(r=zo(r));var l=zo(e);for(o=l.length;o--;)a={attributes:u(i=zo([t,n].join(" "))),attributesOrder:i,children:u(r,Mo)},c[l[o]]=a},l=function(e,t){var n,r,o,i,a=zo(e);n=a.length;for(var u=zo(t);n--;)for(r=c[a[n]],o=0,i=u.length;o<i;o++)r.attributes[u[o]]={},r.attributesOrder.push(u[o])};return Bo[e]?Bo[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",r=[r,a="acronym applet basefont big font strike tt"].join(" "),Fo(zo(a),(function(e){u(e,"",r)})),n=[n,i="center dir isindex noframes"].join(" "),o=[n,r].join(" "),Fo(zo(i),(function(e){u(e,"",o)}))),o=o||[n,r].join(" "),u("html","manifest","head body"),u("head","","base command link meta noscript script style title"),u("title hr noscript br"),u("base","href target"),u("link","href rel media hreflang type sizes hreflang"),u("meta","name http-equiv content charset"),u("style","media type scoped"),u("script","src async defer type charset"),u("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),u("address dt dd div caption","",o),u("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),u("blockquote","cite",o),u("ol","reversed start type","li"),u("ul","","li"),u("li","value",o),u("dl","","dt dd"),u("a","href target rel media hreflang type",r),u("q","cite",r),u("ins del","cite datetime",o),u("img","src sizes srcset alt usemap ismap width height"),u("iframe","src name width height",o),u("embed","src type width height"),u("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),u("param","name value"),u("map","name",[o,"area"].join(" ")),u("area","alt coords shape href target rel media hreflang type"),u("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),u("colgroup","span","col"),u("col","span"),u("tbody thead tfoot","","tr"),u("tr","","td th"),u("td","colspan rowspan headers",o),u("th","colspan rowspan headers scope abbr",o),u("form","accept-charset action autocomplete enctype method name novalidate target",o),u("fieldset","disabled form name",[o,"legend"].join(" ")),u("label","form for",r),u("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),u("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:r),u("select","disabled form multiple name required size","option optgroup"),u("optgroup","disabled label","option"),u("option","disabled label selected value"),u("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),u("menu","type label",[o,"li"].join(" ")),u("noscript","",o),"html4"!==e&&(u("wbr"),u("ruby","",[r,"rt rp"].join(" ")),u("figcaption","",o),u("mark rt rp summary bdi","",r),u("canvas","width height",o),u("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),u("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),u("picture","","img source"),u("source","src srcset type media sizes"),u("track","kind src srclang label default"),u("datalist","",[r,"option"].join(" ")),u("article section nav aside main header footer","",o),u("hgroup","","h1 h2 h3 h4 h5 h6"),u("figure","",[o,"figcaption"].join(" ")),u("time","datetime",r),u("dialog","open",o),u("command","type label icon disabled checked radiogroup command"),u("output","for form name",r),u("progress","value max",r),u("meter","value min max low high optimum",r),u("details","open",[o,"summary"].join(" ")),u("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==e&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("img","loading"),l("iframe","sandbox seamless allowfullscreen loading")),Fo(zo("a form meter progress dfn"),(function(e){c[e]&&delete c[e].children[e]})),delete c.caption.children.table,delete c.script,Bo[e]=c,c)}((e=e||{}).schema);!1===e.verify_html&&(e.valid_elements="*[*]");var u=Wo(e.valid_styles),l=Wo(e.invalid_styles,"map"),s=Wo(e.valid_classes,"map"),f=a("whitespace_elements","pre script noscript style textarea video audio iframe object code"),d=a("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=a("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),p=a("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),g=a("non_empty_elements","td th iframe video audio object script code pre",m),h=a("move_caret_before_on_enter_elements","td th iframe video audio object script code table",m),v=a("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),b=a("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),y=a("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");Fo((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){i[e]=new RegExp("</"+e+"[^>]*>","gi")}));var w=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},C=function(e){var n,o,i,a,c,u,l,s,f,d,m,p,g,h,v,b,y,C,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,k=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,S=/[*?+]/;if(e){var T=zo(e,",");for(t["@"]&&(b=t["@"].attributes,y=t["@"].attributesOrder),n=0,o=T.length;n<o;n++)if(c=x.exec(T[n])){if(h=c[1],f=c[2],v=c[3],s=c[5],u={attributes:p={},attributesOrder:g=[]},"#"===h&&(u.paddEmpty=!0),"-"===h&&(u.removeEmpty=!0),"!"===c[4]&&(u.removeEmptyAttrs=!0),b&&(ce(b,(function(e,t){p[t]=e})),g.push.apply(g,y)),s)for(i=0,a=(s=zo(s,"|")).length;i<a;i++)if(c=k.exec(s[i])){if(l={},m=c[1],d=c[2].replace(/[\\:]:/g,":"),h=c[3],C=c[4],"!"===m&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(d),l.required=!0),"-"===m){delete p[d],g.splice(Uo(g,d),1);continue}h&&("="===h&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:d,value:C}),l.defaultValue=C),":"===h&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:d,value:C}),l.forcedValue=C),"<"===h&&(l.validValues=Lo(C,"?"))),S.test(d)?(u.attributePatterns=u.attributePatterns||[],l.pattern=w(d),u.attributePatterns.push(l)):(p[d]||g.push(d),p[d]=l)}b||"@"!==f||(b=p,y=g),v&&(u.outputName=f,t[v]=u),S.test(f)?(u.pattern=w(f),r.push(u)):t[f]=u}}},x=function(e){t={},r=[],C(e),Fo(c,(function(e,t){n[t]=e.children}))},k=function(e){var r=/^(~)?(.+)$/;e&&(Bo.text_block_elements=Bo.block_elements=null,Fo(zo(e,","),(function(e){var i=r.exec(e),a="~"===i[1],c=a?"span":"div",u=i[2];if(n[u]=n[c],o[u]=c,a||(b[u.toUpperCase()]={},b[u]={}),!t[u]){var l=t[c];delete(l=jo({},l)).removeEmptyAttrs,delete l.removeEmpty,t[u]=l}Fo(n,(function(e,t){e[c]&&(n[t]=e=jo({},n[t]),e[u]=e[c])}))})))},S=function(t){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Bo[e.schema]=null,t&&Fo(zo(t,","),(function(e){var t,o,i=r.exec(e);i&&(o=i[1],t=o?n[i[2]]:n[i[2]]={"#comment":{}},t=n[i[2]],Fo(zo(i[3],"|"),(function(e){"-"===o?delete t[e]:t[e]={}})))}))},T=function(e){var n,o=t[e];if(o)return o;for(n=r.length;n--;)if((o=r[n]).pattern.test(e))return o};e.valid_elements?x(e.valid_elements):(Fo(c,(function(e,r){t[r]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[r]=e.children})),"html5"!==e.schema&&Fo(zo("strong/b em/i"),(function(e){var n=zo(e,"/");t[n[1]].outputName=n[0]})),Fo(zo("ol ul sub sup blockquote span font a table tbody strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),Fo(zo("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),Fo(zo("span"),(function(e){t[e].removeEmptyAttrs=!0}))),k(e.custom_elements),S(e.valid_children),C(e.extended_valid_elements),S("+ol[ul|ol],+ul[ul|ol]"),Fo({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=zo(e))})),e.invalid_elements&&Fo(Ho(e.invalid_elements),(function(e){t[e]&&delete t[e]})),T("span")||C("span[!data-mce-type|*]");return{children:n,elements:t,getValidStyles:function(){return u},getValidClasses:function(){return s},getBlockElements:function(){return b},getInvalidStyles:function(){return l},getShortEndedElements:function(){return m},getTextBlockElements:function(){return v},getTextInlineElements:function(){return y},getBoolAttrs:function(){return p},getElementRule:T,getSelfClosingElements:function(){return d},getNonEmptyElements:function(){return g},getMoveCaretBeforeOnEnterElements:function(){return h},getWhiteSpaceElements:function(){return f},getSpecialElements:function(){return i},isValidChild:function(e,t){var r=n[e.toLowerCase()];return!(!r||!r[t.toLowerCase()])},isValid:function(e,t){var n,r,o=T(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:function(){return o},addValidElements:C,setValidElements:x,addCustomElements:k,addValidChildren:S}}var Vo,$o,Ko,Jo,Go,Xo,Yo,Qo,Zo,ei,ti,ni,ri,oi,ii,ai,ci,ui=function(e,t,n,r){var o=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+o(t)+o(n)+o(r)},li=function(e,t){var n,r,o,i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,c=/\s*([^:]+):\s*([^;]+);?/g,u=/\s+$/,l={};e=e||{},t&&(r=t.getValidStyles(),o=t.getInvalidStyles());var s="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(n=0;n<s.length;n++)l[s[n]]="\ufeff"+n,l["\ufeff"+n]=s[n];return{toHex:function(e){return e.replace(i,ui)},parse:function(t){var r,o,s,f,d,m,p,g,h={},v=e.url_converter,b=e.url_converter_scope||this,y=function(e,t,r){var o=h[e+"-top"+t];if(o){var i=h[e+"-right"+t];if(i){var a=h[e+"-bottom"+t];if(a){var c=h[e+"-left"+t];if(c){var u=[o,i,a,c];for(n=u.length-1;n--&&u[n]===u[n+1];);n>-1&&r||(h[e+t]=-1===n?u[0]:u.join(" "),delete h[e+"-top"+t],delete h[e+"-right"+t],delete h[e+"-bottom"+t],delete h[e+"-left"+t])}}}}},w=function(e){var t,n=h[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return h[e]=n[0],!0}},C=function(e){return f=!0,l[e]},x=function(e,t){return f&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return l[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},k=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},S=function(e){return e.replace(/\\[0-9a-f]+/gi,k)},T=function(t,n,r,o,i,a){if(i=i||a)return"'"+(i=x(i)).replace(/\'/g,"\\'")+"'";if(n=x(n||r||o),!e.allow_script_urls){var c=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(c))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(c))return""}return v&&(n=v.call(b,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,C).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,C)}));r=c.exec(t);)if(c.lastIndex=r.index+r[0].length,o=r[1].replace(u,"").toLowerCase(),s=r[2].replace(u,""),o&&s){if(o=S(o),s=S(s),-1!==o.indexOf("\ufeff")||-1!==o.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===o||/expression\s*\(|\/\*|\*\//.test(s)))continue;"font-weight"===o&&"700"===s?s="bold":"color"!==o&&"background-color"!==o||(s=s.toLowerCase()),s=(s=s.replace(i,ui)).replace(a,T),h[o]=f?x(s,!0):s}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),d="border",p="border-style",g="border-color",w(m="border-width")&&w(p)&&w(g)&&(h[d]=h[m]+" "+h[p]+" "+h[g],delete h[m],delete h[p],delete h[g]),"medium none"===h.border&&delete h.border,"none"===h["border-image"]&&delete h["border-image"]}return h},serialize:function(e,t){var n="",i=function(t){var o,i=r[t];if(i)for(var a=0,c=i.length;a<c;a++)t=i[a],(o=e[t])&&(n+=(n.length>0?" ":"")+t+": "+o+";")};return t&&r?(i("*"),i(t)):ce(e,(function(e,r){!e||o&&!function(e,t){var n=o["*"];return(!n||!n[e])&&!((n=o[t])&&n[e])}(r,t)||(n+=(n.length>0?" ":"")+r+": "+e+";")})),n}}},si=/^(?:mouse|contextmenu)|click/,fi={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},di=function(){return!1},mi=function(){return!0},pi=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},gi=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},hi=function(e,t){var n,r=t||{};for(n in e)fi[n]||(r[n]=e[n]);if(r.target||(r.target=r.srcElement||document),r.composedPath&&(r.composedPath=function(){return e.composedPath()}),e&&function(e){return si.test(e.type)}(e)&&void 0===e.pageX&&void 0!==e.clientX){var o=r.target.ownerDocument||document,i=o.documentElement,a=o.body;r.pageX=e.clientX+(i&&i.scrollLeft||a&&a.scrollLeft||0)-(i&&i.clientLeft||a&&a.clientLeft||0),r.pageY=e.clientY+(i&&i.scrollTop||a&&a.scrollTop||0)-(i&&i.clientTop||a&&a.clientTop||0)}return r.preventDefault=function(){r.isDefaultPrevented=mi,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},r.stopPropagation=function(){r.isPropagationStopped=mi,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=mi,r.stopPropagation()},!1===function(e){return e.isDefaultPrevented===mi||e.isDefaultPrevented===di}(r)&&(r.isDefaultPrevented=di,r.isPropagationStopped=di,r.isImmediatePropagationStopped=di),void 0===r.metaKey&&(r.metaKey=!1),r},vi=function(e,t,n){var r=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var i=function(){gi(e,"DOMContentLoaded",i),gi(e,"load",i),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};"complete"===r.readyState||"interactive"===r.readyState&&r.body?i():pi(e,"DOMContentLoaded",i),n.domLoaded||pi(e,"load",i)}},bi=function(){function e(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}return e.prototype.bind=function(e,t,n,r){var o,i,a,c,u,l,s,f=this,d=window,m=function(e){f.executeHandlers(hi(e||d.event),o)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[f.expando]?o=e[f.expando]:(o=f.count++,e[f.expando]=o,f.events[o]={}),r=r||e;var p=t.split(" ");for(a=p.length;a--;)l=m,u=s=!1,"DOMContentLoaded"===(c=p[a])&&(c="ready"),f.domLoaded&&"ready"===c&&"complete"===e.readyState?n.call(r,hi({type:c})):(f.hasMouseEnterLeave||(u=f.mouseEnterLeave[c])&&(l=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=hi(e||d.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,f.executeHandlers(e,o))}),f.hasFocusIn||"focusin"!==c&&"focusout"!==c||(s=!0,u="focusin"===c?"focus":"blur",l=function(e){(e=hi(e||d.event)).type="focus"===e.type?"focusin":"focusout",f.executeHandlers(e,o)}),(i=f.events[o][c])?"ready"===c&&f.domLoaded?n(hi({type:c})):i.push({func:n,scope:r}):(f.events[o][c]=i=[{func:n,scope:r}],i.fakeName=u,i.capture=s,i.nativeHandler=l,"ready"===c?vi(e,l,f):pi(e,u||c,l,s)));return e=i=null,n}},e.prototype.unbind=function(e,t,n){var r,o,i,a,c;if(!e||3===e.nodeType||8===e.nodeType)return this;var u=e[this.expando];if(u){if(c=this.events[u],t){var l=t.split(" ");for(o=l.length;o--;)if(r=c[a=l[o]]){if(n)for(i=r.length;i--;)if(r[i].func===n){var s=r.nativeHandler,f=r.fakeName,d=r.capture;(r=r.slice(0,i).concat(r.slice(i+1))).nativeHandler=s,r.fakeName=f,r.capture=d,c[a]=r}n&&0!==r.length||(delete c[a],gi(e,r.fakeName||a,r.nativeHandler,r.capture))}}else ce(c,(function(t,n){gi(e,t.fakeName||n,t.nativeHandler,t.capture)})),c={};for(a in c)if(he(c,a))return this;delete this.events[u];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this},e.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var o=hi(null,n);o.type=t,o.target=e;do{(r=e[this.expando])&&this.executeHandlers(o,r),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!o.isPropagationStopped());return this},e.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},e.prototype.destroy=function(){this.events={}},e.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},e.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a&&!1===a.func.call(a.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},e.Event=new e,e}(),yi="sizzle"+-new Date,wi=window.document,Ci=0,xi=0,ki=ea(),Si=ea(),Ti=ea(),Ei=function(e,t){return e===t&&(ei=!0),0},_i={}.hasOwnProperty,Ai=[],Ni=Ai.pop,Ri=Ai.push,Oi=Ai.push,Di=Ai.slice,Ii=Ai.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Pi="[\\x20\\t\\r\\n\\f]",Bi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Mi="\\["+Pi+"*("+Bi+")(?:"+Pi+"*([*^$|!~]?=)"+Pi+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Bi+"))|)"+Pi+"*\\]",Li=":("+Bi+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Mi+")*)|.*)\\)|)",Fi=new RegExp("^"+Pi+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Pi+"+$","g"),ji=new RegExp("^"+Pi+"*,"+Pi+"*"),Hi=new RegExp("^"+Pi+"*([>+~]|"+Pi+")"+Pi+"*"),Ui=new RegExp("="+Pi+"*([^\\]'\"]*?)"+Pi+"*\\]","g"),zi=new RegExp(Li),Wi=new RegExp("^"+Bi+"$"),qi={ID:new RegExp("^#("+Bi+")"),CLASS:new RegExp("^\\.("+Bi+")"),TAG:new RegExp("^("+Bi+"|[*])"),ATTR:new RegExp("^"+Mi),PSEUDO:new RegExp("^"+Li),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Pi+"*(even|odd|(([+-]|)(\\d*)n|)"+Pi+"*(?:([+-]|)"+Pi+"*(\\d+)|))"+Pi+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Pi+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Pi+"*((?:-\\d)?\\d*)"+Pi+"*\\)|)(?=[^-]|$)","i")},Vi=/^(?:input|select|textarea|button)$/i,$i=/^h\d$/i,Ki=/^[^{]+\{\s*\[native \w/,Ji=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Gi=/[+~]/,Xi=/'|\\/g,Yi=new RegExp("\\\\([\\da-f]{1,6}"+Pi+"?|("+Pi+")|.)","ig"),Qi=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{Oi.apply(Ai=Di.call(wi.childNodes),wi.childNodes),Ai[wi.childNodes.length].nodeType}catch(e){Oi={apply:Ai.length?function(e,t){Ri.apply(e,Di.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var Zi=function(e,t,n,r){var o,i,a,c,u,l,s,f,d,m;if((t?t.ownerDocument||t:wi)!==ni&&ti(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(c=(t=t||ni).nodeType)&&9!==c)return[];if(oi&&!r){if(o=Ji.exec(e))if(a=o[1]){if(9===c){if(!(i=t.getElementById(a))||!i.parentNode)return n;if(i.id===a)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(a))&&ci(t,i)&&i.id===a)return n.push(i),n}else{if(o[2])return Oi.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&Vo.getElementsByClassName)return Oi.apply(n,t.getElementsByClassName(a)),n}if(Vo.qsa&&(!ii||!ii.test(e))){if(f=s=yi,d=t,m=9===c&&e,1===c&&"object"!==t.nodeName.toLowerCase()){for(l=Go(e),(s=t.getAttribute("id"))?f=s.replace(Xi,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",u=l.length;u--;)l[u]=f+aa(l[u]);d=Gi.test(e)&&oa(t.parentNode)||t,m=l.join(",")}if(m)try{return Oi.apply(n,d.querySelectorAll(m)),n}catch(e){}finally{s||t.removeAttribute("id")}}}return Yo(e.replace(Fi,"$1"),t,n,r)};function ea(){var e=[];return function t(n,r){return e.push(n+" ")>$o.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function ta(e){return e[yi]=!0,e}function na(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ra(e){return ta((function(t){return t=+t,ta((function(n,r){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(r[o]=n[o]))}))}))}function oa(e){return e&&void 0!==e.getElementsByTagName&&e}function ia(){}function aa(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ca(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=xi++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,a){var c,u,l=[Ci,i];if(a){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((c=(u=t[yi]||(t[yi]={}))[r])&&c[0]===Ci&&c[1]===i)return l[2]=c[2];if(u[r]=l,l[2]=e(t,n,a))return!0}}}function ua(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function la(e,t,n,r,o){for(var i,a=[],c=0,u=e.length,l=null!=t;c<u;c++)(i=e[c])&&(n&&!n(i,r,o)||(a.push(i),l&&t.push(c)));return a}function sa(e,t,n,r,o,i){return r&&!r[yi]&&(r=sa(r)),o&&!o[yi]&&(o=sa(o,i)),ta((function(i,a,c,u){var l,s,f,d=[],m=[],p=a.length,g=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)Zi(e,t[r],n);return n}(t||"*",c.nodeType?[c]:c,[]),h=!e||!i&&t?g:la(g,d,e,c,u),v=n?o||(i?e:p||r)?[]:a:h;if(n&&n(h,v,c,u),r)for(l=la(v,m),r(l,[],c,u),s=l.length;s--;)(f=l[s])&&(v[m[s]]=!(h[m[s]]=f));if(i){if(o||e){if(o){for(l=[],s=v.length;s--;)(f=v[s])&&l.push(h[s]=f);o(null,v=[],l,u)}for(s=v.length;s--;)(f=v[s])&&(l=o?Ii.call(i,f):d[s])>-1&&(i[l]=!(a[l]=f))}}else v=la(v===a?v.splice(p,v.length):v),o?o(null,a,v,u):Oi.apply(a,v)}))}function fa(e){for(var t,n,r,o=e.length,i=$o.relative[e[0].type],a=i||$o.relative[" "],c=i?1:0,u=ca((function(e){return e===t}),a,!0),l=ca((function(e){return Ii.call(t,e)>-1}),a,!0),s=[function(e,n,r){return!i&&(r||n!==Qo)||((t=n).nodeType?u(e,n,r):l(e,n,r))}];c<o;c++)if(n=$o.relative[e[c].type])s=[ca(ua(s),n)];else{if((n=$o.filter[e[c].type].apply(null,e[c].matches))[yi]){for(r=++c;r<o&&!$o.relative[e[r].type];r++);return sa(c>1&&ua(s),c>1&&aa(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(Fi,"$1"),n,c<r&&fa(e.slice(c,r)),r<o&&fa(e=e.slice(r)),r<o&&aa(e))}s.push(n)}return ua(s)}Vo=Zi.support={},Jo=Zi.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},ti=Zi.setDocument=function(e){var t,n=e?e.ownerDocument||e:wi,r=n.defaultView;return n!==ni&&9===n.nodeType&&n.documentElement?(ni=n,ri=n.documentElement,oi=!Jo(n),r&&r!==function(e){try{return e.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",(function(){ti()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){ti()}))),Vo.attributes=!0,Vo.getElementsByTagName=!0,Vo.getElementsByClassName=Ki.test(n.getElementsByClassName),Vo.getById=!0,$o.find.ID=function(e,t){if(void 0!==t.getElementById&&oi){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},$o.filter.ID=function(e){var t=e.replace(Yi,Qi);return function(e){return e.getAttribute("id")===t}},$o.find.TAG=Vo.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},$o.find.CLASS=Vo.getElementsByClassName&&function(e,t){if(oi)return t.getElementsByClassName(e)},ai=[],ii=[],Vo.disconnectedMatch=!0,ii=ii.length&&new RegExp(ii.join("|")),ai=ai.length&&new RegExp(ai.join("|")),t=Ki.test(ri.compareDocumentPosition),ci=t||Ki.test(ri.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Ei=t?function(e,t){if(e===t)return ei=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!Vo.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===wi&&ci(wi,e)?-1:t===n||t.ownerDocument===wi&&ci(wi,t)?1:Zo?Ii.call(Zo,e)-Ii.call(Zo,t):0:4&r?-1:1)}:function(e,t){if(e===t)return ei=!0,0;var r,o=0,i=e.parentNode,a=t.parentNode,c=[e],u=[t];if(!i||!a)return e===n?-1:t===n?1:i?-1:a?1:Zo?Ii.call(Zo,e)-Ii.call(Zo,t):0;if(i===a)return na(e,t);for(r=e;r=r.parentNode;)c.unshift(r);for(r=t;r=r.parentNode;)u.unshift(r);for(;c[o]===u[o];)o++;return o?na(c[o],u[o]):c[o]===wi?-1:u[o]===wi?1:0},n):ni},Zi.matches=function(e,t){return Zi(e,null,null,t)},Zi.matchesSelector=function(e,t){if((e.ownerDocument||e)!==ni&&ti(e),t=t.replace(Ui,"='$1']"),Vo.matchesSelector&&oi&&(!ai||!ai.test(t))&&(!ii||!ii.test(t)))try{var n=(void 0).call(e,t);if(n||Vo.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return Zi(t,ni,null,[e]).length>0},Zi.contains=function(e,t){return(e.ownerDocument||e)!==ni&&ti(e),ci(e,t)},Zi.attr=function(e,t){(e.ownerDocument||e)!==ni&&ti(e);var n=$o.attrHandle[t.toLowerCase()],r=n&&_i.call($o.attrHandle,t.toLowerCase())?n(e,t,!oi):void 0;return void 0!==r?r:Vo.attributes||!oi?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},Zi.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},Zi.uniqueSort=function(e){var t,n=[],r=0,o=0;if(ei=!Vo.detectDuplicates,Zo=!Vo.sortStable&&e.slice(0),e.sort(Ei),ei){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return Zo=null,e},Ko=Zi.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Ko(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=Ko(t);return n},($o=Zi.selectors={cacheLength:50,createPseudo:ta,match:qi,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Yi,Qi),e[3]=(e[3]||e[4]||e[5]||"").replace(Yi,Qi),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Zi.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Zi.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return qi.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&zi.test(n)&&(t=Go(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Yi,Qi).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=ki[e+" "];return t||(t=new RegExp("(^|"+Pi+")"+e+"("+Pi+"|$)"))&&ki(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var o=Zi.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),c="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,u){var l,s,f,d,m,p,g=i!==a?"nextSibling":"previousSibling",h=t.parentNode,v=c&&t.nodeName.toLowerCase(),b=!u&&!c;if(h){if(i){for(;g;){for(f=t;f=f[g];)if(c?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?h.firstChild:h.lastChild],a&&b){for(m=(l=(s=h[yi]||(h[yi]={}))[e]||[])[0]===Ci&&l[1],d=l[0]===Ci&&l[2],f=m&&h.childNodes[m];f=++m&&f&&f[g]||(d=m=0)||p.pop();)if(1===f.nodeType&&++d&&f===t){s[e]=[Ci,m,d];break}}else if(b&&(l=(t[yi]||(t[yi]={}))[e])&&l[0]===Ci)d=l[1];else for(;(f=++m&&f&&f[g]||(d=m=0)||p.pop())&&((c?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++d||(b&&((f[yi]||(f[yi]={}))[e]=[Ci,d]),f!==t)););return(d-=o)===r||d%r==0&&d/r>=0}}},PSEUDO:function(e,t){var n,r=$o.pseudos[e]||$o.setFilters[e.toLowerCase()]||Zi.error("unsupported pseudo: "+e);return r[yi]?r(t):r.length>1?(n=[e,e,"",t],$o.setFilters.hasOwnProperty(e.toLowerCase())?ta((function(e,n){for(var o,i=r(e,t),a=i.length;a--;)e[o=Ii.call(e,i[a])]=!(n[o]=i[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:ta((function(e){var t=[],n=[],r=Xo(e.replace(Fi,"$1"));return r[yi]?ta((function(e,t,n,o){for(var i,a=r(e,null,o,[]),c=e.length;c--;)(i=a[c])&&(e[c]=!(t[c]=i))})):function(e,o,i){return t[0]=e,r(t,null,i,n),!n.pop()}})),has:ta((function(e){return function(t){return Zi(e,t).length>0}})),contains:ta((function(e){return e=e.replace(Yi,Qi),function(t){return(t.textContent||t.innerText||Ko(t)).indexOf(e)>-1}})),lang:ta((function(e){return Wi.test(e||"")||Zi.error("unsupported lang: "+e),e=e.replace(Yi,Qi).toLowerCase(),function(t){var n;do{if(n=oi?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===ri},focus:function(e){return e===ni.activeElement&&(!ni.hasFocus||ni.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!$o.pseudos.empty(e)},header:function(e){return $i.test(e.nodeName)},input:function(e){return Vi.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ra((function(){return[0]})),last:ra((function(e,t){return[t-1]})),eq:ra((function(e,t,n){return[n<0?n+t:n]})),even:ra((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ra((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ra((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:ra((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=$o.pseudos.eq,q(["radio","checkbox","file","password","image"],(function(e){$o.pseudos[e]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(e)})),q(["submit","reset"],(function(e){$o.pseudos[e]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(e)})),ia.prototype=$o.filters=$o.pseudos,$o.setFilters=new ia,Go=Zi.tokenize=function(e,t){var n,r,o,i,a,c,u,l=Si[e+" "];if(l)return t?0:l.slice(0);for(a=e,c=[],u=$o.preFilter;a;){for(i in n&&!(r=ji.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=Hi.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(Fi," ")}),a=a.slice(n.length)),$o.filter)$o.filter.hasOwnProperty(i)&&(!(r=qi[i].exec(a))||u[i]&&!(r=u[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),a=a.slice(n.length)));if(!n)break}return t?a.length:a?Zi.error(e):Si(e,c).slice(0)},Xo=Zi.compile=function(e,t){var n,r=[],o=[],i=Ti[e+" "];if(!i){for(t||(t=Go(e)),n=t.length;n--;)(i=fa(t[n]))[yi]?r.push(i):o.push(i);(i=Ti(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,i,a,c,u){var l,s,f,d=0,m="0",p=o&&[],g=[],h=Qo,v=o||r&&$o.find.TAG("*",u),b=Ci+=null==h?1:Math.random()||.1,y=v.length;for(u&&(Qo=i!==ni&&i);m!==y&&null!=(l=v[m]);m++){if(r&&l){for(s=0;f=e[s++];)if(f(l,i,a)){c.push(l);break}u&&(Ci=b)}n&&((l=!f&&l)&&d--,o&&p.push(l))}if(d+=m,n&&m!==d){for(s=0;f=t[s++];)f(p,g,i,a);if(o){if(d>0)for(;m--;)p[m]||g[m]||(g[m]=Ni.call(c));g=la(g)}Oi.apply(c,g),u&&!o&&g.length>0&&d+t.length>1&&Zi.uniqueSort(c)}return u&&(Ci=b,Qo=h),p};return n?ta(o):o}(o,r))).selector=e}return i},Yo=Zi.select=function(e,t,n,r){var o,i,a,c,u,l="function"==typeof e&&e,s=!r&&Go(e=l.selector||e);if(n=n||[],1===s.length){if((i=s[0]=s[0].slice(0)).length>2&&"ID"===(a=i[0]).type&&Vo.getById&&9===t.nodeType&&oi&&$o.relative[i[1].type]){if(!(t=($o.find.ID(a.matches[0].replace(Yi,Qi),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=qi.needsContext.test(e)?0:i.length;o--&&(a=i[o],!$o.relative[c=a.type]);)if((u=$o.find[c])&&(r=u(a.matches[0].replace(Yi,Qi),Gi.test(i[0].type)&&oa(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&aa(i)))return Oi.apply(n,r),n;break}}return(l||Xo(e,s))(r,t,!oi,n,Gi.test(e)&&oa(t.parentNode)||t),n},Vo.sortStable=yi.split("").sort(Ei).join("")===yi,Vo.detectDuplicates=!!ei,ti(),Vo.sortDetached=!0;var da=document,ma=Array.prototype.push,pa=Array.prototype.slice,ga=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ha=bi.Event,va=dt.makeMap("children,contents,next,prev"),ba=function(e){return void 0!==e},ya=function(e){return"string"==typeof e},wa=function(e,t){var n,r=(t=t||da).createElement("div"),o=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)o.appendChild(n);return o},Ca=function(e,t,n,r){var o;if(ya(t))t=wa(t,Ba(e[0]));else if(t.length&&!t.nodeType){if(t=ja.makeArray(t),r)for(o=t.length-1;o>=0;o--)Ca(e,t[o],n,r);else for(o=0;o<t.length;o++)Ca(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},xa=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},ka=function(e,t,n){var r,o;return t=ja(t)[0],e.each((function(){n&&r===this.parentNode||(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this)),o.appendChild(this)})),e},Sa=dt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Ta=dt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Ea={for:"htmlFor",class:"className",readonly:"readOnly"},_a={float:"cssFloat"},Aa={},Na={},Ra=function(e,t){return new ja.fn.init(e,t)},Oa=/^\s*|\s*$/g,Da=function(e){return null==e?"":(""+e).replace(Oa,"")},Ia=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(i=e[r],!1===t.call(i,r,i)))break}else for(o=0;o<n&&(i=e[o],!1!==t.call(i,o,i));o++);return e},Pa=function(e,t){var n=[];return Ia(e,(function(e,r){t(r,e)&&n.push(r)})),n},Ba=function(e){return e?9===e.nodeType?e:e.ownerDocument:da};Ra.fn=Ra.prototype={constructor:Ra,selector:"",context:null,length:0,init:function(e,t){var n,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(t&&t.nodeType)this.context=t;else{if(t)return ja(e).attr(t);this.context=t=document}if(ya(e)){if(this.selector=e,!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ga.exec(e)))return ja(t).find(e);if(n[1])for(r=wa(e,Ba(t)).firstChild;r;)ma.call(this,r),r=r.nextSibling;else{if(!(r=Ba(t).getElementById(n[2])))return this;if(r.id!==n[2])return this.find(e);this.length=1,this[0]=r}}else this.add(e,!1);return this},toArray:function(){return dt.toArray(this)},add:function(e,t){var n,r;if(ya(e))return this.add(ja(e));if(!1!==t)for(n=ja.unique(this.toArray().concat(ja.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else ma.apply(this,ja.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)Ia(e,(function(e,t){r.attr(e,t)}));else{if(!ba(t)){if(r[0]&&1===r[0].nodeType){if((n=Aa[e])&&n.get)return n.get(r[0],e);if(Ta[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=Aa[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Ea[e]||e))Ia(e,(function(e,t){n.prop(e,t)}));else{if(!ba(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,o=this,i=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},a=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)Ia(e,(function(e,t){o.css(e,t)}));else if(ba(t))e=i(e),"number"!=typeof t||Sa[e]||(t=t.toString()+"px"),o.each((function(){var n=this.style;if((r=Na[e])&&r.set)r.set(this,t);else{try{this.style[_a[e]||e]=t}catch(e){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}}));else{if(n=o[0],(r=Na[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[i(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(e){return}}return o},remove:function(){for(var e,t=this.length;t--;)e=this[t],ha.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(ba(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(n){ja(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(ba(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Ca(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return Ca(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?Ca(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?Ca(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return ja(e).append(this),this},prependTo:function(e){return ja(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return ka(this,e)},wrapAll:function(e){return ka(this,e,!0)},wrapInner:function(e){return this.each((function(){ja(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){ja(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),ja(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?Ia(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var o=xa(r,e);if(o!==t){var i=r.className;o?r.className=Da((" "+i+" ").replace(" "+e+" "," ")):r.className+=i?" "+e:e}}))),n},hasClass:function(e){return xa(this[0],e)},each:function(e){return Ia(this,e)},on:function(e,t){return this.each((function(){ha.bind(this,e,t)}))},off:function(e,t){return this.each((function(){ha.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?ha.fire(this,e.type,e):ha.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new ja(pa.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)ja.find(e,this[t],r);return ja(r)},filter:function(e){return ja("function"==typeof e?Pa(this.toArray(),(function(t,n){return e(n,t)})):ja.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof ja&&(e=e[0]),this.each((function(n,r){for(;r;){if("string"==typeof e&&ja(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),ja(t)},offset:function(e){var t,n,r,o,i=0,a=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:a})},push:ma,sort:Array.prototype.sort,splice:Array.prototype.splice},dt.extend(Ra,{extend:dt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:dt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:dt.isArray,each:Ia,trim:Da,grep:Pa,find:Zi,expr:Zi.selectors,unique:Zi.uniqueSort,text:Zi.getText,contains:Zi.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?ja.find.matchesSelector(t[0],e)?[t[0]]:[]:ja.find.matches(e,t)}});var Ma=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof ja&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&ja(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},La=function(e,t,n,r){var o=[];for(r instanceof ja&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&ja(e).is(r))break}o.push(e)}return o},Fa=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Ia({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Ma(e,"parentNode")},next:function(e){return Fa(e,"nextSibling",1)},prev:function(e){return Fa(e,"previousSibling",1)},children:function(e){return La(e.firstChild,"nextSibling",1)},contents:function(e){return dt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){Ra.fn[e]=function(n){var r=[];this.each((function(){var e=t.call(r,this,n,r);e&&(ja.isArray(e)?r.push.apply(r,e):r.push(e))})),this.length>1&&(va[e]||(r=ja.unique(r)),0===e.indexOf("parents")&&(r=r.reverse()));var o=ja(r);return n?o.filter(n):o}})),Ia({parentsUntil:function(e,t){return Ma(e,"parentNode",t)},nextUntil:function(e,t){return La(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return La(e,"previousSibling",1,t).slice(1)}},(function(e,t){Ra.fn[e]=function(n,r){var o=[];this.each((function(){var e=t.call(o,this,n,o);e&&(ja.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=ja.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var i=ja(o);return r?i.filter(r):i}})),Ra.fn.is=function(e){return!!e&&this.filter(e).length>0},Ra.fn.init.prototype=Ra.fn,Ra.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),o||(o=t.context),new n.fn.init(r,o)};return ja.extend(n,this),n},Ra.attrHooks=Aa,Ra.cssHooks=Na;var ja=Ra,Ha=dt.each,Ua=dt.grep,za=ct.ie,Wa=/^([a-z0-9],?)+$/i,qa=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},Va=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o};function $a(e,t){var n=this;void 0===t&&(t={});var r={},o=window,i={},a=0,c=Sr.forElement(pt.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),u=[],l=t.schema?t.schema:qo({}),f=li({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new bi:bi.Event,m=l.getBlockElements(),p=ja.overrideDefaults((function(){return{context:e,element:W.getRoot()}})),g=function(t){return t&&e&&_(t)?e.getElementById(t):t},h=function(e){return p("string"==typeof e?g(e):e)},v=function(e,t,n){var r,o,i=h(e);return i.length&&(o=(r=V[t])&&r.get?r.get(i,t):i.attr(t)),void 0===o&&(o=n||""),o},b=function(e){var t=g(e);return t?t.attributes:[]},y=function(e,n,r){""===r&&(r=null);var o=h(e),i=o.attr(n);if(o.length){var a=V[n];a&&a.set?a.set(o,r,n):o.attr(n,r),i!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:o,attrName:n,attrValue:r})}},w=function(){return t.root_element||e.body},C=function(t,n){return Kn(e.body,g(t),n)},x=function(e,t,n){var r=h(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=ct.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},k=function(e){var t,n;return e=g(e),t=x(e,"width"),n=x(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},S=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Wa.test(t)){var r=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return Zi(t,i[0].ownerDocument||i[0],null,i).length>0},T=function(e,t,n,r){var o,i=[],a=g(e);for(r=void 0===r,n=n||("BODY"!==w().nodeName?w().parentNode:null),dt.is(t,"string")&&(o=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return S(e,o)});a&&!(a===n||I(a.nodeType)||Sn(a)||Tn(a));){if(!t||"function"==typeof t&&t(a)){if(!r)return[a];i.push(a)}a=a.parentNode}return r?i:null},E=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return S(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},A=function(e,t,r){var o,i="string"==typeof e?g(e):e;if(!i)return!1;if(dt.isArray(i)&&(i.length||0===i.length))return o=[],Ha(i,(function(e,n){e&&o.push(t.call(r,"string"==typeof e?g(e):e,n))})),o;var a=r||n;return t.call(a,i)},N=function(e,t){h(e).each((function(e,n){Ha(t,(function(e,t){y(n,t,e)}))}))},R=function(e,t){var n=h(e);za?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(e){ja("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},O=function(t,n,r,o,i){return A(t,(function(t){var a="string"==typeof n?e.createElement(n):n;return N(a,r),o&&("string"!=typeof o&&o.nodeType?a.appendChild(o):"string"==typeof o&&R(a,o)),i?a:t.appendChild(a)}))},D=function(t,n,r){return O(e.createElement(t),t,n,r,!0)},P=Po.encodeAllRaw,B=function(e,t){var n=h(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},M=function(e,t,n){h(e).toggleClass(t,n).each((function(){""===this.className&&ja(this).attr("class",null)}))},L=function(e,t,n){return A(t,(function(t){return dt.is(t,"array")&&(e=e.cloneNode(!0)),n&&Ha(Ua(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},F=function(e){if(pn(e)){var t="a"===e.nodeName.toLowerCase()&&!v(e,"href")&&v(e,"id");if(v(e,"name")||v(e,"data-mce-bookmark")||t)return!0}return!1},j=function(){return e.createRange()},H=function(n,r,i,a){if(dt.isArray(n)){for(var c=n.length,l=[];c--;)l[c]=H(n[c],r,i,a);return l}return!t.collect||n!==e&&n!==o||u.push([n,r,i,a]),d.bind(n,r,i,a||W)},U=function(t,n,r){if(dt.isArray(t)){for(var i=t.length,a=[];i--;)a[i]=U(t[i],n,r);return a}if(u.length>0&&(t===e||t===o))for(i=u.length;i--;){var c=u[i];t!==c[0]||n&&n!==c[1]||r&&r!==c[2]||d.unbind(c[0],c[1],c[2])}return d.unbind(t,n,r)},z=function(e){if(e&&pn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},W={doc:e,settings:t,win:o,files:i,stdMode:!0,boxModel:!0,styleSheetLoader:c,boundEvents:u,styles:f,schema:l,events:d,isBlock:function(e){if("string"==typeof e)return!!m[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!m[e.nodeName])}return!1},$:p,$$:h,root:null,clone:function(t,n){if(!za||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return Ha(b(t),(function(e){y(r,e.nodeName,v(t,e.nodeName))})),r},getRoot:w,getViewPort:function(e){var t=fn(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=g(e);var t=C(e),n=k(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:k,getParent:function(e,t,n){var r=T(e,t,n,!1);return r&&r.length>0?r[0]:null},getParents:T,get:g,getNext:function(e,t){return E(e,t,"nextSibling")},getPrev:function(e,t){return E(e,t,"previousSibling")},select:function(n,r){return Zi(n,g(r)||t.root_element||e,[])},is:S,add:O,create:D,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)t.hasOwnProperty(r)&&null!==t[r]&&void 0!==t[r]&&(o+=" "+r+'="'+P(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(r),t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o.removeChild(r),o},remove:B,setStyle:function(e,n,r){var o=_(n)?h(e).css(n,r):h(e).css(n);t.update_styles&&qa(f,o)},getStyle:x,setStyles:function(e,n){var r=h(e).css(n);t.update_styles&&qa(f,r)},removeAllAttribs:function(e){return A(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:y,setAttribs:N,getAttrib:v,getPos:C,parseStyle:function(e){return f.parse(e)},serializeStyle:function(e,t){return f.serialize(e,t)},addStyle:function(t){var n,o;if(W!==$a.DOM&&e===document){if(r[t])return;r[t]=!0}(o=e.getElementById("mceDefaultStyles"))||((o=e.createElement("style")).id="mceDefaultStyles",o.type="text/css",(n=e.getElementsByTagName("head")[0]).firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o)),o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))},loadCSS:function(e){e||(e=""),q(e.split(","),(function(e){i[e]=!0,c.load(e,s)}))},addClass:function(e,t){h(e).addClass(t)},removeClass:function(e,t){M(e,t,!1)},hasClass:function(e,t){return h(e).hasClass(t)},toggleClass:M,show:function(e){h(e).show()},hide:function(e){h(e).hide()},isHidden:function(e){return"none"===h(e).css("display")},uniqueId:function(e){return(e||"mce_")+a++},setHTML:R,getOuterHTML:function(e){var t="string"==typeof e?g(e):e;return pn(t)?t.outerHTML:ja("<div></div>").append(ja(t).clone()).html()},setOuterHTML:function(e,t){h(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}B(ja(this).html(t),!0)}))},decode:Po.decode,encode:P,insertAfter:function(e,t){var n=g(t);return A(e,(function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e}))},replace:L,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=D(t),Ha(b(e),(function(t){y(n,t.nodeName,v(e,t.nodeName))})),L(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return f.toHex(dt.trim(e))},run:A,getAttribs:b,isEmpty:function(e,t){var n,r,o=0;if(F(e))return!1;if(e=e.firstChild){var i=new Tr(e,e.parentNode),a=l?l.getWhiteSpaceElements():{};t=t||(l?l.getNonEmptyElements():null);do{if(n=e.nodeType,pn(e)){var c=e.getAttribute("data-mce-bogus");if(c){e=i.next("all"===c);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"===r){o++,e=i.next();continue}return!1}if(F(e))return!1}if(8===n)return!1;if(3===n&&!lo(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&lo(e.nodeValue))return!1;e=i.next()}while(e)}return o<=1},createRng:j,nodeIndex:Va,split:function(e,t,n){var r,o,i,a=j();if(e&&t)return a.setStart(e.parentNode,Va(e)),a.setEnd(t.parentNode,Va(t)),r=a.extractContents(),(a=j()).setStart(t.parentNode,Va(t)+1),a.setEnd(e.parentNode,Va(e)+1),o=a.extractContents(),(i=e.parentNode).insertBefore(wo(W,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(wo(W,o),e),B(e),n||t},bind:H,unbind:U,fire:function(e,t,n){return d.fire(e,t,n)},getContentEditable:z,getContentEditableParent:function(e){for(var t=w(),n=null;e&&e!==t&&null===(n=z(e));e=e.parentNode);return n},destroy:function(){if(u.length>0)for(var e=u.length;e--;){var t=u[e];d.unbind(t[0],t[1],t[2])}ce(i,(function(e,t){c.unload(t),delete i[t]})),Zi.setDocument&&Zi.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},V=function(e,t,n){var r=t.keep_values,o={set:function(e,r,o){t.url_converter&&(r=t.url_converter.call(t.url_converter_scope||n(),r,o,e[0])),e.attr("data-mce-"+o,r).attr(o,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},i={style:{set:function(t,n){null===n||"object"!=typeof n?(r&&t.attr("data-mce-style",n),null!==n&&"string"==typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName)}}};return r&&(i.href=i.src=o),i}(f,t,(function(){return W}));return W}!function(e){e.DOM=e(document),e.nodeIndex=Va}($a||($a={}));var Ka=$a,Ja=Ka.DOM,Ga=dt.each,Xa=dt.grep,Ya=function(){function e(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}return e.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},e.prototype.loadScript=function(e,t,n){var r,o=Ja,i=function(){o.remove(a),r&&(r.onerror=r.onload=r=null)},a=o.uniqueId();(r=document.createElement("script")).id=a,r.type="text/javascript",r.src=dt._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=function(){i(),t()},r.onerror=function(){i(),B(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(r)},e.prototype.isDone=function(e){return 2===this.states[e]},e.prototype.markDone=function(e){this.states[e]=2},e.prototype.add=function(e,t,n,r){var o=this.states[e];this.queue.push(e),void 0===o&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},e.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},e.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},e.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},e.prototype.loadScripts=function(e,t,n,r){var o=this,i=[],a=function(e,t){Ga(o.scriptLoadedCallbacks[t],(function(t){B(t[e])&&t[e].call(t.scope)})),o.scriptLoadedCallbacks[t]=void 0};o.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var c=function(){var t=Xa(e);if(e.length=0,Ga(t,(function(e){2!==o.states[e]?3!==o.states[e]?1!==o.states[e]&&(o.states[e]=1,o.loading++,o.loadScript(e,(function(){o.states[e]=2,o.loading--,a("success",e),c()}),(function(){o.states[e]=3,o.loading--,i.push(e),a("failure",e),c()}))):a("failure",e):a("success",e)})),!o.loading){var n=o.queueLoadedCallbacks.slice(0);o.queueLoadedCallbacks.length=0,Ga(n,(function(e){0===i.length?B(e.success)&&e.success.call(e.scope):B(e.failure)&&e.failure.call(e.scope,i)}))}};c()},e.ScriptLoader=new e,e}(),Qa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Za={},ec=Qa("en"),tc=function(){return ge(Za,ec.get())},nc={getData:function(){return ue(Za,(function(e){return Ee({},e)}))},setCode:function(e){e&&ec.set(e)},getCode:function(){return ec.get()},add:function(e,t){var n=Za[e];n||(Za[e]=n={}),ce(t,(function(e,t){n[t.toLowerCase()]=e}))},translate:function(e){var t,n=tc().getOr({}),r=function(e){return B(e)?Object.prototype.toString.call(e):o(e)?"":""+e},o=function(e){return""===e||null==e},i=function(e){var t=r(e);return ge(n,t.toLowerCase()).map(r).getOr(t)},a=function(e){return e.replace(/{context:\w+}$/,"")};if(o(e))return"";if(A(t=e)&&he(t,"raw"))return r(e.raw);if(function(e){return N(e)&&e.length>1}(e)){var c=e.slice(1);return a(i(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return he(c,t)?r(c[t]):e})))}return a(i(e))},isRtl:function(){return tc().bind((function(e){return ge(e,"_dir")})).exists((function(e){return"rtl"===e}))},hasCode:function(e){return he(Za,e)}};function rc(){var e=this,t=[],n={},r={},o=[],i=function(e,t){var n=$(o,(function(n){return n.name===e&&n.state===t}));q(n,(function(e){return e.callback()}))},a=function(e){var t;return r[e]&&(t=r[e].dependencies),t||[]},c=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},u=function(e,t,o,l,s){if(!n[e]){var f="string"==typeof t?t:t.prefix+t.resource+t.suffix;0!==f.indexOf("/")&&-1===f.indexOf("://")&&(f=rc.baseURL+"/"+f),n[e]=f.substring(0,f.lastIndexOf("/"));var d=function(){i(e,"loaded"),function(e,t,n,r){var o=a(e);q(o,(function(e){var n=c(t,e);u(n.resource,n,void 0,void 0)})),n&&(r?n.call(r):n.call(Ya))}(e,t,o,l)};r[e]?d():Ya.ScriptLoader.add(f,d,l,s)}},l=function(e,t,i){void 0===i&&(i="added"),he(r,e)&&"added"===i||he(n,e)&&"loaded"===i?t():o.push({name:e,state:i,callback:t})};return{items:t,urls:n,lookup:r,_listeners:o,get:function(e){if(r[e])return r[e].instance},dependencies:a,requireLangPack:function(e,t){!1!==rc.languageLoad&&l(e,(function(){var r=nc.getCode();!r||t&&-1===(","+(t||"")+",").indexOf(","+r+",")||Ya.ScriptLoader.add(n[e]+"/langs/"+r+".js")}),"loaded")},add:function(e,n,o){var a=n;return t.push(a),r[e]={instance:a,dependencies:o},i(e,"added"),a},remove:function(e){delete n[e],delete r[e]},createUrl:c,addComponents:function(t,n){var r=e.urls[t];q(n,(function(e){Ya.ScriptLoader.add(r+"/"+e)}))},load:u,waitFor:l}}!function(e){e.PluginManager=e(),e.ThemeManager=e()}(rc||(rc={}));var oc=rc,ic=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null===n&&(n=setTimeout((function(){e.apply(null,r),n=null}),t))}}},ac=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout((function(){e.apply(null,r),n=null}),t)}}},cc=function(e,t){var n=Mn(e,t);return void 0===n||""===n?[]:n.split(" ")},uc=function(e){return void 0!==e.dom.classList},lc=function(e,t){return function(e,t,n){var r=cc(e,t).concat([n]);return Pn(e,t,r.join(" ")),!0}(e,"class",t)},sc=function(e,t){return function(e,t,n){var r=$(cc(e,t),(function(e){return e!==n}));return r.length>0?Pn(e,t,r.join(" ")):Fn(e,t),!1}(e,"class",t)},fc=function(e,t){uc(e)?e.dom.classList.add(t):lc(e,t)},dc=function(e){0===(uc(e)?e.dom.classList:function(e){return cc(e,"class")}(e)).length&&Fn(e,"class")},mc=function(e,t){return uc(e)&&e.dom.classList.contains(t)},pc=function(e,t){var n=[];return q(Mt(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(pc(e,t))})),n},gc=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return vt(n)?[]:W(n.querySelectorAll(e),pt.fromDom)}(t,e)},hc=d("mce-annotation"),vc=d("data-mce-annotation"),bc=d("data-mce-annotation-uid"),yc=function(e,t){var n=e.selection.getRng(),r=pt.fromDom(n.startContainer),o=pt.fromDom(e.getBody()),i=t.fold((function(){return"."+hc()}),(function(e){return"["+vc()+'="'+e+'"]'})),a=Lt(r,n.startOffset).getOr(r),c=gr(a,i,(function(e){return bt(e,o)})),u=function(e,t){return function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)}(e,t)?k.some(Mn(e,t)):k.none()};return c.bind((function(t){return u(t,""+bc()).bind((function(n){return u(t,""+vc()).map((function(t){var r=wc(e,n);return{uid:n,name:t,elements:r}}))}))}))},wc=function(e,t){var n=pt.fromDom(e.getBody());return gc(n,"["+bc()+'="'+t+'"]')},Cc=function(e,t){var n=Qa({}),r=function(e,t){o(e,(function(e){return t(e),e}))},o=function(e,t){var r=n.get(),o=t(r.hasOwnProperty(e)?r[e]:{listeners:[],previous:Qa(k.none())});r[e]=o,n.set(r)},i=ac((function(){var t,i,a,c=n.get(),u=(t=ie(c),(a=L.call(t,0)).sort(i),a);q(u,(function(t){o(t,(function(n){var o=n.previous.get();return yc(e,k.some(t)).fold((function(){o.isSome()&&(!function(e){r(e,(function(t){q(t.listeners,(function(t){return t(!1,e)}))}))}(t),n.previous.set(k.none()))}),(function(e){var t=e.uid,i=e.name,a=e.elements;o.is(t)||(!function(e,t,n){r(e,(function(r){q(r.listeners,(function(r){return r(!0,e,{uid:t,nodes:W(n,(function(e){return e.dom}))})}))}))}(i,t,a),n.previous.set(k.some(t)))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){i.cancel()})),e.on("NodeChange",(function(){i.throttle()}));return{addListener:function(e,t){o(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))}}},xc=function(e,t){e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){q(e,(function(e){(function(e){return k.from(e.attr(vc())).bind(t.lookup)})(e).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))},kc=0,Sc=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++kc+String(t)},Tc=function(e,t){var n,r,o=At(e).dom,i=pt.fromDom(o.createDocumentFragment()),a=(n=t,(r=(o||document).createElement("div")).innerHTML=n,Mt(pt.fromDom(r)));Yt(i,a),Qt(e),Xt(e,i)},Ec=function(e,t){return pt.fromDom(e.dom.cloneNode(t))},_c=function(e){return Ec(e,!1)},Ac=function(e){return Ec(e,!0)},Nc=function(e,t,n){void 0===n&&(n=b);var r=new Tr(e,t),o=function(e){var t;do{t=r[e]()}while(t&&!xn(t)&&!n(t));return k.from(t).filter(xn)};return{current:function(){return k.from(r.current()).filter(xn)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}},Rc=function(e,t){var n=t||function(t){return e.isBlock(t)||En(t)||Nn(t)},r=function(e,t,n,o){if(xn(e)){var i=o(e,t,e.data);if(-1!==i)return k.some({container:e,offset:i})}return n().bind((function(e){return r(e.container,e.offset,n,o)}))};return{backwards:function(e,t,o,i){var a=Nc(e,i,n);return r(e,t,(function(){return a.prev().map((function(e){return{container:e,offset:e.length}}))}),o).getOrNull()},forwards:function(e,t,o,i){var a=Nc(e,i,n);return r(e,t,(function(){return a.next().map((function(e){return{container:e,offset:0}}))}),o).getOrNull()}}},Oc=function(e,t,n){return e.isSome()&&t.isSome()?k.some(n(e.getOrDie(),t.getOrDie())):k.none()},Dc=Math.round,Ic=function(e){return e?{left:Dc(e.left),top:Dc(e.top),bottom:Dc(e.bottom),right:Dc(e.right),width:Dc(e.width),height:Dc(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Pc=function(e,t){return e=Ic(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Bc=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},Mc=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&Bc(t.top-e.bottom,e,t)},Lc=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Bc(t.bottom-e.top,e,t)},Fc=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},jc=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Hc=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Uc=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),zc=function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&Uc.test(e)},Wc=pn,qc=io,Vc=hn("display","block table"),$c=hn("float","left right"),Kc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(Wc,qc,g($c)),Jc=g(hn("white-space","pre pre-line pre-wrap")),Gc=xn,Xc=En,Yc=Ka.nodeIndex,Qc=Hc,Zc=function(e){return"createRange"in e?e.createRange():Ka.DOM.createRng()},eu=function(e){return e&&/[\r\n\t ]/.test(e)},tu=function(e){return!!e.setStart&&!!e.setEnd},nu=function(e){var t,n=e.startContainer,r=e.startOffset;return!!(eu(e.toString())&&Jc(n.parentNode)&&xn(n)&&(t=n.data,eu(t[r-1])||eu(t[r+1])))},ru=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},ou=function(e){var t,n=e.getClientRects();return t=n.length>0?Ic(n[0]):Ic(e.getBoundingClientRect()),!tu(e)&&Xc(e)&&ru(t)?function(e){var t=e.ownerDocument,n=Zc(t),r=t.createTextNode(""),o=e.parentNode;o.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var i=Ic(n.getBoundingClientRect());return o.removeChild(r),i}(e):ru(t)&&tu(e)?function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,o=e.endOffset;if(t===n&&xn(n)&&0===r&&1===o){var i=e.cloneRange();return i.setEndAfter(n),ou(i)}return null}(e):t},iu=function(e,t){var n=Pc(e,t);return n.width=1,n.right=n.left+1,n},au=function(e){var t,n,r=[],o=function(e){var t,n;0!==e.height&&(r.length>0&&(t=e,n=r[r.length-1],t.left===n.left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right)||r.push(e))},i=function(e,t){var n=Zc(e.ownerDocument);if(t<e.data.length){if(zc(e.data[t]))return r;if(zc(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!nu(n)))return o(iu(ou(n),!1)),r}t>0&&(n.setStart(e,t-1),n.setEnd(e,t),nu(n)||o(iu(ou(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),nu(n)||o(iu(ou(n),!0)))};if(Gc(e.container()))return i(e.container(),e.offset()),r;if(Wc(e.container()))if(e.isAtEnd())n=Qc(e.container(),e.offset()),Gc(n)&&i(n,n.data.length),Kc(n)&&!Xc(n)&&o(iu(ou(n),!1));else{if(n=Qc(e.container(),e.offset()),Gc(n)&&i(n,0),Kc(n)&&e.isAtEnd())return o(iu(ou(n),!1)),r;t=Qc(e.container(),e.offset()-1),Kc(t)&&!Xc(t)&&(Vc(t)||Vc(n)||!Kc(n))&&o(iu(ou(t),!1)),Kc(n)&&o(iu(ou(n),!0))}return r};function cu(e,t,n){var r=function(){return n||(n=au(cu(e,t))),n};return{container:d(e),offset:d(t),toRange:function(){var n=Zc(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return r().length>0},isAtStart:function(){return Gc(e),0===t},isAtEnd:function(){return Gc(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return Qc(e,n?t-1:t)}}}!function(e){e.fromRangeStart=function(t){return e(t.startContainer,t.startOffset)},e.fromRangeEnd=function(t){return e(t.endContainer,t.endOffset)},e.after=function(t){return e(t.parentNode,Yc(t)+1)},e.before=function(t){return e(t.parentNode,Yc(t))},e.isAbove=function(e,t){return Oc(ne(t.getClientRects()),re(e.getClientRects()),Mc).getOr(!1)},e.isBelow=function(e,t){return Oc(re(t.getClientRects()),ne(e.getClientRects()),Lc).getOr(!1)},e.isAtStart=function(e){return!!e&&e.isAtStart()},e.isAtEnd=function(e){return!!e&&e.isAtEnd()},e.isTextPosition=function(e){return!!e&&xn(e.container())},e.isElementPosition=function(t){return!1===e.isTextPosition(t)}}(cu||(cu={}));var uu,lu=cu,su=function(e,t){xn(t)&&0===t.data.length&&e.remove(t)},fu=function(e,t,n){Tn(n)?function(e,t,n){var r=k.from(n.firstChild),o=k.from(n.lastChild);t.insertNode(n),r.each((function(t){return su(e,t.previousSibling)})),o.each((function(t){return su(e,t.nextSibling)}))}(e,t,n):function(e,t,n){t.insertNode(n),su(e,n.previousSibling),su(e,n.nextSibling)}(e,t,n)},du=xn,mu=bn,pu=Ka.nodeIndex,gu=function(e){var t=e.parentNode;return mu(t)?gu(t):t},hu=function(e){return e?ke(e.childNodes,(function(e,t){return mu(t)&&"BR"!==t.nodeName?e=e.concat(hu(t)):e.push(t),e}),[]):[]},vu=function(e){return function(t){return e===t}},bu=function(e){return(du(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n;t=hu(gu(e)),n=Se(t,vu(e),e),t=t.slice(0,n+1);var r=ke(t,(function(e,n,r){return du(n)&&du(t[r-1])&&e++,e}),0);return t=Ce(t,gn([e.nodeName])),(n=Se(t,vu(e),e))-r}(e)+"]"},yu=function(e,t){var n,r,o,i,a,c=[];return n=t.container(),r=t.offset(),du(n)?o=function(e,t){for(;(e=e.previousSibling)&&du(e);)t+=e.data.length;return t}(n,r):(r>=(i=n.childNodes).length?(o="after",r=i.length-1):o="before",n=i[r]),c.push(bu(n)),a=function(e,t,n){var r=[];for(t=t.parentNode;t!==e&&(!n||!n(t));t=t.parentNode)r.push(t);return r}(e,n),a=Ce(a,g(bn)),(c=c.concat(we(a,(function(e){return bu(e)})))).reverse().join("/")+","+o},wu=function(e,t){var n;if(!t)return null;var r=t.split(","),o=r[0].split("/");n=r.length>1?r[1]:"before";var i=ke(o,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),function(e,t,n){var r=hu(e);return r=Ce(r,(function(e,t){return!du(e)||!du(r[t-1])})),(r=Ce(r,gn([t])))[n]}(e,n[1],parseInt(n[2],10))):null}),e);return i?du(i)?function(e,t){for(var n,r=e,o=0;du(r);){if(n=r.data.length,t>=o&&t<=o+n){e=r,t-=o;break}if(!du(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return du(e)&&t>e.data.length&&(t=e.data.length),lu(e,t)}(i,parseInt(n,10)):(n="after"===n?pu(i)+1:pu(i),lu(i.parentNode,n)):null},Cu=Nn,xu=function(e,t,n,r,o){var i,a=r[o?"startContainer":"endContainer"],c=r[o?"startOffset":"endOffset"],u=[],l=0,s=e.getRoot();for(xn(a)?u.push(n?function(e,t,n){var r,o;for(o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&xn(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,a,c):c):(c>=(i=a.childNodes).length&&i.length&&(l=1,c=Math.max(0,i.length-1)),u.push(e.nodeIndex(i[c],n)+l));a&&a!==s;a=a.parentNode)u.push(e.nodeIndex(a,n));return u},ku=function(e,t,n){var r=0;return dt.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},Su=function(e,t){var n,r,o,i=t?"start":"end";n=e[i+"Container"],r=e[i+"Offset"],pn(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(t?r:r-1,o.length-1)])&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r))},Tu=function(e){return Su(e,!0),Su(e,!1),e},Eu=function(e,t){var n;if(pn(e)&&(e=Hc(e,t),Cu(e)))return e;if(Wr(e)){if(xn(e)&&Ur(e)&&(e=e.parentNode),n=e.previousSibling,Cu(n))return n;if(n=e.nextSibling,Cu(n))return n}},_u=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(Cu(r)||"IMG"===o)return{name:o,index:ku(n.dom,o,r)};var a=function(e){return Eu(e.startContainer,e.startOffset)||Eu(e.endContainer,e.endOffset)}(i);return a?{name:o=a.tagName,index:ku(n.dom,o,a)}:function(e,t,n,r){var o=t.dom,i={};return i.start=xu(o,e,n,r,!0),t.isCollapsed()||(i.end=xu(o,e,n,r,!1)),i}(e,n,t,i)},Au=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},Nu=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),a=e.getNode(),c=a.nodeName;if("IMG"===c)return{name:c,index:ku(n,c,a)};var u=Tu(r.cloneRange());if(!i){u.collapse(!1);var l=Au(n,o+"_end",t);fu(n,u,l)}(r=Tu(r)).collapse(!0);var s=Au(n,o+"_start",t);return fu(n,r,s),e.moveToBookmark({id:o,keep:!0}),{id:o}},Ru=function(e,t,n){return 2===t?_u(Fr,n,e):3===t?function(e){var t=e.getRng();return{start:yu(e.dom.getRoot(),lu.fromRangeStart(t)),end:yu(e.dom.getRoot(),lu.fromRangeEnd(t))}}(e):t?function(e){return{rng:e.getRng()}}(e):Nu(e,!1)},Ou=p(_u,m,!0),Du=Ka.DOM,Iu=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var o=e.getParam(t,"","hash");return o.hasOwnProperty(e.id)?o[e.id]:n}return r},Pu=function(e){return e.getParam("content_security_policy","")},Bu=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Mu=function(e){return e.getParam("forced_root_block_attrs",{})},Lu=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Fu=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},ju=function(e){return e.getParam("icons","","string")},Hu=function(e){return e.getParam("images_upload_url","","string")},Uu=function(e){return e.getParam("images_upload_base_path","","string")},zu=function(e){return e.getParam("images_upload_credentials",!1,"boolean")},Wu=function(e){return e.getParam("images_upload_handler",null,"function")},qu=function(e){return e.getParam("content_css_cors",!1,"boolean")},Vu=function(e){return e.getParam("referrer_policy","","string")},$u=function(e){return e.getParam("language","en","string")},Ku=function(e){return e.getParam("indent_use_margin",!1)},Ju=function(e){var t=e.getParam("object_resizing");return!1!==t&&!ct.iOS&&(_(t)?t:"table,img,figure.image,div")},Gu=function(e){return e.getParam("event_root")},Xu=function(e){return e.getParam("theme")},Yu=function(e){return e.getParam("validate")},Qu=function(e){return!1!==e.getParam("inline_boundaries")},Zu=function(e){return e.getParam("content_css_cors")},el=function(e){return e.getParam("plugins","","string")},tl=pn,nl=xn,rl=function(e){var t=e.parentNode;t&&t.removeChild(e)},ol=function(e){var t=Fr(e);return{count:e.length-t.length,text:t}},il=function(e){for(var t;-1!==(t=e.data.lastIndexOf("\ufeff"));)e.deleteData(t,1)},al=function(e,t){return sl(e),t},cl=function(e,t){var n=t.container(),r=function(e,t){var n=H(e,t);return-1===n?k.none():k.some(n)}(oe(n.childNodes),e).map((function(e){return e<t.offset()?lu(n,t.offset()-1):t})).getOr(t);return sl(e),r},ul=function(e,t){return nl(e)&&t.container()===e?function(e,t){var n=ol(e.data.substr(0,t.offset())),r=ol(e.data.substr(t.offset()));return(n.text+r.text).length>0?(il(e),lu(e,t.offset()-n.count)):t}(e,t):al(e,t)},ll=function(e,t){return lu.isTextPosition(t)?ul(e,t):function(e,t){return t.container()===e.parentNode?cl(e,t):al(e,t)}(e,t)},sl=function(e){tl(e)&&Wr(e)&&(qr(e)?e.removeAttribute("data-mce-caret"):rl(e)),nl(e)&&(il(e),0===e.data.length&&rl(e))},fl=Qe().browser,dl=Nn,ml=On,pl=Rn,gl=function(e,t,n){var r,o,i,a,c,u=Pc(t.getBoundingClientRect(),n);return"BODY"===e.tagName?(r=e.ownerDocument.documentElement,o=e.scrollLeft||r.scrollLeft,i=e.scrollTop||r.scrollTop):(c=e.getBoundingClientRect(),o=e.scrollLeft-c.left,i=e.scrollTop-c.top),u.left+=o,u.right+=o,u.top+=i,u.bottom+=i,u.width=1,(a=t.offsetWidth-t.clientWidth)>0&&(n&&(a*=-1),u.left+=a,u.right+=a),u},hl=function(e,t,n,r){var o,i,a=Qa(k.none()),c=Bu(e),u=c.length>0?c:"p",l=function(){!function(e){for(var t=gc(pt.fromDom(e),"*[contentEditable=false],video,audio,embed,object"),n=0;n<t.length;n++){var r,o=t[n].dom,i=o.previousSibling;if(Gr(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(r.length-1,1);if(i=o.nextSibling,Jr(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1)}}(t),i&&(sl(i),i=null),a.get().each((function(e){ja(e.caret).remove(),a.set(k.none())})),o&&(wr.clearInterval(o),o=null)},s=function(){o=wr.setInterval((function(){r()?ja("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):ja("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)};return{show:function(e,r){var o,c;if(l(),pl(r))return null;if(!n(r))return i=function(e,t){var n,r=e.ownerDocument.createTextNode("\ufeff"),o=e.parentNode;if(t){if(n=e.previousSibling,Hr(n)){if(Wr(n))return n;if(Gr(n))return n.splitText(n.data.length-1)}o.insertBefore(r,e)}else{if(n=e.nextSibling,Hr(n)){if(Wr(n))return n;if(Jr(n))return n.splitText(1),n}e.nextSibling?o.insertBefore(r,e.nextSibling):o.appendChild(r)}return r}(r,e),c=r.ownerDocument.createRange(),bl(i.nextSibling)?(c.setStart(i,0),c.setEnd(i,0)):(c.setStart(i,1),c.setEnd(i,1)),c;i=Kr(u,r,e),o=gl(t,r,e),ja(i).css("top",o.top);var f=ja('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(o).appendTo(t)[0];return a.set(k.some({caret:f,element:r,before:e})),a.get().each((function(t){e&&ja(t.caret).addClass("mce-visual-caret-before")})),s(),(c=r.ownerDocument.createRange()).setStart(i,0),c.setEnd(i,0),c},hide:l,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){a.get().each((function(e){var n=gl(t,e.element,e.before);ja(e.caret).css(Ee({},n))}))},destroy:function(){return wr.clearInterval(o)}}},vl=function(){return fl.isIE()||fl.isEdge()||fl.isFirefox()},bl=function(e){return dl(e)||ml(e)},yl=function(e){return bl(e)||yn(e)&&vl()},wl=Nn,Cl=On,xl=hn("display","block table table-cell table-caption list-item"),kl=Wr,Sl=Ur,Tl=pn,El=io,_l=function(e){return e>0},Al=function(e){return e<0},Nl=function(e,t){for(var n;n=e(t);)if(!Sl(n))return n;return null},Rl=function(e,t,n,r,o){var i=new Tr(e,r),a=wl(e)||Sl(e);if(Al(t)){if(a&&n(e=Nl(i.prev,!0)))return e;for(;e=Nl(i.prev,o);)if(n(e))return e}if(_l(t)){if(a&&n(e=Nl(i.next,!0)))return e;for(;e=Nl(i.next,o);)if(n(e))return e}return null},Ol=function(e,t){for(;e&&e!==t;){if(xl(e))return e;e=e.parentNode}return null},Dl=function(e,t,n){return Ol(e.container(),n)===Ol(t.container(),n)},Il=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return Tl(n)?n.childNodes[r+e]:null},Pl=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},Bl=function(e,t,n){return Ol(t,e)===Ol(n,e)},Ml=function(e,t,n){var r,o;for(o=e?"previousSibling":"nextSibling";n&&n!==t;){if(r=n[o],kl(r)&&(r=r[o]),wl(r)||Cl(r)){if(Bl(t,r,n))return r;break}if(El(r))break;n=n.parentNode}return null},Ll=p(Pl,!0),Fl=p(Pl,!1),jl=function(e,t,n){var r,o,i,a=p(Ml,!0,t),c=p(Ml,!1,t);o=n.startContainer;var u=n.startOffset;if(Ur(o)){if(Tl(o)||(o=o.parentNode),"before"===(i=o.getAttribute("data-mce-caret"))&&(r=o.nextSibling,yl(r)))return Ll(r);if("after"===i&&(r=o.previousSibling,yl(r)))return Fl(r)}if(!n.collapsed)return n;if(xn(o)){if(kl(o)){if(1===e){if(r=c(o))return Ll(r);if(r=a(o))return Fl(r)}if(-1===e){if(r=a(o))return Fl(r);if(r=c(o))return Ll(r)}return n}if(Gr(o)&&u>=o.data.length-1)return 1===e&&(r=c(o))?Ll(r):n;if(Jr(o)&&u<=1)return-1===e&&(r=a(o))?Fl(r):n;if(u===o.data.length)return(r=c(o))?Ll(r):n;if(0===u)return(r=a(o))?Fl(r):n}return n},Hl=function(e,t){return k.from(Il(e?0:-1,t)).filter(wl)},Ul=function(e,t,n){var r=jl(e,t,n);return-1===e?cu.fromRangeStart(r):cu.fromRangeEnd(r)},zl=function(e){return k.from(e.getNode()).map(pt.fromDom)},Wl=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},ql=function(e,t){var n=Dl(e,t);return!(n||!En(e.getNode()))||n};!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(uu||(uu={}));var Vl,$l=Nn,Kl=xn,Jl=pn,Gl=En,Xl=io,Yl=function(e){return no(e)||function(e){return!!ao(e)&&!0!==J(oe(e.getElementsByTagName("*")),(function(e,t){return e||Yr(t)}),!1)}(e)},Ql=co,Zl=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},es=function(e,t){if(_l(e)){if(Xl(t.previousSibling)&&!Kl(t.previousSibling))return lu.before(t);if(Kl(t))return lu(t,0)}if(Al(e)){if(Xl(t.nextSibling)&&!Kl(t.nextSibling))return lu.after(t);if(Kl(t))return lu(t,t.data.length)}return Al(e)?Gl(t)?lu.before(t):lu.after(t):lu.before(t)},ts=function(e,t,n){var r,o,i,a;if(!Jl(n)||!t)return null;if(t.isEqual(lu.after(n))&&n.lastChild){if(a=lu.after(n.lastChild),Al(e)&&Xl(n.lastChild)&&Jl(n.lastChild))return Gl(n.lastChild)?lu.before(n.lastChild):a}else a=t;var c=a.container(),u=a.offset();if(Kl(c)){if(Al(e)&&u>0)return lu(c,--u);if(_l(e)&&u<c.length)return lu(c,++u);r=c}else{if(Al(e)&&u>0&&(o=Zl(c,u-1),Xl(o)))return!Yl(o)&&(i=Rl(o,e,Ql,o))?Kl(i)?lu(i,i.data.length):lu.after(i):Kl(o)?lu(o,o.data.length):lu.before(o);if(_l(e)&&u<c.childNodes.length&&(o=Zl(c,u),Xl(o)))return Gl(o)?function(e,t){var n=t.nextSibling;return n&&Xl(n)?Kl(n)?lu(n,0):lu.before(n):ts(uu.Forwards,lu.after(t),e)}(n,o):!Yl(o)&&(i=Rl(o,e,Ql,o))?Kl(i)?lu(i,0):lu.before(i):Kl(o)?lu(o,0):lu.after(o);r=o||a.getNode()}if((_l(e)&&a.isAtEnd()||Al(e)&&a.isAtStart())&&(r=Rl(r,e,y,n,!0),Ql(r,n)))return es(e,r);o=Rl(r,e,Ql,n);var l=Te($(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(c,n),$l));return!l||o&&l.contains(o)?o?es(e,o):null:a=_l(e)?lu.after(l):lu.before(l)},ns=function(e){return{next:function(t){return ts(uu.Forwards,t,e)},prev:function(t){return ts(uu.Backwards,t,e)}}},rs=function(e){return lu.isTextPosition(e)?0===e.offset():io(e.getNode())},os=function(e){if(lu.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return io(e.getNode(!0))},is=function(e,t){return!lu.isTextPosition(e)&&!lu.isTextPosition(t)&&e.getNode()===t.getNode(!0)},as=function(e,t,n){return e?!is(t,n)&&(r=t,!(!lu.isTextPosition(r)&&En(r.getNode())))&&os(t)&&rs(n):!is(n,t)&&rs(t)&&os(n);var r},cs=function(e,t,n){var r=ns(t);return k.from(e?r.next(n):r.prev(n))},us=function(e,t,n){return cs(e,t,n).bind((function(r){return Dl(n,r,t)&&as(e,n,r)?cs(e,t,r):k.some(r)}))},ls=function(e,t,n,r){return us(e,t,n).bind((function(n){return r(n)?ls(e,t,n,r):k.some(n)}))},ss=function(e,t){var n,r=e?t.firstChild:t.lastChild;return xn(r)?k.some(lu(r,e?0:r.data.length)):r?io(r)?k.some(e?lu.before(r):En(n=r)?lu.before(n):lu.after(n)):function(e,t,n){var r=e?lu.before(n):lu.after(n);return cs(e,t,r)}(e,t,r):k.none()},fs=p(cs,!0),ds=p(cs,!1),ms=p(ss,!0),ps=p(ss,!1),gs=function(e){return pn(e)&&"_mce_caret"===e.id},hs=function(e,t){for(;t&&t!==e;){if("_mce_caret"===t.id)return t;t=t.parentNode}return null},vs=function(e,t){return pn(t)&&e.isBlock(t)&&!t.innerHTML&&!ct.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},bs=function(e,t){return ps(e).fold((function(){return!1}),(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},ys=function(e,t,n){return!(!function(e){return!1===e.hasChildNodes()}(t)||!hs(e,t))&&(function(e,t){var n=e.ownerDocument.createTextNode("\ufeff");e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)}(t,n),!0)},ws=function(e,t,n,r){var o,i,a,c,u=n[t?"start":"end"],l=e.getRoot();if(u){for(a=u[0],i=l,o=u.length-1;o>=1;o--){if(c=i.childNodes,ys(l,i,r))return!0;if(u[o]>c.length-1)return!!ys(l,i,r)||bs(i,r);i=c[u[o]]}3===i.nodeType&&(a=Math.min(u[0],i.nodeValue.length)),1===i.nodeType&&(a=Math.min(u[0],i.childNodes.length)),t?r.setStart(i,a):r.setEnd(i,a)}return!0},Cs=function(e){return xn(e)&&e.data.length>0},xs=function(e,t,n){var r,o,i,a,c,u,l=e.get(n.id+"_"+t),s=n.keep;if(l){if(r=l.parentNode,"start"===t?(s?l.hasChildNodes()?(r=l.firstChild,o=1):Cs(l.nextSibling)?(r=l.nextSibling,o=0):Cs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)+1):o=e.nodeIndex(l),c=r,u=o):(s?l.hasChildNodes()?(r=l.firstChild,o=1):Cs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)):o=e.nodeIndex(l),c=r,u=o),!s){for(a=l.previousSibling,i=l.nextSibling,dt.each(dt.grep(l.childNodes),(function(e){xn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));l=e.get(n.id+"_"+t);)e.remove(l,!0);a&&i&&a.nodeType===i.nodeType&&xn(a)&&!ct.opera&&(o=a.nodeValue.length,a.appendData(i.nodeValue),e.remove(i),c=a,u=o)}return k.some(lu(c,u))}return k.none()},ks=function(e,t){var n=e.dom;if(t){if(function(e){return dt.isArray(e.start)}(t))return function(e,t){var n=e.createRng();return ws(e,!0,t,n)&&ws(e,!1,t,n)?k.some(n):k.none()}(n,t);if(function(e){return"string"==typeof e.start}(t))return k.some(function(e,t){var n,r=e.createRng();return n=wu(e.getRoot(),t.start),r.setStart(n.container(),n.offset()),n=wu(e.getRoot(),t.end),r.setEnd(n.container(),n.offset()),r}(n,t));if(function(e){return e.hasOwnProperty("id")}(t))return function(e,t){var n=xs(e,"start",t),r=xs(e,"end",t);return Oc(n,r.or(n),(function(t,n){var r=e.createRng();return r.setStart(vs(e,t.container()),t.offset()),r.setEnd(vs(e,n.container()),n.offset()),r}))}(n,t);if(function(e){return e.hasOwnProperty("name")}(t))return function(e,t){return k.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))}(n,t);if(function(e){return e.hasOwnProperty("rng")}(t))return k.some(t.rng)}return k.none()},Ss=function(e,t,n){return Ru(e,t,n)},Ts=function(e,t){ks(e,t).each((function(t){e.setRng(t)}))},Es=function(e){return pn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},_s=(Vl="",function(e){return Vl===e}),As=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},Ns=function(e){return!As(e)&&!_s(e)},Rs=function(e){return!!e.nodeType},Os=function(e,t,n){var r,o,i,a=n.startOffset,c=n.startContainer;if((n.startContainer!==n.endContainer||!function(e){return e&&/^(IMG)$/.test(e.nodeName)}(n.startContainer.childNodes[n.startOffset]))&&1===c.nodeType)for(a<(i=c.childNodes).length?(c=i[a],r=new Tr(c,e.getParent(c,e.isBlock))):(c=i[i.length-1],(r=new Tr(c,e.getParent(c,e.isBlock))).next(!0)),o=r.current();o;o=r.next())if(3===o.nodeType&&!Bs(o))return n.setStart(o,0),void t.setRng(n)},Ds=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(1===e.nodeType||!Bs(e))return e}},Is=function(e,t){return Rs(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},Ps=function(e,t,n){return e.schema.isValidChild(t,n)},Bs=function(e,t){if(void 0===t&&(t=!1),P(e)&&xn(e)){var n=t?e.data.replace(/ /g,""):e.data;return lo(n)}return!1},Ms=function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},Ls=function(e,t){return t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},Fs=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},js=function(e,t,n){return Fs(e,e.getStyle(t,n),n)},Hs=function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},Us=function(e,t,n){return e.getParents(t,n,e.getRoot())},zs=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],o=function(e){return me(e,(function(e,t){return z(r,(function(e){return e===t}))}))};return z(e.formatter.get(t),(function(t){var r=o(t);return z(e.formatter.get(n),(function(e){var t=o(e);return function(e,t,n){return void 0===n&&(n=l),u(n).eq(e,t)}(r,t)}))}))},Ws=function(e){return ve(e,"block")},qs=function(e){return ve(e,"selector")},Vs=function(e){return ve(e,"inline")},$s=Es,Ks=Us,Js=Bs,Gs=Is,Xs=function(e,t){for(var n=t;n;){if(pn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},Ys=function(e,t,n,r){for(var o=t.data,i=n;e?i>=0:i<o.length;e?i--:i++)if(r(o.charAt(i)))return e?i+1:i;return-1},Qs=function(e,t,n){return Ys(e,t,n,(function(e){return _s(e)||As(e)}))},Zs=function(e,t,n){return Ys(e,t,n,Ns)},ef=function(e,t,n,r,o,i){var a,c=e.getParent(n,e.isBlock)||t,u=function(t,n,r){var i=Rc(e),u=o?i.backwards:i.forwards;return k.from(u(t,n,(function(e,t){return $s(e.parentNode)?-1:(a=e,r(o,e,t))}),c))};return u(n,r,Qs).bind((function(e){return i?u(e.container,e.offset+(o?-1:0),Zs):k.some(e)})).orThunk((function(){return a?k.some({container:a,offset:o?0:a.length}):k.none()}))},tf=function(e,t,n,r,o){xn(r)&&0===r.nodeValue.length&&r[o]&&(r=r[o]);for(var i=Ks(e,r),a=0;a<i.length;a++)for(var c=0;c<t.length;c++){var u=t[c];if((!("collapsed"in u)||u.collapsed===n.collapsed)&&e.is(i[a],u.selector))return i[a]}return r},nf=function(e,t,n,r){var o,i=e.dom,a=i.getRoot();if(t[0].wrapper||(o=i.getParent(n,t[0].block,a)),!o){var c=i.getParent(n,"LI,TD,TH");o=i.getParent(xn(n)?n.parentNode:n,(function(t){return t!==a&&Gs(e,t)}),c)}if(o&&t[0].wrapper&&(o=Ks(i,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!i.isBlock(o[r])&&(o=o[r],!Ls(o,"br")););return o||n},rf=function(e,t,n,r){var o=n.parentNode;return!P(n[r])&&(!(o!==t&&!I(o)&&!e.isBlock(o))||rf(e,t,o,r))},of=function(e,t,n,r,o){var i,a,c=n,u=o?"previousSibling":"nextSibling",l=e.getRoot();if(xn(n)&&!Js(n)&&(o?r>0:r<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(c))return c;for(i=c[u];i;i=i[u]){var s=xn(i)&&!rf(e,l,i,u);if(!$s(i)&&(!En(a=i)||!a.getAttribute("data-mce-bogus")||a.nextSibling)&&!Js(i,s))return c}if(c===l||c.parentNode===l){n=c;break}c=c.parentNode}return n},af=function(e){return $s(e.parentNode)||$s(e)},cf=function(e,t,n,r){void 0===r&&(r=!1);var o=t.startContainer,i=t.startOffset,a=t.endContainer,c=t.endOffset,u=e.dom;(pn(o)&&o.hasChildNodes()&&(o=Hc(o,i),xn(o)&&(i=0)),pn(a)&&a.hasChildNodes()&&(a=Hc(a,t.collapsed?c:c-1),xn(a)&&(c=a.nodeValue.length)),o=Xs(u,o),a=Xs(u,a),af(o)&&(o=$s(o)?o:o.parentNode,o=t.collapsed?o.previousSibling||o:o.nextSibling||o,xn(o)&&(i=t.collapsed?o.length:0)),af(a)&&(a=$s(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,xn(a)&&(c=t.collapsed?0:a.length)),t.collapsed)&&(ef(u,e.getBody(),o,i,!0,r).each((function(e){var t=e.container,n=e.offset;o=t,i=n})),ef(u,e.getBody(),a,c,!1,r).each((function(e){var t=e.container,n=e.offset;a=t,c=n})));return(n[0].inline||n[0].block_expand)&&(n[0].inline&&xn(o)&&0!==i||(o=of(u,n,o,i,!0)),n[0].inline&&xn(a)&&c!==a.nodeValue.length||(a=of(u,n,a,c,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(o=tf(u,n,t,o,"previousSibling"),a=tf(u,n,t,a,"nextSibling")),(n[0].block||n[0].selector)&&(o=nf(e,n,o,"previousSibling"),a=nf(e,n,a,"nextSibling"),n[0].block&&(u.isBlock(o)||(o=of(u,n,o,i,!0)),u.isBlock(a)||(a=of(u,n,a,c,!1)))),pn(o)&&(i=u.nodeIndex(o),o=o.parentNode),pn(a)&&(c=u.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:i,endContainer:a,endOffset:c}},uf=function(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e},lf=function(e,t,n){var r=t.startContainer,o=t.startOffset,i=t.endContainer,a=t.endOffset,c=function(e){var t;return 3===(t=e[0]).nodeType&&t===r&&o>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===a&&e.length>0&&t===i&&3===t.nodeType&&e.splice(e.length-1,1),e},u=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},l=function(e,t){do{if(e.parentNode===t)return e;e=e.parentNode}while(e)},s=function(e,t,r){for(var o=r?"nextSibling":"previousSibling",i=e,a=i.parentNode;i&&i!==t;i=a){a=i.parentNode;var l=u(i===e?i:i[o],o);l.length&&(r||l.reverse(),n(c(l)))}};if(1===r.nodeType&&r.hasChildNodes()&&(r=uf(r,o)),1===i.nodeType&&i.hasChildNodes()&&(i=uf(i,a-1)),r===i)return n(c([r]));for(var f=e.findCommonAncestor(r,i),d=r;d;d=d.parentNode){if(d===i)return s(r,f,!0);if(d===f)break}for(d=i;d;d=d.parentNode){if(d===r)return s(i,f);if(d===f)break}var m=l(r,f)||r,p=l(i,f)||i;s(r,m,!0);var g=u(m===r?m:m.nextSibling,"nextSibling",p===i?p.nextSibling:p);g.length&&n(c(g)),s(i,p)},sf=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},ff=function(e){return $(function(e){return Y(e,(function(e){var t=jc(e);return t?[pt.fromDom(t)]:[]}))}(e),Br)},df=function(e,t){var n=gc(t,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:ff(e)},mf=function(e){return df(sf(e.selection.getSel()),pt.fromDom(e.getBody()))},pf=function(e){return Ft(e).fold(d([e]),(function(t){return[e].concat(pf(t))}))},gf=function(e){return jt(e).fold(d([e]),(function(t){return"br"===Ct(t)?Dt(t).map((function(t){return[e].concat(gf(t))})).getOr([]):[e].concat(gf(t))}))},hf=function(e,t){return Oc(function(e){var t=e.startContainer,n=e.startOffset;return xn(t)?0===n?k.some(pt.fromDom(t)):k.none():k.from(t.childNodes[n]).map(pt.fromDom)}(t),function(e){var t=e.endContainer,n=e.endOffset;return xn(t)?n===t.data.length?k.some(pt.fromDom(t)):k.none():k.from(t.childNodes[n-1]).map(pt.fromDom)}(t),(function(t,n){var r=G(pf(e),p(bt,t)),o=G(gf(e),p(bt,n));return r.isSome()&&o.isSome()})).getOr(!1)},vf=function(e,t,n,r){var o=n,i=new Tr(n,o),a=me(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!U(["td","th","table"],t.toLowerCase())}));do{if(xn(n)&&0!==dt.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},bf=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0},yf=function(e,t){var n=mf(e);n.length>0?q(n,(function(n){var r=n.dom,o=e.dom.createRng();o.setStartBefore(r),o.setEndAfter(r),t(o,!0)})):t(e.selection.getRng(),!1)},wf=function(e,t,n){var r=Nu(e,t);n(r),e.moveToBookmark(r)};var Cf=function(e,t){var n=function(t){return e(t)?k.from(t.dom.nodeValue):k.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(Tt,"text"),xf=function(e){return Cf.get(e)},kf=function(e,t,n,r){return Ot(t).fold((function(){return"skipping"}),(function(o){return"br"===r||function(e){return Tt(e)&&"\ufeff"===xf(e)}(t)?"valid":function(e){return St(e)&&mc(e,hc())}(t)?"existing":gs(t.dom)?"caret":Ps(e,n,r)&&Ps(e,Ct(o),n)?"valid":"invalid-child"}))},Sf=function(e,t,n,r){var o=t.uid,i=void 0===o?Sc("mce-annotation"):o,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["uid"]),c=pt.fromTag("span",e);fc(c,hc()),Pn(c,""+bc(),i),Pn(c,""+vc(),n);var u=r(i,a),l=u.attributes,s=void 0===l?{}:l,f=u.classes,d=void 0===f?[]:f;return Bn(c,s),function(e,t){q(t,(function(t){fc(e,t)}))}(c,d),c},Tf=function(e,t,n,r,o){var i=[],a=Sf(e.getDoc(),o,n,r),c=Qa(k.none()),u=function(){c.set(k.none())},l=function(e){q(e,s)},s=function(t){switch(kf(e,t,"span",Ct(t))){case"invalid-child":u();var n=Mt(t);l(n),u();break;case"valid":!function(e,t){Kt(e,t),Xt(t,e)}(t,c.get().getOrThunk((function(){var e=_c(a);return i.push(e),c.set(k.some(e)),e})))}};return lf(e.dom,t,(function(e){u(),function(e){var t=W(e,pt.fromDom);l(t)}(e)})),i},Ef=function(e,t,n,r){e.undoManager.transact((function(){var o=e.selection,i=o.getRng(),a=mf(e).length>0;if(i.collapsed&&!a&&function(e,t){var n=cf(e,t,[{inline:!0}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)}(e,i),o.getRng().collapsed&&!a){var c=Sf(e.getDoc(),r,t,n.decorate);Tc(c,""),o.getRng().insertNode(c.dom),o.select(c.dom)}else wf(o,!1,(function(){yf(e,(function(o){Tf(e,o,t,n.decorate,r)}))}))}))},_f=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return t.hasOwnProperty(e)?k.from(t[e]).map((function(e){return e.settings})):k.none()}});xc(e,n);var r=Cc(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,r){n.lookup(t).each((function(n){Ef(e,t,n,r)}))},annotationChanged:function(e,t){r.addListener(e,t)},remove:function(t){yc(e,k.some(t)).each((function(e){var t=e.elements;q(t,en)}))},getAll:function(t){var n=function(e,t){var n=pt.fromDom(e.getBody()),r=gc(n,"["+vc()+'="'+t+'"]'),o={};return q(r,(function(e){var t=Mn(e,bc()),n=o.hasOwnProperty(t)?o[t]:[];o[t]=n.concat([e])})),o}(e,t);return ue(n,(function(e){return W(e,(function(e){return e.dom}))}))}}};function Af(e){return{getBookmark:p(Ss,e),moveToBookmark:p(Ts,e)}}!function(e){e.isBookmarkNode=Es}(Af||(Af={}));var Nf=Af,Rf=function(e,t){for(;t&&t!==e;){if(An(t)||Nn(t))return t;t=t.parentNode}return null},Of=function(e,t,n){if(n.collapsed)return!1;if(ct.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(pn(r))return z(r.getClientRects(),(function(n){return Fc(n,e,t)}))}return z(n.getClientRects(),(function(n){return Fc(n,e,t)}))},Df={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return ct.mac?e.metaKey:e.ctrlKey&&!e.altKey}},If=Nn,Pf=function(e,t){var n,r,o,i,a,c,u,l,s,f,d,m,p,g,h=t.dom,v=dt.each,b=t.getDoc(),y=document,w=Math.abs,C=Math.round,x=t.getBody(),k={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},S=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},T=function(e){var n=e.target;(function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return S(e.target)&&!Of(n.clientX,n.clientY,t)}return S(e.target)&&!Of(e.clientX,e.clientY,t)})(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},E=function(e){return t.dom.is(e,"figure.image")?e.querySelector("img"):e},_=function(e){var n=Ju(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&ht(pt.fromDom(e),n)))},A=function(e,t,n){h.setStyles(E(e),{width:t,height:n})},N=function(e){var v,b,y,k;v=e.screenX-a,b=e.screenY-c,d=v*i[2]+u,m=b*i[3]+l,d=d<5?5:d,m=m<5?5:m,(S(n)&&!1!==function(e){return e.getParam("resize_img_proportional",!0,"boolean")}(t)?!Df.modifierPressed(e):Df.modifierPressed(e))&&(w(v)>w(b)?(m=C(d*s),d=C(m/s)):(d=C(m/s),m=C(d*s))),A(r,d,m),y=(y=i.startPos.x+v)>0?y:0,k=(k=i.startPos.y+b)>0?k:0,h.setStyles(o,{left:y,top:k,display:"block"}),o.innerHTML=d+" &times; "+m,i[2]<0&&r.clientWidth<=d&&h.setStyle(r,"left",void 0+(u-d)),i[3]<0&&r.clientHeight<=m&&h.setStyle(r,"top",void 0+(l-m)),(v=x.scrollWidth-p)+(b=x.scrollHeight-g)!==0&&h.setStyles(o,{left:y-v,top:k-b}),f||(!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(t,n,u,l,"corner-"+i.name),f=!0)},R=function(){var e=f;f=!1;var a=function(e,r){r&&(n.style[e]||!t.schema.isValid(n.nodeName.toLowerCase(),e)?h.setStyle(E(n),e,r):h.setAttrib(E(n),e,""+r))};e&&(a("width",d),a("height",m)),h.unbind(b,"mousemove",N),h.unbind(b,"mouseup",R),y!==b&&(h.unbind(y,"mousemove",N),h.unbind(y,"mouseup",R)),h.remove(r),h.remove(o),O(n),e&&(!function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(t,n,d,m,"corner-"+i.name),h.setAttrib(n,"style",h.getAttrib(n,"style"))),t.nodeChanged()},O=function(e){D(),B();var f=h.getPos(e,x),w=f.x,C=f.y,S=e.getBoundingClientRect(),T=S.width||S.right-S.left,O=S.height||S.bottom-S.top;n!==e&&(n=e,d=m=0);var I=t.fire("ObjectSelected",{target:e});_(e)&&!I.isDefaultPrevented()?v(k,(function(e,t){var f;(f=h.get("mceResizeHandle"+t))&&h.remove(f),f=h.add(x,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===ct.ie&&(f.contentEditable=!1),h.bind(f,"mousedown",(function(f){f.stopImmediatePropagation(),f.preventDefault(),function(f){a=f.screenX,c=f.screenY,u=E(n).clientWidth,l=E(n).clientHeight,s=l/u,(i=e).name=t,i.startPos={x:T*e[0]+w,y:O*e[1]+C},p=x.scrollWidth,g=x.scrollHeight,r=n.cloneNode(!0),h.addClass(r,"mce-clonedresizable"),h.setAttrib(r,"data-mce-bogus","all"),r.contentEditable=!1,r.unSelectabe=!0,h.setStyles(r,{left:w,top:C,margin:0}),A(r,T,O),r.removeAttribute("data-mce-selected"),x.appendChild(r),h.bind(b,"mousemove",N),h.bind(b,"mouseup",R),y!==b&&(h.bind(y,"mousemove",N),h.bind(y,"mouseup",R)),o=h.add(x,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},u+" &times; "+l)}(f)})),e.elm=f,h.setStyles(f,{left:T*e[0]+w-f.offsetWidth/2,top:O*e[1]+C-f.offsetHeight/2})})):D(),n.setAttribute("data-mce-selected","1")},D=function(){B(),n&&n.removeAttribute("data-mce-selected"),ce(k,(function(e,t){var n=h.get("mceResizeHandle"+t);n&&(h.unbind(n),h.remove(n))}))},I=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};f||t.removed||(v(h.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),r="mousedown"===n.type?n.target:e.getNode(),o(r=h.$(r).closest("table,img,figure.image,hr")[0],x)&&(M(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?O(r):D())},P=function(e){return If(Rf(t.getBody(),e))},B=function(){ce(k,(function(e){e.elm&&(h.unbind(e.elm),delete e.elm)}))},M=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(function(){if(M(),ct.browser.isIE()||ct.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;f||!/^(TABLE|IMG|HR)$/.test(r)||P(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}));var e=function(e){var n=function(e){wr.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(P(e.target)||On(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))};h.bind(x,"mscontrolselect",e),t.on("remove",(function(){return h.unbind(x,"mscontrolselect",e)}))}var r=wr.throttle((function(e){t.composing||I(e)}));t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),t.on("keyup compositionend",(function(e){n&&"TABLE"===n.nodeName&&r(e)})),t.on("hide blur",D),t.on("contextmenu longpress",T,!0)})),t.on("remove",B);return{isResizable:_,showResizeRect:O,hideResizeRect:D,updateResizeRect:I,destroy:function(){n=r=null}}},Bf=function(e){return An(e)||Nn(e)},Mf=function(e,t,n){var r,o,i=n;if(i.caretPositionFromPoint)(o=i.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(n.caretRangeFromPoint)r=n.caretRangeFromPoint(e,t);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o=n.elementFromPoint(e,t),i=n.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=n.body),i.moveToElementText(o),(r=(r=dt.toArray(i.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-(n=Math.abs(Math.max(n.top-t,n.bottom-t)))}))).length>0){t=(r[0].bottom+r[0].top)/2;try{return i.moveToPoint(e,t),i.collapse(!0),i}catch(e){}}return null}(e,t,n)}return function(e,t){var n=e&&e.parentElement?e.parentElement():null;return Nn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(n,t,Bf))?null:e}(r,n.body)}return r},Lf=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Ff=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},jf=function(e,t,n){return Ff(e,t,(function(e){return e.nodeName===n}))},Hf=function(e){return e&&"TABLE"===e.nodeName},Uf=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},zf=function(e,t){return Wr(e)&&!1===Ff(e,t,gs)},Wf=function(e,t,n){for(var r=new Tr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(En(t))return!0},qf=function(e,t,n,r,o){var i,a,c=e.getRoot(),u=e.schema.getNonEmptyElements(),l=e.getParent(o.parentNode,e.isBlock)||c;if(r&&En(o)&&t&&e.isEmpty(l))return k.some(cu(o.parentNode,e.nodeIndex(o)));for(var s=new Tr(o,l);a=s[r?"prev":"next"]();){if("false"===e.getContentEditableParent(a)||zf(a,c))return k.none();if(xn(a)&&a.nodeValue.length>0)return!1===jf(a,c,"A")?k.some(cu(a,r?a.nodeValue.length:0)):k.none();if(e.isBlock(a)||u[a.nodeName.toLowerCase()])return k.none();i=a}return n&&i?k.some(cu(i,0)):k.none()},Vf=function(e,t,n,r){var o,i,a,c,u=e.getRoot(),l=!1;o=r[(n?"start":"end")+"Container"],i=r[(n?"start":"end")+"Offset"];var s=pn(o)&&i===o.childNodes.length,f=e.schema.getNonEmptyElements();if(c=n,Wr(o))return k.none();if(pn(o)&&i>o.childNodes.length-1&&(c=!1),Sn(o)&&(o=u,i=0),o===u){if(c&&(a=o.childNodes[i>0?i-1:0])){if(Wr(a))return k.none();if(f[a.nodeName]||Hf(a))return k.none()}if(o.hasChildNodes()){if(i=Math.min(!c&&i>0?i-1:i,o.childNodes.length-1),o=o.childNodes[i],i=xn(o)&&s?o.data.length:0,!t&&o===u.lastChild&&Hf(o))return k.none();if(function(e,t){for(;t&&t!==e;){if(Nn(t))return!0;t=t.parentNode}return!1}(u,o)||Wr(o))return k.none();if(o.hasChildNodes()&&!1===Hf(o)){a=o;var d=new Tr(o,u);do{if(Nn(a)||Wr(a)){l=!1;break}if(xn(a)&&a.nodeValue.length>0){i=c?0:a.nodeValue.length,o=a,l=!0;break}if(f[a.nodeName.toLowerCase()]&&!Uf(a)){i=e.nodeIndex(a),o=a.parentNode,c||i++,l=!0;break}}while(a=c?d.next():d.prev())}}}return t&&(xn(o)&&0===i&&qf(e,s,t,!0,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),pn(o)&&((a=o.childNodes[i])||(a=o.childNodes[i-1]),!a||!En(a)||function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t}(a,"A")||Wf(e,a,!1)||Wf(e,a,!0)||qf(e,s,t,!0,a).each((function(e){o=e.container(),i=e.offset(),l=!0})))),c&&!t&&xn(o)&&i===o.nodeValue.length&&qf(e,s,t,!1,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),l?k.some(cu(o,i)):k.none()},$f=function(e,t){var n=t.collapsed,r=t.cloneRange(),o=cu.fromRangeStart(t);return Vf(e,n,!0,r).each((function(e){n&&cu.isAbove(o,e)||r.setStart(e.container(),e.offset())})),n||Vf(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),Lf(t,r)?k.none():k.some(r)},Kf=function(e,t){return e.splitText(t)},Jf=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&xn(t)?n>0&&n<t.nodeValue.length&&(t=(r=Kf(t,n)).previousSibling,o>n?(t=r=Kf(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(xn(t)&&n>0&&n<t.nodeValue.length&&(t=Kf(t,n),n=0),xn(r)&&o>0&&o<r.nodeValue.length&&(o=(r=Kf(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}};function Gf(e){return{walk:function(t,n){return lf(e,t,n)},split:Jf,normalize:function(t){return $f(e,t).fold(b,(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}}!function(e){e.compareRanges=Lf,e.getCaretRangeFromPoint=Mf,e.getSelectedNode=jc,e.getNode=Hc}(Gf||(Gf={}));var Xf=Gf;var Yf,Qf=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Hn(n,e);return parseFloat(o)||0}return r},r=function(e,t){return J(t,(function(t,n){var r=Hn(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!M(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Dn(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}("height",(function(e){var t=e.dom;return tn(e)?t.getBoundingClientRect().height:t.offsetHeight})),Zf=function(e,t){return e.view(t).fold(d([]),(function(t){var n=e.owner(t),r=Zf(e,n);return[t].concat(r)}))},ed=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?k.none():k.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(pt.fromDom)},owner:function(e){return Nt(e)}}),td=function(e){var t=pt.fromDom(document),n=cn(t),r=function(e,t){var n=t.owner(e);return Zf(t,n)}(e,ed),o=an(e),i=K(r,(function(e,t){var n=an(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return rn(i.left+o.left+n.left,i.top+o.top+n.top)},nd=function(e){return"textarea"===Ct(e)},rd=function(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return rn(n.offsetLeft,n.offsetTop);var i=on(null==r?void 0:r.pageYOffset,o.scrollTop),a=on(null==r?void 0:r.pageXOffset,o.scrollLeft),c=on(o.clientTop,n.clientTop),u=on(o.clientLeft,n.clientLeft);return an(e).translate(a-u,i-c)}(e),r=function(e){return Qf.get(e)}(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},od=function(e,t){var n=function(e,t){var n=Mt(e);if(0===n.length||nd(e))return{element:e,offset:t};if(t<n.length&&!nd(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return nd(r)?{element:e,offset:t}:"img"===Ct(r)?{element:r,offset:1}:Tt(r)?{element:r,offset:xf(r).length}:{element:r,offset:Mt(r).length}}(e,t),r=pt.fromHtml('<span data-mce-bogus="all">\ufeff</span>');return Kt(n.element,r),rd(r,(function(){return Zt(r)}))},id=function(e,t,n,r){ld(e,(function(o,i){return cd(e,t,n,r)}),n)},ad=function(e,t,n,r,o){var i={elm:r.element.dom,alignToTop:o};(function(e,t){return e.fire("ScrollIntoView",t).isDefaultPrevented()})(e,i)||(n(t,cn(t).top,r,o),function(e,t){e.fire("AfterScrollIntoView",t)}(e,i))},cd=function(e,t,n,r){var o=pt.fromDom(e.getBody()),i=pt.fromDom(e.getDoc());o.dom.offsetWidth;var a=od(pt.fromDom(n.startContainer),n.startOffset);ad(e,i,t,a,r),a.cleanup()},ud=function(e,t,n,r){var o=pt.fromDom(e.getDoc());ad(e,o,n,function(e){return rd(pt.fromDom(e),s)}(t),r)},ld=function(e,t,n){var r=n.startContainer,o=n.startOffset,i=n.endContainer,a=n.endOffset;t(pt.fromDom(r),pt.fromDom(i));var c=e.dom.createRng();c.setStart(r,o),c.setEnd(i,a),e.selection.setRng(n)},sd=function(e,t,n,r){var o=e.pos;if(n)un(o.left,o.top,r);else{var i=o.top-t+e.height;un(o.left,i,r)}},fd=function(e,t,n,r,o){var i=n+t,a=r.pos.top,c=r.bottom,u=c-a>=n;if(a<t)sd(r,n,!1!==o,e);else if(a>i){sd(r,n,u?!1!==o:!0===o,e)}else c>i&&!u&&sd(r,n,!0===o,e)},dd=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;fd(e,t,o,n,r)},md=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;fd(e,t,o,n,r);var i=td(n.element),a=fn(window);i.top<a.y?ln(n.element,!1!==r):i.top>a.bottom&&ln(n.element,!0===r)},pd=function(e,t,n){return id(e,dd,t,n)},gd=function(e,t,n){return ud(e,t,dd,n)},hd=function(e,t,n){return id(e,md,t,n)},vd=function(e,t,n){return ud(e,t,md,n)},bd=function(e,t,n){(e.inline?pd:hd)(e,t,n)},yd=function(e){var t=Wt(e).dom;return e.dom===t.activeElement},wd=function(e){return void 0===e&&(e=pt.fromDom(document)),k.from(e.dom.activeElement).map(pt.fromDom)},Cd=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},xd=ar([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),kd=(xd.before,xd.on,xd.after,function(e){return e.fold(m,m,m)}),Sd=ar([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Td={domRange:Sd.domRange,relative:Sd.relative,exact:Sd.exact,exactFromRange:function(e){return Sd.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=function(e){return e.match({domRange:function(e){return pt.fromDom(e.startContainer)},relative:function(e,t){return kd(e)},exact:function(e,t,n,r){return e}})}(e);return Rt(t)},range:Cd},Ed=Qe().browser,_d=function(e,t){var n=Tt(t)?xf(t).length:Mt(t).length+1;return e>n?n:e<0?0:e},Ad=function(e){return Td.range(e.start,_d(e.soffset,e.start),e.finish,_d(e.foffset,e.finish))},Nd=function(e,t){return!mn(t.dom)&&(wt(e,t)||bt(e,t))},Rd=function(e){return function(t){return Nd(e,t.start)&&Nd(e,t.finish)}},Od=function(e){return!0===e.inline||Ed.isIE()},Dd=function(e){return Td.range(pt.fromDom(e.startContainer),e.startOffset,pt.fromDom(e.endContainer),e.endOffset)},Id=function(e){return function(e){var t=e.getSelection();return(t&&0!==t.rangeCount?k.from(t.getRangeAt(0)):k.none()).map(Dd)}(Rt(e).dom).filter(Rd(e))},Pd=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),k.some(t)}catch(e){return k.none()}},Bd=function(e){var t=Od(e)?Id(pt.fromDom(e.getBody())):k.none();e.bookmark=t.isSome()?t:e.bookmark},Md=function(e){return(e.bookmark?e.bookmark:k.none()).bind((function(t){return function(e,t){return k.from(t).filter(Rd(e)).map(Ad)}(pt.fromDom(e.getBody()),t)})).bind(Pd)},Ld={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Fd=function(e,t){Qe().browser.isIE()?function(e){e.on("focusout",(function(){Bd(e)}))}(e):function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))}(e,t),e.on("keyup NodeChange",(function(t){(function(e){return"nodechange"===e.type&&e.selectionChange})(t)||Bd(e)}))},jd=function(e){var t=ic((function(){Bd(e)}),0);e.on("init",(function(){e.inline&&function(e,t){var n=function(){t.throttle()};Ka.DOM.bind(document,"mouseup",n),e.on("remove",(function(){Ka.DOM.unbind(document,"mouseup",n)}))}(e,t),Fd(e,t)})),e.on("remove",(function(){t.cancel()}))},Hd=Ka.DOM,Ud=function(e,t){var n=function(e){return e.getParam("custom_ui_selector","","string")}(e);return null!==Hd.getParent(t,(function(t){return function(e){return Ld.isEditorUIElement(e)}(t)||!!n&&e.dom.is(t,n)}))},zd=function(e,t){var n=t.editor;jd(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==this&&(t&&t.fire("blur",{focusedEditor:this}),e.setActive(this),e.focusedEditor=this,this.fire("focus",{blurredEditor:t}),this.focus(!0))})),n.on("focusout",(function(){var t=this;wr.setEditorTimeout(t,(function(){var n=e.focusedEditor;Ud(t,function(e){try{var t=Wt(pt.fromDom(e.getElement()));return wd(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(e){return document.body}}(t))||n!==t||(t.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),Yf||(Yf=function(t){var n=e.activeEditor;n&&function(e){if(zt()&&P(e.target)){var t=pt.fromDom(e.target);if(St(t)&&$t(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ne(n)}}return k.from(e.target)}(t).each((function(t){t.ownerDocument===document&&(t===document.body||Ud(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))}))},Hd.bind(document,"focusin",Yf))},Wd=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Hd.unbind(document,"focusin",Yf),Yf=null)},qd=function(e,t){return function(e){return e.collapsed?k.from(Hc(e.startContainer,e.startOffset)).map(pt.fromDom):k.none()}(t).bind((function(t){return Pr(t)?k.some(t):!1===wt(e,t)?k.some(e):k.none()}))},Vd=function(e,t){qd(pt.fromDom(e.getBody()),t).bind((function(e){return ms(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},$d=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},Kd=function(e){return yd(e)||(t=e,wd(Wt(t)).filter((function(e){return t.dom.contains(e.dom)}))).isSome();var t},Jd=function(e){return e.inline?function(e){var t=e.getBody();return t&&Kd(pt.fromDom(t))}(e):function(e){return e.iframeElement&&yd(pt.fromDom(e.iframeElement))}(e)},Gd=function(e){return Jd(e)||function(e){return wd().filter((function(t){return n=t.dom,!(void 0!==(r=n.classList)&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body")))&&Ud(e,t.dom);var n,r})).isSome()}(e)},Xd=function(e){return e.editorManager.setActive(e)},Yd=function(e,t){e.removed||(t?Xd(e):function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===Jd(e)&&Md(e).each((function(t){e.selection.setRng(t),r=t}));var o=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))}(e,t.getNode());if(e.$.contains(n,o))return $d(o),Vd(e,r),void Xd(e);e.inline||(ct.opera||$d(n),e.getWin().focus()),(ct.gecko||e.inline)&&($d(n),Vd(e,r)),Xd(e)}(e))},Qd=function(e,t,n,r,o){var i=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return k.from(i).map(pt.fromDom).map((function(e){return r&&t.collapsed?e:Lt(e,o(e,a)).getOr(e)})).bind((function(e){return St(e)?k.some(e):Ot(e).filter(St)})).map((function(e){return e.dom})).getOr(e)},Zd=function(e,t,n){return Qd(e,t,!0,n,(function(e,t){return Math.min(e.dom.childNodes.length,t)}))},em=function(e,t,n){return Qd(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},tm=function(e,t){for(var n=e;e&&xn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},nm=function(e,t){return W(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},rm=function(e){return B(e)?e:b},om=function(e,t,n){var r=t(e),o=rm(n);return r.orThunk((function(){return o(e)?k.none():function(e,t,n){for(var r=e.dom,o=rm(n);r.parentNode;){r=r.parentNode;var i=pt.fromDom(r),a=t(i);if(a.isSome())return a;if(o(i))break}return k.none()}(e,t,o)}))},im=Ls,am=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++)if(!1===r[o].inherit&&e.dom.is(t,r[o].selector))return!0;return!1},cm=function(e,t,n,r){var o=e.dom.getRoot();return t!==o&&(t=e.dom.getParent(t,(function(t){return!!am(e,t,n)||(t.parentNode===o||!!sm(e,t,n,r,!0))})),sm(e,t,n,r))},um=function(e,t,n){return!!im(t,n.inline)||(!!im(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))},lm=function(e,t,n,r,o,i){var a,c,u,l=n[r];if(n.onmatch)return n.onmatch(t,n,r);if(l)if(void 0===l.length){for(a in l)if(l.hasOwnProperty(a)){if(c="attributes"===r?e.getAttrib(t,a):js(e,t,a),o&&!c&&!n.exact)return;if((!o||n.exact)&&!im(c,Fs(e,Ms(l[a],i),a)))return}}else for(u=0;u<l.length;u++)if("attributes"===r?e.getAttrib(t,l[u]):js(e,t,l[u]))return n;return n},sm=function(e,t,n,r,o){var i,a,c,u,l=e.formatter.get(n),s=e.dom;if(l&&t)for(a=0;a<l.length;a++)if(i=l[a],um(e.dom,t,i)&&lm(s,t,i,"attributes",o,r)&&lm(s,t,i,"styles",o,r)){if(u=i.classes)for(c=0;c<u.length;c++)if(!e.dom.hasClass(t,u[c]))return;return i}},fm=function(e,t,n,r){if(r)return cm(e,r,t,n);if(r=e.selection.getNode(),cm(e,r,t,n))return!0;var o=e.selection.getStart();return!(o===r||!cm(e,o,t,n))},dm=function(e,t){var n=function(t){return bt(t,pt.fromDom(e.getBody()))};return k.from(e.selection.getStart(!0)).bind((function(r){return om(pt.fromDom(r),(function(n){return function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return k.none()}(t,(function(t){return function(t,n){return sm(e,t.dom,n)?k.some(n):k.none()}(n,t)}))}),n)})).getOrNull()},mm=function(e,t,n){return J(n,(function(n,r){var o=function(e,t){return z(e.formatter.get(t),(function(e){var t=function(e){return e.length>1&&"%"===e.charAt(0)};return z(["styles","attributes"],(function(n){return ge(e,n).exists((function(e){var n=N(e)?e:pe(e);return z(n,t)}))}))}))}(e,r);return e.formatter.matchNode(t,r,{},o)?n.concat([r]):n}),[])},pm={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},gm=function(e,t,n){var r=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[r])return e[r];if(e!==t){var i=e[o];if(i)return i;for(var a=e.parent;a&&a!==t;a=a.parent)if(i=a[o])return i}},hm=function(e){if(!lo(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},vm=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},bm=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r=new e(t,pm[t]||1);return n&&ce(n,(function(e,t){r.attr(t,e)})),r},e.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},e.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&ce(e,(function(e,t){r.attr(t,e)})),r;if(n=r.attributes){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];for(var o=n.length;o--;)if(n[o].name===e)return n.splice(o,1),r}return r}if(e in n.map){for(o=n.length;o--;)if(n[o].name===e){n[o].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}},e.prototype.clone=function(){var t,n=new e(this.name,this.type);if(t=this.attributes){var r=[];r.map={};for(var o=0,i=t.length;o<i;o++){var a=t[o];"id"!==a.name&&(r[r.length]={name:a.name,value:a.value},r.map[a.name]=a.value)}n.attributes=r}return n.value=this.value,n.shortEnded=this.shortEnded,n},e.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},e.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},e.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n.next=t,e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t.prev=n,this.parent=this.next=this.prev=null),this},e.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},e.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=gm(n,this))n.name===e&&t.push(n);return t},e.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=gm(t,this))e.push(t);for(var n=e.length;n--;){(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}}return this.firstChild=this.lastChild=null,this},e.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(vm(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(vm(r))return!1}if(8===r.type)return!1;if(3===r.type&&!hm(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&lo(r.value))return!1;if(n&&n(r))return!1}while(r=gm(r,this));return!0},e.prototype.walk=function(e){return gm(this,null,e)},e}(),ym=dt.makeMap,wm=function(e){var t=[],n=(e=e||{}).indent,r=ym(e.indent_before||""),o=ym(e.indent_after||""),i=Po.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="html"===e.element_format;return{start:function(e,c,u){var l,s,f,d;if(n&&r[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n"),t.push("<",e),c)for(l=0,s=c.length;l<s;l++)f=c[l],t.push(" ",f.name,'="',i(f.value,!0),'"');t[t.length]=!u||a?">":" />",u&&n&&o[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n")},end:function(e){var r;t.push("</",e,">"),n&&o[e]&&t.length>0&&(r=t[t.length-1]).length>0&&"\n"!==r&&t.push("\n")},text:function(e,n){e.length>0&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",i(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},Cm=function(e,t){void 0===t&&(t=qo());var n=wm(e);(e=e||{}).validate=!("validate"in e)||e.validate;return{serialize:function(r){var o=e.validate,i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{a(e)}while(e=e.next)}};n.reset();var a=function(e){var r,c,u,l,s,f,d,m,p,g=i[e.type];if(g)g(e);else{if(r=e.name,c=e.shortEnded,u=e.attributes,o&&u&&u.length>1&&((f=[]).map={},p=t.getElementRule(e.name))){for(d=0,m=p.attributesOrder.length;d<m;d++)(l=p.attributesOrder[d])in u.map&&(s=u.map[l],f.map[l]=s,f.push({name:l,value:s}));for(d=0,m=u.length;d<m;d++)(l=u[d].name)in f.map||(s=u.map[l],f.map[l]=s,f.push({name:l,value:s}));u=f}if(n.start(e.name,u,c),!c){if(e=e.firstChild)do{a(e)}while(e=e.next);n.end(r)}}};return 1!==r.type||e.inner?i[11](r):a(r),n.getContent()}}},xm=function(e,t){return e.replace(new RegExp(t.prefix+"_[0-9]+","g"),(function(e){return ge(t.uris,e).getOr(e)}))},km=["img","video"],Sm=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?function(e,t){return!(I(e)?U(km,t):e)}(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},Tm=function(e,t,n){var r,o,i=1,a=e.getShortEndedElements(),c=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;for(c.lastIndex=r=n;o=c.exec(t);){if(r=c.lastIndex,"/"===o[1])i--;else if(!o[1]){if(o[2]in a)continue;i++}if(0===i)break}return r},Em=function(e,t){var n=e.exec(t);if(n){var r=n[1],o=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?o:null}return null};function _m(e,t){void 0===t&&(t=qo());var n=function(){};!1!==(e=e||{}).fix_self_closing&&(e.fix_self_closing=!0);var r=e.comment?e.comment:n,o=e.cdata?e.cdata:n,i=e.text?e.text:n,a=e.start?e.start:n,c=e.end?e.end:n,u=e.pi?e.pi:n,l=e.doctype?e.doctype:n,s=function(n,s){void 0===s&&(s="html");for(var f,d,m,p,g,h,v,b,y,w,C,x,k,S,T,E,_,A,N,R=n.html,O=0,D=[],I=0,P=Po.decode,B=dt.makeMap("src,href,data,background,formaction,poster,xlink:href"),M=/((java|vb)script|mhtml):/i,L="html"===s?0:1,F=function(e){var t,n;for(t=D.length;t--&&D[t].name!==e;);if(t>=0){for(n=D.length-1;n>=t;n--)(e=D[n]).valid&&c(e.name);D.length=t}},j=function(e,t){return i(xm(e,n),t)},H=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),r(xm(t,n)))},U=function(e,t){var n=e||"",r=!Be(n,"--"),o=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))}(r,n)){var o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(t){var i=r.indexOf(">",n);return-1!==i?i:r.length}var a=/--!?>/;a.lastIndex=n;var c=a.exec(e);return c?c.index+c[0].length:r.length}(R,r,t);return e=R.substr(t,o-t),H(r?n+e:e),o+1},z=function(t,r,o,i,a){var c,u;if(o=function(e){return ge(n.uris,e).getOr(e)}((r=r.toLowerCase())in K?r:P(o||i||a||"")),J&&!b&&!1===function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")}(r)){if(!(c=S[r])&&T){for(u=T.length;u--&&!(c=T[u]).pattern.test(r););-1===u&&(c=null)}if(!c)return;if(c.validValues&&!(o in c.validValues))return}if(B[r]&&!e.allow_script_urls){var l=o.replace(/[\s\u0000-\u001F]+/g,"");try{l=decodeURIComponent(l)}catch(e){l=unescape(l)}if(M.test(l))return;if(Sm(e,l,t))return}b&&(r in B||0===r.indexOf("on"))||(p.map[r]=o,p.push({name:r,value:o}))},W=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),q=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,V=t.getShortEndedElements(),$=e.self_closing_elements||t.getSelfClosingElements(),K=t.getBoolAttrs(),J=e.validate,G=e.remove_internals,X=e.fix_self_closing,Y=t.getSpecialElements(),Q=R+">";f=W.exec(Q);){var Z=f[0];if(O<f.index&&j(P(R.substr(O,f.index-O))),d=f[7])":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),F(d);else if(d=f[8]){if(f.index+Z.length>R.length){j(P(R.substr(f.index))),O=f.index+Z.length;continue}":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),y=d in V,X&&$[d]&&D.length>0&&D[D.length-1].name===d&&F(d);var ee=Em(q,f[9]);if(null!==ee){if("all"===ee){O=Tm(t,R,W.lastIndex),W.lastIndex=O;continue}C=!1}if(!J||(w=t.getElementRule(d))){if(C=!0,J&&(S=w.attributes,T=w.attributePatterns),(k=f[9])?((b=-1!==k.indexOf("data-mce-type"))&&G&&(C=!1),(p=[]).map={},k.replace(q,(function(e,t,n,r,o){return z(d,t,n,r,o),""}))):(p=[]).map={},J&&!b){if(E=w.attributesRequired,_=w.attributesDefault,A=w.attributesForced,w.removeEmptyAttrs&&!p.length&&(C=!1),A)for(g=A.length;g--;)v=(x=A[g]).name,"{$uid}"===(N=x.value)&&(N="mce_"+I++),p.map[v]=N,p.push({name:v,value:N});if(_)for(g=_.length;g--;)(v=(x=_[g]).name)in p.map||("{$uid}"===(N=x.value)&&(N="mce_"+I++),p.map[v]=N,p.push({name:v,value:N}));if(E){for(g=E.length;g--&&!(E[g]in p.map););-1===g&&(C=!1)}if(x=p.map["data-mce-bogus"]){if("all"===x){O=Tm(t,R,W.lastIndex),W.lastIndex=O;continue}C=!1}}C&&a(d,p,y)}else C=!1;if(m=Y[d]){m.lastIndex=O=f.index+Z.length,(f=m.exec(R))?(C&&(h=R.substr(O,f.index-O)),O=f.index+f[0].length):(h=R.substr(O),O=R.length),C&&(h.length>0&&j(h,!0),c(d)),W.lastIndex=O;continue}y||(k&&k.indexOf("/")===k.length-1?C&&c(d):D.push({name:d,valid:C}))}else if(d=f[1])H(d);else if(d=f[2]){if(!(1===L||e.preserve_cdata||D.length>0&&t.isValidChild(D[D.length-1].name,"#cdata"))){O=U("",f.index+2),W.lastIndex=O;continue}o(d)}else if(d=f[3])l(d);else{if((d=f[4])||"<!"===Z){O=U(d,f.index+Z.length),W.lastIndex=O;continue}if(d=f[5]){if(1!==L){O=U("?",f.index+2),W.lastIndex=O;continue}u(d,f[6])}}O=f.index+Z.length}for(O<R.length&&j(P(R.substr(O))),g=D.length-1;g>=0;g--)(d=D[g]).valid&&c(d.name)};return{parse:function(e,t){void 0===t&&(t="html"),s(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,r=[],o={},i=Sc("img"),a=0,c=0;t=n.exec(e);){var u=t[0],l=i+"_"+c++;o[l]=u,a<t.index&&r.push(e.substr(a,t.index-a)),r.push(l),a=t.index+u.length}return 0===a?{prefix:i,uris:o,html:e}:(a<e.length&&r.push(e.substr(a)),{prefix:i,uris:o,html:r.join("")})}(e),t)}}}!function(e){e.findEndTag=Tm}(_m||(_m={}));var Am=_m,Nm=function(e,t){var n,r,o,i,a=t,c=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,u=e.schema;a=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")}(e.getTempAttrs(),a);for(var l=u.getShortEndedElements();i=c.exec(a);)r=c.lastIndex,o=i[0].length,n=l[i[1]]?r:Am.findEndTag(u,a,r),a=a.substring(0,r-o)+a.substring(n),c.lastIndex=r-o;return Fr(a)},Rm=Nm,Om=function(e,t,n,r){var o;return t.format=n,t.get=!0,t.getInner=!0,t.no_events||e.fire("BeforeGetContent",t),o="raw"===t.format?dt.trim(Rm(e.serializer,r.innerHTML)):"text"===t.format?e.dom.isEmpty(r)?"":Fr(r.innerText||r.textContent):"tree"===t.format?e.serializer.serialize(r,t):function(e,t){var n=Bu(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")}(e,e.serializer.serialize(r,t)),U(["text","tree"],t.format)||Mr(pt.fromDom(r))?t.content=o:t.content=dt.trim(o),t.no_events||e.fire("GetContent",t),t.content},Dm=dt.each,Im=function(e){this.compare=function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Dm(e.getAttribs(t),(function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))})),n},o=function(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return!1;return!0};return!!o(r(t),r(n))&&(!!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!Es(t)&&!Es(n)))}},Pm=function(e,t,n){return k.from(n.container()).filter(xn).exists((function(r){var o=e?0:-1;return t(r.data.charAt(n.offset()+o))}))},Bm=p(Pm,!0,As),Mm=p(Pm,!1,As),Lm=function(e){var t=e.container();return xn(t)&&(0===t.data.length||Lr(t.data)&&Nf.isBookmarkNode(t.parentNode))},Fm=function(e,t){return function(n){return k.from(Il(e?0:-1,n)).filter(t).isSome()}},jm=function(e){return _n(e)&&"block"===Hn(pt.fromDom(e),"display")},Hm=function(e){return Nn(e)&&!function(e){return pn(e)&&"all"===e.getAttribute("data-mce-bogus")}(e)},Um=Fm(!0,jm),zm=Fm(!1,jm),Wm=Fm(!0,On),qm=Fm(!1,On),Vm=Fm(!0,yn),$m=Fm(!1,yn),Km=Fm(!0,Hm),Jm=Fm(!1,Hm),Gm=function(e){var t=gc(e,"br"),n=$(function(e){for(var t=[],n=e.dom;n;)t.push(pt.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),Rr);t.length===n.length&&q(n,Zt)},Xm=function(e){Qt(e),Xt(e,pt.fromHtml('<br data-mce-bogus="1">'))},Ym=function(e){jt(e).each((function(t){Dt(t).each((function(n){Ar(e)&&Rr(t)&&Ar(n)&&Zt(t)}))}))},Qm=function(e,t,n){return wt(t,e)?function(e,t){for(var n=B(t)?t:b,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=pt.fromDom(i);if(o.push(a),!0===n(a))break;r=i}return o}(e,(function(e){return n(e)||bt(e,t)})).slice(0,-1):[]},Zm=function(e,t){return Qm(e,t,b)},ep=function(e,t){return[e].concat(Zm(e,t))},tp=function(e,t,n){return ls(e,t,n,Lm)},np=function(e,t){return G(ep(pt.fromDom(t.container()),e),Ar)},rp=function(e,t,n){return tp(e,t.dom,n).forall((function(e){return np(t,n).fold((function(){return!1===Dl(e,n,t.dom)}),(function(r){return!1===Dl(e,n,t.dom)&&wt(r,pt.fromDom(e.container()))}))}))},op=function(e,t,n){return np(t,n).fold((function(){return tp(e,t.dom,n).forall((function(e){return!1===Dl(e,n,t.dom)}))}),(function(t){return tp(e,t.dom,n).isNone()}))},ip=p(op,!1),ap=p(op,!0),cp=p(rp,!1),up=p(rp,!0),lp=function(e){return zl(e).exists(Rr)},sp=function(e,t,n){var r=$(ep(pt.fromDom(n.container()),t),Ar),o=ne(r).getOr(t);return cs(e,o.dom,n).filter(lp)},fp=function(e,t){return zl(t).exists(Rr)||sp(!0,e,t).isSome()},dp=function(e,t){return function(e){return k.from(e.getNode(!0)).map(pt.fromDom)}(t).exists(Rr)||sp(!1,e,t).isSome()},mp=p(sp,!1),pp=p(sp,!0),gp=function(e){return cu.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},hp=function(e,t){var n=$(ep(pt.fromDom(t.container()),e),Ar);return ne(n).getOr(e)},vp=function(e,t){return gp(t)?Mm(t):Mm(t)||ds(hp(e,t).dom,t).exists(Mm)},bp=function(e,t){return gp(t)?Bm(t):Bm(t)||fs(hp(e,t).dom,t).exists(Bm)},yp=function(e){return zl(e).bind((function(e){return fr(e,St)})).exists((function(e){return function(e){return U(["pre","pre-wrap"],e)}(Hn(e,"white-space"))}))},wp=function(e,t){return function(e,t){return ds(e.dom,t).isNone()}(e,t)||function(e,t){return fs(e.dom,t).isNone()}(e,t)||ip(e,t)||ap(e,t)||dp(e,t)||fp(e,t)},Cp=function(e,t){return!yp(t)&&(ip(e,t)||cp(e,t)||dp(e,t)||vp(e,t))},xp=function(e,t){return!yp(t)&&(ap(e,t)||up(e,t)||fp(e,t)||bp(e,t))},kp=function(e,t){return Cp(e,t)||xp(e,function(e){var t=e.container(),n=e.offset();return xn(t)&&n<t.data.length?cu(t,n+1):e}(t))},Sp=function(e,t){return _s(e.charAt(t))},Tp=function(e){var t=e.container();return xn(t)&&Pe(t.data,"")},Ep=function(e){var t=e.data,n=function(e){var t=e.split("");return W(t,(function(e,n){return _s(e)&&n>0&&n<t.length-1&&Ns(t[n-1])&&Ns(t[n+1])?" ":e})).join("")}(t);return n!==t&&(e.data=n,!0)},_p=function(e,t){return k.some(t).filter(Tp).bind((function(t){var n=t.container();return function(e,t){var n=t.data,r=cu(t,0);return!(!Sp(n,0)||kp(e,r))&&(t.data=" "+n.slice(1),!0)}(e,n)||Ep(n)||function(e,t){var n=t.data,r=cu(t,n.length-1);return!(!Sp(n,n.length-1)||kp(e,r))&&(t.data=n.slice(0,-1)+" ",!0)}(e,n)?k.some(t):k.none()}))},Ap=function(e){var t=pt.fromDom(e.getBody());e.selection.isCollapsed()&&_p(t,cu.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},Np=function(e,t,n){if(0!==n){var r=pt.fromDom(e),o=sr(r,Ar).getOr(r),i=e.data.slice(t,t+n),a=t+n>=e.data.length&&xp(o,lu(e,e.data.length)),c=0===t&&Cp(o,lu(e,0));e.replaceData(t,n,function(e,t,n){return J(e,(function(r,o){return As(o)||_s(o)?r.previousCharIsSpace||""===r.str&&t||r.str.length===e.length-1&&n?{previousCharIsSpace:!1,str:r.str+""}:{previousCharIsSpace:!0,str:r.str+" "}:{previousCharIsSpace:!1,str:r.str+o}}),{previousCharIsSpace:!1,str:""}).str}(i,c,a))}},Rp=function(e,t){var n=e.data.slice(t),r=n.length-Fe(n).length;return Np(e,t,r)},Op=function(e,t){var n=e.data.slice(0,t),r=n.length-je(n).length;return Np(e,t-r,r)},Dp=function(e,t,n,r){void 0===r&&(r=!0);var o=je(e.data).length,i=r?e:t,a=r?t:e;return r?i.appendData(a.data):i.insertData(0,a.data),Zt(pt.fromDom(a)),n&&Rp(i,o),i},Ip=function(e,t){return function(e,t){var n=e.container(),r=e.offset();return!1===lu.isTextPosition(e)&&n===t.parentNode&&r>lu.before(t).offset()}(t,e)?lu(t.container(),t.offset()-1):t},Pp=function(e){return io(e.previousSibling)?k.some((t=e.previousSibling,xn(t)?lu(t,t.data.length):lu.after(t))):e.previousSibling?ps(e.previousSibling):k.none();var t},Bp=function(e){return io(e.nextSibling)?k.some((t=e.nextSibling,xn(t)?lu(t,0):lu.before(t))):e.nextSibling?ms(e.nextSibling):k.none();var t},Mp=function(e,t){return Pp(t).orThunk((function(){return Bp(t)})).orThunk((function(){return function(e,t){var n=lu.before(t.previousSibling?t.previousSibling:t.parentNode);return ds(e,n).fold((function(){return fs(e,lu.after(t))}),k.some)}(e,t)}))},Lp=function(e,t){return Bp(t).orThunk((function(){return Pp(t)})).orThunk((function(){return function(e,t){return fs(e,lu.after(t)).fold((function(){return ds(e,lu.before(t))}),k.some)}(e,t)}))},Fp=function(e,t,n){return function(e,t,n){return e?Lp(t,n):Mp(t,n)}(e,t,n).map(p(Ip,n))},jp=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},Hp=function(e,t){return t&&he(e.schema.getBlockElements(),Ct(t))},Up=function(e){if(ho(e)){var t=pt.fromHtml('<br data-mce-bogus="1">');return Qt(e),Xt(e,t),k.some(lu.before(t.dom))}return k.none()},zp=function(e,t,n){var r,o,i,a,c=Dt(e).filter(Tt),u=It(e).filter(Tt);return Zt(e),(r=c,o=u,i=t,a=function(e,t,r){var o=e.dom,i=t.dom,a=o.data.length;return Dp(o,i,n),r.container()===i?lu(o,a):r},r.isSome()&&o.isSome()&&i.isSome()?k.some(a(r.getOrDie(),o.getOrDie(),i.getOrDie())):k.none()).orThunk((function(){return n&&(c.each((function(e){return Op(e.dom,e.dom.length)})),u.each((function(e){return Rp(e.dom,0)}))),t}))},Wp=function(e,t,n,r){void 0===r&&(r=!0);var o,i=Fp(t,e.getBody(),n.dom),a=sr(n,p(Hp,e),(o=e.getBody(),function(e){return e.dom===o})),c=zp(n,i,function(e,t){return he(e.schema.getTextInlineElements(),Ct(t))}(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(Up).fold((function(){r&&jp(e,t,c)}),(function(n){r&&jp(e,t,k.some(n))}))},qp=function(e,t){return{start:e,end:t}},Vp=ar([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),$p=function(e,t){return gr(pt.fromDom(e),"td,th",t)},Kp=function(e,t){return mr(e,"table",t)},Jp=function(e){return!bt(e.start,e.end)},Gp=function(e,t){return Kp(e.start,t).bind((function(n){return Kp(e.end,t).bind((function(e){return t=bt(n,e),r=n,t?k.some(r):k.none();var t,r}))}))},Xp=function(e){return gc(e,"td,th")},Yp=function(e,t){var n=$p(t.startContainer,e),r=$p(t.endContainer,e);return t.collapsed?k.none():Oc(n,r,qp).fold((function(){return n.fold((function(){return r.bind((function(t){return Kp(t,e).bind((function(e){return ne(Xp(e)).map((function(e){return qp(e,t)}))}))}))}),(function(t){return Kp(t,e).bind((function(e){return re(Xp(e)).map((function(e){return qp(t,e)}))}))}))}),(function(t){return Qp(e,t)?k.none():function(e,t){return Kp(e.start,t).bind((function(t){return re(Xp(t)).map((function(t){return qp(e.start,t)}))}))}(t,e)}))},Qp=function(e,t){return Gp(t,e).isSome()},Zp=function(e,t,n){return e.filter((function(e){return Jp(e)&&Qp(n,e)})).orThunk((function(){return Yp(n,t)})).bind((function(e){return function(e,t){return Gp(e,t).map((function(t){return function(e,t,n){return{rng:e,table:t,cells:n}}(e,t,Xp(t))}))}(e,n)}))},eg=function(e,t){return X(e,(function(e){return bt(e,t)}))},tg=function(e,t,n){return e.filter((function(e){return function(e,t){return!Jp(e)&&Gp(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))}(e,n)&&hf(e.start,t)})).map((function(e){return e.start}))},ng=function(e){return function(e){return Oc(eg(e.cells,e.rng.start),eg(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))}(e).map((function(t){var n=e.cells;return t.length===n.length?Vp.removeTable(e.table):Vp.emptyCells(t)}))},rg=function(e,t){var n=function(e){return function(t){return bt(e,t)}}(e),r=function(e,t){var n=$p(e.startContainer,t),r=$p(e.endContainer,t);return Oc(n,r,qp)}(t,n);return tg(r,t,n).map((function(e){return Vp.deleteCellSelection(t,e)})).orThunk((function(){return Zp(r,t,n).bind(ng)}))},og=function(e){var t;return(8===xt(t=e)||"#comment"===Ct(t)?Dt(e):jt(e)).bind(og).orThunk((function(){return k.some(e)}))},ig=function(e,t){return q(t,Xm),e.selection.setCursorLocation(t[0].dom,0),!0},ag=function(e,t,n){t.deleteContents();var r,o=og(n).getOr(n),i=pt.fromDom(e.dom.getParent(o.dom,e.dom.isBlock));if(ho(i)&&(Xm(i),e.selection.setCursorLocation(i.dom,0)),!bt(n,i)){var a=Ot(i).is(n)?[]:Ot(r=i).map(Mt).map((function(e){return $(e,(function(e){return!bt(r,e)}))})).getOr([]);q(a.concat(Mt(n)),(function(e){bt(e,i)||wt(e,i)||Zt(e)}))}return!0},cg=function(e,t){return Wp(e,!1,t),!0},ug=function(e,t,n,r){return sg(t,r).fold((function(){return function(e,t,n){return rg(t,n).map((function(t){return t.fold(p(cg,e),p(ig,e),p(ag,e))}))}(e,t,n)}),(function(t){return function(e,t){return fg(e,t)}(e,t)})).getOr(!1)},lg=function(e,t){return G(ep(t,e),Br)},sg=function(e,t){return G(ep(t,e),(function(e){return"caption"===Ct(e)}))},fg=function(e,t){return Xm(t),e.selection.setCursorLocation(t.dom,0),k.some(!0)},dg=function(e,t,n,r,o){return us(n,e.getBody(),o).bind((function(i){return function(e,t,n,r){return ms(e.dom).bind((function(o){return ps(e.dom).map((function(e){return t?n.isEqual(o)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(o)}))})).getOr(!0)}(r,n,o,i)?function(e,t){return fg(e,t)}(e,r):function(e,t,n){return sg(e,pt.fromDom(n.getNode())).map((function(e){return!1===bt(e,t)}))}(t,r,i)})).or(k.some(!0))},mg=function(e,t,n,r){var o=lu.fromRangeStart(e.selection.getRng());return lg(n,r).bind((function(r){return ho(r)?fg(e,r):function(e,t,n,r,o){return us(n,e.getBody(),o).bind((function(e){return lg(t,pt.fromDom(e.getNode())).map((function(e){return!1===bt(e,r)}))}))}(e,n,t,r,o)})).getOr(!1)},pg=function(e,t){return e?Vm(t):$m(t)},gg=function(e,t,n){var r=pt.fromDom(e.getBody());return sg(r,n).fold((function(){return mg(e,t,r,n)||function(e,t){var n=lu.fromRangeStart(e.selection.getRng());return pg(t,n)||cs(t,e.getBody(),n).exists((function(e){return pg(t,e)}))}(e,t)}),(function(n){return function(e,t,n,r){var o=lu.fromRangeStart(e.selection.getRng());return ho(r)?fg(e,r):dg(e,n,t,r,o)}(e,t,r,n).getOr(!1)}))},hg=function(e,t){var n=pt.fromDom(e.selection.getStart(!0)),r=mf(e);return e.selection.isCollapsed()&&0===r.length?gg(e,t,n):function(e,t){var n=pt.fromDom(e.getBody()),r=e.selection.getRng(),o=mf(e);return 0!==o.length?ig(e,o):ug(e,n,r,t)}(e,n)},vg=function(e){var t=lu.fromRangeStart(e),n=lu.fromRangeEnd(e),r=e.commonAncestorContainer;return cs(!1,r,n).map((function(o){return!Dl(t,n,r)&&Dl(t,o,r)?function(e,t,n,r){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,r),o}(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)},bg=function(e){return e.collapsed?e:vg(e)},yg=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&function(e){return""===e.data||En(e)}(e.firstChild)},wg=function(e){return e.length>0&&(!(t=e[e.length-1]).firstChild||yg(t))?e.slice(0,-1):e;var t},Cg=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},xg=function(e,t){var n=lu.after(e),r=ns(t).prev(n);return r?r.toRange():null},kg=function(e,t,n){var r=e.parentNode;return dt.each(t,(function(t){r.insertBefore(t,e)})),function(e,t){var n=lu.before(e),r=ns(t).next(n);return r?r.toRange():null}(e,n)},Sg=function(e,t,n,r){var o,i=function(e,t,n){var r=t.serialize(n);return function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e}(e.createFragment(r))}(t,e,r),a=Cg(t,n.startContainer),c=wg((o=i.firstChild,dt.grep(o.childNodes,(function(e){return"LI"===e.nodeName})))),u=t.getRoot(),l=function(e){var r=lu.fromRangeStart(n),o=ns(t.getRoot()),i=1===e?o.prev(r):o.next(r);return!i||Cg(t,i.getNode())!==a};return l(1)?kg(a,c,u):l(2)?function(e,t,n,r){return r.insertAfter(t.reverse(),e),xg(t[0],n)}(a,c,u,t):function(e,t,n,r){var o=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]}(e,r),i=e.parentNode;return i.insertBefore(o[0],e),dt.each(t,(function(t){i.insertBefore(t,e)})),i.insertBefore(o[1],e),i.removeChild(e),xg(t[t.length-1],n)}(a,c,u,n)},Tg=Rn,Eg=function(e){var t=e.dom,n=bg(e.selection.getRng());e.selection.setRng(n);var r=t.getParent(n.startContainer,Tg);!function(e,t,n){return null!==n&&(n===e.getParent(t.endContainer,Tg)&&hf(pt.fromDom(n),t))}(t,n,r)?e.getDoc().execCommand("Delete",!1,null):ag(e,n,pt.fromDom(r))},_g=function(e,t,n){var r,o,i,a,c,u,l=e.selection,s=e.dom;/^ | $/.test(t)&&(t=function(e,t,n){var r=pt.fromDom(e.getRoot());return n=Cp(r,lu.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=xp(r,lu.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")}(s,l.getRng(),t));var f=e.parser,d=n.merge,m=Cm({validate:Yu(e)},e.schema),p='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';if(i={content:t,format:"html",selection:!0,paste:n.paste},(i=e.fire("BeforeSetContent",i)).isDefaultPrevented())e.fire("SetContent",{content:i.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=i.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,p);var g=(c=l.getRng()).startContainer||(c.parentElement?c.parentElement():null),h=e.getBody();g===h&&l.isCollapsed()&&s.isBlock(h.firstChild)&&function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]}(e,h.firstChild)&&s.isEmpty(h.firstChild)&&((c=s.createRng()).setStart(h.firstChild,0),c.setEnd(h.firstChild,0),l.setRng(c)),l.isCollapsed()||Eg(e);var v,b={context:(r=l.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},y=f.parse(t,b);if(!0===n.paste&&function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||function(e,t){return e.getBlockElements()[t.name]&&function(e){return e.firstChild&&e.firstChild===e.lastChild}(t)&&function(e){return"br"===e.name||""===e.value}(t.firstChild)}(e,t))}(e,r)&&(r=r.prev),!(!n||n!==r)&&("ul"===n.name||"ol"===n.name)}(e.schema,y)&&function(e,t){return!!Cg(e,t)}(s,r))return c=Sg(m,s,l.getRng(),y),l.setRng(c),void e.fire("SetContent",i);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(y),"mce_marker"===(u=y.lastChild).attr("id"))for(a=u,u=u.prev;u;u=u.walk(!0))if(3===u.type||!s.isBlock(u.name)){e.schema.isValidChild(u.parent.name,"span")&&u.parent.insert(a,u,"br"===u.name);break}if(e._selectionOverrides.showBlockCaretContainer(r),b.invalid){for(e.selection.setContent(p),r=l.getNode(),o=e.getBody(),9===r.nodeType?r=u=o:u=r;u!==o;)r=u,u=u.parentNode;t=r===o?o.innerHTML:s.getOuterHTML(r),t=m.serialize(f.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return m.serialize(y)})))),r===o?s.setHTML(o,t):s.setOuterHTML(r,t)}else!function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,o=n.lastChild;!r||r===o&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}}(e,t=m.serialize(y),r);!function(e,t){var n=e.schema.getTextInlineElements(),r=e.dom;if(t){var o=e.getBody(),i=new Im(r);dt.each(r.select("*[data-mce-fragment]"),(function(e){for(var t=e.parentNode;t&&t!==o;t=t.parentNode)n[e.nodeName.toLowerCase()]&&i.compare(t,e)&&r.remove(e,!0)}))}}(e,d),function(e,t){var n,r,o=e.dom,i=e.selection;if(t){i.scrollIntoView(t);var a=function(t){for(var n=e.getBody();t&&t!==n;t=t.parentNode)if("false"===o.getContentEditable(t))return t;return null}(t);if(a)return o.remove(t),void i.select(a);var c=o.createRng(),u=t.previousSibling;u&&3===u.nodeType?(c.setStart(u,u.nodeValue.length),ct.ie||(r=t.nextSibling)&&3===r.nodeType&&(u.appendData(r.data),r.parentNode.removeChild(r))):(c.setStartBefore(t),c.setEndBefore(t));var l=o.getParent(t,o.isBlock);o.remove(t),l&&o.isEmpty(l)&&(e.$(l).empty(),c.setStart(l,0),c.setEnd(l,0),Tg(l)||function(e){return!!e.getAttribute("data-mce-fragment")}(l)||!(n=function(t){var n=lu.fromRangeStart(t);if(n=ns(e.getBody()).next(n))return n.toRange()}(c))?o.add(l,o.create("br",{"data-mce-bogus":"1"})):(c=n,o.remove(l))),i.setRng(c)}}(e,s.get("mce_marker")),v=e.getBody(),dt.each(v.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),function(e,t){k.from(e.getParent(t,"td,th")).map(pt.fromDom).each(Ym)}(s,l.getStart()),e.fire("SetContent",i),e.addVisual()}},Ag=function(e,t){t(e),e.firstChild&&Ag(e.firstChild,t),e.next&&Ag(e.next,t)},Ng=function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var a in n.firstChild&&Ag(n.firstChild,(function(n){q(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),q(t,(function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))})),r)r.hasOwnProperty(a)&&i.push(r[a]);for(var c in o)o.hasOwnProperty(c)&&i.push(o[c]);return i}(e,t,n);q(r,(function(e){q(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},Rg=function(e){return e instanceof bm},Og=function(e,t){e.dom.setHTML(e.getBody(),t),function(e){Jd(e)&&ms(e.getBody()).each((function(t){var n=t.getNode(),r=yn(n)?ms(n).getOr(t):t;e.selection.setRng(r.toRange())}))}(e)},Dg=function(e,t,n){return n.format=n.format?n.format:"html",n.set=!0,n.content=Rg(t)?"":t,n.no_events||e.fire("BeforeSetContent",n),Rg(t)||(t=n.content),k.from(e.getBody()).fold(d(t),(function(r){return Rg(t)?function(e,t,n,r){Ng(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=Cm({validate:e.validate},e.schema).serialize(n);return r.content=Mr(pt.fromDom(t))?o:dt.trim(o),Og(e,r.content),r.no_events||e.fire("SetContent",r),n}(e,r,t,n):function(e,t,n,r){var o,i;return 0===n.length||/^\s+$/.test(n)?(i='<br data-mce-bogus="1">',"TABLE"===t.nodeName?n="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+i+"</li>"),(o=Bu(e))&&e.schema.isValidChild(t.nodeName.toLowerCase(),o.toLowerCase())?(n=i,n=e.dom.createHTML(o,Mu(e),n)):n||(n='<br data-mce-bogus="1">'),Og(e,n),e.fire("SetContent",r)):("raw"!==r.format&&(n=Cm({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=Mr(pt.fromDom(t))?n:dt.trim(n),Og(e,r.content),r.no_events||e.fire("SetContent",r)),r.content}(e,r,t,n)}))},Ig=function(e,t){return function(e,t){var n=e.dom;return n.parentNode?dr(pt.fromDom(n.parentNode),(function(n){return!bt(e,n)&&t(n)})):k.none()}(e,t).isSome()},Pg=function(e){return function(e){for(var t=[];e;){if(3===e.nodeType&&"\ufeff"!==e.nodeValue||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length>0},Bg=function(e){if(e){var t=new Tr(e,e);for(e=t.current();e;e=t.next())if(xn(e))return e}return null},Mg=function(e){var t=pt.fromTag("span");return Bn(t,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Xt(t,pt.fromText("\ufeff")),t},Lg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(Pg(t))Wp(e,!1,pt.fromDom(t),n);else{var i=o.getRng(),a=r.getParent(t,r.isBlock),c=i.startContainer,u=i.startOffset,l=i.endContainer,s=i.endOffset,f=function(e){var t=Bg(e);return t&&"\ufeff"===t.nodeValue.charAt(0)&&t.deleteData(0,1),t}(t);r.remove(t,!0),c===f&&u>0&&i.setStart(f,u-1),l===f&&s>0&&i.setEnd(f,s-1),a&&r.isEmpty(a)&&Xm(pt.fromDom(a)),o.setRng(i)}},Fg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(t)Lg(e,t,n);else if(!(t=hs(e.getBody(),o.getStart())))for(;t=r.get("_mce_caret");)Lg(e,t,!1)},jg=function(e,t){return e.appendChild(t),t},Hg=function(e,t){var n=K(e,(function(e,t){return jg(e,t.cloneNode(!1))}),t);return jg(n,n.ownerDocument.createTextNode("\ufeff"))},Ug=function(e,t,n,r){var o,i,a,c=e.dom,u=e.selection,l=[],s=u.getRng(),f=s.startContainer,d=s.startOffset;for(i=f,3===f.nodeType&&(d!==f.nodeValue.length&&(o=!0),i=i.parentNode);i;){if(sm(e,i,t,n,r)){a=i;break}i.nextSibling&&(o=!0),l.push(i),i=i.parentNode}if(a)if(o){var m=u.getBookmark();s.collapse(!0);var g=cf(e,s,e.formatter.get(t),!0);g=Jf(g),e.formatter.remove(t,n,g,r),u.moveToBookmark(m)}else{var h=hs(e.getBody(),a),v=Mg(!1).dom;!function(e,t,n){var r=e.dom,o=r.getParent(n,p(Is,e));o&&r.isEmpty(o)?n.parentNode.replaceChild(t,n):(Gm(pt.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))}(e,v,null!==h?h:a);var b=function(e,t,n,r,o,i){var a=e.formatter,c=e.dom,u=$(ie(a.get()),(function(e){return e!==r&&!Pe(e,"removeformat")})),l=mm(e,n,u);if($(l,(function(t){return!zs(e,t,r)})).length>0){var s=n.cloneNode(!1);return c.add(t,s),a.remove(r,o,s,i),c.remove(s),k.some(s)}return k.none()}(e,v,a,t,n,r),y=Hg(l.concat(b.toArray()),v);Lg(e,h,!1),u.setCursorLocation(y,1),c.isEmpty(a)&&c.remove(a)}},zg=function(e){e.on("mouseup keydown",(function(t){!function(e,t){var n=e.selection,r=e.getBody();Fg(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||"\ufeff"!==n.getStart().innerHTML||Fg(e,hs(r,n.getStart())),37!==t&&39!==t||Fg(e,hs(r,n.getStart()))}(e,t.keyCode)}))},Wg=function(e,t){return e.schema.getTextInlineElements().hasOwnProperty(Ct(t))&&!gs(t.dom)&&!bn(t.dom)},qg={},Vg=Ce,$g=ye;!function(e,t){qg[e]||(qg[e]=[]),qg[e].push(t)}("pre",(function(e){var t,n=e.selection.getRng(),r=gn(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),$g(Vg(Vg(t,r),(function(e){return r(e.previousSibling)&&-1!==xe(t,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,ja(n=e).remove(),ja(t).append("<br><br>").append(n.childNodes)})))}));var Kg=dt.each,Jg=function(e){return pn(e)&&!Es(e)&&!gs(e)&&!bn(e)},Gg=function(e,t){var n;for(n=e;n;n=n[t]){if(xn(n)&&0!==n.nodeValue.length)return e;if(pn(n)&&!Es(n))return n}return e},Xg=function(e,t,n){var r,o,i=new Im(e);if(t&&n&&(t=Gg(t,"previousSibling"),n=Gg(n,"nextSibling"),i.compare(t,n))){for(r=t.nextSibling;r&&r!==n;)o=r,r=r.nextSibling,t.appendChild(o);return e.remove(n),dt.each(dt.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},Yg=function(e,t,n,r){if(r&&!1!==t.merge_siblings){var o=Xg(e,Ds(r),r);Xg(e,o,Ds(o,!0))}},Qg=function(e,t,n){Kg(e.childNodes,(function(e){Jg(e)&&(t(e)&&n(e),e.hasChildNodes()&&Qg(e,t,n))}))},Zg=function(e,t){return function(n){return!(!n||!js(e,n,t))}},eh=function(e,t,n){return function(r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)}(e,r)}},th=ar([{keep:[]},{rename:["name"]},{removed:[]}]),nh=/^(src|href|style)$/,rh=dt.each,oh=Ls,ih=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},ah=function(e,t,n){var r,o;if(r=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"],pn(r)){var i=r.childNodes.length-1;!n&&o&&o--,r=r.childNodes[o>i?i:o]}return xn(r)&&n&&o>=r.nodeValue.length&&(r=new Tr(r,e.getBody()).next()||r),xn(r)&&!n&&0===o&&(r=new Tr(r,e.getBody()).prev()||r),r},ch=function(e,t){var n=t?"firstChild":"lastChild";if(function(e){return/^(TR|TH|TD)$/.test(e.nodeName)}(e)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},uh=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},lh=function(e,t,n,r,o){var i=pt.fromDom(t),a=pt.fromDom(e.create(r,o)),c=n?Bt(i):Pt(i);return Yt(a,c),n?(Kt(i,a),Gt(a,i)):(Jt(i,a),Xt(a,i)),a.dom},sh=function(e,t,n,r){return!(t=Ds(t,n,r))||"BR"===t.nodeName||e.isBlock(t)},fh=function(e,t,n,r,o){var i,a=e.dom;if(!function(e,t,n){return!!oh(t,n.inline)||(!!oh(t,n.block)||(n.selector?pn(t)&&e.is(t,n.selector):void 0))}(a,r,t)&&!function(e,t){return t.links&&"A"===e.nodeName}(r,t))return th.keep();var c=r;if(t.inline&&"all"===t.remove&&N(t.preserve_attributes)){var u=$(a.getAttribs(c),(function(e){return U(t.preserve_attributes,e.name.toLowerCase())}));if(a.removeAllAttribs(c),q(u,(function(e){return a.setAttrib(c,e.name,e.value)})),u.length>0)return th.rename("span")}if("all"!==t.remove){rh(t.styles,(function(e,r){e=Fs(a,Ms(e,n),r+""),M(r)&&(r=e,o=null),(t.remove_similar||!o||oh(js(a,o,r),e))&&a.setStyle(c,r,""),i=!0})),i&&""===a.getAttrib(c,"style")&&(c.removeAttribute("style"),c.removeAttribute("data-mce-style")),rh(t.attributes,(function(e,r){var i;if(e=Ms(e,n),M(r)&&(r=e,o=null),t.remove_similar||!o||oh(a.getAttrib(o,r),e)){if("class"===r&&(e=a.getAttrib(c,r))&&(i="",q(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)})),i))return void a.setAttrib(c,r,i);"class"===r&&c.removeAttribute("className"),nh.test(r)&&c.removeAttribute("data-mce-"+r),c.removeAttribute(r)}})),rh(t.classes,(function(e){e=Ms(e,n),o&&!a.hasClass(o,e)||a.removeClass(c,e)}));for(var l=a.getAttribs(c),s=0;s<l.length;s++){var f=l[s].nodeName;if(0!==f.indexOf("_")&&0!==f.indexOf("data-"))return th.keep()}}return"none"!==t.remove?(function(e,t,n){var r,o=t.parentNode,i=e.dom,a=Bu(e);n.block&&(a?o===i.getRoot()&&(n.list_block&&oh(t,n.list_block)||q(oe(t.childNodes),(function(t){Ps(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=uh(i,t,a),i.setAttribs(r,e.settings.forced_root_block_attrs)):r=0}))):i.isBlock(t)&&!i.isBlock(o)&&(sh(i,t,!1)||sh(i,t.firstChild,!0,!0)||t.insertBefore(i.create("br"),t.firstChild),sh(i,t,!0)||sh(i,t.lastChild,!1,!0)||t.appendChild(i.create("br")))),n.selector&&n.inline&&!oh(n.inline,t)||i.remove(t,!0)}(e,c,t),th.removed()):th.keep()},dh=function(e,t,n,r,o){return fh(e,t,n,r,o).fold(b,(function(t){return e.dom.rename(r,t),!0}),y)},mh=function(e,t,n,r){return fh(e,t,n,r,r).fold(d(r),(function(t){return e.dom.createFragment().appendChild(r),e.dom.rename(r,t)}),d(null))},ph=function(e,t,n,r,o){var i=e.formatter.get(t),a=i[0],c=!0,u=e.dom,l=e.selection,s=function(r){var c=function(e,t,n,r,o){var i;return q(Us(e.dom,t.parentNode).reverse(),(function(t){if(!i&&"_start"!==t.id&&"_end"!==t.id){var a=sm(e,t,n,r,o);a&&!1!==a.split&&(i=t)}})),i}(e,r,t,n,o);return function(e,t,n,r,o,i,a,c){var u,l,s,f=e.dom;if(n){for(var d=n.parentNode,m=r.parentNode;m&&m!==d;m=m.parentNode){u=f.clone(m,!1);for(var p=0;p<t.length&&null!==(u=mh(e,t[p],c,u));p++);u&&(l&&u.appendChild(l),s||(s=u),l=u)}!i||a.mixed&&f.isBlock(n)||(r=f.split(n,r)),l&&(o.parentNode.insertBefore(l,o),s.appendChild(o),a.inline&&Yg(f,a,0,l))}return r}(e,i,c,r,r,!0,a,n)},f=function(t){var r,o;pn(t)&&u.getContentEditable(t)&&(r=c,c="true"===u.getContentEditable(t),o=!0);var l=oe(t.childNodes);if(c&&!o)for(var s=0;s<i.length&&!dh(e,i[s],n,t,t);s++);if(a.deep&&l.length){for(s=0;s<l.length;s++)f(l[s]);o&&(c=r)}},d=function(e){var t=u.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return function(e){return Es(e)&&pn(e)&&("_start"===e.id||"_end"===e.id)}(n)&&(n=n[e?"firstChild":"lastChild"]),xn(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),u.remove(t,!0),n},m=function(t){var n,r,o=cf(e,t,i,t.collapsed);if(a.split){if(o=Jf(o),(n=ah(e,o,!0))!==(r=ah(e,o))){if(n=ch(n,!0),r=ch(r,!1),ih(u,n,r)){var c=k.from(n.firstChild).getOr(n);return s(lh(u,c,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void d(!0)}if(ih(u,r,n)){c=k.from(r.lastChild).getOr(r);return s(lh(u,c,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void d(!1)}n=uh(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=uh(u,r,"span",{id:"_end","data-mce-type":"bookmark"});var l=u.createRng();l.setStartAfter(n),l.setEndBefore(r),lf(u,l,(function(e){q(e,(function(e){Es(e)||Es(e.parentNode)||s(e)}))})),s(n),s(r),n=d(!0),r=d()}else n=r=s(n);o.startContainer=n.parentNode?n.parentNode:n,o.startOffset=u.nodeIndex(n),o.endContainer=r.parentNode?r.parentNode:r,o.endOffset=u.nodeIndex(r)+1}lf(u,o,(function(t){q(t,(function(t){f(t);q(["underline","line-through","overline"],(function(n){pn(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&Hs(u,t.parentNode)===n&&dh(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))}))}))};if(r)if(Rs(r)){var p=u.createRng();p.setStartBefore(r),p.setEndAfter(r),m(p)}else m(r);else if("false"!==u.getContentEditable(l.getNode()))l.isCollapsed()&&a.inline&&!mf(e).length?Ug(e,t,n,o):(wf(l,!0,(function(){yf(e,m)})),a.inline&&fm(e,t,n,l.getStart())&&Os(u,l,l.getRng()),e.nodeChanged());else{r=l.getNode();for(var g=0;g<i.length&&(!i[g].ceFalseOverride||!dh(e,i[g],n,r,r));g++);}},gh=dt.each,hh=function(e,t,n,r){gh(t,(function(t){gh(e.dom.select(t.inline,r),(function(r){Jg(r)&&dh(e,t,n,r,t.exact?r:null)})),function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";Kg(e.select(r,n),(function(n){Jg(n)&&Kg(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}}(e.dom,t,r)}))},vh=dt.each,bh=function(e,t){return ve(e,t)},yh=function(e,t,n,r){var o=e.formatter.get(t),i=o[0],a=!r&&e.selection.isCollapsed(),c=e.dom,u=e.selection,l=function(e,t){if(t=t||i,e){if(t.onformat&&t.onformat(e,t,n,r),vh(t.styles,(function(t,r){c.setStyle(e,r,Ms(t,n))})),t.styles){var o=c.getAttrib(e,"style");o&&c.setAttrib(e,"data-mce-style",o)}vh(t.attributes,(function(t,r){c.setAttrib(e,r,Ms(t,n))})),vh(t.classes,(function(t){t=Ms(t,n),c.hasClass(e,t)||c.addClass(e,t)}))}},s=function(e,t){var n=!1;return!!qs(i)&&(vh(e,(function(e){if(!("collapsed"in e)||e.collapsed===a)return c.is(t,e.selector)&&!gs(t)?(l(t,e),n=!0,!1):void 0})),n)},f=function(r,a,c,u){var f=[],d=!0,m=i.inline||i.block,p=r.create(m);l(p),lf(r,a,(function(a){var c,g=function(a){var h=!1,v=d,b=a.nodeName.toLowerCase(),y=a.parentNode.nodeName.toLowerCase();if(pn(a)&&r.getContentEditable(a)&&(v=d,d="true"===r.getContentEditable(a),h=!0),En(a)&&!function(e,t,n,r){if(function(e){return e.getParam("format_empty_lines",!1,"boolean")}(e)&&Vs(t)){var o=Ee(Ee({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),i=Ig(pt.fromDom(n),(function(e){return gs(e.dom)}));return ve(o,r)&&ho(pt.fromDom(n.parentNode),!1)&&!i}return!1}(e,i,a,y))return c=null,void(Ws(i)&&r.remove(a));if(i.wrapper&&sm(e,a,t,n))c=null;else{if(d&&!h&&Ws(i)&&!i.wrapper&&Is(e,b)&&Ps(e,y,m)){var w=r.rename(a,m);return l(w),f.push(w),void(c=null)}if(qs(i)){var C=s(o,a);if(!bh(i,"inline")||C)return void(c=null)}!d||h||!Ps(e,m,b)||!Ps(e,y,m)||!u&&3===a.nodeType&&1===a.nodeValue.length&&65279===a.nodeValue.charCodeAt(0)||gs(a)||bh(i,"inline")&&r.isBlock(a)?(c=null,vh(dt.grep(a.childNodes),g),h&&(d=v),c=null):(c||(c=r.clone(p,!1),a.parentNode.insertBefore(c,a),f.push(c)),c.appendChild(a))}};vh(a,g)})),!0===i.links&&vh(f,(function(e){var t=function(e){"A"===e.nodeName&&l(e,i),vh(dt.grep(e.childNodes),t)};t(e)})),vh(f,(function(a){var c=function(e){var t=!1;return vh(e.childNodes,(function(e){if(function(e){return e&&1===e.nodeType&&!Es(e)&&!gs(e)&&!bn(e)}(e))return t=e,!1})),t},u=function(e){var t=0;return vh(e.childNodes,(function(e){(function(e){return P(e)&&xn(e)&&0===e.length})(e)||Es(e)||t++})),t}(a);!(f.length>1)&&r.isBlock(a)||0!==u?(Vs(i)||i.wrapper)&&(i.exact||1!==u||(a=function(e){var t,n=c(e);return n&&!Es(n)&&um(r,n,i)&&(t=r.clone(n,!1),l(t),r.replace(t,e,!0),r.remove(n,!0)),t||e}(a)),hh(e,o,n,a),function(e,t,n,r,o){sm(e,o.parentNode,n,r)&&dh(e,t,r,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(sm(e,i,n,r))return dh(e,t,r,o),!0}))}(e,i,t,n,a),function(e,t,n,r){t.styles&&t.styles.backgroundColor&&Qg(r,Zg(e,"fontSize"),eh(e,"backgroundColor",Ms(t.styles.backgroundColor,n)))}(r,i,n,a),function(e,t,n,r){var o=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=Hs(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(dt.walk(r,o,"childNodes"),o(r))}(r,i,0,a),function(e,t,n,r){"sub"!==t.inline&&"sup"!==t.inline||(Qg(r,Zg(e,"fontSize"),eh(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))}(r,i,0,a),Yg(r,i,0,a)):r.remove(a,!0)}))};if("false"!==c.getContentEditable(u.getNode())){if(i){if(r)if(Rs(r)){if(!s(o,r)){var d=c.createRng();d.setStartBefore(r),d.setEndAfter(r),f(c,cf(e,d,o),0,!0)}}else f(c,r,0,!0);else if(a&&Vs(i)&&!mf(e).length)!function(e,t,n){var r,o,i=e.selection,a=i.getRng(),c=a.startOffset,u=a.startContainer.nodeValue;(r=hs(e.getBody(),i.getStart()))&&(o=Bg(r));var l,s,f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&c>0&&c<u.length&&f.test(u.charAt(c))&&f.test(u.charAt(c-1))){var d=i.getBookmark();a.collapse(!0);var m=cf(e,a,e.formatter.get(t));m=Jf(m),e.formatter.apply(t,n,m),i.moveToBookmark(d)}else r&&"\ufeff"===o.nodeValue||(l=e.getDoc(),s=Mg(!0).dom,o=(r=l.importNode(s,!0)).firstChild,a.insertNode(r),c=1),e.formatter.apply(t,n,r),i.setCursorLocation(o,c)}(e,t,n);else{var m=u.getNode(),p=o[0];e.settings.forced_root_block||!p.defaultBlock||c.getParent(m,c.isBlock)||yh(e,p.defaultBlock),u.setRng(bg(u.getRng())),wf(u,!0,(function(t){yf(e,(function(t,n){var r=n?t:cf(e,t,o);f(c,r)}))})),Os(c,u,u.getRng()),e.nodeChanged()}!function(e,t){$g(qg[e],(function(e){e(t)}))}(t,e)}}else{r=u.getNode();for(var g=0,h=o.length;g<h;g++){var v=o[g];if(v.ceFalseOverride&&qs(v)&&c.is(r,v.selector))return void l(r,v)}}},wh=function(e,t,n,r){var o=ie(n.get()),i={},a={},c=$(Us(e.dom,t),(function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")}));ce(r,(function(t,n){dt.each(c,(function(r){return e.formatter.matchNode(r,n,{},t.similar)?(-1===o.indexOf(n)&&(q(t.callbacks,(function(e){e(!0,{node:r,format:n,parents:c})})),i[n]=t.callbacks),a[n]=t.callbacks,!1):!am(e,r,n)&&void 0}))}));var u=Ch(n.get(),a,t,c);n.set(Ee(Ee({},i),u))},Ch=function(e,t,n,r){return de(e,(function(e,o){return!!he(t,o)||(q(e,(function(e){e(!1,{node:n,format:o,parents:r})})),!1)})).t},xh=function(e,t,n,r,o){return null===t.get()&&function(e,t){var n=Qa({});e.set({}),t.on("NodeChange",(function(r){wh(t,r.element,n,e.get())}))}(t,e),function(e,t,n,r){var o=e.get();q(t.split(","),(function(e){o[e]||(o[e]={similar:r,callbacks:[]}),o[e].callbacks.push(n)})),e.set(o)}(t,n,r,o),{unbind:function(){return function(e,t,n){var r=e.get();q(t.split(","),(function(e){r[e].callbacks=$(r[e].callbacks,(function(e){return e!==n})),0===r[e].callbacks.length&&delete r[e]})),e.set(r)}(t,n,r)}}},kh=function(e,t){var n=(t||document).createDocumentFragment();return q(e,(function(e){n.appendChild(e.dom)})),pt.fromDom(n)},Sh=function(e,t,n){return{element:e,width:t,rows:n}},Th=function(e,t){return{element:e,cells:t}},Eh=function(e,t){return{x:e,y:t}},_h=function(e,t){var n=parseInt(Mn(e,t),10);return isNaN(n)?1:n},Ah=function(e,t,n){var r=e.rows;return!!(r[n]?r[n].cells:[])[t]},Nh=function(e){return J(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)},Rh=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var o=n[r].cells,i=0;i<o.length;i++)if(bt(o[i],t))return k.some(Eh(i,r));return k.none()},Oh=function(e,t,n,r,o){for(var i=[],a=e.rows,c=n;c<=o;c++){var u=a[c].cells,l=t<r?u.slice(t,r+1):u.slice(r,t+1);i.push(Th(a[c].element,l))}return i},Dh=function(e){var t=Sh(_c(e),0,[]);return q(gc(e,"tr"),(function(e,n){q(gc(e,"td,th"),(function(r,o){!function(e,t,n,r,o){for(var i=_h(o,"rowspan"),a=_h(o,"colspan"),c=e.rows,u=n;u<n+i;u++){c[u]||(c[u]=Th(Ac(r),[]));for(var l=t;l<t+a;l++){c[u].cells[l]=u===n&&l===t?o:_c(o)}}}(t,function(e,t,n){for(;Ah(e,t,n);)t++;return t}(t,o,n),n,e,r)}))})),Sh(t.element,Nh(t.rows),t.rows)},Ih=function(e){return function(e,t){var n=_c(e.element),r=pt.fromTag("tbody");return Yt(r,t),Xt(n,r),n}(e,function(e){return W(e.rows,(function(e){var t=W(e.cells,(function(e){var t=Ac(e);return Fn(t,"colspan"),Fn(t,"rowspan"),t})),n=_c(e.element);return Yt(n,t),n}))}(e))},Ph=function(e,t,n){return Rh(e,t).bind((function(t){return Rh(e,n).map((function(n){return function(e,t,n){var r=t.x,o=t.y,i=n.x,a=n.y,c=o<a?Oh(e,r,o,i,a):Oh(e,r,a,i,o);return Sh(e.element,Nh(c),c)}(e,t,n)}))}))},Bh=function(e,t){return G(e,(function(e){return"li"===Ct(e)&&hf(e,t)})).fold(d([]),(function(t){return function(e){return G(e,(function(e){return"ul"===Ct(e)||"ol"===Ct(e)}))}(e).map((function(e){var t=pt.fromTag(Ct(e)),n=me(Wn(e),(function(e,t){return Be(t,"list-style")}));return jn(t,n),[pt.fromTag("li"),t]})).getOr([])}))},Mh=function(e,t){var n=pt.fromDom(t.commonAncestorContainer),r=ep(n,e),o=$(r,(function(e){return Nr(e)||_r(e)})),i=Bh(r,t),a=o.concat(i.length?i:function(e){return Ir(e)?Ot(e).filter(Dr).fold(d([]),(function(t){return[e,t]})):Dr(e)?[e]:[]}(n));return W(a,_c)},Lh=function(){return kh([])},Fh=function(e,t){return n=pt.fromDom(t.cloneContents()),r=Mh(e,t),o=J(r,(function(e,t){return Xt(t,e),t}),n),r.length>0?kh([o]):o;var n,r,o},jh=function(e,t){return(n=e,r=t[0],mr(r,"table",p(bt,n))).bind((function(e){var n=t[0],r=t[t.length-1],o=Dh(e);return Ph(o,n,r).map((function(e){return kh([Ih(e)])}))})).getOrThunk(Lh);var n,r},Hh=function(e,t){var n=df(t,e);return n.length>0?jh(e,n):function(e,t){return t.length>0&&t[0].collapsed?Lh():Fh(e,t[0])}(e,t)},Uh=function(e,t){return t>=0&&t<e.length&&As(e.charAt(t))},zh=function(e,t){var n=Fr(e.innerText);return t?function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")}(n):n},Wh=function(e,t,n){if(void 0===n&&(n={}),n.get=!0,n.format=t,n.selection=!0,(n=e.fire("BeforeGetContent",n)).isDefaultPrevented())return e.fire("GetContent",n),n.content;if("text"===n.format)return function(e){return k.from(e.selection.getRng()).map((function(t){var n=k.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),o=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()}(n),i=ct.browser.isIE()&&"pre"!==o,a=e.dom.add(r,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),c=zh(a,i),u=Fr(a.textContent);if(e.dom.remove(a),Uh(u,0)||Uh(u,u.length-1)){var l=n.getOr(r),s=zh(l,i),f=s.indexOf(c);return-1===f?c:(Uh(s,f-1)?" ":"")+c+(Uh(s,f+c.length)?" ":"")}return c})).getOr("")}(e);n.getInner=!0;var r=function(e,t){var n=e.selection.getRng(),r=e.dom.create("body"),o=e.selection.getSel(),i=nm(e,sf(o)),a=t.contextual?Hh(pt.fromDom(e.getBody()),i).dom:n.cloneContents();return a&&r.appendChild(a),e.selection.serializer.serialize(r,t)}(e,n);return"tree"===n.format?r:(n.content=e.selection.isCollapsed()?"":r,e.fire("GetContent",n),n.content)},qh=function(e){return pn(e)?e.outerHTML:xn(e)?Po.encodeRaw(e.data,!1):kn(e)?"\x3c!--"+e.data+"--\x3e":""},Vh=function(e,t,n){var r=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(r,o)}else e.appendChild(r)},$h=function(e,t){var n,r,o,i,a,c,u,l,s,f=W(oe(t.childNodes),qh);return function(e,t){var n=0;q(e,(function(e){0===e[0]?n++:1===e[0]?(Vh(t,e[1],n),n++):2===e[0]&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(t,n)}))}((r=e,o=(n=f).length+r.length+2,i=new Array(o),a=new Array(o),c=function(e,t,o,i,a){var u=l(e,t,o,i);if(null===u||u.start===t&&u.diag===t-i||u.end===e&&u.diag===e-o)for(var s=e,f=o;s<t||f<i;)s<t&&f<i&&n[s]===r[f]?(a.push([0,n[s]]),++s,++f):t-e>i-o?(a.push([2,n[s]]),++s):(a.push([1,r[f]]),++f);else{c(e,u.start,o,u.start-u.diag,a);for(var d=u.start;d<u.end;++d)a.push([0,n[d]]);c(u.end,t,u.end-u.diag,i,a)}},u=function(e,t,o,i){for(var a=e;a-t<i&&a<o&&n[a]===r[a-t];)++a;return function(e,t,n){return{start:e,end:t,diag:n}}(e,a,t)},l=function(e,t,o,c){var l=t-e,s=c-o;if(0===l||0===s)return null;var f,d,m,p,g,h=l-s,v=s+l,b=(v%2==0?v:v+1)/2;for(i[1+b]=e,a[1+b]=t+1,f=0;f<=b;++f){for(d=-f;d<=f;d+=2){for(m=d+b,d===-f||d!==f&&i[m-1]<i[m+1]?i[m]=i[m+1]:i[m]=i[m-1]+1,g=(p=i[m])-e+o-d;p<t&&g<c&&n[p]===r[g];)i[m]=++p,++g;if(h%2!=0&&h-f<=d&&d<=h+f&&a[m-h]<=i[m])return u(a[m-h],d+e-o,t,c)}for(d=h-f;d<=h+f;d+=2){for(m=d+b-h,d===h-f||d!==h+f&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],g=(p=a[m]-1)-e+o-d;p>=e&&g>=o&&n[p]===r[g];)a[m]=p--,g--;if(h%2==0&&-f<=d&&d<=f&&a[m]<=i[m+h])return u(a[m],d+e-o,t,c)}}},s=[],c(0,n.length,0,r.length,s),s),t),t},Kh=Qa(k.none()),Jh=function(e){var t,n=(t=e.getBody(),$(W(oe(t.childNodes),qh),(function(e){return e.length>0}))),r=Y(n,(function(t){var n=Nm(e.serializer,t);return n.length>0?[n]:[]})),o=r.join("");return-1!==o.indexOf("</iframe>")?function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}}(r):function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}}(o)},Gh=function(e,t,n){"fragmented"===t.type?$h(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)},Xh=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},Yh=function(e){var t=pt.fromTag("body",Kh.get().getOrThunk((function(){var e=document.implementation.createHTMLDocument("undo");return Kh.set(k.some(e)),e})));return Tc(t,Xh(e)),q(gc(t,"*[data-mce-bogus]"),en),t.dom.innerHTML},Qh=function(e,t){return!(!e||!t)&&(!!function(e,t){return Xh(e)===Xh(t)}(e,t)||function(e,t){return Yh(e)===Yh(t)}(e,t))},Zh=function(e){return 0===e.get()},ev=function(e,t,n){Zh(n)&&(e.typing=t)},tv=function(e,t){e.typing&&(ev(e,!1,t),e.add())},nv=function(e){return e instanceof bm},rv=function(e,t){Ng(e.serializer.getNodeFilters(),e.serializer.getAttributeFilters(),t)},ov=function(e){return{undoManager:{beforeChange:function(t,n){return function(e,t,n){Zh(t)&&n.set(k.some(Ou(e.selection)))}(e,t,n)},addUndoLevel:function(t,n,r,o,i,a){return function(e,t,n,r,o,i,a){var c=Jh(e);if(i=i||{},i=dt.extend(i,c),!1===Zh(r)||e.removed)return null;var u=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:u,originalEvent:a}).isDefaultPrevented())return null;if(u&&Qh(u,i))return null;t.data[n.get()]&&o.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var l=function(e){return e.getParam("custom_undo_redo_levels",0,"number")}(e);if(l&&t.data.length>l){for(var s=0;s<t.data.length-1;s++)t.data[s]=t.data[s+1];t.data.length--,n.set(t.data.length)}i.bookmark=Ou(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);var f={level:i,lastLevel:u,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.fire("AddUndo",f),e.fire("change",f)):e.fire("AddUndo",f),i}(e,t,n,r,o,i,a)},undo:function(t,n,r){return function(e,t,n,r){var o;return t.typing&&(t.add(),t.typing=!1,ev(t,!1,n)),r.get()>0&&(r.set(r.get()-1),o=t.data[r.get()],Gh(e,o,!0),e.setDirty(!0),e.fire("Undo",{level:o})),o}(e,t,n,r)},redo:function(t,n){return function(e,t,n){var r;return t.get()<n.length-1&&(t.set(t.get()+1),r=n[t.get()],Gh(e,r,!1),e.setDirty(!0),e.fire("Redo",{level:r})),r}(e,t,n)},clear:function(t,n){return function(e,t,n){t.data=[],n.set(0),t.typing=!1,e.fire("ClearUndos")}(e,t,n)},reset:function(e){return function(e){e.clear(),e.add()}(e)},hasUndo:function(t,n){return function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!Qh(Jh(e),t.data[0])}(e,t,n)},hasRedo:function(e,t){return function(e,t){return t.get()<e.data.length-1&&!e.typing}(e,t)},transact:function(e,t,n){return function(e,t,n){return tv(e,t),e.beforeChange(),e.ignore(n),e.add()}(e,t,n)},ignore:function(e,t){return function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}}(e,t)},extra:function(t,n,r,o){return function(e,t,n,r,o){if(t.transact(r)){var i=t.data[n.get()].bookmark,a=t.data[n.get()-1];Gh(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=i)}}(e,t,n,r,o)}},formatter:{match:function(t,n,r){return fm(e,t,n,r)},matchAll:function(t,n){return function(e,t,n){var r=[],o={},i=e.selection.getStart();return e.dom.getParent(i,(function(i){for(var a=0;a<t.length;a++){var c=t[a];!o[c]&&sm(e,i,c,n)&&(o[c]=!0,r.push(c))}}),e.dom.getRoot()),r}(e,t,n)},matchNode:function(t,n,r,o){return sm(e,t,n,r,o)},canApply:function(t){return function(e,t){var n,r,o,i,a,c=e.formatter.get(t),u=e.dom;if(c)for(n=e.selection.getStart(),r=Us(u,n),i=c.length-1;i>=0;i--){if(!(a=c[i].selector)||c[i].defaultBlock)return!0;for(o=r.length-1;o>=0;o--)if(u.is(r[o],a))return!0}return!1}(e,t)},closest:function(t){return dm(e,t)},apply:function(t,n,r){return yh(e,t,n,r)},remove:function(t,n,r,o){return ph(e,t,n,r,o)},toggle:function(t,n,r){return function(e,t,n,r){var o=e.formatter.get(t);!fm(e,t,n,r)||"toggle"in o[0]&&!o[0].toggle?yh(e,t,n,r):ph(e,t,n,r)}(e,t,n,r)},formatChanged:function(t,n,r,o){return xh(e,t,n,r,o)}},editor:{getContent:function(t,n){return function(e,t,n){return k.from(e.getBody()).fold(d("tree"===t.format?new bm("body",11):""),(function(r){return Om(e,t,n,r)}))}(e,t,n)},setContent:function(t,n){return Dg(e,t,n)},insertContent:function(t,n){return _g(e,t,n)},addVisual:function(t){return function(e,t){var n=e.dom,r=P(t)?t:e.getBody();D(e.hasVisual)&&(e.hasVisual=function(e){return e.getParam("visual",!0,"boolean")}(e)),q(n.select("table,a",r),(function(t){switch(t.nodeName){case"TABLE":var r=function(e){return e.getParam("visual_table_class","mce-item-table","string")}(e),o=n.getAttrib(t,"border");o&&"0"!==o||!e.hasVisual?n.removeClass(t,r):n.addClass(t,r);break;case"A":if(!n.getAttrib(t,"href")){var i=n.getAttrib(t,"name")||t.id,a=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")}(e);i&&e.hasVisual?n.addClass(t,a):n.removeClass(t,a)}}})),e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})}(e,t)}},selection:{getContent:function(t,n){return Wh(e,t,n)}},raw:{getModel:function(){return k.none()}}}},iv=function(e,t){var n=function(e){return A(e)?e:{}},r=h("Unimplemented feature for rtc");return{undoManager:{beforeChange:s,addUndoLevel:r,undo:function(){return t.undo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},redo:function(){return t.redo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},clear:r,reset:r,hasUndo:function(){return t.hasUndo()},hasRedo:function(){return t.hasRedo()},transact:function(e,n,r){return t.transact(r),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},ignore:r,extra:r},formatter:{match:function(e,r,o){return t.matchFormat(e,n(r))},matchAll:r,matchNode:r,canApply:function(e){return t.canApplyFormat(e)},closest:function(e){return t.closestFormat(e)},apply:function(e,r,o){return t.applyFormat(e,n(r))},remove:function(e,r,o,i){return t.removeFormat(e,n(r))},toggle:function(e,r,o){return t.toggleFormat(e,n(r))},formatChanged:function(e,n,r,o){return t.formatChanged(n,r,o)}},editor:{getContent:function(n,r){if("html"===r||"tree"===r){var o=t.getContent(),i=Cm({inner:!0});return rv(e,o),"tree"===r?o:i.serialize(o)}return ov(e).editor.getContent(n,r)},setContent:function(n,r){var o=nv(n)?n:e.parser.parse(n,{isRootContent:!0,insert:!0});return t.setContent(o),n},insertContent:function(n,r){var o,i=(o=e,k.from(o.selection.getStart(!0)).map((function(e){return e.nodeName.toLowerCase()}))).fold((function(){return{}}),(function(e){return{context:e}})),a=nv(n)?n:e.parser.parse(n,Ee(Ee({},i),{insert:!0}));t.insertContent(a)},addVisual:function(e){}},selection:{getContent:function(n,r){if("html"===n||"tree"===n){var o=t.getSelectedContent(),i=Cm({});return rv(e,o),"tree"===n?o:i.serialize(o)}return ov(e).selection.getContent(n,r)}},raw:{getModel:function(){return k.some(t.getRawModel())}}}},av=function(e){return he(e.plugins,"rtc")},cv=function(e){return e.rtcInstance?e.rtcInstance:ov(e)},uv=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},lv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return uv(e).selection.getContent(t,n)}(e,t.format?t.format:"html",t)},sv=function(e){return 0===e.dom.length?(Zt(e),k.none()):k.some(e)},fv=function(e,t,n,r){e.bind((function(e){return(r?Op:Rp)(e.dom,r?e.dom.length:0),t.filter(Tt).map((function(t){return function(e,t,n,r){var o=e.dom,i=t.dom,a=r?o.length:i.length;r?(Dp(o,i,!1,!r),n.setStart(i,a)):(Dp(i,o,!1,!r),n.setEnd(i,a))}(e,t,n,r)}))})).orThunk((function(){return function(e,t){return e.filter((function(e){return Nf.isBookmarkNode(e.dom)})).bind(t?It:Dt)}(t,r).or(t).filter(Tt).map((function(e){return function(e,t){Ot(e).each((function(n){var r=e.dom;t&&Cp(n,lu(r,0))?Rp(r,0):!t&&xp(n,lu(r,r.length))&&Op(r,r.length)}))}(e,r)}))}))},dv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return Ee(Ee({format:"html"},e),{set:!0,selection:!0,content:t})}(n,t);if(r.no_events||!(r=e.fire("BeforeSetContent",r)).isDefaultPrevented()){n.content=function(e,t){if("raw"!==t.format){var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=r?{context:r.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,Ee(Ee({isRootContent:!0,forced_root_block:!1},o),t));return Cm({validate:e.validate},e.schema).serialize(i)}return t.content}(e,r);var o=e.selection.getRng();!function(e,t){var n=k.from(t.firstChild).map(pt.fromDom),r=k.from(t.lastChild).map(pt.fromDom);e.deleteContents(),e.insertNode(t);var o=n.bind(Dt).filter(Tt).bind(sv),i=r.bind(It).filter(Tt).bind(sv);fv(o,n,e,!0),fv(i,r,e,!1),e.collapse(!1)}(o,o.createContextualFragment(n.content)),e.selection.setRng(o),bd(e,o),r.no_events||e.fire("SetContent",r)}else e.fire("SetContent",r)},mv=function(e,t,n){if(e&&e.hasOwnProperty(t)){var r=$(e[t],(function(e){return e!==n}));0===r.length?delete e[t]:e[t]=r}};var pv=function(e){return!!e.select},gv=function(e){return!(!e||!e.ownerDocument)&&wt(pt.fromDom(e.ownerDocument),pt.fromDom(e))},hv=function(e,t,n,r){var o,i,a=function(e,t){var n,r;return{selectorChangedWithUnbind:function(o,i){return n||(n={},r={},t.on("NodeChange",(function(t){var o=t.element,i=e.getParents(o,null,e.getRoot()),a={};dt.each(n,(function(t,n){dt.each(i,(function(o){if(e.is(o,n))return r[n]||(dt.each(t,(function(e){e(!0,{node:o,selector:n,parents:i})})),r[n]=t),a[n]=t,!1}))})),dt.each(r,(function(e,t){a[t]||(delete r[t],dt.each(e,(function(e){e(!1,{node:o,selector:t,parents:i})})))}))}))),n[o]||(n[o]=[]),n[o].push(i),{unbind:function(){mv(n,o,i),mv(r,o,i)}}}}}(e,r).selectorChangedWithUnbind,c=function(e,t){return dv(r,e,t)},u=function(e){var t=s();t.collapse(!!e),f(t)},l=function(){return t.getSelection?t.getSelection():t.document.selection},s=function(){var n,a,c,u=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}};if(!t)return null;var s=t.document;if(null==s)return null;if(void 0!==r.bookmark&&!1===Jd(r)){var f=Md(r);if(f.isSome())return f.map((function(e){return nm(r,[e])[0]})).getOr(s.createRange())}try{(n=l())&&!mn(n.anchorNode)&&(a=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():s.createRange(),a=nm(r,[a])[0])}catch(e){}return a||(a=s.createRange?s.createRange():s.body.createTextRange()),a.setStart&&9===a.startContainer.nodeType&&a.collapsed&&(c=e.getRoot(),a.setStart(c,0),a.setEnd(c,0)),o&&i&&(0===u(a.START_TO_START,a,o)&&0===u(a.END_TO_END,a,o)?a=i:(o=null,i=null)),a},f=function(e,t){var n;if(function(e){return!!e&&(!!pv(e)||gv(e.startContainer)&&gv(e.endContainer))}(e)){var a=pv(e)?e:null;if(a){i=null;try{a.select()}catch(e){}}else{var c=l();if(e=r.fire("SetSelectionRange",{range:e,forward:t}).range,c){i=e;try{c.removeAllRanges(),c.addRange(e)}catch(e){}!1===t&&c.extend&&(c.collapse(e.endContainer,e.endOffset),c.extend(e.startContainer,e.startOffset)),o=c.rangeCount>0?c.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!c.setBaseAndExtent||ct.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(c.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),c.anchorNode===e.startContainer&&c.focusNode===e.endContainer||c.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},d=function(){var t=l(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;if(!t||!n||!r||mn(n)||mn(r))return!0;var o=e.createRng();o.setStart(n,t.anchorOffset),o.collapse(!0);var i=e.createRng();return i.setStart(r,t.focusOffset),i.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,i)<=0},m={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:u,setCursorLocation:function(t,n){var o=e.createRng();t?(o.setStart(t,n),o.setEnd(t,n),f(o),u(!1)):(vf(e,o,r.getBody(),!0),f(o))},getContent:function(e){return lv(r,e)},setContent:c,getBookmark:function(e,t){return p.getBookmark(e,t)},moveToBookmark:function(e){return p.moveToBookmark(e)},select:function(t,n){return function(e,t,n){return k.from(t).map((function(t){var r=e.nodeIndex(t),o=e.createRng();return o.setStart(t.parentNode,r),o.setEnd(t.parentNode,r+1),n&&(vf(e,o,t,!0),vf(e,o,t,!1)),o}))}(e,t,n).each(f),t},isCollapsed:function(){var e=s(),t=l();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:d,setNode:function(t){return c(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,r,o;if(!t)return e;r=t.startContainer,o=t.endContainer;var i=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(r===o&&a-i<2&&r.hasChildNodes()&&(n=r.childNodes[i]),3===r.nodeType&&3===o.nodeType&&(r=r.length===i?tm(r.nextSibling,!0):r.parentNode,o=0===a?tm(o.previousSibling,!1):o.parentNode,r&&r===o))?r:n&&3===n.nodeType?n.parentNode:n}(r.getBody(),s())},getSel:l,setRng:f,getRng:s,getStart:function(e){return Zd(r.getBody(),s(),e)},getEnd:function(e){return em(r.getBody(),s(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i=[],a=e.getRoot();if(n=e.getParent(n||Zd(a,t,t.collapsed),e.isBlock),r=e.getParent(r||em(a,t,t.collapsed),e.isBlock),n&&n!==a&&i.push(n),n&&r&&n!==r){o=n;for(var c=new Tr(n,a);(o=c.next())&&o!==r;)e.isBlock(o)&&i.push(o)}return r&&n!==r&&r!==a&&i.push(r),i}(e,s(),t,n)},normalize:function(){var t=s(),n=l();if(!(sf(n).length>1)&&bf(r)){var o=$f(e,t);return o.each((function(e){f(e,d())})),o.getOr(t)}return t},selectorChanged:function(e,t){return a(e,t),m},selectorChangedWithUnbind:a,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){return function(e,t,n){(e.inline?gd:vd)(e,t,n)}(r,e,t)},placeCaretAt:function(e,t){return f(Mf(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=s();return e.collapsed?lu.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=o=i=null,g.destroy()}},p=Nf(m),g=Pf(m,r);return m.bookmarkManager=p,m.controlSelection=g,m},vv=function(e,t,n){e.addNodeFilter("font",(function(e){q(e,(function(e){var r=t.parse(e.attr("style")),o=e.attr("color"),i=e.attr("face"),a=e.attr("size");o&&(r.color=o),i&&(r["font-family"]=i),a&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),function(e,t){q(t,(function(t){e.attr(t,null)}))}(e,["color","face","size"])}))}))},bv=function(e,t){var n=li();t.convert_fonts_to_spans&&vv(e,n,dt.explode(t.font_size_legacy_values)),function(e,t){e.addNodeFilter("strike",(function(e){q(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))}(e,n)},yv=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},wv=function(e,t){var n;try{n=atob(t)}catch(e){return k.none()}for(var r=new Uint8Array(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);return k.some(new Blob([r],{type:e}))},Cv=function(e){return 0===e.indexOf("blob:")?function(e){return new hr((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===this.status?t(this.response):r()},o.onerror=r,o.send()}catch(e){r()}}))}(e):0===e.indexOf("data:")?(t=e,new hr((function(e){var n=yv(t),r=n.type,o=n.data;wv(r,o).fold((function(){return e(new Blob([]))}),e)}))):null;var t},xv=0,kv=function(e){return(e||"blobid")+xv++},Sv=function(e,t,n,r){var o,i;if(0!==t.src.indexOf("blob:")){var a=yv(t.src),c=a.data,u=a.type;o=c,(i=e.getByData(o,u))?n({image:t,blobInfo:i}):Cv(t.src).then((function(r){i=e.create(kv(),r,o),e.add(i),n({image:t,blobInfo:i})}),(function(e){r(e)}))}else(i=e.getByUri(t.src))?n({image:t,blobInfo:i}):Cv(t.src).then((function(r){(function(e){return new hr((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))})(r).then((function(a){o=yv(a).data,i=e.create(kv(),r,o),e.add(i),n({image:t,blobInfo:i})}))}),(function(e){r(e)}))};function Tv(e,t){var n={};return{findAll:function(r,o){o||(o=y);var i=$(function(e){return e?oe(e.getElementsByTagName("img")):[]}(r),(function(t){var n=t.src;return!!ct.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===ct.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t)))))})),a=W(i,(function(e){if(void 0!==n[e.src])return new hr((function(t){n[e.src].then((function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new hr((function(n,r){Sv(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return hr.all(a)}}}var Ev,_v,Av=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new bm("br",1)).shortEnded=!0:r.empty().append(new bm("#text",3)).value=""},Nv=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},Rv=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty}(e,t)}))},Ov=function(e,t){var n=t.blob_cache,r=function(e){var r=e.attr("src");(function(e){return e.attr("src")===ct.transparentSrc||e.attr("data-mce-placeholder")})(e)||function(e){return e.attr("data-mce-bogus")}(e)||function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(e);return t?k.some({type:t[1],data:decodeURIComponent(t[2])}):k.none()}(r).filter((function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),ce(e.attributes.map,(function(e,t){n.setAttribute(t,e)})),t.images_dataimg_filter(n)}return!0}(e,t)})).bind((function(e){var t=e.type,r=e.data;return k.from(n.getByData(r,t)).orThunk((function(){return wv(t,r).map((function(e){var t=n.create(kv(),e,r);return n.add(t),t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return q(e,r)}))},Dv=dt.makeMap,Iv=dt.each,Pv=dt.explode,Bv=dt.extend,Mv=function(e,t){void 0===t&&(t=qo());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a=function(e){var t,a,c;(a=e.name)in n&&((c=o[a])?c.push(e):o[a]=[e]),t=r.length;for(;t--;)(a=r[t].name)in e.attributes.map&&((c=i[a])?c.push(e):i[a]=[e]);return e},c={schema:t,addAttributeFilter:function(e,t){Iv(Pv(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){Iv(Pv(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:a,parse:function(c,u){var l,s,f,d,m,p,g,h,v,b=[];u=u||{},o={},i={};var y=Bv(Dv("script,style,head,html,body,title,meta,param"),t.getBlockElements()),w=t.getNonEmptyElements(),C=t.children,x=e.validate,k=function(e){return!1===e?"":!0===e?"p":e}("forced_root_block"in u?u.forced_root_block:e.forced_root_block),S=t.getWhiteSpaceElements(),T=/^[ \t\r\n]+/,E=/[ \t\r\n]+$/,_=/[ \t\r\n]+/g,A=/^[ \t\r\n]+$/;h=S.hasOwnProperty(u.context)||S.hasOwnProperty(e.root_name);var N=function(e,t){var r,i=new bm(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},R=function(e){var n,r,o,i,a=t.getBlockElements();for(n=e.prev;n&&3===n.type;){if((o=n.value.replace(E,"")).length>0)return void(n.value=o);if(r=n.next){if(3===r.type&&r.value.length){n=n.prev;continue}if(!a[r.name]&&"script"!==r.name&&"style"!==r.name){n=n.prev;continue}}i=n.prev,n.remove(),n=i}},O=Am({validate:x,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(t.getSelfClosingElements()),cdata:function(e){v.append(N("#cdata",4)).value=e},text:function(e,t){var n;h||(e=e.replace(_," "),function(e,t){return e&&(t[e.name]||"br"===e.name)}(v.lastChild,y)&&(e=e.replace(T,""))),0!==e.length&&((n=N("#text",3)).raw=!!t,v.append(n).value=e)},comment:function(e){v.append(N("#comment",8)).value=e},pi:function(e,t){v.append(N(e,7)).value=t,R(v)},doctype:function(e){v.append(N("#doctype",10)).value=e,R(v)},start:function(e,n,o){var a,c,u,l,s=x?t.getElementRule(e):{};if(s){for((a=N(s.outputName||e,1)).attributes=n,a.shortEnded=o,v.append(a),(l=C[v.name])&&C[a.name]&&!l[a.name]&&b.push(a),c=r.length;c--;)(u=r[c].name)in n.map&&((p=i[u])?p.push(a):i[u]=[a]);y[e]&&R(a),o||(v=a),!h&&S[e]&&(h=!0)}},end:function(n){var r,o,i,a,c=x?t.getElementRule(n):{};if(c){if(y[n]&&!h){if((r=v.firstChild)&&3===r.type)if((o=r.value.replace(T,"")).length>0)r.value=o,r=r.next;else for(i=r.next,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.next,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i;if((r=v.lastChild)&&3===r.type)if((o=r.value.replace(E,"")).length>0)r.value=o,r=r.prev;else for(i=r.prev,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.prev,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i}if(h&&S[n]&&(h=!1),c.removeEmpty&&Rv(t,w,S,v))return a=v.parent,y[v.name]?v.empty().remove():v.unwrap(),void(v=a);c.paddEmpty&&(function(e){return Nv(e,"#text")&&""===e.firstChild.value}(v)||Rv(t,w,S,v))&&Av(e,u,y,v),v=v.parent}}},t),D=v=new bm(u.context||e.root_name,11);if(O.parse(c,u.format),x&&b.length&&(u.context?u.invalid=!0:function(e){var n,r,o,i,c,u,l,s,f,d,m,p=Dv("tr,td,th,tbody,thead,tfoot,table"),g=t.getNonEmptyElements(),h=t.getWhiteSpaceElements(),v=t.getTextBlockElements(),b=t.getSpecialElements();for(n=0;n<e.length;n++)if((r=e[n]).parent&&!r.fixed)if(v[r.name]&&"li"===r.parent.name){for(d=r.next;d&&v[d.name];)d.name="li",d.fixed=!0,r.parent.insert(d,r.parent),d=d.next;r.unwrap(r)}else{for(i=[r],o=r.parent;o&&!t.isValidChild(o.name,r.name)&&!p[o.name];o=o.parent)i.push(o);if(o&&i.length>1){for(i.reverse(),c=u=a(i[0].clone()),f=0;f<i.length-1;f++){for(t.isValidChild(u.name,i[f].name)?(l=a(i[f].clone()),u.append(l)):l=u,s=i[f].firstChild;s&&s!==i[f+1];)m=s.next,l.append(s),s=m;u=l}Rv(t,g,h,c)?o.insert(r,i[0],!0):(o.insert(c,i[0],!0),o.insert(r,c)),o=i[0],(Rv(t,g,h,o)||Nv(o,"br"))&&o.empty().remove()}else if(r.parent){if("li"===r.name){if((d=r.prev)&&("ul"===d.name||"ol"===d.name)){d.append(r);continue}if((d=r.next)&&("ul"===d.name||"ol"===d.name)){d.insert(r,d.firstChild,!0);continue}r.wrap(a(new bm("ul",1)));continue}t.isValidChild(r.parent.name,"div")&&t.isValidChild("div",r.name)?r.wrap(a(new bm("div",1))):b[r.name]?r.empty().remove():r.unwrap()}}}(b)),k&&("body"===D.name||u.isRootContent)&&function(){var n,r,o=D.firstChild,i=function(e){e&&((o=e.firstChild)&&3===o.type&&(o.value=o.value.replace(T,"")),(o=e.lastChild)&&3===o.type&&(o.value=o.value.replace(E,"")))};if(t.isValidChild(D.name,k.toLowerCase())){for(;o;)n=o.next,3===o.type||1===o.type&&"p"!==o.name&&!y[o.name]&&!o.attr("data-mce-type")?(r||((r=N(k,1)).attr(e.forced_root_block_attrs),D.insert(r,o)),r.append(o)):(i(r),r=null),o=n;i(r)}}(),!u.invalid){for(g in o)if(o.hasOwnProperty(g)){for(p=n[g],d=(l=o[g]).length;d--;)l[d].parent||l.splice(d,1);for(s=0,f=p.length;s<f;s++)p[s](l,g,u)}for(s=0,f=r.length;s<f;s++)if((p=r[s]).name in i){for(d=(l=i[p.name]).length;d--;)l[d].parent||l.splice(d,1);for(d=0,m=p.callbacks.length;d<m;d++)p.callbacks[d](l,p.name,u)}}return D}};return function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,o){var i,a,c,u,l,s,f,d,m=e.length,p=dt.extend({},n.getBlockElements()),g=n.getNonEmptyElements(),h=n.getWhiteSpaceElements();for(p.body=1,i=0;i<m;i++)if(c=(a=e[i]).parent,p[a.parent.name]&&a===c.lastChild){for(l=a.prev;l;){if("span"!==(s=l.name)||"bookmark"!==l.attr("data-mce-type")){"br"===s&&(a=null);break}l=l.prev}a&&(a.remove(),Rv(n,g,h,c)&&(f=n.getElementRule(c.name))&&(f.removeEmpty?c.remove():f.paddEmpty&&Av(t,o,p,c)))}else{for(u=a;c&&c.firstChild===u&&c.lastChild===u&&(u=c,!p[c.name]);)c=c.parent;u===c&&!0!==t.padd_empty_with_br&&((d=new bm("#text",3)).value="",a.replace(d))}})),e.addAttributeFilter("href",(function(e){var n,r,o=e.length;if(!t.allow_unsafe_link_target)for(;o--;){var i=e[o];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",(n=i.attr("rel"),r=void 0,r=n?dt.trim(n):"",/\b(noopener)\b/g.test(r)?r:function(e){return e.split(" ").filter((function(e){return e.length>0})).concat(["noopener"]).sort().join(" ")}(r)))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href")){r=o.parent,t=o.lastChild;do{n=t.prev,r.insert(t,o),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){for(var t,n,r=e.length;r--;)if("ul"===(n=(t=e[r]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new bm("li",1);o.attr("style","list-style-type: none"),t.wrap(o)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){for(var t,r,o,i,a,c,u,l=e.length,s=n.getValidClasses();l--;){for(r=(t=e[l]).attr("class").split(" "),a="",o=0;o<r.length;o++)i=r[o],u=!1,(c=s["*"])&&c[i]&&(u=!0),c=s[t.name],!u&&c&&c[i]&&(u=!0),u&&(a&&(a+=" "),a+=i);a.length||(a=null),t.attr("class",a)}})),Ov(e,t)}(c,e),function(e,t){t.inline_styles&&bv(e,t)}(c,e),c},Lv=function(e,t,n){return function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events}(e,n)?function(e,t,n){var r,o,i=e.dom;t=t.cloneNode(!0);var a=document.implementation;return a.createHTMLDocument&&(r=a.createHTMLDocument(""),dt.each("BODY"===t.nodeName?t.childNodes:[t],(function(e){r.body.appendChild(r.importNode(e,!0))})),t="BODY"!==t.nodeName?r.body.firstChild:r.body,o=i.doc,i.doc=r),function(e,t){e.fire("PreProcess",t)}(e,Ee(Ee({},n),{node:t})),o&&(i.doc=o),t}(e,t,n):t},Fv=function(e,t,n){-1===dt.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},jv=function(e,t,n,r,o){return function(e,t,n){return!t.no_events&&e?function(e,t){return e.fire("PostProcess",t)}(e,Ee(Ee({},t),{content:n})).content:n}(e,o,function(e,t,n){return Cm(e,t).serialize(n)}(t,n,r))},Hv=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:Ka.DOM,o=t&&t.schema?t.schema:qo(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i=Mv(e,o);!function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n,r=e.length;r--;)(n=e[r]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)})),e.addAttributeFilter("src,href,style",(function(e,r){for(var o,i,a=e.length,c="data-mce-"+r,u=t.url_converter,l=t.url_converter_scope;a--;)void 0!==(i=(o=e[a]).attr(c))?(o.attr(r,i.length>0?i:null),o.attr(c,null)):(i=o.attr(r),"style"===r?i=n.serializeStyle(n.parseStyle(i),o.name):u&&(i=u.call(l,i,r,o.name)),o.attr(r,i.length>0?i:null))})),e.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)(n=(t=e[r]).attr("class"))&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",n.length>0?n:null))})),e.addAttributeFilter("data-mce-type",(function(e,t,n){for(var r,o=e.length;o--;){if("bookmark"===(r=e[o]).attr("data-mce-type")&&!n.cleanup)k.from(r.firstChild).exists((function(e){return!Lr(e.value)}))?r.unwrap():r.remove()}})),e.addNodeFilter("noscript",(function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=Po.decode(t.value))})),e.addNodeFilter("script,style",(function(e,n){for(var r,o,i,a=e.length,c=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};a--;)o=(r=e[a]).firstChild?r.firstChild.value:"","script"===n?((i=r.attr("type"))&&r.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="// <![CDATA[\n"+c(o)+"\n// ]]>")):"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="\x3c!--\n"+c(o)+"\n--\x3e")})),e.addNodeFilter("#comment",(function(e){for(var r,o=e.length;o--;)r=e[o],t.preserve_cdata&&0===r.value.indexOf("[CDATA[")?(r.name="#cdata",r.type=4,r.value=n.decode(r.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===r.value.indexOf("mce:protected ")&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(r.value).substr(14))})),e.addNodeFilter("xml:namespace,input",(function(e,t){for(var n,r=e.length;r--;)7===(n=e[r]).type?n.remove():1===n.type&&("input"!==t||n.attr("type")||n.attr("type","text"))})),e.addAttributeFilter("data-mce-type",(function(t){q(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}))}(i,e,r);return{schema:o,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:function(n,a){void 0===a&&(a={});var c=Ee({format:"html"},a),u=Lv(t,n,c),l=function(e,t,n){var r=Fr(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Mr(pt.fromDom(t))?r:dt.trim(r)}(r,u,c),s=function(e,t,n){var r=n.selection?Ee({forced_root_block:!1},n):n,o=e.parse(t,r);return function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var r=n.prev;t(r)&&(n.remove(),r.remove())}}(o),o}(i,l,c);return"tree"===c.format?s:jv(t,e,o,s,c)},addRules:function(e){o.addValidElements(e)},setRules:function(e){o.setValidElements(e)},addTempAttr:p(Fv,i,n),getTempAttrs:function(){return n},getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters}},Uv=function(e,t){var n=Hv(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},zv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return cv(e).editor.getContent(t,n)}(e,t,t.format?t.format:"html")},Wv=function(e,t,n){return void 0===n&&(n={}),function(e,t,n){return cv(e).editor.setContent(t,n)}(e,t,n)},qv=Ka.DOM,Vv=function(e){return k.from(e).each((function(e){return e.destroy()}))},$v=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&qv.remove(o.nextSibling),function(e){e.fire("remove")}(e),e.editorManager.remove(e),!e.inline&&r&&function(e){qv.setStyle(e.id,"display",e.orgDisplay)}(e),function(e){e.fire("detach")}(e),qv.remove(e.getContainer()),Vv(t),Vv(n),e.destroy()}},Kv=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Vv(n),Vv(r)),function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),qv.unbind(t,"submit reset",e.formEventDelegate))}(e),function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)}(e),e.destroyed=!0):e.remove())},Jv=Object.prototype.hasOwnProperty,Gv=(Ev=function(e,t){return A(e)&&A(t)?Gv(e,t):t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)Jv.call(o,i)&&(n[i]=Ev(n[i],o[i]))}return n}),Xv=Qe().deviceType,Yv=Xv.isTouch(),Qv=Xv.isPhone(),Zv=Xv.isTablet(),eb=["lists","autolink","autosave"],tb={table_grid:!1,object_resizing:!1,resize:!1},nb=function(e){var t=N(e)?e.join(" "):e,n=W(_(t)?t.split(" "):[],Le);return $(n,(function(e){return e.length>0}))},rb=function(e,t){var n=de(t,(function(t,n){return U(e,n)}));return function(e,t){return{sections:d(e),settings:d(t)}}(n.t,n.f)},ob=function(e,t){return e.sections().hasOwnProperty(t)},ib=function(e,t){return ge(e,"toolbar_mode").orThunk((function(){return ge(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},ab=function(e,t){var n={resize:!1,toolbar_mode:ib(e,"scrolling"),toolbar_sticky:!1};return Ee(Ee(Ee({},tb),n),t?{menubar:!1}:{})},cb=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?dt.extend({},e.external_plugins,n):n},ub=function(e,t,n,r){return e&&function(e,t,n){var r=e.sections();return ob(e,t)&&r[t].theme===n}(t,"mobile","mobile")?$(r,p(U,eb)):e&&ob(t,"mobile")?r:n},lb=function(e,t,n,r){var o=nb(n.forced_plugins),i=nb(r.plugins),a=function(e,t){return ob(e,t)?e.sections()[t]:{}}(t,"mobile"),c=a.plugins?nb(a.plugins):i,u=function(e,t){return[].concat(nb(e)).concat(nb(t))}(o,ub(e,t,i,c));if(ct.browser.isIE()&&U(u,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return dt.extend(r,{plugins:u.join(" ")})},sb=function(e,t,n,r,o){var i=e?{mobile:ab(o.mobile||{},t)}:{},a=rb(["mobile"],Gv(i,o)),c=dt.extend(n,r,a.settings(),function(e,t){return e&&ob(t,"mobile")}(e,a)?function(e,t,n){void 0===n&&(n={});var r=e.sections(),o=r.hasOwnProperty(t)?r[t]:{};return dt.extend({},n,o)}(a,"mobile"):{},{validate:!0,external_plugins:cb(r,a.settings())});return lb(e,a,r,c)},fb=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i={id:t,theme:"silver",toolbar_mode:ib(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:o.convertURL,url_converter_scope:o};return Ee(Ee({},i),r?tb:{})}(o,t,n,Yv,e);return sb(Qv||Zv,Qv,i,r,o)},db=function(e,t,n){return k.from(t.settings[n]).filter(e)},mb=function(e,t,n,r){var o,i=t in e.settings?e.settings[t]:n;return"hash"===r?function(e){var t={};return"string"==typeof e?q(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[dt.trim(n[0])]=dt.trim(n[1]):t[dt.trim(n[0])]=dt.trim(n[0])})):t=e,t}(i):"string"===r?db(_,e,t).getOr(n):"number"===r?db(M,e,t).getOr(n):"boolean"===r?db(O,e,t).getOr(n):"object"===r?db(A,e,t).getOr(n):"array"===r?db(N,e,t).getOr(n):"string[]"===r?db((o=_,function(e){return N(e)&&Q(e,o)}),e,t).getOr(n):"function"===r?db(B,e,t).getOr(n):i},pb=(_v={},{add:function(e,t){_v[e]=t},get:function(e){return _v[e]?_v[e]:{icons:{}}},has:function(e){return he(_v,e)}}),gb=function(e,t){return t.dom[e]},hb=function(e,t){return parseInt(Hn(t,e),10)},vb=p(gb,"clientWidth"),bb=p(gb,"clientHeight"),yb=p(hb,"margin-top"),wb=p(hb,"margin-left"),Cb=function(e,t,n){var r,o=pt.fromDom(e.getBody()),i=e.inline?o:(r=o,pt.fromDom(Nt(r).dom.documentElement)),a=function(e,t,n,r){var o=function(e){return e.dom.getBoundingClientRect()}(t);return{x:n-(e?o.left+t.dom.clientLeft+wb(t):0),y:r-(e?o.top+t.dom.clientTop+yb(t):0)}}(e.inline,i,t,n);return function(e,t,n){var r=vb(e),o=bb(e);return t>=0&&n>=0&&t<=r&&n<=o}(i,a.x,a.y)},xb=function(e){var t,n=e.inline?e.getBody():e.getContentAreaContainer();return(t=n,k.from(t).map(pt.fromDom)).map(tn).getOr(!1)};function kb(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},r=function(){return k.from(t[0])},o=function(){t.length>0&&n().reposition(t)},i=function(e){X(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},a=function(a,c){if(void 0===c&&(c=!0),!e.removed&&xb(e))return c&&e.fire("BeforeOpenNotification",{notification:a}),G(t,(function(e){return t=n().getArgs(e),r=a,!(t.type!==r.type||t.text!==r.text||t.progressBar||t.timeout||r.progressBar||r.timeout);var t,r})).getOrThunk((function(){e.editorManager.setActive(e);var c=n().open(a,(function(){i(c),o(),r().fold((function(){return e.focus()}),(function(e){return pt.fromDom(e.getEl()).dom.focus()}))}));return function(e){t.push(e)}(c),o(),e.fire("OpenNotification",Ee({},c)),c}))};return function(e){e.on("SkinLoaded",(function(){var t=function(e){return e.getParam("service_message")}(e);t&&a({text:t,type:"warning",timeout:0},!1)})),e.on("ResizeEditor ResizeWindow NodeChange",(function(){wr.requestAnimationFrame(o)})),e.on("remove",(function(){q(t.slice(),(function(e){n().close(e)}))}))}(e),{open:a,close:function(){r().each((function(e){n().close(e),i(e),o()}))},getNotifications:function(){return t}}}var Sb=oc.PluginManager,Tb=oc.ThemeManager;var Eb=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){return t?t.apply(e,arguments):void 0}},o=function(n){t.push(n),function(t){e.fire("OpenWindow",{dialog:t})}(n)},i=function(n){!function(t){e.fire("CloseWindow",{dialog:t})}(n),0===(t=$(t,(function(e){return e!==n}))).length&&e.focus()},a=function(t){e.editorManager.setActive(e),Bd(e);var n=t();return o(n),n};return e.on("remove",(function(){q(t,(function(e){n().close(e)}))})),{open:function(e,t){return a((function(){return n().open(e,t,i)}))},openUrl:function(e){return a((function(){return n().openUrl(e,i)}))},alert:function(e,t,o){n().alert(e,r(o||this,t))},confirm:function(e,t,o){n().confirm(e,r(o||this,t))},close:function(){k.from(t[t.length-1]).each((function(e){n().close(e),i(e)}))}}},_b=function(e,t){e.notificationManager.open({type:"error",text:t})},Ab=function(e,t){e._skinLoaded?_b(e,t):e.on("SkinLoaded",(function(){_b(e,t)}))},Nb=function(e,t,n){!function(e,t,n){e.fire(t,n)}(e,t,{message:n}),console.error(n)},Rb=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},Ob=function(e,t,n){Nb(e,"PluginLoadError",Rb("plugin",t,n))},Db=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,_e([e],t)):r.log.apply(r,_e([e],t)))},Ib=function(e){var t=function(e){var t=e.getParam("content_css");return _(t)?W(t.split(","),Le):N(t)?t:!1===t||e.inline?[]:["default"]}(e),n=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",o=!0===e.inline;return W(t,(function(t){return function(e){return/^[a-z0-9\-]+$/i.test(e)}(t)&&!o?n+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)}))};function Pb(e,t){var n={},r=function(e,n,r,o){var i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){if(i.status<200||i.status>=300)r("HTTP Error: "+i.status);else{var e,o,a=JSON.parse(i.responseText);if(a&&"string"==typeof a.location)n((e=t.basePath,o=a.location,e?e.replace(/\/$/,"")+"/"+o.replace(/^\//,""):o));else r("Invalid JSON: "+i.responseText)}};var a=new FormData;a.append("file",e.blob(),e.filename()),i.send(a)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},a=function(e,t){dt.each(n[e],(function(e){e(t)})),delete n[e]},c=function(r,c){return r=dt.grep(r,(function(t){return!e.isUploaded(t.blobUri())})),hr.all(dt.map(r,(function(r){return e.isPending(r.blobUri())?function(e){var t=e.blobUri();return new hr((function(e){n[t]=n[t]||[],n[t].push(e)}))}(r):function(t,n,r){return e.markPending(t.blobUri()),new hr((function(c){var u,l=function(){};try{var s=function(){u&&(u.close(),l)};n(t,(function(n){s(),e.markUploaded(t.blobUri(),n),a(t.blobUri(),o(t,n)),c(o(t,n))}),(function(n,r){var o=r||{};s(),e.removeFailed(t.blobUri()),a(t.blobUri(),i(t,n,o)),c(i(t,n,o))}),(function(e){e<0||e>100||(u||(u=r()),u.progressBar.value(e))}))}catch(e){c(i(t,e.message,{}))}}))}(r,t.handler,c)})))};return!1===B(t.handler)&&(t.handler=r),{upload:function(e,n){return t.url||t.handler!==r?c(e,n):new hr((function(e){e([])}))}}}var Bb=0,Mb=function(e){return e+Bb+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},Lb=function(e){var t,n,r,o,i,a=function(){var e=[],t=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t,n=e.id||Mb("blobid"),r=e.name||n,o=e.blob;return{id:d(n),name:d(r),filename:d(e.filename||r+"."+(t=o.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[t.toLowerCase()]||"dat")),blob:d(o),base64:d(e.base64),blobUri:d(e.blobUri||URL.createObjectURL(o)),uri:d(e.uri)}},n=function(t){return G(e,t).getOrUndefined()},r=function(e){return n((function(t){return t.id()===e}))};return{create:function(e,n,r,o,i){if(_(e))return t({id:e,name:o,filename:i,blob:n,base64:r});if(A(e))return t(e);throw new Error("Unknown input type")},add:function(t){r(t.id())||e.push(t)},get:r,getByUri:function(e){return n((function(t){return t.blobUri()===e}))},getByData:function(e,t){return n((function(n){return n.base64()===e&&n.blob().type===t}))},findFirst:n,removeByUri:function(t){e=$(e,(function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)}))},destroy:function(){q(e,(function(e){URL.revokeObjectURL(e.blobUri())})),e=[]}}}(),c=(r={},o=function(e,t){return{status:e,resultUri:t}},{hasBlobUri:i=function(e){return e in r},getResultUri:function(e){var t=r[e];return t?t.resultUri:null},isPending:function(e){return!!i(e)&&1===r[e].status},isUploaded:function(e){return!!i(e)&&2===r[e].status},markPending:function(e){r[e]=o(1,null)},markUploaded:function(e,t){r[e]=o(2,t)},removeFailed:function(e){delete r[e]},destroy:function(){r={}}}),u=[],l=function(e){var t=Qa(null);e.on("change AddUndo",(function(e){t.set(Ee({},e.level))}));return{fireIfChanged:function(){var n=e.undoManager.data;re(n).filter((function(e){return!Qh(t.get(),e)})).each((function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:te(n,n.length-2).getOrNull()})}))}}}(e),s=function(t){return function(n){return e.selection?t(n):[]}},f=function(e,t,n){var r=0;do{-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},m=function(e,t,n){var r='src="'+n+'"'+(n===ct.transparentSrc?' data-mce-placeholder="1"':"");return e=f(e,'src="'+t+'"',r),e=f(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},p=function(t,n){q(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=W(e.fragments,(function(e){return m(e,t,n)})):e.content=m(e.content,t,n)}))},g=function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},h=function(n){return t||(t=Pb(c,{url:Hu(e),basePath:Uu(e),credentials:zu(e),handler:Wu(e)})),w().then(s((function(r){var o=W(r,(function(e){return e.blobInfo}));return t.upload(o,g).then(s((function(t){var o=[],i=W(t,(function(t,n){var i=r[n].blobInfo,c=r[n].image;return t.status&&function(e){return e.getParam("images_replace_blob_uris",!0,"boolean")}(e)?(a.removeByUri(c.src),function(t,n){var r,o=e.convertURL(n,"src");p(t.src,n),e.$(t).attr({src:Fu(e)?(r=n,r+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime()):n,"data-mce-src":o})}(c,t.url)):t.error&&(t.error.options.remove&&(p(c.getAttribute("src"),ct.transparentSrc),o.push(c)),function(e,t){Ab(e,nc.translate(["Failed to upload image: {0}",t]))}(e,t.error.message)),{element:c,status:t.status,uploadUri:t.url,blobInfo:i}}));return i.length>0&&l.fireIfChanged(),o.length>0&&(av(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){q(o,(function(t){e.dom.remove(t),a.removeByUri(t.src)}))}))),n&&n(i),i})))})))},v=function(t){if(Lu(e))return h(t)},b=function(t){return!1!==Q(u,(function(e){return e(t)}))&&(0!==t.getAttribute("src").indexOf("data:")||function(e){return e.getParam("images_dataimg_filter",y,"function")}(e)(t))},w=function(){return n||(n=Tv(c,a)),n.findAll(e.getBody(),b).then(s((function(t){return t=$(t,(function(t){return"string"!=typeof t||(Ab(e,t),!1)})),q(t,(function(e){p(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},C=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var r=c.getResultUri(n);if(r)return'src="'+r+'"';var o=a.getByUri(n);return o||(o=J(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),o?'src="data:'+o.blob().type+";base64,"+o.base64()+'"':t}))};return e.on("SetContent",(function(){Lu(e)?v():w()})),e.on("RawSaveContent",(function(e){e.content=C(e.content)})),e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=C(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){q(e,(function(e){var t=e.attr("src");if(!a.getByUri(t)){var n=c.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:a,addFilter:function(e){u.push(e)},uploadImages:h,uploadImagesAuto:v,scanForImages:w,destroy:function(){a.destroy(),c.destroy(),n=t=null}}};function Fb(e){var t={},n=function(e,r){e&&("string"!=typeof e?dt.each(e,(function(e,t){n(t,e)})):(N(r)||(r=[r]),dt.each(r,(function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))})),t[e]=r))};return n(function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return pn(e)&&e.hasAttribute("href")},onformat:function(t,n,r){dt.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return dt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t}(e.dom)),n(function(e){return e.getParam("formats")}(e)),{get:function(e){return e?t[e]:t},has:function(e){return he(t,e)},register:n,unregister:function(e){return e&&t[e]&&delete t[e],t}}}var jb,Hb=dt.each,Ub=Ka.DOM,zb=function(e,t){var n,r,o,i=t&&t.schema||qo({}),a=function(e){r="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t=Ub.create(r.name);return function(e,t){t.classes.length&&Ub.addClass(e,t.classes.join(" ")),Ub.setAttribs(e,t.attrs)}(t,r),t},c=function(e,t,n){var r,o,u=t.length>0&&t[0],l=u&&u.name,s=function(e,t){var n="string"!=typeof e?e.nodeName.toLowerCase():e,r=i.getElementRule(n),o=r&&r.parentsRequired;return!(!o||!o.length)&&(t&&-1!==dt.inArray(o,t)?t:o[0])}(e,l);if(s)l===s?(o=t[0],t=t.slice(1)):o=s;else if(u)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=a(o)).appendChild(e),n&&(r||(r=Ub.create("div")).appendChild(e),dt.each(n,(function(t){var n=a(t);r.insertBefore(n,e)}))),c(r,t,o&&o.siblings)};return e&&e.length?(r=e[0],n=a(r),(o=Ub.create("div")).appendChild(c(n,e.slice(1),r.siblings)),o):""},Wb=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=dt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==dt.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}if("["===o){var a=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},qb=function(e,t){var n,r,o,i="",a=function(e){var t=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");return _(t)?t:""}(e);if(""===a)return"";var c=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var u=ge(t,"preview");if(u.is(!1))return"";a=u.getOr(a)}n=t.block||t.inline||"span";var l,s=(l=t.selector)&&"string"==typeof l?(l=(l=l.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),dt.map(l.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=dt.map(e.split(/(?:~\+|~|\+)/),Wb),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[];s.length?(s[0].name||(s[0].name=n),n=t.selector,r=zb(s,e)):r=zb([n],e);var f=Ub.select(n,r)[0]||r.firstChild;return Hb(t.styles,(function(e,t){var n=c(e);n&&Ub.setStyle(f,t,n)})),Hb(t.attributes,(function(e,t){var n=c(e);n&&Ub.setAttrib(f,t,n)})),Hb(t.classes,(function(e){var t=c(e);Ub.hasClass(f,t)||Ub.addClass(f,t)})),e.fire("PreviewFormats"),Ub.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),o=Ub.getStyle(e.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,Hb(a.split(" "),(function(t){var n=Ub.getStyle(f,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=Ub.getStyle(e.getBody(),t,!0),"#ffffff"===Ub.toHex(n).toLowerCase())||"color"===t&&"#000000"===Ub.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===o)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*o+"px"}"border"===t&&n&&(i+="padding:0 2px;"),i+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),Ub.remove(r),i},Vb=function(e){var t=Fb(e),n=Qa(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),zg(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){!function(e,t,n,r){uv(e).formatter.apply(t,n,r)}(e,t,n,r)},remove:function(t,n,r,o){!function(e,t,n,r,o){uv(e).formatter.remove(t,n,r,o)}(e,t,n,r,o)},toggle:function(t,n,r){!function(e,t,n,r){uv(e).formatter.toggle(t,n,r)}(e,t,n,r)},match:function(t,n,r){return function(e,t,n,r){return uv(e).formatter.match(t,n,r)}(e,t,n,r)},closest:function(t){return function(e,t){return uv(e).formatter.closest(t)}(e,t)},matchAll:function(t,n){return function(e,t,n){return uv(e).formatter.matchAll(t,n)}(e,t,n)},matchNode:function(t,n,r,o){return function(e,t,n,r,o){return uv(e).formatter.matchNode(t,n,r,o)}(e,t,n,r,o)},canApply:function(t){return function(e,t){return uv(e).formatter.canApply(t)}(e,t)},formatChanged:function(t,r,o){return function(e,t,n,r,o){return void 0===o&&(o=!1),uv(e).formatter.formatChanged(t,n,r,o)}(e,n,t,r,o)},getCssText:p(qb,e)}},$b=function(e){var t=Qa(k.none()),n=Qa(0),r=Qa(0),o={data:[],typing:!1,beforeChange:function(){!function(e,t,n){uv(e).undoManager.beforeChange(t,n)}(e,n,t)},add:function(i,a){return function(e,t,n,r,o,i,a){return uv(e).undoManager.addUndoLevel(t,n,r,o,i,a)}(e,o,r,n,t,i,a)},undo:function(){return function(e,t,n,r){return uv(e).undoManager.undo(t,n,r)}(e,o,n,r)},redo:function(){return function(e,t,n){return uv(e).undoManager.redo(t,n)}(e,r,o.data)},clear:function(){!function(e,t,n){uv(e).undoManager.clear(t,n)}(e,o,r)},reset:function(){!function(e,t){uv(e).undoManager.reset(t)}(e,o)},hasUndo:function(){return function(e,t,n){return uv(e).undoManager.hasUndo(t,n)}(e,o,r)},hasRedo:function(){return function(e,t,n){return uv(e).undoManager.hasRedo(t,n)}(e,o,r)},transact:function(t){return function(e,t,n,r){return uv(e).undoManager.transact(t,n,r)}(e,o,n,t)},ignore:function(t){!function(e,t,n){uv(e).undoManager.ignore(t,n)}(e,n,t)},extra:function(t,n){!function(e,t,n,r,o){uv(e).undoManager.extra(t,n,r,o)}(e,o,r,t,n)}};return av(e)||function(e,t,n){var r=Qa(!1),o=function(e){ev(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var r=e.command.toLowerCase();"undo"!==r&&"redo"!==r&&"mcerepaint"!==r&&(tv(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&o(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",(function(n){var i=n.keyCode;n.isDefaultPrevented()||((i>=33&&i<=36||i>=37&&i<=40||45===i||n.ctrlKey)&&(o(),e.nodeChanged()),46!==i&&8!==i||e.nodeChanged(),r.get()&&t.typing&&!1===Qh(Jh(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var i=e.keyCode;if(!e.isDefaultPrevented())if(i>=33&&i<=36||i>=37&&i<=40||45===i)t.typing&&o(e);else{var a=e.ctrlKey&&!e.altKey||e.metaKey;!(i<16||i>20)||224===i||91===i||t.typing||a||(t.beforeChange(),ev(t,!0,n),t.add({},e),r.set(!0))}})),e.on("mousedown",(function(e){t.typing&&o(e)}));e.on("input",(function(e){e.inputType&&("insertReplacementText"===e.inputType||function(e){return"insertText"===e.inputType&&null===e.data}(e)||function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType}(e))&&o(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))}(e,o,n),function(e){e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")}(e),o},Kb=[9,27,Df.HOME,Df.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Df.DOWN,Df.UP,Df.LEFT,Df.RIGHT].concat(ct.browser.isFirefox()?[224]:[]),Jb=function(e){return"keydown"===e.type||"keyup"===e.type},Gb=function(e){var t=e.keyCode;return t===Df.BACKSPACE||t===Df.DELETE},Xb=function(e){var t=e.dom,n=Bu(e),r=function(e){return e.getParam("placeholder",Du.getAttrib(e.getElement(),"placeholder"),"string")}(e),o=function(i,a){if(!function(e){if(Jb(e)){var t=e.keyCode;return!Gb(e)&&(Df.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||U(Kb,t))}return!1}(i)){var c=e.getBody(),u=!function(e){return Jb(e)&&!(Gb(e)||"keyup"===e.type&&229===e.keyCode)}(i)&&function(e,t,n){if(ho(pt.fromDom(t),!1)){var r=""===n,o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(o):n===o.nodeName.toLowerCase())}return!1}(t,c,n);(""!==t.getAttrib(c,"data-mce-placeholder")!==u||a)&&(t.setAttrib(c,"data-mce-placeholder",u?r:null),t.setAttrib(c,"aria-placeholder",u?r:null),function(e,t){e.fire("PlaceholderToggle",{state:t})}(e,u),e.on(u?"keydown":"keyup",o),e.off(u?"keyup":"keydown",o))}};r&&e.on("init",(function(t){o(t,!0),e.on("change SetContent ExecCommand",o),e.on("paste",(function(t){return wr.setEditorTimeout(e,(function(){return o(t)}))}))}))},Yb=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Qb=function(e,t){return ht(pt.fromDom(t),function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")}(e))},Zb=function(e){return"rtl"===Ka.DOM.getStyle(e,"direction",!0)||(t=e.textContent,Yb.test(t));var t},ey=function(e,t,n){var r=function(e,t,n){return $(Ka.DOM.getParents(n.container(),"*",t),e)}(e,t,n);return k.from(r[r.length-1])},ty=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?zr(n)?xn(n.nextSibling)?lu(n.nextSibling,0):lu.after(n):Vr(t)?lu(n,r+1):t:zr(n)?xn(n.previousSibling)?lu(n.previousSibling,n.previousSibling.data.length):lu.before(n):$r(t)?lu(n,r-1):t},ny=p(ty,!0),ry=p(ty,!1),oy=function(e,t){return wt(e,t)?fr(t,(function(e){return Or(e)||Ir(e)}),function(e){return function(t){return bt(e,pt.fromDom(t.dom.parentNode))}}(e)):k.none()},iy=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)}(e))},ay=function(e,t){return{from:e,to:t}},cy=function(e,t){var n=pt.fromDom(e),r=pt.fromDom(t.container());return oy(n,r).map((function(e){return function(e,t){return{block:e,position:t}}(e,t)}))},uy=function(e,t,n){var r=cy(e,lu.fromRangeStart(n)),o=r.bind((function(n){return cs(t,e,n.position).bind((function(n){return cy(e,n).map((function(n){return function(e,t,n){return En(n.position.getNode())&&!1===ho(n.block)?ss(!1,n.block.dom).bind((function(r){return r.isEqual(n.position)?cs(t,e,r).bind((function(t){return cy(e,t)})):k.some(n)})).getOr(n):n}(e,t,n)}))}))}));return Oc(r,o,ay).filter((function(e){return function(e){return!1===bt(e.from.block,e.to.block)}(e)&&function(e){return Ot(e.from.block).bind((function(t){return Ot(e.to.block).filter((function(e){return bt(t,e)}))})).isSome()}(e)&&function(e){return!1===Nn(e.from.block.dom)&&!1===Nn(e.to.block.dom)}(e)}))},ly=function(e){var t=Mt(e);return X(t,Ar).fold((function(){return t}),(function(e){return t.slice(0,e)}))},sy=function(e){var t=ly(e);return q(t,Zt),t},fy=function(e,t){var n=ep(t,e);return G(n.reverse(),(function(e){return ho(e)})).each(Zt)},dy=function(e,t,n,r){if(ho(n))return Xm(n),ms(n.dom);0===$(Pt(r),(function(e){return!ho(e)})).length&&ho(t)&&Kt(r,pt.fromTag("br"));var o=ds(n.dom,lu.before(r.dom));return q(sy(t),(function(e){Kt(r,e)})),fy(e,t),o},my=function(e,t,n){if(ho(n))return Zt(n),ho(t)&&Xm(t),ms(t.dom);var r=ps(n.dom);return q(sy(t),(function(e){Xt(n,e)})),fy(e,t),r},py=function(e,t){return wt(t,e)?function(e,t){var n=ep(t,e);return k.from(n[n.length-1])}(t,e):k.none()},gy=function(e,t){ss(e,t.dom).map((function(e){return e.getNode()})).map(pt.fromDom).filter(Rr).each(Zt)},hy=function(e,t,n){return gy(!0,t),gy(!1,n),py(t,n).fold(p(my,e,t,n),p(dy,e,t,n))},vy=function(e,t,n,r){return t?hy(e,r,n):hy(e,n,r)},by=function(e,t){var n=pt.fromDom(e.getBody()),r=function(e,t,n){return n.collapsed?uy(e,t,n):k.none()}(n.dom,t,e.selection.getRng()).bind((function(e){return vy(n,t,e.from.block,e.to.block)}));return r.each((function(t){e.selection.setRng(t.toRange())})),r.isSome()},yy=function(e,t){var n=pt.fromDom(t),r=p(bt,e);return sr(n,Br,r).isSome()},wy=function(e,t){var n=ds(e.dom,lu.fromRangeStart(t)).isNone(),r=fs(e.dom,lu.fromRangeEnd(t)).isNone();return!function(e,t){return yy(e,t.startContainer)||yy(e,t.endContainer)}(e,t)&&n&&r},Cy=function(e){var t=pt.fromDom(e.getBody()),n=e.selection.getRng();return wy(t,n)?function(e){return e.setContent(""),e.selection.setCursorLocation(),!0}(e):function(e,t){var n=t.getRng();return Oc(oy(e,pt.fromDom(n.startContainer)),oy(e,pt.fromDom(n.endContainer)),(function(r,o){return!1===bt(r,o)&&(n.deleteContents(),vy(e,!0,r,o).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)}(t,e.selection)},xy=function(e,t){return!e.selection.isCollapsed()&&Cy(e)},ky=An,Sy=Nn,Ty=function(e,t,n,r,o){return k.from(t._selectionOverrides.showCaret(e,n,r,o))},Ey=function(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?k.none():k.some(function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t}(t))},_y=function(e,t,n){var r=jl(1,e.getBody(),t),o=lu.fromRangeStart(r),i=o.getNode();if(bl(i))return Ty(1,e,i,!o.isAtEnd(),!1);var a=o.getNode(!0);if(bl(a))return Ty(1,e,a,!1,!1);var c=e.dom.getParent(o.getNode(),(function(e){return Sy(e)||ky(e)}));return bl(c)?Ty(1,e,c,!1,n):k.none()},Ay=function(e,t,n){return t.collapsed?_y(e,t,n).getOr(t):t},Ny=function(e){return Km(e)||Wm(e)},Ry=function(e){return Jm(e)||qm(e)},Oy=function(e,t,n,r,o,i){return Ty(r,e,i.getNode(!o),o,!0).each((function(n){if(t.collapsed){var r=t.cloneRange();o?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),function(e,t){xn(t)&&0===t.data.length&&e.remove(t)}(e.dom,n),!0},Dy=function(e,t){return function(e,t){var n=e.selection.getRng();if(!xn(n.commonAncestorContainer))return!1;var r=t?uu.Forwards:uu.Backwards,o=ns(e.getBody()),i=p(Wl,t?o.next:o.prev),a=t?Ny:Ry,c=Ul(r,e.getBody(),n),u=ty(t,i(c));if(!u||!ql(c,u))return!1;if(a(u))return Oy(e,n,c.getNode(),r,t,u);var l=i(u);return!!(l&&a(l)&&ql(u,l))&&Oy(e,n,c.getNode(),r,t,l)}(e,t)},Iy=ar([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Py=function(e,t,n,r){var o=r.getNode(!1===t);return oy(pt.fromDom(e),pt.fromDom(n.getNode())).map((function(e){return ho(e)?Iy.remove(e.dom):Iy.moveToElement(o)})).orThunk((function(){return k.some(Iy.moveToElement(o))}))},By=function(e,t,n){return cs(t,e,n).bind((function(r){return o=r.getNode(),Br(pt.fromDom(o))||Ir(pt.fromDom(o))||function(e,t,n,r){var o=function(t){return Nr(pt.fromDom(t))&&!Dl(n,r,e)};return Hl(!t,n).fold((function(){return Hl(t,r).fold(b,o)}),o)}(e,t,n,r)?k.none():t&&Nn(r.getNode())||!1===t&&Nn(r.getNode(!0))?Py(e,t,n,r):t&&Jm(n)||!1===t&&Km(n)?k.some(Iy.moveToPosition(r)):k.none();var o}))},My=function(e,t,n){return function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return pn(n)&&n.getAttribute("data-mce-caret")===r}(t,n)?function(e,t){return e&&Nn(t.nextSibling)?k.some(Iy.moveToElement(t.nextSibling)):!1===e&&Nn(t.previousSibling)?k.some(Iy.moveToElement(t.previousSibling)):k.none()}(t,n.getNode(!1===t)).fold((function(){return By(e,t,n)}),k.some):By(e,t,n).bind((function(t){return function(e,t,n){return n.fold((function(e){return k.some(Iy.remove(e))}),(function(e){return k.some(Iy.moveToElement(e))}),(function(n){return Dl(t,n,e)?k.none():k.some(Iy.moveToPosition(n))}))}(e,n,t)}))},Ly=function(e,t){return k.from(Rf(e.getBody(),t))},Fy=function(e,t){var n=e.selection.getNode();return Ly(e,n).filter(Nn).fold((function(){return function(e,t,n){var r=jl(t?1:-1,e,n),o=lu.fromRangeStart(r),i=pt.fromDom(e);return!1===t&&Jm(o)?k.some(Iy.remove(o.getNode(!0))):t&&Km(o)?k.some(Iy.remove(o.getNode())):!1===t&&Km(o)&&dp(i,o)?mp(i,o).map((function(e){return Iy.remove(e.getNode())})):t&&Jm(o)&&fp(i,o)?pp(i,o).map((function(e){return Iy.remove(e.getNode())})):My(e,t,o)}(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),Wp(e,t,pt.fromDom(n)),!0}}(e,t),function(e,t){return function(n){var r=t?lu.before(n):lu.after(n);return e.selection.setRng(r.toRange()),!0}}(e,t),function(e){return function(t){return e.selection.setRng(t.toRange()),!0}}(e))}))}),y)},jy=function(e,t){var n=e.selection.getNode();return!!Nn(n)&&Ly(e,n.parentNode).filter(Nn).fold((function(){var n;return n=pt.fromDom(e.getBody()),q(gc(n,".mce-offscreen-selection"),Zt),Wp(e,t,pt.fromDom(e.selection.getNode())),iy(e),!0}),(function(){return!0}))},Hy=function(e){var t=e.dom,n=e.selection,r=Rf(e.getBody(),n.getNode());if(An(r)&&t.isBlock(r)&&t.isEmpty(r)){var o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(r,""),r.appendChild(o),n.setRng(lu.before(o).toRange())}return!0},Uy=function(e,t){return e.selection.isCollapsed()?Fy(e,t):jy(e,t)},zy=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n=lu.fromRangeStart(e.selection.getRng());return cs(t,e.getBody(),n).filter((function(e){return t?Um(e):zm(e)})).bind((function(e){return k.from(Il(t?0:-1,e))})).exists((function(t){return e.selection.select(t),!0}))}(e,t)},Wy=xn,qy=function(e){return Wy(e)&&"\ufeff"===e.data[0]},Vy=function(e){return Wy(e)&&"\ufeff"===e.data[e.data.length-1]},$y=function(e){return e.ownerDocument.createTextNode("\ufeff")},Ky=function(e,t){return e?function(e){if(Wy(e.previousSibling))return Vy(e.previousSibling)||e.previousSibling.appendData("\ufeff"),e.previousSibling;if(Wy(e))return qy(e)||e.insertData(0,"\ufeff"),e;var t=$y(e);return e.parentNode.insertBefore(t,e),t}(t):function(e){if(Wy(e.nextSibling))return qy(e.nextSibling)||e.nextSibling.insertData(0,"\ufeff"),e.nextSibling;if(Wy(e))return Vy(e)||e.appendData("\ufeff"),e;var t=$y(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}(t)},Jy=p(Ky,!0),Gy=p(Ky,!1),Xy=function(e,t){return xn(e.container())?Ky(t,e.container()):Ky(t,e.getNode())},Yy=function(e,t){var n=t.get();return n&&e.container()===n&&zr(n)},Qy=function(e,t){return t.fold((function(t){sl(e.get());var n=Jy(t);return e.set(n),k.some(lu(n,n.length-1))}),(function(t){return ms(t).map((function(t){if(Yy(t,e))return lu(e.get(),1);sl(e.get());var n=Xy(t,!0);return e.set(n),lu(n,1)}))}),(function(t){return ps(t).map((function(t){if(Yy(t,e))return lu(e.get(),e.get().length-1);sl(e.get());var n=Xy(t,!1);return e.set(n),lu(n,n.length-1)}))}),(function(t){sl(e.get());var n=Gy(t);return e.set(n),k.some(lu(n,1))}))},Zy=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return k.none()},ew=ar([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),tw=function(e,t){var n=Ol(t,e);return n||e},nw=function(e,t,n){var r=ny(n),o=tw(t,r.container());return ey(e,o,r).fold((function(){return fs(o,r).bind(p(ey,e,o)).map((function(e){return ew.before(e)}))}),k.none)},rw=function(e,t){return null===hs(e,t)},ow=function(e,t,n){return ey(e,t,n).filter(p(rw,t))},iw=function(e,t,n){var r=ry(n);return ow(e,t,r).bind((function(e){return ds(e,r).isNone()?k.some(ew.start(e)):k.none()}))},aw=function(e,t,n){var r=ny(n);return ow(e,t,r).bind((function(e){return fs(e,r).isNone()?k.some(ew.end(e)):k.none()}))},cw=function(e,t,n){var r=ry(n),o=tw(t,r.container());return ey(e,o,r).fold((function(){return ds(o,r).bind(p(ey,e,o)).map((function(e){return ew.after(e)}))}),k.none)},uw=function(e){return!1===Zb(sw(e))},lw=function(e,t,n){return Zy([nw,iw,aw,cw],[e,t,n]).filter(uw)},sw=function(e){return e.fold(m,m,m,m)},fw=function(e){return e.fold(d("before"),d("start"),d("end"),d("after"))},dw=function(e){return e.fold(ew.before,ew.before,ew.after,ew.after)},mw=function(e){return e.fold(ew.start,ew.start,ew.end,ew.end)},pw=function(e,t,n,r,o,i){return Oc(ey(t,n,r),ey(t,n,o),(function(t,r){return t!==r&&function(e,t,n){var r=Ol(t,e),o=Ol(n,e);return r&&r===o}(n,t,r)?ew.after(e?t:r):i})).getOr(i)},gw=function(e,t){return e.fold(y,(function(e){return r=t,!(fw(n=e)===fw(r)&&sw(n)===sw(r));var n,r}))},hw=function(e,t){return e?t.fold(f(k.some,ew.start),k.none,f(k.some,ew.after),k.none):t.fold(k.none,f(k.some,ew.before),k.none,f(k.some,ew.end))},vw=function(e,t,n,r){var o=ty(e,r),i=lw(t,n,o);return lw(t,n,o).bind(p(hw,e)).orThunk((function(){return function(e,t,n,r,o){var i=ty(e,o);return cs(e,n,i).map(p(ty,e)).fold((function(){return r.map(dw)}),(function(o){return lw(t,n,o).map(p(pw,e,t,n,i,o)).filter(p(gw,r))})).filter(uw)}(e,t,n,i,r)}))},bw=(p(vw,!1),p(vw,!0),function(e,t,n){var r=e?1:-1;return t.setRng(lu(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0}),yw=function(e,t){var n=t.selection.getRng(),r=e?lu.fromRangeEnd(n):lu.fromRangeStart(n);return!!function(e){return B(e.selection.getSel().modify)}(t)&&(e&&Vr(r)?bw(!0,t.selection,r):!(e||!$r(r))&&bw(!1,t.selection,r))},ww=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},Cw=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},xw=function(e,t,n){return Qy(t,n).map((function(t){return ww(e,t),n}))},kw=function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=lu.fromRangeStart(e.selection.getRng());lu.isTextPosition(n)&&!1===function(e){return Vr(e)||$r(e)}(n)&&(ww(e,ll(t.get(),n)),t.set(null))}},Sw=function(e,t,n){return!!Qu(e)&&function(e,t,n){var r=e.getBody(),o=lu.fromRangeStart(e.selection.getRng()),i=p(Qb,e);return vw(n,i,r,o).bind((function(n){return xw(e,t,n)}))}(e,t,n).isSome()},Tw=function(e,t,n){return!!Qu(t)&&yw(e,t)},Ew=function(e){var t=Qa(null),n=p(Qb,e);return e.on("NodeChange",(function(r){!Qu(e)||ct.browser.isIE()&&r.initial||(function(e,t,n){var r=W(gc(pt.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom})),o=$(r,e),i=$(n,e);q(ee(o,i),p(Cw,!1)),q(ee(i,o),p(Cw,!0))}(n,e.dom,r.parents),kw(e,t),function(e,t,n,r){if(t.selection.isCollapsed()){var o=$(r,e);q(o,(function(r){var o=lu.fromRangeStart(t.selection.getRng());lw(e,t.getBody(),o).bind((function(e){return xw(t,n,e)}))}))}}(n,e,t,r.parents))})),t},_w=p(Tw,!0),Aw=p(Tw,!1),Nw=function(e,t){return function(n){return Qy(t,n).exists((function(t){return ww(e,t),!0}))}},Rw=function(e,t,n,r){var o=e.getBody(),i=p(Qb,e);e.undoManager.ignore((function(){e.selection.setRng(function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n}(n,r)),e.execCommand("Delete"),lw(i,o,lu.fromRangeStart(e.selection.getRng())).map(mw).map(Nw(e,t))})),e.nodeChanged()},Ow=function(e,t,n,r){var o=function(e,t){var n=Ol(t,e);return n||e}(e.getBody(),r.container()),i=p(Qb,e),a=lw(i,o,r);return a.bind((function(e){return n?e.fold(d(k.some(mw(e))),k.none,d(k.some(dw(e))),k.none):e.fold(k.none,d(k.some(dw(e))),k.none,d(k.some(mw(e))))})).map(Nw(e,t)).getOrThunk((function(){var c=us(n,o,r),u=c.bind((function(e){return lw(i,o,e)}));return Oc(a,u,(function(){return ey(i,o,r).exists((function(t){return!!function(e){return Oc(ms(e),ps(e),(function(t,n){var r=ty(!0,t),o=ty(!1,n);return fs(e,r).forall((function(e){return e.isEqual(o)}))})).getOr(!0)}(t)&&(Wp(e,n,pt.fromDom(t)),!0)}))})).orThunk((function(){return u.bind((function(o){return c.map((function(o){return n?Rw(e,t,r,o):Rw(e,t,o,r),!0}))}))})).getOr(!1)}))},Dw=function(e,t,n){if(e.selection.isCollapsed()&&Qu(e)){var r=lu.fromRangeStart(e.selection.getRng());return Ow(e,t,n,r)}return!1},Iw=function(e){return 1===Mt(e).length},Pw=function(e,t,n,r){var o=p(Wg,t),i=W($(r,o),(function(e){return e.dom}));if(0===i.length)Wp(t,e,n);else{var a=function(e,t){var n=Mg(!1),r=Hg(t,n.dom);return Kt(pt.fromDom(e),n),Zt(pt.fromDom(e)),lu(r,0)}(n.dom,i);t.selection.setRng(a.toRange())}},Bw=function(e,t){var n=pt.fromDom(e.getBody()),r=pt.fromDom(e.selection.getStart()),o=$(function(e,t){var n=ep(t,e);return X(n,Ar).fold(d(n),(function(e){return n.slice(0,e)}))}(n,r),Iw);return re(o).exists((function(n){var r,i=lu.fromRangeStart(e.selection.getRng());return!(!function(e,t,n){return Oc(ms(n),ps(n),(function(r,o){var i=ty(!0,r),a=ty(!1,o),c=ty(!1,t);return e?fs(n,c).exists((function(e){return e.isEqual(a)&&t.isEqual(i)})):ds(n,c).exists((function(e){return e.isEqual(i)&&t.isEqual(a)}))})).getOr(!0)}(t,i,n.dom)||(r=n,gs(r.dom)&&Pg(r.dom)))&&(Pw(t,e,n,o),!0)}))},Mw=function(e,t){return!!e.selection.isCollapsed()&&Bw(e,t)},Lw=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),Wp(e,t,pt.fromDom(n)),!0},Fw=function(e,t){return e.selection.isCollapsed()?function(e,t){var n=t?Wm:qm,r=t?uu.Forwards:uu.Backwards,o=Ul(r,e.getBody(),e.selection.getRng());return n(o)?Lw(e,t,o.getNode(!t)):k.from(ty(t,o)).filter((function(e){return n(e)&&ql(o,e)})).exists((function(n){return Lw(e,t,n.getNode(!t))}))}(e,t):function(e,t){var n=e.selection.getNode();return!!On(n)&&Lw(e,t,n)}(e,t)},jw=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},Hw=function(e,t){return(e||"table"===Ct(t)?"margin":"padding")+("rtl"===Hn(t,"direction")?"-right":"-left")},Uw=function(e){var t=Ww(e);return!e.mode.isReadOnly()&&(t.length>1||function(e,t){return Q(t,(function(t){var n=Hw(Ku(e),t),r=zn(t,n).map(jw).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&r>0}))}(e,t))},zw=function(e){return Dr(e)||Ir(e)},Ww=function(e){return $(W(e.selection.getSelectedBlocks(),pt.fromDom),(function(e){return!zw(e)&&!function(e){return Ot(e).map(zw).getOr(!1)}(e)&&fr(e,(function(e){return An(e.dom)||Nn(e.dom)})).exists((function(e){return An(e.dom)}))}))},qw=function(e,t){var n=e.dom,r=e.selection,o=e.formatter,i=function(e){return e.getParam("indentation","40px","string")}(e),a=/[a-z%]+$/i.exec(i)[0],c=parseInt(i,10),u=Ku(e),l=Bu(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==l||n.getParent(r.getNode(),n.isBlock)||o.apply("div"),q(Ww(e),(function(e){!function(e,t,n,r,o,i){var a=Hw(n,pt.fromDom(i));if("outdent"===t){var c=Math.max(0,jw(i.style[a])-r);e.setStyle(i,a,c?c+o:"")}else{c=jw(i.style[a])+r+o;e.setStyle(i,a,c)}}(n,t,u,c,a,e.dom)}))},Vw=function(e,t){if(e.selection.isCollapsed()&&Uw(e)){var n=e.dom,r=e.selection.getRng(),o=lu.fromRangeStart(r),i=n.getParent(r.startContainer,n.isBlock);if(null!==i&&ip(pt.fromDom(i),o))return qw(e,"outdent"),!0}return!1},$w=function(e,t){e.getDoc().execCommand(t,!1,null)},Kw=function(e,t){e.addCommand("delete",(function(){!function(e,t){Vw(e)||Uy(e,!1)||Dy(e,!1)||Dw(e,t,!1)||by(e,!1)||hg(e)||zy(e,!1)||Fw(e,!1)||xy(e)||Mw(e,!1)||($w(e,"Delete"),iy(e))}(e,t)})),e.addCommand("forwardDelete",(function(){!function(e,t){Uy(e,!0)||Dy(e,!0)||Dw(e,t,!0)||by(e,!0)||hg(e)||zy(e,!0)||Fw(e,!0)||xy(e)||Mw(e,!0)||$w(e,"ForwardDelete")}(e,t)}))},Jw=function(e){return void 0===e.touches||1!==e.touches.length?k.none():k.some(e.touches[0])},Gw=function(e){var t=Qa(k.none()),n=Qa(!1),r=ac((function(t){e.fire("longpress",Ee(Ee({},t),{type:"longpress"})),n.set(!0)}),400);e.on("touchstart",(function(e){Jw(e).each((function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(k.some(i))}))}),!0),e.on("touchmove",(function(o){r.cancel(),Jw(o).each((function(r){t.get().each((function(o){(function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>5||r>5})(r,o)&&(t.set(k.none()),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&t.get().filter((function(e){return e.target.isEqualNode(o.target)})).each((function(){n.get()?o.preventDefault():e.fire("tap",Ee(Ee({},o),{type:"tap"}))}))}),!0)},Xw=function(e,t){return e.hasOwnProperty(t.nodeName)},Yw=function(e,t){return!!xn(t)||!!pn(t)&&(!Xw(e,t)&&!Es(t))},Qw=function(e,t){if(xn(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||Xw(e,t.nextSibling)))return!0}return!1},Zw=function(e){var t,n,r,o=e.dom,i=e.selection,a=e.schema,c=a.getBlockElements(),u=i.getStart(),l=e.getBody(),s=Bu(e);if(u&&pn(u)&&s){var f=l.nodeName.toLowerCase();if(a.isValidChild(f,s.toLowerCase())&&!function(e,t,n){return z(Zm(pt.fromDom(n),pt.fromDom(t)),(function(t){return Xw(e,t.dom)}))}(c,l,u)){var d=i.getRng(),m=d.startContainer,p=d.startOffset,g=d.endContainer,h=d.endOffset,v=Jd(e);for(u=l.firstChild;u;)if(Yw(c,u)){if(Qw(c,u)){n=u,u=u.nextSibling,o.remove(n);continue}t||(t=o.create(s,Mu(e)),u.parentNode.insertBefore(t,u),r=!0),n=u,u=u.nextSibling,t.appendChild(n)}else t=null,u=u.nextSibling;r&&v&&(d.setStart(m,p),d.setEnd(g,h),i.setRng(d),e.nodeChanged())}}},eC=function(e,t){t.hasAttribute("data-mce-caret")&&(Xr(t),function(e){e.selection.setRng(e.selection.getRng())}(e),e.selection.scrollIntoView(t))},tC=function(e,t){var n=function(e){return pr(pt.fromDom(e.getBody()),"*[data-mce-caret]").fold(d(null),(function(e){return e.dom}))}(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void eC(e,n)):void(qr(n)&&(eC(e,n),e.undoManager.add()))};!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(jb||(jb={}));var nC,rC=function(e,t){return e===uu.Backwards?Z(t):t},oC=function(e,t,n){return e===uu.Forwards?t.next(n):t.prev(n)},iC=function(e,t,n,r){return En(r.getNode(t===uu.Forwards))?jb.Br:!1===Dl(n,r)?jb.Block:jb.Wrap},aC=function(e,t,n,r){for(var o,i=ns(n),a=r,c=[];a&&(o=oC(t,i,a));){if(En(o.getNode(!1)))return t===uu.Forwards?{positions:rC(t,c).concat([o]),breakType:jb.Br,breakAt:k.some(o)}:{positions:rC(t,c),breakType:jb.Br,breakAt:k.some(o)};if(o.isVisible()){if(e(a,o)){var u=iC(0,t,a,o);return{positions:rC(t,c),breakType:u,breakAt:k.some(o)}}c.push(o),a=o}else a=o}return{positions:rC(t,c),breakType:jb.Eol,breakAt:k.none()}},cC=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var o=t(n,r).positions;return e===uu.Backwards?o.concat(r):[r].concat(o)})).getOr([])},uC=function(e,t){return J(e,(function(e,n){return e.fold((function(){return k.some(n)}),(function(r){return Oc(ne(r.getClientRects()),ne(n.getClientRects()),(function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r})).or(e)}))}),k.none())},lC=function(e,t){return ne(t.getClientRects()).bind((function(t){return uC(e,t.left)}))},sC=p(aC,cu.isAbove,-1),fC=p(aC,cu.isBelow,1),dC=p(cC,-1,sC),mC=p(cC,1,fC),pC=function(e){var t=function(t){return W(t,(function(t){return(t=Ic(t)).node=e,t}))};if(pn(e))return t(e.getClientRects());if(xn(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},gC=function(e){return Y(e,pC)};!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(nC||(nC={}));var hC,vC,bC=function(e,t,n,r,o,i){var a=0,c=[],u=function(r){var i,u,s;for(s=gC([r]),-1===e&&(s=s.reverse()),i=0;i<s.length;i++)if(u=s[i],!n(u,l)){if(c.length>0&&t(u,Te(c))&&a++,u.line=a,o(u))return!0;c.push(u)}},l=Te(i.getClientRects());if(!l)return c;var s=i.getNode();return u(s),function(e,t,n,r){for(;r=Rl(r,e,co,t);)if(n(r))return}(e,r,u,s),c},yC=p(bC,nC.Up,Mc,Lc),wC=p(bC,nC.Down,Lc,Mc),CC=function(e){return function(t){return function(e,t){return t.line>e}(e,t)}},xC=function(e){return function(t){return function(e,t){return t.line===e}(e,t)}},kC=Nn,SC=Rl,TC=function(e,t){return Math.abs(e.left-t)},EC=function(e,t){return Math.abs(e.right-t)},_C=function(e,t){return e>=t.left&&e<=t.right},AC=function(e,t){return e>=t.top&&e<=t.bottom},NC=function(e,t){return ke(e,(function(e,n){var r=Math.min(TC(e,t),EC(e,t)),o=Math.min(TC(n,t),EC(n,t));return _C(t,n)?n:_C(t,e)?e:o===r&&kC(n.node)||o<r?n:e}))},RC=function(e,t,n,r,o){var i=SC(r,e,co,t,!o);do{if(!i||n(i))return}while(i=SC(i,e,co,t))},OC=function(e,t,n){var r=gC(function(e){return $(oe(e.getElementsByTagName("*")),yl)}(e)),o=$(r,p(AC,n)),i=NC(o,t);if(i){var a=!yn(i.node)&&!On(i.node);if((i=NC(function(e,t,n){void 0===n&&(n=!0);var r=[],o=function(e,n){var o=$(gC([n]),(function(n){return!e(n,t)}));return r=r.concat(o),0===o.length};return r.push(t),RC(nC.Up,e,p(o,Mc),t.node,n),RC(nC.Down,e,p(o,Lc),t.node,n),r}(e,i,a),t))&&yl(i.node))return function(e,t){return{node:e.node,before:TC(e,t)<EC(e,t)}}(i,t)}return null},DC=function(e,t){e.selection.setRng(t),bd(e,e.selection.getRng())},IC=function(e,t,n){return k.some(Ay(e,t,n))},PC=function(e,t,n,r,o,i){var a=t===uu.Forwards,c=ns(e.getBody()),u=p(Wl,a?c.next:c.prev),l=a?r:o;if(!n.collapsed){var s=jc(n);if(i(s))return Ty(t,e,s,t===uu.Backwards,!1)}var f=Ul(t,e.getBody(),n);if(l(f))return Ey(e,f.getNode(!a));var d=ty(a,u(f)),m=function(e){return Ur(e.startContainer)}(n);if(!d)return m?k.some(n):k.none();if(l(d))return Ty(t,e,d.getNode(!a),a,!1);var g=u(d);return g&&l(g)&&ql(d,g)?Ty(t,e,g.getNode(!a),a,!1):m?IC(e,d.toRange(),!1):k.none()},BC=function(e,t,n,r,o,i){var a=Ul(t,e.getBody(),n),c=Te(a.getClientRects()),u=t===nC.Down;if(!c)return k.none();var l,s=(u?wC:yC)(e.getBody(),CC(1),a),f=$(s,xC(1)),d=c.left,m=NC(f,d);if(m&&i(m.node)){var p=Math.abs(d-m.left),g=Math.abs(d-m.right);return Ty(t,e,m.node,p<g,!1)}if(l=r(a)?a.getNode():o(a)?a.getNode(!0):jc(n)){var h=function(e,t,n,r){var o,i,a,c,u,l=ns(t),s=[],f=0,d=function(e){return Te(e.getClientRects())};1===e?(o=l.next,i=Lc,a=Mc,c=lu.after(r)):(o=l.prev,i=Mc,a=Lc,c=lu.before(r));var m=d(c);do{if(c.isVisible()&&!a(u=d(c),m)){if(s.length>0&&i(u,Te(s))&&f++,(u=Ic(u)).position=c,u.line=f,n(u))return s;s.push(u)}}while(c=o(c));return s}(t,e.getBody(),CC(1),l),v=NC($(h,xC(1)),d);if(v)return IC(e,v.position.toRange(),!1);if(v=Te($(h,xC(0))))return IC(e,v.position.toRange(),!1)}return 0===f.length?MC(e,u).filter(u?o:r).map((function(t){return Ay(e,t.toRange(),!1)})):k.none()},MC=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var o=lu.fromRangeEnd(n),i=fC(r,o);return re(i.positions)}o=lu.fromRangeStart(n),i=sC(r,o);return ne(i.positions)},LC=function(e,t,n){return MC(e,t).filter(n).exists((function(t){return e.selection.setRng(t.toRange()),!0}))},FC=Nn,jC=function(e,t,n){var r=ns(e.getBody()),o=p(Wl,1===t?r.next:r.prev);if(n.collapsed&&function(e){return""!==Bu(e)}(e)){var i=e.dom.getParent(n.startContainer,"PRE");if(!i)return;if(!o(lu.fromRangeStart(n))){var a=function(e){var t=e.dom.create(Bu(e));return(!ct.ie||ct.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t}(e);1===t?e.$(i).after(a):e.$(i).before(a),e.selection.select(a,!0),e.selection.collapse()}}},HC=function(e,t){var n=t?uu.Forwards:uu.Backwards,r=e.selection.getRng();return function(e,t,n){return PC(t,e,n,Km,Jm,FC)}(n,e,r).orThunk((function(){return jC(e,n,r),k.none()}))},UC=function(e,t){var n=t?1:-1,r=e.selection.getRng();return function(e,t,n){return BC(t,e,n,(function(e){return Km(e)||Vm(e)}),(function(e){return Jm(e)||$m(e)}),FC)}(n,e,r).orThunk((function(){return jC(e,n,r),k.none()}))},zC=function(e,t){return HC(e,t).exists((function(t){return DC(e,t),!0}))},WC=function(e,t){return UC(e,t).exists((function(t){return DC(e,t),!0}))},qC=function(e,t){return LC(e,t,t?Jm:Km)},VC=function(e){return U(["figcaption"],Ct(e))},$C=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},KC=function(e,t,n){n?Xt(e,t):Gt(e,t)},JC=function(e,t,n,r){return""===t?function(e,t){var n=pt.fromTag("br");return KC(e,n,t),$C(n)}(e,r):function(e,t,n,r){var o=pt.fromTag(n),i=pt.fromTag("br");return Bn(o,r),Xt(o,i),KC(e,o,t),$C(i)}(e,r,t,n)},GC=function(e,t,n){return t?function(e,t){return fC(e,t).breakAt.isNone()}(e.dom,n):function(e,t){return sC(e,t).breakAt.isNone()}(e.dom,n)},XC=function(e,t){var n=pt.fromDom(e.getBody()),r=lu.fromRangeStart(e.selection.getRng()),o=Bu(e),i=Mu(e);return function(e,t){var n=p(bt,t);return fr(pt.fromDom(e.container()),Ar,n).filter(VC)}(r,n).exists((function(){if(GC(n,t,r)){var a=JC(n,o,i,t);return e.selection.setRng(a),!0}return!1}))},YC=function(e,t){return!!e.selection.isCollapsed()&&XC(e,t)},QC=function(e,t){return Y(function(e){return W(e,(function(e){return Ee({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:s},e)}))}(e),(function(e){return function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey}(e,t)?[e]:[]}))},ZC=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},ex=function(e,t){return G(QC(e,t),(function(e){return e.action()}))},tx=function(e,t){var n=t?uu.Forwards:uu.Backwards,r=e.selection.getRng();return PC(e,n,r,Wm,qm,On).exists((function(t){return DC(e,t),!0}))},nx=function(e,t){var n=t?1:-1,r=e.selection.getRng();return BC(e,n,r,Wm,qm,On).exists((function(t){return DC(e,t),!0}))},rx=function(e,t){return LC(e,t,t?qm:Wm)},ox=function(e,t,n,r,o){var i=gc(pt.fromDom(n),"td,th,caption").map((function(e){return e.dom}));return function(e,t,n){return J(e,(function(e,r){return e.fold((function(){return k.some(r)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return k.some(i<o?r:e)}))}),k.none())}($(function(e,t){return Y(t,(function(t){var n=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}}(Ic(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))}(e,i),(function(e){return t(e,o)})),r,o).map((function(e){return e.cell}))},ix=p(ox,(function(e){return e.bottom}),(function(e,t){return e.y<t})),ax=p(ox,(function(e){return e.top}),(function(e,t){return e.y>t})),cx=function(e,t){return ne(t.getClientRects()).bind((function(t){return ix(e,t.left,t.top)})).bind((function(e){return lC(ps(n=e).map((function(e){return sC(n,e).positions.concat(e)})).getOr([]),t);var n}))},ux=function(e,t){return re(t.getClientRects()).bind((function(t){return ax(e,t.left,t.top)})).bind((function(e){return lC(ms(n=e).map((function(e){return[e].concat(fC(n,e).positions)})).getOr([]),t);var n}))},lx=function(e,t,n){var r=e(t,n);return function(e){return e.breakType===jb.Wrap&&0===e.positions.length}(r)||!En(n.getNode())&&function(e){return e.breakType===jb.Br&&1===e.positions.length}(r)?!function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))}(e,t,r):r.breakAt.isNone()},sx=p(lx,sC),fx=p(lx,fC),dx=function(e,t,n,r){var o=e.selection.getRng(),i=t?1:-1;return!(!vl()||!function(e,t,n){var r=lu.fromRangeStart(t);return ss(!e,n).exists((function(e){return e.isEqual(r)}))}(t,o,n))&&(Ty(i,e,n,!t,!1).each((function(t){DC(e,t)})),!0)},mx=function(e,t){var n=t.getNode(e);return pn(n)&&"TABLE"===n.nodeName?k.some(n):k.none()},px=function(e,t,n){var r=mx(!!t,n),o=!1===t;r.fold((function(){return DC(e,n.toRange())}),(function(r){return ss(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return DC(e,n.toRange())}),(function(o){return function(e,t,n,r){var o=Bu(t);o?t.undoManager.transact((function(){var r=pt.fromTag(o);Bn(r,Mu(t)),Xt(r,pt.fromTag("br")),e?Jt(pt.fromDom(n),r):Kt(pt.fromDom(n),r);var i=t.dom.createRng();i.setStart(r.dom,0),i.setEnd(r.dom,0),DC(t,i)})):DC(t,r.toRange())}(t,e,r,n)}))}))},gx=function(e,t,n,r){var o=e.selection.getRng(),i=lu.fromRangeStart(o),a=e.getBody();if(!t&&sx(r,i)){var c=function(e,t,n){return cx(t,n).orThunk((function(){return ne(n.getClientRects()).bind((function(n){return uC(dC(e,lu.before(t)),n.left)}))})).getOr(lu.before(t))}(a,n,i);return px(e,t,c),!0}if(t&&fx(r,i)){c=function(e,t,n){return ux(t,n).orThunk((function(){return ne(n.getClientRects()).bind((function(n){return uC(mC(e,lu.after(t)),n.left)}))})).getOr(lu.after(t))}(a,n,i);return px(e,t,c),!0}return!1},hx=function(e,t,n){return k.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(r){return k.from(e.dom.getParent(r,"table")).map((function(o){return n(e,t,o,r)}))})).getOr(!1)},vx=function(e,t){return hx(e,t,dx)},bx=function(e,t){return hx(e,t,gx)},yx=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){var r=Qe().os;ex([{keyCode:Df.RIGHT,action:ZC(zC,e,!0)},{keyCode:Df.LEFT,action:ZC(zC,e,!1)},{keyCode:Df.UP,action:ZC(WC,e,!1)},{keyCode:Df.DOWN,action:ZC(WC,e,!0)},{keyCode:Df.RIGHT,action:ZC(vx,e,!0)},{keyCode:Df.LEFT,action:ZC(vx,e,!1)},{keyCode:Df.UP,action:ZC(bx,e,!1)},{keyCode:Df.DOWN,action:ZC(bx,e,!0)},{keyCode:Df.RIGHT,action:ZC(tx,e,!0)},{keyCode:Df.LEFT,action:ZC(tx,e,!1)},{keyCode:Df.UP,action:ZC(nx,e,!1)},{keyCode:Df.DOWN,action:ZC(nx,e,!0)},{keyCode:Df.RIGHT,action:ZC(Sw,e,t,!0)},{keyCode:Df.LEFT,action:ZC(Sw,e,t,!1)},{keyCode:Df.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:ZC(_w,e,t)},{keyCode:Df.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:ZC(Aw,e,t)},{keyCode:Df.UP,action:ZC(YC,e,!1)},{keyCode:Df.DOWN,action:ZC(YC,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},wx=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){ex([{keyCode:Df.BACKSPACE,action:ZC(Vw,e,!1)},{keyCode:Df.BACKSPACE,action:ZC(Uy,e,!1)},{keyCode:Df.DELETE,action:ZC(Uy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Dy,e,!1)},{keyCode:Df.DELETE,action:ZC(Dy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Dw,e,t,!1)},{keyCode:Df.DELETE,action:ZC(Dw,e,t,!0)},{keyCode:Df.BACKSPACE,action:ZC(hg,e,!1)},{keyCode:Df.DELETE,action:ZC(hg,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(zy,e,!1)},{keyCode:Df.DELETE,action:ZC(zy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Fw,e,!1)},{keyCode:Df.DELETE,action:ZC(Fw,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(xy,e,!1)},{keyCode:Df.DELETE,action:ZC(xy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(by,e,!1)},{keyCode:Df.DELETE,action:ZC(by,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Mw,e,!1)},{keyCode:Df.DELETE,action:ZC(Mw,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.BACKSPACE,action:ZC(Hy,e)},{keyCode:Df.DELETE,action:ZC(Hy,e)}],t)}(e,t)}))},Cx=function(e,t){var n,r=t,o=e.dom,i=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var a=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);a&&/^(UL|OL|DL)$/.test(a.nodeName)&&t.insertBefore(o.doc.createTextNode(""),t.firstChild)}var c=o.createRng();if(t.normalize(),t.hasChildNodes()){for(var u=new Tr(t,t);n=u.current();){if(xn(n)){c.setStart(n,0),c.setEnd(n,0);break}if(i[n.nodeName.toLowerCase()]){c.setStartBefore(n),c.setEndBefore(n);break}r=n,n=u.next()}n||(c.setStart(r,0),c.setEnd(r,0))}else En(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(c.setStartBefore(t),c.setEndBefore(t)):(c.setStartAfter(t),c.setEndAfter(t)):(c.setStart(t,0),c.setEnd(t,0));e.selection.setRng(c),bd(e,c)}},xx=function(e){return k.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},kx=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},Sx=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},Tx=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},Ex=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!pn(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},_x=function(e,t,n,r,o){var i=e.dom,a=e.selection.getRng();if(n!==e.getBody()){var c;Sx(c=n)&&Sx(c.parentNode)&&(o="LI");var u=o?t(o):i.create("BR");if(Ex(n,r,!0)&&Ex(n,r,!1))kx(n,"LI")?i.insertAfter(u,Tx(n)):i.replace(u,n);else if(Ex(n,r,!0))kx(n,"LI")?(i.insertAfter(u,Tx(n)),u.appendChild(i.doc.createTextNode(" ")),u.appendChild(n)):n.parentNode.insertBefore(u,n);else if(Ex(n,r,!1))i.insertAfter(u,Tx(n));else{n=Tx(n);var l=a.cloneRange();l.setStartAfter(r),l.setEndAfter(n);var s=l.extractContents();"LI"===o&&function(e,t){return e.firstChild&&e.firstChild.nodeName===t}(s,"LI")?(u=s.firstChild,i.insertAfter(s,n)):(i.insertAfter(s,n),i.insertAfter(u,n))}i.remove(r),Cx(e,u)}},Ax=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)},Nx=function(e){e.innerHTML='<br data-mce-bogus="1">'},Rx=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},Ox=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},Dx=function(e,t,n){return!1===xn(t)?n:e?1===n&&"\ufeff"===t.data.charAt(n-1)?0:n:n===t.data.length-1&&"\ufeff"===t.data.charAt(n)?t.data.length:n},Ix=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},Px=function(e,t){var n=Bu(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){var r=e.dom;k.from(n.style).map(r.parseStyle).each((function(e){var n=Wn(pt.fromDom(t)),o=Ee(Ee({},n),e);r.setStyles(t,o)}));var o=k.from(n.class).map((function(e){return e.split(/\s+/)})),i=k.from(t.className).map((function(e){return $(e.split(/\s+/),(function(e){return""!==e}))}));Oc(o,i,(function(e,n){var o=$(n,(function(t){return!U(e,t)})),i=_e(e,o);r.setAttrib(t,"class",i.join(" "))}));var a=["style","class"],c=me(n,(function(e,t){return!U(a,t)}));r.setAttribs(t,c)}(e,t,Mu(e))},Bx=function(e,t){var n,r,o,i,a,c,u,l,s,f,d=e.dom,m=e.schema,p=m.getNonEmptyElements(),g=e.selection.getRng(),h=function(t){var n,o,a,c=r,u=m.getTextInlineElements();if(a=n=t||"TABLE"===l||"HR"===l?d.create(t||s):i.cloneNode(!1),!1===function(e){return e.getParam("keep_styles",!0)}(e))d.setAttrib(n,"style",null),d.setAttrib(n,"class",null);else do{if(u[c.nodeName]){if(gs(c)||Es(c))continue;o=c.cloneNode(!1),d.setAttrib(o,"id",""),n.hasChildNodes()?(o.appendChild(n.firstChild),n.appendChild(o)):(a=o,n.appendChild(o))}}while((c=c.parentNode)&&c!==C);return Px(e,n),Nx(a),n},v=function(e){var t,n,a=Dx(e,r,o);if(xn(r)&&(e?a>0:a<r.nodeValue.length))return!1;if(r.parentNode===i&&f&&!e)return!0;if(e&&pn(r)&&r===i.firstChild)return!0;if(Rx(r,"TABLE")||Rx(r,"HR"))return f&&!e||!f&&e;var c=new Tr(r,i);for(xn(r)&&(e&&0===a?c.prev():e||a!==r.nodeValue.length||c.next());t=c.current();){if(pn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),p[n]&&"br"!==n))return!1}else if(xn(t)&&!lo(t.nodeValue))return!1;e?c.prev():c.next()}return!0},b=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(l)&&"HGROUP"!==x?h(s):h(),function(e){return e.getParam("end_container_on_empty_block",!1)}(e)&&Ox(d,u)&&d.isEmpty(i)?a=d.split(u,i):d.insertAfter(a,i),Cx(e,a)};$f(d,g).each((function(e){g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)})),r=g.startContainer,o=g.startOffset,s=Bu(e);var y=!(!t||!t.shiftKey),w=!(!t||!t.ctrlKey);pn(r)&&r.hasChildNodes()&&(f=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=f&&xn(r)?r.nodeValue.length:0);var C=Ix(d,r);if(C){(s&&!y||!s&&y)&&(r=function(e,t,n,r,o){var i,a,c,u,l,s,f=t||"P",d=e.dom,m=Ix(d,r);if(!(a=d.getParent(r,d.isBlock))||!Ox(d,a)){if(s=(a=a||m)===e.getBody()||function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)}(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return i=d.create(f),Px(e,i),a.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(u=r;u.parentNode!==a;)u=u.parentNode;for(;u&&!d.isBlock(u);)c=u,u=u.previousSibling;if(c&&e.schema.isValidChild(s,f.toLowerCase())){for(i=d.create(f),Px(e,i),c.parentNode.insertBefore(i,c),u=c;u&&!d.isBlock(u);)l=u.nextSibling,i.appendChild(u),u=l;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,s,g,r,o)),i=d.getParent(r,d.isBlock),u=i?d.getParent(i.parentNode,d.isBlock):null,l=i?i.nodeName.toUpperCase():"";var x=u?u.nodeName.toUpperCase():"";"LI"!==x||w||(i=u,u=u.parentNode,l=x),/^(LI|DT|DD)$/.test(l)&&d.isEmpty(i)?_x(e,h,u,i,s):s&&i===e.getBody()||(s=s||"P",Ur(i)?(a=Xr(i),d.isEmpty(i)&&Nx(i),Px(e,a),Cx(e,a)):v()?b():v(!0)?(a=i.parentNode.insertBefore(h(),i),Cx(e,Rx(i,"HR")?a:i)):((n=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,Dx(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Dx(!1,e.endContainer,e.endOffset)),t}(g).cloneRange()).setEndAfter(i),function(e){q(pc(pt.fromDom(e),Tt),(function(e){var t=e.dom;t.nodeValue=Fr(t.nodeValue)}))}(c=n.extractContents()),function(e){do{xn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)}(c),a=c.firstChild,d.insertAfter(c,i),function(e,t,n){var r,o=n,i=[];if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;pn(o)&&!t[o.nodeName.toLowerCase()]&&i.push(o)}for(r=i.length;r--;)(!(o=i[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||Ax(e,o))&&e.remove(o)}}(d,p,a),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(d,i),d.isEmpty(i)&&Nx(i),a.normalize(),d.isEmpty(a)?(d.remove(a),b()):(Px(e,a),Cx(e,a))),d.setAttrib(a,"id",""),e.fire("NewBlock",{newBlock:a}))}},Mx=function(e,t,n){var r=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(r,n),t.scrollIntoView(r),e.remove(r)},Lx=function(e,t,n,r){var o=e.createRng();r?(o.setStartBefore(n),o.setEndBefore(n)):(o.setStartAfter(n),o.setEndAfter(n)),t.setRng(o)},Fx=function(e,t){var n,r,o=e.selection,i=e.dom,a=o.getRng();$f(i,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var c=a.startOffset,u=a.startContainer;if(1===u.nodeType&&u.hasChildNodes()){var l=c>u.childNodes.length-1;u=u.childNodes[Math.min(c,u.childNodes.length-1)]||u,c=l&&3===u.nodeType?u.nodeValue.length:0}var s=i.getParent(u,i.isBlock),f=s?i.getParent(s.parentNode,i.isBlock):null,d=f?f.nodeName.toUpperCase():"",m=!(!t||!t.ctrlKey);"LI"!==d||m||(s=f),u&&3===u.nodeType&&c>=u.nodeValue.length&&(function(e,t,n){for(var r,o=new Tr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||r.length>0)return!0}(e.schema,u,s)||(n=i.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),r=!0)),n=i.create("br"),fu(i,a,n),Mx(i,o,n),Lx(i,o,n,r),e.undoManager.add()},jx=function(e,t){var n=pt.fromTag("br");Kt(pt.fromDom(t),n),e.undoManager.add()},Hx=function(e,t){Ux(e.getBody(),t)||Jt(pt.fromDom(t),pt.fromTag("br"));var n=pt.fromTag("br");Jt(pt.fromDom(t),n),Mx(e.dom,e.selection,n.dom),Lx(e.dom,e.selection,n.dom,!1),e.undoManager.add()},Ux=function(e,t){return n=lu.after(t),!!En(n.getNode())||fs(e,lu.after(t)).map((function(e){return En(e.getNode())})).getOr(!1);var n},zx=function(e){return e&&"A"===e.nodeName&&"href"in e},Wx=function(e){return e.fold(b,zx,zx,b)},qx=function(e,t){t.fold(s,p(jx,e),p(Hx,e),s)},Vx=function(e,t){var n=function(e){var t=p(Qb,e),n=lu.fromRangeStart(e.selection.getRng());return lw(t,e.getBody(),n).filter(Wx)}(e);n.isSome()?n.each(p(qx,e)):Fx(e,t)},$x=function(e,t){return xx(e).filter((function(e){return t.length>0&&ht(pt.fromDom(e),t)})).isSome()},Kx=ar([{br:[]},{block:[]},{none:[]}]),Jx=function(e,t){return function(e){return $x(e,function(e){return e.getParam("no_newline_selector","")}(e))}(e)},Gx=function(e){return function(t,n){return""===Bu(t)===e}},Xx=function(e){return function(t,n){return function(e){return xx(e).filter((function(e){return Ir(pt.fromDom(e))})).isSome()}(t)===e}},Yx=function(e,t){return function(n,r){return function(e){return xx(e).fold(d(""),(function(e){return e.nodeName.toUpperCase()}))}(n)===e.toUpperCase()===t}},Qx=function(e){return Yx("pre",e)},Zx=function(e){return function(t,n){return function(e){return e.getParam("br_in_pre",!0)}(t)===e}},ek=function(e,t){return function(e){return $x(e,function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")}(e))}(e)},tk=function(e,t){return t},nk=function(e){var t=Bu(e),n=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},rk=function(e,t){return function(n,r){return J(e,(function(e,t){return e&&t(n,r)}),!0)?k.some(t):k.none()}},ok=function(e,t){(function(e,t){return Zy([rk([Jx],Kx.none()),rk([Yx("summary",!0)],Kx.br()),rk([Qx(!0),Zx(!1),tk],Kx.br()),rk([Qx(!0),Zx(!1)],Kx.block()),rk([Qx(!0),Zx(!0),tk],Kx.block()),rk([Qx(!0),Zx(!0)],Kx.br()),rk([Xx(!0),tk],Kx.br()),rk([Xx(!0)],Kx.block()),rk([Gx(!0),tk,nk],Kx.block()),rk([Gx(!0)],Kx.br()),rk([ek],Kx.br()),rk([Gx(!1),tk],Kx.br()),rk([nk],Kx.block())],[e,!(!t||!t.shiftKey)]).getOr(Kx.none())})(e,t).fold((function(){Vx(e,t)}),(function(){Bx(e,t)}),s)},ik=function(e){e.on("keydown",(function(t){t.keyCode===Df.ENTER&&function(e,t){var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),ok(e,t)})))}(e,t)}))},ak=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.END,action:ZC(qC,e,!0)},{keyCode:Df.HOME,action:ZC(qC,e,!1)},{keyCode:Df.END,action:ZC(rx,e,!0)},{keyCode:Df.HOME,action:ZC(rx,e,!1)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},ck=Qe().browser,uk=function(e){!function(e){var t=ic((function(){e.composing||Ap(e)}),0);ck.isIE()&&(e.on("keypress",(function(e){t.throttle()})),e.on("remove",(function(e){t.cancel()})))}(e),e.on("input",(function(t){!1===t.isComposing&&Ap(e)}))},lk=function(e,t){var n=t.container(),r=t.offset();return xn(n)?(n.insertData(r,e),k.some(cu(n,r+e.length))):zl(t).map((function(n){var r=pt.fromText(e);return t.isAtEnd()?Jt(n,r):Kt(n,r),cu(r.dom,e.length)}))},sk=p(lk,""),fk=p(lk," "),dk=function(e,t){return function(n){return function(e,t){return!yp(t)&&(wp(e,t)||vp(e,t)||bp(e,t))}(e,n)?sk(t):fk(t)}},mk=function(e){var t=lu.fromRangeStart(e.selection.getRng()),n=pt.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=p(Qb,e),o=lu.fromRangeStart(e.selection.getRng());return lw(r,e.getBody(),o).bind(function(e){return function(t){return t.fold((function(t){return ds(e.dom,lu.before(t))}),(function(e){return ms(e)}),(function(e){return ps(e)}),(function(t){return fs(e.dom,lu.after(t))}))}}(n)).bind(dk(n,t)).exists(function(e){return function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}}(e))}return!1},pk=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.SPACEBAR,action:ZC(mk,e)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},gk=function(e){var t=Ew(e);return function(e){e.on("keyup compositionstart",p(tC,e))}(e),yx(e,t),wx(e,t),ik(e),pk(e),uk(e),ak(e),t},hk=function(){function e(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var r=e.selection.getRng(),o={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Lf(o,t)||e.fire("SelectionChange"),t=o})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!ct.range&&e.selection.isCollapsed()||bf(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&bf(e)&&("IMG"===e.selection.getNode().nodeName?wr.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}return e.prototype.nodeChanged=function(e){var t,n,r,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(t=o.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,(function(e){if(e===r)return!0;n.push(e)})),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},e.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;t>=0&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},e}(),vk=function(e){!function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))}(e),function(e){e.parser.addNodeFilter("details",(function(e){q(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){q(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",_(t)?t:null),e.attr("data-mce-open",null)}))}))}(e)},bk=function(e){return pn(e)&&Or(pt.fromDom(e))},yk=function(e){e.on("click",(function(t){t.detail>=3&&function(e){var t=e.selection.getRng(),n=cu.fromRangeStart(t),r=cu.fromRangeEnd(t);if(cu.isElementPosition(n)){var o=n.container();bk(o)&&ms(o).each((function(e){return t.setStart(e.container(),e.offset())}))}if(cu.isElementPosition(r)){o=n.container();bk(o)&&ps(o).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(bg(t))}(e)}))},wk=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-r.clientTop,left:t.left+o.pageXOffset-r.clientLeft}},Ck=function(e,t){return function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}}(function(e){return e.inline?wk(e.getBody()):{left:0,top:0}}(e),function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}}(e),function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=wk(e.getContentAreaContainer()),r=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:o}(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}}(e,t))},xk=Nn,kk=An,Sk=function(e,t,n,r){var o=e.dom,i=t.cloneNode(!0);o.setStyles(i,{width:n,height:r}),o.setAttrib(i,"data-mce-selected",null);var a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(i,{margin:0,boxSizing:"border-box"}),a.appendChild(i),a},Tk=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},Ek=function(e,t){return function(n){if(function(e){return 0===e.button}(n)){var r=G(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(xk,kk)).getOr(null);if(c=t.getBody(),xk(u=r)&&u!==c){var o=t.dom.getPos(r),i=t.getBody(),a=t.getDoc().documentElement;e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:r.offsetWidth,height:r.offsetHeight,ghost:Sk(t,r,r.offsetWidth,r.offsetHeight)})}}var c,u}},_k=function(e,t){return function(n){e.on((function(e){if(e.dragging&&function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!xk(t)}(t,(a=t.selection,3===(c=a.getSel().getRangeAt(0).startContainer).nodeType?c.parentNode:c),e.element)){var r=(o=e.element,(i=o.cloneNode(!0)).removeAttribute("data-mce-selected"),i);t.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact((function(){Tk(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()}))}var o,i,a,c})),Ak(e)}},Ak=function(e){e.on((function(e){Tk(e.ghost)})),e.clear()},Nk=function(e){var t,n=(t=Qa(k.none()),{clear:function(){return t.set(k.none())},set:function(e){return t.set(k.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}),r=Ka.DOM,o=document,i=Ek(n,e),a=function(e,t){var n=wr.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.stop),function(r){return e.on((function(e){var o,i,a=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&a>10){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var c=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}}(e,Ck(t,r));o=e.ghost,i=t.getBody(),o.parentNode!==i&&i.appendChild(o),function(e,t,n,r,o,i){var a=0,c=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(a=t.pageX+n-o),t.pageY+r>i&&(c=t.pageY+r-i),e.style.width=n-a+"px",e.style.height=r-c+"px"}(e.ghost,c,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}))}}(n,e),c=_k(n,e),u=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")})),Ak(e)}}(n,e);e.on("mousedown",i),e.on("mousemove",a),e.on("mouseup",c),r.bind(o,"mousemove",a),r.bind(o,"mouseup",u),e.on("remove",(function(){r.unbind(o,"mousemove",a),r.unbind(o,"mouseup",u)}))},Rk=function(e){Nk(e),function(e){e.on("drop",(function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(xk(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))}(e),function(e){return e.getParam("block_unsupported_drop",!0,"boolean")}(e)&&function(e){var t=function(t){if(!t.defaultPrevented){var n=t.dataTransfer;n&&(U(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&Ab(e,"Dropped file type is not supported"))}},n=function(n){Ud(e,n.target)&&t(n)},r=function(){var r=Ka.DOM,o=e.dom,i=document,a=e.inline?e.getBody():e.getDoc(),c=["drop","dragover"];q(c,(function(e){r.bind(i,e,n),o.bind(a,e,t)})),e.on("remove",(function(){q(c,(function(e){r.unbind(i,e,n),o.unbind(a,e,t)}))}))};e.on("init",(function(){wr.setEditorTimeout(e,r,0)}))}(e)},Ok=An,Dk=Nn,Ik=function(e,t){return Rf(e.getBody(),t)},Pk=function(e){var t,n=e.selection,r=e.dom,o=r.isBlock,i=e.getBody(),a=hl(e,i,o,(function(){return Jd(e)})),c="sel-"+r.uniqueId(),u=function(e){return e!==i&&(Dk(e)||On(e))&&r.isChildOf(e,i)},l=function(e){e&&n.setRng(e)},s=n.getRng,f=function(t,r,o,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:r,direction:t,before:o}).isDefaultPrevented()?null:(i&&n.scrollIntoView(r,-1===t),a.show(o,r))},d=function(e){return Wr(e)||Jr(e)||Gr(e)},m=function(e){return d(e.startContainer)||d(e.endContainer)},p=function(t){var n=e.schema.getShortEndedElements(),o=r.createRng(),i=t.startContainer,a=t.startOffset,c=t.endContainer,u=t.endOffset;return he(n,i.nodeName.toLowerCase())?0===a?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,a),he(n,c.nodeName.toLowerCase())?0===u?o.setEndBefore(c):o.setEndAfter(c):o.setEnd(c,u),o},g=function(o){var i=o.cloneNode(!0),a=e.fire("ObjectSelected",{target:o,targetClone:i});if(a.isDefaultPrevented())return null;var u=function(t,o,i){var a=e.$,u=pr(pt.fromDom(e.getBody()),"#"+c).fold((function(){return a([])}),(function(e){return a([e.dom])}));0===u.length&&(u=a('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",c)).appendTo(e.getBody());var l=r.createRng();o===i&&ct.ie?(u.empty().append('<p style="font-size: 0" data-mce-bogus="all"></p>').append(o),l.setStartAfter(u[0].firstChild.firstChild),l.setEndAfter(o)):(u.empty().append("").append(o).append(""),l.setStart(u[0].firstChild,1),l.setEnd(u[0].lastChild,0)),u.css({top:r.getPos(t,e.getBody()).y}),u[0].focus();var s=n.getSel();return s.removeAllRanges(),s.addRange(l),l}(o,a.targetClone,i),l=pt.fromDom(o);return q(gc(pt.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){bt(l,e)||Fn(e,"data-mce-selected")})),r.getAttrib(o,"data-mce-selected")||o.setAttribute("data-mce-selected","1"),t=o,b(),u},h=function(e,t){if(!e)return null;if(e.collapsed){if(!m(e)){var n=t?1:-1,o=Ul(n,i,e),a=o.getNode(!t);if(yl(a))return f(n,a,!!t&&!o.isAtEnd(),!1);var c=o.getNode(t);if(yl(c))return f(n,c,!t&&!o.isAtEnd(),!1)}return null}var l=e.startContainer,s=e.startOffset,d=e.endOffset;if(3===l.nodeType&&0===s&&Dk(l.parentNode)&&(l=l.parentNode,s=r.nodeIndex(l),l=l.parentNode),1!==l.nodeType)return null;if(d===s+1&&l===e.endContainer){var p=l.childNodes[s];if(u(p))return g(p)}return null},v=function(){t&&t.removeAttribute("data-mce-selected"),pr(pt.fromDom(e.getBody()),"#"+c).each(Zt),t=null},b=function(){a.hide()};return ct.ceFalse&&function(){e.on("mouseup",(function(t){var n=s();n.collapsed&&Cb(e,t.clientX,t.clientY)&&_y(e,n,!1).each(l)})),e.on("click",(function(t){var o=Ik(e,t.target);o&&(Dk(o)&&(t.preventDefault(),e.focus()),Ok(o)&&r.isChildOf(o,n.getNode())&&v())})),e.on("blur NewBlock",v),e.on("ResizeWindow FullscreenStateChanged",a.reposition);var d=function(e){var t=ns(e);if(!e.firstChild)return!1;var n,r=lu.before(e.firstChild),o=t.next(r);return o&&!(Km(n=o)||Jm(n)||Wm(n)||qm(n))},g=function(t,n){var i,a,c=r.getParent(t,o),u=r.getParent(n,o);return!(!c||t===u||!r.isChildOf(c,u)||!1!==Dk(Ik(e,c)))||c&&(i=c,a=u,!(r.getParent(i,o)===r.getParent(a,o)))&&d(c)};e.on("tap",(function(t){var n=t.target,r=Ik(e,n);Dk(r)?(t.preventDefault(),Ey(e,r).each(h)):u(n)&&Ey(e,n).each(h)}),!0),e.on("mousedown",(function(t){var o=t.target;if((o===i||"HTML"===o.nodeName||r.isChildOf(o,i))&&!1!==Cb(e,t.clientX,t.clientY)){var a=Ik(e,o);if(a)Dk(a)?(t.preventDefault(),Ey(e,a).each(h)):(v(),Ok(a)&&t.shiftKey||Of(t.clientX,t.clientY,n.getRng())||(b(),n.placeCaretAt(t.clientX,t.clientY)));else if(u(o))Ey(e,o).each(h);else if(!1===yl(o)){v(),b();var c=OC(i,t.clientX,t.clientY);if(c&&!g(o,c.node)){t.preventDefault();var s=f(1,c.node,c.before,!1);e.getBody().focus(),l(s)}}}})),e.on("keypress",(function(e){Df.modifierPressed(e)||Dk(n.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}})),e.on("SetSelectionRange",(function(e){e.range=p(e.range);var t=h(e.range,e.forward);t&&(e.range=t)}));e.on("AfterSetSelectionRange",(function(e){var t=e.range,n=t.startContainer.parentNode;m(t)||"mcepastebin"===n.id||b(),function(e){return r.hasClass(e,"mce-offscreen-selection")}(n)||v()})),e.on("copy",(function(e){var t,n=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!ct.ie){var o=(t=r.get(c))?t.getElementsByTagName("*")[0]:t;o&&(e.preventDefault(),n.clearData(),n.setData("text/html",o.outerHTML),n.setData("text/plain",o.outerText||o.innerText))}})),Rk(e),function(e){var t=ic((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=Ay(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))}(e),function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(On(n)){var r=Rf(e.getBody(),n),o=Nn(r)?r:n;e.selection.getNode()!==o&&Ey(e,o).each((function(t){return e.selection.setRng(t)}))}}))}))}(e)}(),{showCaret:f,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(Xr(e),l(s()),n.scrollIntoView(e))},hideFakeCaret:b,destroy:function(){a.destroy(),t=null}}},Bk=function(e){var t,n,r,o=dt.each,i=Df.BACKSPACE,a=Df.DELETE,c=e.dom,u=e.selection,l=e.parser,s=ct.gecko,f=ct.ie,d=ct.webkit,m=f?"Text":"URL",p=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},g=function(e){return e.isDefaultPrevented()},h=function(){e.shortcuts.add("meta+a",null,"SelectAll")},v=function(){e.on("keydown",(function(e){if(!g(e)&&e.keyCode===i&&u.isCollapsed()&&0===u.getRng().startOffset){var t=u.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},b=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(ct.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))};return e.on("keydown",(function(t){var n,r;if(!g(t)&&t.keyCode===Df.BACKSPACE){var o=(n=u.getRng()).startContainer,i=n.startOffset,a=c.getRoot();if(r=o,n.collapsed&&0===i){for(;r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==a;)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(e.formatter.toggle("blockquote",null,r),(n=c.createRng()).setStart(o,0),n.setEnd(o,0),u.setRng(n))}}})),t=function(e){var t=c.create("body"),n=e.cloneContents();return t.appendChild(n),u.serializer.serialize(t,{format:"html"})},e.on("keydown",(function(n){var r,o,u=n.keyCode;if(!g(n)&&(u===a||u===i)){if(r=e.selection.isCollapsed(),o=e.getBody(),r&&!c.isEmpty(o))return;if(!r&&!function(n){var r=t(n),o=c.createRng();return o.selectNode(e.getBody()),r===t(o)}(e.selection.getRng()))return;n.preventDefault(),e.setContent(""),o.firstChild&&c.isBlock(o.firstChild)?e.selection.setCursorLocation(o.firstChild,0):e.selection.setCursorLocation(o,0),e.nodeChanged()}})),ct.windowsPhone||e.on("keyup focusin mouseup",(function(e){Df.modifierPressed(e)||u.normalize()}),!0),d&&(e.inline||c.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=u.getRng(),e.getBody().focus(),"mousedown"===t.type){if(Wr(n.startContainer))return;u.placeCaretAt(t.clientX,t.clientY)}else u.setRng(n)})),e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==c.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&c.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),u.select(n))})),Bu(e)&&e.on("init",(function(){p("DefaultParagraphSeparator",Bu(e))})),e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))})),v(),l.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),ct.iOS?(e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()})),b(),e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):h()),ct.ie>=11&&(b(),v()),ct.ie&&(h(),p("AutoUrlDetect",!1),e.on("dragstart",(function(t){!function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&u.select(t.target),(n=e.selection.getContent()).length>0&&(r="data:text/mce-internal,"+escape(e.id)+","+escape(n),t.dataTransfer.setData(m,r)))}(t)})),e.on("drop",(function(t){if(!g(t)){var n=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(m))&&t.indexOf("data:text/mce-internal,")>=0?(t=t.substr("data:text/mce-internal,".length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null}(t);if(n&&n.id!==e.id){t.preventDefault();var r=Mf(t.x,t.y,e.getDoc());u.setRng(r),o=n.html,i=!0,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:i}):e.execCommand("mceInsertContent",!1,o)}}var o,i}))),s&&(e.on("keydown",(function(t){if(!g(t)&&t.keyCode===i){if(!e.getBody().getElementsByTagName("hr").length)return;if(u.isCollapsed()&&0===u.getRng().startOffset){var n=u.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return c.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(c.remove(r),t.preventDefault())}}})),Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!g(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),wr.setEditorTimeout(e,(function(){n.focus()}))}})),n=function(){var t=c.getAttribs(u.getStart().cloneNode(!1));return function(){var n=u.getStart();n!==e.getBody()&&(c.setAttrib(n,"style",null),o(t,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},r=function(){return!u.isCollapsed()&&c.getParent(u.getStart(),c.isBlock)!==c.getParent(u.getEnd(),c.isBlock)},e.on("keypress",(function(t){var o;if(!g(t)&&(8===t.keyCode||46===t.keyCode)&&r())return o=n(),e.getDoc().execCommand("delete",!1,null),o(),t.preventDefault(),!1})),c.bind(e.getDoc(),"cut",(function(t){var o;!g(t)&&r()&&(o=n(),wr.setEditorTimeout(e,(function(){o()})))})),function(e){return e.getParam("readonly")}(e)||e.on("BeforeExecCommand mousedown",(function(){p("StyleWithCSS",!1),p("enableInlineTableEditing",!1),Ju(e)||p("enableObjectResizing",!1)})),e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||o(c.select("a"),(function(e){var t=e.parentNode,n=c.getRoot();if(t.lastChild===e){for(;t&&!c.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}c.add(t,"br",{"data-mce-bogus":1})}}))})),e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),ct.mac&&e.on("keydown",(function(t){!Df.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))})),v()),{refreshContentEditable:function(){},isHidden:function(){if(!s||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},Mk=Ka.DOM,Lk=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0},Fk=function(e){return me(e,(function(e){return!1===D(e)}))},jk=function(e){var t=e.settings,n=e.editorUpload.blobCache;return Fk({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:Lk(e),validate:!0,blob_cache:n,images_dataimg_filter:t.images_dataimg_filter})},Hk=function(e){var t=e.dom.getRoot();e.inline||bf(e)&&e.selection.getStart(!0)!==t||ms(t).each((function(t){var n=t.getNode(),r=yn(n)?ms(n).getOr(t):t;ct.browser.isIE()?function(e,t){var n=pt.fromDom(e.getBody()),r=(Od(e)?k.from(t):k.none()).map(Dd).filter(Rd(n));e.bookmark=r.isSome()?r:e.bookmark}(e,r.toRange()):e.selection.setRng(r.toRange())}))},Uk=function(e){e.bindPendingEventDelegates(),e.initialized=!0,function(e){e.fire("Init")}(e),e.focus(!0),Hk(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),function(e){e.settings.auto_focus&&wr.setEditorTimeout(e,(function(){var t;(t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus)).destroyed||t.focus()}),100)}(e)},zk=function(e,t){var n=e.settings,r=e.getDoc(),o=e.getBody();n.browser_spellcheck||n.gecko_spellcheck||(r.body.spellcheck=!1,Mk.setAttrib(o,"spellcheck","false")),e.quirks=Bk(e),function(e){e.fire("PostRender")}(e);var i=function(e){return e.getParam("directionality",nc.isRtl()?"rtl":void 0)}(e);if(void 0!==i&&(o.dir=i),n.protect&&e.on("BeforeSetContent",(function(e){dt.each(n.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),!1===t&&e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"}),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type})),e.contentStyles.length>0){var a="";dt.each(e.contentStyles,(function(e){a+=e+"\r\n"})),e.dom.addStyle(a)}!function(e,t){var n=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader}(e),r=function(){e.on("remove",(function(){return n.unloadAll(t)})),Uk(e)};n.loadAll(t,r,r)}(e,e.contentCSS),n.content_style&&function(e,t){var n=pt.fromDom(e.getBody()),r=qt(Wt(n)),o=pt.fromTag("style");Pn(o,"type","text/css"),Xt(o,pt.fromText(t)),Xt(r,o),e.on("remove",(function(){Zt(o)}))}(e,n.content_style)},Wk=function(e,t){var n=e.settings,r=e.getElement(),o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(o.open(),o.write(e.iframeHTML),o.close()),e.inline&&(Mk.addClass(r,"mce-content-body"),e.contentDocument=o=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var i=e.getBody();i.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===Mk.getStyle(i,"position",!0)&&(i.style.position="relative"),i.contentEditable=e.getParam("content_editable_state",!0)),i.disabled=!1,e.editorUpload=Lb(e),e.schema=qo(n),e.dom=Ka(o,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:qu(e),referrerPolicy:Vu(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=function(e){var t=Mv(jk(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){for(var r,o,i=t.length,a=e.dom,c="data-mce-"+n;i--;)if((o=(r=t[i]).attr(n))&&!r.attr(c)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===n?((o=a.serializeStyle(a.parseStyle(o),r.name)).length||(o=null),r.attr(c,o),r.attr(n,o)):"tabindex"===n?(r.attr(c,o),r.attr(n,null)):r.attr(c,e.convertURL(o,n,r.name))}})),t.addNodeFilter("script",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}})),e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){for(var n=t.length;n--;){var r=t[n];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode(r.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){for(var n=t.length,r=e.schema.getNonEmptyElements();n--;){var o=t[n];o.isEmpty(r)&&0===o.getAll("br").length&&(o.append(new bm("br",1)).shortEnded=!0)}})),t}(e),e.serializer=Uv(function(e){var t=e.settings;return Ee(Ee({},jk(e)),Fk({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before,block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements}))}(e),e),e.selection=hv(e.dom,e.getWin(),e.serializer,e),e.annotator=_f(e),e.formatter=Vb(e),e.undoManager=$b(e),e._nodeChangeDispatcher=new hk(e),e._selectionOverrides=Pk(e),Gw(e),vk(e),av(e)||yk(e);var a=function(e){return av(e)?Qa(null):gk(e)}(e);Kw(e,a),function(e){Bu(e)&&e.on("NodeChange",p(Zw,e))}(e),Xb(e),function(e){e.fire("PreInit")}(e),function(e){var t=e;return ge(e.plugins,"rtc").fold((function(){return t.rtcInstance=ov(e),k.none()}),(function(n){return k.some(n.setup().then((function(n){return t.rtcInstance=iv(e,n),n.isRemote})))}))}(e).fold((function(){zk(e,!1)}),(function(t){e.setProgressState(!0),t.then((function(t){e.setProgressState(!1),zk(e,t)}))}))},qk=Ka.DOM,Vk=function(e){var t=function(e){return e.getParam("doctype","<!DOCTYPE html>")}(e)+"<html><head>";(function(e){return e.getParam("document_base_url","")})(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=function(e){return Iu(e,"body_id","tinymce")}(e),r=function(e){return Iu(e,"body_class","")}(e);return Pu(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Pu(e)+'" />'),t+='</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'"><br></body></html>'},$k=function(e,t){var n=e.editorManager.translate("Rich Text Area. Press ALT-0 for help."),r=function(e,t,n,r){var o=pt.fromTag("iframe");return Bn(o,r),Bn(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),fc(o,"tox-edit-area__iframe"),o}(e.id,n,t.height,function(e){return e.getParam("iframe_attrs",{})}(e)).dom;r.onload=function(){r.onload=null,e.fire("load")};var o=function(e,t){if(document.domain!==window.location.hostname&&ct.browser.isIE()){var n=Mb("mce");e[n]=function(){Wk(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return qk.setAttrib(t,"src",r),!0}return!1}(e,r);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=Vk(e),qk.add(t.iframeContainer,r),o},Kk=Ka.DOM,Jk=function(e,t,n){var r=Sb.get(n),o=Sb.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=dt.trim(n),r&&-1===dt.inArray(t,n)){if(dt.each(Sb.dependencies(n),(function(n){Jk(e,t,n)})),e.plugins[n])return;try{var i=new r(e,o,e.$);e.plugins[n]=i,i.init&&(i.init(e,o),t.push(n))}catch(t){!function(e,t,n){var r=nc.translate(["Failed to initialize plugin: {0}",t]);Db(r,n),Ab(e,r)}(e,n,t)}}},Gk=function(e){return e.replace(/^\-/,"")},Xk=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},Yk=function(e){var t=e.getElement();return e.inline?Xk(null):function(e){var t=Kk.create("div");return Kk.insertAfter(t,e),Xk(t)}(t)},Qk=function(e){var t=e.getElement();return e.orgDisplay=t.style.display,_(Xu(e))?function(e){return e.theme.renderUI()}(e):B(Xu(e))?function(e){var t=e.getElement(),n=Xu(e)(e,t);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||e.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||e.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:t.offsetHeight,n}(e):Yk(e)},Zk=function(e){e.fire("ScriptsLoaded"),function(e){var t=dt.trim(ju(e)),n=e.ui.registry.getAll().icons,r=Ee(Ee({},pb.get("default").icons),pb.get(t).icons);ce(r,(function(t,r){he(n,r)||e.ui.registry.addIcon(r,t)}))}(e),function(e){var t=Xu(e);if(_(t)){e.settings.theme=Gk(t);var n=Tb.get(t);e.theme=new n(e,Tb.urls[t]),e.theme.init&&e.theme.init(e,Tb.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}}(e),function(e){var t=[];dt.each(el(e).split(/[ ,]/),(function(n){Jk(e,t,Gk(n))}))}(e);var t=Qk(e);!function(e,t){var n={show:k.from(t.show).getOr(s),hide:k.from(t.hide).getOr(s),disable:k.from(t.disable).getOr(s),isDisabled:k.from(t.isDisabled).getOr(b),enable:function(){e.mode.isReadOnly()||k.from(t.enable).map(v)}};e.ui=Ee(Ee({},e.ui),n)}(e,k.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,function(e){e.contentCSS=e.contentCSS.concat(Ib(e))}(e),e.inline?Wk(e):function(e,t){var n=$k(e,t);t.editorContainer&&(qk.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=qk.isHidden(t.editorContainer)),e.getElement().style.display="none",qk.setAttrib(e.id,"aria-hidden","true"),n||Wk(e)}(e,n)},eS=Ka.DOM,tS=function(e){return"-"===e.charAt(0)},nS=function(e,t){var n=$u(t),r=function(e){return e.getParam("language_url","","string")}(t);if(!1===nc.hasCode(n)&&"en"!==n){var o=""!==r?r:t.editorManager.baseURL+"/langs/"+n+".js";e.add(o,s,void 0,(function(){!function(e,t,n){Nb(e,"LanguageLoadError",Rb("language",t,n))}(t,o,n)}))}},rS=function(e,t,n){return k.from(t).filter((function(e){return e.length>0&&!pb.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:k.some(t)}}))},oS=function(e,t,n){var r=rS(t,"default",n),o=function(e){return k.from(function(e){return e.getParam("icons_url","","string")}(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:k.none()}}))}(t).orThunk((function(){return rS(t,ju(t),"")}));q(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([r,o]),(function(n){e.add(n.url,s,void 0,(function(){!function(e,t,n){Nb(e,"IconsLoadError",Rb("icons",t,n))}(t,n.url,n.name.getOrUndefined())}))}))},iS=function(e,t){var n=Ya.ScriptLoader;!function(e,t,n,r){var o=Xu(t);if(_(o)){if(!tS(o)&&!Tb.urls.hasOwnProperty(o)){var i=function(e){return e.getParam("theme_url")}(t);i?Tb.load(o,t.documentBaseURI.toAbsolute(i)):Tb.load(o,"themes/"+o+"/theme"+n+".js")}e.loadQueue((function(){Tb.waitFor(o,r)}))}else r()}(n,e,t,(function(){nS(n,e),oS(n,e,t),function(e,t){dt.each(function(e){return e.getParam("external_plugins")}(e),(function(t,n){Sb.load(n,t,s,void 0,(function(){Ob(e,t,n)})),e.settings.plugins+=" "+n})),dt.each(el(e).split(/[ ,]/),(function(n){if((n=dt.trim(n))&&!Sb.urls[n])if(tS(n)){n=n.substr(1,n.length);var r=Sb.dependencies(n);dt.each(r,(function(n){var r={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"},o=Sb.createUrl(r,n);Sb.load(o.resource,o,s,void 0,(function(){Ob(e,o.prefix+o.resource+o.suffix,o.resource)}))}))}else{var o={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};Sb.load(n,o,s,void 0,(function(){Ob(e,o.prefix+o.resource+o.suffix,n)}))}}))}(e,t),n.loadQueue((function(){e.removed||Zk(e)}),e,(function(){e.removed||Zk(e)}))}))},aS=function(e){var t=e.id;nc.setCode($u(e));var n=function(){eS.unbind(window,"ready",n),e.render()};if(bi.Event.domLoaded){if(e.getElement()&&ct.contentEditable){var r=pt.fromDom(e.getElement()),o=function(e){return J(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}(r);e.on("remove",(function(){V(r.dom.attributes,(function(e){return Fn(r,e.name)})),Bn(r,o)})),e.ui.styleSheetLoader=function(e,t){return Sr.forElement(e,{contentCssCors:Zu(t),referrerPolicy:Vu(t)})}(r,e),!function(e){return e.getParam("inline")}(e)?(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden"):e.inline=!0;var i=e.getElement().form||eS.getParent(t,"form");i&&(e.formElement=i,function(e){return e.getParam("hidden_input")}(e)&&!Cn(e.getElement())&&(eS.insertAfter(eS.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},eS.bind(i,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.resetContent()})),!function(e){return e.getParam("submit_patch")}(e)||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),i._mceOldSubmit(i)})),e.windowManager=Eb(e),e.notificationManager=kb(e),function(e){return"xml"===e.getParam("encoding")}(e)&&e.on("GetContent",(function(e){e.save&&(e.content=eS.encode(e.content))})),function(e){return e.getParam("add_form_submit_trigger")}(e)&&e.on("submit",(function(){e.initialized&&e.save()})),function(e){return e.getParam("add_unload_trigger")}(e)&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),iS(e,e.suffix)}}else eS.bind(window,"ready",n)},cS=function(e,t){return function(e,t){return uv(e).editor.addVisual(t)}(e,t)},uS={"font-size":"size","font-family":"face"},lS=function(e,t,n){return om(pt.fromDom(n),(function(t){return function(t){return zn(t,e).orThunk((function(){return"font"===Ct(t)?ge(uS,e).bind((function(e){return Ln(t,e)})):k.none()}))}(t)}),(function(e){return bt(pt.fromDom(t),e)}))},sS=function(e){return function(t,n){return k.from(n).map(pt.fromDom).filter(St).bind((function(n){return lS(e,t,n.dom).or(function(e,t){return k.from(Ka.DOM.getStyle(t,e,!0))}(e,n.dom))})).getOr("")}},fS=sS("font-size"),dS=f((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),sS("font-family")),mS=function(e){return ms(e.getBody()).map((function(e){var t=e.container();return xn(t)?t.parentNode:t}))},pS=function(e,t){return function(e){return k.from(e.selection.getRng()).bind((function(t){var n=e.getBody();return t.startContainer===n&&0===t.startOffset?k.none():k.from(e.selection.getStart(!0))}))}(e).orThunk(p(mS,e)).map(pt.fromDom).filter(St).map(t)},gS=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var r=function(e){return dt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))}(e),o=function(e){return dt.explode(e.getParam("font_size_classes",""))}(e);return o?o[n-1]||t:r[n-1]||t}return t}return t},hS=function(e){var t=e.split(/\s*,\s*/);return W(t,(function(e){return-1===e.indexOf(" ")||Be(e,'"')||Be(e,"'")?e:"'"+e+"'"})).join(",")},vS=function(e,t){var n=function(e){var t;return"string"!=typeof e?(t=dt.extend({paste:e.paste,data:{paste:e.paste}},e),{content:e.content,details:t}):{content:e,details:{}}}(t);!function(e,t,n){cv(e).editor.insertContent(t,n)}(e,n.content,n.details)},bS=dt.each,yS=dt.map,wS=dt.inArray,CS=function(){function e(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}return e.prototype.execCommand=function(e,t,n,r){var o,i=!1,a=this;if(!a.editor.removed){var c;if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?(c=a.editor,Md(c).each((function(e){return c.selection.setRng(e)}))):a.editor.focus(),(r=a.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var u=e.toLowerCase();if(o=a.commands.exec[u])return o(u,t,n),a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(bS(this.editor.plugins,(function(r){if(r.execCommand&&r.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),i=!0,!1})),i)return i;if(a.editor.theme&&a.editor.theme.execCommand&&a.editor.theme.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{i=a.editor.getDoc().execCommand(e,t,n)}catch(e){}return!!i&&(a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},e.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},e.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},e.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;bS(e,(function(e,r){bS(r.toLowerCase().split(","),(function(r){n.commands[t][r]=e}))}))},e.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,o,i,a){return t.call(n||r.editor,o,i,a)}},e.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},e.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},e.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},e.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},e.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},e.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},e.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},e.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},e.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},e.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(n){var r,o=e.getDoc();try{t.execNativeCommand(n)}catch(e){r=!0}if("paste"!==n||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){var i=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");ct.mac&&(i=i.replace(/Ctrl\+/g,"+")),e.notificationManager.open({text:i,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),bS("left,center,right,justify".split(","),(function(t){r!==t&&e.formatter.remove("align"+t)})),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");o&&(r=o.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)&&(t.storeSelection(),e.dom.split(r,o),t.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,r)},FontName:function(t,n,r){!function(e,t){var n=gS(e,t);e.formatter.toggle("fontname",{value:hS(n)}),e.nodeChanged()}(e,r)},FontSize:function(t,n,r){!function(e,t){e.formatter.toggle("fontsize",{value:gS(e,t)}),e.nodeChanged()}(e,r)},LineHeight:function(t,n,r){!function(e,t){e.undoManager.transact((function(){e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()}))}(e,r)},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,o){var i=o||e.selection.getNode();i!==e.getBody()&&(t.storeSelection(),e.dom.remove(i,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var o=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&o++===r)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){vS(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,(function(){return r})))},mceInsertNewLine:function(t,n,r){ok(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){qw(e,t)},mceRepaint:function(){},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"==typeof r&&(r={href:r});var o=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),o&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,o)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),An);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return Vx(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),o=yS(r,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==wS(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return Uw(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return function(e){return pS(e,(function(t){return dS(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("FontSize",(function(){return function(e){return pS(e,(function(t){return fS(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("LineHeight",(function(){return function(e){return pS(e,(function(t){var n=pt.fromDom(e.getBody());return om(t,(function(e){return zn(e,"line-height")}),p(bt,n)).getOrThunk((function(){var e=parseFloat(Hn(t,"line-height")),n=parseFloat(Hn(t,"font-size"));return String(e/n)}))})).getOr("")}(e)}),this)},e}(),xS=function(e,t,n){mc(e,t)&&!1===n?function(e,t){uc(e)?e.dom.classList.remove(t):sc(e,t);dc(e)}(e,t):n&&fc(e,t)},kS=function(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},SS=function(e,t){e.dom.contentEditable=t?"true":"false"},TS=function(e,t){var n=pt.fromDom(e.getBody());xS(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),function(e){k.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))}(e),e.readonly=!0,SS(n,!1),q(gc(n,'*[contenteditable="true"]'),(function(e){Pn(e,"data-mce-contenteditable","true"),SS(e,!1)}))):(e.readonly=!1,SS(n,!0),function(e){q(gc(e,'*[data-mce-contenteditable="true"]'),(function(e){Fn(e,"data-mce-contenteditable"),SS(e,!0)}))}(n),kS(e,"StyleWithCSS",!1),kS(e,"enableInlineTableEditing",!1),kS(e,"enableObjectResizing",!1),Gd(e)&&e.focus(),function(e){e.selection.setRng(e.selection.getRng())}(e),e.nodeChanged())},ES=function(e){return e.readonly},_S=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){ES(e)&&q(t,(function(e){e.attr("data-mce-contenteditable",e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter("data-mce-contenteditable",(function(t){ES(e)&&q(t,(function(e){e.attr("contenteditable",e.attr("data-mce-contenteditable"))}))})),e.serializer.addTempAttr("data-mce-contenteditable")},AS=function(e,t){if(function(e){return"click"===e.type}(t)&&!Df.metaKeyPressed(t)){var n=pt.fromDom(t.target);(function(e,t){return gr(t,"a",(function(t){return bt(t,pt.fromDom(e.getBody()))})).bind((function(e){return Ln(e,"href")}))})(e,n).each((function(n){if(t.preventDefault(),/^#/.test(n)){var r=e.dom.select(n+',[name="'+((Be(o=n,i="#")?function(e,t){return e.substring(t)}(o,i.length):o)+'"]'));r.length&&e.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var o,i}))}},NS=dt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),RS=function(){function e(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||b}return e.isNative=function(e){return!!NS[e.toLowerCase()]},e.prototype.fire=function(e,t){var n=e.toLowerCase(),r=t||{};r.type=n,r.target||(r.target=this.scope),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=y},r.stopPropagation=function(){r.isPropagationStopped=y},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=y},r.isDefaultPrevented=b,r.isPropagationStopped=b,r.isImmediatePropagationStopped=b),this.settings.beforeFire&&this.settings.beforeFire(r);var o=this.bindings[n];if(o)for(var i=0,a=o.length;i<a;i++){var c=o[i];if(c.once&&this.off(n,c.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===c.func.call(this.scope,r))return r.preventDefault(),r}return r},e.prototype.on=function(e,t,n,r){if(!1===t&&(t=b),t){var o={func:t};r&&dt.extend(o,r);for(var i=e.toLowerCase().split(" "),a=i.length;a--;){var c=i[a],u=this.bindings[c];u||(u=this.bindings[c]=[],this.toggleEvent(c,!0)),n?u.unshift(o):u.push(o)}}return this},e.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),o=r.length;o--;){var i=r[o],a=this.bindings[i];if(!i)return ce(this.bindings,(function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]})),this;if(a){if(t)for(var c=a.length;c--;)a[c].func===t&&(a=a.slice(0,c).concat(a.slice(c+1)),this.bindings[i]=a);else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else ce(this.bindings,(function(e,t){n.toggleEvent(t,!1)})),this.bindings={};return this},e.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},e.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},e}(),OS=function(e){return e._eventDispatcher||(e._eventDispatcher=new RS({scope:e,toggleEvent:function(t,n){RS.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},DS={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=OS(this).fire(e,t);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},on:function(e,t,n){return OS(this).on(e,t,n)},off:function(e,t){return OS(this).off(e,t)},once:function(e,t){return OS(this).once(e,t)},hasEventListeners:function(e){return OS(this).has(e)}},IS=Ka.DOM,PS=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=Gu(e);return n?(e.eventRoot||(e.eventRoot=IS.select(n)[0]),e.eventRoot):e.getBody()},BS=function(e,t,n){!function(e){return!e.hidden&&!ES(e)}(e)?ES(e)&&AS(e,n):e.fire(t,n)},MS=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=PS(e,t);if(Gu(e)){if(hC||(hC={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||hC&&(ce(hC,(function(t,n){e.dom.unbind(PS(e,n))})),hC=null)}))),hC[t])return;n=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var a=o[i].getBody();(a===r||IS.isChildOf(r,a))&&BS(o[i],t,n)}},hC[t]=n,IS.bind(r,t,n)}else n=function(n){BS(e,t,n)},IS.bind(r,t,n),e.delegates[t]=n}},LS=Ee(Ee({},DS),{bindPendingEventDelegates:function(){var e=this;dt.each(e._pendingNativeEvents,(function(t){MS(e,t)}))},toggleNativeEvent:function(e,t){"focus"!==e&&"blur"!==e&&(t?this.initialized?MS(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&(this.dom.unbind(PS(this,e),e,this.delegates[e]),delete this.delegates[e]))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(ce(e.delegates,(function(t,n){e.dom.unbind(PS(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),FS=["design","readonly"],jS=function(e,t,n,r){var o=n[t.get()],i=n[r];try{i.activate()}catch(e){return void console.error("problem while activating editor mode "+r+":",e)}o.deactivate(),o.editorReadOnly!==i.editorReadOnly&&TS(e,i.editorReadOnly),t.set(r),function(e,t){e.fire("SwitchMode",{mode:t})}(e,r)},HS=function(e){var t=Qa("design"),n=Qa({design:{activate:s,deactivate:s,editorReadOnly:!1},readonly:{activate:s,deactivate:s,editorReadOnly:!0}});return function(e){e.serializer?_S(e):e.on("PreInit",(function(){_S(e)}))}(e),function(e){e.on("ShowCaret",(function(t){ES(e)&&t.preventDefault()})),e.on("ObjectSelected",(function(t){ES(e)&&t.preventDefault()}))}(e),{isReadOnly:function(){return ES(e)},set:function(r){return function(e,t,n,r){if(r!==n.get()){if(!he(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?jS(e,n,t,r):e.on("init",(function(){return jS(e,n,t,r)}))}}(e,n.get(),t,r)},get:function(){return t.get()},register:function(e,t){n.set(function(e,t,n){var r;if(U(FS,t))throw new Error("Cannot override default mode "+t);return Ee(Ee({},e),((r={})[t]=Ee(Ee({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),r))}(n.get(),e,t))}}},US=dt.each,zS=dt.explode,WS={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},qS=dt.makeMap("alt,ctrl,shift,meta,access"),VS=function(){function e(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(US(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}return e.prototype.add=function(e,t,n,r){var o=this,i=o.normalizeCommandFunc(n);return US(zS(dt.trim(e)),(function(e){var n=o.createShortcut(e,t,i,r);o.shortcuts[n.id]=n})),!0},e.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},e.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:dt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},e.prototype.parseShortcut=function(e){var t,n={};US(zS(e.toLowerCase(),"+"),(function(e){e in qS?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=WS[e]||e.toUpperCase().charCodeAt(0))}));var r=[n.keyCode];for(t in qS)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,ct.mac?n.ctrl=!0:n.shift=!0),n.meta&&(ct.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},e.prototype.createShortcut=function(e,t,n,r){var o=dt.map(zS(e,">"),this.parseShortcut);return o[o.length-1]=dt.extend(o[o.length-1],{func:n,scope:r||this.editor}),dt.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})},e.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},e.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},e.prototype.matchShortcut=function(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))},e.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},e}(),$S=function(){var e=function(){var e={},t={},n={},r={},o={},i={},a={},c=function(e,t){return function(n,r){return e[n.toLowerCase()]=Ee(Ee({},r),{type:t})}};return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(i,"contexttoolbar"),addContextForm:c(i,"contextform"),addSidebar:c(a,"sidebar"),addIcon:function(e,t){return r[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:o,contextToolbars:i,sidebars:a}}}}();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},KS=dt.each,JS=dt.trim,GS="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),XS={ftp:21,http:80,https:443,mailto:25},YS=function(){function e(t,n){t=JS(t),this.settings=n||{};var r=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))o.source=t;else{var i=0===t.indexOf("//");if(0!==t.indexOf("/")||i||(t=(r&&r.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var a=this.settings.base_uri?this.settings.base_uri.path:new e(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+o.toAbsPath(a,t);else{var c=/([^#?]*)([#?]?.*)/.exec(t);t=(r&&r.protocol||"http")+"://mce_host"+o.toAbsPath(a,c[1])+c[2]}}t=t.replace(/@@/g,"(mce_at)");var u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);KS(GS,(function(e,t){var n=u[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n})),r&&(o.protocol||(o.protocol=r.protocol),o.userInfo||(o.userInfo=r.userInfo),o.port||"mce_host"!==o.host||(o.port=r.port),o.host&&"mce_host"!==o.host||(o.host=r.host),o.source=""),i&&(o.protocol="")}}return e.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},e.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},e.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},e.prototype.toRelative=function(t){var n;if("./"===t)return t;var r=new e(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();var o=this.getURI(),i=r.getURI();return o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i?o:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)},e.prototype.toAbsolute=function(t,n){var r=new e(t,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))},e.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=XS[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},e.prototype.toRelPath=function(e,t){var n,r,o=0,i="",a=e.substring(0,e.lastIndexOf("/")).split("/"),c=t.split("/");if(a.length>=c.length)for(n=0,r=a.length;n<r;n++)if(n>=c.length||a[n]!==c[n]){o=n+1;break}if(a.length<c.length)for(n=0,r=c.length;n<r;n++)if(n>=a.length||a[n]!==c[n]){o=n+1;break}if(1===o)return t;for(n=0,r=a.length-(o-1);n<r;n++)i+="../";for(n=o-1,r=c.length;n<r;n++)i+=n!==o-1?"/"+c[n]:c[n];return i},e.prototype.toAbsPath=function(e,t){var n,r,o=0,i=[],a=/\/$/.test(t)?"/":"",c=e.split("/"),u=t.split("/");for(KS(c,(function(e){e&&i.push(e)})),c=i,n=u.length-1,i=[];n>=0;n--)0!==u[n].length&&"."!==u[n]&&(".."!==u[n]?o>0?o--:i.push(u[n]):o++);return 0!==(r=(n=c.length-o)<=0?Z(i).join("/"):c.slice(0,n).join("/")+"/"+Z(i).join("/")).indexOf("/")&&(r="/"+r),a&&r.lastIndexOf("/")!==r.length-1&&(r+=a),r},e.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},e}(),QS=Ka.DOM,ZS=dt.extend,eT=dt.each,tT=dt.resolve,nT=ct.ie,rT=function(){function e(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,ZS(this,LS),this.settings=fb(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(Ya.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),Ka.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),oc.languageLoad=this.settings.language_load,oc.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new YS(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new VS(this),this.editorCommands=new CS(this),this.settings.cache_suffix&&(ct.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:$S(),styleSheetLoader:void 0,show:s,hide:s,enable:s,disable:s,isDisabled:b};var o=HS(this);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=ja.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))}return e.prototype.render=function(){aS(this)},e.prototype.focus=function(e){Yd(this,e)},e.prototype.hasFocus=function(){return Jd(this)},e.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this,i=o.settings[e];if(i)return o.callbackLookup&&(r=o.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?tT(r):0,i=tT(i),o.callbackLookup=o.callbackLookup||{},o.callbackLookup[e]={func:i,scope:r}),i.apply(r||o,t)},e.prototype.translate=function(e){return nc.translate(e)},e.prototype.getParam=function(e,t,n){return mb(this,e,t,n)},e.prototype.hasPlugin=function(e,t){return!!U(el(this).split(/[ ,]/),e)&&(!t||void 0!==Sb.get(e))},e.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},e.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},e.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},e.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},e.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},e.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},e.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},e.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},e.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},e.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(QS.show(this.getContainer()),QS.hide(this.id)),this.load(),this.fire("show"))},e.prototype.hide=function(){var e=this.getDoc();this.hidden||(nT&&e&&!this.inline&&e.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(QS.hide(this.getContainer()),QS.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},e.prototype.isHidden=function(){return!!this.hidden},e.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},e.prototype.load=function(e){var t,n=this.getElement();if(this.removed)return"";if(n){(e=e||{}).load=!0;var r=Cn(n)?n.value:n.innerHTML;return t=this.setContent(r,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t}},e.prototype.save=function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Cn(o)?o.value=t:(!e.is_removing&&r.inline||(o.innerHTML=t),(n=QS.getParent(r.id,"form"))&&eT(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},e.prototype.setContent=function(e,t){return Wv(this,e,t)},e.prototype.getContent=function(e){return zv(this,e)},e.prototype.insertContent=function(e,t){t&&(e=ZS({content:e},t)),this.execCommand("mceInsertContent",!1,e)},e.prototype.resetContent=function(e){void 0===e?Wv(this,this.startContent,{format:"raw"}):Wv(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},e.prototype.isDirty=function(){return!this.isNotDirty},e.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},e.prototype.getContainer=function(){return this.container||(this.container=QS.get(this.editorContainer||this.id+"_parent")),this.container},e.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},e.prototype.getElement=function(){return this.targetElm||(this.targetElm=QS.get(this.id)),this.targetElm},e.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},e.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},e.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},e.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},e.prototype.addVisual=function(e){cS(this,e)},e.prototype.remove=function(){$v(this)},e.prototype.destroy=function(e){Kv(this,e)},e.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},e.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},e.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},e.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},e.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},e.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},e}(),oT=Ka.DOM,iT=dt.explode,aT=dt.each,cT=dt.extend,uT=0,lT=!1,sT=[],fT=[],dT=function(e){var t=e.type;aT(hT.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}}))},mT=function(e){e!==lT&&(e?ja(window).on("resize scroll",dT):ja(window).off("resize scroll",dT),lT=e)},pT=function(e){var t=fT;delete sT[e.id];for(var n=0;n<sT.length;n++)if(sT[n]===e){sT.splice(n,1);break}return fT=$(fT,(function(t){return e!==t})),hT.activeEditor===e&&(hT.activeEditor=fT.length>0?fT[0]:null),hT.focusedEditor===e&&(hT.focusedEditor=null),t.length!==fT.length},gT="CSS1Compat"!==document.compatMode,hT=Ee(Ee({},DS),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:ja,majorVersion:"5",minorVersion:"6.1",releaseDate:"2020-11-25",editors:sT,i18n:nc,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t,n="";t=YS.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/"));var r,o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,n=o.suffix;else{for(var i=document.getElementsByTagName("script"),a=0;a<i.length;a++){var c;if(""!==(c=i[a].src||"")){var u=c.substring(c.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(c)){-1!==u.indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"));break}}}if(!e&&document.currentScript)-1!==(c=document.currentScript.src).indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"))}this.baseURL=new YS(t).toAbsolute(e),this.documentBaseURL=t,this.baseURI=new YS(this.baseURL),this.suffix=n,(r=this).on("AddEditor",p(zd,r)),r.on("RemoveEditor",p(Wd,r))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);var n=e.suffix;e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;void 0!==r&&ce(r,(function(e,t){oc.PluginManager.urls[t]=e}))},init:function(e){var t,n=this,r=dt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=function(e){var t=e.id;return t||(t=ge(e,"name").filter((function(e){return!oT.get(e)})).getOrThunk(oT.uniqueId),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):oT.hasClass(e,t)},a=function(e){t=e},c=function(){var t,u=0,l=[],s=function(e,r,o){var i=new rT(e,r,n);l.push(i),i.on("init",(function(){++u===t.length&&a(l)})),i.targetElm=i.targetElm||o,i.render()};oT.unbind(window,"ready",c),function(t){var r=e[t];if(r)r.apply(n,Array.prototype.slice.call(arguments,2))}("onpageload"),t=ja.unique(function(e){var t=[];if(ct.browser.isIE()&&ct.browser.version.major<11)return Db("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(gT)return Db("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return aT(e.types,(function(e){t=t.concat(oT.select(e.selector))})),t;if(e.selector)return oT.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&aT(iT(n),(function(e){var n=oT.get(e);n?t.push(n):aT(document.forms,(function(n){aT(n.elements,(function(n){n.name===e&&(e="mce_editor_"+uT++,oT.setAttrib(n,"id",e),t.push(n))}))}))}));break;case"textareas":case"specific_textareas":aT(oT.select("textarea"),(function(n){e.editor_deselector&&i(n,e.editor_deselector)||e.editor_selector&&!i(n,e.editor_selector)||t.push(n)}))}return t}(e)),e.types?aT(e.types,(function(n){dt.each(t,(function(t){return!oT.is(t,n.selector)||(s(o(t),cT({},e,n),t),!1)}))})):(dt.each(t,(function(e){var t;(t=n.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(pT(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(t=dt.grep(t,(function(e){return!n.get(e.id)}))).length?a([]):aT(t,(function(t){!function(e,t){return e.inline&&t.tagName.toLowerCase()in r}(e,t)?s(o(t),e,t):Db("Could not initialize inline editor on invalid inline target element",t)})))};return n.settings=e,oT.bind(window,"ready",c),new hr((function(e){t?e(t):a=function(t){e(t)}}))},get:function(e){return 0===arguments.length?fT.slice(0):_(e)?G(fT,(function(t){return t.id===e})).getOr(null):M(e)&&fT[e]?fT[e]:null},add:function(e){var t=this;return sT[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(sT[e.id]=e),sT.push(e),fT.push(e)),mT(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),vC||(vC=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",vC))),e},createEditor:function(e,t){return this.add(new rT(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!_(e))return n=e,R(r.get(n.id))?null:(pT(n)&&r.fire("RemoveEditor",{editor:n}),0===fT.length&&window.removeEventListener("beforeunload",vC),n.remove(),mT(fT.length>0),n);aT(oT.select(e),(function(e){(n=r.get(e.id))&&r.remove(n)}))}else for(t=fT.length-1;t>=0;t--)r.remove(fT[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new rT(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",0,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){aT(fT,(function(e){e.save()}))},addI18n:function(e,t){nc.add(e,t)},translate:function(e){return nc.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new YS(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new YS(this.baseURL)}});hT.setup();var vT,bT,yT,wT,CT=Math.min,xT=Math.max,kT=Math.round,ST=function(e,t,n){var r=t.x,o=t.y,i=e.w,a=e.h,c=t.w,u=t.h,l=(n||"").split("");return"b"===l[0]&&(o+=u),"r"===l[1]&&(r+=c),"c"===l[0]&&(o+=kT(u/2)),"c"===l[1]&&(r+=kT(c/2)),"b"===l[3]&&(o-=a),"r"===l[4]&&(r-=i),"c"===l[3]&&(o-=kT(a/2)),"c"===l[4]&&(r-=kT(i/2)),TT(r,o,i,a)},TT=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},ET={inflate:function(e,t,n){return TT(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:ST,findBestRelativePosition:function(e,t,n,r){var o,i;for(i=0;i<r.length;i++)if((o=ST(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n=xT(e.x,t.x),r=xT(e.y,t.y),o=CT(e.x+e.w,t.x+t.w),i=CT(e.y+e.h,t.y+t.h);return o-n<0||i-r<0?null:TT(n,r,o-n,i-r)},clamp:function(e,t,n){var r=e.x,o=e.y,i=e.x+e.w,a=e.y+e.h,c=t.x+t.w,u=t.y+t.h,l=xT(0,t.x-r),s=xT(0,t.y-o),f=xT(0,i-c),d=xT(0,a-u);return r+=l,o+=s,n&&(i+=l,a+=s,r-=f,o-=d),TT(r,o,(i-=f)-r,(a-=d)-o)},create:TT,fromClientRect:function(e){return TT(e.left,e.top,e.width,e.height)}},_T=(vT={},bT={},{load:function(e,t){var n='Script at URL "'+t+'" failed to load',r='Script at URL "'+t+"\" did not call `tinymce.Resource.add('"+e+"', data)` within 1 second";if(void 0!==vT[e])return vT[e];var o=new hr((function(o,i){var a=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))}},a=i(e),c=i(t);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==o||(o=setTimeout((function(){return c.apply(null,e)}),n))},resolve:a,reject:c}}(o,i);bT[e]=a.resolve,Ya.ScriptLoader.loadScript(t,(function(){return a.start(r)}),(function(){return a.reject(n)}))}));return vT[e]=o,o},add:function(e,t){void 0!==bT[e]&&(bT[e](t),delete bT[e]),vT[e]=hr.resolve(t)}}),AT=dt.each,NT=dt.extend,RT=function(){};RT.extend=yT=function(e){var t=this.prototype,n=function(){var e,t,n,r=this;if(!wT&&(r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(r,arguments)},r=function(){return this};wT=!0;var o=new this;return wT=!1,e.Mixins&&(AT(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&AT(e.Methods.split(","),(function(t){e[t]=r})),e.Properties&&AT(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&AT(e.Statics,(function(e,t){n[t]=e})),e.Defaults&&t.Defaults&&(e.Defaults=NT({},t.Defaults,e.Defaults)),ce(e,(function(e,n){"function"==typeof e&&t[n]?o[n]=function(e,n){return function(){var r=this,o=r._super;r._super=t[e];var i=n.apply(r,arguments);return r._super=o,i}}(n,e):o[n]=e})),n.prototype=o,n.constructor=n,n.extend=yT,n};var OT,DT=Math.min,IT=Math.max,PT=Math.round,BT={serialize:function(e){var t=JSON.stringify(e);return _(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},parse:function(e){try{return JSON.parse(e)}catch(e){}}},MT={callbacks:{},count:0,send:function(e){var t=this,n=Ka.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},LT=Ee(Ee({},DS),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):wr.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",LT.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&dt.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=LT.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();wr.setTimeout(r,10)}}),FT=dt.extend,jT=function(){function e(e){this.settings=FT({},e),this.count=0}return e.sendRPC=function(t){return(new e).send(t)},e.prototype.send=function(e){var t=e.error,n=e.success,r=FT(this.settings,e);r.success=function(e,o){void 0===(e=BT.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,o):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=BT.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",LT.send(r)},e}();try{var HT="__storage_test__";(OT=window.localStorage).setItem(HT,HT),OT.removeItem(HT)}catch(e){OT=function(){var e={},t=[],n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n}()}var UT={geom:{Rect:ET},util:{Promise:hr,Delay:wr,Tools:dt,VK:Df,URI:YS,Class:RT,EventDispatcher:RS,Observable:DS,I18n:nc,XHR:LT,JSON:BT,JSONRequest:jT,JSONP:MT,LocalStorage:OT,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=IT(0,DT(t,1)),i=IT(0,DT(i,1)),0!==t){var a=e/60,c=i*t,u=c*(1-Math.abs(a%2-1)),l=i-c;switch(Math.floor(a)){case 0:n=c,r=u,o=0;break;case 1:n=u,r=c,o=0;break;case 2:n=0,r=c,o=u;break;case 3:n=0,r=u,o=c;break;case 4:n=u,r=0,o=c;break;case 5:n=c,r=0,o=u;break;default:n=r=o=0}n=PT(255*(n+l)),r=PT(255*(r+l)),o=PT(255*(o+l))}else n=r=o=PT(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return function(e,t,n){var r,o;o=0;var i=DT(e/=255,DT(t/=255,n/=255)),a=IT(e,IT(t,n));return i===a?{h:0,s:0,v:100*(o=i)}:(r=(a-i)/a,o=a,{h:PT(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/(a-i))),s:PT(100*r),v:PT(100*o)})}(n,r,o)},t.toHex=function(){var e=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t}},dom:{EventUtils:bi,Sizzle:Zi,DomQuery:ja,TreeWalker:Tr,TextSeeker:Rc,DOMUtils:Ka,ScriptLoader:Ya,RangeUtils:Xf,Serializer:Uv,StyleSheetLoader:Cr,ControlSelection:Pf,BookmarkManager:Nf,Selection:hv,Event:bi.Event},html:{Styles:li,Entities:Po,Node:bm,Schema:qo,SaxParser:Am,DomParser:Mv,Writer:wm,Serializer:Cm},Env:ct,AddOnManager:oc,Annotator:_f,Formatter:Vb,UndoManager:$b,EditorCommands:CS,WindowManager:Eb,NotificationManager:kb,EditorObservable:LS,Shortcuts:VS,Editor:rT,FocusManager:Ld,EditorManager:hT,DOM:Ka.DOM,ScriptLoader:Ya.ScriptLoader,PluginManager:Sb,ThemeManager:Tb,IconManager:pb,Resource:_T,trim:dt.trim,isArray:dt.isArray,is:dt.is,toArray:dt.toArray,makeMap:dt.makeMap,each:dt.each,map:dt.map,grep:dt.grep,inArray:dt.inArray,extend:dt.extend,create:dt.create,walk:dt.walk,createNS:dt.createNS,resolve:dt.resolve,explode:dt.explode,_addCacheSuffix:dt._addCacheSuffix,isOpera:ct.opera,isWebKit:ct.webkit,isIE:ct.ie,isGecko:ct.gecko,isMac:ct.mac},zT=dt.extend(hT,UT);!function(e){window.tinymce=e,window.tinyMCE=e}(zT),function(t){try{e.exports=t}catch(e){}}(zT)}()}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/timers-browserify/main.js").setImmediate)},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/window-or-global/lib/index.js":function(e,t,n){"use strict";(function(t){e.exports="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/editor-plugins/a11ychecker/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/a11ychecker/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/draggable/draggable.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/status-macro/styles.scss":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./node_modules/window-or-global/lib/index.js"),o=n.n(r);n("./node_modules/tinymce/tinymce.js"),n("./node_modules/tinymce/plugins/table/index.js"),n("./node_modules/tinymce/plugins/lists/index.js"),n("./node_modules/tinymce/plugins/paste/index.js");function i(){return"undefined"!=typeof window?window.location:void 0}function a(){if(window&&window.require){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return window.require.apply(window,t)}}function c(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}r.tinymce.confluenceEditorVersion="2.2.3";var u=n("confluence.web.resources:jquery/require('jquery')"),l=n.n(u);function s(e,t,n){return"function"==typeof n?l()(o.a).bind(e,t,n):l()(o.a).bind(e,t)}function f(e,t){return l()(o.a).unbind(e,t)}function d(e,t){return l()(o.a).trigger(e,t)}var m="confluence.spa.editor";function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"value",void 0),p(this,"toJSON",void 0),this.value=t,this.valueOf=this.toString=this.toJSON=function(){return n.value}},h=function(e){return new g(e)},v=function(e,t){Object.keys(t).forEach((function(e){t[e]=h(t[e])})),d("analytics",{name:"".concat(m,".plugins.").concat(e),data:t})},b=n("confluence.web.resources:ajs/require('ajs')"),y=n.n(b);function w(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var C={isCursorAtStartOf:function(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf:function(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("context is invalid. received: ".concat(e));var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.prev(!0)}while(w(i));return void 0===i},isCursorAtEndOf:function(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf:function(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("container is invalid. received: ".concat(e));var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.next(!0)}while(w(i));return void 0===i||"BR"===i.nodeName&&void 0===a.next(!0)},setCursorAtStartOfContents:function(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: ".concat(e));var t=r.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))},isCursorAtEnd:function(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r=t.endContainer;if(3==r.nodeType)return r.wholeText.length==t.endOffset;var o=r.childNodes[t.endOffset];return l()(o).is(":last-child")}},x=C;function k(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r,o=t.startContainer;return 3==o.nodeType?!o.previousSibling&&0===t.startOffset&&function(e){if(0==l()(e).closest("td").length)return!0;for(var t=e.parentNode;t&&"td"!=t.nodeName.toLowerCase();){if(l()(t).prevAll().contents().filter((function(){return 3==this.nodeType})).length)return!1;t=t.parentNode}return!0}(o):l()(o).is("p:first-child")?0===t.startOffset:l()(o).is(".wysiwyg-macro-body")?1==t.startOffset&&(3==(r=t.startContainer.childNodes[0]).nodeType&&"\n"==r.nodeValue):void 0}function S(e,t,n){var o=e.dom.create("p",{},r.tinymce.Env.ie?"&nbsp;":'<br data-mce-bogus="1" />');n?t.after(o):t.before(o),e.selection.select(o,!0),e.selection.collapse()}function T(){var e=r.tinymce.activeEditor;r.tinymce.Env.ie&&e.on("KeyPress",(function(t){var n=e.selection,o=n.getNode();if(13==t.keyCode&&"P"==o.nodeName&&e.dom.is(o,":first-child")&&r.tinymce.confluence.MacroUtils.isInMacro(o)){var i=e.dom.create("p","&#x200b");return e.dom.insertAfter(i,o),n.select(i,1),n.collapse(),r.tinymce.dom.Event.cancel(t)}})),r.tinymce.Env.gecko&&e.on("KeyPress",(function(t){if(t.charCode==r.tinymce.util.VK.SPACE){var n=e.selection.getNode(),o=l()(n).closest("a"),i=e.selection.getRng();o.length&&x.isCursorAtEnd(e,e.selection.getRng())&&(i.setStartAfter(o[0]),i.setEndAfter(o[0]),e.selection.setRng(i),e.selection.collapse())}})),e.on("KeyPress",(function(t){if(13==t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=l()(n).closest("pre");if(o.length&&!r.tinymce.confluence.MacroUtils.isInMacro(o)&&x.isCursorAtEnd(e,e.selection.getRng()))return S(e,o,!0),r.tinymce.dom.Event.cancel(t);var i=l()(n).closest("blockquote");if(i.length){var a=l()(n).closest("p");if(a.is(":first-child")&&k(e,e.selection.getRng()))return S(e,i,!1),r.tinymce.dom.Event.cancel(t);if(a.is(":last-child")&&function(e){var t=e.contents();if(!t.length)return!0;if(1==t.length){if(t.is("br"))return!0;if("&nbsp;"==t.html()||160==t.text().charCodeAt(0))return!0;if(3==t[0].nodeType&&t[0].nodeValue==y.a.Rte.HIDDEN_CHAR)return!0}return!1}(a))return e.dom.remove(a[0],!1),S(e,i,!0),r.tinymce.dom.Event.cancel(t)}}return!0}),!0)}var E=function(e){var t=o.a.document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");return n.indexOf(e)>-1&&-1===n.indexOf("".concat(e,".disable"))}},_=function(e){return l()("<br>").add(e.contents())},A=function(e){return(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE)&&l.a.trim(e.textContent)},N=function(e){var t=!1;return e.parent().contents().each((function(){if(A(this))return this===e[0]&&(t=!0,!1)})),t},R=function(e){var t=e.attr("style"),n=l()("<p></p>").append(e.contents());t&&n.attr("style",t),e.replaceWith(n)},O=function(e){var t=e.prev("p");t.length?(t.append(_(e)),e.remove()):N(e)?R(e):e.replaceWith(_(e))},D=function(e,t){var n=l()('<table class="wysiwyg-macro" data-macro-name="'.concat(e,'" data-macro-body-type="RICH_TEXT">')+'<tbody><tr><td class="wysiwyg-macro-body"></td></tr></tbody></table>');return n.find(".wysiwyg-macro-body").append(t),n},I=function(e){return""===e.text()},P=R,B=[function(e){e.find(".expand-container").replaceWith((function(){var e=l()(this).find(".expand-content").first().contents();return e.length?D("expand",e):l()("")}))},function(e){e.find("span:empty").remove()},function(e){e.find("p + br").remove()},function(e){var t=!1;e.find("div:not(.content-wrapper)").each((function(){var e=l()(this);I(e)?(e.remove(),t=!0):e.find("div, p, pre").length?e.replaceWith(e.contents()):(t?P(e):O(e),t=!1)}))}];var M={repair:function(e){var t=l()("<div></div>").html(e);return B.forEach((function(e){e(t)})),t.html()}},L=[{repair:function(e){var t=/(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody><tr>'.concat(t[1],"</tr></tbody></table>"):e}},{repair:function(e){var t=/(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody>'.concat(t[1],"</tbody></table>"):e}}],F=function(e){return e?(L.forEach((function(t){e=t.repair(e)})),e):e},j={apply:function(e){return e=function(e){return E("editor.advanced.paste.disable")?e:M.repair(e)}(e=F(e))},repair:F},H=n("confluence.web.resources:meta/require('confluence/meta')"),U=n.n(H).a,z=function(e){e.parentNode.removeChild(e)},W=function(e){return function(t){var n=t.classList;n.remove.apply(n,e),""===t.className&&t.removeAttribute("class")}},q=function(e,t,n){r.tinymce.util.Tools.each(e.querySelectorAll(t),n)};var V={apply:function(e,t){!function(e){var t;q(e,"img:not([data-emoticon-name]):not(.editor-inline-macro):not(.confluence-embedded-image):not(.template-constiable)",(t=["confluence-embedded-image","confluence-external-resource"],function(e){var n=e.classList;n.add.apply(n,t)}))}(e),function(e){q(e,"span.Apple-style-span",W(["Apple-style-span"]))}(e),function(e){q(e,"br.Apple-interchange-newline",z)}(e),function(e){q(e,"meta",z)}(e),function(e,t){q(e,"ul.inline-task-list > li[data-inline-task-id]",(function(n){var o,i,a=n.getAttribute("data-inline-task-id");r.tinymce.util.Tools.grep(t.querySelectorAll('li[data-inline-task-id="'.concat(a,'"]')),(i=e,o=function(e){return function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e,i)},function(e){return!o(e)})).length>0&&n.setAttribute("data-inline-task-id","")}))}(e,t),function(e){var t;q(e,".mceSelected",W(["mceSelected"])),q(e,"[data-mce-selected]",(t="data-mce-selected",function(e){e.removeAttribute(t)}))}(e),function(e){var t=U.get("base-url");q(e,"a:not([data-base-url='".concat(t,"'])[data-base-url]"),(function(e){for(var n=e.attributes.href?e.attributes.href.value:t;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("href",n)}))}(e)}},$=function(e,t){return"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?l()(e,t||r.document):l()("<div>".concat(e,"</div>"),t||r.document).contents()},K=function(e,t){e.is("ul.inline-task-list")?t.each((function(){var e=l()(this);e.attr("data-inline-task-id")||e.attr("data-inline-task-id","")})):t.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")},J=function(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return r.tinymce.isIE?"LI"===t.nodeName&&0===t.childNodes.length:"LI"===t.nodeName&&1===t.childNodes.length&&"BR"===t.firstChild.nodeName},G=function(e,t){if(!t.collapsed||0!=t.startOffset)return!1;var n=l()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).prev(!0);return void 0===o||l()(o).is("li")},X=function(e){var t=e.filter("ol,ul").length;return e.length===t},Y=function(e,t,n){var r=null;return Q.forEach((function(o){if(o.shouldInsert(e,t,n))return r=o,!1})),r},Q=[{shouldInsert:function(e,t,n){var r=J(t);return(r=r&&X(n))&&n.children("li").length>0},insert:function(e,t,n){var r=l()(3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.replaceWith(o),e.selection.select(o.last()[0],!0),e.selection.collapse(),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=G(e,t);return(r=r&&X(n))&&n.children("li").length>0},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.before(o),e.selection.select(r[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t,n){return function(e,t){if(!t.collapsed)return!1;if(3===t.startContainer.nodeType&&t.startOffset!=t.startContainer.nodeValue.length)return!1;if(1===t.startContainer.nodeType&&t.startOffset!=t.startContainer.childNodes.length)return!1;var n=l()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).next(!0);return void 0===o||l()(o).is("li")}(e,t)&&n.length===n.filter("ol,ul").length&&n.children("li").length>0},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.after(o),e.selection.select(o.last()[0],!0),e.selection.collapse(!1),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=n.length>1;return r=(r=(r=r&&!J(t))&&G(e,t))&&function(e){var t=e.filter("ol,ul"),n=e[e.length-1];return 1===t.length&&t[0]===n}(n)},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody());e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),n.children("li"));var o=l()("<li></li>").append(n);r.before(o),e.undoManager.add()}},{shouldInsert:function(e,t,n){return!t.collapsed&&(!!l()(t.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")&&n.is("table:not(.wysiwyg-macro)"))},insert:function(e,t,n){var r=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),o=r.children("td, th"),i=l()(".mceSelected",e.getDoc()),a=i.parent();function c(e,t){for(var n=e.shift(),r=t.shift();n&&r;n=e.shift(),r=t.shift())l()(r).html(l()(n).html())}if(e.undoManager.beforeChange(),e.undoManager.add(),1===a.length)c(l.a.makeArray(o),l.a.makeArray(i));else for(var u=l.a.makeArray(r),s=l.a.makeArray(a),f=u.shift(),d=s.shift();f&&d;f=u.shift(),d=s.shift())c(l.a.makeArray(l()(f).children()),l.a.makeArray(l()(d).children()));e.selection.setRng(t),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0===r.length)return!1;var o=r.closest("table.confluenceTable",".mceContent");if(0===o.length||0===o.children("tbody").length)return!1;if(!n.is("table:not(.wysiwyg-macro)"))return!1;var i=!1;return o.find("*[colspan], *[rowspan]").each((function(e,t){if(parseInt(l()(t).attr("rowspan"))>1||parseInt(l()(t).attr("colspan"))>1)return i=!0,!1})),!i},insert:function(e,t,n){var o=l()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent"),i=o.closest("table.confluenceTable",".mceContent"),a=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),c=i.children("tbody").children("tr"),u=a.length,s=a.first().children("td, th").length,f=c.length,d=c.first().children("td, th").length,m=o.parent().index(),p=o.index();e.undoManager.beforeChange(),e.undoManager.add();var g=p+s-d,h=m+u-f;g=g<0?0:g,h=h<0?0:h,c.each((function(e,t){for(var n=l()(t),o=n.children().last(),i=0;i<g;i++)n.append(o.clone().html(r.tinymce.isIE?"":"<br/>"))}));for(var v=c.last(),b=0;b<h;b++){for(var y=l()("<tr></tr>").insertAfter(v),w=0;w<d+g;w++)y.append('<td class="confluenceTd">'.concat(r.tinymce.isIE?"":"<br/>","</td>"));v=y}var C=[];i.children("tbody").children("tr").slice(m).each((function(e,t){C.push(l.a.makeArray(l()(t).children("th, td").slice(p)))}));var x=[];a.each((function(e,t){x.push(l.a.makeArray(l()(t).children("th, td")))}));for(var k=x.shift(),S=C.shift();k&&S;k=x.shift(),S=C.shift())for(var T=k.shift(),E=S.shift();T&&E;T=k.shift(),E=S.shift())l()(E).html(l()(T).html());e.selection.select(o[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t){return l()(t.startContainer).closest("[data-macro-body-type='PLAIN_TEXT']").length>0},insert:function(e,t,n){n.raw&&e.selection.setContent(n.raw())}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("table").length>0,o=1===n.length&&n.is("table.wysiwyg-macro");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("table").is("table.wysiwyg-macro"),o=1===n.length&&n.is("table.confluenceTable");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}}],Z={insert:function(e,t,n,r){var o=e.selection.getRng();if(o){var i,a,c,u=(i=e,a=t.content,c={content:a,format:"html",selection:!0},i.fire("BeforeSetContent",c),c.content),l=$(u,e.getDoc());l.raw=!!n&&function(){return n};var s=Y(e,o,l);s?(s.insert(e,o,l),e.fire("SetContent",{content:u,format:"html",selection:!0}),e.addVisual()):(e.selection.isCollapsed()||e.undoManager.ignore((function(){e.execCommand("mceDelete",!1,null,{skip_undo:!0})})),t.wasProcessed=!0,e.execCommand("mceInsertContent",!1,t,{skip_undo:r}))}},parse:$};function ee(e,t,n,r){return"function"==typeof r?l()(e).bind(t,n,r):l()(e).bind(t,n)}function te(e,t,n){return l()(e).unbind(t,n)}function ne(e,t,n){return l()(e).trigger(t,n)}function re(e){var t={repair:j.repair,parse:Z.parse},n=null;function o(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(?:\r\n|\r|\n)/g,"<br />")}e.on("PastePreProcess",(function(e){e.content=j.apply(e.content),ne(r.document,"prePaste",[t,e]),r.tinymce.Env.ie&&(n=function(e){var t=l()("<pre>".concat(e.content||"","</pre>"))[0];return o(t.innerText||t.textContent)}(e))})),e.on("PastePostProcess",(function(n){V.apply(n.node,e.getBody()),ne(r.document,"postPaste",[t,n])})),e.on("BeforeExecCommand",(function(t){var r=t.command,o=t.value;"mceInsertContent"===r&&o&&!0===o.paste&&!o.wasProcessed&&(t.preventDefault(),Z.insert(e,o,n,!1))})),e.on("paste",(function(e){if(n=null,!r.tinymce.Env.ie){var t=o(e.clipboardData.getData("text/plain"));n=t}}),!0)}var oe,ie,ae=[],ce={};function ue(e){var t='<span class="text-placeholder">'.concat(oe,"</span>"),n=l()("<div></div>").append(t);e&&n.find(".text-placeholder").html(e),r.tinymce.activeEditor.execCommand("mceInsertContent",!1,n.html())}function le(e){var t=r.tinymce.activeEditor,n=l()(t.getBody()),o=oe,i=e&&e.parentElement;i&&"LI"===i.nodeName&&(o=ie);var a=t.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");i&&e&&i.replaceChild(a,e);var c=n.find("#placeholder-cursor")[0];t.selection.select(c.firstChild),t.dom.remove(c,!1),t.execCommand("mceInsertContent",!1,o)}function se(){return ae}function fe(e){return ce[e]}r.tinymce.Env.ie?(oe="\ufeff{$caret}",ie="<p>{$caret}</p>"):ie=oe=r.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var de={insertTextPlaceHolder:ue,removePlaceholder:le,addPlaceholderType:function(e){e&&e.type&&(ae.push(e),ce[e.type]=e)},getPlaceholderTypes:se,getPlaceholderType:fe};function me(){return r.AJS.Rte}var pe={"editor.autocomplete.macros.header.text":"Macro suggestions","editor.autocomplete.macros.dialog.browse":"Open macro browser","editor.autocomplete.macros.error.load.header":"Failed to get macro details","editor.autocomplete.macros.error.load.retrylink":"Try again","editor.autocomplete.links.header.text":"Link suggestions","editor.autocomplete.links.dialog.search":"Search for &lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"Search","editor.autocomplete.links.web.link":"Insert web link","editor.autocomplete.links.create.link":"Insert link to create page","editor.autocomplete.file.header.text":"File suggestions","editor.autocomplete.media.header.text":"Media suggestions","editor.autocomplete.media.files.dialog.browse":"Open file library","editor.autocomplete.media.macros.dialog.browse":"Insert other media","editor.autoformat.sampletext.firstcell":"first cell","editor.autoformat.sampletext.heading":"heading","calendar3.helptip.learn.more":"Learn More","tinymce.confluence.placeholder.inline.tasks":"Type your task here, using \u0022@\u0022 to assign to a user and \u0022//\u0022 to select a due date","tinymce.confluence.files":"Files","tinymce.confluence.conf_file_desc":"Insert files and images","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.confluence.conf_wikimarkup_conversion_errors":"Wiki markup conversion errors","tinymce.confluence.conf_wikimarkup_timeout":"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.","tinymce.confluence.conf_wikimarkup_info_title":"Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.","tinymce.confluence.conf_wikimarkup.insert.label":"Insert","tinymce.confluence.conf_wikimarkup_preview_label":"Preview","editor.minor.edit":"Notify watchers","property.panel.textplaceholder.display.default":"Text","property.panel.textplaceholder.display.default.tooltip":"Instructional text is replaced with empty content when a person types.","property.panel.textplaceholder.remove":"Remove","editor.shared.draft.done.desc":"Save draft and close editor","editor.change.comment":"What did you change?","tinymce.tablepicker.insert_table_title":"Insert table","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"Got it, thanks!","comment.notification.enable":"Watch this page"},ge=function(e){var t=pe[e];return void 0!==t?t:e};function he(){return{name:"textplaceholder",canHandleElement:function(e){return e.hasClass("text-placeholder")},handle:function(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=se(),o=e.containerEl,i=o.getAttribute("data-placeholder-type"),a=[],c=f("default",ge("property.panel.textplaceholder.display.default"),ge("property.panel.textplaceholder.display.default.tooltip"));c.selected=!i,a.push(c);for(var u=0,s=n.length;u<s;u++)t=n[u],a.push(f(t.type,t.label,t.tooltip));a.push(null),a.push({className:"text-placeholder-property-panel-remove-button",text:ge("property.panel.textplaceholder.remove"),click:function(){r.Confluence.PropertyPanel.destroy(),le(o)}}),r.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,a,{anchorIframe:me().getEditorFrame()})}function f(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-".concat(e),text:t,tooltip:n,selected:i===e,click:function(){!function(e){"default"===e?o.removeAttribute("data-placeholder-type"):o.setAttribute("data-placeholder-type",e);var t=l()(".text-placeholder-property-panel-type-".concat(e));t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function ve(){var e={click:!1,keypress:!0},t=r.tinymce.VK,n=r.tinymce.dom.Event,o="template"===U.get("content-type");function i(e){d("cursor-target-refresh"),l()("#rte-button-insert-placeholder").click((function(e){e.preventDefault(),ue()})),e.on("KeyDown",(function(t){if(13===t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=l()(n).closest(".text-placeholder"),i=e.selection.getRng();if(o.length&&i&&x.isCursorAtEnd(e,i))return S(e,o,!0),r.tinymce.dom.Event.cancel(t)}}),!0)}var a={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function c(e){return!a[e.nodeName]}function u(o){function i(){var e=f();e&&o.selection.select(e)}function a(e){e.off("KeyDown",u),e.off("KeyPress",s),e.off("Click",s)}function u(e){var r=f();return e.keyCode===t.LEFT||e.keyCode===t.UP?(function(e,t){for(var n,r=t&&t.previousSibling;t&&!r;)r=(t=t.parentNode).previousSibling;if(r){for(n=r;!c(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.RIGHT||e.keyCode===t.DOWN?(function(e,t){for(var n,r=t&&t.nextSibling;t&&!r;)r=(t=t.parentNode).nextSibling;if(r){for(n=r;!c(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.BACKSPACE||e.keyCode===t.DELETE?(le(r),n.cancel(e)):void 0}function s(t){if(!r.tinymce.Env.gecko||t.isChar||"keypress"!==t.type){var n,o,i,a=f();if(a){var c=a.getAttribute("data-placeholder-type");n=c,o=t.type,i=n&&fe(n),l.a.extend({},e,i&&i.activation)[o]&&(le(a),d("editor.text-placeholder.activated",{placeholderType:c||"",triggerEvent:t}))}}}function f(){var e=l()(o.getBody()).find(".text-placeholder.selected");return e.length?e[0]:(a(o),null)}o.on("NodeChange",(function(e){var t=e.element,n=l()(t).closest(".text-placeholder");l()(o.getBody()).find(".text-placeholder.selected").not(n).removeClass("selected"),n.length?(n.hasClass("selected")||(n.addClass("selected"),function(e){e.on("KeyDown",u,!0),e.on("KeyPress",s,!0),e.on("Click",s,!0)}(o)),setTimeout(i,0)):a(o)}),!0)}return{init:function(e){e.on("init",(function(){(o?i:u)(e),function(e){var t=l()(e.getDoc()).find("head");r.tinymce.Env.ie?t.append('<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>'):t.append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')}(e)}))},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}var be,ye=U.get("context-path"),we=0,Ce={updateNode:function(e,t){var n=r.tinymce.activeEditor,o=l()(e,n.getDoc()),i="confluence.update-node-".concat(we++);d("synchrony.stop",{id:i});var a=Ce.prepareNodeForUpdate(o);return Ce.replaceNode(o,t).fail(a).always((function(){d("synchrony.start",{id:i})})).promise()},storeNodeState:function(e,t){for(var n,r={},o=0,i=t.length;o<i;o++)n=t[o],r[n]=e.attr(n);return function(){for(var t in r)e.attr(t,r[t])}},prepareNodeForUpdate:function(e){var t;return e.is("img")&&(t=Ce.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:"".concat(ye,"/images/border/spacer.gif"),width:e.attr("width"),height:e.attr("height")})),t},replaceNode:function(e,t){var n=Ce.getDoc(),o=l()(t,n),i=l()(e,n),a="confluence.replace-node-".concat(we++);return d("synchrony.stop",{id:a}),l.a.Deferred((function(){var e=this;o.is("img")?(o[0].onload=function(){this.onload=null,e.resolve(this)},r.tinymce.Env.opera&&(o[0].src=o.attr("src")),n.createDocumentFragment().appendChild(o[0])):e.resolve(o[0])})).always((function(){d("synchrony.start",{id:a})})).done((function(e){i.replaceWith(e)})).promise()},replaceSelection:function(e){var t=r.tinymce.activeEditor,n=t.selection.getRng(),o=t.getDoc().createRange(),i=l()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=me().HIDDEN_CHAR),n.insertNode(i);var a=t.getDoc().createTextNode(me().HIDDEN_CHAR);t.dom.insertAfter(a,i);var c=a;return o.setStartBefore(c),o.setEndAfter(c),o.collapse(!1),t.selection.setRng(o),i},normalize:function(e){var t,n,o=r.tinymce.activeEditor,i=o.selection.getRng(),a=null,c=[];if(e&&e.childNodes){if(r.tinymce.Env.webkit?a=i:r.tinymce.Env.gecko&&i&&(a=i.cloneRange(),((t={startIndex:Array.from(e.childNodes).indexOf(i.startContainer),startOffset:a.startOffset,endIndex:Array.from(e.childNodes).indexOf(i.endContainer),endOffset:a.endOffset}).startIndex>-1||t.endIndex>-1)&&(c=function(e){var t=[],n=0;return Array.prototype.forEach.call(e.childNodes,(function(e,r){var o={},i=t[r-1]||{};o.isTextNode=3===e.nodeType,o.textNodesBefore=(o.isTextNode&&i.isTextNode?1:0)+~~i.textNodesBefore,o.precedingTextLength=n,n=o.isTextNode&&e.nodeValue?n+e.nodeValue.length:0,t.push(o)})),t}(e))),e.normalize(),r.tinymce.Env.gecko&&a){if(n=c[t.startIndex]){var u=t.startIndex-n.textNodesBefore,l=t.startOffset+n.precedingTextLength;a.setStart(e.childNodes[u],l)}if(n=c[t.endIndex]){var s=t.endIndex-n.textNodesBefore,f=t.endOffset+n.precedingTextLength;a.setEnd(e.childNodes[s],f)}}a&&o.selection.setRng(a)}},getDoc:function(){return r.tinymce.Env.gecko||r.tinymce.Env.opera?document:r.tinymce.activeEditor.getDoc()},isolateSelectedRange:function(){var e=r.tinymce.activeEditor,t=Ce.getDoc(),n=e.selection,o=n.getRng();if(o){var i,a=o.startContainer,c=o.startOffset,u=o.endContainer,s=o.endOffset;if(o.collapsed)return o;a===u&&(i=s-c);var f=m(a,c);f&&o.setStartBefore(f),a!==o.startContainer&&(s=i||s);var d=m(u,s,!0);return d&&o.setEndAfter(d),n.setRng(o),o}function m(n,r,o){var i=e.dom.getParent(n,e.dom.isBlock);i||(i=e.getBody());var a=function(e,n,r,o){var i,a,c=null,u=null,s=o?"nextSibling":"previousSibling";if(!(i=0===n)&&o&&(i=3===e.nodeType?n===e.length:n===e.childNodes.length),i)for(c=e[s],u=e;null===c;){if(u===r)return;if(u.parentNode===r)break;c=(u=u.parentNode)[s]}else 3===e.nodeType?(a=e.data,e.data=a.slice(n),c=t.createTextNode(a.slice(0,n)),u=e,l()(c).insertBefore(u),o&&(a=u,u=c,c=a)):c=(u=e.childNodes[n-(o?1:0)])[s];return[u,c]}(n,r,i,o);return a?a[1]?function(e,t,n,r){for(var o,i,a,c;t!==n&&t.parentNode!==n;){if(o=(i=t.parentNode).cloneNode(!1),r)for(l()(o).insertAfter(i),a=e;a;)c=a.nextSibling,o.appendChild(a),a=c;else for(l()(o).insertBefore(i),a=i.firstChild;a!==t;)c=a.nextSibling,o.appendChild(a),a=c;e=o,t=i}return t}(a[1],a[0],i,o):a[0]:void 0}}},xe=Ce;var ke=function(){var e,t=r.tinymce.activeEditor,n=Te();t.focus(!1);var o=t.selection.getRng();e=o&&o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,be={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},Se=function(){var e=r.tinymce.activeEditor.selection,t=r.tinymce.activeEditor.getWin();be&&(Ee(be),t.focus(),e.setRng(be.range)),be=null},Te=function(){var e=r.tinymce.DOM.getViewPort(r.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},Ee=function(e){e&&r.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},_e={storeBookmark:ke,restoreBookmark:Se,getScroll:Te,restoreScroll:Ee};function Ae(){var e=U.get("content-id");return+e||(e=U.get("page-id")),+e||(e="0"),e}function Ne(e){return l()(e).hasClass("wysiwyg-macro")}function Re(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: ".concat(e));n=e}var o,i=l.a.Deferred(),a=r.tinymce.activeEditor;if(!t){var c="macro-".concat((new Date).getTime());o=a.dom.create("span",{id:c}),a.selection.setNode(o),t=o=a.dom.select("#".concat(c))[0],i.fail((function(){l()(o).remove()}))}return l.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),y.a.Editor.UI.setButtonsState(!1),l.a.ajax(n).done((function(e){var n=e;function r(e){return e&&e.parentNode}"<"!==n[0]&&(n=document.createTextNode(n)),r(t)?xe.updateNode(t,n).done((function(e){i.resolve(e,n)})).fail(i.reject):i.rejectWith(this,Array.from(arguments))})).fail((function(e,t,n){i.rejectWith(this,Array.from(arguments))})),i.done((function(e,t){y.a.Editor.UI.setButtonsState(!0),Ne(e)&&/P|H\d/.test(e.parentNode.nodeName)&&a.dom.split(e.parentNode,e),function(e){var t=r.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng();if(Ne(e)){!r.tinymce.isIE&&l()("p, pre",e).each((function(e,t){0===t.childNodes.length&&t.appendChild(n.createElement("br"))}));var i=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;i&&(o.setStart(i,0),o.setEnd(i,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),a.nodeChanged(),me().showElement(e),a.fire("SetContent",{content:t,format:"html",selection:!0}),r.tinymce.activeEditor.undoManager.add(),d("macro-browser.macro-inserted")})).fail((function(){y.a.Editor.UI.setButtonsState(!0)})),i.promise()}var Oe,De={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:Re,isInMacro:function(e){return l()(e).closest(".wysiwyg-macro").length>0},updateMacro:function(e,t,n,r){return Re({contentId:Ae(),macro:{name:n,params:e,body:t||""}},r)}},Ie=De;var Pe=Oe={storedRange:null,bookmark:null,editedMacroDiv:null,editedMacro:null,getCurrentNode:function(){return l()(r.tinymce.activeEditor.selection.getNode())},isMacroDiv:function(e){return l()(e).hasClass("wysiwyg-macro")},isMacroTag:function(e){var t=l()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:function(e){return l()(e).hasClass("editor-inline-macro")},isMacroWithBody:function(e){return l()(e).hasClass("wysiwyg-macro")},isMacroStartTag:function(e){return l()(e).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(e){return l()(e).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(e){return l()(e).hasClass("wysiwyg-macro-body")},hasMacroBody:function(e){return"true"==l()(e).attr("macrohasbody")},getNestingMacros:function(e){var t=l()(e||Oe.getCurrentNode()),n=[];return t.parents(".wysiwyg-macro").each((function(e,t){n.push(l()(t).attr("data-macro-name"))})),n},logMCESelection:function(e){r.tinymce.activeEditor.selection},getSelectedMacro:function(){var e=Oe.getCurrentNode();return Oe.isMacroDiv(e)?e:Ie.isInMacro(e)},openMacro:function(e){y.a.MacroBrowser.open({selectedMacro:e,onComplete:Oe.macroBrowserComplete,onCancel:Oe.macroBrowserCancel})},editMacro:function(e){var t=l()(e);Oe.editedMacroDiv=t[0];var n=r.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});r.tinymce.activeEditor.selection.select(t[0]),ke(),l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/definition"),data:JSON.stringify({contentId:Ae(),macroHtml:n}),dataType:"text",success:function(e){Oe.openMacro(JSON.parse(e))}})},macroBrowserToolbarButtonClicked:function(e){var t=r.tinymce.activeEditor,n=Oe.getCurrentNode();ke();var o=l.a.extend({presetMacroName:null,nestingMacros:Oe.getNestingMacros(n),onComplete:Oe.macroBrowserComplete,onCancel:Oe.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if((!e||e&&!e.ignoreEditorSelection)&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof y.a.MacroBrowser.Model.addMacro)return y.a.MacroBrowser.open(o);var i=o.presetMacroMetadata&&o.presetMacroMetadata.macroName||o.presetMacroName,a=y.a.MacroBrowser.getMacroMetadata(i);a?(o.presetMacroMetadata=o.presetMacroMetadata||a,y.a.MacroBrowser.open(o)):y.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:function(e){e&&e.details?(y.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=y.a.MacroBrowser.getMacroMetadata(o.presetMacroName),s("reset.complete",(function e(){y.a.MacroBrowser.open(o),f("reset.complete",e)})),d("reset.rte")):y.a.MacroBrowser.open(o)},errorCallback:function(e){console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})},macroBrowserComplete:function(e){var t={contentId:U.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};Se(),Oe.editedMacroDiv?(Ie.insertMacro(t,Oe.editedMacroDiv),delete Oe.editedMacroDiv):Ie.insertMacro(t)},macroBrowserCancel:function(){Se(),Oe.editedMacroDiv=null,Oe.editedMacro=null}};n("./src/editor-plugins/propertypanel/css/property-panel.css");var Be=function(){var e=r.Confluence.PropertyPanel,t=[];return s("add-handler.property-panel",(function(e,n){n&&t.push(n)})),{init:function(n){var o,i=function(){return!!e.current},a=function(o,a){var c={focusedEl:a,focusedNodeName:a.nodeName&&a.nodeName.toLowerCase(),ed:n,e:l.a.extend({},o)},u=function(e){if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""}(l()(a)),s=!!l()(a).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,f=!!l()(".toolbar-contextual").length;if(c.containerEl=u,d("user-blurred-rte-element",c),u&&!function(e){return"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0)}(o)&&!i()&&e.shouldCreate)for(var m=0,p=t.length;m<p;m++)if(t[m].canHandleElement(l()(u))){if(f||!s)return t[m].handle(c);!function(e){ee(r.document,"shown.contextToolbar",(function(){e.handle(c)}))}(t[m])}};function c(e,t){a(e,t.elem)}function u(t,n){i()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():d("same-anchor.property-panel"))}function m(){setTimeout((function(){me().bindScroll("property-panel",(function(){e.destroy()}))}),0),l()(n.getDoc()).bind("keydown.property-panel.escape",(function(t){27===t.keyCode&&i()&&e.destroy()}))}function p(){me().unbindScroll("property-panel"),l()(n.getDoc()).unbind("keydown.property-panel.escape")}r.tinymce.Env.ie&&n.on("MouseDown",(function(e){o&&o.unbind("mouseup.IEDragHandlesWorkaround"),(o=l()(e.target)).filter("img, table").bind("mouseup.IEDragHandlesWorkaround",(function(){a(e,e.target)}))})),n.on("Click",(function(e){a(e,e.target)})),n.on("KeyUp",(function(e){27!==e.keyCode&&a(e,n.selection.getNode())}),!0),n.on("ContextMenu",(function(){e.destroy()})),s("trigger.property-panel",c),s("user-blurred-rte-element",u),s("created.property-panel",m),s("destroyed.property-panel",p),n.on("Remove",(function(){f("trigger.property-panel",c),f("user-blurred-rte-element",u),f("created.property-panel",m),f("destroyed.property-panel",p)}))},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};n("./src/editor-plugins/confcharmap/charmap.css");var Me=/^\u200b?(\[)$/;function Le(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function Fe(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function je(e){return e&&"ul"===e.nodeName.toLowerCase()&&!Fe(e)}function He(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),0===e.classList.length&&e.removeAttribute("class"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach((function(e){e.removeAttribute("data-inline-task-id"),e.classList.remove("checked"),e.style.backgroundImage=""})))}function Ue(){return!(e=U.get("use-inline-tasks"),"true"===e||!0===e||"page"===U.get("content-type")||"blogpost"===U.get("content-type")||"template"===U.get("content-type"));var e}var ze=function(){return!!U.get("collaborative-content")&&We()},We=function(){var e=U.get("content-type");return"page"===e||"blogpost"===e};function qe(){return l()("#table-highlight-group").attr("data-highlight-colour")||""}function Ve(e,t,n){if(!t.length)return l()("");for(var r=function(e,t){var n=l()(e.selection.getNode());return!!n.length&&(n[0]===t[0]||!!n.closest(t).length)}(e,t),o=t[0],i=o.ownerDocument.createElement(n),a=o.attributes,c=0,u=a.length;c<u;c++){var s=a[c];i.setAttribute(s.nodeName,s.nodeValue)}for(;o.hasChildNodes();)i.appendChild(o.firstChild);return o.parentNode.replaceChild(i,o),r&&(e.selection.select(i,!0),e.selection.collapse()),l()(i)}var $e,Ke={convertToNormalCells:function(e,t){t.filter("th").each((function(){var t=l()(this);(t=Ve(e,t,"td")).removeClass("confluenceTh"),t.addClass("confluenceTd")}))},convertToHeadingCells:function(e,t){t.filter("td").each((function(){var t=l()(this);(t=Ve(e,t,"th")).removeClass("confluenceTd"),t.addClass("confluenceTh")}))},areCellsHeadings:function(e){var t=e.filter("th").length;return e.length===t},isColumnHeading:function(e,t){var n=l()(e).children("tbody").children("tr");return 1!==n.length&&n.children().filter("th:nth-child(".concat(t,")")).length===n.length},areCellsHighlighted:function(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,r=qe();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==r)return!1;return!0}(t)},isColumnHighlighted:function(e,t){var n=l()(e).children("tbody").children("tr").children("th,td").nthCol(t),r=n.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(n.length!==r)return!1;for(var o=n.eq(0).attr("data-highlight-colour"),i=1,a=n.length;i<a;i++)if(o!==n.eq(i).attr("data-highlight-colour"))return!1;return!0},getSelectedHighlightColour:qe},Je=n("com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')"),Ge=n.n(Je),Xe=function(e){function t(t){var r,o,i=function(t){return e.translate(t)};n(t),Ke.getSelectedHighlightColour()&&(r=Ke.getSelectedHighlightColour(),o=i([i("table.cell_background_color"),Ge.a.colorNames[r.substring(1,r.length)]]),t.attr("data-highlight-colour",r),t.attr("title",o),t.children().attr("title",""),t.addClass("highlight-".concat(r)))}function n(e){var t,n,r;for(t=0,n=e.length;t<n;t++)(r=e.eq(t)).attr("data-highlight-colour")&&r.removeAttr("data-highlight-colour"),r.attr("title")&&r.removeAttr("title"),r[0].className=r[0].className.replace(/( |^)highlight-[#\w]+/g,"")}e.on("init",(function(){var o=function(e){return l()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},i=function(e){var t=l()(e.getBody()).find("th.confluenceTh[data-mce-selected],td.confluenceTd[data-mce-selected]");return t.length?t:o(e)},a=function(e){return 0===e.find("tbody > tr > td").length};function c(e){return l()(e).parents("table").is(".confluenceTable")}function u(t){if(9===t.keyCode){var n=e.selection.getNode();if(c(n)&&!function(t){var n=e.dom.getParent(t,"UL,OL,TR").tagName;return"UL"===n||"OL"===n}(n)){var r=t.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell";return e.execCommand(r),t.preventDefault(),!1}}}e.addCommand("confTableRowToggleHeading",(function(){var t=function(e){var t=l()(e.getBody()).find("td[data-mce-selected],th[data-mce-selected]");t.length||(t=l()(e.selection.getNode()));for(var n=t.closest("tr"),r=n.parent(),o=r.is("tbody")?n.parent().parent():r;0!==n.length&&!o.is(".confluenceTable");)n=o.closest("tr"),o=(r=n.parent()).is("tbody")?n.parent().parent():r;return n}(this),n=t.children("td,th"),r=0;return Ke.areCellsHeadings(n)?(a(t.closest("table"))||(n=n.filter((function(){var e=l()(this),t=e.closest("table");return r+=parseInt(e.attr("colspan"))||1,!Ke.isColumnHeading(t,r)}))),Ke.convertToNormalCells(e,n)):Ke.convertToHeadingCells(e,n),!1})),e.addCommand("confTableColumnToggleHeading",(function(){var t=function(e){var t=l()([]);return e.each((function(){var e=l()(this),n=e.index()+1,r=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(r.children().nthCol(n))})),t}(i(this));return Ke.areCellsHeadings(t)?(a(t.closest("table"))||(t=t.filter((function(){var e=l()(this).parent("tr").children(),t=e.filter("th");return e.length!==t.length}))),Ke.convertToNormalCells(e,t)):Ke.convertToHeadingCells(e,t),!1})),e.addCommand("confTableSelectionToggleHighlight",(function(e,r){var o=r&&r.alwaysHighlight,a=i(this);return Ke.areCellsHighlighted(a)&&!o||l()("#table-highlight-group").attr("data-remove-highlight")?n(a):t(a),!1})),(r.tinymce.isIE8||E("confluence-table-enhancements.auto-row"))&&e.on("KeyDown",(function(t){function n(t,n){var r=e.selection.getRng();if(!r)return!1;var o=r.startContainer;if(r.collapsed){var i=function(e,t,n){for(;e!=t;){if(e[n])return!1;e=e.parentNode}return!0}(o,t,n);return 3===o.nodeType?i&&r.startOffset==("nextSibling"==n?o.length:0):o==t?r.startOffset==("nextSibling"==n?o.childNodes.length-1:0):i}return!1}if((37===t.keyCode||39===t.keyCode)&&!t.shiftKey){var i=o(this);if(i.length){var a=i[0];if(37===t.keyCode&&n(a,"previousSibling")&&(c=e.selection.getNode(),l()(c).parents("table").first().find("tr:first-child").children().first()[0]!=c))return e.execCommand("mceTableMoveCaretToPrevCell"),r.tinymce.dom.Event.cancel(t);if(39===t.keyCode&&n(a,"nextSibling")&&!function(){var t=e.selection.getNode();return l()(t).parents("table").first().find("tr:last-child").children().last()[0]==t}())return e.execCommand("mceTableMoveCaretToNextCell"),r.tinymce.dom.Event.cancel(t)}}var c})),e.on("KeyDown",(function(t){u(t),function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(),r=l()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==r.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var o=r.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],i=l()(o);i.hasClass("numberingColumn")&&(o=i.next()[0]),n&&(n.setStart(o,0),n.setEnd(o,0),e.selection.setRng(n)),t.preventDefault()}}}(t)})),E("confluence-table-enhancements.auto-row")&&(e.on("Click",(function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")})),e.on("KeyDown",(function(t){if((38===t.keyCode||40===t.keyCode)&&c(e.selection.getNode())&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1}),!0))})),E("confluence-table-enhancements.auto-row")&&e.on("init",(function(){l()(e.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}))},Ye={},Qe=0,Ze=function(e,t){if(e&&(Ye[e]?Ye[e]++:Ye[e]=1,t)){var n="".concat(e,"Size");Ye[n]?Ye[n]+=t:Ye[n]=t}},et=function e(){Ye.pageID=U.get("page-id"),Ye.editorVersion=h("2.2.3"),d("analytics",{name:"confluence.editor.action",data:Ye}),Ye={},Object(r.clearTimeout)($e),$e=Object(r.setTimeout)(e,6e4)},tt={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"},nt=Ze;var rt=function(e){e.addCommand("confInsertTable",(function(t,n){return function(e,t,n,o){var i,a,c,u,l,s=r.tinymce.Env,f=s.ie&&s.ie<10?"&nbsp;":'<br data-mce-bogus="1">';for(c='<table id="__mce" class="confluenceTable"><tbody>',i=0;i<n;i++){var d=0===i&&o,m=d?"confluenceTh":"confluenceTd";for(c+="<tr>",a=0;a<t;a++)c+=d?"<th class=".concat(m,">").concat(f,"</th>"):"<td class=".concat(m,">").concat(f,"</td>");c+="</tr>"}c+="</tbody></table>",e.undoManager.transact((function(){e.insertContent(c),(u=e.dom.get("__mce"))&&e.dom.setAttrib(u,"id",""),e.$("tr",u).each((function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each((function(t,n){l=l||n,e.fire("newcell",{node:n})}))})),u&&e.dom.setAttribs(u,e.settings.table_default_attributes||{}),u&&e.dom.setStyles(u,e.settings.table_default_styles||{})})),e.selection.select(l,!0),e.selection.collapse(!0)}(e,n.cols,n.rows,n.heading),nt("insert.table"),!1})),e.addCommand("mceInsertTable",(function(){return r.tinymce.execCommand("confInsertTable",!1,{rows:4,cols:3,heading:!0}),!1}))},ot=function(e){var t,n,r=/([\+\-]?\d*)[nN]([\+\-]?\d*)/;e.fn.nthCol=function(o){var i,a,c,u,l,s,f,d,m;return c={multiplier:0,offset:0},"even"===(i=o)?i="2n":"odd"===i?i="2n+1":/^\d*$/.test(i)&&(i="0n+".concat(i)),null!==(a=r.exec(i))&&(c.multiplier=a[1]-0,c.offset=a[2]-0),n=c,u=this,f=[],d=0,m=[],e.each(u,(function(e,t){var n=0,r=0,o=t.rowSpan||1,i=t.colSpan||1;for(t.parentNode!==l&&((l=t.parentNode).parentNode!==s&&(s=l.parentNode,f=[]),d=0,void 0===f[l.rowIndex]&&(f[l.rowIndex]=[])),n=0;n<f[l.rowIndex].length+1;n+=1)if(void 0===f[l.rowIndex][n]){d=n;break}for(m[e]=d,n=l.rowIndex;n<l.rowIndex+o;n+=1)for(void 0===f[n]&&(f[n]=[]),r=d;r<d+i;r+=1)f[n][r]=!0})),t=m,e(this).filter((function(e){return r=t[e]-(n.offset-1),0===n.multiplier?0===r:r%n.multiplier==0&&r/n.multiplier>=0;var r}))}};function it(e){var t=0;e.find(">tbody >tr").each((function(){var e=0;l()(this).find(">th,>td").each((function(){var t=l()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++})),e>t&&(t=e)}));var n=e.find(">colgroup"),r=n.find("col"),o=r.length;if(o!==t){var i=n.length>0;if(i||(n=l()("<colgroup>")),t>o)for(var a=0;a<t-o;a++){var c=l()("<col>");n.append(c)}else for(var u=0;u<o-t;u++)r.last().remove();return i||e.prepend(n),n}}function at(e,t,n){var o=e.find(">colgroup>col");0===o.length&&(it(e),o=e.find(">colgroup>col"));for(var i,a,c,u=o.length,s=e.find(">thead>tr,>tbody>tr,>tr"),f=0;f<s.length;f++)if(u===s.eq(f).find(">th, >td").length){i=s.eq(f);break}if(i)a=i.find(">th, >td");else{var d=l()("<tr>");(c=l()("<tfoot>")).append(d);for(var m=0;m<u;m++)d.append(l()("<td>"));e.append(c),a=d.find(">td")}for(var p=e.outerWidth()-1,g=[],h=[],v=0;v<u;v++){var b=a.eq(v),y=b[0].getBoundingClientRect(),w=t?"".concat(y.width/p*100,"%"):b.outerWidth();g[v]=w,h[v]=y}var C=0;r.tinymce.activeEditor&&(C=r.tinymce.activeEditor.getWin().pageXOffset);for(var x=0;x<u;x++)o.eq(x).attr("data-resize-pixel",h[x].width).attr("data-resize-percent",h[x].width/p*100).attr("data-offset-left",h[x].left+C).attr("data-offset-right",h[x].right+C).removeAttr("data-mce-style"),(!n||x===n.index()&&x===n.next().index())&&o.eq(x).css({width:g[x]});c&&c.remove(),e.removeAttr("data-mce-style")}function ct(e,t,n){var r={},o=!1,i=t.find("body");return n.each((function(){var t=l()(this);pt(t)&&t.find("th, td").each((function(){if(!r[t]){var n=l()(this),a=n.offset().left+n.innerWidth();Math.abs(a-parseInt(e.attr("data-offset-right")))<=0&&(r[t]=!0,o=!0,function(e,t){l()('<div contenteditable="false" class="resize-alignment-bar">').css({top:lt(e[0],i[0]),left:t,height:e.height()}).appendTo(i)}(t,a))}}))})),o}function ut(e){e.find(".resize-alignment-bar").remove()}function lt(e,t){return parseInt(e.getBoundingClientRect().top-t.getBoundingClientRect().top,10)}var st=function(e){var t={$doc:l()(r.document)},n=this,o=n.data("uuid");if(!n.data("initialized")){o||(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),n.data("uuid",o)),e=l.a.extend(t,e||{});var i,a,c,u,s,f,m,p,g,h,v=e.$doc,b=e.editor,y=v.find("body"),w=!1,C=-1,x=!1,k=l()('<div contenteditable="false" class="synchrony-exclude" id="resize-indicator">'),S=l()('<div contenteditable="false" class="synchrony-exclude resize-width-holder" unselectable="on">'),T=!1,_=function(){k.remove(),n.removeClass("active-resizable"),T=!1,m=void 0,u=null,s=null,y.attr("data-table-resizing",!1)},A=function(e){v.find("#resize-indicator").length>0?k=v.find("#resize-indicator"):k.appendTo(y),n.addClass("active-resizable"),k.css({top:lt(n[0],y[0]),left:e,height:n.height()}),T=!0},N=function(e){y.outerWidth(!0)!==y[0].scrollWidth&&(e&&dt(n),y.find("#".concat(o,"-holder")).length||(S.css("width",n.width()+parseInt(l()(b.getBody()).css("margin-right"))),S.attr("id","".concat(o,"-holder")),n.after(S)))};return n.on("mousemove.table-resizable".concat(o),"th, td",(function(e){if(!w&&!(l()(this).parents("table.confluenceTable").length>1||gt(n)&&E("confluence.table.resizable.hide-indicator-on-fluid"))){it(n);var t,r=l()(this),o=r.offset().left,a=Math.round(k.outerWidth()/2),c=r.index(),u=r.parent().children();C=-1;var s=r.closest("tr").index();if(r.closest("table.confluenceTable tr").prevAll("tr").each((function(){var e=l()(this),t=e.index();e.children("td, th").each((function(){if(r.offset().left>l()(this).offset().left){var e=parseInt(l()(this).attr("colspan")),n=parseInt(l()(this).attr("rowspan"));e&&n?t+n>s&&(c+=e):n&&t+n>s&&(c+=1)}}))})),x=!1,e.pageX-r.offset().left<r.outerWidth()/2){if(0===(c-=1)&&r.prev().hasClass("numberingColumn"))return;if(c<0){x=!0;var d=u.eq(0);d.attr("colspan")?C+=parseInt(d.attr("colspan")):C++}else for(var m=0;m<=c;m++){var p=u.eq(m);p.attr("colspan")?C+=parseInt(p.attr("colspan")):C++}t=x?o+r.outerWidth()-a:o-a}else{if(0===c&&r.hasClass("numberingColumn"))return;for(var g=0;g<=c;g++){var h=u.eq(g);h.attr("colspan")?C+=parseInt(h.attr("colspan")):C++}t=o+r.outerWidth()-a}i=r.closest("table").find("col").eq(C),function(){if(Math.abs(f-t)<=1)if(T){if(Math.abs(e.pageX-t-a)<=4)return;_()}else{if(!(Math.abs(e.pageX-t-a)<=4))return;A(t)}else Math.abs(e.pageX-t-a)<=4?A(t):_()}(),f=t,pt(n)&&N()}})),n.on("mousedown.table-resizable".concat(o),(function(e){O(e)})),n.on("mouseout.table-resizable".concat(o),(function(){w||_()})),v.on("keypress.table-resizable".concat(o),(function(){T&&_()})),v.on("mousemove.table-resizable".concat(o),(function(e){w&&(d("synchrony.stop",{id:"confluence.table-resize-plugin"}),R(e.pageX-a,!0,e),e.preventDefault())})),v.on("mouseup.table-resizable".concat(o),(function(){w&&(n[0].releaseCapture&&n[0].releaseCapture(),w=!1,_(),ut(v),dt(n),i&&i.width()!==c&&(gt(n)&&n.addClass("relative-table"),d("analytics",{name:"confluence.table.resize.from.".concat(h),data:{pageId:U.get("page-id")}})),mt(n)&&ft(n),pt(n)&&N(!0),b&&(b.undoManager.add(),d("synchrony.start",{id:"confluence.table-resize-plugin"})))})),n.data("initialized",!0),this}function R(e,t,r){c||(c=i.width()),i.attr("data-mce-style")&&i.removeAttr("data-mce-style");var o=!1;if(p){var a=e-p,f=n.parent().width(),d=n.width()/f*100;mt(n)&&d>99.9&&a>1&&(o=!0,!s&&(s=i.width()+i.next().width()));var h=Math.abs(Math.abs(e)-Math.abs(p));if(h>=7&&(m=!1),m&&h<7)return}var b=c+e;if(b<29&&(b=29),i.width(b),(o||u)&&(i.next().width(s-b),!u&&(u=r.pageX)),u&&u>r.pageX&&(u=null),at(n,!1,i),!x&&t&&(k.css({display:"block",top:lt(n[0],y[0]),left:parseInt(i.attr("data-offset-right"))-1,height:n.height()}),pt(n))){var w=ct(i,v,g)||function(e,t,n){var r;return Math.abs(parseInt(e.next().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,n.find(".resizable-align-right").remove(),l()('<div contenteditable="false" class="resize-alignment-bar resizable-align-right">').css({height:t.height(),top:lt(t[0],n[0]),left:parseInt(e.next().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.attr("data-offset-left"))-1}).appendTo(n)),Math.abs(parseInt(e.prev().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,l()('<div contenteditable="false" class="resize-alignment-bar">').css({height:t.height(),top:lt(t[0],n[0]),left:parseInt(e.prev().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.prev().attr("data-offset-left"))-1}).appendTo(n)),r}(i,n,y);w&&(m=!0),!w&&ut(y)}p=Math.abs(e)}function O(e){i&&T&&(h=pt(n)?"fixed":mt(n)?"relative":"fluid",w=!0,at(n),n.updateTableModeInToolbar(),E("confluence.table.resizable.relative.keep.width")&&i.next().length||n.css({width:""}),a=e.pageX,n[0].setCapture&&n[0].setCapture(),v.find("body").attr("data-table-resizing",!0),c=i.width(),g=function(e){var t=e.nextAll(".confluenceTable").first(),n=e.prevAll(".confluenceTable").first();return l.a.merge(n,t)}(n),e.preventDefault())}},ft=function(e){var t=e.parent().width(),n=e.width()/t*100;return n>100&&(n=100),e.css({width:"".concat(n,"%")}).attr("data-resize-percent",n),function(e){at(e,!0)}(e),e},dt=function(e){return e.parent("body").find("#".concat(e.data("uuid"),"-holder")).remove(),e},mt=function(e){return e.hasClass("relative-table")},pt=function(e){return e.hasClass("fixed-table")},gt=function(e){return!mt(e)&&!pt(e)},ht=function(e){var t={$doc:l()(r.document)},n=(e=l.a.extend(t,e||{})).$doc,o=this.data("uuid");return n.find("#resize-indicator").remove(),this.off("mousemove.table-resizable".concat(o)),this.off("mouseout.table-resizable".concat(o)),this.off("mousedown.table-resizable".concat(o)),n.off("keypress.table-resizable".concat(o)),n.off("mousemove.table-resizable".concat(o)),n.off("mouseup.table-resizable".concat(o)),this.data("initialized",!1),this},vt=function(){return dt(l()(this)).removeClass("relative-table fixed-table").removeAttr("style").find(">colgroup").remove(),this},bt=function(){var e=l()(this);return dt(e),function(e){return at(e),e}(e).css("width","").removeClass("relative-table").addClass("fixed-table"),e.find(">tbody >tr >td, >tbody >tr >th").each((function(e,t){t.style.width=""})),this},yt=function(){var e=r.tinymce.activeEditor;if(this.parent().closest("table.confluenceTable").length)return l()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive")),void l()("#table-mode-picker .aui-dd-parent").addClass("disabled");l()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),pt(this)?l()("#table-mode-picker .dropdown-text").text(e.translate("table.fixed_width")):l()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive"))},wt=function(e,t,n){if(n||n.content){var r=l()("<div/>").append(n.content);r.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each((function(){var e;(e=l()(this)).data("resize-percent")?e.css({width:"".concat(e.data("resize-percent"),"%")}):e.attr("style",e.data("mce-style"))})),n.content=r.html()}},Ct=function(e){var t=l()(e.getWin().document);function n(){t.find("table.confluenceTable").each((function(){l()(this).removeTableResizable({$doc:t})})),t.find("#resize-indicator").remove(),t.find(".resize-width-holder").remove(),l()(e.getBody()).removeAttr("data-table-resizing")}return e.on("Change",(function(){var n=e.selection.getNode(),r=l()(n).parent().closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable");r.is(".confluenceTable")&&r.removeTableResizable({$doc:t}).tableResizable({$doc:t,editor:e,force:!0})})),s("confluence.editor.on.save",n),e.on("Remove",(function(){f("confluence.editor.on.save",n)})),t.on("mousemove","table.confluenceTable",(function(){var n=l()(this);n.parents("table.confluenceTable").length||n.data("initialized")||n.tableResizable({$doc:t,editor:e})})),r.tinymce.isWebKit&&l()(r.document).bind("prePaste",wt),r.tinymce.Env.ie&&l()('<style type="text/css"></style>').html(".confluenceTable td, .confluenceTable th {overflow: hidden !important;}.confluenceTable .content-wrapper {overflow-x : visible !important}").appendTo(t.find("head")),this},xt=function(e){l.a.fn.tableResizable=st,l.a.fn.removeTableResizable=ht,l.a.fn.toggleFluidColumnWidth=vt,l.a.fn.toggleFixedColumnWidth=bt,l.a.fn.updateTableModeInToolbar=yt,e.on("init",(function(){Ct(e)}))};function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e){Array.from(e.getBody().querySelectorAll(".confluenceTable.fixed-table >tbody >tr >td, .confluenceTable.fixed-table >tbody >tr >th")).forEach((function(e){e.style.width=""}))}var Tt=function(){var e=r.tinymce.each,t=r.AJS.storageManager;ot(l.a);var n,i=t("atlassian.editor","tables");function a(e,t){return parseInt(e.getAttribute(t)||"1")}function c(t,o,i){var c,u,s,f,d,m,p=o.dom;b();var g,h;function v(e,t){return(e=e.cloneNode(t)).removeAttribute("id"),t&&D()&&e.removeChild(e.children[0]),e}function b(){var n=0;c=[],e(["thead","tbody","tfoot"],(function(r){var o=p.select("> ".concat(r," > tr"),t);e(o,(function(t,o){o+=n,e(p.select("> td, > th",t),(function(e,t){var n,i;if(c[o])for(;c[o][t];)t++;var u=a(e,"rowspan"),l=a(e,"colspan");for(i=o;i<o+u;i++)for(c[i]||(c[i]=[]),n=t;n<t+l;n++)c[i][n]={part:r,real:i==o&&n==t,elm:e,rowspan:u,colspan:l}}))})),n+=o.length}))}function y(e,t){var n=c[t];if(n)return n[e]}function w(e,t,n){e&&(1===n?e.removeAttribute(t):e.setAttribute(t,n.toString()))}function C(e){return e&&e.elm&&(e.elm.hasAttribute("data-mce-selected")||e==d)}function x(){var n=[];return e(t.rows,(function(t){e(t.cells,(function(e){if(e&&e.hasAttribute("data-mce-selected")||e==d.elm)return n.push(t),!1}))})),n}function k(t){var n;return r.tinymce.walk(t,(function(o){var i;if(3===o.nodeType)return e(p.getParents(o.parentNode,void 0,t).reverse(),(function(e){e=v(e,!1),n?i&&i.appendChild(e):n=i=e,i=e})),i&&(i.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1}),"childNodes"),w(t=v(t,!1),"rowSpan",1),w(t,"colSpan",1),n?t.appendChild(n):r.tinymce.isIE||(t.innerHTML='<br data-mce-bogus="1" />'),l()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}function S(){var n=p.createRng();if(e(p.select("tr",t),(function(e){0===e.cells.length&&p.remove(e)})),0===p.select("tr",t).length)return n.setStartAfter(t),n.setEndAfter(t),i.setRng(n),void p.remove(t);e(p.select("thead,tbody,tfoot",t),(function(e){0===e.rows.length&&p.remove(e)})),function(){var e;b();var t=c[Math.min(c.length-1,u.y)];t&&(e=t[Math.min(t.length-1,u.x)].elm)&&(n=e,r.tinymce.isIE9||r.tinymce.isIE10up?(i.setCursorLocation(n,0),i.collapse(!0)):(i.select(n,!0),i.collapse(!0)));var n}()}function T(e,t,n,r){var o,i,a,u,l;for(o=c[t][e].elm.parentNode,a=1;a<=n;a++)if(o=p.getNext(o,"tr")){for(i=e;i>=0;i--)if((l=c[t+a][i].elm).parentNode==o){for(u=1;u<=r;u++)p.insertAfter(k(l),l);break}if(-1==i)for(u=1;u<=r;u++)o.insertBefore(k(o.cells[0]),o.cells[0])}}function E(){e(c,(function(t,n){e(t,(function(e,t){var r,o,i;if(C(e)){var c=e.elm;if(r=a(c,"colspan"),o=a(c,"rowspan"),r>1||o>1){for(w(c,"rowSpan",1),w(c,"colSpan",1),i=0;i<r-1;i++)p.insertAfter(k(c),c);T(t,n,o-1,r)}}}))}))}function _(t){var n,o,i,u,l,s,f,d,m,g,h;for(e(c,(function(r,o){if(e(r,(function(e){if(C(e)&&(l=e.elm.parentNode,s=v(l,!1),n=o,t))return!1})),t)return!n})),u=0;u<c[0].length;u++)if(c[n][u]&&(o=c[n][u].elm)!=i){if(t){if(n>0&&c[n-1][u]&&(m=a(d=c[n-1][u].elm,"rowSpan"))>1){w(d,"rowSpan",m+1);continue}}else if((m=a(o,"rowspan"))>1){w(o,"rowSpan",m+1);continue}(f=(h=A(u))?p.create("th"):p.create("td")).colSpan=o.colSpan,f.width=o.width,f.innerHTML=r.tinymce.isIE9?"":r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />',f.className=o.className,h||(p.removeClass(f,r.tinymce.settings.confluence_table_heading_style),p.addClass(f,r.tinymce.settings.confluence_table_cell_style)),g=p.getAttrib(o,"data-highlight-colour",""),N(u)?p.setAttrib(f,"data-highlight-colour",g):p.removeClass(f,"highlight-".concat(g)),s.appendChild(f),i=o}s.hasChildNodes()&&(t?l.parentNode.insertBefore(s,l):p.insertAfter(s,l)),O()}function A(e){if(1===c.length)return!1;for(var t=0;t<c.length;t++)if(c[t]&&c[t][e]&&"TH"!==c[t][e].elm.tagName.toUpperCase())return!1;return!0}function N(e){var t=c[0][e].elm.getAttribute("data-highlight-colour");if(null===t)return!1;for(var n=0;n<c.length;n++)if(c[n][e].elm.getAttribute("data-highlight-colour")!==t)return!1;return!0}function R(t){var o,i,u=[];return e(c,(function(n){if(e(n,(function(e,n){if(C(e)&&(o=n,t))return!1})),t)return!o})),0==o&&t&&D()?[]:(e(c,(function(e,c){var s,f;if(e[o]){var d=e[o].elm;if(0===c){var m=l()(d).closest("table"),g=m.find(">colgroup>col").eq(o),h=l()("<col>");t?h.insertBefore(g):h.insertAfter(g),m.hasClass("fixed-table")&&(n&&0!==parseFloat(n)?h.css({width:n}):h.css({width:29}))}if(d!=i){if(f=a(d,"colspan"),s=a(d,"rowspan"),1==f){var v=function(e){var t=p.create(e.tagName);t.colSpan=e.colSpan,t.width=e.width,t.className=e.className,t.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';var n=p.getAttrib(e,"data-highlight-colour","");return n&&p.setAttrib(t,"data-highlight-colour",n),l()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}(d);t?(d.parentNode.insertBefore(v,d),T(o,c,s-1,f)):(p.insertAfter(v,d),T(o,c,s-1,f)),u.push(v)}else w(d,"colSpan",d.colSpan+1);i=d}}})),u)}function O(){if(D()){m=1;var n=0,r=0;e(t.rows,(function(e){var t=l()(e);Ke.areCellsHeadings(t.children())?t.children(":first").addClass("numberingColumn").attr("contenteditable","true"):r>0?r--:(t.children(":first").html(m.toString()).attr("contenteditable","false").addClass("numberingColumn"),(n=parseInt(t.children(":first").attr("rowspan")))>1&&(r=n-1),m++)}))}}function D(){return l()(t.rows[0]).children(":first").hasClass("numberingColumn")}function I(e){if(e){l()(t.rows[0]).children(":first").addClass("numberingColumn");var n=l()(t),r=n.find(">colgroup>col").eq(0),o=l()("<col>");o.insertBefore(r),n.hasClass("fixed-table")&&o.css({width:29})}else l()(t.rows[0]).children(":first").removeClass("numberingColumn"),l()(t).find(">colgroup>col").eq(0).remove()}function P(){var t=[];e(c,(function(n){e(n,(function(n,o){C(n)&&-1===r.tinymce.inArray(t,o)&&(l()(n.elm).closest("table").find(">colgroup>col").eq(o).remove(),e(c,(function(e){if(e[o]){var t=e[o].elm,n=a(t,"colSpan");n>1?w(t,"colSpan",n-1):p.remove(t)}})),t.push(o))}))})),S()}function B(){var t={};return e(c,(function(r){e(r,(function(e,r){C(e)&&(n=l()(e.elm).closest("table").find(">colgroup>col").eq(r).css("width"),0===parseFloat(n)&&(n="".concat(e.elm.getBoundingClientRect().width)),t[r]||(t[r]=[]))}))})),e(c,(function(n){e(n,(function(e,n){t[n]&&t[n].push(e.elm.innerHTML)}))})),t}function M(e){e&&e.parentNode&&(i.select(e.parentNode),i.collapse(!0))}function L(e,t){var n=y(e.x,e.y).elm,o=void 0===t||t,a=null;if((r.tinymce.isGecko||r.tinymce.isIE)&&n.firstChild&&(a=n.firstChild),r.tinymce.isIE9||r.tinymce.isIE10up){var c=i.getRng();if(!c)return;o?(c.setStart(a||n,0),c.setEnd(a||n,0)):(c.setStartAfter(a||n),c.setEndAfter(a||n)),i.setRng(c)}else i.select(a||n,!0),i.collapse(o)}function F(){var e,t=c[0].length;return u.x==t-1&&u.y==c.length-1||(u.x==t-1&&D()?(e={x:1,y:u.y+1},Ke.areCellsHeadings(l()(c[e.y][0].elm).parent().children())&&(e.x=0)):e=u.x==t-1?{x:0,y:u.y+1}:{x:u.x+1,y:u.y}),e}function j(){var e,t;return 0==u.x&&0==u.y||(1==u.x&&D()&&u.y>0?(t=u.y-1,e={x:c[t].length-1,y:t}):u.x>0?e={x:u.x-1,y:u.y}:(t=u.y-1,e={x:c[t].length-1,y:t})),e}function H(t){var n;return e(c,(function(r,o){return e(r,(function(e,r){if(e.elm==t)return n={x:r,y:o},!1})),!n})),n}(f=p.select("td[data-mce-selected],th[data-mce-selected]")[0]||l()(i.getStart()).closest(["table.confluenceTable > tbody > tr > th","table.confluenceTable > tbody > tr > td","table.confluenceTable > thead > tr > th","table.confluenceTable > thead > tr > td"].join(","))[0])&&(u=H(f),g=h=0,e(c,(function(t,n){e(t,(function(e,t){var r,o;C(e)&&(e=c[n][t],t>g&&(g=t),n>h&&(h=n),e.real&&(r=e.colspan-1,o=e.rowspan-1,r&&t+r>g&&(g=t+r),o&&n+o>h&&(h=n+o)))}))})),s={x:g,y:h},d=y(u.x,u.y)),r.tinymce.extend(this,{deleteTable:function(){var e=p.createRng();e.setStartAfter(t),e.setEndAfter(t),i.setRng(e),p.remove(t)},split:E,merge:function(t,n,o){var i,a,l,f,d,m,g,h,v;if(t){var C=H(t);i=C.x,a=C.y,l=i+(n-1),f=a+(o-1)}else i=u.x,a=u.y,l=s.x,f=s.y;if(0!=i||!D()){g=y(i,a);var x=y(l,f);if(g&&x&&g.part==x.part){var k=function(){if(E(),b(),!(g=y(i,a)))return{v:void 0};var n=g.elm;for(w(n,"colSpan",l-i+1),w(n,"rowSpan",f-a+1),m=a;m<=f;m++)for(d=i;d<=l;d++)c[m]&&c[m][d]&&(t=c[m][d].elm)!=n&&(h=r.tinymce.grep(t.childNodes),e(h,(function(e){n.appendChild(e)})),h.length&&(h=r.tinymce.grep(n.childNodes),v=0,e(h,(function(e){"BR"===e.nodeName&&p.getAttrib(e,"data-mce-bogus","")&&v++<h.length-1&&n.removeChild(e)}))),p.remove(t));S()}();if("object"===kt(k))return k.v}}},insertRow:_,insertCol:R,insertNumCol:function(){var t;D()?(e(c,(function(e){var t=e[0].elm;l()(t).hasClass("numberingColumn")&&null!==t.parentNode&&t.parentNode.removeChild(t)})),I(!1)):(e(c,(function(e){var n=e[0].elm;if(t!=n){var r=k(n);n.parentNode.insertBefore(r,n),n.rowSpan>1&&(r.rowSpan=n.rowSpan),t=n}})),I(!0)),O()},updateNumCol:O,deleteCols:P,deleteRows:function(){var t=x();(r.tinymce.isIE9||r.tinymce.isIE10)&&M(t[0]),e(t.reverse(),(function(t){!function(t){var n,r;e(t.cells,(function(e){var t=a(e,"rowSpan");t>1&&(w(e,"rowSpan",t-1),T((n=H(e)).x,n.y,1,1))})),n=H(t.cells[0]),e(c[n.y],(function(e){var t,n=e.elm;n!=r&&((t=a(n,"rowSpan"))<=1?p.remove(n):w(n,"rowSpan",t-1),r=n)}))}(t)})),S(),O()},cutRows:function(){var e=x();return(r.tinymce.isIE9||r.tinymce.isIE10)&&M(e[0]),p.remove(e),S(),O(),e},copyRows:function(){var t=x();return e(t,(function(e,n){t[n]=v(e,!0)})),t},pasteRows:function(t,n){var r=x(),o=r[n?0:r.length-1],i=o.cells.length;e(c,(function(t){var n;if(i=0,e(t,(function(e){e.real&&(i+=e.colspan),e.elm.parentNode==o&&(n=1)})),n)return!1})),e(t,(function(e){var t,r=e.cells.length;for(l()(e.cells[0]).hasClass("numberingColumn")&&(e.removeChild(e.cells[0]),r--),m=0;m<r;m++)w(t=e.cells[m],"colSpan",1),w(t,"rowSpan",1);for(D()&&(e.insertBefore(e.firstChild.cloneNode(!1),e.firstChild),l()(e.firstChild).addClass("numberingColumn"),r++);i<r;)R(!1),i++;for(m=r;m<i;m++)e.appendChild(k(e.cells[r-1]));n?o.parentNode.insertBefore(e,o):p.insertAfter(e,o)})),O()},getPos:H,setStartCell:function(e){u=H(e)},setEndCell:function(e){var t,n,r,i,a,f,d,m,p;if(s=H(e),u&&s){t=Math.min(u.x,s.x),n=Math.min(u.y,s.y),a=r=Math.max(u.x,s.x),f=i=Math.max(u.y,s.y);for(var g=n;g<=f;g++)(p=c[g][t]).real||t-(p.colspan-1)<t&&(t-=p.colspan-1);for(var h=t;h<=a;h++)(p=c[n][h]).real||n-(p.rowspan-1)<n&&(n-=p.rowspan-1);for(var v=n;v<=i;v++)for(var b=t;b<=r;b++)(p=c[v][b]).real&&((d=p.colspan-1)&&b+d>a&&(a=b+d),(m=p.rowspan-1)&&v+m>f&&(f=v+m));l()("td[data-mce-selected],th[data-mce-selected]",o.getBody()).removeAttr("data-mce-selected");for(var y=n;y<=f;y++)for(var w=t;w<=a;w++)c[y][w]&&c[y][w].elm.setAttribute("data-mce-selected","1")}},moveCaretToNextCell:function(){var e=F();e||(_(!1),b(),e=F()),L(e)},moveCaretToPrevCell:function(){var e=j();e||(_(!0),b(),u=H(p.getParent(i.getStart(),"th,td")),e=j()),L(e,!1)},cutColumns:function(){var e=B();return P(),e},copyColumns:B,pasteColumns:function(e,t){var n=Object.keys(e);t||n.reverse(),l.a.each(n,(function(n,r){var o=R(t);for(n=0;n<o.length;n++)o[n].innerHTML=e[r][n]||""}))},prepareTableForColPasteAndCheckIfNeedToRepaint:function(t){var n,r,o=t[Object.keys(t)[0]].length,i=!1;if(e(c,(function(t,i){o--,n=i,e(t,(function(e,t){r=t}))})),o>0)for(i=!0,d=y(r,n),m=0;m<o;m++)_(!1);return i},toggleFluidColumnWidth:function(){t&&t.rows&&(l()(t).toggleFluidColumnWidth(),l()("#table-mode-picker .dropdown-text").text(o.translate("table.responsive")))},toggleFixedColumnWidth:function(){t&&t.rows&&(l()(t).toggleFixedColumnWidth(),l()("#table-mode-picker .dropdown-text").text(o.translate("table.fixed_width")))}})}return{init:function(t){var u=!0;function s(e){var n=t.selection;e=e||n.getNode().parentNode;var r=t.dom.getParent(e,"table.confluenceTable");if(r)return new c(r,t,n)}function f(){t.getBody().style.webkitUserSelect="",u&&(l()("td[data-mce-selected],th[data-mce-selected]",t.getBody()).removeAttr("data-mce-selected"),u=!1)}function d(e){for(var n,r=[],o=0;o<e.length;o++)r.push(t.serializer.serialize(e[o],{}));n="<tr>".concat(r.join("</tr><tr>"),"</tr>"),i.setItem("copied",n,7200)}function m(){var e,n=l()(""),r=i.getItem("copied")||"";return r&&((e=t.getDoc().createElement("div")).innerHTML="<table>".concat(r,"</table>"),n=l()(e).find("tr")),n}function p(e){i.setItem("copiedCols",JSON.stringify(e))}function g(){return JSON.parse(i.getItem("copiedCols"))||{}}t.on("PreProcess",(function(e){var n,r,o,i=t.dom,a=i.select("table",e.node);for(n=a.length;n--;)r=a[n],i.setAttrib(r,"data-mce-style",""),(o=i.getAttrib(r,"width"))&&(i.setStyle(r,"width",o),i.setAttrib(r,"width","")),(o=i.getAttrib(r,"height"))&&(i.setStyle(r,"height",o),i.setAttrib(r,"height",""))})),t.on("init",(function(){t.on("Undo",(function(){u=t.dom.select("td[data-mce-selected], th[data-mce-selected]").length>0})),t.on("KeyUp",(function(){f()})),r.tinymce.isWebKit&&t.on("KeyDown",(function(n){var o=r.tinymce.util.VK,i=n.keyCode;function c(e,n,o){var i=e?"previousSibling":"nextSibling",a=t.dom.getParent(n,"tr"),f=a[i];if(f)return s(t,n,f,e),r.tinymce.dom.Event.cancel(o),!0;var d=t.dom.getParent(a,"table"),m=a.parentNode,p=m.nodeName.toLowerCase();if("tbody"===p||p===(e?"tfoot":"thead")){var g=function(e,n,r,o){var i=t.dom.select(">".concat(o),n),a=i.indexOf(r);if(e&&0===a||!e&&a===i.length-1)return function(e,n){var r=e?"thead":"tfoot",o=t.dom.select(">".concat(r),n);return 0!==o.length?o[0]:null}(e,n);if(-1===a){var c="thead"===r.tagName.toLowerCase()?0:i.length-1;return i[c]}return i[a+(e?-1:1)]}(e,d,m,"tbody");if(null!==g)return function(e,n,o,i){var a=u(n,e);return a&&s(t,o,a,e),r.tinymce.dom.Event.cancel(i),!0}(e,g,n,o)}return function(e,n,o,i,a){var s=i[o];if(s)return l(s),!0;var f=t.dom.getParent(i,"td,th");return f?c(e,f,a):(l(u(n,!e)),r.tinymce.dom.Event.cancel(a))}(e,a,i,d,o)}function u(e,n){var r=e&&e[n?"lastChild":"firstChild"];return r&&"BR"===r.nodeName?t.dom.getParent(r,"td,th"):r}function l(e){t.selection.setCursorLocation(e,0)}function s(t,n,r,o){var i=function(t,n){var r=0,o=0;return e(t.children,(function(e,t){if(r+=a(e,"colspan"),o=t,r>n)return!1})),o}(r,function(e){for(var t=0,n=e;n.previousSibling;)t+=a(n=n.previousSibling,"colspan");return t}(t.dom.getParent(n,"td,th"))),c=r.childNodes[i];l(u(c,o)||c)}function f(e){var n,r,o=t.selection.getNode(),i=t.dom.getParent(o,"td,th"),a=t.dom.getParent(e,"td,th");return i&&i!==a&&(n=i,r=a,t.dom.getParent(n,"TABLE")===t.dom.getParent(r,"TABLE"))}if((i==o.UP||i==o.DOWN)&&function(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}(t)){var d=t.selection.getNode();setTimeout((function(){f(d)&&c(!n.shiftKey&&i===o.UP,d,n)}),0)}}))})),t.on("copy",(function(){!0===t.selection.isCollapsed()&&t.getBody().querySelectorAll("th[data-mce-selected],td[data-mce-selected]").length>1&&t.selection.select(t.selection.getNode())}),!0),e({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){t.dom.select("td[data-mce-selected],th[data-mce-selected]").length&&e.merge()},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertNumberingCol:function(e){e.insertNumCol()},mceTableUpdateNumberingCol:function(e){e.updateNumCol()},mceAutoWidth:function(e){e.toggleFluidColumnWidth()},mceFixedWidth:function(e){e.toggleFixedColumnWidth()},mceTableInsertColBefore:function(e){n=null,e.insertCol(!0)},mceTableInsertColAfter:function(e){n=null,e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){d(e.cutRows())},mceTableCopyRow:function(e){d(e.copyRows())},mceTablePasteRowBefore:function(e){e.pasteRows(m(),!0)},mceTablePasteRowAfter:function(e){e.pasteRows(m())},mceTableDelete:function(e){e.deleteTable()},mceTableMoveCaretToNextCell:function(e){e.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(e){e.moveCaretToPrevCell()},mceTableCopyCol:function(e){p(e.copyColumns())},mceTableCutCol:function(e){p(e.cutColumns())},mceTablePasteColBefore:function(e){var n=g();e.prepareTableForColPasteAndCheckIfNeedToRepaint(n)&&(t.execCommand("mceRepaint"),e=s()),e.pasteColumns(n,!0)},mceTablePasteColAfter:function(e){e.pasteColumns(g(),!1)}},(function(e,n){t.addCommand(n,(function(){var n=s();return n&&(e(n),t.execCommand("mceRepaint"),f()),!1}))})),rt(t),xt(t),Xe(t),ze()?l()(o.a).one("rte-collab-ready",(function(){St(t)})):l()(o.a).one("rte-ready",(function(){St(t)}))}}};n("./src/editor-plugins/iosediting/iosediting.css");var Et=function(e){return e.replace(/[&"'<>`]/g,(function(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"}))};function _t(e,t,n){"cl.ly"==e.host?l.a.get("".concat(ye,"/rest/autoconvert/1.0/cloudappembed?resource=").concat(e.path.substr(1)),(function(e){if(e)switch(e.item_type){case"image":var r=Et(e.content_url);n(l()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(r,'" data-image-src="').concat(r,'"/>'))[0]);break;case"bookmark":t.text(e.name),t.attr("href",Et(e.redirect_url)),n(t)}else n()})):n()}function At(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?"".concat(e,"#").concat(t.anchor.substring(t.anchor.indexOf("-")+1)):e},n=function(n,i,a){if(o(n)){var c=function(e){return ye?e.path.substring(ye.length+1):e.path.substring(1)}(n),u=decodeURIComponent(c).split("/"),s="";n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(s="$".concat(n.queryKey.focusedCommentId),s=t(s,n)):n.queryKey.pageId?(s="$".concat(n.queryKey.pageId),s=t(s,n)):"display"===u[0]?s=function(e,n,r){return 2===r.length&&0===r[1].indexOf("~")?n=r[1]:3===r.length?(n="".concat(r[1],":").concat(r[2].replace(/\+/g," ")),n=t(n,e)):4===r.length&&"status"===r[1]?n="$".concat(r[3]):6===r.length&&(n="".concat(r[1],":")+"/".concat(r[2],"/").concat(r[3],"/").concat(r[4],"/").concat(r[5].replace(/\+/g," ")),n=t(n,e)),n}(n,s,u):"spaces"===u[0]?s=(s=(s=e.spaViewPageLinkHandler(u))||e.spaBlogPostLinkHandler(u))?t(s,n):function(e,n,r){return 2!==r.length&&3!==r.length||-1!==r[1].indexOf(".action")||(n="".concat(r[1],":")+"",n=t(n,e)),n}(n,s,u):"users"===u[0]?s=function(e,t,n){return 2===n.length&&"viewuserprofile.action"==n[1]?t="~".concat(e.queryKey.username):2===n.length&&"viewmyprofile.action"==n[1]&&(t="~".concat(U.get("remote-user"))),t}(n,s,u):"pages"===u[0]&&"viewpage.action"===u[1]&&n.queryKey&&n.queryKey.spaceKey&&n.queryKey.title&&(s="".concat(n.queryKey.spaceKey,":").concat(n.queryKey.title.replace(/\+/g," "))),s?(s="[".concat(s,"]"),r.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(s,(function(e){a(l()(e).children()[0])}),(function(){a()}))):a()}else a()},o=function(e){var t=!0;return t=t&&e.authority===r.document.location.host,t=t&&(!ye||0===e.path.indexOf(ye)),t};this.init=function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}At.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$".concat(n)},At.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],r=e[3],o=e[4],i=e[5],a=e[6],c=e[7];if(t&&n&&r&&o&&i&&a&&c)return"".concat(n,":/").concat(r,"/").concat(o,"/").concat(i,"/").concat(c.replace(/\+/g," "))};function Nt(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var r=decodeURIComponent(e.queryKey.url);(t=l()(t)).attr("href",r),t.attr("data-mce-href",r),t.text(r),n(t)}else n()}))}var Rt=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):"".concat(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"(.*)")};r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,r){if(t.source===n.text()){for(var o=0;o<e.length;o++){var i=e[o],a=t.source.match(i.regex);if(a){var c=a[1];if(i.defaultAlias){var u=i.defaultAlias.replace(/%s/,c);return void r(l()(n).text(u))}return void r(l()(n).text(c))}}r()}else r()})),setTimeout((function(){l.a.ajax({url:"".concat(ye,"/rest/autoconvert/latest/shortcutlinkconfigurations"),type:"GET",dataType:"json",success:function(n){e=n.configurations;for(var r=0;r<e.length;r++){var o=e[r];try{o.regex=new RegExp(t(o.expandedValue))}catch(e){console.log("Failed to generated regex for ".concat(o))}}},error:function(e){console.log("Failed to load shortcut link configurations ".concat(e.statusText))}})}),0)},Ot=function(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?l.a.get("".concat(ye,"/rest/autoconvert/1.0/skitchembed?url=").concat(e.source),(function(e){e&&e.url?n(l()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(e.url,'" data-image-src="').concat(e.url,'"/>'))[0]):n()})):n()};function Dt(){var e=[/youtube-nocookie.com\/embed\/?/,/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){for(var i=decodeURI(t.source),a=0;a<e.length;a++)if(i.match(e[a])){var c={name:"widget",params:{url:i}};return void r.tinymce.plugins.Autoconvert.convertMacroToDom(c,o,o)}o()}))}function It(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(".*youtu.be.*")){var r=e.path.substr(1),o="http://youtube.com/watch?v=".concat(r);n(l()(t).attr("href",o).text(o))}else n()}))}var Pt={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,t){var n=null;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=o.url;if("/"!==o.url[o.url.length-1]&&(i+="/"),0===e.indexOf(i)){n=o;break}}return n},pasteHandler:function(e,t,n){var o=y.a.Editor.JiraConnector.servers;if(!o)return n(),null;var i=y.a.Editor.JiraAnalytics,a={},c=Pt._getMatchedServerFromLink(e.source,o),u=null;if(c){var l="",s=Pt.jqlRegEx.exec(e.source)||Pt.jqlRegExAlternateFormat.exec(e.source),f=y.a.JQLHelper.isFilterUrl(e.source),d=Pt.issueKeyOnlyRegEx.exec(e.source)||Pt.issueKeyWithinRegex.exec(e.source);if(d?(l=d[2],i&&(a.type=i.linkTypes.jql)):(d=Pt.singleTicketXMLEx.exec(e.source))&&(l=d[1],i&&(a.type=i.linkTypes.xml)),s)a.is_single_issue=!1,a.type=y.a.JQLHelper.checkQueryType(e.source),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:decodeURIComponent(s[1].replace(/\+/g,"%20"))}};else if(f){var m=e.source;a.is_single_issue=!1,a.type=y.a.JQLHelper.checkQueryType(m),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:y.a.JQLHelper.getFilterFromFilterUrl(m)}}}else l&&(a.is_single_issue=!0,u={name:"jira",params:{server:c.name,serverId:c.id,key:l}})}u?(r.tinymce.plugins.Autoconvert.convertMacroToDom(u,n,n),i&&i.triggerPasteEvent(a)):n()}};var Bt=/^\/(.*?)\/status\/([^/]+\/?$)/,Mt=/^\/(.*?)\/statuses\/([^/]+\/?$)/,Lt=function(e,t,n){var o,i,a;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(Bt))?i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/status/").concat(o[2]):(o=decodeURI(e.path).match(Mt))&&(i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/statuses/").concat(o[2])),i?(a={name:"widget",params:{url:i}},r.tinymce.plugins.Autoconvert.convertMacroToDom(a,n,n)):n()):n()};function Ft(){s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(_t)})),s("init.rte",(new At).init),s("init.rte",Nt),s("init.rte",Rt),s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Ot)})),s("init.rte",Dt),s("init.rte",It),s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Pt.pasteHandler)})),s("init.rte",(function(){return r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Lt)}))}var jt={initializeEditor:function(){r.AJS&&r.AJS.Rte&&r.AJS.Rte.BootstrapManager&&r.AJS.Rte.BootstrapManager.addOnInitCallback((function(){var e=r.tinymce.activeEditor;e&&(window.MutationObserver&&!(r.tinymce.Env.gecko||r.tinymce.Env.webkit||r.tinymce.Env.ie>11)?function(e){new MutationObserver((function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.addedNodes.length)for(var r=0;r<n.addedNodes.length;r++){if("img"===n.addedNodes[r].localName)return void window.setTimeout(jt.pasteFromDataURL,0)}}})).observe(e.getDoc(),{childList:!0,subtree:!0})}(e):function(e){e.on("Paste",(function(e){return!!jt.onPaste(e)||(r.tinymce.dom.Event.cancel(e),!1)}))}(e))}))},pasteFromDataURL:function(){var e=l()('img[src^="data:image"]:not(".editor-inline-macro")',r.tinymce.activeEditor.getDoc());l.a.each(e,(function(){var e,t,n,o=this.src;if(E("filestore.direct.upload")&&!E("filestore.direct.upload.force.disable")){var i=o.split(","),a=atob(i[1]),c=a.length;for(t=a.length,e=new Uint8Array(c);c--;)e[c]=a.charCodeAt(c)}else{n="base64",t=3*(e=o.substring(22,o.length)).length/4;for(var u=0,l=e.length-1;"="==e[l];l--)u++;t-=u}r.Confluence.Uploader.upload([jt.createUploadFile(e,t,n)])})),e.remove()},onPaste:function(e){return!e||!e.clipboardData||jt.pasteFromEvent(e)},showClipboardAccessError:function(){var e=r.tinymce.activeEditor;new r.AJS.Dialog({width:400,closeOnOutsideClick:!0}).addPanel("alert",l()("<div />",{text:e.translate("clipboardaccess.browser.not.supported")})).addButton(e.translate("clipboardaccess.ok"),(function(e){e.remove()})).show().updateHeight()},pasteFromEvent:function(e){if(e&&e.clipboardData){if(e.clipboardData.items){var t=e.clipboardData.items[0];if(!t||"file"!=t.kind)return!0;var n=t.getAsFile(),o=jt.createUploadFile(n,n.size);return r.Confluence.Uploader.upload([o]),!1}window.setTimeout((function(e){var t=l()("img[src^='webkit-fake-url://']",r.tinymce.activeEditor.getDoc());t.length&&(t.remove(),e.showClipboardAccessError())}),0,this)}return!0},createUploadFile:function(e,t,n){var r=new Date,o=r.getMonth()+1;return{fileName:"image".concat(r.getFullYear(),"-").concat(o,"-").concat(r.getDate(),"_").concat(r.getHours(),"-").concat(r.getMinutes(),"-").concat(r.getSeconds(),".png"),fileSize:t,slice:function(t,n){return e.slice(t,t+n)},getAsBinary:function(){return e},getData:function(){return e},encoding:n}}};n("./src/editor-plugins/draggable/draggable.css");var Ht=function(){var e,t,n,o,i,a,c,u,s,f,m,p,g,h=r.Confluence.PropertyPanel,v=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];var b="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img";function y(t){var r=!!o.children(".contentLayout,.contentLayout2").length;function i(){return n.find("#move-indicator")}function a(e){return"move-indicator"===e.attr("id")}function c(e){return r?e.is("div.innerCell,div.cell"):e.is("body")}function u(e,t,r){return e.is("img")?function(e,t){var r=e.offset();return t+n.scrollLeft()-r.left}(e,t)<e.width()/2:s(e,r)<e.height()/2}function s(e,t){var r=e.offset();return t+n.scrollTop()-r.top}return{positionNear:function(e,r){var f=function(e,r){var f=l()(n[0].elementFromPoint(e,r)),d=!0;if(function(e){if(e.is(b)&&!a(e))return(!e.is("td.wysiwyg-macro-body")||"PLAIN_TEXT"!==e.closest("table").attr("data-macro-body-type"))&&!(e.is("img")&&!t.is("img"));return!1}(f))return{target:f,before:u(f,e,r)};if(c(f)){if(function(e,t){return s(e.children().first(),t)<0}(f=function(e){if(e.is("div.cell"))return e.children("div.innerCell").first();return e}(f),r))f=f.children().first();else if(function(e,t){return function(e,t){var n=s(e,t),r=e.height();return n-r}(e.children().last(),t)>0}(f,r))f=f.children().last(),d=!1;else{if(m=f,i().length>0&&i().parent(m).length>0)return null;f=function(e){var n=t.parent(b);n.length||(n=e.find(b).last());n.length||(n=o.find(b).last());return n}(f),d=!1}return{target:f,before:d}}var m;return null}(e,r);f&&function(e,t){if(a(e))return;var n=i();if(e.is("li,td,th")&&e.find(n).length)return;n.length?n.detach():n=l()('<span id="move-indicator">|</span>');!(e=function(e){if(e.is("li,td,th")){var t=e.children().first();t.is("p,h1,h2,h3,h4,h5,h6,blockquote")&&(e=t)}return e}(e)).is("img")&&me().Cursor.isTextContainerEmpty(e[0])?e.prepend(n):e.is("li,td,th")?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n)}(f.target,f.before)},replaceWith:function(t){var n=i();n.length?(t.is("img")&&c(n.parent())&&(t=l()("<p></p>").append(t)),n.replaceWith(t),e.dom.isBlock(t[0])&&t.parent().is("p")&&t.unwrap(),me().showElement(t),e.selection.select(t[0]),e.selection.collapse(!0)):e.undoManager.undo(),me().Cursor.fixCursorTargets(e.getBody())},destroy:function(){var t=i();t.length&&(t.remove(),me().Cursor.fixCursorTargets(e.getBody()))}}}function w(t){if(1===t.which&&t.target===t.currentTarget)if(s)S(t);else{s=l()(t.target),e.selection.select(t.target),t.preventDefault(),n.bind({"mousemove.moveable-zone":k,"mouseup.moveable-zone":S,"keydown.moveable-zone":C,"mouseover.moveable-zone":x});var r,o=s.offset();c=t.pageX,u=t.pageY,i=o.top-u,a=o.left-c,m=!0,f=(r=s).attr("style")||"",s=r}}function C(t){27===t.keyCode&&(p.cancelScrolling(),n.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(s[0]),e.selection.collapse(!1),s=null)}function x(){n.find(".mceSelected").removeClass("mceSelected")}function k(n){if(m){if(function(e){var t=Math.abs(c-e.pageX),n=Math.abs(u-e.pageY);return t<10&&n<10}(n))return;ke(),e.undoManager.beforeChange(),e.undoManager.typing=!0,e.undoManager.add(),d("synchrony.stop",{id:"confluence.draggable-plugin"}),(r=e.selection.getSel())&&r.removeAllRanges&&r.removeAllRanges(),s.css({position:"absolute",width:s.css("width"),"max-width":"50%"}),h.current&&h.destroy(),s.detach(),me().Cursor.fixCursorTargets(e.getBody()),o.append(s),g=y(s),m=!1}var r;n.preventDefault(),s.hide(),function(e,n){var r=v.length;if((n=Math.max(n,0))<r)return void p.scrollUp(v[n]);var o=t.height(),i=Math.max(0,o-n);if(i<r)return void p.scrollDown(v[i]);p.cancelScrolling()}(n.clientX,n.clientY),g.positionNear(n.clientX,n.clientY);var l=Math.min(n.pageY+i,p.scrollHeight()-s.outerHeight()),f=n.pageX+a;s.css({top:l,left:f,opacity:.5}),s.show()}function S(t){n.unbind(".moveable-zone"),p.cancelScrolling(),m?s=null:(t.preventDefault(),s.detach(),s.attr("style",f),g.replaceWith(s),g.destroy(),s=null,g=null,x(),e.undoManager.add(),d("synchrony.start",{id:"confluence.draggable-plugin"}))}return{init:function(i){e=i,i.on("Init",(function(){var e,a,c;t=l()(i.getWin()),n=l()(i.getDoc()),o=l()(i.getBody()),e=r.tinymce.Env.webkit?o:n.find("html"),a=e,c=0,p={scrollUp:function(e){if(c!==-e){c=-e;var t=a.scrollTop()/e*1e3;a.stop(!1,!1),a.animate({scrollTop:0},{duration:t})}},scrollDown:function(e){if(c!==e){var t=a[0].scrollHeight,n=(t-a.scrollTop())/e*1e3;a.stop(!1,!1),a.animate({scrollTop:t},{duration:n})}},cancelScrolling:function(){a.stop(!0,!1)},scrollHeight:function(){return a[0].scrollHeight}},n.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",{mousedown:w})}))},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}};n("./src/editor-plugins/insert-files/insert-files.css");var Ut=function e(t,n){var i;if(!U.get("remote-user")||!U.get("confluence.prefs.editor.disable.autoformat")){E.prototype={registerHandler:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers:function(e,t,n,r){var o=!0;return l.a.each(this.handlers[e]||[],(function(e,i){if(i.handles(t))return o=i.execute(t,n,r),!1})),o}};var a,c=n.editor,u=new E,s=[new _(")",e.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile.svg"),new _("(",e.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.svg"),new _("P",e.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.svg"),new _("p",e.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.svg"),new _("D",e.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.CROSS,"cross","emotions_dlg.error","error.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on","emotions_dlg.lightbulb_on","lightbulb_on.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.svg"),new _("3",e.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.svg"),new _("3",e.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.svg")],f=[];for(a=0;a<s.length;a++)f[a]=new o.a.Image,f[a].src=s[a].imagePath;for(l.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough","`":"monospace"},(function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));u.registerHandler(e.charCodeAt(0),S(n,(function(e){A(t,e[2])}),!0))})),c.formatter.register("code",{inline:"code"}),u.registerHandler("}".charCodeAt(0),S(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,(function(e){A("code",e[2])}),!0)),a=1;a<=6;a++)!function(e){u.registerHandler(" ".charCodeAt(0),S(new RegExp("^\\u200b?(h".concat(e,"\\.)$")),(function(){c.execCommand("formatBlock",!1,"h".concat(e),{skip_undo:!0})}),!0))}(a);u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(bq\.)$/,(function(){c.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})}),!0));var m=S(/^\u200b?(\-\-\-\-)$/,(function(){c.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})}),!0);u.registerHandler(" ".charCodeAt(0),m),u.registerHandler(13,m),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\#)$/,(function(){c.execCommand("InsertOrderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\*)$/,(function(){c.execCommand("InsertUnorderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(1\.)$/,(function(){c.execCommand("InsertOrderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\-)$/,(function(){var e=c.dom;c.execCommand("InsertUnorderedList");var t=e.getParent(c.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))}),!0)),d("confluence.editor.registerHandlers",{handlerManager:u,createHandler:S,ed:c});var p=S(/((\<\-\-?\>)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),p),u.registerHandler(13,p);var g=S(/((\-\-?\>)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),g),u.registerHandler(13,g);var h=S(/((\<\-\-?)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,""+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),h),u.registerHandler(13,h),u.registerHandler(" ".charCodeAt(0),S(/[^-]*[\s](\-\-\-?)$/,(function(e){var t=2===e[1].length?"":"";c.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1));var v=S(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,(function(e){var t=2===e[3].length?"":"";c.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),v),u.registerHandler(13,v),u.registerHandler(13,S(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n="",r=!0,o=l()(e[1].slice(2,-2).split("||")).map((function(e){return e=l.a.trim(this),r=r&&""===e,e}));r&&(o[0]=ge("editor.autoformat.sampletext.firstcell"));for(var i=0,a=o.length;i<a;i++)t+='<th class="confluenceTh">'.concat(o[i],"</th>"),n+='<td class="confluenceTd">'.concat(me().ZERO_WIDTH_WHITESPACE,"</td>");t+="</tr><tr>".concat(n,"</tr></table>"),c.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),c.selection.select(l()(c.selection.getRng().commonAncestorContainer).parents("table").find(r?"th":"td")[0].childNodes[0]),l()(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0)),u.registerHandler(13,S(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n=!0,r=l()(e[1].slice(1,-1).split("|")).map((function(e){return e=l.a.trim(this),n=n&&""==e,e}));n&&(r[0]=ge("editor.autoformat.sampletext.firstcell"));for(var o=0,i=r.length;o<i;o++)t+='<td class="confluenceTd">'.concat(r[o],"</td>");t+="</tr></table>",c.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&c.selection.select(l()(c.selection.getRng().commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),l()(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0));var b=S(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,(function(e){var t=e[3]?e[1]:"http://".concat(e[1]),n=c.dom.create("a",{href:t});n.appendChild(r.document.createTextNode(e[1])),c.execCommand("mceInsertContent",!1,x(n),{skip_undo:!0}),c.getDoc().execCommand("unlink",!1,{})}),!1,"a");u.registerHandler(" ".charCodeAt(0),b),u.registerHandler(13,b);var y=S(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,(function(e){var t=c.dom.create("a",{href:"mailto:".concat(e[1])});t.appendChild(r.document.createTextNode(e[1])),c.execCommand("mceInsertContent",!1,x(t),{skip_undo:!0}),c.getDoc().execCommand("unlink",!1,{})}),!1,"a");u.registerHandler(" ".charCodeAt(0),y),u.registerHandler(13,y);var w=function(e,t){var n=S(e,(function(){c.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),n),u.registerHandler(13,n)};w(/(?:\b|^)(jira)$/,"Jira"),w(/(?:\b|^)(bitbucket)$/,"Bitbucket"),w(/(?:\b|^)(atlassian)$/,"Atlassian"),w(/(?:\b|^)(hipchat)$/,"Hipchat"),w(/(?:\b|^)(statuspage)$/,"Statuspage"),w(/(?:\b|^)(sourcetree)$/,"Sourcetree"),w(/(?:\b|^)(trello)$/,"Trello");var C={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};l.a.each(C,(function(e,t){u.registerHandler(e.charCodeAt(0),S(t,(function(t){var n=t[1]+e,o={type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(U.get("context-path"),"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify({wiki:n,entityId:U.get("content-id"),spaceKey:U.get("space-key"),contextType:U.get("content-type"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?r.tinymce.confluence.MacroUtils.insertMacro(o):"!"==e?l.a.ajax(o).done((function(e){!n===e?r.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})):l.a.ajax(o).done((function(e){c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}))}),!0))})),u.registerHandler("`".charCodeAt(0),S(/(``)$/,(function(e){var t={contentId:U.get("content-id"),macro:{name:"code",body:""}};r.tinymce.confluence.MacroUtils.insertMacro(t)}),!0)),c.on("KeyPress",(function(e){return u.executeHandlers(T(e),c,e,t)})),c.on("KeyDown",(function(e){if(13===T(e))return u.executeHandlers(13,c,e,t)}),!0);return{getHandlerCount:function(){return Object.keys(u.handlers).length}}}function x(e){return l()("<div>").append(e.cloneNode(!0)).html()}function k(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var r=t.nodeValue.substring(0,n),o=t.previousSibling;o&&3===o.nodeType;o=o.previousSibling)r=o.nodeValue+r;return r}function S(e,t,n,o){return{handles:function(t){var n=t.selection.getRng();if(!n||!n.collapsed)return!1;var r=n.commonAncestorContainer||{};return!l()(r).closest("pre,.text-placeholder").length&&((!o||!l()(r).closest(o).length)&&e.test(k(n)))},execute:function(o,a,c){var u,s=1,f=T(a);if(32===f?o.execCommand("mceInsertContent",!1,"&nbsp;"):o.execCommand("mceInsertContent",!1,String.fromCharCode(f)),o.undoManager.transact((function(){var n=o.selection.getRng();if(n){"|"==(u=k(n))[u.length-1]&&(u+=" ",s=0);var r=e.exec(u.substring(0,u.length-1)),a=function(e,t,n){var r,o;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var i=t,a=n;i&&3===i.nodeType;i=i.previousSibling){if(-1==a&&(a=i.nodeValue.length),a>e)return{container:i,offset:a-e};if(a==e){for(o=0,r=i.parentNode;i=i.previousSibling;)o++;return{container:r,offset:o}}e-=a,a=-1}return null}}(r[1].length+s,n.commonAncestorContainer,n.startOffset);n.setStart(a.container,a.offset);var c=l()(n.commonAncestorContainer);o.selection.setRng(n),c.closest(".wysiwyg-macro-body").length&&n.toString()==c.text()?(c[0].innerHTML="<br>",o.selection.select(c[0].childNodes[0]),o.selection.collapse(!0)):o.execCommand("delete",!1,{},{skip_undo:!0}),t(r,o.selection.getRng()),i=o.selection.getRng()}})),n)return c.preventDefault(),c.stopPropagation(),r.tinymce.dom.Event.cancel(a),i&&me().showElement(i.startContainer),!1}}}function T(e){return e.which}function E(){this.handlers={}}function _(e,t,n,r,o){var i=e.charCodeAt(0),a="".concat(me().getResourceUrlPrefix(),"/images/icons/emoticons/").concat(o),l=S(t,(function(){var e=c.dom.createHTML("img",{src:a,alt:c.translate("tinymce.".concat(r)),title:c.translate("tinymce.".concat(r)),border:0,class:"emoticon emoticon-".concat(n),"data-emoticon-name":n});c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}),!0);this.imagePath=a,u.registerHandler(i,l)}function A(e,t){var n=c.formatter.get(e)[0],o=c.dom.create(n.inline,{style:n.styles,class:n.classes});o.appendChild(r.document.createTextNode(t)),c.execCommand("mceInsertContent",!1,"".concat(x(o),"&nbsp;"),{skip_undo:!0})}},zt=(Ut.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}},0),Wt={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:o.a.document,objHead:"head",objWindow:o.a,scrollableArea:o.a,cacheHeaderHeight:!1};function qt(e,t){var n=this;n.$el=l()(e),n.el=e,n.id=zt++,n.$el.bind("destroyed",l.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each((function(){var e=l()(this);e.css("padding",0),n.$originalHeader=l()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.".concat("stickyTableHeaders"),[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=l()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)})),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),l.a.removeData(n.el,"plugin_".concat("stickyTableHeaders")),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.on("resize.".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.toggleHeaders),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}},n.toggleHeaders=n.debounce((function(){n.$el&&n.$el.each((function(){var e,t=l()(this),r=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),o=t.offset(),i=n.$scrollableArea.scrollTop()+r,a=n.$scrollableArea.scrollLeft(),c=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),u=n.isWindowScrolling?i>o.top:r>o.top,s=(n.isWindowScrolling?i:0)<o.top+t.height()-c-(n.isWindowScrolling?0:r);u&&s?(e=o.left-a+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=r,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.".concat("stickyTableHeaders"))),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(l()("td,th",n.$clonedHeader),l()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.".concat("stickyTableHeaders")))}))}),0),n.setPositionValues=n.debounce((function(){var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})}),0),n.updateWidth=n.debounce((function(){if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=l()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=l()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}}),0),n.getWidth=function(e){var t=[];return e.each((function(e){var r,i=l()(this);if("border-box"===i.css("box-sizing")){var a=i[0].getBoundingClientRect();r=a.width?a.width:a.right-a.left}else{if("collapse"===l()("th",n.$originalHeader).css("border-collapse"))if(o.a.getComputedStyle)r=parseFloat(o.a.getComputedStyle(this,null).width);else{var c=parseFloat(i.css("padding-left")),u=parseFloat(i.css("padding-right")),s=parseFloat(i.css("border-width"));r=i.outerWidth()-c-u-s}else r=i.width()}t[e]=r})),t},n.setWidth=function(e,t,n){t.each((function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})}))},n.resetWidth=function(e,t){e.each((function(e){var n=l()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},n.setOptions=function(e){n.options=l.a.extend({},Wt,e),n.$window=l()(n.options.objWindow),n.$head=l()(n.options.objHead),n.$document=l()(n.options.objDocument),n.$scrollableArea=l()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}l.a.fn.stickyTableHeaders=function(e){return this.each((function(){var t=l.a.data(this,"plugin_".concat("stickyTableHeaders"));t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&l.a.data(this,"plugin_".concat("stickyTableHeaders"),new qt(this,e))}))};var Vt=function(e){return!(e.parents("table").length>0)},$t=function(e){return!(e.closest(".columnLayout").length>0)},Kt=function(){return!l()("body").hasClass("theme-documentation")},Jt=function(e){var t=l()(e);return Kt()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&$t(t)&&Vt(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},Gt=function(e,t){var n=t||l()(window);e.closest(".table-wrap").scroll((function(){n.trigger("scroll.stickyTableHeaders")}))},Xt=function(e){l()(e).each((function(){var e=l()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),r=n.length&&n.closest("thead").length>0,o=n.length&&0===n.parent().index();if(Vt(e)&&$t(e)&&!r&&o&&!t){var i=l()("<thead />").append(n.parent());e.prepend(i)}}))},Yt=Kt,Qt=function(e,t){var n=e.filter((function(){return Jt(this)}));n.stickyTableHeaders(t).addClass("stickyTableHeaders"),s("sticky-table-headers.change.options",(function(e,t){n.stickyTableHeaders(t)})),Gt(n)},Zt=function(){var e=l()(".confluenceTable"),t=l()(window);if(Yt()){if(Xt(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var r=/sticky|tableFloating|confluenceTh/;new MutationObserver(l.a.debounce((function(e){for(var n,o=!1,i=0,a=e.length;i<a;i++)if(n=e[i].target.className,!r.test(n)){o=!0;break}o&&t.trigger("resize.stickyTableHeaders")}),0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}Qt(e,{cacheHeaderHeight:!0})}},en=function(e,t){var n=r.tinymce.activeEditor;if(n){var o=function(e){var t={};return t.objWindow=l()(e.getWin()),t.scrollableArea=t.objWindow,t.objDocument=l()(e.getDoc()),t.objHead=t.objDocument.find("head"),t}(n),i=l.a.extend({},o,t),a=e.filter((function(){return Jt(this)}));a.stickyTableHeaders(i).addClass("stickyTableHeaders"),Gt(a,i.objWindow)}},tn=function(){var e=r.tinymce.activeEditor;if(e){var t=l()(e.getBody()).find(".confluenceTable");Xt(t),en(t)}};var nn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){f("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var rn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){f("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var on=function(){return{init:function(e){var t,n=r.Confluence.Editor.Drafts,i=r.Confluence.Editor;function a(){var e,t,n;e=U.get("draft-id"),t=U.get("draft-share-id"),0!==parseInt(e)&&o.a.history&&o.a.history.replaceState&&o.a.history.replaceState(null,"","".concat(ye,"/pages/resumedraft.action?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(void 0===(n=o.a.location.search)?"":("?"===n.charAt(0)&&(n=n.substr(1)),n.split("&").filter((function(e){return 0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("src.")})).join("&")))),i.UI.cancelButton.attr("data-tooltip",ge("editor.shared.draft.done.desc")),i.UI.cancelButton.on("click",(function(){d("analytics",{name:"confluence.editor.done.button.clicked"}),d("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:U.get("content-id"),currentVersion:U.get("page-version")||"null"}})}))}function c(){if(!U.get("has-collaborated")&&r.AJS.Rte.Content.editorHasContentChanged()){U.set("has-collaborated",!0);var e=U.get("remote-user-key"),t=U.get("content-id");l.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/collaborator/toContent/").concat(t,"?targetStatus=draft"),error:function(){U.set("has-collaborated",!1)}}),l.a.ajax({type:"DELETE",url:"".concat(ye,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(t,"?targetStatus=current")}),l.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/touched/toContent/").concat(t,"?targetStatus=draft"),error:function(){U.set("has-collaborated",!1)}})}}var u=function(e){return l()("#draft-status").show(),n.bindUnloadMessage(),i.UI.cancelButton.click((function(){U.getBoolean("shared-drafts")||n.save({skipErrorHandler:!0})})),U.getBoolean("shared-drafts")&&a(),o.a.setInterval(n.save,+U.get("draft-save-interval")||3e4)};e.on("Init",(function(){s("editor.local.change",c)})),e.on("Remove",(function(){f("editor.local.change",c)})),s("rte-ready",(function(){t=u()})),s("rte-destroyed",(function(){clearInterval(t)}))},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};var an={init:function(e){e.on("Init",(function(){e.addCommand("mceConfMacroBrowser",r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)}))},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},cn={init:function(e){e.on("init",(function(){if(U.get("use-watch")){var e={userWatchingOwnContent:U.get("user-watching-own-content")};l()("#rte-savebar-tinymce-plugin-point").append((t=function(e){return ge(e)},'\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" '.concat(e.userWatchingOwnContent?'checked="checked"':"",'/>\n            <label for="watchPage">').concat(t("comment.notification.enable"),"</label>\n        </li>\n    </ul>\n")))}var t}))},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},un={init:function(e){var t=function(e){l()(".tablesorter",e.node).each((function(e,t){var n,r,o=l()(t).find("thead");1===o.length&&"THEAD"===(o=o[0]).nodeName&&1===o.childNodes.length&&(r=o.removeChild(o.childNodes[0]),n=l()(t).find("tbody")[0],t.removeChild(o),n.insertBefore(r,n.childNodes[0]))}))};e.on("PastePostProcess",t),e.on("remove",(function(){e.off("PastePostProcess",t)}))},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}},ln={init:function(e){e.on("Init",(function(){e.getBody().classList.add("resizable")}));var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height","".concat(e.getElement().offsetHeight))),o=parseInt(e.getParam("autoresize_max_height","0"));e.on("Change SetContent Paste KeyUp Init",i),e.addCommand("mceAutoResize",i)}function i(a){var c=e.getDoc(),u=c.body,s=c.documentElement,f=r.tinymce.DOM,d=n,m=a===Object(a)&&a.forceExec||!1,p=l()(c).height();if(p>n&&(d=p),o&&p>o?(d=o,u.style.overflowY="auto",s.style.overflowY="auto"):(u.style.overflowY="hidden",s.style.overflowY="hidden",u.scrollTop=0),m||d!==t){var g=d-t;f.setStyle(document.querySelectorAll("div.tox-tinymce")[0],"height","".concat(d,"px")),f.setStyle(f.get("".concat(e.id,"_ifr")),"height","".concat(d,"px")),t=d,r.tinymce.Env.webkit&&g<0&&i()}return!0}},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},sn=function(){function e(e){return e.nodeValue.toLowerCase()}return{search:function(t,n,r,o,i){var a=t.getSel(),c=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var r=t.childNodes,o=0,i=r.length;o<i;++o)n.push.apply(n,e(r[o]));return n}(o);n=n.replace(/\s/g,"").toLowerCase();var u=c.map(e).join("");r=function(e,t,n){var r=e.getRng();if(r&&r.endContainer.nodeValue){var o=n.indexOf(r.endContainer.nodeValue.toLowerCase(),t)+r.endOffset;t=t!==o&&-1!==t?o:t}return t}(t,r,u);var l,s,f,d,m,p=(l=u,s=n,f=r,(m=(d=i)?l.lastIndexOf(s,f-1):l.indexOf(s,f))<0&&!d?m=l.indexOf(s):0===m&&0===f&&d&&(m=l.lastIndexOf(s)),m);if(p<0)return[!1,p];var g=function(e,t,n){for(var r,o,i,a,c=0,u=0;u<t.length;u++){if(t[u].nodeType===Node.TEXT_NODE){var l=e+n.length;!o&&t[u].length+c>=l&&(o=t[u],a=l-c),!r&&t[u].length+c>e&&(r=t[u],i=e-c),c+=t[u].length}if(r&&o)return{startNode:r,startIndex:i,endNode:o,endIndex:a}}}(p,c,n),h=document.createRange();return h.setStart(g.startNode,g.startIndex),h.setEnd(g.endNode,g.endIndex),a&&a.removeAllRanges(),a&&a.addRange(h),h.startContainer.parentNode&&h.startContainer.parentNode.scrollIntoView(),[!0,p]}}},fn=function(){var e=sn(),t=r.tinymce.Env.browser.isEdge,n=function e(t){var n=t,r=null,o=null,i=null,a=null,c=null,u={initialised:!1,find:function(e,t,n){var o=r.getFindInput().val(),a=i.findText(o,!0,e);a&&t?t():!a&&n&&n()},replace:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceText(n.val(),a,!0);c&&e?e():!c&&t&&t()},replaceAll:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceAll(n.val(),a);c&&e?e():!c&&t&&t()},focus:function(){r.focusFindTextBox()},isVisible:function(){return null!=r},init:function(){r=e.UI(n,a,c),(o=new e.MarkManager).addListener(r),i=null,i=new e.impl(r,o),r.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=r.getFindInput(),n=t.val();t.val(n+e)}r.onVisible()},onHide:function(){a=r.getFindInput().val(),c=r.getReplaceInput().val(),i.destroy(),i=null,r.destroy(),r=null,o.destroy(),o=null},_clearSavedValues:function(){a=null,c=null}};return u};return n.utils={moveCursorToEnd:function(e){if(r.tinymce.Env.gecko){var t=l()(e).val().length;e.setSelectionRange(t,t)}},createTextRange:function(e,t){return e.selection?e.selection.createRange():t.getBody().createTextRange()}},n.impl=function(n,o){var i=new r.tinymce.html.Writer,a=o,c=-1,u=function n(o,i,u){if(!o)return!1;var l=r.tinymce.activeEditor,s=l.selection,f=l.getWin();function d(){return l.undoManager.ignore((function(){a.markCurrentlySelectedRange()})),!0}function m(){return l.undoManager.ignore((function(){a.removeCurrentMark(!0),r.tinymce.activeEditor.selection.isCollapsed()||r.tinymce.activeEditor.selection.collapse()})),!1}if(a.isCursorAtCurrentMark()&&l.undoManager.ignore((function(){s=a.selectCurrentMark()})),s.isCollapsed()||s.collapse(u),r.tinymce.Env.gecko)return f.find(o,!1,u)?d():i?(s.select(l.getBody(),!1),s.collapse(!u),n(o,!1,u)):m();if(!t())return f.find(o,!1,u,!0,!1,!1,!1)?d():m();var p=e.search(s,o,c,l.getBody(),u);return c=p[1],p[0]?d():void 0},l=function(e){var t=r.tinymce.activeEditor;i.text(e,!1),t.selection.setContent(i.getContent(),{format:"raw"}),i.reset(),t.selection.collapse(!0)},s={};return s.findText=u,s.replaceText=function(e,t,n){var o=r.tinymce.activeEditor;return a.hasCurrentMark()?(o.undoManager.transact((function(){var e=a.replaceCurrentMark(t);e&&o.selection.select(e)})),u(e,n)):u(e,n)},s.replaceAll=function(n,o){var i=r.tinymce.activeEditor,c=0;return i.undoManager.transact((function(){var u=i.selection,s=i.getWin();if(a.removeCurrentMark(!1),i.execCommand("selectAll"),i.selection.collapse(!0),t())for(var f=-1;;){var d=e.search(u,n,f,i.getBody(),!1);if(!d[0])break;f=d[1],l(o),c++}else for(;s.find(n,!1,!1,!1,!1,!1,!1);)l(o),c++;if(0===c)r.Confluence.EditorNotification.notify("info",i.translate("searchreplace_dlg.notfound"));else if(1===c)r.Confluence.EditorNotification.notify("success",i.translate("searchreplace_dlg.allreplacedsingular"));else if(c>1){var m=i.translate("searchreplace_dlg.allreplacedplural");r.Confluence.EditorNotification.notify("success",m.replace("{0}",c))}})),c},s.destroy=function(){a=null,i=null},s},n.UI=function(e,t,o){var i=null,a=n.utils.moveCursorToEnd;r.tinymce.activeEditor&&r.tinymce.activeEditor.plugins&&r.tinymce.activeEditor.plugins.customtoolbar&&(i=r.tinymce.activeEditor.plugins.customtoolbar.getToolbarRow(e));var c=function(){return l()(".toolbar-find-input",i)},u=function(){return l()(".toolbar-replace-input",i)},s=function(e){if("input"===e.type||"propertychange"===e.type){var t=c(),n="string"==typeof t.val()&&t.val().length>0;d(n),m(n)}},f=function(){var e=c();h(e&&e.val())},d=function(e){e?(r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},m=function(e){var t=c();p().toggleClass("default-action",e&&t.val().length>0)},p=function(){return l()(".search-toolbar-find-next-button",i).closest(".aui-button")},g=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},h=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},v={};return v.getFindInput=c,v.getReplaceInput=u,v.focusFindTextBox=function(){top.focus(),c().focus()},v.onVisible=function(){var e=c();e.focus(),e.val().length>0&&(a(e[0]),d(!0),h(!0))},v.destroy=function(){},v.marked=function(){g(!0)},v.markRemoved=function(){g(!1)},function(e,t){var n=c(),r=!1;(e&&e.length&&(n.val(e),r=!0),t&&t.length)&&u().val(t);!function(){function e(e,t){e&&e.bind("input",t)}var t=c();e(t,s),e(t,f),l()(i).focusin((function(){m(!0)})).focusout((function(){m(!1)})),t.focus((function(){m(!0)}))}(),d(r),h(r),g(!1)}(t,o),v},n.MarkManager=function(){var e=null,t=new r.tinymce.html.Writer,n=null,o=[],i=function(){u()},a=function(){if(!e)return null;var t=r.tinymce.activeEditor;return t.selection.select(e[0]),t.selection},c=function(t){g(),(s(e,t)||n&&r.tinymce.activeEditor.selection.getRng().toString()==n)&&(e=null,n=null,l.a.each(o,(function(e,t){t.markRemoved()})))},u=function(){g(),l()("mark",r.tinymce.activeEditor.getDoc()).each((function(e,t){s(l()(t),!1)})),e=null,n=null,l.a.each(o,(function(e,t){t.markRemoved()}))},s=function(e,t){var n=r.tinymce.activeEditor.selection.getRng();if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=r.tinymce.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),i=null,a=null;if(e.contents().each((function(t,n){e.before(n),i||(i=n),a=n})),o||t){var c=r.tinymce.activeEditor.selection.getRng();c.setStartBefore(i),c.setEndAfter(a),t||c.collapse(!1),r.tinymce.activeEditor.selection.setRng(c)}return e.remove(),!0},f=function(){return!!e||(n?r.tinymce.activeEditor.selection.getRng().toString()==n:void 0)},d=function(){u()},m=function(){g(),l.a.each(o,(function(e,t){t.markRemoved()}))},p=function(e){var t=r.tinymce.activeEditor;t.on("Change",i),t.on("BeforeSetContent",i),e&&(t.on("Click",m),t.on("DblClick",m))},g=function(){var e=r.tinymce.activeEditor;e.off("Change",i),e.off("BeforeSetContent",i),e.off("Click",m),e.off("DblClick",m)},h={markCurrentlySelectedRange:function(){var t=r.tinymce.activeEditor;if(e){var i=t.selection.getBookmark();c(!1),t.selection.moveToBookmark(i)}n=null;var u=t.selection.getRng();if(e=l()('<mark data-searching class="find-current"></mark>',t.getDoc()),u)try{u.surroundContents(e[0]),p(!1)}catch(t){1==t.code&&(n=u.toString(),e=null,p(!0))}if(l.a.each(o,(function(e,t){t.marked()})),!n){var s=a();s&&s.collapse()}}};return h.removeCurrentMark=c,h.removeAllMarks=u,h.selectCurrentMark=a,h.isCursorAtCurrentMark=function(){if(!e)return!1;var t=r.tinymce.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng();if(n){if(3===n.startContainer.nodeType)return n.startContainer.parentNode&&n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,i=n.startOffset;return i>0&&o[i-1]===e[0]||i+1<o.length&&o[i+1]===e[0]}}},h.hasCurrentMark=f,h.replaceCurrentMark=function(n){if(function(n){if(e||!f())return!1;var o=r.tinymce.activeEditor;return o.undoManager.transact((function(){t.text(n,!1),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()})),o.undoManager.ignore((function(){c(!1)})),!0}(n))return null;if(!e)return null;var o=r.tinymce.activeEditor,i=[];o.undoManager.ignore((function(){e.contents().each((function(e,t){i.push(t)})),c(!1)}));var a=void 0;return o.undoManager.transact((function(){a=l()(i[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=i.length-1;e>=0;e--)l()(i[e]).remove()})),a},h.addListener=function(e){o.push(e)},h.destroy=function(){c(!0),r.tinymce.activeEditor.off("BeforeGetContent",d)},r.tinymce.activeEditor.on("BeforeGetContent",d),h},n},dn=function(){ee(r.document,"initContextToolbars.Toolbar",(function(e,t){var n;r.Confluence.Editor.searchToolbar=(n=r.Confluence.Editor,{initContextToolbars:function(e,t){var o=function(e){if(r.tinymce.Env.gecko){var t=l()(e).val().length;e.setSelectionRange(t,t)}},i=function(e){top.focus(),r.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},a=function(){top.focus();var e=l()("#search-toolbar-find-text");e.focus(),o(e[0])},c=function(){top.focus();var e=l()("#search-toolbar-replace-text");e.focus(),o(e[0])},u=function(){if(r.tinymce.Env.gecko){var e=r.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},s=new n.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:t.translate("searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:a,onNotFound:a};r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})}))}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-find-input"}),f=new n.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:t.translate("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:c,onNotFound:a},{skip_undo:!0})}));g(c,a,t)}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-replace-input"}),d=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findprevious"),click:function(){var e={backwards:!0,onFound:function(){top.focus(),i("search-toolbar-find-previous-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-previous-button"}),m=new n.Toolbar.Components.TextButton({text:r.tinymce.Env.ie?t.translate("searchreplace_dlg.findlabel"):t.translate("searchreplace_dlg.findnext"),click:function(){var e={backwards:!1,onFound:function(){top.focus(),i("search-toolbar-find-next-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-next-button"}),p=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replace"),click:function(){g((function(){top.focus(),i("search-toolbar-replace-button")}),a)},textClass:"search-toolbar-replace-button"}),g=function(e,t,n){r.Confluence.Editor.searchManager&&(r.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?r.Confluence.Editor.searchManager.replace(e,t):n&&n())},h=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replaceall"),click:function(){var e={onReplaced:u,onNotReplaced:a};t.undoManager.transact((function(){t.execCommand("mceConfReplaceAll",!1,e)}))},textClass:"search-toolbar-replaceall-button"}),v=new n.Toolbar.Components.Button({text:t.translate("searchreplace_dlg.close"),iconClass:"icon aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){t.undoManager.ignore((function(){t.execCommand("mceConfSearchClose",!1,null)}))}});return{Buttons:[new n.Toolbar.Components.Group([v],{groupClass:"close"}),new n.Toolbar.Components.Group([s,f],{groupClass:"no-separator"}),new n.Toolbar.Components.Group(r.tinymce.Env.ie?[m]:[d,m]),new n.Toolbar.Components.Group([p,h])]}}}).initContextToolbars(e,t)}))};function mn(){var e=r.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},i=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},a=function(e){var t=l()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},c=function(){if(!n){n=!0;var c=l()("#rte-button-searchreplace"),u=!c.hasClass("active"),s=l()("body"),f=!s.hasClass("no-tools")||s.hasClass("no-tools-toolbars-visible");u?(c.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),l()(r.document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:f,onVisible:function(){var c=function(){var e=r.tinymce.activeEditor;e.off("KeyDown",i),e.off("KeyPress",o),e.off("KeyUp",o);for(var n,a="",c=0;c<t.length;c++)a+=(n=t[c])>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):String.fromCharCode(n);return a.toLowerCase()}();e.searchManager.onVisible(c),a(!0),n=!1,e.searchManager.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),function(){var e=r.tinymce.activeEditor;t=[],e.on("KeyDown",i),e.on("KeyPress",o),e.on("KeyUp",o)}(),e.searchManager.init(),a(!1)):(c.removeClass("active"),e.searchManager.onHide(),l()(r.document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:f,onHide:function(){l()(r.document).trigger("contextToolbarRowRemoved.Toolbar"),a(!0),n=!1,e.searchManager.initialised=!1}}),a(!1),r.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),r.tinymce.activeEditor.focus())}};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",(function(){return t.undoManager.ignore((function(){c()})),!1})),t.addCommand("mceConfSearch",(function(n,r){return!!e.searchManager&&((r=r||{}).backwards&&!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?(e.searchManager.focus(),!1):r.backwards||t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?(e.searchManager.find(r.backwards,r.onFound,r.onNotFound),!1):(e.searchManager.focus(),!1))})),t.addCommand("mceConfReplaceAll",(function(n,r){return!!e.searchManager&&(r=r||{},!!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&(e.searchManager.replaceAll(r.onReplaced,r.onNotReplaced),!1))})),t.addCommand("mceConfSearchClose",(function(){return!!e.searchManager&&(t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,null)})),!1)})),t.ui.registry.addButton("searchreplace",{text:"searchreplace.search_desc",onAction:function(){t.execCommand("mceSearchReplaceToolbar")}}),8!=r.tinymce.Env.ie&&t.shortcuts.add("meta+f","searchreplace.search_desc",(function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))}))},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gn="object"===("undefined"==typeof window?"undefined":pn(window))?window.localStorage:{},hn=function(e,t){var n=U.get("remote-user")||"",r="".concat(e,".").concat(n,".").concat(t),o=!1,i=/\d+#/,a=function(e){if(!o)return null;var t,n=gn.getItem("".concat(r,".").concat(e));return n&&(t=i.exec(n))&&(n=n.replace(t[0],""),+new Date>Number(t[0].replace("#","")))?(gn.removeItem("".concat(r,".").concat(e)),null):n};try{o=Object.keys(gn).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:a,getAllItems:function(){if(!o)return null;var e={};for(var t in gn)if(gn.hasOwnProperty(t)&&t.indexOf("".concat(r,"."))>-1){var n=t.split("".concat(r,"."))[1];e[n]=a(n)}return e},doesContain:function(e){return!!a(e)},getItemAsBoolean:function(e){var t=a(e);return"false"!==t&&("true"===t||!!t)},setItem:function(e,t,n){var i;o&&(t=((i=1e3*(n||0))?+new Date+i+"#":"")+t,gn.setItem("".concat(r,".").concat(e),t))},setItemQuietly:function(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log("Unable to write to localStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}},removeItem:function(e){o&&gn.removeItem("".concat(r,".").concat(e))}}}("confluence","userSettings");function vn(e,t){return t?"".concat(e,".").concat(t.replace(/\./g,"-")):e}var bn,yn={get:function(e,t,n){var r=vn(e,t),o=hn.getItem(r);return null!==o?JSON.parse(o):void 0!==n?n:null},set:function(e,t,n,r){var o=vn(e,t);if(r===n)hn.removeItem(o);else{hn.setItem(o,JSON.stringify(r),2592e3)}}},wn={init:function(e){e.on("init",(function(){var e={contentId:U.get("content-id")},t=l()("#rte-savebar-tinymce-plugin-point");t.append('\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>'.concat(function(e){return ge(e)}("editor.minor.edit"),"</span>\n        </label>\n    </span>\n"));var n=t[0].querySelector('input[id="notifyWatchers"]'),r=yn.get("notifyWatchers",e.contentId,!0);null!==r&&(n.checked=r),ee(n,"change",(function(){yn.set("notifyWatchers",e.contentId,!0,n.checked)}))}))},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function Cn(e,t){var n=l.a.parseHTML(e),r=[Node.ELEMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE],o=!1;return n.forEach((function(e){(bn.dom.is(e,t)||r.includes(e.nodeType)&&e.querySelector(t))&&(o=!0)})),o}function xn(){d("analytics",{name:"confluence.table.image.insert",data:{pageId:U.get("page-id"),tableMode:Sn()}})}function kn(){return!!l()(bn.selection.getNode()).closest("table.confluenceTable").length}function Sn(){var e=l()(bn.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function Tn(){var e=l()(bn.getBody()).find("table.confluenceTable");d("analytics",{name:"confluence.table.quality.in.page",data:{pageId:U.get("page-id"),total:e.length,fixed:e.filter(".fixed-table").length,fluid:e.filter(":not(.fixed-table,.relative-table)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var En={init:function(e){function t(e,t){kn()&&function(e){var t,n;e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&d("analytics",{name:"confluence.table.img.resize",data:{pageId:U.get("page-id"),tableMode:Sn(),isImgBiggerCell:(t=l()(bn.selection.getNode()),n=t.closest("th, td"),t.width()>n.width())}})}(t)}bn=e,e.on("ExecCommand",(function(e){switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":d("analytics",{name:"confluence.table.mode.to.".concat(Sn()),data:{pageId:U.get("page-id")}});break;case"mceTableCopyRow":d("analytics",{name:"confluence.table.row.copy",data:{pageId:U.get("page-id")}});break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":d("analytics",{name:"confluence.table.row.paste",data:{pageId:U.get("page-id")}});break;case"mceTableCopyCol":d("analytics",{name:"confluence.table.col.copy",data:{pageId:U.get("page-id")}});break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":d("analytics",{name:"confluence.table.col.paste",data:{pageId:U.get("page-id")}});break;case"mceInsertContent":Cn(t=e.value,"img")&&kn()&&xn(),Cn(t,"table.confluenceTable")&&d("analytics",{name:"confluence.table.paste",data:{pageId:U.get("page-id")}});break;case"confTableSelectionToggleHighlight":d("analytics",{name:"confluence.editor.table.selection.toggle.highlight",data:{color:l()("#table-highlight-group").attr("data-highlight-colour")}})}var t})),e.on("Init",(function(){e.on("SetContent",(function(e){kn()&&e&&function(e){Cn(e.content,".confluence-embedded-image")&&xn()}(e)}))})),s("analyticsEvent",t),s("rte.safe-save.success",Tn),e.on("Remove",(function(){f("analyticsEvent",t),f("rte.safe-save.success",Tn)}))},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function _n(e,t,n){n&&n.node&&l()(".inline-comment-marker",n.node).contents().unwrap()}var An={init:function(e){e.on("beforeExecCommand",(function(t){if("Indent"===t.command||"Outdent"===t.command){var n=e.selection.getNode(),r=n.nodeName.toLowerCase();if("li"!==r&&"body"!==r){var o=parseInt(e.dom.getStyle(n,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(n,"padding-left",!1)||0,10);if(0!==o){var i=e.settings.indentation,a=/[a-z%]+/i.exec(i);e.dom.setStyle(n,"padding-left",""),e.dom.setStyle(n,"margin-left",o+a[0])}}}}))},getInfo:function(){return{longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Nn=function(e){if(!e)return null;var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Rn=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,r=n.childNodes.length,o=n.childNodes[r-1],i=o.length,a=e.dom.createRng();a.setStart(o,i),a.setEnd(o,i),e.selection.setRng(a)}},On={init:function(e){e.on("KeyDown",(function(t){r.tinymce.VK.modifierPressed(t)||32!==t.keyCode||function(e){var t=e.selection.getNode(),n=l()(t).closest("a"),r=e.selection.getRng();n.length&&r&&x.isCursorAtEnd(e,r)&&(r.setStartAfter(n[0]),r.setEndAfter(n[0]),e.selection.setRng(r),e.selection.collapse())}(e),r.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=Nn(e.selection.getRng());t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore((function(){Rn(e,t),t.parentNode&&t.parentNode.removeChild(t)}))}}(e)}))}};function Dn(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bn=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Pn(this,"_namespace",void 0),Pn(this,"_sessionStorageSupported",void 0);var o=U.get("remote-user")||"";this._namespace="".concat(t,".").concat(o,".").concat(n),this._sessionStorageSupported=!!r.sessionStorage}var t,n,o;return t=e,(n=[{key:"getItem",value:function(e){return this._sessionStorageSupported?r.sessionStorage.getItem("".concat(this._namespace,".").concat(e)):null}},{key:"doesContain",value:function(e){return!!this.getItem(e)}},{key:"setItem",value:function(e,t){if(this._sessionStorageSupported)try{r.sessionStorage.setItem("".concat(this._namespace,".").concat(e),t)}catch(n){console.error("Unable to write to sessionStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}}},{key:"removeItem",value:function(e){this._sessionStorageSupported&&r.sessionStorage.removeItem("".concat(this._namespace,".").concat(e))}}])&&In(t.prototype,n),o&&In(t,o),e}())("atlassian","frontend"),Mn=function(e){var t=[];return Array.from(e).forEach((function(e,n){(function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),i=o.top,a=o.bottom,c=n.offsetHeight;return 0<=i&&i<c||0<=a&&a<=c||i<=0&&0<=a&&a>=c}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})})),t},Ln=function(e){var t=Mn(e),n=null;return t.some((function(e){return!!function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,i=n.offsetHeight;return 0<=o&&o<i}}(e.visibleBlockEl)&&(n=e,!0)})),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}};function Fn(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if(function(e){if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")}(e)){var r=e.children[0].children,o=Ln(r),i=o.targetElementIndex,a=o.visibleBlockEl;if(a){var c=function(e){var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return Array.from(e).some((function(e,n){var r=Ln(e.children),o=r.visibleBlockEl,i=r.targetElementIndex;return!!o&&(t.columnIndex=n,t.targetElementIndexInColumn=i,t.visibleBlockEl=o,!0)})),t}(a.getElementsByClassName("innerCell")),u=c.columnIndex,l=c.targetElementIndexInColumn,s=c.visibleBlockEl;s&&(n.targetElementIndex=l,n.offsetBetweenTargetAndCurrentScroll=t-Dn(s),n.columnLayoutPosition={rowIndex:i,columnIndex:u})}}else{var f=Ln(e.children),d=f.targetElementIndex,m=f.visibleBlockEl;m&&(n.targetElementIndex=d,n.offsetBetweenTargetAndCurrentScroll=t-Dn(m),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}var jn={_saveScrollPosition:function(e){var t,n,i,a,c,u,l,s;e.getDoc()&&e.getWin()&&(t={contentId:Ae(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()},n=t.contentId,i=t.isInViewPage,a=t.docObject,c=void 0===a?r.document:a,u=t.winObject,l=void 0===u?o.a:u,(s=Fn(i?c.getElementById("main-content"):c.body,l.pageYOffset))&&(s.contentId=n,s.isInViewPage=i,Bn.setItem("editor-persit-scroll-position",JSON.stringify(s))))},_restoreScrollPositionIfNeeded:function(e){e.getDoc()&&e.getWin()&&function(e){var t=e.contentId,n=e.isInViewPage,i=e.docObject,a=void 0===i?r.document:i,c=e.winObject,u=void 0===c?o.a:c,l=Bn.getItem("editor-persit-scroll-position");try{l=JSON.parse(l)}catch(e){0}finally{Bn.removeItem("editor-persit-scroll-position")}if(l&&l.contentId===t&&l.isInViewPage!==n){var s;s=n?a.getElementById("main-content"):a.body;var f,d=l.columnLayoutPosition;if(d){var m=s.children[0].children[d.rowIndex].getElementsByClassName("innerCell")[d.columnIndex];f=m&&m.children[l.targetElementIndex]}else f=s.children[l.targetElementIndex];if(f){var p=Dn(f)+l.offsetBetweenTargetAndCurrentScroll;setTimeout((function(){return u.scrollTo(0,p)}),1)}}}({contentId:Ae(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:function(e){var t=U.get("content-type");"page"!==t&&"blogpost"!==t||(s("rte-collab-ready",(function(){jn._restoreScrollPositionIfNeeded(e)})),s("rte-ready",(function(){r.Confluence.Editor.UI.cancelButton.click((function(){return jn._saveScrollPosition(e)})),r.Confluence.Editor.UI.saveButton.click((function(){return jn._saveScrollPosition(e)}))})))},getInfo:function(){return{longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Hn={init:function(e){e.on("init",(function(){e.getBody().classList.add("template-editor")}))}};function Un(e){return e.parentNode&&e.parentNode.childNodes||[]}function zn(e){var t=Un(e);return function(e){var t=!0,n=/TABLE|TH|TD/;return t=(t=(t=!n.test(e.nodeName))&&e.previousSibling?!n.test(e.previousSibling.nodeName):t)&&e.nextSibling?!n.test(e.nextSibling.nodeName):t}(e)&&(function(e){var t=function(e){return e&&e.innerHTML&&(e.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}(e);return/^&nbsp;$/.test(t)}(e)||t.length>1&&"BR"==t[0].nodeName)}function Wn(e,t){e.dom.remove(t)}var qn={init:function(e){var t=e.getParam("atl_macro_class","wysiwyg-macro"),n=function(e){return 3===e.nodeType},o=function(t,n){return e.dom.getParent(t,n)},i=function(e){return n(e)?e.length:e.childNodes.length},a=function(e){return o(e,"table."+t)},c=function(e){return null!==a(e)},u=function(e,t){return e.bottom<=t.top&&e.top<t.bottom},l=function(e,t){return e.top>=t.bottom&&e.bottom>t.top},s=function(e,t){var n=e.childNodes;if(0===n.length)return{node:e,offset:t};if(t<n.length)return{node:n[t],offset:0};var r=n[n.length-1];return"img"===e.nodeName.toLowerCase()?{node:r,offset:1}:{node:r,offset:i(r)}},f=function(t){if(function(e){return 1===e.nodeType}(t))return r.tinymce.toArray(t.getClientRects());if(n(t)){var o=e.dom.createRng();return o.selectNode(t),r.tinymce.toArray(o.getClientRects())}return[]},d=function(t,o){return function(t,r){var o=e.selection.getRng();if(o){var i=s(1===t?o.startContainer:o.endContainer,1===t?o.startOffset:o.endOffset),a=i.node;if(n(a)&&i.offset>0){var c=a.splitText(i.offset),u=r(1===t?a:c);return 0===c.length&&e.dom.remove(c),u}return r(a)}}(o,(function(e){return function(e,t,n,o){var i,a=new r.tinymce.dom.TreeWalker(e,t),c=1===n?a.prev:a.next,s=1===n?u:l,d=e,m=0,p=[];do{var g=f(d).filter((function(e){return 0!==e.height&&0!==e.width}));if(0!==g.length&&(1===n&&g.reverse(),g.forEach((function(e){if(0!==e.height&&0!==e.width){i&&s(e,i)&&m++;var t=p[m];p[m]=t?t.concat([e]):[e],i=e}})),o(p)))return p}while(d=c());return p}(e,t,o,(function(e){return e.length>1})).length<=1}))},m=function(t,n){var r=e.selection.getRng();if(r){var o=1===n?r.startContainer:r.endContainer,a=1===n?r.startOffset:r.endOffset;return(1===n&&a<=0||-1===n&&a>=i(o))&&function(e,t,n){for(var r,o=s(n?t.startContainer:t.endContainer,n?t.startOffset:t.endOffset),a={node:e,offset:n?0:i(e)};!r||a.node!==r.node;){if(o.node===a.node&&o.offset===a.offset)return!0;r=a,a=s(a.node,a.offset)}return!1}(t,r,1===n)}};e.on("init",(function(){e.on("keydown",(function(t){var n,o,u=e.selection.getRng(),l=function(e){return(e.keyCode===r.tinymce.util.VK.LEFT||e.keyCode===r.tinymce.util.VK.RIGHT)&&e.shiftKey}(t),f=function(e){return(e.keyCode===r.tinymce.util.VK.UP||e.keyCode===r.tinymce.util.VK.DOWN)&&e.shiftKey}(t);if((l||f)&&u&&function(e){return c(e.startContainer)&&c(e.endContainer)}(u)){var p=(n=u.startContainer,o=a(n),e.dom.select("th,td",o)[0]),g=t.keyCode===r.tinymce.util.VK.UP||t.keyCode===r.tinymce.util.VK.LEFT?1:-1,h=f&&d(p,g),v=l&&m(p,g);(h||v)&&(!function(t,n){var r=e.selection.getRng();if(r){var o=r.cloneRange(),a=s(t,n?0:i(t));n?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),e.selection.setRng(o,!n)}}(p,1===g),t.preventDefault(),t.stopImmediatePropagation())}if(t.keyCode===r.tinymce.util.VK.ENTER||t.keyCode===r.tinymce.util.VK.BACKSPACE||t.keyCode===r.tinymce.util.VK.DELETE){if(!u||u.collapsed)return;e.getDoc().querySelectorAll("".concat("td.wysiwyg-macro-body","[data-mce-selected]")).forEach((function(e){e.removeAttribute("data-mce-selected")}))}}),!0),e.on("mouseup",(function(t){if(3===t.detail){var n=e.selection.getRng();if(n){var r=o(n.startContainer,"td.wysiwyg-macro-body"),i=o(n.endContainer,"td.wysiwyg-macro-body");if(r===i)return;if(null!==r&&!r.contains(n.endContainer)&&r.lastChild){var a=e.dom.createRng();a.setStart(n.startContainer,n.startOffset),a.setEndAfter(r.lastChild),e.selection.setRng(a,!0)}if(null!==i&&!i.contains(n.startContainer)&&i.firstChild){var c=e.dom.createRng();c.setStartBefore(i.firstChild),c.setEnd(n.endContainer,n.endOffset),e.selection.setRng(c,!0)}}}}))}))},getInfo:function(){return{longname:"Macro Navigation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Vn={offset:function(e){var t=l()(e).offset(),n=r.tinymce.activeEditor.iframeElement,o=l()(n).offset(),i=n.contentWindow.document,a=l()(r.tinymce.activeEditor.getBody()),c=l.a.support.boxModel&&i.documentElement.scrollTop||a.scrollTop(),u=l.a.support.boxModel&&i.documentElement.scrollLeft||a.scrollLeft();return{top:t.top-c+o.top,left:t.left-u+o.left}},getSelectedText:function(){var e=r.tinymce.activeEditor.selection;return e.getRng().text||e.getSel()&&e.getSel().toString&&e.getSel().toString()||""},setHtml:function(e){e&&r.tinymce.activeEditor.setContent(e)},getHtml:function(){return"".concat(r.tinymce.activeEditor.getContent())},isEmpty:function(){var e=r.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===e.trim()||0===e.length},editorHasContentChanged:function(){return r.tinymce.activeEditor.isDirty()},editorResetContentChanged:function(){r.tinymce.activeEditor.setDirty(!1)},getChildIndex:function(e,t){for(var n=e.childNodes,r=0,o=n.length;r<o;r++)if(n[r]==t)return r;return-1}},$n=function(){void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Content&&(r.AJS.Rte.Content=Vn)};function Kn(){r.tinymce.activeEditor.getBody().style.height="auto"}var Jn=function(){s("init.rte",(function(){var e;r.Confluence.EditorNotification={notify:function(t,n,r){var o=a("aui/flag");void 0!==e&&"true"!==e.getAttribute("aria-hidden")&&e.close(),void 0===r&&(r="error"===t?"manual":"auto"),e=o({type:t,body:n,close:r})}}}))},Gn=n("./node_modules/@atlassian/aui-template/src/template.js"),Xn=n.n(Gn);function Yn(){return{component:function(e){var t,n=function(e){0};return e=e||{},e=l.a.extend({},{keypressListener:function(r){if(27===r.keyCode)n(),l()(".aui-dropdown",t.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():t.hide());else if(13===r.keyCode){if(n(),!l()(".aui-dropdown",t.popup.element).is(":visible"))"textarea"!=(r.target.nodeName&&r.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit)}},width:865,height:530},e),t=new y.a.Dialog(e),r.document.addEventListener("hideLayer",(function(n,r,o){"popup"==r&&o==t&&"function"==typeof e.onCancel&&e.onCancel()})),t},initialiser:function(e){var t=this;s("show.dialog",(function(e,t){var n,r=U.get("page-id"),o=U.get("space-key"),i=U.get("editor-mode"),a=U.get("new-page");y.a.EventQueue=y.a.EventQueue||[],y.a.EventQueue.push({name:t.dialog.id,properties:(n={},r&&(n.pageid=r),o&&(n.spacekey=o),i&&(n.editormode=i),a&&(n.newpage=a),n)})})),r.document.addEventListener("showLayer",(function(t,n,o){r.Confluence.runBinderComponents(),"popup"==n&&o&&function(t){var n,o=e(t);if(!o.attr("data-lasttab-override")){o.attr("data-tab-default")&&(n=o.attr("data-tab-default"));var i=r.Confluence.storageManager(o.attr("id")),a=i.getItem("last-tab"),c=null!=a?a:n;c&&e(".page-menu-item:visible:eq(".concat(c,") button"),o).click(),o.attr("data-lasttab-bound")||(e(".page-menu-item",o).each((function(t,n){e(n).click((function(){i.setItem("last-tab",t)}))})),o.attr("data-lasttab-bound","true"))}}(o.element)})),y.a.Dialog.prototype.overrideLastTab=function(){e(t.popup.element).attr("data-lasttab-override","true")},y.a.Dialog.prototype.addHelpText=function(n,r){if(n){var o=n;r&&(o=Xn()(n).fill(r).toString());var i=t.page[t.curpage];i.buttonpanel||i.addButtonPanel();var a=e("<div class='dialog-tip'></div>").html(o);i.buttonpanel.append(a),e("a",a).click((function(){var e=window.open(t.href,"_blank");return e&&e.focus(),e&&e.opener&&(e.opener=null),!1}))}},y.a.Dialog.prototype.getTitle=function(){return e("#".concat(t.id,".dialog-components:visible h2")).text()},y.a.Dialog.prototype.isVisible=function(){return e("#".concat(t.id)).is(":visible")}}}}var Qn=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,r=e.triggerText,o=e.iconClass,i=e.click,a=!!e.disabled,c=e.id;this.render=function(){var e=l()('<button type="button"></button>').addClass("aui-button aui-button-subtle").attr("data-tooltip",n||t);if(c&&e.attr("id",c),a&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||i()})),o){var u=l()("<span />");u.addClass("icon ".concat(o)),u.text(t),e.append(u)}if(r){var s=l()("<span />");s.addClass("trigger-text"),s.text(r),e.append(s)}return e[0]}},DropDownButton:function(e){var t,n=e.id,r=e.tooltip,o=e.text||"",i=e.iconClass,a=!!e.disabled,c=e.dropDownContent;this.render=function(){var e=l()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",r);e.attr("id",n);var u=l()("<div/>").addClass("aui-dd-parent"),s=l()("<a href='#'></a>");if(s.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),o&&s.append('<span class="dropdown-text">'.concat(o,"</span>")),a&&(e.addClass("disabled"),s.addClass("disabled")),i){var f=l()("<span />");f.addClass("icon ".concat(i)),f.text(o),s.append(f)}var d=l()("<span/>");return d.addClass("icon").addClass("icon-dropdown"),s.append(d),t=l()("<div/>").addClass("hidden").addClass("aui-dropdown"),c&&t.append(c),u.append(s),u.append(t),e.append(u),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,r=e.click,o=!!e.disabled,i=e.tooltip;this.render=function(){var e=l()('<button type="button"></button>').addClass("aui-button aui-button-subtle").addClass(n).text(t);return i&&e.attr("data-tooltip",i),o&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||r()})),e[0]}},TextBox:function(e){var t=e.id,n=e.text,r=e.name,o=e.keydown,i=e.cssClass;this.render=function(){var e=l()("<div></div>").addClass("toolbar-item");e.append(l()('<label for="'.concat(t,'">').concat(n,"</label>")));var a=l()('<input id="'.concat(t,'" type="text" name="').concat(r,'" class="').concat(i,' text" autocomplete="off">'));return a.keydown((function(e){o(e)})),e.append(a),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=l()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var r=0,o=n.length;r<o;r++)e.append(n[r].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,r=t&&t.dropDownOptions||{};this.render=function(){var e=l()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,i=n.length;o<i;o++)e.append(n[o].render());return e.append(function(){var e=r.id,t=r.disabled,n=r.dropDownContent,o=r.title,i=r.alignment,a=l()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&a.attr("id",e),o&&a.attr({"data-tooltip":o}),i&&a.data("dropdown-alignment",i);var c=l()("<div/>").addClass("aui-dd-parent"),u=l()("<a href='#'></a>");u.addClass("toolbar-trigger aui-dd-trigger aui-button"),t&&(a.addClass("disabled"),u.addClass("disabled"));var s=l()("<span/>");s.addClass("icon").addClass("icon-dropdown"),u.append(s);var f=l()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&f.append(n),c.append(u),c.append(f),a.append(c),a[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},o.a.Confluence.Editor.Toolbar={},o.a.Confluence.Editor.Toolbar.Components=e,e},Zn=function(){var e,t,n,o,i,a,c,u,s,f,d,m,p,g,h,v,b,y,w={},C=!1;var x=function(){c.css({top:l()("#insert-table-dropdown").outerHeight(!0)}),x=function(){}};function k(){var t;c.hasClass("hidden")||(t=l()(r.tinymce.activeEditor.getDoc()),e.unbind(".atlassian-table-picker"),t.unbind(".atlassian-table-picker"),c.addClass("hidden"),n.addClass("hidden"),a.removeClass("active"))}function S(e,t){e==v&&t==b||(e=Math.max(1,Math.min(15,e)),t=Math.max(1,Math.min(20,t)),g=Math.max(4,e),h=Math.max(4,t),v=e,b=t,u.width(25*g+1),u.height(17*h+20),E(s,g,h),E(d,v,b),E(f,g,1),E(m,v,1),T(),p.text("".concat(v," x ").concat(b)))}function T(){f.toggleClass("hidden",!y),m.toggleClass("hidden",!y)}function E(e,t,n){e.width(25*t+1),e.height(17*n+1)}function _(t){var n=s.offset(),r=n.top-e.scrollTop(),o=n.left-e.scrollLeft(),i=r+s.outerHeight(!0)+0,a=i-17-0,c=o+s.outerWidth(!0)+0,u=c-25-0,l=t.clientY,f=t.clientX,d=g,m=h;f>c?d+=~~((f-c)/25+1):f<u&&(d+=~~((f-u)/25-1)),l>i?m+=~~((l-i)/17+1):l<a&&(m+=~~((l-a)/17-1)),S(d,m)}function A(e){e!=y&&(y=e,T())}function N(e){var n=function(e){var t=1+~~(~~(e.offsetX||e.originalEvent.layerX)/25),n=1+~~(~~(e.offsetY||e.originalEvent.layerY)/17);return t<1||t>15||n<1||n>20?null:{width:t,height:n}}(e);e.preventDefault(),n&&(k(),function(e,n,o){var i,a;0;var c=l()("#tinymce-table-form");c.length?(c.find('input[name="rows"]').val(n),c.find('input[name="cols"]').val(e)):(i=r.AJS.renderTemplate("tableForm",n,e),(a=l()("<div></div>").addClass("hidden")).append(i),t.append(a));l()("#table-heading-checkbox").prop("checked",o),Se(),r.tinymce.activeEditor.undoManager.beforeChange();var u={cols:e,rows:n,heading:o};r.tinymce.activeEditor.execCommand("confInsertTable",!1,u),a&&a.remove()}(n.width,n.height,y))}function R(e){r.tinymce.Env.ie?(16===e.keyCode&&A(!e.shiftKey),27===e.keyCode&&k()):(0===e.charCode&&A(!e.shiftKey),27===e.keyCode&&0===e.charCode&&k())}function O(){k()}return w.insertTable=N,{bindToControl:function(){e=l()(r.document),t=e.find("body"),o=l()("#insert-table-dropdown"),i=l()("#rte-button-insert-table"),a=o.find(".aui-dd-parent"),c=l()("#table-picker-container"),u=c.find(".table-picker-box"),s=c.find(".picker-cell"),f=c.find(".picker-heading"),d=c.find(".picker-selected-cell"),m=c.find(".picker-selected-heading"),p=u.find(".desc"),n=l()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(o),i.click((function(t){var o;t.preventDefault(),C||(ke(),x(),y=!0,S(1,1),o=l()(r.tinymce.activeEditor.getDoc()),e.bind("mousemove.atlassian-table-picker",_),e.bind("keydown.atlassian-table-picker",R),e.bind("keyup.atlassian-table-picker",R),o.bind("keydown.atlassian-table-picker",R),o.bind("keyup.atlassian-table-picker",R),n.removeClass("hidden"),c.removeClass("hidden"),a.addClass("active"),i.focus())})),n.click(O),d.click(N),m.click(N)},disable:function(){C=!0,o.addClass("disabled")},enable:function(){C=!1,o.removeClass("disabled"),i.attr("data-tooltip",ge("tinymce.tablepicker.insert_table_title"))},close:k,_internal:w}};var er=[];function tr(){l()(".tipsy").remove()}function nr(){var e=/\+/g;setTimeout((function(){l()("#rte-savebar .aui-button[title]").each((function(){var t=l()(this),n=t.attr("title");if(t.removeAttr("title"),r.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)}))}),0)}function rr(e,t,n){if("dropdown"===t&&(l()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var r=n.trigger.data("tipsy");r&&(r.hoverState="out")}}function or(){var e;(e=l.a).fn.tipsy.autoBounds2=function(t,n){return function(){var r={},o=e(document).scrollTop()+t,i=e(document).scrollLeft()+t,a=e(this);return n.length>1?(r.ns=n[0],r.ew=n[1]):"e"==n[0]||"w"==n[0]?r.ew=n[0]:r.ns=n[0],a.offset().top<o&&(r.ns="n"),a.offset().left<i&&(r.ew="w"),e(window).width()+e(document).scrollLeft()-(a.offset().left+a.width())<t&&(r.ew="e"),e(window).height()+e(document).scrollTop()-(a.offset().top+a.height())<t&&(r.ns="s"),r.ns?r.ns+(r.ew?r.ew:""):r.ew}};var t={live:!0,gravity:"n",title:function(){return l()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},n=l.a.fn.tipsy.autoBounds2(50,"n"),o=l.a.fn.tipsy.autoBounds2(50,"w"),i=l.a.extend({},t,{gravity:n}),a=l.a.extend({},t,{gravity:o}),c=l.a.extend({},t,{gravity:"se"});l()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(i),l()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(a),l()("#rte-savebar [data-tooltip]").tooltip(c),l()("#editor-precursor [data-tooltip]").tooltip(i),l()("#property-panel [data-tooltip]").tooltip(i),ee(r.document,"showLayer",rr),ee(r.document,"hideLayer",rr),s("created.property-panel",tr),s("destroyed.property-panel",tr),s("register-contexts.keyboardshortcuts",nr)}function ir(){var e=r.Confluence.Editor,t=!1;function n(e){var t=function(){e&&e.hide()};ee(r.document,"showLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.on("Click",t),a.on("KeyUp",t)}})),ee(r.document,"hideLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.off("Click",t),a.off("KeyUp",t)}}))}function i(e){e.addCallback("show",(function(){e.$.parents(".disabled").length&&e.hide()}))}function a(e,n){if(!t){var r=p(n);l()("#".concat(r)).removeClass("disabled")}}function c(e,t){var n=p(t);l()("#".concat(n)).addClass("disabled")}function u(e,n){n?e.closest(".aui-button").prop("disabled",!0).attr("aria-disabled","true").toggleClass("disabled",n):t||e.closest(".aui-button").prop("disabled",!1).removeAttr("aria-disabled").toggleClass("disabled",n)}function s(e,n,r,o){var i=!!t||e,a=!!t||n,c=!!t||r,u=l()("#toolbar"),s=u.find(".toolbar-item"),f=l()("#insert-menu, #more-menu"),d=l()("#insert-menu, #color-picker-control"),m=l()("#format-dropdown"),p=o||function(){return!0};s.toggleClass("disabled",i),f.toggleClass("disabled",i),d.toggleClass("disabled",i),m.toggleClass("disabled",!!a),me().TablePicker[i?"disable":"enable"](),void 0!==c&&u.find("button, input").filter(p).toggleClass("disabled",c).prop("disabled",c)}var d,m=function(){return function(e){var t,n,r=e.element,o=(t=r,n=l()(t).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(e){return n.is(e)}),i=o("BLOCKQUOTE"),a=o("PRE"),c=o(".text-placeholder");if(a)s(!0,l()(r).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(c)s(!0);else if(i){s(!1),l()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass("disabled",!0)}else s(!1)}};function p(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function g(e){return l()("#".concat(e)).length>0}function h(e,t){var n=t.animate;null==n&&(n=!0);var i=function(){l()(this).remove(),ne(r.document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(d),d=o.a.setTimeout((function(){var e=p(t),r=l()("#".concat(e));n?r.slideUp(400,i):(r.hide(),i.call(r))}),100)}function v(e,n){if(!t){var i=p(n),a=n.animate;if(null==a&&(a=!0),g(i))l()("#".concat(i,":hidden")).slideDown(400,(function(){0}));else{var c=l()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");c.attr("id",i),n.editorAdjacent&&c.addClass("editor-adjacent");for(var u=n.topToolbar?l()("#rte-toolbar.aui-toolbar:visible"):l()("#savebar-container .aui-toolbar:visible"),s=0,f=n.buttons.length;s<f;s++){var m=n.buttons[s];c.append(m.render())}if(c.css({display:"none"}),n.editorAdjacent)u.append(c);else{var h=l()(".editor-adjacent",u).filter(":first");h.length?h.before(c):u.append(c)}c.find(".toolbar-dropdown").each((function(){b(this)}));var v=function(){ne(r.document,"resize.resizeplugin"),ne(r.document,"shown.contextToolbar"),n.onVisible&&n.onVisible()};clearTimeout(d),d=o.a.setTimeout((function(){a?c.slideDown(400,v):(c.show(),v())}),100)}}}function b(e){var o=l()(e),a=o.dropDown("Standard",{alignment:o.data("dropdown-alignment")||"left"})[0];o.find(".dropdown-item").click((function(e){!function(e){if(!t){var n=e.attr("data-macro-name"),o=e.attr("data-command"),i=e.attr("data-format"),a=e.attr("data-control-id"),c=r.tinymce.activeEditor;n&&Pe.macroBrowserToolbarButtonClicked({presetMacroName:n}),o&&c.execCommand(o,!1),i&&c.plugins.atlassiantheme.controlHandlers.formatselect.click.dispatch(i),a&&c.plugins.atlassiantheme.controlHandlers.buttons.click.dispatch(a.toLowerCase())}}(l()(this)),a.hide(),e.preventDefault()})),i(a),n(a)}function y(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){l()("#rte-savebar .hints-text").html(r.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),l()("#rte-savebar a.hints-close").click((function(e){l()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()})),l()("#rte-savebar a.hints-next").click((function(e){o(),e.preventDefault()}))}return{init:function(t){var o,u;b("#format-dropdown"),b("#more-menu .aui-dd-parent"),b("#insert-menu .aui-dd-parent"),l()("#pagelayout-menu").length&&b("#pagelayout-menu .aui-dd-parent"),l()("#template-menu").length&&b("#template-menu .aui-dd-parent"),function(){var e=l()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),o=l()("#rte-button-color"),a=o.find(".selected-color"),c=t.dropDown("Standard",{alignment:"left"})[0],u=o.attr("data-color");a.css("background-color","#".concat(u)),e.delegate("a[data-color]","click",(function(e){var t=l()(this),n=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(r.tinymce.execCommand("ForeColor",!1,"#".concat(n)),o.attr("data-color",n),a.css("background-color","#".concat(n)))})),i(c),n(c)}}(),me().TablePicker.bindToControl(r.tinymce.activeEditor,l()("#insert-table-dropdown")),(o=l()("#rte-button-source-mode")).click((function(){o.hasClass("active")?e.changeMode(e.MODE_RICHTEXT):e.changeMode(e.MODE_SOURCE)})),y(),u=t,ne(r.document,"initContextToolbars.Toolbar",u),ee(r.document,"createContextToolbarRow.Toolbar",v),ee(r.document,"removeContextToolbarRow.Toolbar",h),ee(r.document,"enableContextToolbarRow.Toolbar",a),ee(r.document,"disableContextToolbarRow.Toolbar",c);var s=l()("#format-dropdown"),d=s.find("span.dropdown-text");t.on("BeforeExecCommand",(function(e){var n=e.command,r=e.value;if(l.a.each(["pre","blockquote"],(function(){"FormatBlock"==n&&r==this&&(t.formatter.remove("alignleft"),t.formatter.remove("aligncenter"),t.formatter.remove("alignright"))})),l()(t.selection.getNode()).closest("pre,.text-placeholder").length)for(var o=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],i=o.length,a=0;a<i;a++)n==o[a]&&e.preventDefault();if("FormatBlock"==n&&"pre"==r&&(t.undoManager.add(),t.execCommand("removeFormat")),"FormatBlock"==n&&"p"==r){var c=s.find(".dropdown-item[data-format='blockquote']").text();d.text()==c&&t.execCommand("FormatBlock",!1,"blockquote")}})),t.on("ExecCommand",(function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var r=s.find(".dropdown-item[data-format='".concat(n,"']"));r.length||(r=s.find(".dropdown-item[data-format='p']")),d.text(r.text())}})),t.on("NodeChange",m()),t.on("init",(function(){var e={};l()(".aui-toolbar").find("[data-control-id]").each((function(n,r){var o=l()(r),i=o.attr("data-control-id");i&&("formatselect"==i?t.plugins.atlassiantheme.controlHandlers[i].state.add((function(e){if("p"==e){var n=t.selection.getNode();l()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var r=s.find(".dropdown-item[data-format='".concat(e,"']")).text();r&&d.text(r)})):e[i.toLowerCase()]=o)}));var n=t.plugins.atlassiantheme.controlHandlers.buttons;n.state.add((function(t,n,r){var o=e[t];if(o){var i=o.find(".icon-check"),a=o.closest(".toolbar-item");i.length?i.toggleClass("hidden",!r):a.toggleClass(n,r)}})),l()(".aui-toolbar").delegate(".toolbar-item","click",(function(e){var t=l()(this);if(t.hasClass("disabled"))e.preventDefault();else{var r=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");r&&(n.click.dispatch(r.toLowerCase()),e.preventDefault())}})),l.a.support.shrinkWrapBlocks=!1,or()})),t.on("Remove",(function(){te(r.document,"showLayer",rr),te(r.document,"hideLayer",rr),f("created.property-panel",tr),f("destroyed.property-panel",tr),f("register-contexts.keyboardshortcuts",nr)}))},toggleToolbarButton:u,disableToolbarButton:function(e){u(l()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){t||u(l()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){t||l()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var t=p({id:e});return g(t)&&!l()("#".concat(t)).hasClass("disabled")},getToolbarRow:function(e){var t=p({id:e}),n=l()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!l()(".".concat(e.replace(".",""))).closest(".aui-button").prop("disabled")},bindDropdownMenu:b,toggleToolbarButtons:s,disableToolbar:function(e){t=!!e},getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}var ar=n("./node_modules/querystring-es3/index.js"),cr=n.n(ar);function ur(e){return this.message=e.message,this.statusCode=e["status-code"],this.stack=(new Error).stack,this}ur.prototype=new Error;var lr=ur;function sr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){fr(e,t,n[t])}))}return e}function fr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dr=function(e,t){return e.replace(/:([a-zA-Z]+)\?*/g,(function(e,n){var r=t[n];return"string"==typeof r&&-1===r.indexOf("=")?encodeURIComponent(decodeURIComponent(r)):r.toString()}))};function mr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(r instanceof lr){if(401===r.statusCode)return e.onUnauthorized&&e.onUnauthorized(),t(r);var o=n[r.statusCode];return o?o(r,t):t(r)}if(r instanceof TypeError)return t(r);throw r}}function pr(e,t,n){var r=t.body,o=t.callback,i=t.headers,a=t.method,c=t.extraConfig,u=t.responseTransformer,l=r,s=i["Content-Type"];return s||delete i["Content-Type"],s&&-1!==s.indexOf("application/x-www-form-urlencoded")?l=cr.a.stringify(r):"application/json"===s&&(l=JSON.stringify(r)),fetch(e,{headers:i,credentials:"include",method:a,body:l}).then((function(e){if(!e.ok){var t=e.status;return e.text().then((function(e){throw new lr({message:e,"status-code":t})}))}return c&&c.ignoreResponseJson?null:204!==e.status?e.json():e})).then((function(t){if(t&&t["status-code"])throw new lr(t);return o(null,u?u(t,e,n.contextPath,r):t)})).catch(mr(n,o))}var gr,hr=(gr={endpoint:null,contextPath:null,onUnauthorized:function(){},extraHeaders:{}},{configure:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gr=sr({},gr,e)},getConfig:function(){return gr},getFullPath:function(e,t){var n=gr.contextPath+e;return t?dr(n,t):n},getExternalServicePath:function(e,t){if("function"!=typeof e)throw"getExternalServicePath expects path to be a function so it can be lazy evaluated";var n=e();return dr(n,t)},get:function(e,t){var n=t.callback,r=t.headers,o=t.responseTransformer;return pr(e,{callback:n,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,r),method:"GET",responseTransformer:o},gr)},post:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.extraConfig,a=t.responseTransformer;return pr(e,{body:n,callback:r,headers:sr({"Content-Type":"application/x-www-form-urlencoded"},gr.extraHeaders,o),method:"POST",extraConfig:i,responseTransformer:a},gr)},put:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return pr(e,{body:n,callback:r,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,o),method:"PUT",responseTransformer:i},gr)},delete:function(e,t){var n=t.callback,r=t.headers,o=t.extraConfig,i=t.responseTransformer;return pr(e,{callback:n,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,r),method:"DELETE",extraConfig:o,responseTransformer:i},gr)},postLegacyResource:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return fetch(e,{headers:sr({"Content-Type":"application/x-www-form-urlencoded"},gr.extraHeaders,o),credentials:"include",method:"POST",body:"string"==typeof n?n:cr.a.stringify(n)}).then((function(e){if(!e.ok)return new Error("Request failed with ".concat(e.status));var t=e.headers.get("content-type");return t&&-1===t.indexOf("text/html")&&-1===t.indexOf("text/plain")?e.json():e.text()})).then((function(t){return t instanceof Error?r(t):r(null,i?i(t,e,gr.contextPath,n):t)})).catch(mr(gr,r))},fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))}),vr={configure:function(e){hr.configure(e)},getPluginCodeLanguages:function(e){var t=hr.getFullPath("/plugins/newcode/getlanguages.action");hr.get(t,{callback:e})},getWikiConfluenceToXhtml:function(e,t){var n=hr.getFullPath("/rest/tinymce/1/wikixhtmlconverter");hr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})},getWikiMarkdownToXhtml:function(e,t){var n=hr.getFullPath("/rest/tinymce/1/markdownxhtmlconverter");hr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})}};function br(){Object(r.redirect)("".concat(ye,"/login.action?os_destination=").concat(Object(r.location)().pathname.replace(ye,"")))}vr.configure({endpoint:("undefined"==typeof window?"http://localhost:8080":"".concat(i().protocol,"//").concat(i().host))+ye,contextPath:ye,onUnauthorized:br});var yr=vr,wr=(n("./src/editor-plugins/insertwiki/insert-wiki-markup.css"),function(){return!E("editor.insert-wiki-markdown")}),Cr={HELP_REST_API:"".concat(ye,"/plugins/tinymce/helplink.action"),WIKI:{CONFLUENCE:{api:yr.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:yr.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},xr={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:U.get("content-id"),spaceKey:U.get("space-key")},kr=null,Sr=function(){var e=yn.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return Cr.WIKI[e]},Tr=function(e,t){var n=l()(function(e,t,n){return'\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="'.concat(t.val,'">').concat(e(t.label),"</option>\n                ").concat(Object.keys(n).filter((function(e){return n[e].val!==t.val})).map((function(t){return'<option value="'.concat(n[t].val,'">').concat(e(n[t].label),"</option>")})),"\n            </select>\n        </form>\n    </span>\n")}(e,t,Cr.WIKI));return l()("#insert-wiki-insert-title").append(n),l()("#".concat(xr.selectionMenuId))},Er=function(){var e=l()("#".concat(xr.selectionMenuId));return e.length?e.val():Sr().val},_r=function(e){var t={wiki:(e=e||{}).textToConvert,entityId:xr.entityId,spaceKey:xr.spaceKey};e.api(JSON.stringify(t),(function(t,n){t?e.errorCallback(t):e.successCallback(n)}))},Ar=function(){var e=l()("#".concat(xr.markupEditId)).val();l.a.trim(e)?_r({api:Cr.WIKI[Er()].api,textToConvert:e,successCallback:function(e){kr.html(e)},errorCallback:function(){kr.html(Rr(e))}}):kr.html(e)},Nr=function(){var e,t,n,r=Er();yn.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",r),e=r,t=l()("#".concat(xr.dialog.id)).find(".dialog-help-link"),n=Cr.WIKI[e].helpLink,t.load(Cr.HELP_REST_API,{linkUrlKey:n}),Ar()};function Rr(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,(function(e){return"string"==typeof t[e]?t[e]:"&quot;"}))}var Or={init:function(e,t){var n;xr.dialog.content=wr()?'\n    <p id="insert-wiki-info-title">'.concat((n=function(e){return ge(e)})("tinymce.confluence.conf_wikimarkup_info_title"),'</p>\n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">').concat(n("tinymce.confluence.conf_wikimarkup.insert.label"),'</span>\n            <span id="insert-wiki-preview-title">').concat(n("tinymce.confluence.conf_wikimarkup_preview_label"),'</span>\n        </h3>\n        <textarea class="monospaceInput textarea" id="insert-wiki-textarea" name="wikitext"></textarea>\x3c!--\n            --\x3e<div class="example-container" id="insert-wiki-textarea-preview"></div>\n    </form>\n'):' \n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <textarea class="monospaceInput textarea originalDefault" id="insert-wiki-textarea" name="wikitext"></textarea>\n    </form>\n';var i=function(t){var n,o,i,a=xr.dialog.id,c=Er();e.windowManager.setBusy(a,!1),r.tinymce.EditorManager.activeEditor.windowManager.close(a),wr()&&(d("analytics",{name:"insert-wiki-markup-dialog.".concat(c)}),"MARKDOWN"===c&&(n=t,(o=l()(n)).find("img").addClass("confluence-embedded-image"),t=l()("<div>").append(o.clone()).html())),e.execCommand("mceInsertContent",!1,t),i=e,r.tinymce.each(i.dom.select("p > p"),(function(e){try{e.parentNode&&i.dom.split(e.parentNode,e)}catch(e){}}))},a=function(t,n,o){e.windowManager.setBusy(xr.dialog.id,!1);var i=function(e,t){return'\n        <p class="warning">\n            '.concat(e,'\n        </p>\n        <p class="exception-report">\n            <span class="exceptionMessage">\n                ').concat(t,"\n            </span>\n        </p>\n")}(e.translate("confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?e.translate("confluence.conf_wikimarkup_timeout"):"".concat(Rr(n||t.message)," : ").concat(Rr(o)));r.tinymce.EditorManager.activeEditor.windowManager.alert(i)};e.addCommand("InsertWikiMarkup",(function(){var n,r=Sr();return e.windowManager.open(xr.dialog,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){e.windowManager.setBusy(xr.dialog.id,!0),_r({api:Cr.WIKI[Er()].api,successCallback:i,errorCallback:a,textToConvert:l()("#".concat(xr.markupEditId)).val(),setBusy:!0})}}],plugin_url:t,helpLink:r.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),wr()&&(!function(e){var t=l()("#wysiwygTextarea_ifr").contents().find("head").html(),n=l()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");l()("#".concat(e)).append(n);var r=n.contents(),o=r[0];o.open(),o.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),o.close(),r.find("head").html(t),kr=r.find("body")}(xr.previewAreaId),Tr((function(t){return e.translate(t)}),r).on("change",Nr),l()("#".concat(xr.markupEditId)).on("keydown",(function(){clearTimeout(n),n=o.a.setTimeout(Ar,xr.serverRequestTimer)}))),!1})),e.ui.registry.addButton("insertwikimarkup",{text:"confluence.conf_wikimarkup_desc",onAction:function(){e.execCommand("InsertWikiMarkup")}})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}};var Dr={fields:{string:{language:function(e,t){var n,o=l()(r.Confluence.Templates.MacroBrowser.macroParameterSelect()),i=l()("select",o);return null==t&&(t={}),t.setValue=function(e){if(0==i.find("option[value='".concat(e,"']")).length){var t=l()("<option/>");t.val(e),t.text(e),i.append(t)}},n=i,yr.getPluginCodeLanguages((function(e,t){if(!e&&t.length){var r=n.val();n.empty(),n.append(l()("<option/>").attr("value","")),t.forEach((function(e){var t=l()("<option />");t.val(e.aliases[0]),t.text(e.friendlyName),n.append(t)})),n.val(r)}})),new r.AJS.MacroBrowser.Field(o,i,t)}}}};function Ir(){var e;function t(){var t=l()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),l()("#editor-precursor .cell").prepend(t)}if("comment"!==U.get("content-type")){var n=l()("#quickedit-breadcrumbs");n.length>0&&(l()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),l()("#breadcrumb-section").append(n)),e=l()(".edited-page-title").parent().detach(),t(),ee(r.document,"mode-changed",(function(n,r){var o;"preview"===r?(o=l()("#breadcrumbs").detach(),e.detach(),l()("#breadcrumb-section").append(o)):"richtext"===r&&t()}))}}var Pr={};function Br(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mr(e){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Lr=function(e){return function(t,n,r){var o=null!=r&&"object"!==Mr(r),i=null!=r?o?" = ".concat(r):" >":"";console.log("".concat(e," - ").concat(t," : ").concat(n||null).concat(i)),r&&!o&&console.log(r)}},Fr=function e(t,n){var o=Lr("Autocompleter.Control"),i={},a=t.selection,c=a.getRng();if(!c)return null;var u=c.startOffset,s=c.startContainer,f=s.nodeValue,d=n.leadingChar,m=t.getDoc(),p=n.backWords||0,g=n.insertedFromMenu||!1,h=Pr[d||"["],v=h&&void 0!==h.preventStartNodes?h.preventStartNodes:"div.code, a[href], img, pre";if(l()("#".concat("autocomplete"),m).length)return o("init","Autocomplete already exists, returning null."),null;i.backWords=p,i.maxResults=n.maxResults||10,null==f&&c.collapsed&&u&&s.childNodes[u-1]&&(u=(f=(s=s.childNodes[u-1]).nodeValue)&&f.length||0);var b="";if(null!=f){b="".concat(f).substring(0,u);for(var y=s.previousSibling;y&&3===y.nodeType;)b=y.nodeValue+b,y=y.previousSibling}var w;if(!p&&b&&!function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].test(e))return!0;return!1}(b+d,[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/]))return o("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(l()(s).closest(v).length)return o("init","Cursor is in wrong node to start autocomplete, returning null."),null;if(r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&(r.Confluence.PropertyPanel.shouldCreate=!1,r.Confluence.PropertyPanel.destroy()),d||null!=f||(o("init","No text available for suggestion, range is",c),f=""),i.getContainer=function(){return l()("#".concat("autocomplete"),m)},c.collapsed&&p&&f){var C=function(e,t,n){var r,o;function i(e,t,n){!t.global&&(t=new RegExp(t.source,"g".concat(t.ignoreCase?"i":"").concat(t.multiline?"m":""))),null==n?n=e.length:n<0&&(n=0);for(var r,o=e.substring(0,n+1),i=-1,a=0;null!=(r=t.exec(o));)i=r.index,t.lastIndex=++a;return i}for(var a=0;a<n;a++)for(t=i(r=e.nodeValue.substring(0,t),/\s+/,t);-1==t;){if(!(o=e.previousSibling)||3!==o.nodeType){a=n;break}e=o,(r=o.nodeValue)&&(t=i(r,/\s+/,r.length))}return{node:e,offset:t+1}}(s,u,p),x=a.getRng();x&&(x.setStart(C.node,C.offset),x.setEnd(s,u),a.setRng(x))}w=a&&a.getNode()&&a.getNode().classList.contains("placeholder-inline-tasks")?"":a.getContent({format:"text"}).replace("\n",""),o("init","suggestionHtml",w);var k,S=function(e,t,n){var o=r.document.createElement(e);return t&&o.setAttribute("id",t),n&&o.appendChild(r.document.createTextNode(n)),o},T=S("span","autocomplete");if(n.classNames)if("string"==typeof n.classNames)(k=T.classList).add.apply(k,Br(n.classNames.split(" ")));else if(Array.isArray(n.classNames)){var E;(E=T.classList).add.apply(E,Br(n.classNames))}d&&T.appendChild(S("span","autocomplete-trigger",d));var _=S("span","autocomplete-search-text",r.AJS.Rte.HIDDEN_CHAR);T.appendChild(_),a.setNode(l()(T)[0]);var A=i.getContainer();i.previousSearchText="",i.settings=h,!1===h.cache||h.cacheManager?!1!==h.cache||h.cacheManager||(h.cacheManager={get:l.a.noop,put:l.a.noop}):h.cacheManager=new r.AJS.Confluence.localStorageCacheManager(h.ch);var N=l()("#".concat("autocomplete-search-text"),i.getContainer()),R=l()(m.createElement("span")).text(w||r.AJS.Rte.HIDDEN_CHAR);N.empty().append(R),a.select(R[0],!0),a.collapse();var O,D,I=function(e){if(i.onBeforeKey&&!i.onBeforeKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("before","blocked by onBeforeKey: ".concat(e.keyCode)),!1},P=function(e){var t=a.getRng();if(t){var n=i.getContainer(),c=t.startContainer,u=c.parentNode;3===c.nodeType&&u&&(u=u.parentNode);var l=u?u.parentNode:null,s=l?l.parentNode:null,f=u!==n[0]&&l!==n[0]&&s!==n[0];if(27===e.keyCode||f)o("after","dying because of: ".concat(f?"outside search span":"escape pressed")),i.die();else if(i.onAfterKey&&!i.onAfterKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("after","blocked by onAfterKey: ".concat(e.keyCode)),!1}},B=function(e){if(i.onKeyPress&&!i.onKeyPress(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("press","blocked by onKeyPress: ".concat(e.keyCode)),!1},M=function(e){i.getContainer()[0]!=e.target.parentNode&&(o("click","Clicked outside of autocomplete, closing."),i.die())};t.on("KeyDown",I,!0),t.on("KeyUp",P,!0),t.on("KeyPress",B,!0),t.on("Click",M,!0),i.word="",n.keepAlias?o("init","No suggestion based on previous or selected text"):i.word=w,r.AJS.Rte.showElement(A[0]),O=r.tinymce.DOM.getPos(A[0]),D=A.height(),i.left=O.x,i.top=O.y+D,i.text=function(e){var t=l()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=r.AJS.escapeEntities(t.text())).replace(r.AJS.Rte.HIDDEN_CHAR,"")},i.plainText=function(e){var t=l()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=t.text()).replace(r.AJS.Rte.HIDDEN_CHAR,"")};var L=function(t,n){var r=i.getContainer();return e.replaceWithTextAndGetRange(r,t,n)};return i.replaceWithSelectedSearchText=function(){var e=i.text();return o("replaceWithSelectedSearchText",e),L(e,!1),e},i.die=function(e){if(i.dying)o("die","Already dying, returning.");else{if(i.dying=!0,r.Confluence.PropertyPanel&&(r.Confluence.PropertyPanel.shouldCreate=!0),i.getContainer().length){o("die","Tearing down autocomplete, cleaning up autocompleter");var a=(e||n.backWords||g?"":i.settings.ch)+i.text();c=L(a,!0)}setTimeout((function(){o("die","Removing autocomplete-control keyboard listeners."),t.off("KeyDown",I),t.off("KeyUp",P),t.off("Click",M),t.off("KeyPress",B)}),1),r.AJS.Rte.unbindScroll("autocomplete"),l()(r.document).unbind("click.autocomplete-outside"),this.onDeath&&this.onDeath()}},r.AJS.Rte.bindScroll("autocomplete",(function(){o("scrolling:"),r.AJS.Rte.isAnyPartShown(A)?i.onScroll():i.die()})),l()(r.document).bind("click.autocomplete-outside",(function(e){var t=e.srcElement&&"rte-insert-date"===e.srcElement.id;l()(e.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||t||i.die()})),r.AJS.Rte.getEditor().on("BeforeExecCommand",(function(e){"mceConfSavePage"==e.command&&i.die()})),i.update=function(e){ke(),L("",!0),this.settings.update(this,e)},i.removeSpan=function(){i.getContainer().remove()},i};Fr.removeOrphanedControl=function(){var e=l()(r.AJS.Rte.getEditor().getDoc()),t=e.find("#".concat("autocomplete"));if(!t.length)return null;var n=e.find("#".concat("autocomplete-trigger")).text(),o=e.find("#".concat("autocomplete-search-text")).text();return Fr.replaceWithTextAndGetRange(t,o,!1),{leadingChar:n,content:o}},Fr.replaceWithTextAndGetRange=function(e,t,n){if(e.length){t=t||"",n=n||!t;var o=r.AJS.Rte.getEditor(),i=e[0].parentNode,a=r.AJS.Rte.Content.getChildIndex(i,e[0]),c=n?1:0,u=o.selection.getRng();return u.setStart(i,a+c),u.setEnd(i,a+1),e.before(t||r.AJS.Rte.HIDDEN_CHAR).remove(),o.selection.setRng(u),u}console.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")};var jr=function e(t){if(!(this instanceof e))return new e(t);this.cache={},this.cacheStack=[],this.cacheSize=t||30};jr.prototype.get=function(e){var t=this.cache[e];if(t){var n=this.cacheStack[this.cacheStack.length-1][0]+1;return t.weight=n,this.cacheStack.push([n,e]),t.value}},jr.prototype.put=function(e,t){var n,r,o,i=this.cacheStack.length?this.cacheStack[this.cacheStack.length-1][0]+1:0;for(this.cache[e]={weight:i,value:t},this.cacheStack.push([i,e]);this.cacheStack.length>this.cacheSize;)r=(n=this.cacheStack.shift())[0],o=n[1],r===this.cache[o].weight&&delete this.cache[o]},jr.prototype.clear=function(){this.cache={},this.cacheStack=[]};var Hr=jr,Ur=function(e,t){var n,r;if(e&&e.length&&e[0]){for(var o=[],i=0,a=e.length;i<a;i++){var c=e[i];c&&o.push(c.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"))}n=new RegExp("(".concat(o.join("|"),")"),"gi"),r=Xn()(t||"<strong>{highlight}</strong>").fill({highlight:"$1"}).toString()}return{highlight:function(e,t){return e?(t||(e=Xn.a.escape(e)),n?e.replace(n,r):e):e},safeHighlight:function(e){if(!e)return e;var t,o;if(n&&r){var i=r.split("$1");t=i[0],o=i[1],e=e.replace(n,"@@@hl@@@$1@@@endhl@@@")}return Et(e).replace(/@@@hl@@@/gi,t).replace(/@@@endhl@@@/gi,o)}}},zr=function(e,t){var n=e.options;n.ajsDropDownOptions=n.ajsDropDownOptions||{};var o,i=(n.ajsDropDownOptions.Highlighter||Ur)(t.queryTokens||[t.query]);n.ajsDropDownOptions.alignment||(n.ajsDropDownOptions.alignment="left"),n.ajsDropDownOptions.selectionHandler=n.ajsDropDownOptions.selectionHandler||Wr,(o=e.dd)&&(o.hide(),o.$.remove());var a=e.dd=r.AJS.dropDown(t.matrix,n.ajsDropDownOptions)[0];if(n.ajsDropDownOptions.className&&a.$.addClass(n.ajsDropDownOptions.className),a.$.find("li a:not(.dropdown-prevent-highlight) span").each((function(){var e=l()(this);e.html(i.safeHighlight(e.text()))})),a.$.hasClass("fabric")){var c=a.$.find(".insert-mentions-dropdown-option");c.length===t.matrix[1].length&&t.matrix[1].forEach((function(e,t){var n=i.safeHighlight(e.username);if(n){e.lozenge&&(n+=" &middot; ".concat(e.lozenge));var r=l()("<span>").addClass("dropdown-lozenge").html(n);c.eq(t).append(r)}}))}return n.dropdownPlacement?n.dropdownPlacement(a.$):(console.log("No dropdownPlacement function specified. Appending dropdown to the body."),l()("body").append(a.$)),function(e){var t=e.$.closest(".aui-dd-parent").width();t||(e.$.width("25em"),t=e.$.width()),l()("a span:not(.icon)",e.$).each((function(){var e=l()(this),n=r.document.createElement("var");n.innerHTML="&#8230;";var o=l()(n),i=o.width(),a=!1;e.wrapInner(l()("<em>")),l()("em",e).each((function(){var e=l()(this);if(e.show(),this.offsetLeft+this.offsetWidth+i>t-20){for(var n=this.childNodes,r=!1,o=n.length-1;o>=0;o--){var c=n[o],u=1,s=3===c.nodeType?"nodeValue":"innerHTML",f=c[s];do{if(!(u<=f.length))break;c[s]=f.substr(0,f.length-u++)}while(this.offsetLeft+this.offsetWidth+i>t-20);if(u<=f.length){r=!0;break}}r?a=!0:e.hide()}})),a&&(e.append(o),this.elpss=o)}))}(a),function(e){l()("a span:not(.icon)",e.$).each((function(){var e,t=l()(this);try{var n=t.data("properties");e=n?n.spaceName:null}catch(e){console.error("Problem getting space name: ",e.message)}var r=t.text();e&&(r+=" (".concat(l()("<i></i>").html(e).text(),")")),t.attr("title",r)}))}(a),n.dropdownPostprocess&&n.dropdownPostprocess(a.$),a.show(e._effect),"function"==typeof n.onShow&&n.onShow.call(a,a.$),a},Wr=function(e,t){if("click"!=e.type){var n=l()("a",t).first(),i=n.attr("href");if("keydown"===e.type&&(e.metaKey||e.ctrlKey)&&13===e.which){var a=o.a.open(i,"_blank");a&&a.opener&&(a.opener=null)}else n.click(),r.document.location=i;e.preventDefault()}};function qr(e,t){this._effect="appear",this._timer=null,this.id=e,this.options=t,this.inactive=!1,this.busy=!1,this.cacheManager=Hr()}qr.prototype.clearCache=function(){this.cacheManager.clear()},qr.prototype.change=function(e,t,n){var r=this;if(e!=r._value){r._value=e,r.busy=!1,o.a.clearTimeout(r._timer);var i=r.options.minLengthForGetData||2,a=new RegExp("\\S{".concat(i,",}"));if(t||a.test(e)){var c=r.cacheManager.get(e);if(c)zr(r,c);else{r.busy=!0;var u=function(){r.options.getDataAndRunCallback.call(r,e,(function(){r.show.apply(this,arguments),n&&n(e)}))};0===r.options.dropDownDelay?u():r._timer=o.a.setTimeout((function(){u()}),r.options.dropDownDelay||200)}}else r.dd&&r.dd.hide(),n&&n(e)}},qr.prototype.hide=function(){this.dd&&this.dd.hide()},qr.prototype.remove=function(){var e=this.dd;e&&(this.hide(),e.$.remove()),this.inactive=!0,this.options.onDeath&&this.options.onDeath()},qr.prototype.show=function(e,t,n){if(this.inactive)console.log("Quick search abandoned before server response received, ignoring. ",this);else{var r={matrix:e,query:t,queryTokens:n};this.cacheManager.put(t,r),zr(this,r),this.busy=!1}};var Vr,$r;Lr("Autocompleter.Manager");var Kr=function(e){var t=Pr[e.leadingChar];if(e=l.a.extend({minLengthForGetData:t.minLengthForGetData,displayHandler:t.displayHandler,Highlighter:t.Highlighter,classNames:t.autocompleteClassNames},e),!(Vr=Fr(r.AJS.Rte.getEditor(),e)))return!1;function n(e){return l.a.data(e,"properties")}d("synchrony.stop",{id:"confluence.autocomplete-plugin"});var o,i=l()(r.window).width(),a=function(e){var t,n,a=l()("#autocomplete-dropdown"),c=Vr.getContainer();a.length||(a=l()("<div></div>").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));var u=r.AJS.Position.spaceAboveBelow(r.AJS.Rte.getEditorFrame(),c);e.find("ol:has(a.menu-header)").addClass("top-menu-item"),e.find("ol:empty").hide(),a.append(e);var s=r.AJS.Rte.Content.offset(c),f=Math.max(a.width()+s.left-i+10,0),d=s.left-f-0,m=e.outerHeight(!0),p=m+10;o&&(function(e,t){return 1==o?e.above>=t:e.below>=t}(u,p)||(o=null)),o||(o=function(e,t){return e.below>=t?2:e.above>=t?1:e.below>e.above?2:1}(u,p)),(n=a.find(".autocomplete-dropdown-arrow")).length||(n=l()("<div>").addClass("autocomplete-dropdown-arrow").addClass(Vr.settings.autocompleteClassNames)),1===o?(n.addClass("autocomplete-dropdown-bottom-arrow").css({top:m-1}),t=s.top-m-10):(n.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),t=s.top+c.height()+10),n.css({left:f}).appendTo(a),a.css({position:"absolute",top:t,left:d})};$r=function(e){return new qr("inputdriven-dropdown",e)}({onShow:function(e){d("rte-autocomplete-on-show",{triggerChar:Vr.settings.ch});var t=r.AJS.Rte.getEditorFrame();t&&t.shim&&t.shim.hide(),e.find("a.menu-header").unbind().click((function(e){e.preventDefault(),Vr.die()})),this.reset(),Vr.settings.selectFirstItem&&e.find("a:not('.menu-header')").length&&r.AJS.dropDown.current.moveDown()},dropdownPlacement:a,onDeath:function(){l()("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(e,t){e.preventDefault();var r=n(t[0]);r&&"function"==typeof r.callback?r.callback(Vr):"menu-header"!==r.className&&Vr.update(r),Vr.die()},moveHandler:function(e,t){var n=r.AJS.dropDown.current;e&&e.find("a").is(".menu-header")&&("up"==t?n.moveUp():n.moveDown())},className:"autocomplete ".concat(Vr.settings.dropDownClassName),displayHandler:e.displayHandler,Highlighter:e.Highlighter},getDataAndRunCallback:function(e){Vr&&Vr.settings.getDataAndRunCallback&&Vr.settings.getDataAndRunCallback(Vr,e,(function(t,n,r,o){t.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:Vr.settings.getHeaderText(Vr,e)}]),t.push(Vr.settings.getAdditionalLinks(Vr,e,r)),$r&&$r.show(t,n,o||[n])}))},dropDownDelay:Vr.settings.dropDownDelay,minLengthForGetData:Vr.settings.minLengthForGetData}),Vr.onBeforeKey=function(e,t){return 40===e.keyCode||38===e.keyCode||13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):!(27===e.keyCode||9===e.keyCode||8===e.keyCode&&!t)||(this.die(8===e.keyCode),!1)},Vr.onKeyPress=function(e){var t=String.fromCharCode(e.which);return 13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):(this.settings.endChars.includes(t)&&Vr.die(),!0)};var c=e.minLengthForGetData||2,u=new RegExp("\\S{".concat(c,",}"));Vr.onAfterKey=function(e,t){if(40===e.keyCode||38===e.keyCode||13===e.keyCode){var n=r.AJS.dropDown.current;return!!n&&(-1==n.getFocusIndex()&&13===e.keyCode?(Jr(),!0):(e.which||(e.which=e.keyCode),n.moveFocus(e)))}var o=8===e.keyCode&&!t||s(t);return(o||u.test(t))&&$r&&$r.change(t,o),!0};var s=function(e){return/[\u4E00-\u9FFF]/gi.test(e)};return Vr.onDeath=function(){$r&&($r.remove(),$r.closing=!0),d("synchrony.start",{id:"confluence.autocomplete-plugin"})},Vr.onScroll=function(){$r&&$r.dd&&a($r.dd.$)},Vr.getCurrentItem=function(){if(!$r||!$r.dd)return null;var e=$r.dd,t=e.getFocusIndex();return t<0?null:n(e.links[t])},$r&&$r.change(Vr.text(),!0),!0},Jr=function(){Vr.die(),Vr=null},Gr={getInputDrivenDropdown:function(){return $r},triggerListener:function(e){if(!e.metaKey){$r&&$r.closing&&($r=null);var t=String.fromCharCode(e.which);!$r&&t in Pr&&Kr({leadingChar:t})&&r.tinymce.dom.Event.cancel(e)}},shortcutFired:function(e,t){var n=t?0:1;return $r&&$r.closing&&($r=null),$r&&(n=t?0:Vr.backWords+1,Jr()),Kr({leadingChar:e,backWords:n})},reattach:function(){var e=Fr.removeOrphanedControl();e&&Gr.shortcutFired(e.leadingChar)}},Xr=n("com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')"),Yr=n.n(Xr),Qr=function(e,t){Pr[e]=t},Zr=function(e,t,n){return'<a href="#" class="'.concat(t||"",'"><span class="icon ').concat(n||"",'"></span><span>').concat(e,"</span></a>")},eo=function(e,t,n,r,o){var i;if(e.statusMessage)i=[[{html:e.statusMessage,className:"error"}]];else{var a=t?Yr.a.REST.makeRestMatrixFromSearchData(e):Yr.a.REST.makeRestMatrixFromData(e,r);i=Yr.a.REST.convertFromRest(a)}n(i,t,(function(e,t){o&&"function"==typeof o&&o(i,e,t)}))},to=function(e,t,n,r,o,i,a){var c,u=t(r),s=e.settings.cacheManager,f=s.get(r);u?((c=l.a.ajax({type:"GET",url:u,data:n(e,r),dataType:"json",global:!1,timeout:5e3})).done((function(e){s.put(r,e)})),f?eo(f,r,o,i,a):(c.done((function(e){eo(e,r,o,i,a)})),c.fail((function(e,t){"timeout"==t&&eo({statusMessage:"Timeout",query:r},r,o,i)})))):o([],r)};function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"!==no(o.a.Confluence)&&(o.a.Confluence={}),void 0===o.a.Confluence.Editor&&(o.a.Confluence.Editor={}),o.a.Confluence.Editor.Autocompleter={Settings:Pr,log:Lr,Util:{dropdownLink:Zr,getRestData:to},Control:Fr,Manager:Gr},Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager",(function(){return Gr})),Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",(function(){return{Settings:Pr,log:Lr}}));var ro=function(e){e.on("PostRender",(function(){console.log("Autocomplete enabled, adding keyPress listener"),e.on("keypress",Gr.triggerListener,!0),d("ready-editor-autocomplete")})),e.on("Undo",Gr.reattach),e.on("Redo",Gr.reattach)};var oo=n("confluence.web.components:confluence/require('confluence/root')"),io=function(e){return e?"".concat(ye,"/rest/prototype/1/search.json"):U.get("remote-user")?"".concat(ye,"/rest/prototype/1/session/history.json"):null},ao=function(e,t){var n={"max-results":e.maxResults};return t&&(n.query=Object(oo.unescapeEntities)(t),n.search="name",n.preferredSpaceKey=U.get("space-key")),n},co=function(){return Qr("[",{ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.links.header.text")},getAdditionalLinks:function(e,t,n){var o;if(t){var i=ge("editor.autocomplete.links.dialog.search");o=r.AJS.format(i,t)}else o=ge("editor.autocomplete.links.dialog.search.no.text");var a=r.Confluence.Editor.LinkBrowser,c=[{className:"search-for",name:o,href:"#",callback:function(e){e.replaceWithSelectedSearchText();var t=a.open({panelKey:a.SEARCH_PANEL});t.doSearch(t.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:Zr(ge("editor.autocomplete.links.web.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),a.open({panelKey:a.WEBLINK_PANEL})}}];return n&&n(t,c),c},getDataAndRunCallback:function(e,t,n){to(e,io,ao,t,n,"content",(function(e,t,n){var o;t&&(e.length<2||("page"!==(o=e[1][0].restObj).type||o.space.key!=U.get("space-key")||o.title.toLowerCase()!==t.toLowerCase()))&&n.push({className:"insert-create-page-link",html:Zr(ge("editor.autocomplete.links.create.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var n=Object(oo.unescapeEntities)(t),o=r.Confluence.Link.createLinkToNewPage(n,U.get("space-key"));e.update(o)}})}))},update:function(e,t){t.restObj&&(t=r.Confluence.Link.fromREST(t.restObj)),t&&t.insert()}})},uo=function(e){e.addCommand("mceConfAutocompleteLink",(function(){return Gr.shortcutFired("["),!1})),e.addShortcut("meta+shift+k",e.translate("AutoCompleteLink"),"mceConfAutocompleteLink"),co()},lo=n("com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')"),so=n.n(lo);function fo(){return{init:function(){!function(){function e(e){l()("#autocomplete-dropdown .top-menu-item").spin(e)}function t(){so.a.reset(),so.a.preLoadMacro()}function n(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?so.a.hasRequiredParameters(n)||n.alwaysShowConfig?Pe.macroBrowserToolbarButtonClicked(t):(ke(),Ie.insertMacro({contentId:U.get("content-id")||"0",macro:{name:n.macroName,body:""}})):Pe.macroBrowserToolbarButtonClicked(t)}function r(e){if(e.hidden&&!so.a.isHiddenMacroShown(e))return null;var t={className:"autocomplete-macro-".concat(e.macroName),callback:function(t){n(t,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(t.name=e.title,t.href="#",t.icon=(e.icon.relative?U.get("static-resource-url-prefix"):"")+e.icon.location):t.html=Zr(e.title),t}Qr("{",{ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.macros.header.text")},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:Zr(ge("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var t=e.text();n(e,{searchText:t})}}]},getDataAndRunCallback:function(n,o,i){var a=so.a.getMetadataPromise(),c=this,u=arguments;function s(e){var t=[];return l()("#macro-insert-list li").each((function(n,o){var i=l()(o),a=e.find((function(e){return e.macroName===i.attr("data-macro-name")}));if(a){var c=r(a);c&&t.push(c)}})),t}function f(e){for(var t=[],o=so.a.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),i=0,a=o.length;i<a;i++){var c=r(o[i]);if(c&&t.push(c)==n.maxResults)break}return t}function m(){var t;t=o?f(o):s(so.a.metadataList),e(!1),i([t],o)}function p(e){e.preventDefault(),e.stopPropagation(),d("analytics",{name:"autocomplete-macrobrowser.load-retry"}),t(),c.getDataAndRunCallback.apply(c,u)}c.alreadyBinded||(c.alreadyBinded=!0,a.always((function(){m(),c.alreadyBinded=!1})),a.fail((function(){d("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),y.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:ge("editor.autocomplete.macros.error.load.header"),body:'<p><a id="macro-retry-link" href="#">'.concat(ge("editor.autocomplete.macros.error.load.retrylink"),"</a></p>")}),l()("#macro-retry-link").click(p),l()("#autocomplete-dropdown ol").eq(1).show()}))),"pending"===a.state()&&(i([],o),e(!0))},update:function(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}})}()},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}var mo=n("com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')"),po=n.n(mo),go=n("confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')"),ho=n.n(go);function vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bo=function(e){var t=U.get("content-id");return e?"".concat(ye,"/rest/prototype/1/search.json"):+t?"".concat(ye,"/rest/prototype/1/content/").concat(t,"/attachments.json"):null},yo=function(e,t){var n=r.AJS.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return t?{type:"attachment",attachmentType:n,search:"name","max-results":e.maxResults,query:t}:{attachmentType:n,"max-results":e.maxResults}},wo=function(){return Qr("!",{ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:function(){return r.AJS.MacroBrowser.getMacroMetadata("view-file")?ge("editor.autocomplete.file.header.text"):ge("editor.autocomplete.media.header.text")},getAdditionalLinks:function(){var e=ge("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:Zr(e,"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:Zr(ge("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(e,t,n){to(e,bo,yo,t,n,"attachment")},update:function(e,t){d("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:t});var n=t.restObj,o=r.AJS.REST.wikiLink(n),i=n&&n.title||t.name;if("Image"==n.niceType){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vo(e,t,n[t])}))}return e}({filename:i,contentId:t.ownerId||n.ownerId},o.params);r.tinymce.confluence.ImageUtils.insertFromProperties(a)}else{var c=!!r.AJS.MacroBrowser.getMacroMetadata("view-file"),u=n.contentType,l="VANILLA"!==U.get("confluence-flavour");if(c&&(l&&!(u&&"application/x-shockwave-flash"===u)||u&&("audio/mp3"===u||"video/mp4"===u)||"Multimedia"!==n.niceType)){var s={name:i,page:n.parentTitle,space:n.space?n.space.key:"",date:n.datePath,ownerId:n.ownerId};po.a.insertFilePlaceholder(s)}else this._insertFile(i,t,o)}},_insertFile:function(e,t,n){var o;switch(t.restObj.niceType){case"PDF Document":o="viewpdf";break;case"Word Document":o="viewdoc";break;case"Excel Spreadsheet":o="viewxls";break;case"PowerPoint Presentation":o="viewppt";break;case"Multimedia":o="multimedia"}var i={page:n.destination.substring(0,n.destination.indexOf("^")),name:e};ho.a.get("viewdoc").beforeParamsRetrieved(i),i.page||delete i.page;var a={contentId:U.get("content-id")||"0",macro:{name:o,params:i,body:""}};r.tinymce.confluence.MacroUtils.insertMacro(a)}})},Co=function(){s("init.rte",(function(){s("rte-autocomplete-on-show",(function(e,t){"!"===t.triggerChar&&d("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})})),s("rte-autocomplete-on-insert",(function(e,t){var n;"!"===t.triggerChar&&(n=t.selectedFile)&&n.name&&d("analytics",{name:"confluence.editor.autocomplete.insert",data:{extension:n.name.split(".").pop(),type:"media"}})}))})),s("rte-destroyed",(function(){f("rte-autocomplete-on-insert"),f("rte-autocomplete-on-show")}))},xo=function(e){e.addCommand("mceConfAutocompleteImage",(function(){return Gr.shortcutFired("!"),!1})),e.addShortcut("meta+shift+m",e.translate("AutoCompleteImage"),"mceConfAutocompleteImage"),wo(),Co()};var ko=function(){return{initContextToolbars:function(){var e,t,n,o,i=r.tinymce.activeEditor,a=Qn(),c="aui-icon aui-icon-small aui-iconfont-",u=r.AJS.storageManager("atlassian.editor","tables"),s=function(e){var t=i.translate(e),n="".concat(e,"_shortcut"),r=i.translate(n);return r&&r!==n&&(t+=" (".concat(r,")")),t},f={Buttons:[new a.Group([new a.Button({text:s("table.row_before_desc"),iconClass:"".concat(c,"insert-row-before"),click:function(){r.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new a.Button({text:s("table.row_after_desc"),iconClass:"".concat(c,"insert-row-after"),click:function(){r.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new a.Button({text:s("table.delete_row_desc"),iconClass:"".concat(c,"remove-row"),click:function(){r.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new a.Group([new a.Button({text:s("table.cut_row_desc"),iconClass:"".concat(c,"cut-table-row"),click:function(){r.tinymce.execCommand("mceTableCutRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.copy_row_desc"),iconClass:"".concat(c,"copy-table-row"),click:function(){r.tinymce.execCommand("mceTableCopyRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.paste_row_before_desc"),iconClass:"".concat(c,"paste-table-row"),click:function(){r.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!u.doesContain("copied")})]),new a.Group([new a.Button({text:s("table.col_before_desc"),iconClass:"".concat(c,"insert-column-before"),click:function(){r.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new a.Button({text:s("table.col_after_desc"),iconClass:"".concat(c,"insert-column-after"),click:function(){r.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new a.Button({text:s("table.delete_col_desc"),iconClass:"".concat(c,"remove-column"),click:function(){r.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new a.Group([new a.Button({text:s("table.merge_cells_desc"),iconClass:"".concat(c,"merge-table-cells"),click:function(){r.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new a.Button({text:s("table.split_cells_desc"),iconClass:"".concat(c,"split-merged-table-cells"),click:function(){r.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new a.Group([new a.Button({text:s("table.row_highlight"),iconClass:"".concat(c,"heading-row"),click:function(){r.tinymce.execCommand("confTableRowToggleHeading",!1),r.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new a.Button({text:s("table.col_highlight"),iconClass:"".concat(c,"heading-column"),click:function(){r.tinymce.execCommand("confTableColumnToggleHeading",!1)}}),new a.Button({text:s("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click:function(){r.tinymce.execCommand("mceTableInsertNumberingCol",!1,"")}})]),new a.SplitGroup([new a.Button({text:s("table.selection_highlight"),iconClass:"".concat(c,"paint-bucket"),click:function(){r.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:(e=l()("<ul/>").addClass("table-highlight-picker"),l.a.each(Ge.a.colorValues,(function(t,n){var r=l()("<li/>"),o=l()("<a href='#'></a>"),i=Ge.a.colorNames[n];"clear"===n?o.addClass("remove-highlight").attr("data-remove-highlight","true"):o.addClass("highlight-#".concat(n)).attr("data-highlight-colour","#".concat(n)),o.attr("title",i),o.attr("aria-label",i),o.tooltip(),r.append(o),e.append(r)})),e),alignment:"left"},postProcess:function(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=l()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-paint-bucket").after(t)}}),new a.Group([new a.Button({text:s("table.del"),iconClass:"".concat(c,"remove-table"),click:function(){r.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:er},d=function(e){var t=l()(e).closest("td,th"),n=l()(".mceSelected",t.closest("table"));!function(e){function t(e,t){return parseInt(e.attr(t),10)}return e.filter((function(){var e=l()(this);return t(e,"rowspan")>1||t(e,"colspan")>1})).length>=1}(t.add(n))?i.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"):i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split")};function m(e){var t=l()(this),n=l()("#table-highlight-group"),r=n.attr("data-highlight-colour"),o=n.attr("data-remove-highlight");r&&(n.removeClass("highlight-".concat(r)),n.removeAttr("data-highlight-colour")),n.removeClass("remove-highlight"),o&&n.removeAttr("data-remove-highlight");var a=t.attr("data-highlight-colour");a&&(n.addClass("highlight-".concat(a)),n.attr("data-highlight-colour",a)),t.attr("data-remove-highlight")&&(n.addClass("remove-highlight"),n.attr("data-remove-highlight","true")),i.focus(!1),i.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}return i.on("NodeChange",(function(e){var n,o=e.element,i=l()("body"),a=!i.hasClass("no-tools")||i.hasClass("no-tools-toolbars-visible");t||null==o.parentNode||"BODY"===o.nodeName||(t=!0,n=o,l()(n).closest("table:not(.wysiwyg-macro)").length?(ne(r.document,"createContextToolbarRow.Toolbar",{buttons:f.Buttons,topToolbar:!0,animate:a}),ne(r.document,"enableContextToolbarRow.Toolbar",{id:"default"}),function(e){l.a.fn.updateTableModeInToolbar&&l()(e).closest("table").updateTableModeInToolbar()}(o),d(o),function(e){l()(e).closest("table").find(".numberingColumn").length>0?l()("#insert-numbering-column").addClass("active"):l()("#insert-numbering-column").removeClass("active")}(o)):ne(r.document,"disableContextToolbarRow.Toolbar",{animate:a}),t=!1)})),i.on("Undo",(function(){i.nodeChanged()})),i.initialized?l()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m):i.on("init",(function(){l()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m)})),i.on("Remove",(function(){l()(r.document).off("click","#table-highlight-colour .aui-dropdown a",m)})),f.Buttons.splice(0,0,new a.Group([new a.DropDownButton({id:"table-mode-picker",text:s("table.auto_width"),dropDownContent:(n=l()("<ul/>").addClass("table-mode-list"),o=[{name:s("table.responsive"),mceCmd:"mceAutoWidth",tooltip:s("table.responsive_tooltip")},{name:s("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:s("table.fixed_width_tooltip")}],l.a.each(o,(function(e,t){var o=l()("<li/>").addClass("dropdown-item").attr("data-tooltip",t.tooltip),i=l()('<a href="#">'.concat(t.name,"</a>")).addClass("item-link");o.on("click",(function(){r.tinymce.execCommand(t.mceCmd,!1,"")})),n.append(o.append(i))})),n)})])),E("confluence-table-enhancements.copy-cut-paste-cols.disabled")||f.Buttons.splice(3,0,new a.Group([new a.Button({text:s("table.col_cut_desc"),iconClass:"".concat(c,"cut-table-column"),click:function(){r.tinymce.execCommand("mceTableCutCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_copy_desc"),iconClass:"".concat(c,"copy-table-column"),click:function(){r.tinymce.execCommand("mceTableCopyCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_paste_desc"),iconClass:"".concat(c,"paste-table-column"),click:function(){r.tinymce.execCommand("mceTablePasteColBefore",!1,"")},disabled:!u.doesContain("copied")})])),f}}};function So(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(!e.page&&!e.date&&!e.space){var t=U.get("content-type");"page"==t||"blogpost"==t?e.page=r.document.getElementById("content-title").value:"comment"==t&&(e.page=U.get("page-title"))}if(e.date){var n=e.date.split("/");e.page=["",n[2],n[0],n[1],e.page].join("/")}return e.space&&(e.page="".concat(e.space,":").concat(e.page)),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]);var o=U.get("content-type");(("page"==o||"blogpost"==o)&&e.page==r.document.getElementById("content-title").value||"comment"==o&&e.page==U.get("page-title"))&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=r.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){var n,o,i=(n={},o=t.split(":",2),n.spaceKey=2==o.length&&o[0]||U.get("space-key"),n.title=o[o.length-1],0==n.title.indexOf("/")&&(n.postingDay=n.title.substr(1,10),n.title=n.title.substr(12)),n.title==r.document.getElementById("content-title").value&&(n.title=""),n.title||(U.get("new-page")?n.draftId=U.get("content-id"):n.pageId=U.get("page-id")),n);this.getData(i)},n},spacekey:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return r.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},r.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),r.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),r.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),r.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),r.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var r=t.substring(n+1);r&&("doc"==r&&"docx"==r&&(e.name="viewdoc"),"pdf"==r&&(e.name="viewpdf"),"ppt"==r&&"pptx"==r&&(e.name="viewppt"),"xls"==r&&"xlsx"==r&&(e.name="viewxls"))}}}}}var To,Eo,_o,Ao,No=n("./src/editor-plugins/status-macro/editor-content.scss"),Ro=n.n(No),Oo=(n("./src/editor-plugins/status-macro/styles.scss"),["Grey","Red","Yellow","Green","Blue"]),Do=Oo[0];function Io(){Po();var e=r.Confluence.MacroParameterSerializer.deserialize(l()(Eo).attr("data-macro-parameters")),t=!1,n=!1;return e&&_o&&(t=e.title!==_o.title,n=e.colour!==_o.colour),t||n}function Po(){if(Ao){var e=Mo(_o)==Ao.val(),t=""===Ao.val();e||t?delete _o.title:_o.title=Ao.val()}}function Bo(){if(!To||!To.state||"pending"!==To.state()){Po();var e={contentId:r.Confluence.Editor.getContentId(),macro:{name:"status",params:_o,defaultParameterValue:"",body:""}};(To=r.tinymce.confluence.MacroUtils.insertMacro(e,Eo)).done((function(e){var t;t=Eo=e,r.tinymce.activeEditor.selection.select(t),ke(),r.tinymce.activeEditor.selection.collapse()})).fail((function(e){0}))}}function Mo(e){return e.colour||e.color||Do}function Lo(){var e=l()("<input/>");return e.attr("class","status-macro-title first last editable"),e.keyup((function(e){return 13!==e.keyCode||(r.Confluence.PropertyPanel.destroy(),!1)})),e.keydown((function(e){return 27!==e.keyCode||(Ao=null,!0)})),e}function Fo(e){(Ao=Lo()).val(e.find("span.panel-button-text").text()),e.replaceWith(Ao),Ao.select().focus()}function jo(e){e.on("init",(function(){Ro.a.use()}))}var Ho=n("./src/editor-plugins/theme-atlassian/editor-content.scss"),Uo=n.n(Ho);function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Vo(e,t,n[t])}))}return e}function Wo(e){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $o=function(e,t){if("number"==typeof e)return e;if("string"==typeof e&&/^\d+/.test(e))try{return parseInt(e)}catch(e){return t}return t},Ko=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Vo(this,"scope",void 0),Vo(this,"listeners",void 0),Vo(this,"inDispatch",void 0),this.inDispatch=!1,this.scope=t||this,this.listeners=[]}var t,n,o;return t=e,(n=[{key:"add",value:function(e,t){return this.listeners.push({cb:e,scope:t||this.scope}),e}},{key:"addToTop",value:function(e,t){var n={cb:e,scope:t||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),e}},{key:"remove",value:function(e){var t=this.listeners,n=null;return r.tinymce.each(t,(function(r,o){if(e==r.cb)return n=r,t.splice(o,1),!1})),n}},{key:"dispatch",value:function(){var e,t,n,r=this,o=arguments,i=r.listeners;for(r.inDispatch=!0,t=0;t<i.length&&!1!==(n=(e=i[t]).cb.apply(e.scope,o.length>0?o:[e.scope]));t++);return r.inDispatch=!1,n}}])&&qo(t.prototype,n),o&&qo(t,o),e}();function Jo(e){return"object"===Wo(e)&&e.name}function Go(e,t){return"string"==typeof t?e.queryCommandState(t):!!Jo(t)&&e.queryCommandState(t.name)}function Xo(e){this.init=this.init(e)}function Yo(e){var t={},n={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote",help:"mceConfShortcutDialog"},o=["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"];function i(e){var n=e.undoManager;t.buttons.state.dispatch("undo","disabled",!n.hasUndo()&&!n.typing),t.buttons.state.dispatch("redo","disabled",!n.hasRedo())}function a(t){var r=e.ui.registry.getAll().buttons[t];if(!r)return!1;r.cmd?n[t]=r.cmd:n[t]={func:r.onAction,name:t}}function c(){r.tinymce.each(r.tinymce.explode(e.settings.theme_advanced_buttons1),(function(n){if(!a(n))switch(n){case"formatselect":t.formatselect={},t.formatselect.state=new Ko,t.formatselect.click=new Ko,t.formatselect.click.add((function(t){e.execCommand("FormatBlock",!1,t)}))}})),t.buttons={},t.buttons.state=new Ko,t.buttons.click=new Ko,t.buttons.click.add((function(t){var r=n[t];"string"===Wo(r)?e.execCommand(n[t]):Jo(r)&&r.func()})),function(){var t={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=e.ui.registry.getAll().buttons,r=[];for(var o in n)r.push(zo({},t,n[o],{id:o,weight:$o(n[o].weight,1/0)}));r=r.filter((function(e){return!!e.locationGroup})),["toolbar-primary"].forEach((function(e){var t=l()(".".concat(e));r.filter((function(t){return t.toolbar===e})).sort((function(e,t){return e.weight-t.weight})).forEach((function(e){a(e.id);var n,r=t.find(".".concat(e.locationGroup)),o=l()('<li id="'.concat((n=e).id,'" class="toolbar-item ').concat(n.className,'" data-tooltip="').concat(n.tooltip,'" data-weight="').concat(n.weight,'">\n                            <a class="toolbar-trigger aui-button aui-button-subtle" href="#" data-control-id="').concat(n.id,'">\n                                <span class="icon ').concat(n.icon,'"></span>\n                                <span class="trigger-text">').concat(n.title,"</span>\n                            </a>\n                        </li>"));r.append(o).removeClass("hidden")}))}))}()}var u=Xo.shouldInit();return u&&Xo.suppressIncompatiblePlugins(),e.on("init",(function(){c(),e.settings.readonly||(e.on("NodeChange",(function(a){!function(e,a){r.tinymce.each(o,(function(r){t.buttons.state.dispatch(r,"active",!!Go(e,n[r]))})),i(e),t.buttons.state.dispatch("outdent","disabled",!Go(e,"Outdent"));var c=function(e){for(var t=a.parents,n=0;n<t.length;n++)if(e(t[n]))return t[n]}(e.dom.isBlock);c&&t.formatselect.state.dispatch(c.nodeName.toLowerCase())}(e,{parents:a.parents})})),e.on("keyup",(function(){i(e)})),e.on("MouseUp",(function(){i(e)})),e.dom.bind(e.dom.getRoot(),"dragend",(function(){i(e)})),u&&new Xo(e)),Uo.a.use()})),{controlHandlers:t}}Xo.INCOMPATIBLE_PLUGINS=["dfe"],Xo.shouldInit=function(){var e=l()("body");return e.hasClass("edit")||e.hasClass("create")||e.hasClass("copy-page")},Xo.suppressIncompatiblePlugins=function(){for(var e=function(){},t=0,n=Xo.INCOMPATIBLE_PLUGINS.length;t<n;t++)r.tinymce.PluginManager.lookup[Xo.INCOMPATIBLE_PLUGINS[t]]=e},Xo.prototype.init=function(e){var t=r.tinymce.util.VK,n=l()("#content-title"),i=l()("form.editor"),a=l()(e.getBody()),c=l()(e.getDoc()),u=l()("#editor-precursor"),s=l()(e.getWin()),f=l()("#toolbar"),d=c.scrollTop(),m=parseInt(a.css("padding-top"),10)+parseInt(a.css("margin-top"),10),p=parseInt(u.css("padding-top"),10),g=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;function h(t){var n=this;e.plugins.customtoolbar.toggleToolbarButtons(t,t,t,(function(){return!l()(n).parent().hasClass("close")}))}function v(e){return e.getBoundingClientRect().top+document.body.scrollTop}function b(){var e=d-c.scrollTop(),t=v(f[0])-v(i[0]),n=u.outerHeight(),r=f.outerHeight();u.css("top","".concat(t+r+e+p,"px")),a.css("padding-top","".concat(n+m,"px"))}return n.on("keydown",(function(n){var r=n.keyCode||n.which;r!==t.ENTER&&r!==t.DOWN||(n.preventDefault(),n.stopPropagation(),e.focus(!1))})).on("focus click",(function(){h(!0)})),s.on("focus",(function(){h(!1)})),function(e){!function t(){e(t),b()}(),a.on("scroll mousewheel",(function(){setTimeout(b,0)}))}(g),!0};function Qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zo(e,t,n[t])}))}return e}function Zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ei=["Next Issue","Previous Issue","Click for more info","Ignore","Repair"],ti=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ed=t,Zo(this,"handleClick",(function(e){n.processAnalytics(e)})),Zo(this,"handleKeyDown",(function(e){r.tinymce.util.VK.SPACEBAR!==e.keyCode&&r.tinymce.util.VK.ENTER!==e.keyCode||n.processAnalytics(e)})),Zo(this,"handleReport",(function(){var e=n.ed.plugins.a11ychecker.getReport(),t={};e.forEach((function(e){t.hasOwnProperty(e.id)?t[e.id]++:t[e.id]=1})),d("analytics",{name:"confluence.editor.a11ychecker.issues",data:Qo({pageId:U.get("page-id"),warning:e.filter((function(e){return"warning"===e.severity})).length,error:e.filter((function(e){return"error"===e.severity})).length,contentType:U.get("content-type")},t)})})),Zo(this,"processAnalytics",(function(e){var t=e.target.closest(".tox-button");if(t){var r=ei.find((function(e){return t.getAttribute("title")===n.ed.translate(e)}));r&&d("analytics",{name:"confluence.editor.a11ychecker.dialog.item.click",data:{item:r,pageId:U.get("page-id"),contentType:U.get("content-type")}})}}))},ni=n("./src/editor-plugins/a11ychecker/editor-content.scss"),ri=n.n(ni);function oi(e){var t=e.translate("a11ychecker.btn_tooltip"),n=new ti(e);e.on("init",(function(){ri.a.use();var r=l()('<li id="'.concat("a11y-check-btn",'" class="toolbar-item aui-button aui-button-subtle" data-tooltip="').concat(t,'">\n                            <a class="toolbar-trigger" href="#" data-control-id="').concat("a11y-check-btn",'" aria-label="').concat(t,'">\n                                <span class="tox-icon tox-tbtn__icon-wrap">\n                                    ').concat('<svg width="18" height="18">\n                                <path fill-rule="nonzero" d="M9 1c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm6 7h-3v8a1 1 0 01-2 0v-3a1 1 0 00-2 0v3a1 1 0 01-2 0V8H3a1 1 0 110-2h12a1 1 0 010 2z"></path>\n                             </svg>',"\n                                </span>\n                            </a>\n                        </li>"));r.on("click",(function(t){t.preventDefault(),t.currentTarget.classList.contains("disabled")||(n.handleReport(),e.plugins.a11ychecker.toggleaudit())})),U.get("content-type").indexOf("question")>0?r.insertAfter(l()("#rte-button-insert-code")):l()(".rte-toolbar-group-undo").prepend(r)})),e.on("OpenWindow",(function(){l()(".tox-dialog").on("click",n.handleClick).on("keydown",n.handleKeyDown)}))}var ii=[function(){var e;function t(){}function n(t){!e&&o.a&&o.a.console&&(e=!0,console.log("Deprecated TinyMCE API call: ".concat(t)))}function i(e,r,o,i){e=e||this;var a=[];r?(this.add=function(t,c,u){function l(n){var a=[];if("string"==typeof o&&(o=o.split(" ")),o&&"function"!=typeof o)for(var u=0;u<o.length;u++)a.push(n[o[u]]);("function"!=typeof o||(a=o(r,n,e)))&&(o||(a=[n]),a.unshift(i||e),!1===t.apply(c||i||e,a)&&n.stopImmediatePropagation())}n("<target>.on".concat(r,".add(..)")),e.on(r,l,u);var s={original:t,patched:l};return a.push(s),l},this.addToTop=function(e,t){this.add(e,t,!0)},this.remove=function(t){return a.forEach((function(n,o){if(n.original===t)return a.splice(o,1),e.off(r,n.patched)})),e.off(r,t)},this.dispatch=function(){return e.fire(r),!0}):this.add=this.addToTop=this.remove=this.dispatch=t}function a(e){function o(t,n){r.tinymce.each(t.split(" "),(function(t){e["on".concat(t)]=new i(e,t,n)}))}function a(e,t,n){return[t.level,n]}function c(e){return function(t,n){if(!n.selection&&!e||n.selection==e)return[n]}}if(!e.controlManager){e.controlManager={buttons:{},setDisabled:function(e,t){n("controlManager.setDisabled(..)"),this.buttons[e]&&this.buttons[e].disabled(t)},setActive:function(e,t){n("controlManager.setActive(..)"),this.buttons[e]&&this.buttons[e].active(t)},onAdd:new i,onPostRender:new i,add:function(e){return e},createButton:u,createColorSplitButton:u,createControl:u,createDropMenu:u,createListBox:u,createMenuButton:u,createSeparator:u,createSplitButton:u,createToolbar:u,createToolbarGroup:u,destroy:t,get:t,setControlType:u},o("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),o("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),o("BeforeExecCommand ExecCommand","command ui value args"),o("PreProcess PostProcess LoadContent SaveContent Change"),o("BeforeSetContent BeforeGetContent SetContent GetContent",c(!1)),o("SetProgressState","state time"),o("VisualAid","element hasVisual"),o("Undo Redo",a),o("NodeChange",(function(t,n){return[e.controlManager,n.element,e.selection.isCollapsed(),n]}));e.addButton;e.addButton=function(t,n){var o,i,a;n.title&&(n.text=(o=n.title,i=[e.settings.language||"en",o].join("."),a=r.tinymce.i18n.translate(i),i!==a?a:r.tinymce.i18n.translate(o))),n.cmd&&(n.onAction=function(){ed.execCommand(n.cmd)}),e.ui.registry.addButton(t,n)},e.on("init",(function(){var t=e.undoManager,n=e.selection;t.onUndo=new i(e,"Undo",a,null,t),t.onRedo=new i(e,"Redo",a,null,t),t.onBeforeAdd=new i(e,"BeforeAddUndo",null,t),t.onAdd=new i(e,"AddUndo",null,t),n.onBeforeGetContent=new i(e,"BeforeGetContent",c(!0),n),n.onGetContent=new i(e,"GetContent",c(!0),n),n.onBeforeSetContent=new i(e,"BeforeSetContent",c(!0),n),n.onSetContent=new i(e,"SetContent",c(!0),n)})),e.on("BeforeRenderUI",(function(){var t=e.windowManager;t.onOpen=new i,t.onClose=new i,t.createInstance=function(e,t,o,i,a,c){return n("windowManager.createInstance(..)"),new(r.tinymce.resolve(e))(t,o,i,a,c)}})),e.getLang=function(t,n){return e.editorManager.i18n.data[(e.settings.language||"en")+"."+t]||(void 0!==n?n:"{#"+t+"}")}}function u(){var e={};function t(){return u()}return n("editor.controlManager.*"),r.tinymce.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),(function(n){e[n]=t})),e}}r.tinymce.util.Dispatcher=i,r.tinymce.onBeforeUnload=new i(r.tinymce,"BeforeUnload"),r.tinymce.onAddEditor=new i(r.tinymce,"AddEditor","editor"),r.tinymce.onRemoveEditor=new i(r.tinymce,"RemoveEditor","editor"),r.tinymce.util.Cookie={get:t,getHash:t,remove:t,set:t,setHash:t},r.tinymce.on("SetupEditor",(function(e){a(e.editor)})),r.tinymce.PluginManager.add("compat3x",a),r.tinymce.addI18n=function(e,t){var n=r.tinymce.util.I18n,o=r.tinymce.each;if("string"!=typeof e||-1!==e.indexOf("."))if(n.data=n.data||{},r.tinymce.is(e,"string"))if(r.tinymce.is(t,"string")){var i=e.split("."),a=i.shift(),c={};c[i.join()]=t,n.add(a,c)}else o(t,(function(t,r){n.data["".concat(e,".").concat(r)]=t;var o=e.split("."),i=o.shift();o.push(r);var a={};a[o.join(".")]=t,n.add(i,a)}));else o(e,(function(e,t){o(e,(function(e,r){o(e,(function(e,o){var i={};"common"===r?(n.data["".concat(t,".").concat(o)]=e,i[o]=e):(n.data["".concat(t,".").concat(r,".").concat(o)]=e,i["".concat(r,".").concat(o)]=e),n.add(t,i)}))}))}));else n.add(e,t)}},function(){r.tinymce.PluginManager.add("atlassiantheme",Yo)},function(){s("init.rte",T)},function(){r.tinymce.PluginManager.add("aePaste",re)},function(){r.tinymce.create("tinymce.plugins.ConfList",{init:function(e){e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function r(t){var r=n.getParent(t,n.isBlock);return r&&parseInt(e.dom.getStyle(r,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(r,"padding-left",!1)||0,10)>0}return r(t.getStart())||r(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}),r.tinymce.PluginManager.add("conflist",r.tinymce.plugins.ConfList)},function(){r.tinymce.PluginManager.add("tasklist",(function(e){var t=function(){var t=Le(e);t&&function(t){var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n}(t)&&function(e){return Array.from(e.childNodes).every((function(e){return e.hasAttribute("data-inline-task-id")}))}(t)&&e.undoManager.ignore((function(){t.classList.add("inline-task-list")}))},n=function(){return"page"!==U.get("content-type")&&"blogpost"!==U.get("content-type")&&"template"!==U.get("content-type")||e.undoManager.transact((function(){je(Le(e))&&(e.execCommand("InsertOrderedList"),He(Le(e))),function(e){var t=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":t,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select('[data-task-list-id="'.concat(t,'"]')).forEach((function(t){var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML='<span class="placeholder-inline-tasks">'.concat(ge("tinymce.confluence.placeholder.inline.tasks"),"</span>"),e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")}))}(e)})),!1};function o(t,n){if(!Ue()){var r=n.handlerManager,o=n.createHandler;r.registerHandler("]".charCodeAt(0),o(Me,(function(){e.execCommand("InsertInlineTaskList")}),!0))}}function i(){e.addQueryStateHandler("InsertInlineTaskList",(function(){return Fe(Le(e))})),e.addQueryStateHandler("InsertUnorderedList",(function(){return je(Le(e))}))}function a(t,n,r){if(Ue()){var o=e.dom.createFragment("");o.appendChild(r.node),Array.prototype.slice.call(o.querySelectorAll("ul.inline-task-list, ol.inline-task-list")).forEach((function(e){return He(e)}))}}e.addCommand("InsertInlineTaskListNoToggle",(function(){return Fe(Le(e))||n(),!1})),e.addCommand("InsertInlineTaskList",n),e.on("BeforeExecCommand",(function(t){"InsertUnorderedList"===t.command&&Fe(Le(e))&&!t.value?e.undoManager.ignore((function(){e.execCommand("InsertOrderedList"),He(Le(e))})):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore((function(){He(Le(e))}))})),e.on("execCommand",(function(e){"Indent"===e.command&&t()})),e.on("Click",(function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,i;if(r.tinymce.Env.gecko){var a=n.getBoundingClientRect();o=t.pageX-(a.left+r.tinymce.DOM.getViewPort(e.getWin()).x),i=t.pageY-(a.top+r.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,i=t.offsetY;return o>=3&&o<=14&&i>=3&&i<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}})),e.on("KeyUp",(function(t){if(t.keyCode===r.tinymce.util.VK.ENTER&&!t.shiftKey){var n=(o=e.selection.getStart())&&o.tagName&&"LI"===o.tagName.toUpperCase()?o:e.dom.getParent(o,"li");if(n){if(e.dom.removeClass(n,"checked"),!n.parentNode)return;e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id")}}var o})),e.on("KeyDown",(function(e){e.shiftKey||e.keyCode!==r.tinymce.util.VK.TAB||r.tinymce.util.VK.metaKeyPressed(e)||t()})),s("confluence.editor.registerHandlers",o),s("rte-ready",i),ee(r.document,"postPaste",a),e.on("Remove",(function(){f("confluence.editor.registerHandlers",o),f("rte-ready",i),te(r.document,"postPaste",a)}))}))},function(){s("init.rte",Ut)},function(){r.tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init:function(e){e.addCommand("mceDelete",(function(t,n){return function(){if(r.tinymce.Env.webkit){var t=e.selection.getRng();if(!t||t.collapsed)return!1;var n=l()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&x.isRangeAtStartOf(n,t)&&x.isRangeAtEndOf(n,t)){var o=l()(n.firstChild).is("pre")?"pre":"p",i=l()("<".concat(o,'><br data-mce-bogus="1"></').concat(o,">"))[0];return l()(n).html(i),e.selection.select(i,!0),!0}}return!1}()||e.getDoc().execCommand("Delete",t),!1}))},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("deletecommand",r.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e,t,n=(e=o.a.Raphael,t=new r.tinymce.util.Dispatcher,{AUIWindowManager:{init:function(e){e.on("init",(function(){e.windowManager=new r.tinymce.AUIWindowManager(e)}))},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0,n.tinymceWM=e.windowManager},open:function(e,t){var n=this;if(e.title===n.editor.translate("Accessibility Checker"))return n.tinymceWM.open(e,t);e=e||{},n.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n.features=e,n.params=t,n.eventDispatcher.dispatch("open",{t:n,settings:e,params:t});var o=e.height;e.name&&(o+=56),(t.cancelLink||t.buttons)&&(o+=51),o+=40,e.popup&&(o+=8);var i=e.id||r.tinymce.DOM.uniqueId(),a=(new Yn).component({width:e.width,height:o,id:i,onCancel:function(){a.hide().remove()}});e.name&&a.addHeader(this.editor.translate(e.name)),this.createDialogButtons(a,t,i),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(a,e,t,i),t.helpLink&&this.createHelpLink(a,t.helpLink,t.helpName,i),t.hintText&&this.createHintText(a,t.hintText,i);var c={id:i,settings:e,params:t,dialog:a};return this.modalDialogsStack.push(c),this.dialogs[i]=c,this.count++,ke(),a.show(),null!=a.takeFocus&&a.takeFocus(),i},initialiseSettings:function(e){e.width=parseInt((e.width||400).toString(),10),e.height=parseInt((e.height||250).toString(),10),e.resizable=!1,null==e.popup&&(e.popup=!0),e.popup&&null!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons:function(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var i=t.buttons[o];e.addButton(this.editor.translate("".concat(i.label)),i.action)}t.cancelLink&&e.addCancel(this.editor.translate("auiwindowmanager.cancel"),(function(){return r.tinymce.activeEditor.windowManager.close(n)}))},createDialogContent:function(e,t,n,r){var o=this.createContentId(r),i="panel_".concat(o);t.popup?(e.addPanel(i,l()('<iframe id="'.concat(o,'" width="100%" height="').concat(t.height,'px" frameborder="0" name="auidialogiframe" src="').concat(t.file,'" scrolling="').concat(t.scrollbars,'"></iframe>')),n.cssClass),e.takeFocus=function(){l()("#".concat(o)).focus()}):(null==t.content?(e.addPanel(i,l()('<div id="'.concat(o,'"/>')),n.cssClass),l()("#".concat(o)).load(t.file)):e.addPanel(i,l()('<div id="'.concat(o,'">').concat(t.content,"</div>")),n.cssClass),e.takeFocus=function(){var e=l()("#".concat(o,":input"));if(e.length)l()(e[0]).focus();else{var t=l()("#".concat(o," .button-panel button"));t.length&&l()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:function(e,t,n){var o=l()("<div></div>").addClass("dialog-tip");o.text(r.tinymce.activeEditor.translate("".concat(t))),l()("#".concat(n," .dialog-button-panel")).append(o)},createHelpLink:function(e,t,n,r){var o=l()("<div></div>").addClass("dialog-help-link");o.load("".concat(ye,"/plugins/tinymce/helplink.action"),{linkUrlKey:t,linkNameKey:n||""}),l()("#".concat(r," .dialog-components .dialog-title")).prepend(o)},close:function(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,r.tinymce.activeEditor.focus(),Se()),!1},alert:function(e,t,n){if("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."!==e){var o,i={content:"<p>".concat(e,"</p>"),width:500,height:160,popup:!1},a={buttons:[{label:"auiwindowmanager.ok",action:function(){r.tinymce.activeEditor.windowManager.toggleOtherDialogs(o,!0),r.tinymce.activeEditor.windowManager.close(o),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"};o=this.open(i,a),this.toggleOtherDialogs(o,!1)}},createInstance:function(e,t,n,o,i,a){return new(r.tinymce.resolve(e))(t,n,o,i,a)},toggleOtherDialogs:function(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var r=this.modalDialogsStack[n];r.id!=e&&l()("".concat(r.id," .dialog-button-panel")).toggle(t)}},confirm:function(e,t,n,r){r=r||o.a,t.call(n||this,r.confirm(this._decode(this.editor.translate(e))))},setBusy:function(t,n){var r=this.dialogs[t],o="#".concat(this.createBusyContentId(t)),i="#".concat(this.createContentId(t)),a=l()(i),c=l()(o);if(r)if(n){var u=l()(i);u.hide();var s=u.parent(),f=l()(o,s);f.length||(s.append(l()('<div id="'.concat(o,'" class="spinner"></div>'))),f=l()(o,s),e.spinner(f[0],50,"#666")),l()(".button-panel button",l()("#".concat(t))).each((function(e,t){l()(t).prop("disabled",!0)})),l()(f[0]).show()}else c.length&&c.hide(),l()(".button-panel button",l()("#".concat(t))).each((function(e,t){l()(t).prop("disabled",!1)})),a.show()},logMCESelection:function(e){r.tinymce.activeEditor.selection},setDefaultParameters:function(e){return e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e},createContentId:function(e){return"content_".concat(e)},createBusyContentId:function(e){return"content_busy_".concat(e)},resizeBy:function(){}}});r.tinymce.create("tinymce.plugins.AUIWindowManager",n.AUIWindowManager),r.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",n.WindowManager),r.tinymce.PluginManager.add("auiwindowmanager",r.tinymce.plugins.AUIWindowManager)},function(){var e;e=he(),r.Confluence.PropertyPanel.TextPlaceholder=e,s("init.rte",(function(){"template"===U.get("content-type")&&d("add-handler.property-panel",e)})),r.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",ve()),r.tinymce.PluginManager.add("textplaceholders",r.tinymce.plugins.TextPlaceholderPlugin)},function(){r.tinymce.create("tinymce.plugins.EmotionsPlugin",{init:function(e,t){e.addCommand("mceEmotion",(function(){return e.windowManager.open({file:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/emotions.action"),width:190,height:125,inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t}),!1})),e.ui.registry.addButton("emotions",{text:"emotions.emotions_desc",onAction:function(){e.execCommand("mceEmotion")}}),e.on("Click",(function(t){var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return(n=e.selection.getRng())&&((t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n)),e.selection.collapse(),r.tinymce.dom.Event.cancel(t)}))},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("emotions",r.tinymce.plugins.EmotionsPlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluencePlugin",{init:function(e){e.addCommand("mceConfUnlink",(function(t,n){var o=e.selection,i=n||o.getNode(),a=l()(i);if("A"!==i.nodeName){var c=a.closest("a");if(!c.length)return!1;i=c[0],a=c}var u,s,f=a.attr("href");if(f||(f="#",a.attr("href",f)),!a.attr("data-linked-resource-id")&&r.Confluence.Link.isExternalLink(f)&&a.text()==(null!=(s=/(.*)[\/]$/.exec(u=f))?s[1]:u)){var d=e.dom.create("span",{class:"nolink"},f);e.dom.replace(d,i,!1)}else o.select(i),a.removeClass("createlink unresolved"),e.execCommand("UnLink");return!1})),e.ui.registry.addButton("confimage",{text:"confluence.confimage_desc",onAction:function(){e.execCommand("mceConfimage")}}),e.ui.registry.addButton("conf_macro_browser",{text:"confluence.conf_macro_browser_desc",onAction:function(){e.execCommand("mceConfMacroBrowser")}})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluence",r.tinymce.plugins.ConfluencePlugin)},function(){var e;r.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",(e=r.tinymce.util.VK,{init:function(t){var n=this;function o(e){t.on("KeyDown",e),r.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function i(e,t){return e&&1===e.childNodes.length&&l()(e).is(t)&&l()(e.firstChild).is("br")}function a(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!l()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",(function(){t.on("SetContent",(function(e){e.selection&&r.tinymce.each(t.dom.select("p > .wysiwyg-macro"),(function(e){var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}}))}))})),t.on("SetContent",(function(){r.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),(function(e){t.dom.select("pre",e).length||(r.tinymce.isIE?t.dom.setHTML(e,"<pre></pre>"):t.dom.setHTML(e,"<pre><br /></pre>"))}))})),t.on("KeyDown",(function(n){var o=t.selection,i=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==l.a.inArray(n.keyCode,i)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=l.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!r.tinymce.isMac&&n.altKey)){var a=o.getNode();if(Pe.isMacroWithBody(a)){var c=l()(".wysiwyg-macro-body",a);c.length>0&&o.select(c[0],!0)}}})),t.on("DblClick",(function(e){var t=l()(e.target),n=t.closest("[data-macro-name]");if(n.length){if(n.attr("data-macro-body-type"))if(r.tinymce.isIE){if(!t.hasClass("wysiwyg-macro-body")&&!t.hasClass("wysiwyg-macro"))return}else if(t.closest(".wysiwyg-macro-body").length)return;Pe.editMacro(n),r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&r.Confluence.PropertyPanel.destroy()}})),t.addCommand("mceConfRemoveMacro",(function(e){l()(e).remove(),r.tinymce.isGecko&&t.execCommand("mceRepaint",!1)})),n._isCursorInMostNestedElement=a,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&t.previousSibling&&!t.nextSibling&&i(t,"p, pre")}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){var o=t.selection.getRng();if(46===n.keyCode&&o&&e(o))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInLastParagraphOrPre=e}(),r.tinymce.isWebKit&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return a(e)&&t&&1===t.childNodes.length&&l()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!l()(o).is("li")))||r.tinymce.dom.Event.cancel(e)})),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&0===e.startOffset&&l()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&l()(t.firstChild).is("br")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();return 8!==n.keyCode||!o||!e(o)||(t.execCommand("Outdent"),r.tinymce.dom.Event.cancel(n))})),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.previousSibling&&t.nextSibling&&i(t.nextSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(46!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=l()(i);if(e(o)){var c=i.nextSibling;return a.remove(),t.selection.select(c,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&i(t.previousSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(8!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=l()(i);if(e(o)){var c=i.previousSibling;return a.remove(),t.selection.select(c,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return!(!t||e.startOffset>0)&&(xe.normalize(t),t&&0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){return 8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng())?r.tinymce.dom.Event.cancel(n):void 0)})),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function c(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function u(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}function s(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!l()(o).closest(".wysiwyg-macro-body").size()||(xe.normalize(o),!(46===e.keyCode&&(i(n)||u(n))||8===e.keyCode&&(c(n)||s(n)))||(o.lastChild&&!l()(o.lastChild).is("br")&&l()(o).append("<br/>"),l()(o.firstChild).remove(),t.selection.select(o,!0),r.tinymce.dom.Event.cancel(e)))})),n._isCursorBehindOnlyCharacterInNestedElement=i,n._isCursorAfterOnlyCharacterInNestedElement=c,n._isCursorBehindOnlyChildInNestedElement=u,n._isCursorAfterOnlyChildInNestedElement=s}(),function(){function e(e){return!e.collapsed&&(0===e.startOffset&&i(e.startContainer,(function(e){return!e.previousSibling}))&&(t=e.endContainer,n=e.endOffset,!!t&&(3===t.nodeType?n===t.nodeValue.length:1===t.nodeType&&(1===t.childNodes.length&&l()(t.firstChild).is("br")?0===n:n===t.childNodes.length)))&&i(e.endContainer,(function(e){return!e.nextSibling})));var t,n}function i(e,t){if(!e)return!1;if(l()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!l()(e).is(".wysiwyg-macro-body"));return!0}r.tinymce.isWebKit&&o((function(n){if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng();if(o&&e(o)){var i=l()(o.startContainer).closest(".wysiwyg-macro-body");if(i.length>0){var a,c=l()(i[0].firstChild).is("pre");return t.undoManager.add(),i.empty(),a=c?l()("<pre><br/></pre>").appendTo(i):l()("<p><br/></p>").appendTo(i),t.selection.select(a[0],!0),r.tinymce.dom.Event.cancel(n)}}return!0})),n._isMacroBodySelected=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p")&&n.next().is("table")}r.tinymce.isWebKit&&o((function(n){if(46===n.keyCode&&e(t.selection.getRng()))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function i(e){return e?3===e.nodeType?e:i(e.firstChild)||i(e.nextSibling):null}function a(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:a(e.previousSibling)||a(e.parentNode):null}function c(e){var t,n;return l()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(a(e.startContainer)||(t=i(function e(t){return!t||l()(t.parentNode).is(".wysiwyg-macro td")?null:l()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=l()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(a(e.startContainer)||(t=i(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}r.tinymce.isWebKit&&r.tinymce.isMac&&o((function(n){var o=t.selection.getRng();if(o&&(n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var i=c(o);if(i!==o)return t.selection.setRng(i),r.tinymce.dom.Event.cancel(n)}})),n._selectTillStart=c}(),t.on("KeyDown",(function(e){if(e.keyCode===r.tinymce.util.VK.TAB){var n=t.selection.getRng();if(n){var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(l()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var i=t.getDoc().createTextNode("\t");return n.insertNode(i),t.selection.setCursorLocation(i,1),t.undoManager.add(),r.tinymce.dom.Event.cancel(e)}}}}))},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("macroplaceholder",r.tinymce.plugins.MacroPlaceHolderPlugin)},function(){ee(r.document,"initContextToolbars.Toolbar",(function(){ko().initContextToolbars(),function(e){var t={},n={},r=function(e,n){var r,o;for(o in t)if(t.hasOwnProperty(o)&&t[o].isEnabled)for(var i=0,a=t[o].events.length;i<a;i++)(r=t[o].events[i]).type.toLowerCase().indexOf(n.type)>-1&&(r.shouldTrigger(e,n)?r.callback.apply(this,[n.target]):r.missed&&r.missed())};return{addEventsForComponent:function(o,i){o in t||(t[o]={},t[o].events=[],t[o].isEnabled=!0);for(var a=function(a,c){var u;!(i[a].type in n)&&(n[i[a].type]=!0,e[i[a].type].add(r)),"function"!=typeof i[a].shouldTrigger&&(u=i[a].shouldTrigger,i[a].shouldTrigger=function(e,t){return t.target.tagName.toLowerCase()==u}),t[o].events.push(i[a])},c=0,u=i.length;c<u;c++)a(c)},disableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!1,!0;return!1},enableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!0,!0;return!1}}}(r.tinymce).addEventsForComponent("TableToolbar",er)}))},function(){Qn(),r.AJS.Rte=me()||{},r.AJS.Rte.TablePicker=Zn(),r.tinymce.create("tinymce.plugins.customtoolbar",ir()),r.tinymce.PluginManager.add("customtoolbar",r.tinymce.plugins.customtoolbar)},function(){r.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",Or),r.tinymce.PluginManager.add("insertwikimarkup",r.tinymce.plugins.InsertWikiMarkupPlugin)},function(){r.tinymce.create("tinymce.plugins.PropertyPanel",Be()),r.tinymce.PluginManager.add("propertypanel",r.tinymce.plugins.PropertyPanel)},function(){},function(){r.tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:function(e){e.addCommand("confMonospace",(function(){return e.formatter.toggle("monospace",void 0),!1})),e.on("Init",(function(){e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")})),e.ui.registry.addButton("monospace",{text:"monospace",onAction:function(){e.execCommand("confMonospace")}})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confmonospace",r.tinymce.plugins.ConfMonospacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfCharmapPlugin",{init:function(e){e.addCommand("confCharmap",(function(){return e.windowManager.open({id:"insert-char-dialog",url:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/charmap.action"),width:600,height:290,inline:!0,name:"advanced.charmap_desc"},{}),!1}))},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confcharmap",r.tinymce.plugins.ConfCharmapPlugin)},function(){var e=this,t=".wysiwyg-macro,.placeholder,table";r.tinymce.create("tinymce.plugins.CursorTargetPlugin",{init:function(n){var o=r.tinymce.util.VK;function i(e,n){l()(t,e).each((function(e,r){!function(e,n){var r=l()(e);function o(e){if(0===e.length)throw new Error("no paragraph element specified");ze()&&e.addClass("auto-cursor-target");var t=e[0];return 0===t.childNodes.length&&(t.innerHTML="<br />"),t}function i(e){return!l()(e).is("ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6")}function a(e,t){var n=l()("<p/>");if(l()(e.parentNode).is("li, td, th"))for(;e[t]&&i(e[t]);)n["previousSibling"==t?"prepend":"append"](e[t]);return o(n)}(!r.prev().length||r.prev(t).length||l()(e.parentNode).is("li, td, th")&&i(e.previousSibling))&&r.before(a(e,"previousSibling")),(!r.next().length||r.next(".synchrony-container").length||l()(e.parentNode).is("li, td, th")&&i(e.nextSibling))&&r.after(a(e,"nextSibling")),ze()&&r.next().length&&!r.next().next().length&&c(r.next()[0])&&r.next().addClass("auto-cursor-target"),n&&function(e){function n(e){("BR"===e[0].nodeName||c(e[0]))&&e.replaceWith(o(l()("<p/>")))}var r=e.prev();r.length&&function(e){for(var n=e.prev();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.prev()}return!0}(r)&&n(r);var i=e.next();i.length&&function(e){for(var n=e.next();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.next()}return!0}(i)&&n(i)}(r)}(r,n)}))}function a(e){return l()("p",e).each((function(e,t){c(t)&&u(t)&&l()(t).attr("data-tag","marked-for-deletion")})),l()("p[data-tag=marked-for-deletion]",e).remove(),e}function c(e){return 1===e.nodeType&&0===e.childNodes.length||function(e){for(var t=0,n=0,r=0,o=e.childNodes.length;r<o;r++){var i=e.childNodes[r];if("BR"===i.nodeName){if(++t>1)return!1}else if(/^[\s|\u00A0]$/.test(i.nodeValue)){if(++n>1)return!1}else if(""!==i.nodeValue)return!1}return!0}(e)}function u(e){if(!e||1!==e.nodeType)return!1;var n=m(e,!1),r=m(e,!0),o=d(n)||l()(n).is(t),i=d(r)||l()(r).is(t),a=d(n)&&d(r);return o&&i&&!a}function d(e){return!e||e.className&&/cell|header|footer/.test(e.className)}function m(e,t){var n=l()(e);do{var r=t?n[0].nextSibling:n[0].previousSibling;if(r)return r;n=n.parent()}while(n.length>0&&!n.is(".cell, .mceContentBody, td, li"));return null}function p(e){var t=e.startContainer;return 3===t.nodeType?!(t.previousSibling&&(3===t.previousSibling.nodeType||l()(t.previousSibling).is("br")))&&0===e.startOffset:1===t.nodeType&&0===e.startOffset}function g(e,t){return t.startContainer==t.endContainer&&1===t.startContainer.nodeType&&function(e,t){var n=t.startOffset;return e||n--,n>=0&&n<t.startContainer.childNodes.length&&"TABLE"===t.startContainer.childNodes[n].nodeName}(e,t)}function h(e){if(!e.collapsed)return!1;if(!function(e){for(var t=/^(TABLE|TR|TD)$/,n=e.startContainer;n&&n;){if(t.test(n.nodeName))return!0;n=n.parentNode}return!1}(e))return!1;var t,n=e.startContainer;if(3===n.nodeType)return t=m(n,!0),e.startOffset==n.nodeValue.length&&(null==t||l()(t).is("br"));if(1===n.nodeType){if(l()(n).is("td, th")&&0===e.startOffset&&n.childNodes.length>0)return l()(n.childNodes[0]).is("br");var r=0===e.startOffset?0:e.startOffset-1;return null==(t=m(n.parentNode.childNodes[r],!0))||l()(t).is("br")}return!1}function v(e){return e&&1===e.childNodes.length&&l()(e.childNodes[0]).is("br")}function b(e,t){return!!(t&&(r.tinymce.isWebKit&&g(!1,t)||r.tinymce.isGecko&&(h(t)||u(e)&&0===t.startOffset&&v(e))))}function y(e,t){return!!(t&&(r.tinymce.isWebKit&&(g(!0,t)||p(t)&&u(e)||function(e){var t=n.getBody();return!!t.childNodes.length&&e.collapsed&&0===e.startOffset&&t.childNodes[0]==e.startContainer}(t))||r.tinymce.isGecko&&p(t)&&u(e)&&v(e)))}function w(e){var t=e.keyCode;return t!==o.BACKSPACE&&t!==o.DELETE||(n.selection.isCollapsed()?(t===o.BACKSPACE&&y(n.selection.getNode(),n.selection.getRng())||t===o.DELETE&&b(n.selection.getNode(),n.selection.getRng()))&&r.tinymce.dom.Event.cancel(e):i(n.getBody())),!0}var C=function(){i(n.getBody(),!0)},x=function(e){i(e,!1),r.tinymce.isIE10&&function(e){l()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,t){(function(e){return e&&""===e.innerHTML})(t)&&l()(t).html("<br />")}))}(e)};function k(){x(n.getBody())}ze()?(s("cursor-target-refresh",k),n.on("Remove",(function(){f("cursor-target-refresh",k)}))):(n.on("SetContent",(function(){var e,t;i(n.getBody()),e=n.getBody(),t=r.tinymce.isIE?"&nbsp;":"<br/>",l()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,n){(function(e){return e&&e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0)})(n)&&l()(n).html(t)}))})),n.on("GetContent",(function(e){if(""!==e.content){var t="<div class='root-node'>"+e.content+"</div>",r=a(l()(t)),o=l.a.extend({},e,{getInner:!1}),i=n.serializer.serialize(r[0],o);e.content=i.substring("<div class='root-node'>".length,i.length-"</div>".length)}})),n.on("init",(function(){n.dom.events.bind(n.selection,"SetContent",C),n.dom.events.bind(n.getBody(),"cut",C),s("cursor-target-refresh",C)})),n.on("Remove",(function(){f("cursor-target-refresh",C)})),r.tinymce.isGecko&&n.on("KeyDown",(function(e){e.keyCode!==o.ENTER&&e.keyCode!==o.BACKSPACE&&e.keyCode!==o.DELETE||n.selection.normalize()})),n.on("KeyDown",w),n.on("KeyUp",w),r.tinymce.isGecko&&n.on("KeyPress",w),n.on("Paste",C)),l.a.extend(e,{isCursorBeforeAfterTable:g,isCursorTarget:u,_isTextContainerEmpty:c,_removeCollaborativeEditorCursorTargets:function(e){var t=l()("<div>");return t.html(e),t.find("p.auto-cursor-target").each((function(e,t){t.remove()})),t.html()},_processCursorTargets:a,_isCursorAtStartOfContainer:p,_isCursorAtEndOfContainer:function(e){var t=e.startContainer;if(3===t.nodeType)return!(t.nextSibling&&(3===t.nextSibling.nodeType||l()(t.nextSibling).is("br")))&&e.endOffset==t.nodeValue.length;if(1===t.nodeType){var n=t.childNodes[e.startOffset];return!(!l()(n).is("br")||null!=n.nextSibling)||e.endOffset==t.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:m,_doesContainerHaveNestedContent:function e(t){var n,r=l()(t).children();for(n=0;n<r.length;n++)if(!c(r[n])&&(l()(r[n]).contents().filter((function(){return 3===this.nodeType})).length||e(r[n])))return!0;return!1},_addCursorTargetParagraphsToContent:i,_isCursorAtEndOfBottomRightCellInTable:h,_shouldCancelDelete:b,_shouldCancelBackspace:y,_collabEditingCursorTargetRefresh:x}),r.AJS.Rte.Cursor=me().Cursor||{},l.a.extend(r.AJS.Rte.Cursor,{isTextContainerEmpty:c,fixCursorTargets:i})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}),r.tinymce.PluginManager.add("cursorTarget",r.tinymce.plugins.CursorTargetPlugin)},function(){r.tinymce.create("tinymce.plugins.iOSEditing",{init:function(e){r.tinymce.Env.iOS&&setTimeout((function(){l()(e.getBody()).addClass("ios")}),0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("iosediting",r.tinymce.plugins.iOSEditing)},function(){r.tinymce.create("tinymce.plugins.aeTable",Tt()),r.tinymce.PluginManager.add("aeTable",r.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",(function(n){t.cleanLinks(e)})),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,r=n.parser[n.strictMode?"strict":"loose"].exec(e),o={},i=14;i--;)o[n.key[i]]=r[i]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,(function(e,t,r){return t&&(o[n.q.name][t]=r),""})),o}e.prototype={addHandler:function(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort((function(e,t){return e.weight-t.weight})),this.handlers=[];for(var n=this.weightedHandlers.length,r=0;r<n;r++)this.handlers.push(this.weightedHandlers[r].handler)},cleanLinks:function(e){return l()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0},callHandlers:function(e){var i=0,a=this,c=l()(e),u=l()(e).clone(),s=u.attr("href"),f=t(n(s));function d(e){if(e&&(1!==e.length||!e.attr("href")))return p(e);if(e)i=0,f=t((u=e).attr("href")),m(a.handlers[i],f,u);else{if(!(++i<a.handlers.length))return p(u);m(a.handlers[i],f,u)}}function m(e,t,n){var i,c=d;i=o.a.setTimeout((function(){c=function(){0},d()}),r.tinymce.plugins.Autoconvert.callbackTimeout),e(t,n,(function(){clearTimeout(i),c.apply(a,arguments),c=function(){0}}))}function p(e){a.editor.undoManager.beforeChange();var t=a.editor.selection,n=a.editor.selection.getBookmark();c.replaceWith(e),t.moveToBookmark(n),a.editor.undoManager.add()}0!==this.handlers.length&&m(this.handlers[0],f,u)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var r={macro:e,contentId:U.get("content-id")};l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,r){var o=["{",t.name],i=!0;for(var a in t.defaultParameterValue&&(o.push(":",t.defaultParameterValue),i=!1),t.params)i?(o.push(":"),i=!1):o.push("|"),o.push(a,"=",t.params[a]);o.push("}"),e.getHtmlFromWikiMarkup(o.join(""),(function(e){n(l()(e)[0])}),(function(){r()}))},e.getHtmlFromWikiMarkup=function(e,t,n){var r={wiki:e,entityId:U.get("content-id"),contextType:U.get("content-type"),spaceKey:U.get("space-key")};l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")},i={init:function(t){var n=new e(t);function o(e,r,o){var i=l()(o.node).children("a");1===i.length&&"A"===i[0].tagName&&i.text()===i.attr("href")&&(i.attr("class","atlassian-autoconvert"),setTimeout((function(){var e=l()("a.atlassian-autoconvert",l()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)}),0))}r.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",(function(){l()(document).on("postPaste",o),t.addCommand("addAutoconverter",(function(e,t){return n.addHandler(t),!1}))})),t.on("remove",(function(){l()(document).off("postPaste",o)}))},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}};return{autoConverter:e,plugin:i}}();r.tinymce.plugins.Autoconvert=e.autoConverter,r.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),r.tinymce.PluginManager.add("autoconvert",r.tinymce.plugins.AutoconvertPlugin),Ft()},function(){s("rte-ready",jt.initializeEditor)},function(){r.tinymce.create("tinymce.plugins.draggable",Ht()),r.tinymce.PluginManager.add("draggable",r.tinymce.plugins.draggable)},function(){r.tinymce.create("tinymce.plugins.InsertFiles",{init:function(e){e.ui.registry.addButton("confluence-insert-files",{text:ge("tinymce.confluence.files"),tooltip:"".concat(ge("tinymce.confluence.conf_file_desc")," (").concat(e.translate("toolbar.insert_files_shortcut_tooltip"),")"),className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-image",locationGroup:"rte-toolbar-group-files",weight:0,onAction:function(){e.execCommand("mceConfimage")}})},getInfo:function(){return{longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}),r.tinymce.PluginManager.add("insertfiles",r.tinymce.plugins.InsertFiles)},function(){var e,t,n;r.tinymce.create("tinymce.plugins.flextofullsizeplugin",(n=function(){var e=l()("#wysiwyg").is(":hidden")?l()("#preview"):l()("#wysiwyg");t=e.find("iframe");var n=l()("#header-precursor"),r=l()(o.a).height(),i=n.offset().top+n.height()+l()("#header").height();l()("#content.edit").height(r-i),setTimeout((function(){if(l()("#preview").is(":hidden"))t.height(0).height(e.height());else{l()("#content.edit").height("auto");var n=l()("#savebar-container").height();i+=l()("#editor-precursor").height(),t.height(r-i-n-4)}}),1)},{init:function(t){t.on("Init",(function(){var o,i;l()(t.getBody()).addClass("fullsize");var a=r.tinymce.Env;(a.ie||a.opera)&&(o=t.getWin(),e=l()(o.parent),i=l()(o.parent.document),l()("body").css({overflow:"hidden"}),e.bind("resize.resizeplugin",(function(){n()})),i.bind("messageClose",(function(){setTimeout(n,0)})),i.bind("resize.resizeplugin",(function(){n()})),i.bind("mode-changed",(function(){n()})),t.on("Change",(function(){n()})),n())}))},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("flextofullsize",r.tinymce.plugins.flextofullsizeplugin)},function(){r.tinymce.create("tinymce.plugins.Referrer",{init:function(e){e.on("Init",(function(){var e=l()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)}))},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("referrer",r.tinymce.plugins.Referrer)},function(){var e,t;r.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",(e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>",{init:function(n){function r(){l()(n.dom.select("table.confluenceTable:not(.".concat("wrapped",")"))).each((function(n,r){l()(r).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each((function(n,r){var o=l()(r);!o.find("> .content-wrapper").length&&o.find(e).length&&o.wrapInner(t)}))}))}s("rte-ready",r),n.on("Remove",(function(){f("rte-ready",r)})),n.on("Change",(function(){var r=n.selection;function o(){return r.getBookmark()}function i(e){r.moveToBookmark(e),ke()}var a=r.getNode(),c=l()(a);if(a&&c.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=r.getRng();if(e.is("tr")&&t&&l()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),o=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(o,0),t.setEnd(o,0),r.setRng(t)}}(c);var u,s=c.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(s.find(e).length){var f=s.find("> .content-wrapper");f.length?(u=o(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(f),i(u)):s.find("> p").length?(u=o(),s.wrapInner(t),i(u)):(u=o(),s.wrapInner("<p/>").wrapInner(t),i(u))}}l()(n.getWin().document).find(".content-wrapper:empty").remove()}))},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("tableContentWrapper",r.tinymce.plugins.TableContentWrapperPlugin)},function(){var e;r.tinymce.create("tinymce.plugins.LinkBrowser",(e=r.Confluence.Editor.LinkBrowser,{init:function(t){t.ui.registry.addButton("linkbrowserbutton",{text:"confluence.conflink_desc",className:"mce_conflink",onAction:function(){t.execCommand("mceConflink")}}),t.addCommand("mceConflink",(function(){return e.open({bookmarkManager:_e}),!1})),t.addCommand("mceConfAttachments",(function(){return e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:_e}),!1}))},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}})),r.tinymce.PluginManager.add("linkbrowser",r.tinymce.plugins.LinkBrowser)},function(){r.tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init:function(e){e.on("Init",(function(){var e=U.get("version-comment");l()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" '.concat(t?'value="'.concat(t,'"'):"",'\n           placeholder="').concat(e("editor.change.comment"),'"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">').concat(e("editor.change.comment"),"</label>\n</span>\n")}((function(e){return ge(e)}),e))}))},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluenceversioncomment",r.tinymce.plugins.ConfluenceVersionComment)},function(){r.tinymce.PluginManager.add("autocomplete",ro)},function(){},function(){r.tinymce.PluginManager.add("autocompletelink",uo)},function(){r.tinymce.create("tinymce.plugins.AutoCompleteMacro",fo()),r.tinymce.PluginManager.add("autocompletemacro",r.tinymce.plugins.AutoCompleteMacro)},function(){r.tinymce.PluginManager.add("autocompletemedia",xo)},function(){E("confluence-table-enhancements.sticky-headers.disabled")||l()(document).ready(Zt),E("confluence-table-enhancements.sticky-headers-editor")&&(s("rte-ready",tn),s("rte-quick-edit-push-state",tn),s("rte-quick-edit-push-hash",tn))},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",nn),r.tinymce.PluginManager.add("confluenceleavecomment",r.tinymce.plugins.ConfluenceLeaveComment)},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",rn),r.tinymce.PluginManager.add("confluenceleavetemplate",r.tinymce.plugins.ConfluenceLeaveTemplate)},function(){r.Confluence.Editor.SearchManager=fn(),dn(),r.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",mn()),r.tinymce.PluginManager.add("searchreplace",r.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluenceDrafts",on()),r.tinymce.PluginManager.add("confluencedrafts",r.tinymce.plugins.ConfluenceDrafts)},function(){var e=function(e){return!!e.querySelector(".contentLayout, .contentLayout2")},t=function(e){return Array.from(e.querySelectorAll(".contentLayout2 .columnLayout.single"))},n=function(e,t){e.undoManager.ignore((function(){t.forEach((function(t){return t.appendChild(function(e){return e.dom.create("div",{class:"pagelayout-delete-stub synchrony-exclude",style:"display:none;",contenteditable:"true"},".")}(e))}))}))},o=function(e,t){var n=Array.from(t.querySelectorAll(".pagelayout-delete-stub"));e.undoManager.ignore((function(){n.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)}))}))};s("rte-ready",(function(){var i=r.tinymce.activeEditor,a=i.getDoc(),c=i.getBody();c.addEventListener("keydown",(function(r){if((8===r.keyCode||46===r.keyCode)&&e(a))if(i.dom.isEmpty(i.getBody()))r.stopImmediatePropagation();else{var o=t(a);o.length>0&&(n(i,o),r.stopImmediatePropagation())}}),!0),c.addEventListener("keyup",(function(t){8!==t.keyCode&&46!==t.keyCode||!e(a)||o(i,a)}),!0),i.on("beforeExecCommand",(function(r){if("delete"===r.command&&e(a)){var o=t(a);o.length>0&&n(i,o)}})),i.on("ExecCommand",(function(t){"delete"===t.command&&e(a)&&o(i,a)})),i.on("BeforeGetContent",(function(){o(i,a)}))}))},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",an),r.tinymce.PluginManager.add("confluencemacrobrowser",r.tinymce.plugins.ConfluenceMacroBrowser)},function(){r.tinymce.PluginManager.add("statusmacro",jo),r.Confluence.PropertyPanel.Macro.registerInitHandler((function(e,t){var n,o;Eo=e,function(e){var t=function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf("macro-placeholder-property-panel-edit-button")>-1)return e[t];return null}(e),n=function(e){Pe.editMacro(e)};t&&(t.click=function(){r.Confluence.PropertyPanel.destroy(),Io()?To.always(n):n(Eo)})}(t),_o=r.Confluence.MacroParameterSerializer.deserialize(l()(Eo).attr("data-macro-parameters")),Ao=null,t.splice(1,0,(n=(o=_o).title||Mo(o),{className:"status-macro-title first last editable",text:Et(n),click:Fo}))}),"status"),l.a.each(Oo,(function(e,t){r.Confluence.PropertyPanel.Macro.registerButtonHandler(t,(function(){_o.colour=t,r.Confluence.PropertyPanel.destroy()}),"status")})),s("destroyed.property-panel",(function(){Io()&&Bo()}))},function(){},function(){},function(){},function(){r.AJS.MacroBrowser.Macros.code=Dr},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceWatch",cn),r.tinymce.PluginManager.add("confluencewatch",r.tinymce.plugins.ConfluenceWatch)},function(){r.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",un),r.tinymce.PluginManager.add("confluencesortabletablesplugin",r.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){r.tinymce.create("tinymce.plugins.AutoResizePlugin",ln),r.tinymce.PluginManager.add("autoresize",r.tinymce.plugins.AutoResizePlugin)},function(){},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",wn),r.tinymce.PluginManager.add("confluencenotifywatchers",r.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){r.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",(function(e,t){for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),o={},i=0;i<n.length;i++){var a=n[i].split("=");a.length>1&&(o[a[0]]=a[1])}var c=U.get("page-id"),u=U.get("content-type");function l(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n="".concat(n).concat(e,"=").concat(encodeURI(t))),n}o.space||(o.space=U.get("space-key"));var s=U.get("context-path")+"/plugins/servlet/oc/getattachment?";s=l("title",o.page,s),s=l("date",o.date,s),s=l("space",o.space,s),s=l("filename",o.name,s),s=l("contextid",c,s),s=l("contexttype",u,s);var f=r.tinymce.Env.ie?"_blank":"download-office-attachment",d=window.open(s,f);d&&d.opener&&(d.opener=null)})),So()},function(){s("rte-ready",(function(){!function(){Object(r.clearTimeout)($e),$e=Object(r.setTimeout)(et,6e4);r.tinymce.activeEditor.on("ExecCommand",(function(e){var t,n="mceToggleFormat"===e.command?(t=e.value).charAt(0).toUpperCase()+t.slice(1):e.command;Ze(tt[n])})),r.tinymce.activeEditor.on("KeyPress",(function(){Ze("keys")})),r.tinymce.activeEditor.on("KeyUp",(function(e){46===e.keyCode?Ze("delete",Qe):8===e.keyCode&&Ze("backspace",Qe),Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("MouseUp",(function(){Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("PastePostProcess",(function(e){var t=e&&e.node?e.node.innerText||e.node.textContent:"";Ze("paste",t.length)})),r.tinymce.activeEditor.on("Remove",(function(){et(),Object(r.clearTimeout)($e)}))}(),o.a.addEventListener("beforeunload",(function(){et()}))}))},function(){r.tinymce.create("tinymce.plugins.TableAnalytics",En),r.tinymce.PluginManager.add("tableAnalytics",r.tinymce.plugins.TableAnalytics)},function(){s("init.rte",Ir)},function(){s("init.rte",(function(){te(r.document,"postPaste",_n),ee(r.document,"postPaste",_n),r.tinymce.activeEditor&&r.tinymce.activeEditor.on("Remove",(function(){te(r.document,"postPaste",_n)}))}))},function(){r.tinymce.create("tinymce.plugins.ConfIndentation",An),r.tinymce.PluginManager.add("confindentation",r.tinymce.plugins.ConfIndentation)},function(){},function(){r.tinymce.create("tinymce.plugins.TextPatternPlugin",On),r.tinymce.PluginManager.add("aetextpattern",r.tinymce.plugins.TextPatternPlugin)},function(){r.tinymce.Env.gecko&&s("rte-ready",Kn)},function(){12===r.tinymce.Env.ie&&s("rte-ready",Kn)},function(){r.tinymce.create("tinymce.plugins.PersistScrollPosition",jn),r.tinymce.PluginManager.add("persit_scroll_position",r.tinymce.plugins.PersistScrollPosition)},function(){r.tinymce.create("tinymce.plugins.templateeditor",Hn),r.tinymce.PluginManager.add("templateeditor",r.tinymce.plugins.templateeditor)},function(){r.tinymce.PluginManager.add("preserve-paragraph-formatting-on-delete",(function(e){return e.on("KeyDown",(function(t){!function(e,t){var n,o,i=r.tinymce.VK,a=i.BACKSPACE,c=i.DELETE,u=e.selection.getNode(),l=u.nextSibling;if(e.selection.isCollapsed()&&u!=e.dom.getRoot())if(t.keyCode===a){if(n=e.selection,(o=n.getRng())&&0===o.startOffset){var s=u.previousSibling;s&&zn(s)&&(Wn(e,s),r.tinymce.dom.Event.cancel(t))}}else if(t.keyCode==c){if(Un(u).length<=1||u.childNodes.length>1)return;l&&zn(u)&&(Wn(e,u),r.tinymce.dom.Event.cancel(t),function(e,t){var n=e.selection,r=n.getRng();e.focus(!1),t.focus(),r&&(r.setStart(t,0),r.setEnd(t,0),n.setRng(r))}(e,l))}}(e,t)})),{getMetadata:function(){return{name:"Preserve paragraph formatting when deleting empty line",author:"Atlassian",url:"http://www.atlassian.com"}}}}))},function(){r.tinymce.create("tinymce.plugins.macroNavigation",qn),r.tinymce.PluginManager.add("macroNavigation",r.tinymce.plugins.macroNavigation)},function(){r.tinymce.PluginManager.add("a11ychecker-helper",oi)}],ai=function(){return ii.forEach((function(e,t){try{e()}catch(n){v("initError",{fnName:e.name||t,message:n.message||"",exceptionName:n.name||""})}})),!0},ci=function(){return new Promise((function(e){!function(e,t){e.listener;var n=e.globalProperty,r=e.interval,o=void 0===r?250:r;if(c(n))return t(),null;var i=setInterval((function(){c(n)&&(clearInterval(i),t())}),o)}({listener:"editor-plugins/index",globalProperty:"AJS.Confluence.PropertyPanel.Macro",interval:20},(function(){e()}))}))},ui=!1,li=function(){if(ui)return v("initError",{message:"Editor was loaded already, stop re-running init phase"}),Promise.reject();var e=o.a.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.macrobrowser=Oe,$n(),r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.NodeUtils=Ce,r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.MacroUtils=De,Jn(),y.a.EditorUtils=C,y.a.Rte=y.a.Rte||{},y.a.Rte.Cursor=y.a.Rte.Cursor||{},l.a.extend(y.a.Rte.Cursor,{insertParagraph:S,isCursorAtStart:k,isCursorAtEnd:x.isCursorAtEnd}),ui=!0,E("confluence.editor.a11ychecker")?Promise.all([ci(),a("wrm/require")("com.atlassian.confluence.plugins.confluence-editor-v4:editor-a11ychecker-plugin")]).then(ai):ci().then(ai)},si=!1,fi="",di={},mi={},pi=function(){si&&(d("analytics",function(){for(var e={},t={name:fi,data:e},n=gi.getEntriesByType("measure"),r=0;r<n.length;r++){var o=n[r],i=o.name;di[i]&&(e["".concat(i,".startTime")]=o.startTime,e["".concat(i,".duration")]=o.duration)}return t}()),si=!1)};var gi=o.a.performance,hi=function(e){return"".concat(e,".start")};function vi(e){!function(e){if(gi&&gi.mark&&di[e]){si||(si=!0);var t=hi(e);gi.mark(t)}}(e)}function bi(e){!function(e){if(gi&&gi.mark&&di[e]){var t=hi(e);if(0!==gi.getEntriesByName(t,"mark").length){var n=function(e){return"".concat(e,".end")}(e);gi.mark(n),gi.measure(e,t,n),mi[e]&&pi()}else o.a.console.warn("Calling debugTimeEnd for ".concat(e," before debugTime"))}}(e)}var yi={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"},wi=function(e,t,n){!1===t&&function(e,t){Array.prototype.forEach.call(r.document.getElementById(e).querySelectorAll(t),(function(e){e.style.display="none"}))}(e,n)};function Ci(e){return(e=e&&e.jquery?e[0]:e)?("BR"!==e.tagName&&3!==e.nodeType||(e=e.parentNode),e&&9===e.nodeType&&(e=null),e):null}var xi={};xi.Rte={HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return r.tinymce.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var e=r.document.location;this.currentBaseUrl="".concat(e.protocol,"//").concat(e.hostname).concat(e.port?":".concat(e.port):"")}return this.currentBaseUrl},showSelection:function(e){me().showElement(r.tinymce.activeEditor.selection.getStart(),e)},isAnyPartShown:function(e){var t=Ci(e);if(!t)return!1;var n=l()(t),r=n.offset().top,o=r+n.outerHeight(),i=l()(me().getEditor().getDoc()).scrollTop(),a=i+l()(me().getEditorFrame()).height();return o>i&&r<a},showElement:function(e,t){var n=Ci(e);if(n){var r=l()(n),o=me().getEditor(),i=l()(o.getDoc()),a=r.offset().top,c=a+r.outerHeight(),u=i.scrollTop(),s=u+l()(me().getEditorFrame()).height(),f=function(){me().bindScroll("AJS.Rte.showElement",(function(){me().unbindScroll("AJS.Rte.showElement"),setTimeout(t,1)}))};a<u?(me().scrollTo(a),t&&f()):c>s?(me().scrollTo(Math.min(a,u+c-s)),t&&f()):t&&t()}},scrollTo:function(e){var t=me().getEditor();e=Math.ceil(e),l()(t.getDoc()).scrollTop(e)},bindScroll:function(e,t){var n=me().getEditor();l()(r.document).add(n.getDoc()).add(n.getWin()).bind("scroll.".concat(e),t)},unbindScroll:function(e){var t=me().getEditor();l()(r.document).add(t.getDoc()).add(t.getWin()).unbind("scroll.".concat(e))},getMainEditor:function(){var e=r.tinymce.EditorManager.editors[me().editorId];if(!e)throw new Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return e},getEditorContainer:function(){return r.document.getElementById("wysiwyg")},getEditorFrame:function(){return r.document.getElementById("".concat(me().getEditor().id,"_ifr"))},getEditorTable:function(){return r.document.getElementById("".concat(me().getEditor().id,"_tbl"))},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){return this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+U.get("editor-plugin-resource-prefix")),this.resourceUrlPrefix},getTinyMceBaseUrl:function(){return this.absoluteUrl||(this.absoluteUrl="".concat(this.getResourceUrlPrefix()+this.webResourcePath,"tinymcesource/")),this.absoluteUrl},getMinEditorHeight:function(){return+U.get("min-editor-height")},getTinyMceEditorMinHeight:function(e){e=e||0;var t=me().getMinEditorHeight(),n=0;return t||(Array.prototype.forEach.call(r.document.querySelectorAll("#editor-precursor,#header-precursor,#header"),(function(e){n+=l()(e).outerHeight(!0)})),l()(o.a).height()-n-e)},fixEditorFocus:function(){0},editorFocus:function(e){if(e&&!e.destroyed){var t,n=(t=e.dom.getRoot(),r.tinymce.isWebKit&&!l()(t).parents("body").length&&(t=l()(e.getBody()).find("p:first-child")[0]),t);n&&(e.selection.select(n,!0),e.selection.collapse(!0),n.focus()),e.getBody().focus(),e.getWin().focus()}}},xi.KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91};var ki=xi;function Si(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ti(e,t,n[t])}))}return e}function Ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ei=function(){void 0===r.AJS.Rte&&(r.AJS.Rte=Si({},ki.Rte)),void 0===r.AJS.Rte.getEditor&&(r.AJS.Rte=Si({},r.AJS.Rte,ki.Rte))},_i=n("com.atlassian.confluence.plugins.confluence-frontend:locale/require('confluence/locale')");function Ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ni(e,t,n[t])}))}return e}function Ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Oi,Di=!1,Ii={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return Ii._tinyMceHasInit},isEditorActive:function(){return!!(Ii.isInitComplete()&&r.tinymce&&r.tinymce.activeEditor)},onInit:function(){Ii._tinyMceHasInit=!0;var e=r.AJS.Rte.getEditor();if(e.getBody().classList.add("notranslate"),d("init.rte",{editor:e}),!1!==U.get("editor-auto-focus")){var t=r.document.getElementById("content-title");t&&""===t.value?t.focus():r.AJS.Rte.editorFocus(e)}else 0},addOnInitCallback:function(e){if("function"!=typeof e)throw new Error("Attempt made to register an oninit callback that is not a function. Received: ".concat(e));Ii._tinyMceHasInit?e():s("init.rte",e)},addBeforeInitCallback:function(e){Ii._beforeInitCallbacks.push(e)},addTinyMcePluginInit:function(e){Ii._tinymcePluginInits.push(e)},preInitialise:function(e){Ii._settings=e,Di&&(Di=!1,Ii.initialise(Oi))},initialise:function(e){if(vi("confluence.editor.tinymce"),!Ii._settings)return Di=!0,void(Oi=e);e=Ai({},e);var t,n,o,i,c=Ai({},Ii._settings);r.AJS.Rte.isQuickEdit=e.isQuickEdit||!1,Ii._beforeInitCallbacks.forEach((function(e){e(c)})),d("rte-pre-resolveplugins");for(var u=0,l=Ii._tinymcePluginInits.length;u<l;u++)"function"==typeof Ii._tinymcePluginInits[u]&&Ii._tinymcePluginInits[u](c);!function(e){var t=a("confluence-editor/i18n/translations.i18n"),n=a("wrm/require"),o={cs:"cs-CZ",da:"da-DK",de:"de-DE",es:"es-ES",fi:"fi-FI",fr_FR:"fr-FR",it:"it-IT",hu_HU:"hu-HU",ja:"ja-JP",ko_KR:"ko-KR",nl:"nl-NL",nb_NO:"no-NO",pl:"pl-PL",pt_BR:"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sv_SE:"sv-SE",zh_CN:"zh-CN"},i=r.tinymce.EditorManager.addI18n;r.tinymce.EditorManager.addI18n=function(e,t){o.hasOwnProperty(e)?i(Object(_i.getUserLocale)(),t):i(e,t)},Object.values(o).includes(e)&&n("com.atlassian.confluence.editor:editor-a11ychecker-i18n-"+e),Ri(t);var c=new RegExp("".concat(t.ctrl_key,"\\+"),"g"),u=new RegExp("".concat(t.shift_key,"\\+"),"g"),l=function(e){return e.replace(c,"").replace(u,"")};for(var s in t){var f=t[s];if("object"===Ri(f))for(var d in f)r.tinymce.Env.mac&&(f[d]=l(f[d]));r.tinymce.EditorManager.addI18n("".concat(e,".").concat(s),t[s])}r.tinymce.ScriptLoader.markDone("".concat(r.tinymce.baseURL,"/langs/").concat(e,".js")),r.tinymce.Env.mac&&Array.prototype.forEach.call(r.document.querySelectorAll("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button"),(function(e){var t=e.getAttribute("title"),n=e.dataset.tooltip;t&&e.setAttribute("title",l(t)),n&&(e.dataset.tooltip=l(n))}))}(c.locale),function(e,t){var n;if(!1!==t)for(n in t=t||{})t.hasOwnProperty(n)&&yi[n]&&wi(e,t[n],yi[n]);else r.document.getElementById(e).style.display="none"}("toolbar",e.toolbar),c.plugins=(t=c.plugins,n="string"==typeof e.plugins?e.plugins.split(","):e.plugins||[],o=e.excludePlugins||[],i=t.split(","),n.forEach((function(e){i.indexOf(e)<0&&i.push(e)})),(i=i.filter((function(e){return o.indexOf(e)<0}))).join(",")),c.setup=function(t){t.on("PreInit",(function(){t.dom.loadCSS=function(){}})),e&&"function"==typeof e.onInitialise&&e.onInitialise(t)},c.init_instance_callback=function(e){var t=ze();Ei(),r.tinymce.FocusManager.isEditorUIElement=function(e){for(var t=e,n=!1;t;){if("rte-toolbar"===t.id){n=!0;break}t=t.parentElement}return n};try{var n=c.contentCssTags,o=e.getDoc().querySelectorAll("head");if(void 0===o[0])throw"No editor <head>";o[0].innerHTML=n+o[0].innerHTML}catch(e){}r.AJS.Rte.BootstrapManager.onInit(e),Vn.editorResetContentChanged(),r.AJS.Rte.getEditorFrame().setAttribute("tabindex",100),r.tinymce.isIE&&r.AJS.Rte.getEditorFrame().setAttribute("hidefocus","hidefocus"),t&&e.on("AddUndo",(function(t){var n={level:null,lastLevel:null,originalEvent:t};return e.fire("change",n)})),bi("confluence.editor.tinymce"),d("rte-ready"),t&&d("rte-begin-collab-editing"),We()&&e.getBody().classList.add("page-edit")},r.tinymce.IconManager.add("default",{icons:{}}),r.tinymce.IconManager.add("atlassian",{icons:{"accessibility-check":'<svg width="18" height="18"><path fill-rule="nonzero" d="M9 1c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm6 7h-3v8a1 1 0 01-2 0v-3a1 1 0 00-2 0v3a1 1 0 01-2 0V8H3a1 1 0 110-2h12a1 1 0 010 2z"/></svg>',"action-next":'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M17.257 10.473l-4.548 4.558a1 1 0 01-1.415.001l-4.55-4.56A1.051 1.051 0 118.23 8.984l.001.001 3.77 3.776 3.768-3.776a1.05 1.05 0 011.486 0h.001c.411.41.411 1.076.001 1.488" id="i3-a"/></defs><use xlink:href="#i3-a" fill-rule="evenodd"/></svg>',"action-prev":'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11.294 8.968l-4.55 4.56a1.051 1.051 0 101.486 1.488l.001-.001 3.77-3.776 3.768 3.776a1.05 1.05 0 001.486 0h.001a1.054 1.054 0 00.001-1.488L12.71 8.969a1 1 0 00-1.415-.001z" id="i5-a"/></defs><use xlink:href="#i5-a" fill-rule="evenodd"/></svg>',checkmark:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M12 21a9 9 0 110-18 9 9 0 010 18zm-2.293-9.707a1 1 0 10-1.414 1.414l2 2a1 1 0 001.414 0l4-4a1 1 0 10-1.414-1.414L11 12.586l-1.293-1.293z" id="i7-a"/></defs><use xlink:href="#i7-a" fill-rule="evenodd"/></svg>',"chevron-down":'<svg width="16" height="16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11.708 5.804a.989.989 0 00-1.407 0L8.004 8.121 5.697 5.794a.985.985 0 00-1.406 0A1 1 0 004 6.503v.001c0 .256.096.513.291.709l2.939 2.965c.219.215.499.322.778.322.28 0 .557-.107.77-.322l2.93-2.955a1.007 1.007 0 000-1.419" id="i9-a"/></defs><use xlink:href="#i9-a" fill-rule="evenodd"/></svg>',close:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M12 10.586l5.293-5.293a1 1 0 011.414 1.414L13.414 12l5.293 5.293a1 1 0 01-1.414 1.414L12 13.414l-5.293 5.293a1 1 0 11-1.414-1.414L10.586 12 5.293 6.707a1 1 0 011.414-1.414L12 10.586z" id="i11-a"/></defs><use fill-rule="nonzero" xlink:href="#i11-a"/></svg>',help:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M13 17a1 1 0 11-2 0 1 1 0 012 0m2.5-7.5a3.505 3.505 0 01-2.5 3.354V14a1 1 0 01-2 0v-2a1 1 0 011-1c.827 0 1.5-.673 1.5-1.5S12.827 8 12 8s-1.5.673-1.5 1.5a1 1 0 01-2 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5M12 20c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8m0-18C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2" id="i13-a"/></defs><use xlink:href="#i13-a" fill-rule="evenodd"/></svg>',info:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M3 12a9 9 0 019-9 9 9 0 019 9 9 9 0 01-9 9 9 9 0 01-9-9zm8-.997v4.994A.994.994 0 0012 17c.556 0 1-.449 1-1.003v-4.994A.994.994 0 0012 10c-.556 0-1 .449-1 1.003zM12 9a1 1 0 100-2 1 1 0 000 2z" id="i15-a"/></defs><use xlink:href="#i15-a" fill-rule="evenodd"/></svg>',warning:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M13.416 4.417l6.168 6.167c.783.784.782 2.05 0 2.833l-6.168 6.167a2.002 2.002 0 01-2.832 0l-6.168-6.167a2.002 2.002 0 010-2.833l6.168-6.167a2.002 2.002 0 012.832 0zM12 14a1 1 0 001-1V8a1 1 0 00-2 0v5a1 1 0 001 1zm0 3a1 1 0 100-2 1 1 0 000 2z" id="i17-a"/></defs><use xlink:href="#i17-a" fill-rule="evenodd"/></svg>'}}),r.tinymce.init(c)}},Pi=Ii,Bi="".concat(o.a.location.protocol,"//").concat(o.a.location.host),Mi={a11ycheckerIssueUrlCallback:function(e){return"".concat(Bi).concat(ye,"/plugins/a11ychecker/a11ychecker-rules.action#").concat(e)},a11ycheckerFilterIssue:function(e){return!(e.element.classList.contains("wysiwyg-macro")||e.element.classList.contains("editor-inline-macro"))}};function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fi="".concat(o.a.location.protocol,"//").concat(o.a.location.host),ji=["compat3x","atlassiantheme","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","cursorTarget","aeTable","confluencepastetableplugin","pagelayoutplugin","iosediting","autoconvert","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation","preserve-paragraph-formatting-on-delete","tableContentWrapper","statusmacro","macroNavigation"],Hi=function(){var e;return E("confluence.editor.a11ychecker")?(ji=ji.concat(["a11ychecker","a11ychecker-helper"]),e={theme:"silver",a11ychecker_html_version:"html5",a11ychecker_ignored_rules:"T1,T2,T3,T4C,H93",a11ychecker_issue_url_callback:Mi.a11ycheckerIssueUrlCallback,a11ychecker_filter_issue:Mi.a11ycheckerFilterIssue}):e={theme:"default"},e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Li(e,t,n[t])}))}return e}({},e,{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:"".concat(Fi).concat(ye,"/"),plugins:ji.join(","),theme_advanced_buttons1:"formatselect,confimage,conf_macro_browser,code,customtoolbar,monospace,searchreplace,linkbrowserbutton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",toolbar:!1,menubar:!1,skin:!1,statusbar:!1,table_toolbar:"",contextmenu:!1,mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:ye,plugin_action_base_path:"".concat(ye,"/plugins/tinymce"),editor_plugin_action_base_path:"".concat(ye,"/plugins/editor/tinymce"),page_id:U.get("page-id"),draft_type:null,form_name:U.get("form-name"),space_key:encodeURI(U.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:!1,inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0,atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,gecko_spellcheck:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,#div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{float:"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{float:"right"}}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"em",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:":not(li)",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,padd_empty_with_br:!0,allow_unsafe_link_target:!0,paste_remove_styles_if_webkit:!1,object_resizing:!1,automatic_uploads:!1,allow_html_data_urls:!0,images_dataimg_filter:function(){return!1},icons:"atlassian"})};var Ui={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize"]}},createProfileForPageEditor:function(e){var t=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer"];return e&&e.versionComment&&t.push("confluenceversioncomment"),e&&e.notifyWatchers&&t.push("confluencenotifywatchers"),{plugins:t}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","templateeditor"]}}},zi=function(){return{renderUI:function(){return{iframeContainer:r.tinymce.DOM.get("rte"),editorContainer:"wysiwyg"}}}};function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Ei(),$n(),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BootstrapManager&&(r.AJS.Rte.BootstrapManager=Pi),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Placeholder&&(r.AJS.Rte.Placeholder=de),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BookmarkManager&&(r.AJS.Rte.BookmarkManager=_e),Object(r.define)("confluence-editor/loader/tinymce-bootstrap",(function(){return Pi})),Object(r.define)("confluence-editor/editor/atlassian-editor",(function(){return ki})),Object(r.define)("confluence-editor/editor/atlassian-editor-content",(function(){return Vn})),Object(r.define)("confluence-editor/utils/tinymce-node-utils",(function(){return xe})),Object(r.define)("confluence-editor-v4/build/editor",(function(){li().then((function(){var e={locale:U.get("user-locale").replace("_","-")};r.AJS.toInit((function(){!function(e){r.tinymce.ThemeManager.requireLangPack("advanced"),E("confluence.editor.a11ychecker")||r.tinymce.ThemeManager.add("default",zi),o.a.requestAnimFrame=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;var t=Hi();0===Number(t.page_id)&&(t.page_id=null,t.draft_type=U.get("draft-type")),Pi.addBeforeInitCallback((function(e){e.contentCssTags=r.document.querySelector('script[title="editor-css"]').innerHTML,e.language=U.get("action-locale").replace("_","-");var t=U.get("min-editor-height");t&&(e.autoresize_min_height=t)}));var n=!(U.get("remote-user")&&U.get("confluence.prefs.editor.disable.autocomplete"));if(n&&(t.plugins+=",autocomplete,autocompletelink,autocompletemedia"),t.locale="object"===Wi(e)&&void 0!==e.locale?e.locale:"",!!U.get("auto-start")){if(d("rte-loaded",{editPermission:!0}),ze()){var i=r.document.getElementById(t.editor_id);d("rte-collaborative-content-ready",{title:U.get("page-title")||U.get("original-content-title")||"",editorContent:i.value,confRev:U.get("conf-revision"),syncRev:r.document.getElementById("syncRev").value,syncRevSource:U.get("sync-revision-source")})}vi("confluence.editor"),n&&(t.plugins+=",autocompletemacro");var a="0"==="".concat(U.get("page-id")),c=function(e,t){if("template"===e)return Ui.createProfileForTemplateEditor();if("comment"===e)return Ui.createProfileForCommentEditor();var n={versionComment:!t,notifyWatchers:!t};return Ui.createProfileForPageEditor(n)}(U.get("content-type"),a).plugins.join(",");c&&(t.plugins+=",".concat(c)),Pi.preInitialise(t),Pi.initialise(),bi("confluence.editor")}else Pi.preInitialise(t)}(e)}))}))}))},0:function(e,t,n){e.exports=n("./src/index.ts")},"com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')":function(e,t){e.exports=require("confluence-editor/utils/attachments-insert-utils")},"com.atlassian.confluence.plugins.confluence-frontend:locale/require('confluence/locale')":function(e,t){e.exports=require("confluence/locale")},"com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')":function(e,t){e.exports=require("confluence/table-color-names")},"com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')":function(e,t){e.exports=require("confluence-macro-browser/macro-browser")},"com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')":function(e,t){e.exports=require("confluence-rest/confluence-rest")},"confluence.web.components:confluence/require('confluence/root')":function(e,t){e.exports=require("confluence/root")},"confluence.web.resources:ajs/require('ajs')":function(e,t){e.exports=require("ajs")},"confluence.web.resources:jquery/require('jquery')":function(e,t){e.exports=require("jquery")},"confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')":function(e,t){e.exports=require("confluence/macro-js-overrides")},"confluence.web.resources:meta/require('confluence/meta')":function(e,t){e.exports=require("confluence/meta")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:bookmark-manager-conf-frontend', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce","ajs"],function(c,e){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a};e.log("Storing bookmark");e.log(b)},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();e.log("Restoring bookmark");
e.log(b);b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:analytics', location = 'analytics/editor-ready-collab-mode-analytics.js' */
define("confluence-editor/analytics/editor-ready-collab-mode-analytics",["ajs","confluence/dark-features","confluence/meta"],function(a,d,b){return{trigger:function(){if(a.Rte&&a.Rte.getEditor()&&(a.$("#editpageform").length||a.$("#createpageform").length)){var c;c="confluence.editor.ready.collab.mode."+(d.isEnabled("site-wide.shared-drafts")?"on":"off");var e=b.get("synchrony-connection-order")?b.get("synchrony-connection-order"):"",f=b.get("synchrony-connection-type")?b.get("synchrony-connection-type"):
"";a.trigger("analyticsEvent",{name:c,data:{connectionOrder:e,connectionType:f}})}}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-ready-collab-mode-analytics",function(a){require("ajs").bind("rte-ready",function(){a.trigger()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes",["jquery","confluence/legacy","ajs","underscore","tinymce"],function(c,a,g,i,h){return{init:function(e){var f=c(a.Templates.UnpublishedChanges.lozenge({tooltip:g.I18n.getText("editor.unpublished.changes.lozenge.tooltip"),label:g.I18n.getText("editor.unpublished.changes.lozenge.label")})),h=function(d){d=i.isBoolean(d)?d:!0;a.Editor.UI.setButtonState(d,c("#rte-button-publish"))},j=function(d,b){var a=b||function(){};(i.isBoolean(d)?
d:1)?f.addClass("visible").fadeIn("fast",a):f.fadeOut("fast",function(){c(this).hide().removeClass("visible");a()})},b={show:function(){f.hasClass("visible")||j(!0,h)},hide:function(){j(!1);h(!1)}};g.bind("rte-ready",function(){var a=c("#content-title-div");b.hide();f.insertBefore(a);f.tooltip();c("#content-title").on("keydown change",b.show);e.onChange.add(b.show);e.onKeyDown.add(b.show);e.onLoad.add(function(){c(e.startContent).text().trim()&&0<g.Meta.get("draft-id")&&b.show()});f.on("mouseenter.tipsy",
function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});e.addCommand("mceConf.UnpublishedChangesLozenge.show",b.show);e.addCommand("mceConf.UnpublishedChangesLozenge.hide",b.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(c){var a=require("tinymce");a.create("tinymce.plugins.UnpublishedChanges",c);a.PluginManager.add("unpublishedchanges",a.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!d[b.name]?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=f.length;d<
e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,d,c){for(var a=
c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.on("init",function(){g(c).bind("postPaste",l)});i.on("remove",function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p></p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'templates/reliable-save.soy' */
// This file was automatically generated from reliable-save.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Reliable.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Reliable == 'undefined') { Confluence.Templates.Editor.Reliable = {}; }


Confluence.Templates.Editor.Reliable.draftMessage = function(opt_data, opt_ignored) {
  var output = '<div id="draft-messages">';
  if (opt_data.isNewPage) {
    if (opt_data.existingDraft.title) {
      var escapedTitle__soy8 = '' + soy.$$escapeHtml(opt_data.existingDraft.title);
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} called \x26#8216;{1}\x26#8217; was saved as a draft.',opt_data.existingDraft.date,escapedTitle__soy8));
    } else {
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} was saved as a draft.',opt_data.existingDraft.date));
    }
    output += ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}resume editing{1} or {2}discard{3} it?','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft"> ','</a>'));
  } else {
    output += soy.$$filterNoAutoescape(AJS.format('A version of this page you were editing at {0} was saved as a draft.',opt_data.existingDraft.date)) + ((opt_data.mergeRequired) ? ' ' + soy.$$escapeHtml('The page has since been updated. Your changes will be merged with the latest version.') : '') + ((opt_data.conflictFound) ? ' ' + soy.$$filterNoAutoescape(AJS.format('The page has since been updated. The changes made conflict with your changes and cannot be merged. Do you want to {0}view the conflict{1} or {2}discard{3} your changes?','<a href="?pageId=' + opt_data.pageId + '&viewConflict=true&spaceKey=' + opt_data.spaceKey + '" >','</a>','<a href="#" class="discard-draft">','</a>','<a href="' + "" + '/users/viewmydrafts.action">','</a>')) : (opt_data.mergeRequired) ? ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view{1}, {2}merge and resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')) : ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view the change{1}, {2}resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')));
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Reliable.draftMessage.soyTemplateName = 'Confluence.Templates.Editor.Reliable.draftMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/reliable-save.js' */
define("confluence-editor-reliable-save/reliable-save","ajs confluence/legacy underscore jquery window document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog".split(" "),function(a,c,n,e,u,L,p,b,D){function v(){return a.Meta.get("shared-drafts")}function w(){return a.Meta.getBoolean("new-page")}function x(){c.Editor.UI.toggleSavebarBusy(!1)}function q(c){var e="There was an error processing the request.";b.closeMessages(["generic-error"]);
b.handleMessage("generic-error",{type:"error",message:e},f);a.logError("Generic error: "+JSON.stringify(c))}function f(){var b=e("#draft-messages");0<b.length&&(b.is(":visible")&&a.Confluence.Analytics.publish("rte.notification.draft"),b.find("a.use-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Editor.Drafts.useDraft();a.Confluence.Analytics.publish("rte.notification.draft.resume")}),b.find("a.discard-draft").click(function(b){b.stopPropagation();b.preventDefault();h.Draft.discardDraft(a.Meta.get("page-id"),
a.Meta.get("existing-draft-id")).done(h.Draft.onSuccessDiscardDraft).fail(h.Draft.onErrorDiscardDraft)}))}function G(){e("#editor-restore-title-link").click(function(c){c.stopPropagation();c.preventDefault();e("#content-title").val(a.Meta.get("latest-published-page-title"));b.closeMessages(["rename-during-limited-mode"])})}function r(){a.Meta.set("access-mode","READ_ONLY");b.closeMessages(["read-only-mode"]);b.handleMessage("read-only-mode",{title:"This site is read-only",
type:"error",message:"Starting now, any changes you make won\u0027t be saved. We\u0027ll let you know when you can start editing again."});c.Editor.UI.setButtonsState(!0);c.Editor.UI.toggleSavebarBusy(!1);c.Editor.UI.setButtonState(!1,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(!1,c.Editor.UI.cancelButton)}function A(c){var e="Looks like your session expired. Log in again to keep working.\n \u003cdiv\u003e\u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003eLogin\u003c/a\u003e\u003c/div\u003e";b.closeMessages(["noauthorized"]);b.handleMessage("noauthorized",{title:"Can\u0027t connect to the server",type:"error",message:e},f);c&&a.trigger("rte.safe-save.invalid-xsrf-token")}
function E(){var c="Unable to communicate with server. Saving is not possible at the moment.";b.closeMessages(["server-offline"]);b.handleMessage("server-offline",{type:"error",message:c},f)}var F=[],t=!1,h={Draft:{discardDraft:function(b,c){b={draftId:c,pageId:b,type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};return e.ajax({type:"DELETE",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/discard",data:e.toJSON(b),contentType:"application/json",dataType:"json"})},onSuccessDiscardDraft:function(){w()||a.Meta.set("draft-id",
"0");b.closeMessages(["draft-message"]);b.handleMessage("discarding-successfull",{type:"info",message:"Your draft has been discarded.",close:"auto"},f);a.Confluence.Analytics.publish("rte.notification.draft.discard")},onErrorDiscardDraft:function(c){switch(c.status){case 403:A(!0);break;case 404:b.handleMessage("draft-deleted",{type:"info",message:"This draft has been discarded."},f);break;case 405:r();break;case 422:b.handleMessage("discarding-invalid",{type:"error",
message:"This draft is invalid. It can be deleted by someone or looks like your session expired."},f);break;default:b.handleMessage("discarding-error",{type:"error",message:"An unknown error has occurred. Please check your logs."},f)}}}};h._internal=c.SafeSafe&&c.SafeSave._internal?c.SafeSave._internal:{};h._internal.onSuccessfulResponse=function(b){e("#rte-button-overwrite").unbind("click.overwrite");var f={dataType:"json",contentId:a.Meta.get("content-id"),draftType:a.Meta.get("draft-type")};a.safe.post(p.CONTEXT_PATH+"/json/stopheartbeatactivity.action",
f,function(){a.log("Stop heartbeat activity on",f.draftType,"id",f.contentId)},"json").fail(function(b,c,e){a.logError("Server error on stop heartbeat activity request:");a.log(e)}).always(function(){var a=b._links.webui;a?0!==a.indexOf("/")?u.location=a:u.location=p.CONTEXT_PATH+a:(c.Editor.isPublishing(!1),x())})};h.resetUnrecoverableEditorError=function(){t=!1};h.initialize=function(){function z(d){x();switch(d.status){case 400:b.closeMessages(["empty-title","duplicate-title","title-too-long",
"legacy-draft-deprecated","utf8-validation-failed"]);0<=d.responseText.indexOf(k.duplicatedTitle)?b.handleMessage("duplicate-title",{type:"error",message:a.format("A page with the title \u0027\u0027{0}\u0027\u0027 already exists in this space. Enter a different title for your page.",a.escapeHtml(e("#content-title").val()))}):0<=d.responseText.indexOf(k.titleTooLong)?b.handleMessage("title-too-long",{type:"error",message:"Title cannot be longer than 255 characters."},f):0<=d.responseText.indexOf(k.publishNewDraftDeprecated)||0<=d.responseText.indexOf(k.existingDraftNotFound)?
a.Meta.get("new-page")&&v()&&!c.Editor.hasContentChanged()?(a.trigger("rte.legacy-draft-can-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:a.format("Collaborative editing is here! So that you can keep working on this page, we need to migrate the content to a new draft for you.\u003cbr\u003e \u003ca href={0}\u003eMigrate now\u003c/a\u003e",p.CONTEXT_PATH+"/pages/resumedraft.action?draftId\x3d"+a.Meta.get("draft-id"))},f)):(a.trigger("rte.legacy-draft-cannot-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."},f)):0<=d.responseText.indexOf(k.utf8ValidationFailed)?
(d=d.responseJSON.message.split(k.utf8ValidationFailed)[1],b.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",d)},f)):q(d);break;case 403:A(!0);break;case 404:b.closeMessages(["page-not-accessible","noauthorized"]);b.handleMessage("page-not-accessible",{title:"This content cannot be accessed.",type:"error",message:a.format("Your session may have expired, you can attempt to \u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003elog in\u003c/a\u003e.",
a.Meta.get("space-key"))},f);break;case 405:r();break;case 410:b.closeMessages(["page-deleted"]);b.handleMessage("page-deleted",{title:"This content has been deleted",type:"error",message:a.format("Copy your content, then add it to a new page or \u003cdiv\u003e\u003ca href=\u0022viewtrash.action?key={0}\u0022 target=\u0022_blank\u0022\u003erestore this page from the trash\u003c/a\u003e and try again.\u003c/div\u003e",a.Meta.get("space-key"))},f);break;case 413:b.closeMessages(["page-too-big"]);b.handleMessage("page-too-big",{type:"error",message:"This page is too big to save. You could split it into multiple pages, then use the \u003ca href=\u0022https://confluence.atlassian.com/conf51/include-page-macro-336169384.html\u0022 target=\u0022_blank\u0022\u003einclude page macro\u003c/a\u003e to display the content."},f);break;case 0:case 500:case 503:E();break;case 501:0<=d.responseText.indexOf(k.renameDuringLimitedMode)?
b.handleMessage("rename-during-limited-mode",{type:"error",message:"Changing page titles isn\u0027t possible right now, as collaborative editing is offline. \u003cdiv\u003e\u003ca id=\u0022editor-restore-title-link\u0022 href=\u0022#\u0022\u003eRestore the page title\u003c/a\u003e if you\u0027d like to publish the page.\u003c/div\u003e"},G):q(d);break;default:q(d)}}function y(d){function I(c){B<J?(B++,C.push(setTimeout(function(){y()},K))):(a.trigger("analyticsEvent",{name:"editor.save.error.conflict"}),B=0,b.handleMessage("page-conflict",{title:"Can\u0027t sync with the server.",type:"error",message:a.format("Refresh the page to try to re-establish the connection.",g.space.key)},f),k(c))}function k(b){a.trigger("rte.safe-save.error",
{status:b.status})}function n(){c.Editor.isPublishing(!0);e.ajax({type:r,url:l,contentType:"application/json; charset\x3dutf-8",dataType:"json",data:JSON.stringify(g),success:function(b){"page"!==g.type&&"blogpost"!==g.type||a.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}});a.trigger("rte.safe-save.success",b);h._internal.onSuccessfulResponse(b)},error:function(b){c.Editor.isPublishing(!1);x();var d=!1;switch(b.status){case 409:v()?(d=!0,I(b)):(c.Editor.restoreDefaultSave(),
c.Editor.UI.saveButton.click());break;case 0:case 500:case 503:for(;C.length;)clearTimeout(C.shift());z(b);break;default:z(b)}d||k(b);a.trigger("synchrony.start",{id:"confluence.editor.publish"})}})}a.trigger("synchrony.stop",{id:"confluence.editor.publish"});d&&d.preventDefault();var m=e("#content-title");if(m.hasClass("placeholded")||""===m.val().trim())a.trigger("rte.safe-save.error"),a.trigger("synchrony.start",{id:"confluence.editor.publish"}),b.closeMessages(["title-too-long","duplicate-title"]),
b.handleMessage("empty-title",{title:"This page needs a name",type:"error",message:"Add a page title before hitting publish."},f),x();else{c.Editor.Drafts.unBindUnloadMessage();var g={};d=a.Meta.get("draft-id");var t=a.Meta.get("content-id"),l=p.CONTEXT_PATH+"/rest/api/content",q=e("#sourceTemplateId").val();g.status="current";g.title=m.val();g.space={key:a.Meta.get("space-key")};g.body={editor:{value:function(a){F.forEach(function(b){a=b(a)});return a}(a.Rte.getEditor().getContent()),
representation:"editor"}};q&&(g.extensions={sourceTemplateId:q});m=(m=c.Editor.UI.postingDatePicker)&&m.getDate();"blogpost"===u.type&&m&&m.toISOString&&(g.history={createdDate:m.toISOString()});if(w()&&!a.Meta.get("shared-drafts")){var r="POST";a.Meta.get("is-blueprint-page")&&(l=l+"/blueprint/instance/"+d);l+="?status\x3ddraft";g.id=d;g.type=a.Meta.get("content-type");g.body.editor.content={id:d}}else r="PUT",w()&&a.Meta.get("is-blueprint-page")&&(l+="/blueprint/instance"),l=l+"/"+t,w()&&v()?(g.id=
d,g.body.editor.content={id:d}):(g.id=a.Meta.get("page-id"),g.body.editor.content={id:a.Meta.get("page-id")}),l="0"===d?l+"?status\x3dcurrent":l+"?status\x3ddraft",d=a.Meta.getNumber("page-version")||0,g.type=a.Meta.get("content-type"),g.version={number:d+1,message:e("#versionComment").val(),minorEdit:!e("#notifyWatchers").is(":checked"),syncRev:e("#syncRev").val()};d=function(){var b={};b.id=a.Meta.get("parent-page-id")||"0";b.type=a.Meta.get("content-type");var c=a.Meta.get("parent-page-id");c&&
g.space.key===a.Meta.get("space-key")||(b.id="0");c&&b.id!==c&&(b.id=e("#parentPageString").val()===a.Meta.get("from-page-title")?b.id:c);return b}();"0"!==d.id&&(g.ancestors=[d]);(d=c.Editor.Drafts.getDraftSavingPromise())?d.always(n):n()}}if(0!==e("#editpageform").length||0!==e("#createpageform").length){var k={duplicatedTitle:"A page with this title already exists",titleTooLong:"Title cannot be longer than 255 characters.",publishNewDraftDeprecated:"Unsupported call to publishNewDraft",existingDraftNotFound:"Could not find existing draft, perhaps you're trying to publish a personal draft?",
renameDuringLimitedMode:"Unable to perform a page rename when limited mode is enabled",utf8ValidationFailed:"Unsupported character found in content: "},u={existingDraftId:a.Meta.get("existing-draft-id")?a.Meta.get("existing-draft-id"):0,pageId:a.Meta.get("page-id"),type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};if(!0===a.Meta.get("show-draft-message")){if(0<e("#conflict-diffs").length)return;e.ajax({type:"GET",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/message",data:u,contentType:"application/json",
dataType:"text json",success:function(d){d&&d.draftData&&(d=c.Templates.Editor.Reliable.draftMessage({existingDraft:d.draftData,conflictFound:d.conflictFound,mergeRequired:d.mergeRequired,isNewPage:d.newPage,pageId:a.Meta.get("page-id"),spaceKey:a.Meta.get("space-key")}),b.handleMessage("draft-message",{type:"info",message:d},f))}})}var H=0<e("#editor-notifications-container #all-messages .aui-message-error").length;v()?(D.init({saveHandler:y,cancelErrorHandler:z}),c.Editor.overrideSave(D.process)):
H?c.Editor.restoreDefaultSave():c.Editor.overrideSave(y);e("#rte-button-overwrite").bind("click.overwrite",y);var B=0,J=3,K=1E3,C=[];a.bind("rte.heartbeat-error",function(d,e){switch(e.status){case 401:case 403:b.isDisplayed(["page-not-accessible"])||A(!1);break;case 405:if(e.responseText){d=JSON.parse(e.responseText);b.isDisplayed(["read-only-mode"])||"READ_ONLY"!==d.reason||r();break}case 0:case 404:case 500:case 503:c.Editor.metadataSyncRequired()||E();break;default:a.logError("Heartbeat action error: "+
JSON.stringify(e))}});a.bind("rte.heartbeat",function(d){var e=!1;n.each(b.displayedErrors(),function(a){n.contains(["noauthorized","server-offline","page-not-accessible","read-only-mode"],a)&&(e=!0,b.closeMessages([a]))});(d="READ_ONLY"===a.Meta.get("access-mode"))&&a.Meta.set("access-mode","READ_WRITE");(e||d)&&b.handleMessage("reconnect",{type:"info",title:"Successfully reconnected",message:"We\u0027re back in business. You\u0027re free to save your page again.",close:"auto"},f);c.Editor.UI.isButtonEnabled(c.Editor.UI.saveButton)||
t||c.Editor.UI.setButtonState(!0,c.Editor.UI.saveButton);c.Editor.UI.isButtonEnabled(c.Editor.UI.cancelButton)||t||c.Editor.UI.setButtonState(!0,c.Editor.UI.cancelButton)});a.bind("synchrony.history.evicted",function(){t=!0})}};h.registerCleanupFunction=function(a){F.push(a)};return h});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/reliable-save",function(a){var c=require("ajs"),n=0<window.document.referrer.indexOf("createDialog\x3dtrue\x26flashId");if(c.DarkFeatures.isEnabled("editor.ajax.save")&&""!==c.Meta.get("remote-user")&&!n){var e=require("confluence/legacy");c.bind("rte.init.ui",function(){a.initialize();e.Editor=e.Editor||{};e.Editor.SafeSave=e.Editor.SafeSave||{};e.Editor.SafeSave.Draft=a.Draft;e.Editor.SafeSave._internal=a._internal||
{}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/ajax-login.js' */
define("confluence-editor-reliable-save/ajax-login",["confluence/dark-features","confluence/meta","ajs","jquery","document"],function(p,k,b,f,y){return function(){function z(A,g,a){function h(a){a=a.getResponseHeader("X-AUSERNAME");return v===a}function k(a){for(var d=0,B=a.length;d<B;d++){var e=a[d];b.debug("Rerunning ajax query to: "+e.url,e);w.call(f,e.url,e.settings).done(function(){b.debug("Rerunning done");e.deferred.resolve(arguments)}).fail(function(){b.debug("Rerunning failed");e.deferred.reject(arguments)})}}
function p(a){r.push({deferred:l,url:A,settings:g,defaultCallback:a});t||(u=!1,m||(m=new b.Dialog(840,700),m.addPanel("ajax-login","ajax-login-content","ajax-login-panel",1),a=f(".ajax-login-panel"),n=f("\x3ciframe\x3e\x3c/iframe\x3e"),n.bind("load",function(a){(a=n[0].contentDocument.location.pathname)&&0<=a.indexOf("/ajaxlogincomplete.action")&&(t=!1,u=!0,m.hide(),n.attr("src","about:blank"))}),a.append(n),f(y).bind("hideLayer",function(a,d,e){if("popup"===d&&e===m.popup){b.debug("hiding login dialog");
if(u)k(r);else for(a=r,d=0,e=a.length;d<e;d++){var c=a[d];b.debug("Executing with original response for: "+c.url,c);c.defaultCallback&&c.defaultCallback()}r=[]}})),n.attr("src",C),m.show(),t=!0)}function q(a,b,f,e){function d(){c.readyState=a.readyState;c.status=a.status;c.statusText=a.statusText;a.responseXML?c.responseXML=a.responseXML:c.responseText=a.responseText;b.apply(f,e)}h(a)?d():p(d)}b.debug("Using authenticatingPromise");var c={abort:function(){a.abort.apply(a,arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,
arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(c,b){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},l=f.Deferred();l.promise(c);c.success=c.done;c.error=c.fail;a.done(function(a,c,b){q(b,l.resolve,l,arguments)});a.fail(function(a,
c,b){q(a,l.reject,l,arguments)});return c}if(p.isEnabled("ajax.login")){b.debug("AJAX login support enabled");var t=!1,m,n,u,r=[],w=f.ajax,v=k.get("remote-user"),q=k.get("base-url"),x=k.get("context-path"),C=k.get("context-path")+"/login.action?os_destination\x3d%2Fajaxlogincomplete.action";f.ajax=function(b,g){var a=w.call(f,b,g);var h=b&&b.url;h=v&&(!g||g&&!g.preventAjaxLogin)&&h&&(q&&0===h.indexOf(q)||x&&0===h.indexOf(x));return h?z(b,g,a):a}}}});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/ajax-login",function(p){require("ajs").toInit(p)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,f,!0,!1,b,i);
f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;if(0<=b.substring(a,
c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,j)+"...");p&&(a=
a.replace(/([/=])/g,"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","jquery confluence/legacy confluence-editor/tinymce3/plugins/confluencepaste/linkify ajs document tinymce".split(" "),function(e,B,q,r,y,z){function u(a,b){for(var f=e(a).find("["+b+"]"),c="",d="",g="",h=0,k=f.length;h<k;h++){d=(c=e(f[h]))&&["/",c.attr(b)].join("");g=c&&["/",c.attr("data-mce-"+b)].join("");r.contextPath()&&d.indexOf(r.contextPath())===0&&(f[h]=c.attr(b,d));r.contextPath()&&g.indexOf(r.contextPath())===
0&&(f[h]=c.attr("data-mce-"+b,g))}return f}function m(a,b,f){var a=e(a).find("["+b+"]"),c="",d,g;if(a)for(var h=0,k=a.length;h<k;h++){d=e(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&d.is(n)){g=f[n];break}if(b.indexOf("style")>-1){var c=d,i=g;g=[];for(var o="",o=void 0,p=c.attr("style"),l=c.attr("data-mce-style"),j=0,m=i.length;j<m;j++)if(p&&p.toLowerCase().indexOf(i[j])>-1)g.push(i[j]+": "+c.css(i[j])+";");else if(l&&l.toLowerCase().indexOf(i[j])>-1){o=RegExp(i[j]+":.+?(?:;|$)");o=l.match(o);
g.push(o[0].indexOf(";")>-1?o:o+";")}c=g.join(" ")}else{c=d;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)c.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}c=p.join(" ")}d.removeAttr(b);c.length&&d.attr(b,c)}}function A(a,b){function f(f){var d;if(c.index){d=a.splitText(c.index);a&&b.push(a);a=d}(d=a.splitText(c[0].length))&&b.push(d);e(a).wrap("<a href='"+f+a.data+"'></a>")}var c,d,g;d=s.exec(a.data);g=t.exec(a.data);if(d){c=d;f("mailto:")}else if(g){d=(c=g)&&c[0].indexOf("://")===-1?"http://":"";f(d)}}var t;
q.init();var v=RegExp(q.RE_FULL_URL),w=RegExp(q.RE_OTHER_URL);t={exec:function(a){return v.exec(a)||w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0])){a[0]=a[0].replace(/\s/,"");a.index++}return a},test:function(a){return x.test(a)}};e(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],
span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);if(e.browser.mozilla){u(a,"src");u(a,"href")}m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var c=0;c<b.length;c++)for(var d=b[c],g=0;g<d.elements.length;g++)for(var h=
e(a).find(d.elements[g]+"["+d.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(d.attribute),n=n.replace(d.blackValue,"");h.eq(k).attr(d.attribute,n)}var i=f.node;e.each([".contentLayout",".contentLayout2",".columnLayout",".header",".footer",".cell",".innerCell",".panelContent",".panel",".panelHeader",".Apple-converted-space","font",".jira-status",".jira-issue",".diff-html-removed",".diff-html-added",".diff-html-changed"],function(a,b){e(b,i).contents().unwrap()});e("img",i).map(function(){e(this).attr("data-attachment-copy",
"");!e(this).attr("src")&&e(this).remove()});e("dl",i).map(function(){e(this).replaceWith(e("<p></p>").text(e(this).text()))});e("a",i).map(function(){e(this).removeClass("confluence-userlink userLogoLink")});for(a=e.makeArray(f.node.childNodes);a.length;){b=a.pop();e(b).is("a")||(b.nodeType===3?A(b,a):b.nodeType===1&&(b.childNodes&&b.nodeName.toLowerCase()!=="pre")&&(a=a.concat(e.makeArray(b.childNodes))))}if(a=e.browser.mozilla){a=e(f.node);a=a.children("br").length&&!a.find(":not(br)").length&&
!e(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length}if(a){f=e(f.node);a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>";f.html(a)}});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["tinymce","ajs","confluence/legacy","jquery"],function(e,a,g,h){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,i=d.getDoc(),b=h(b,c||i),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,insertLink:function(b,
f){f&&a.Rte.getEditor().selection.select(f);g.Editor.LinkAdapter.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},
isExternalLink:function(a){return g.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},getEditorHTML:function(){return""+a.Rte.getEditor.getContent()},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},
editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},
getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:editor-resources-v4-exporter', location = 'editor-plugins/tinymce-exporter.js' */
try{require("confluence-editor-v4/build/editor")}catch(a){};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(a){var b="single";a.container.find("#opt-table").is(":checked")?b="table":a.container.find("#opt-total").is(":checked")&&(b="count");return b},
setupAnalyticPanelActionObject:function(a,b,d){return{name:a.analyticPanelActionName,properties:this.setupPanelActionProperties(a,b,d)}},setupPanelActionProperties:function(a,b,d){var c={};b===AJS.Editor.JiraConnector.source.instructionalText&&("confluence.jira.plugin.issuecreated"===a.analyticPanelActionName?c.issueType=a.container.find('select[name\x3d"issuetype"] :selected').text():"confluence.jira.plugin.searchadded"===a.analyticPanelActionName&&(c.display=this.getDisplayType(a)),c.label=d);return c},
triggerPasteEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:a})},triggerPannelActionEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(a)},triggerSearchEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:a})},triggerMarkupEvent:function(a){this.triggerSearchEvent(a)},triggerPannelTriggerEvent:function(a){AJS.EventQueue=
AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:a})},triggerCustomizeColumnEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:a})}};
(function(a){a.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(b,a){b&&b[0]&&"confluence.extra.jira"==b[0].pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})});a.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(b,a){b&&b[0]&&b[0].presetMacroMetadata&&"confluence.extra.jira"==b[0].presetMacroMetadata.pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})});
AJS.bind("init.rte",function(){a.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(b,d){if(b&&"mceInsertContent"==b[0]&&b[2]&&(d=[Node.ELEMENT_NODE],b=a.parseHTML(b[2]),b.length)){var c=b[0];if(d.includes(c.nodeType)&&(d=c.getAttribute("data-macro-name"),["jira","jiraissues"].includes(d)&&(d=AJS.Editor.JiraAnalytics,b={source:"wiki_markup"},c.getAttribute("data-macro-parameters")))){c=c.getAttribute("data-macro-parameters").split("|");for(var f=0;f<c.length;f++){var e=a.trim(c[f]);
if(0==e.indexOf("jql")||0==e.indexOf("jqlQuery")){b.type=d.linkTypes.jqlDirect;break}else if(0==e.indexOf("url")){c=a.trim(e.substring(e.indexOf("\x3d")+1,e.length));b.type=AJS.JQLHelper.checkQueryType(c);break}else if(0==e.indexOf("http")){c=e;b.type=AJS.JQLHelper.checkQueryType(c);break}}"undefined"===typeof b.type&&(b.type=d.linkTypes.jqlDirect);d.triggerMarkupEvent(b)}}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_jquery-selection-plugin', location = 'jquery-selection-plugin.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[17],{401:function(t,e,n){"use strict";n.r(e);var s=n(13),o=n(105);!function(t,e){if(e.selection){const n=function(t){return t.replace(/\u000D/g,"")};t.fn.selection=function(t){const n=this[0];if(this.focus(),!n)return!1;if(null==t)return e.selection.createRange().text;const{scrollTop:s}=n,o=e.selection.createRange();o.text=t,o.select(),n.focus(),n.scrollTop=s},t.fn.selectionRange=function(t,s){const o=this[0];this.focus();const c=e.selection.createRange();if(null==t){const t=this.val(),e=t.length,s=c.duplicate();s.moveToElementText(o),s.setEndPoint("StartToEnd",c);let i=e-n(s.text).length;s.setEndPoint("StartToStart",c);const l=e-n(s.text).length;return i!==l&&"\n"===t.charAt(i+1)&&(i+=1),{end:i,start:l,text:t.substring(l,i),textBefore:t.substring(0,l),textAfter:t.substring(i)}}c.moveToElementText(o),c.collapse(!0),c.moveStart("character",t),c.moveEnd("character",s-t),c.select()}}else t.fn.selection=function(t){const e=this[0];if(!e)return!1;if(null==t)return!!e.setSelectionRange&&e.value.substring(e.selectionStart,e.selectionEnd);const{scrollTop:n}=e;if(e.setSelectionRange){const{selectionStart:n}=e;e.value=e.value.substring(0,n)+t+e.value.substring(e.selectionEnd),e.selectionStart=n,e.selectionEnd=n+t.length}e.focus(),e.scrollTop=n},t.fn.selectionRange=function(t,e){if(null==t){const t={start:this[0].selectionStart,end:this[0].selectionEnd},e=this.val();return t.text=e.substring(t.start,t.end),t.textBefore=e.substring(0,t.start),t.textAfter=e.substring(t.end),t}this[0].selectionStart=t,this[0].selectionEnd=e};t.fn.wrapSelection=function(t,e){this.selection(t+this.selection()+(e||""))}}(n.n(o).a,s.document)}},[[401,0,1,4,6]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(e){AJS.DataTable=function(a,c,b){b=null;a&&a.jquery?b=a:"string"==typeof a&&(b=e(a));b.addClass("data-table");if(c&&c.length){this.columns=c;a=e("\x3ctr\x3e\x3c/tr\x3e").appendTo(b);a.addClass("data-table-header");for(var d=0;d<c.length;d++){var f=c[d];a.append('\x3cth class\x3d"'+f.className+'"\x3e'+f.title+"\x3c/th\x3e")}}this.tbl=b;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(a){for(var c=e("\x3ctr\x3e\x3c/tr\x3e").appendTo(this.tbl),b=this.columns,d=0;d<this.columns.length;d++){var f=
b[d],g=e("\x3ctd\x3e\x3c/td\x3e").appendTo(c);g.addClass(f.className);f.renderCell(g,a)}c.data("row-data",a);this._bindRowJs(c,this.rowIdx,"selected","hover");this.rowIdx+=1;c.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(a){a=e("tbody tr",this.tbl)[a+1];e(a).focus()};AJS.DataTable.prototype._bindRowJs=function(a,c,b,d){var f=this;a.click(function(c){b&&(e(f.tbl).find("."+b).removeClass(b),e(this).addClass(b));c=a.data("row-data");f.tbl.trigger("row-select",[c])});var g=function(b){switch(b.keyCode){case 13:var d,
g=a.data("row-data");a.keyup(d=function(b){f.tbl.trigger("row-action",[g]);a.unbind("keyup",d);b.stopPropagation();return!1});b.stopPropagation();return!1;case 38:return 0<c&&a.prev().focus(),b.stopPropagation(),!1;case 40:var h=e("tbody tr",f.tbl).length;c<h-1&&a.next().focus();b.stopPropagation();return!1}};e.browser.mozilla?a.keypress(g):a.keydown(g);a.focus(function(b){a.click()});d&&a.hover(function(){e(this).addClass(d)},function(){e(this).removeClass(d)})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(e){e.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);e.on("PostRender",function(){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(e){AJS.Editor.JiraConnector.servers=e}});AJS.$("#jiralink").click(function(e){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,!0);e.stopPropagation();return!1});AJS.$("#insert-menu .macro-jiralink").show();
e.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(e){e.plugins+=",jiraconnector";var h=e.theme_advanced_buttons1,l=h.indexOf("confimage");e.theme_advanced_buttons1=h.substring(0,l)+"jiralinkButton,"+h.substring(l)});
AJS.Editor.JiraConnector=function(e){var h=require("confluence/form-state-control"),l="Insert Jira Issue/Filter",r="Insert",t="Cancel",m=AJS.format("Hint: type \u0022{0}+Shift+J\u0022 in the editor to quickly access this dialog.",-1!=navigator.platform.toLowerCase().indexOf("mac")?"Cmd":"Ctrl"),g,k,f,v=function(){var a=e("#createPageLabelsString");0<a.length?(k=a.val().split(" ").join(),AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:g,
label:k})):e.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(a){var b=[];e.each(a.labels,function(a,c){b.push(c.name)});k=b.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:g,label:k})})},p=function(a){if(!f){f=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});f.addHeader(l);for(var c=AJS.Editor.JiraConnector.Panels,b=0;b<c.length;b++){f.addPanel(c[b].title());var u=f.getCurrentPanel();c[b].init(u)}f.addLink("Select Macro",
function(){f.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");f.addHelpText(m);e("#jira-connector .dialog-tip").attr("title",m);f.addButton(r,function(){var a=f.getCurrentPanel().id;a=c[a];var b=c[0];AJS.Editor.JiraAnalytics&&(AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(a,g,k),b.customizedColumn&&AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:b.customizedColumn}));a.insertLink()},"insert-issue-button");h.disableElement(AJS.$(".insert-issue-button"));
f.addCancel(t,function(){AJS.Editor.JiraConnector.closePopup()});f.gotoPanel(0);if(AJS.Editor.JiraConnector.servers)for(b=0;b<AJS.Editor.JiraConnector.servers.length;b++){var n=AJS.Editor.JiraConnector.servers[b];AppLinks.makeRequest({appId:n.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:b,success:function(a){a&&a.length&&(AJS.Editor.JiraConnector.servers[this.serverIndex].columns=a)},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+n.id)}})}e("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",
label:"Jira Charts"}));e("#jira-connector .dialog-page-menu button").click(function(){var a=AJS.Editor.JiraConnector.Panels[f.getCurrentPanel().id];a.setInsertButtonState&&a.setInsertButtonState();a.focusForm&&a.focusForm()});e("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();AJS.Editor.JiraChart&&AJS.Editor.JiraChart.open()})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(a){f.gotoPanel(1);var d=AJS.Editor.JiraConnector.Panels[1];
d.setSummary(a);setTimeout(function(){d.focusForm&&d.focusForm()},0)}else f.gotoPanel(0);f.overrideLastTab();f.show()},q=function(){AJS.Editor.JiraConnector.clickConfigApplink&&AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(a){AJS.Editor.JiraConnector.servers=a}});if("undefined"===typeof AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length)return AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin")),!1;AJS.Editor.JiraConnector.clickConfigApplink=
!1;AJS.Editor.JiraConnector.refreshAppLink&&(AJS.Editor.JiraConnector.refreshAppLink.call(),AJS.Editor.JiraConnector.refreshAppLink=!1);return!0};return{warningPopup:function(a){var c=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"}),b="Connect Confluence To Jira";c.addHeader(b);b=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:a});c.addPanel("Panel 1",b);c.get("panel:0").setPadding(0);a?(c.addButton("Set connection",
function(a){AJS.Editor.JiraConnector.clickConfigApplink=!0;a.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action").opener=null},"create-dialog-create-button app_link"),c.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")):c.addButton("Contact admin",function(a){a.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();
window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action").opener=null});c.addLink("Cancel",function(a){a.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});c.show();c.gotoPanel(0)},closePopup:function(){f.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(a,c){if(q()){AJS.Editor.Adapter.storeCurrentSelectionState();g=a;AJS.Editor.JiraAnalytics&&g&&(g===AJS.Editor.JiraConnector.source.instructionalText?
v():(k=null,AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:g})));a=tinymce.confluence.macrobrowser;var b=a.getCurrentNode();a.isMacroTag(b)&&"jira"==e(b).attr("data-macro-name")?a.editMacro(b):AJS.Editor.JiraConnector.openCleanDialog(c)}},openCleanDialog:function(a){a=a&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});p(a);AJS.Editor.JiraConnector.Panels[0].setMacroParams(null)},edit:function(a){if(q())if("undefined"==typeof a.params)AJS.Editor.JiraConnector.openCleanDialog(!1);
else{k=g="";var c={};if(a.params.url)c.searchStr=a.params.url;else{c.maximumIssues=a.params.maximumIssues;var b;if(!(b=a.defaultParameterValue))b:if(b=a.params,b.hasOwnProperty("jqlQuery"))b=b.jqlQuery;else{var h=/^([0-9]\d*)$/,l="count columns columnIds title renderMode cache width height server serverId anonymous baseurl showSummary".split(" ");for(d in b)if(-1==e.inArray(d,l)&&b.hasOwnProperty(d)){b=h.test(d)?b[d]:d+(" \x3d "+b[d]);break b}b=""}var d=b;c.searchStr="undefined"==typeof d?"":d;if("undefined"!=
typeof a.params.server)c.serverName=a.params.server;else for(d=0;d<AJS.Editor.JiraConnector.servers.length;d++)if(AJS.Editor.JiraConnector.servers[d].selected){c.serverName=AJS.Editor.JiraConnector.servers[d].name;break}c.columnIds=a.params.columnIds}d=a.params.count;"undefined"===typeof d&&(d="false");c.count=d;d=a.params.columns;"undefined"!=typeof d&&d.length&&(c.columns=d);a&&!AJS.Editor.inRichTextMode()&&e("#markupTextarea").selectionRange(a.startIndex,a.startIndex+a.markup.length);p();c.searchStr&&
(f.gotoPanel(0),d=AJS.Editor.JiraConnector.Panels[0],d.setMacroParams(c),a={searchValue:c.searchStr,serverName:c.serverName,isJqlQuery:a.params.hasOwnProperty("jqlQuery"),isAutoSearch:!0},d.doSearch(a))}},source:{macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"}}}(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});
AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=!1;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,!0)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
(function(c){var k=require("confluence/form-state-control");c.Editor.JiraConnector.Panel=function(){};c.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:!1,insertIssueLink:function(a){this.insertIssueLinkWithParams({key:a})},insertJqlLink:function(a){this.insertIssueLinkWithParams({jqlQuery:a})},insertIssueLinkWithParams:function(a){a.server=this.selectedServer.name;a.serverId=this.selectedServer.id;if(c.Editor.inRichTextMode())tinymce.confluence.macrobrowser.macroBrowserComplete({name:"jira",
params:a});else{var b="{jira:";for(d in a)b=b+d+"\x3d"+a[d]+"|";"|"==b.charAt(b.length-1)&&(b=b.substr(0,b.length-1));a=c.$("#markupTextarea");var d=a.selectionRange();a.selectionRange(d.start,d.end);a.selection(b);d=a.selectionRange();a.selectionRange(d.end,d.end)}c.Editor.JiraAnalytics&&c.Editor.JiraConnector.analyticPanelActionObject&&(c.Editor.JiraAnalytics.triggerPannelActionEvent(c.Editor.JiraConnector.analyticPanelActionObject),c.Editor.JiraConnector.analyticPanelActionObject=null);c.Editor.JiraConnector.closePopup()},
disableInsert:function(){k.disableElement(c.$(".insert-issue-button"))},isInsertDisabled:function(){return c.$(".insert-issue-button").is(":disabled")},getOAuthRealm:function(a){a=a.getResponseHeader("WWW-Authenticate")||"";return(a=/OAuth realm="([^"]+)"/.exec(a))?a[1]:null},enableInsert:function(){k.enableElement(c.$(".insert-issue-button"))},handleInsertWaiting:function(a){var b=c.$(".insert-issue-button");return a?b.before(aui.icons.icon({icon:"wait"})):b.prev(".aui-icon.aui-icon-wait").remove()},
msg:function(a,b,d){if(aui&&aui.message)try{var g=c.$('\x3cdiv class\x3d"aui-message-container"/\x3e'),e=b;b.html&&(e=b.html());e={content:e};switch(d){case "error":var f=aui.message.error(e);break;case "success":f=aui.message.success(e);break;case "warning":f=aui.message.warning(e);break;default:f=aui.message.info(e)}g.append(f);b=g}catch(l){c&&c.logError&&c.logError("jira-connector",l)}a.append(b)},errorMsg:function(a,b){this.removeError(a);a=this.SHOW_MESSAGE_ON_TOP?c.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(a):
c.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(a);this.msg(a,b,"error")},warningMsg:function(a,b){this.removeError(a);a=this.SHOW_MESSAGE_ON_TOP?c.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(a):c.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(a);this.msg(a,b,"warning")},noServerMsg:function(a,b){a=c.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(a);a=this.SHOW_MESSAGE_ON_TOP?c.$('\x3cdiv class\x3d"message-panel"/\x3e').prependTo(a):
c.$('\x3cdiv class\x3d"message-panel"/\x3e').appendTo(a);this.msg(a,b,"info")},ajaxError:function(a,b){401==a.status?(a=this.getOAuthRealm(a),this.selectedServer.authUrl=a,b.call(this)):this.errorMsg(this.container,"Received the following HTTP error code from the server"+": "+a.status)},removeError:function(a){c.$("div.jira-error",a).remove()},setActionOnEnter:function(a,c,d){a.unbind("keydown").keydown(function(b){if(13==b.which){var e=function(b){a.unbind("keyup",e);c(d);b.stopPropagation();return!1};a.keyup(e);
b.stopPropagation();return!1}})},createOauthForm:function(a){var b=this.selectedServer,d=function(){b.authUrl=null;a(b)},g=function(){},e='\x3ca class\x3d"oauth-init" href\x3d"javascript:void(0)"\x3e'+"Login & Approve"+"\x3c/a\x3e "+"to retrieve data from"+" "+c.escapeHtml(this.selectedServer.name),f=c.$('\x3cdiv class\x3d"jira-oauth-message-marker"/\x3e');aui&&aui.message||f.addClass("oauth-message");this.msg(f,e,"info");c.$(".oauth-init",
f).click(function(a){AppLinks.authenticateRemoteCredentials(b.authUrl,d,g);a.preventDefault()});return f},applinkServerSelect:function(a,b){c.$(c.Editor.JiraConnector.servers).each(function(){var b="\x3coption ";this.selected&&(selectedServer=this,b+='selected\x3d"selected"');b+='value\x3d"'+this.id+'"\x3e\x3c/option\x3e';b=c.$(b);b.text(this.name);c.$(a).append(b);b.data("jiraapplink",this)});c.$(a).change(function(d){d=c.$("option:selected",a).data("jiraapplink");b(d)})},showSpinner:function(a,
b,d,g){c.$.data(a,"spinner",Raphael.spinner(a,b,"#666"));d&&c.$(a).css("marginLeft",1.2*-b);g&&c.$(a).css("marginTop",1.2*-b)},hideSpinner:function(a){c.$(a).css("marginTop","");c.$(a).css("marginLeft","");var b=c.$.data(a,"spinner");b&&(b(),delete b,c.$.data(a,"spinner",null))},setSelectedIssue:function(a){this.selectedIssue=a;this.enableInsert()},insertSelected:function(){this.selectedIssue&&this.insertIssueLink(this.selectedIssue.key)},createIssueTableFromUrl:function(a,b,d,g,e,f,l,p,t){c.$("div.data-table",
a).remove();var u=c.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(a),q=c.$('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e').appendTo(u);this.removeError(a);this.showSpinner(q[0],50,!0,!0);var h=this;this.currentXhr=AppLinks.makeRequest({appId:b,type:"GET",url:d,dataType:"xml",success:function(b){q.remove();var d=c.$("item",b);k.enableElement(c.$(":disabled",a));if(d.length){var m=c.$('\x3ctable class\x3d"my-result aui"\x3e\x3c/table\x3e');c.$(".jiraSearchResults",
a).append(m);var n=[];t&&n.push({className:"issue-checkbox-column",title:'\x3cinput type\x3d"checkbox" name\x3d"jira-issue-all" checked/\x3e',renderCell:function(a,b){b=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({issueKey:b.key});c.$(b).appendTo(a)}});var p=[{className:"issue-key-column",title:"Key",renderCell:function(a,b){b=Confluence.Templates.ConfluenceJiraPlugin.issueKey({issueIconUrl:b.iconUrl,issueKey:b.key});c.$(b).appendTo(a)}},{className:"issue-summary-column",
title:"Summary",renderCell:function(a,b){a.text(b.summary)}}];n=n.concat(p);var r=new c.DataTable(m,n);c.$(d).each(function(){var a={iconUrl:c.$("type",this).attr("iconUrl"),key:c.$("key",this).text(),summary:c.$("summary",this).text(),url:c.$("link",this).text()};r.addRow(a)});m.bind("row-action",function(a,b){e.call(h,b)});m.bind("row-select",function(a,b){g.call(h,b)});r.selectRow(0);l&&(b=c.$("issue",b).attr("total"),l.call(h,b))}else f&&f(),b="No search results found.",
d=c.$('\x3cdiv class\x3d"message-panel"/\x3e'),h.msg(d,b,"info"),c.$(".jiraSearchResults",a).append(d)},error:function(b){k.enableElement(c.$(":disabled",a));q.remove();p.call(h,b)}})},retrieveJson:function(a,b,c,g){AppLinks.makeRequest({appId:a,type:"GET",url:b,dataType:"json",success:c,error:g})}}})(AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1E3,MINIMUM_MAX_ISSUES_VAL:1,
title:function(){return "Search"},init:function(a){var c=require("confluence/form-state-control");a.html('\x3cdiv id\x3d"my-jira-search"\x3e\x3c/div\x3e');var b=this,e=AJS.$("#my-jira-search");this.container=e;var d=function(){e.children(":not(div.jira-search-form)").remove()},g=function(){c.enableElement(AJS.$("input.text,button",e))},k=function(){c.disableElement(AJS.$("input.text,button",e))},h=function(a){d();b.disableInsert();a&&(b.selectedServer=a);b.selectedServer.authUrl?
(k(),a=b.createOauthForm(function(){d();g()}),e.append(a)):(g(),AJS.$(".search-help").show())};this.authCheck=h;this.doSearch=function(a){var l=a&&a.searchValue,f=a&&a.serverName;l&&AJS.$("input:text",e).val(l);if(f&&f!=this.selectedServer.name){for(var g=AJS.Editor.JiraConnector.servers,r=!1,p=0;p<g.length;p++)if(g[p].name==f){AJS.$('option[value\x3d"'+g[p].id+'"]',e).attr("selected","selected");AJS.$("select",e).change();r=!0;break}if(!r){n(AJS.Meta.get("is-admin"));return}}this.currentXhr&&4!=
this.currentXhr.readyState||(f=l||AJS.$("input",e).val(),AJS.Editor.JiraAnalytics&&(l=AJS.JQLHelper.checkQueryType(f))&&AJS.Editor.JiraAnalytics.triggerSearchEvent({type:l,source:"dialog"}),l=function(l,d,f){d=e.find("#jiraIssueColumnSelector");var m=d.val()&&d.val();c.disableElement(AJS.$("select",e));k();b.lastSearch=l;b.createIssueTableFromUrl(e,b.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3d"+encodeURIComponent(l)+"\x26returnMax\x3dtrue\x26tempMax\x3d20\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink",
b.selectHandler,b.insertLinkFromForm,function(){b.addDisplayOptionPanel();b.loadMacroParams(m);b.bindEventToDisplayOptionPanel(!0,a);b.enableInsert()},function(c){b.addDisplayOptionPanel();b.loadMacroParams(m);b.bindEventToDisplayOptionPanel(!1,a);b.updateTotalIssuesDisplay(c);b.checkAutoSelectColumns();a&&a.isAutoSearch&&b.focusForm()},function(c){b.disableInsert();400==c.status?f?f():(AJS.$("div.data-table",e).remove(),b.warningMsg(e,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))):
(AJS.$("div.data-table",e).remove(),b.ajaxError(c,h));a&&a.isAutoSearch&&b.focusForm()},!0)},AJS.JQLHelper.isFilterUrl(f)?(f=decodeURIComponent(f),g=AJS.JQLHelper.findServerIndexFromUrl(f,AJS.Editor.JiraConnector.servers),-1!=g?(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[g].id+'"]',e).attr("selected","selected"),AJS.$("select",e).change(),(f=AJS.JQLHelper.getFilterFromFilterUrl(f))?(AJS.$("input",e).val(f),l(f)):(d(),b.warningMsg(e,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",
Confluence.Templates.ConfluenceJiraPlugin.learnMore())))):(d(),b.disableInsert(),n(AJS.Meta.get("is-admin")))):AJS.JQLHelper.isIssueUrlOrXmlUrl(f)?(f=decodeURIComponent(f),f=AJS.JQLHelper.getJqlAndServerIndexFromUrl(f,AJS.Editor.JiraConnector.servers),m(f)&&(AJS.$("input",e).val(f.jqlQuery),l(f.jqlQuery,!1,null))):f.match(b.jql_operators)?l(f,!1,null):AJS.JQLHelper.isSingleKeyJQLExp(f)?l("key \x3d "+f,!0):AJS.JQLHelper.isMultipleSingleKeyJQLExp(f)?l("key in ("+f+")",!0):l('summary ~ "'+f+'" OR description ~ "'+
f+'"',!1,null))};b.addSearchForm();var m=function(a){if(-1!=a.serverIndex)if(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[a.serverIndex].id+'"]',e).attr("selected","selected"),AJS.$("select",e).change(),0==a.jqlQuery.length)d(),b.errorMsg(e,"The Jira server didn\u0027t understand your search query. If you entered JQL, please ensure that it\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}");else var c=a.jqlQuery;else d(),b.disableInsert(),n(AJS.Meta.get("is-admin"));return c};b.processJiraParams=m;var n=function(a){a=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:a,
contextPath:Confluence.getContextPath()});b.noServerMsg(e,a);AJS.$("#open_applinks").bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=!0;AJS.Editor.JiraConnector.refreshAppLink=function(){b.refreshSearchForm()}})};b.bindPasteEvent();AJS.$(a).select(function(){b.validate()});$(document).tooltip({live:".jql-display-opts-open.disabled",title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0})},focusForm:function(){AJS.$('input[name\x3d"jiraSearch"]',
this.container).focus()},addSearchForm:function(){var a=this;a.container.empty();var c=AJS.Editor.JiraConnector.servers;a.selectedServer=c[0];var b=!1;1<c.length&&(b=!0);b=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:b});b=AJS.$(b).appendTo(a.container);1<c.length&&(c=AJS.$('\x3cselect class\x3d"select" tabindex\x3d"0"\x3e\x3c/select\x3e').insertAfter("div.search-input",b),a.applinkServerSelect(c,a.authCheck));a.authCheck(a.selectedServer);AJS.$("button",a.container).click(function(){a.doSearch()});
a.setActionOnEnter(AJS.$("input.text",a.container),a.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var c=this;setTimeout(function(){var b=AJS.$(c).val();AJS.JQLHelper.isFilterUrl(b)?a.doSearch():AJS.JQLHelper.isIssueUrlOrXmlUrl(b)&&(b=decodeURIComponent(b),b=AJS.JQLHelper.getJqlAndServerIndexFromUrl(b,AJS.Editor.JiraConnector.servers),a.processJiraParams(b)&&(AJS.$(c).val(b.jqlQuery),a.doSearch()))},100)})},refreshSearchForm:function(){this.container.empty();
this.addSearchForm();this.bindPasteEvent()},validate:function(a,c){var b=this.container,e=AJS.$("input:checkbox[name\x3djira-issue]",b),d=AJS.Editor.JiraConnector.Panel.Search.prototype;e.length||a?(b=AJS.$("input:checkbox[name\x3djira-issue]:checked",b).length,0<b||a?d.enableInsert():d.disableInsert(),d.changeInsertOptionStatus(b,a,c)):(AJS.$(".jira-oauth-message-marker",b).length&&d.authCheck(this.selectedServer),AJS.$("input",b).focus(),d.disableInsert());d.isInsertDisabled()||d.validateMaxIssues()},
isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL},validateMaxIssues:function(a){function c(){b.next("#jira-max-number-error").remove()}var b=AJS.$("#jira-maximum-issues");switch(AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()){case "insert-single":case "insert-count":c();b.attr("disabled","disabled");break;case "insert-table":var e=AJS.Editor.JiraConnector.Panel.Search.prototype;b.removeAttr("disabled");var d=b.val();
if(""===AJS.$.trim(d)){if(a&&"keyup"===a.type){c();break}if(a&&"blur"===a.type){d=e.MAXIMUM_MAX_ISSUES_VAL;b.val(d);break}}e.isValidMaxIssues(d)?(c(),e.enableInsert()):(c(),b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues()),e.disableInsert())}},customizedColumn:null,checkAndSetDefaultValueMaximumIssues:function(a){if(a){var c=a.element||AJS.$("#jira-maximum-issues");a=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;""===AJS.$.trim(c.val())&&c.val(a)}else AJS.log("Cannot set default value for Maximum Issues")},
setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var a=this,c="insert-count"==AJS.$("input:radio[name\x3dinsert-advanced]:checked").val(),b=[],e=[],d=[],g=[],k=[],h={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name\x3djira-issue]").each(function(a){a=AJS.$(this);a.is(":checked")?e[e.length]=a.val():d[d.length]=a.val()});if(c)h.count="true";else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){h.columns=this.defaultColumns;h.columnIds=this.defaultColumnIds;
return}b=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");b.length?(h.columns=b.map(function(b){return a.selectedServer.columns.find(function(a){return a.id===b.id}).custom?b.text.replace(/%/g,encodeURIComponent("%")).replace(/,/g,encodeURIComponent(",")).replace(/;/g,encodeURIComponent(";")):b.id}).map(function(b){var c=a.aliases.find(function(a){return a.id===b});return c?c.clauseName:b}).join(","),h.columnIds=b.map(function(a){return a.id}).join(","),(g=a.selectedServer.columns.find(function(a){return a.clauseNames.find(function(a){a=
a.toLowerCase();return"epic link"===a||"gh.epic.link.name"===a})}))&&!b.some(function(a){return a.id===g.id})&&(k=a.selectedServer.columns.filter(function(a){return a.clauseNames.find(function(a){a=a.toLowerCase();return"epic name"===a||"gh.epic.label.name"===a||"epic colour"===a||"gh.epic.color.name"===a||"epic status"===a||"gh.epic.status.name"===a})}),b.some(function(a){return k.some(function(b){return b.id===a.id})})&&(h.epicLinkId=g.id))):(h.columns=this.defaultColumns,h.columnIds=this.defaultColumnIds)}c=
AJS.$("input:radio[name\x3dinsert-advanced]:checked").val();"insert-single"===c?h.key=e.toString():h.jqlQuery=0==d.length?this.lastSearch+" ":1==e.length?"key \x3d "+e.toString():"key in ("+e.toString()+")";"insert-table"===c&&(h.maximumIssues=AJS.$("#jira-maximum-issues").val());return h},insertLinkFromForm:function(){var a=this.container;AJS.$("input:checkbox[name\x3djira-issue]",a).length&&0<AJS.$("input:checkbox[name\x3djira-issue]:checked",a).length&&this.insertLink()},insertLink:function(a){a=
a&&"function"===typeof a.insertIssueLinkWithParams?a:this;var c=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(c);return!0},loadMacroParams:function(a){var c=this.macroParams;c?(c.maximumIssues||AJS.$("#jira-maximum-issues").attr("disabled","disabled"),"true"==c.count?AJS.$("#opt-total").prop("checked",!0):(AJS.$("#opt-table").prop("checked",!0),AJS.$("#jira-maximum-issues").removeAttr("disabled"),this.checkAndSetDefaultValueMaximumIssues({defaultVal:c.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL}))):
this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(a)},selectHandler:function(){var a=this.container.find("tr.selected");a.length&&a.unbind("keydown.space").bind("keydown.space",function(c){32!=c.which&&32!=c.keyCode||a.find("[type\x3dcheckbox]").trigger("click")})},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(a){return!1})},
updateTotalIssuesDisplay:function(a){var c=this.selectedServer.url+"/issues/?jql\x3d"+this.lastSearch;20<a&&AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:c}));a=AJS.format("{0} issues",a);AJS.$(".total-issues-text").html(a);AJS.$(".total-issues-link").attr("href",c)},prepareColumnSelect:function(a){var c=this,b=!(this.macroParams&&!this.macroParams.columnIds),e=a||this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(",")||
this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(",")||this.defaultColumnIds.split(","),d=this.selectedServer,g=function(a){var d=AJS.$("#jiraIssueColumnSelector"),g="",k="";a.filter(function(a){return a.navigable}).sort(function(a,d){var f=e.map(function(a){var b=c.aliases.find(function(b){return b.clauseName===a});return b?b.id:a});return f.indexOf(b||!a.custom?a.id:a.name.toLowerCase())-f.indexOf(b||!d.custom?d.id:d.name.toLowerCase())}).forEach(function(a){e.find(function(c){return b?
c===a.id:a.clauseNames.includes(c)||c===a.name.toLowerCase()})?k+=AJS.template('\x3coption selected\x3d"true" value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:a.id,fieldName:a.name}):g+=AJS.template('\x3coption value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:a.id,fieldName:a.name})});d.hide();d.html(k+g);d.show();d.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=d};d.columns&&
0<d.columns.length?g(d.columns):this.retrieveJson(d.id,"/rest/api/2/field",function(a){a&&a.length&&(d.columns=a,g(d.columns))})},expandDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay"),c=a.height();a.css("top","");a.css("bottom",-(c-40)+"px");a.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:414},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",
!1)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",!0)},checkAutoSelectColumns:function(){AJS.$("#opt-table").prop("checked")?this.enableAutoSelectColumns():(this.disableAutoSelectColumns(),this.enableInsert())},bindEventToDisplayOptionPanel:function(a,c){var b=this,e=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),d=AJS.$(".jql-display-opts-overlay"),g=AJS.$(".jql-display-opts-inner .radio"),k=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]"),
h=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]");AJS.$("#jira-maximum-issues").on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);d.css("top","414px");e.click(function(a){a.preventDefault();AJS.$(this).hasClass("disabled")||(AJS.$(this).hasClass("jql-display-opts-open")?(b.expandDisplayOptPanel(),jQuery(this).addClass("jql-display-opts-close"),jQuery(this).removeClass("jql-display-opts-open")):(b.minimizeDisplayOptPanel(),jQuery(this).removeClass("jql-display-opts-close"),
jQuery(this).addClass("jql-display-opts-open")))});g.change(function(){b.checkAutoSelectColumns();b.validateMaxIssues()});k.bind("click",function(){AJS.$(this).prop("checked")?h.prop("checked","checked"):h.removeAttr("checked");b.validate()});h.change(function(){0<AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:not(:checked)").length?k.removeAttr("checked"):k.prop("checked","checked");b.validate()});b.validate(a,c)},changeInsertOptionStatus:function(a,c,b){var e=AJS.$("#opt-single"),d=AJS.$("#opt-total"),
g=AJS.$("#opt-table"),k=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:checked");a="checked"===AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]").attr("checked");var h=1===k.length,m=1<k.length;k=0===k.length;var n=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name\x3djiraSearch]").val()),l=function(){b&&b.isJqlQuery?g.click():e.click()},q=function(){d.attr("disabled","disabled");g.removeAttr("disabled");e.removeAttr("disabled");l();setTimeout(function(){l()},
100)},f=function(){e.attr("disabled","disabled");d.removeAttr("disabled");"insert-single"===AJS.$("input[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){g.removeAttr("disabled").click()},100)},t=function(){g.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");e.removeAttr("disabled","disabled");"insert-single"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){g.click()},100)};AJS.$(".jql-display-opts-open").removeClass("disabled");
e.removeAttr("disabled");d.removeAttr("disabled");g.removeAttr("disabled");a&&h&&n?q():a&&h&&!n?t():m?f():h&&!a?q():c?f():k&&(e.attr("disabled","disabled"),d.attr("disabled","disabled"),g.attr("disabled","disabled"),AJS.$(".jql-display-opts-close").click(),AJS.$(".jql-display-opts-open").addClass("disabled"))},isInsertTableType:function(){return"insert-table"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),
c=AJS.$("#jira-maximum-issues");!a.length||a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(c.val())?this.disableInsert():this.enableInsert()},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:!0,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(a){var b=AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl);b.length&&b.val(a)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",
this.container);a.length?a.focus():(a=AJS.$(".project-select",this.container),a.length&&a.focus())},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();this.selectedServer.authUrl?this.showOauthChallenge():this.serverSelect()},ajaxAuthCheck:function(a){var b=this;this.endLoading();this.ajaxError(a,function(){b.authCheck(b.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",
this.container).remove();var a=this,b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(!1===this.formHasError&&this.projectOk())return this.enableInsert(),!0;this.disableInsert();return!1},startLoading:function(){var a=require("confluence/form-state-control");this.removeError(this.container);AJS.$(".loading-blanket",
this.container).removeClass("hidden");a.disableElement(AJS.$("input,select,textarea",this.container));this.disableInsert();this.handleInsertWaiting(!0)},endLoading:function(){var a=require("confluence/form-state-control");AJS.$(".loading-blanket",this.container).addClass("hidden");a.enableElement(AJS.$("input,select,textarea",this.container));AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE&&a.disableElement(AJS.$(".issuetype-select",this.container));this.setInsertButtonState();
this.handleInsertWaiting(!1)},bindEvent:function(){var a=this;AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl).keyup(function(){a.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var a=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid\x3d"+a+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "Create New Issue"},init:function(a){var b=this;
a.html('\x3cdiv class\x3d"create-issue-container"\x3e\x3c/div\x3e');this.container=AJS.$("div.create-issue-container");this.selectedServer=AJS.Editor.JiraConnector.servers[0];this.jipForm=new jiraIntegration.JiraCreateIssueForm({container:".create-issue-container",renderSummaryAndDescription:!0,onError:function(){AJS.$(".field-group .error",this.container).remove();b.formHasError=!0;b.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();b.setInsertButtonState();
b.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(a,e){AJS.$(".field-group .error",this.container).remove();b.formHasError=!!e.length;b.setInsertButtonState()},ajax:AJS.$.ajax});a.onselect=function(){b.onselect()};this.bindEvent()},convertFormToJSON:function(a){if(!jiraIntegration)return AJS.logError("Jira integration plugin is missing!"),"";var b={issues:[]},d={};d.fields={project:{id:AJS.$(".project-select option:selected",a).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",
a).val()},summary:AJS.$('.field-group [name\x3d"summary"]',a).val(),description:AJS.$('.field-group [name\x3d"description"]',a).val()};a.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(a,b){a=AJS.$(b);d.fields[a.attr("name")]=jiraIntegration.fields.getJSON(a)});b.issues.push(d);return JSON.stringify(b)},validateRequiredFieldInForm:function(a){var b=!0,d="placeholder"in document.createElement("input");a.find(".field-group .icon-required, .field-group .aui-icon-required").each(function(a,
c){c=AJS.$(c).parent();a=c.text();var f=c.nextAll("input,select,textarea"),g=AJS.$.trim(f.val());if(!g||!d&&g==f.attr("placeholder"))b=!1,c=c.parent(),a=AJS.format("{0} is required",a),c.append(aui.form.fieldError({message:a}))});return b},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var a=this,b=Confluence.getContextPath()+"/rest/jira-integration/1.0/issues",d=AJS.$("div.create-issue-container form"),e=this.jipForm.getCurrentServer();
a.clearFieldErrors();a.validateRequiredFieldInForm(d)&&(this.startLoading(),AJS.$.ajax({type:"POST",contentType:"application/json",url:b+"?applicationId\x3d"+this.selectedServer.id,data:this.convertFormToJSON(d),success:function(b){var c=b&&b.issues&&b.issues[0]&&b.issues[0].issue&&b.issues[0].issue.key;c?(a.insertIssueLink(c,e.displayUrl+"/browse/"+c),a.resetIssue()):(_.isEmpty(b.errors[0].elementErrors.errorMessages)||(c=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:b.errors[0].elementErrors.errorMessages,
serverUrl:e.displayUrl}),a.errorMsg(AJS.$("div.create-issue-container"),c)),_.each(b.errors[0].elementErrors.errors,function(a,b){a=aui.form.fieldError({message:a});AJS.$(AJS.format(".field-group [name\x3d{0}]",b),d).after(a)}));a.endLoading()},error:function(b,d){a.ajaxAuthCheck(b)}}))},onselect:function(){var a=!!AJS.$(".aui-message \x3e .oauth-init",this.container).length;this.selectedServer&&!this.selectedServer.authUrl&&a?this.jipForm.defaultFields.server.trigger("change"):this.setInsertButtonState()},
analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "Recently Viewed"},init:function(d){var a=AJS.Editor.JiraConnector.servers;d.html('\x3cdiv id\x3d"my-recent-issues" '+(1<a.length?'class\x3d"multi-server" ':"")+"\x3e\x3c/div\x3e");var b=this;this.selectedServer=a[0];1<a.length&&(a=AJS.$('\x3cdiv class\x3d"jira-server-select"\x3e\x3cform action\x3d"#" method\x3d"post" class\x3d"aui"\x3e\x3cdiv class\x3d"field-group"\x3e\x3clabel\x3eServer\x3c/label\x3e\x3cselect class\x3d"select" \x3e\x3c/select\x3e\x3c/div\x3e\x3c/form\x3e\x3c/div\x3e').appendTo("div#my-recent-issues"),
this.applinkServerSelect(AJS.$(".select",a),function(a){b.selectedServer=a;b.onselect()}));d.onselect=function(){b.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var d=require("confluence/form-state-control"),a=this,b=AJS.$("div#my-recent-issues");this.container=b;var e=function(){b.children().not(".jira-server-select").remove()},g=function(){if(a.selectedServer.authUrl){e();var c=a.createOauthForm(function(){f()});b.append(c)}else f()};var f=function(){if(!a.currentXhr||
4==a.currentXhr.readyState){var c=AJS.$(".select",b);d.disableElement(c);e();a.createIssueTableFromUrl(b,a.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3dkey+in+issueHistory()+ORDER+BY+lastViewed+DESC\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink\x26tempMax\x3d50\x26returnMax\x3dtrue",a.setSelectedIssue,a.insertLink,a.disableInsert,function(){c.length&&c.focus()},function(c){AJS.$("div.data-table",b).remove();a.ajaxError(c,g)},!1)}};g()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});
AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('Display as') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('Single issue') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display the macro as a single issue.') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('Total issue count') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display total number of issues as a link. E.g.') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0} issues',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('Table') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Customize your columns below.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Maximum issues') + '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">' + soy.$$escapeHtml('Leave empty to get all issues.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Columns to display') + '</label><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('Start typing to see possible columns') + '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('Search') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('If you connect Confluence to Jira you can easily link issues...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('Your administrator can set this up.') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked/>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"/> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('Displaying first 20 results.') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('View all.') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/Jira+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('Learn More') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0"></select>' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('Preview') + '</button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="javascript:void(0)"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('Chart by') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('Period') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('Hourly') + '</option><option value="daily">' + soy.$$escapeHtml('Daily') + '</option><option value="weekly">' + soy.$$escapeHtml('Weekly') + '</option><option value="monthly">' + soy.$$escapeHtml('Monthly') + '</option><option value="quarterly">' + soy.$$escapeHtml('Quarterly') + '</option><option value="yearly">' + soy.$$escapeHtml('Yearly') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('Days previously') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('Number of days to include (counting back from today).') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('Cumulative totals') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('Progressively add totals (1, 2, 3) or show individual values (1,1,1).') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('Show unresolved trend') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('Include a subplot showing unresolved issues.') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('Show versions') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('All versions') + '</option><option value="major">' + soy.$$escapeHtml('Only major versions') + '</option><option value="none">' + soy.$$escapeHtml('None') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('Mark version release dates in the chart.') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('XAxis') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('YAxis') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('Rows to display') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('More to come...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('OTHER Jira CONTENT') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('The Jira server didn\x27t understand your search query. If you entered JQL, please ensure that it\x27s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('The width must be in correct format') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('The width must be a number between 100 and 9000') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('Must be a number between 1 and 1000.') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira Charts are not available for your version of Jira. Upgrade to Jira 6.1.1 or later to use this macro.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('Server') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('Project') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('Issue Type') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('Summary') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('Description') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('There were errors creating an issue in') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>Jira</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){a&&"jira"===a.placeholderType&&AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)});AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType&&AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"Jira Macro",tooltip:"Instructional text is replaced with a Jira Macro on click.",activation:{click:!0,keypress:!1}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=function(f){var e=require("confluence/form-state-control"),r="Insert",t="Cancel",u="Insert Jira Chart",c,d,n=function(a){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(u);d=AJS.Editor.JiraChart.Panels;for(var b=0;b<d.length;b++){"function"===typeof d[b].title?c.addPanel(d[b].title()):void 0!==d[b].title&&c.addPanel(d[b].title);
var v=c.getCurrentPanel();d[b].init(v)}f("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira Issue/Filter"}));c.addButton(r,function(){var a=d[c.getCurrentPanel().id],b=a.chartType;0<c.getCurrentPanel().body.find("#jira-chart-content-"+b).length&&a.isImageChartExisted()?(a=a.getMacroParamsFromDialog(),m(a),AJS.Editor.JiraChart.close()):h(f("#jira-chart-content-"+a.chartType))},"insert-jira-chart-macro-button");
c.addLink("Select Macro",function(){c.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");c.addCancel(t,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var a=d[c.getCurrentPanel().id],b=c.getCurrentPanel().body,e=AJS.Editor.JiraChart.Helper.getSelectedServer(b);k(b,e);g(b);a.handleInsertButton();a.focusForm();a.resetDisplayOption()});b=c.getCurrentPanel().body;g(b);var e=e||function(a){var b={};_.each(a,
function(a,c){b[a.chartType]=c});return b}(d);w(e,a);l();c.gotoPanel(a&&a.params?e[a.params.chartType]:0);c.overrideLastTab();c.show();x()},y=function(){_.each(AJS.Editor.JiraChart.Panels,function(a){a.preBinding&&"function"===typeof a.preBinding&&a.preBinding()})},x=function(){f("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();AJS.Editor.JiraConnector&&AJS.Editor.JiraConnector.openCleanDialog(!1)})},h=function(a){void 0!==AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(a)&&
d[c.getCurrentPanel().id].renderChart()},g=function(a){if(a.find("#jira-chart-support-all-version").length)return!0;var b=AJS.Editor.JiraChart.Helper.getSelectedServer(a).buildNumber;return-1==b||6109<=b&&6155>b?(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion()),a.find("#jira-chart-search-input").attr("disabled","disabled"),a.find("#jira-chart-search-button").attr("disabled","disabled"),a=a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),
a.hasClass("jirachart-display-opts-close")&&a.click(),a.addClass("disabled"),l(),!1):!0},m=function(a){AJS.Editor.inRichTextMode()&&tinymce.confluence.macrobrowser.macroBrowserComplete({name:"jirachart",params:a})},w=function(a,b){for(var c=0;c<d.length;c++)d[c].resetDialogValue();y();b&&b.params&&d[a[b.params.chartType]].bindingDataFromMacroToForm(b.params)},p=function(a){a.find(".jira-oauth-message-marker").remove();a.find(".jira-chart-img").empty();a.find("#jira-chart-search-input").empty()},l=
function(){e.disableElement(f("#jira-chart").find(".insert-jira-chart-macro-button"))},k=function(a,b){f(".jira-oauth-message-marker",a).remove();var c={selectedServer:b,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};b&&b.authUrl&&(b=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(c,function(){f(".jira-oauth-message-marker",a).remove();AJS.Editor.JiraChart.search(a)}),a.find("div.jira-chart-search").append(b))},q=function(a){a.find("#jira-chart-search-input").removeAttr("disabled");
a.find("#jira-chart-search-button").removeAttr("disabled");a.find(".jirachart-display-opts-open").removeClass("disabled")};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(a){if(void 0===AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));var b=!1}else b=!0;b&&(n(a),b=c.getCurrentPanel().body,g(b)&&(q(b),void 0!==a.params&&void 0!==a.params.serverId&&h(b),
a=AJS.Editor.JiraChart.Helper.getSelectedServer(b),k(b,a)))},search:h,disableInsert:l,enableInsert:function(){var a=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");a.is(":disabled")&&e.enableElement(a)},disableSearch:function(a){e.disableElement(a.find("#jira-chart-search-button"))},enableSearch:function(a){a.find("#jira-chart-search-button").is(":disabled")&&e.enableElement(a.find("#jira-chart-search-button"))},insertJiraChartMacroWithParams:m,open:n,clearChartContent:p,loadServers:function(a){0<
AJS.Editor.JiraConnector.servers.length&&AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(a.find("#jira-chart-servers"),function(b){p(a);g(a)&&(k(a,b),q(a))})},validateServerSupportedChart:g}}(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=function(m){var k=/^\d+$/,f={},e=function(a){a=a&&"string"===typeof a?a.replace("px",""):"";"auto"===a&&(a="");0<a.indexOf("%")&&(a=4*a.replace("%",""));return a},h=function(a){return k.test(a)},g=function(a){var b=AJS.Editor.JiraConnector.servers;return 1<b.length?a.find("#jira-chart-servers option:selected").data("jiraapplink"):b[0]};return{getSelectedServer:g,bindingCommonChartElements:function(a){return{jql:a.find("#jira-chart-search-input"),width:a.find("#jira-chart-width"),
border:a.find(".jira-chart-show-border"),showinfor:a.find(".jira-chart-show-infor"),displayOption:a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:a.find("#jira-chart-servers")}},bindingCommonDataFromMacroToForm:function(a,b){a.jql.val(decodeURIComponent(b.jql));a.width.val(b.width);a.border.attr("checked","true"===b.border);a.showinfor.attr("checked","true"===b.showinfor);1<AJS.Editor.JiraConnector.servers.length&&a.server.val(b.serverId)},getCommonMacroParamsFromDialog:function(a,
b){b=g(b);return{jql:encodeURIComponent(a.jql.val()),width:e(a.width.val()),border:a.border.prop("checked"),showinfor:a.showinfor.prop("checked"),serverId:b.id,server:b.name,isAuthenticated:!b.authUrl}},getCommonChartParamsRequest:function(a,b){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:a.jql,serverId:a.serverId,width:a.width,border:a.border,showinfor:a.showinfor,chartType:b}}}},convertSearchTextToJQL:function(a){var b=AJS.Editor.JiraConnector.servers,c=a.find("#jira-chart-search-input").val();
if(0===c.indexOf("http")){var d=AJS.JQLHelper.findServerIndexFromUrl(c,b);if(-1!==d)d=b[d].id,a.find("#jira-chart-servers").val(d);else{b=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});a.find(".jira-chart-img").html(b);AJS.Editor.JiraChart.disableInsert();return}}(b=AJS.JQLHelper.convertToJQL(c,d))?a.find("#jira-chart-search-input").val(b):(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid()),
AJS.Editor.JiraChart.disableInsert());return b},convertFormatWidth:e,isChartWidthValid:function(a){a.next().next(".width-error").remove();var b=e(a.val());if(b)if(h(b)){if(100>b||9E3<b)var c="wrongNumber"}else c="wrongFormat";return c?(a.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:c})),AJS.Editor.JiraChart.disableInsert(),!1):!0},isNumber:h,isJqlNotEmpty:function(a){return a?""!==AJS.$.trim(a.val())&&a.val()!==a.attr("placeholder"):!1},populateStatType:function(a,
b){var c=g(a);if(b){var d=f[c.id];d||AppLinks.makeRequest({appId:c.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:!1,success:function(a){a&&(d=f[c.id]=a)},error:function(a){if(a)try{f[c.id]=JSON.parse(a.responseText),d=JSON.parse(a.responseText)}catch(l){AJS.error("Error contacting the server "+c.id+" with response "+a.response)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+c.id)}}).fail(function(a){if(a)try{f[c.id]=JSON.parse(a.responseText),d=JSON.parse(a.responseText)}catch(l){AJS.error("Error contacting the server "+
c.id+" with response "+a.response)}});var e="";d&&"undefined"!==typeof d.stats&&_.each(d.stats,function(a){e+="\x3coption value \x3d '"+a.value+"'\x3e"+AJS.escapeHtml(a.label)+" \x3c/option\x3e"});b.html(e)}}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};
AJS.Editor.JiraChart.Panel.prototype={init:function(a){var b=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:1<AJS.Editor.JiraConnector.servers.length,chartType:this.chartType});a.html(b);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var a=this,b=function(){a.isFormValid()?AJS.Editor.JiraChart.search(a.container):
AJS.Editor.JiraChart.disableInsert()};a.container.find(a.clickableElements).click(b);a.container.find(a.onChangeElements).change(b);a.chartElements.jql.change(function(){this.value!==a.jqlWhenEnterKeyPress&&(a.container.find(".jira-chart-img").empty(),AJS.Editor.JiraChart.disableInsert());a.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){a.isFormValid()&&(a.jqlWhenEnterKeyPress=a.chartElements.jql.val(),AJS.Editor.JiraChart.search(a.container))},100)});var d=a.container.find("input[type\x3d'text']");
d.unbind("keydown").keydown(function(c){if(13==c.which){var b=function(c){d.unbind("keyup",b);a.isFormValid()&&AJS.Editor.JiraChart.search(a.container);"jira-chart-search-input"===d.attr("id")&&(a.jqlWhenEnterKeyPress=d.val());c.stopPropagation();return!1};d.keyup(b);c.stopPropagation();return!1}});a.bindSelectOption();a.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)?
AJS.Editor.JiraChart.search(a.container):AJS.Editor.JiraChart.disableInsert()})},renderChart:function(){var a=this,b=this.getChartParamsRequest(),d=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",c=this.container.find(".jira-chart-img");c.html('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e');var f=c.find(".loading-data")[0];AJS.$.data(f,"spinner",Raphael.spinner(f,50,"#666"));a.request&&a.request.abort();a.request=AJS.$.ajax({url:d,type:"POST",contentType:"application/json",data:JSON.stringify(b)}).done(function(b){c.html("").hide();
var d=AJS.$('\x3ciframe frameborder\x3d"0" id\x3d"chart-preview-iframe"\x3e\x3c/iframe\x3e');d.appendTo(c);var f=d[0].contentWindow,e=f.document;d.on("load",function(){f.AJS.$("#main").addClass("chart-preview-main");c.show();a.handleInsertButton()});b=b.replace("window.onload","var chartTest");e.open();e.write(b);e.close()}).error(function(a){"abort"!=a.statusText&&(AJS.log("Jira Chart Macro - Fail to get data from macro preview"),c.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"Unable to render Jira chart macro due to an execution error."})));
AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var a=this,b=this.chartElements.displayOption;b.addClass("jirachart-display-opts-open");b.removeClass("jirachart-display-opts-close");setTimeout(function(){var b=a.container.find(".jira-chart-option");
b.scrollTop(0);b.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var a=this.container.find(".jira-chart-option"),b=function(b){var c=a.position().top+"px",d="",e={top:430};b?(c="",d=40-a.find("#jiraChartMacroOption").height()+"px",e={bottom:0},a.css("overflow","auto")):a.css("overflow","hidden");a.css("top",c);a.css("bottom",d);a.animate(e,500)};a.css("top","430px");this.chartElements.displayOption.click(function(a){var c=AJS.$(this);a.preventDefault();c.hasClass("disabled")||
(c.hasClass("jirachart-display-opts-open")?(b(!0),c.addClass("jirachart-display-opts-close"),c.removeClass("jirachart-display-opts-open")):(b(),c.removeClass("jirachart-display-opts-close"),c.addClass("jirachart-display-opts-open")))})},isImageChartExisted:function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){this.isFormValid()&&this.isResultValid()?
AJS.Editor.JiraChart.enableInsert():AJS.Editor.JiraChart.disableInsert()}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(c){AJS.Editor.JiraChart.Panel.call(this);var a=this;this.title="Pie Chart";this.chartType="pie";this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(a.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(a.chartElements.jql)};
this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){a.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(a.container,a.chartElements.statType);a.isFormValid()?AJS.Editor.JiraChart.search(a.container):
AJS.Editor.JiraChart.disableInsert()})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var b=this.getMacroParamsFromDialog(),a=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(b,this.chartType);a.macro.params.statType=b.statType;return a};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,
this.container);a.chartType="pie";a.statType=this.chartElements.statType.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,a),this.chartElements.statType.val(a.statType))};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var c=this,f=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")},g=function(){var a=c.chartElements.periodName.val(),b=e.trim(c.chartElements.daysprevious.val()),d=c.container.find(".days-previous-error");if(""===b)return c.container.find(".days-previous-error").html("Days Previously is required field."),
!1;if(!AJS.Editor.JiraChart.Helper.isNumber(b)||0>b)return d.html("Days Previously must be a number and positive."),!1;switch(a){case "hourly":(isValid=10>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",10,a));break;case "daily":(isValid=300>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",300,a));break;case "weekly":(isValid=1750>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",
1750,a));break;case "monthly":(isValid=7500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",7500,a));break;case "quarterly":(isValid=22500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",22500,a));break;case "yearly":(isValid=36500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",36500,a));break;default:isValid=!1}isValid&&d.empty();return isValid};this.title="Created vs Resolved";
this.chartType="createdvsresolved";this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var a=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);
return g()&&a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);f()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");
this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});
this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),b=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);b.macro.params.periodName=a.periodName;b.macro.params.daysprevious=a.daysprevious;b.macro.params.isCumulative=
a.isCumulative;b.macro.params.showUnresolvedTrend=a.showUnresolvedTrend;b.macro.params.versionLabel=a.versionLabel;return b};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="createdvsresolved";a.periodName=this.chartElements.periodName.val();a.daysprevious=e.trim(this.chartElements.daysprevious.val());a.isCumulative=this.chartElements.isCumulative.prop("checked");a.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");
a.versionLabel=this.chartElements.versionLabel.val();return a};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);f()};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,a),c.chartElements.isCumulative.attr("checked","false"!==a.isCumulative),c.chartElements.showUnresolvedTrend.attr("checked","true"===a.showUnresolvedTrend),c.chartElements.periodName.val(""===a.periodName?"daily":
a.periodName),c.chartElements.versionLabel.val(a.versionLabel),c.chartElements.daysprevious.val(""===a.daysprevious?"30":a.daysprevious))}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(c){AJS.Editor.JiraChart.Panel.call(this);var b=this,d=function(){b.chartElements.numberToShow.val(5);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="Two Dimensional";this.chartType="twodimensional";this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";
this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var a=c(".twodimensional-number-of-result-error");var e=b.chartElements.numberToShow.val();AJS.Editor.JiraChart.Helper.isNumber(e)&&0<e?(a.empty(),a=!0):(a.html("The number of rows should be a positive integer"),a=!1);return a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};
this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);d()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");
this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),b=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);b.macro.params.xstattype=a.xstattype;b.macro.params.ystattype=a.ystattype;b.macro.params.sortBy=a.sortBy;b.macro.params.sortDirection=a.sortDirection;b.macro.params.showTotals=a.showTotals;
b.macro.params.numberToShow=a.numberToShow;return b};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="twodimensional";a.xstattype=this.chartElements.xstattype.val();a.ystattype=c.trim(this.chartElements.ystattype.val());a.sortBy=c.trim(this.chartElements.sortBy.val());a.sortDirection=c.trim(this.chartElements.sortDirection.val());a.showTotals=this.chartElements.showTotals.prop("checked");a.numberToShow=
this.chartElements.numberToShow.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,a),b.chartElements.xstattype.val(a.xstattype),b.chartElements.ystattype.val(a.ystattype),b.chartElements.sortBy.val(a.sortBy),b.chartElements.sortDirection.val(a.sortDirection),b.chartElements.showTotals.attr("checked","true"===a.showTotals),b.chartElements.numberToShow.val(a.numberToShow))};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);
d()};this.isImageChartExisted=function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=
function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");b.isFormValid()?AJS.Editor.JiraChart.search(b.container):AJS.Editor.JiraChart.disableInsert()})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-support-util', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-quit-dialog', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/is-valid-uri.js' */
define("confluence-collaborative-editor-plugin/util/is-valid-uri",[],function(){function d(a,c){var b=a.lastIndexOf(c);return-1!==b&&b===a.length-c.length}var e=/^(((?![':"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])+|\#(\w)+)$/,
f=/^(?:\s*(?:([a-zA-Z]*):\/\/|mailto:|skype:|callto:|facetime:|git:|irc:|irc6:|news:|nntp:|feed:|cvs:|svn:|mvn:|ssh:|itms:|notes:|smb:|sourcetree:|urn:|tel:|xmpp:|telnet:|vnc:|rdp:|whatsapp:|slack:|sip:|sips:|magnet:)[A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------\/]+(?:(?!['"<>])[\s-\$\+<->\^`\|~-------------------------------------------------------------------------!-#%-\*,-/:;\?@\[-\]_\{\}-------------------------------------------------A-Za-z-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9-------------------------------------------------------------])*(?:\s)*)$/;
return function(a){if(null===a)return!1;var c=e.test(a),b=(a=a.match(f))&&a.length&&a[1];a=a&&a.length&&(!b||!d(b,"script")&&!d(b,"data"));return c||a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/synchrony-presence.soy' */
// This file was automatically generated from synchrony-presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SynchronyPresence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SynchronyPresence == 'undefined') { Confluence.Templates.SynchronyPresence = {}; }


Confluence.Templates.SynchronyPresence.container = function(opt_data, opt_ignored) {
  return '<ul id="avatar-list" class="synchrony-doc-' + soy.$$escapeHtml(opt_data.docId) + ' collaborative-avatars-list"></ul><aui-inline-dialog id="more-avatars" alignment="bottom right" responds-to="toggle" aria-hidden="true"><h3>' + soy.$$escapeHtml('Also edited') + '</h3><ul id="more-avatars-list" class="collaborative-avatars-list"></ul></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.container.soyTemplateName = 'Confluence.Templates.SynchronyPresence.container';
}


Confluence.Templates.SynchronyPresence.avatar = function(opt_data, opt_ignored) {
  return '<li class="avatar-item' + ((opt_data.active) ? ' p' + soy.$$escapeHtml(opt_data.telepointer) + ' active' : '') + ((opt_data.currentUser) ? ' no-animate-entry' : '') + '"><span title="' + soy.$$escapeHtml(opt_data.title) + '" avatar="' + soy.$$escapeHtml(opt_data.initial) + '"' + ((opt_data.active) ? ' data-origin="' + soy.$$escapeHtml(opt_data.origin) + '"' : '') + ' class="avatar' + ((opt_data.active) ? ' active' : '') + '"' + ((opt_data.username) ? ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + '><img src="' + soy.$$escapeHtml(opt_data.avatarUrl) + '" alt="' + soy.$$escapeHtml(AJS.format('Profile picture for {0}',opt_data.username)) + '"/></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.avatar.soyTemplateName = 'Confluence.Templates.SynchronyPresence.avatar';
}


Confluence.Templates.SynchronyPresence.overlay = function(opt_data, opt_ignored) {
  return '<span id="synchrony-presence-overlay" class="overlay avatar"><a href="#" aria-controls="more-avatars" class="aui-button" data-aui-trigger></a></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.overlay.soyTemplateName = 'Confluence.Templates.SynchronyPresence.overlay';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-presence.js' */
define("confluence-collaborative-editor-plugin/synchrony-presence","backbone confluence-collaborative-editor-plugin/avatar-list-view confluence-collaborative-editor-plugin/overlay-view ajs confluence/legacy confluence/meta confluence/templates jquery underscore".split(" "),function(w,x,q,d,y,e,z,f,g){function r(){m=f(z.SynchronyPresence.container({docId:y.getContentId()}));f("#rte-toolbar").append(m);new x({el:"#avatar-list",collection:c});h=new q({collection:c});f("#rte-toolbar").append(h.render())}
function t(b){var a=f.extend({},b);a.id=b.origin;a.fullname=b.fullname||"Anonymous";a.name=b.name||"anonymous";a.username=b.name;a.avatarURL=d.contextPath()+b.avatarURL;a.active=b.active||!0;a.currentUser=b.currentUser||n===b.origin;return a}function A(){return c.filter(function(b){return b.get("active")}).length}function p(){var b=[];c.each(function(a){a.get("active")||g.some(k,function(b){return a.get("id")===b.name})||b.push(a)});g.each(b,function(a){c.remove(a)});g.each(k,
function(a){a.name===e.get("remote-user")||c.any(function(b){return b.get("id")===a.name||b.get("name")===a.name})||(a.active=!1,a.id=a.name,c.add(a))})}var c=new w.Collection;c.add(t({origin:"current-user",fullname:e.get("current-user-fullname"),name:e.get("remote-user"),avatarURL:e.get("current-user-avatar-url"),active:!0,currentUser:!0}));var u=!1,n="",l,k=[],m=null,h,v=!1;d.Rte.getEditor()&&d.Rte.getEditor().initialized?r():d.bind("rte-collab-ready",r);return{appendTo:function(b,a,f){n=b;u||(l=
l||require("tinymce"),u=!0,k=f,a.on("presence",function(a){h.hideInlineDialog();a.joined.filter(function(a){return a.origin!==n}).forEach(function(a){a=t(a);var b=c.findWhere({active:!1,id:a.name});b&&c.remove(b);c.add(a,{at:A()})});a.left.forEach(function(a){a.id=a.origin;c.remove(a);p()});p();v||(d.bind("editor-heartbeat",function(a,b){g.isArray(b.contributors)&&(k=b.contributors,p())}),v=!0);d.trigger("analyticsEvent",{name:"confluence.synchrony.user.in.session",data:{numOtherUsers:c.length,draftId:e.get("draft-id"),
contentId:e.get("content-id")}})}),l.EditorManager.activeEditor.on("click",g.bind(q.prototype.hideInlineDialog,h)));return m},setTinyMce:function(b){l=b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-list-view.js' */
define("confluence-collaborative-editor-plugin/avatar-list-view",["backbone","confluence-collaborative-editor-plugin/avatar-view","ajs","jquery","underscore"],function(d,e,c,g,f){return d.View.extend({initialize:function(){this.collection.on("add",this.addAvatar,this);this.collection.on("remove",this.removeAvatar,this);this.collection.each(this.addAvatar,this)},addAvatar:function(a){var b=new e({model:a});a.get("active")?(c.log(a.get("fullname")+" joined. ("+a.get("origin")+")"),a=this.$el.find("li.active").last(),
b=a.length?b.render().insertAfter(a):b.render().prependTo(this.$el)):b=b.render().appendTo(this.$el);a=function(a){a.addClass("show");a.children(".avatar").tooltip({fade:!0,gravity:"ne"})};6===this.collection.length?a(b):f.defer(a,b);this._manageOverlayClass()},removeAvatar:function(a){a.get("active")&&c.log(a.get("fullname")+" left. ("+a.get("origin")+")");this._manageOverlayClass()},_manageOverlayClass:function(){var a=this.collection.length;this.collection.each(function(b,c){b.set("hidden",5<a&&
4<=c)});5<a?this.$el.addClass("has-overlay"):this.$el.removeClass("has-overlay")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-view.js' */
define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(f,d,g,e){return f.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){return this.$el=e(g.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),
active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}))},remove:function(){this.$el.removeClass().addClass("avatar-item animate");this.model.get("hidden")||this.$el.addClass("removing");this.$el.one(this._getSupportedTransition(),function(){e(this).removeClass("animate removing");e(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var a=["It\u0027s you, but smaller!","Look at you, getting stuff done!"];
return a[Math.floor(Math.random()*a.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?"is editing this page.":"has made changes that haven\u0027t been published.")},_getSupportedTransition:function(){var a={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"},b=document.createElement("_"),c;for(c in a)if(void 0!==b.style[c])return a[c]},_synchronyTelepointerId:function(){for(var a=
""+(this.model.get("sub")||this.model.get("origin")||""),b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)%10}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/overlay-view.js' */
define("confluence-collaborative-editor-plugin/overlay-view","backbone aui/inline-dialog2 confluence-collaborative-editor-plugin/avatar-view confluence/templates ajs jquery underscore".split(" "),function(c,g,d,e,f,b,h){return c.View.extend({initialize:function(){this.collection.on("add remove",this.reconcile,this);this.inlineDialog2=document.querySelector("#more-avatars")},render:function(){this.$el=b(e.SynchronyPresence.overlay());this.$el.children("a").tooltip({fade:!0,gravity:"ne"});this.$el.on("click",
function(){b(".tipsy").remove()});return this.$el},reconcile:function(){var a=this.collection.where({hidden:!0});0<a.length?(this.$el.addClass("show"),this.$el.children(".aui-button").html("+"+a.length).attr("title",a.length+" "+"other users are editing."),b("#more-avatars-list").children().remove(),a.forEach(function(a){a=new d({model:a});b("#more-avatars-list").append(a.render())})):(this.$el.removeClass("show"),this.hideInlineDialog())},hideInlineDialog:function(){this.inlineDialog2&&
this.inlineDialog2.isVisible&&this.inlineDialog2.isVisible()&&(this.inlineDialog2.open=!1)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/status-indicator.soy' */
// This file was automatically generated from status-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.CollaborativeEditor.StatusIndicator.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.CollaborativeEditor == 'undefined') { Confluence.Templates.CollaborativeEditor = {}; }
if (typeof Confluence.Templates.CollaborativeEditor.StatusIndicator == 'undefined') { Confluence.Templates.CollaborativeEditor.StatusIndicator = {}; }


Confluence.Templates.CollaborativeEditor.StatusIndicator.container = function(opt_data, opt_ignored) {
  return '<div class="synchrony-status-indicator"><div class="status-indicator-icon aui-icon aui-icon-small' + ((opt_data.error) ? ' aui-iconfont-warning' : (opt_data.saving) ? ' aui-iconfont-devtools-task-in-progress' : ' aui-iconfont-approve') + '" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '"></div><div class="status-indicator-message" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.CollaborativeEditor.StatusIndicator.container.soyTemplateName = 'Confluence.Templates.CollaborativeEditor.StatusIndicator.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/status-indicator-view.js' */
define("confluence-collaborative-editor-plugin/status-indicator-view",["confluence/templates","backbone","ajs","jquery","underscore"],function(e,f,c,g,d){return f.View.extend({initialize:function(){this.$el.addClass("synchrony");this.listenTo(this.model,"change:saving change:error",this.render);this.model.set("confluenceUnreachable",!1);this.model.set("synchronyUnreachable",!1);this.model.set("tokenExpired",!1);c.bind("rte.heartbeat",d.bind(this.onConfluenceConnectedState,this));c.bind("rte.safe-save.error",
d.bind(this._errorPublishing,this));c.bind("rte.preview.error",d.bind(this._errorPublishing,this));this.model.set("connecting",!0);this._setProgressState()},render:function(){g(".tipsy").remove();this.$el.html(e.CollaborativeEditor.StatusIndicator.container(this.model.attributes))},onConnectedState:function(a){this.model.set("synchronyUnreachable",!1);if(!this.model.has("synchronyEntity")){this.model.set("synchronyEntity",a);var b=this;this.model.get("synchronyEntity").on("update",function(a){b._handleSynchronyUpdateEvent(a,
b)});this.model.get("synchronyEntity").on("ack",function(a){b._handleSynchronyAckEvent(a,b)})}this._setSavedState()},onDisconnectedState:function(){this.model.set("synchronyUnreachable",!0);this.model.set("connecting",!0);this._setErrorState()},onConfluenceConnectedState:function(){this.model.get("confluenceUnreachable")&&(this.model.set("confluenceUnreachable",!1),this._setSavedState())},onConfluenceDisconnectedState:function(){this.model.set("confluenceUnreachable",!0);this.model.set("connecting",
!0);this._setErrorState()},onTokenRenewedState:function(){this.model.get("tokenExpired")&&(this.model.set("tokenExpired",!1),this._setSavedState())},onTokenExpiredState:function(){this.model.set("tokenExpired",!0);this.model.set("connecting",!0);this._setErrorState()},_handleSynchronyUpdateEvent:function(a,b){"local"===a.updateType&&(b.model.set("pendingChanges",!0),b._saving())},_handleSynchronyAckEvent:function(a,b){a=0<a.pending.length;b.model.set("pendingChanges",a);a||b.model.set("lastSavedTime",
(new Date).getTime())},_saving:function(){var a=this,b=function(){setTimeout(function(){a.model.get("pendingChanges")||(new Date).getTime()-a.model.get("lastSavedTime")<a.model.get("minActiveTime")?b():a._setSavedState()},a.model.get("minActiveTime"))};this.model.get("saving")||(this.model.set("connecting",!1),this._setProgressState(),b())},_reachable:function(){return!this.model.get("confluenceUnreachable")&&!this.model.get("synchronyUnreachable")&&!this.model.get("tokenExpired")},_errorPublishing:function(a,
b){switch(b.status){case 0:this.onConfluenceDisconnectedState();break;case 500:case 503:this.onConfluenceDisconnectedState()}},_setSavedState:function(){this._reachable()&&"READ_ONLY"!==c.Meta.get("access-mode")?(this.model.set("statusMessage",this.model.get("connecting")?"Ready to go":"Changes saved"),this.model.set("isReadyToGo",!!this.model.get("connecting")),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("connecting",
!1),this.model.set("saving",!1),this.model.set("error",!1)):this._setErrorState()},_setErrorState:function(){var a="READ_ONLY"!==c.Meta.get("access-mode");this.model.set("statusMessage","Can\u0027t save changes");this.model.set("tooltipMessage",a?"Can\u0027t reach the server. Check your internet connection, and we\u0027ll keep trying to reconnect you.":"This site is read-only. You can\u0027t make changes right now.");this.model.set("saving",!1);this.model.set("error",!0)},_setProgressState:function(){this._reachable()?(this.model.set("statusMessage",
this.model.get("connecting")?"Connecting...":"Saving changes"),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("saving",!0),this.model.set("error",!1)):this._setErrorState()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/initialise-metrics.js' */
define("collaborative-editing-initialise-metrics-collection",["confluence/legacy"],function(a){return function(){var b={"confluence.editor":!0,"confluence.editor.preload":!0,"confluence.editor.quick.fetchContent":!0,"confluence.editor.tinymce":!0,"confluence.editor.synchrony":!0,"confluence.editor.synchrony.CR":!0,"confluence.editor.synchrony.connect":!0,"confluence.editor.synchrony.deps":!0,"confluence.editor.synchrony.init":!0,"confluence.editor.synchrony.jsLoad":!0,"confluence.editor.synchrony.snapshot":!0,
"confluence.editor.synchrony.unmarshal":!0},c={"confluence.editor.synchrony.connect":!0};a.registerPerformanceSession&&a.registerPerformanceSession("confluence.editor.quickedit.loading.times",b,c)}});require("confluence/module-exporter").safeRequire("collaborative-editing-initialise-metrics-collection",function(a){a()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/lib/SyncManager.js' */
define("confluence-collaborative-editor-plugin/lib/SyncManager",["ajs","jquery"],function(d,e){var f=["id"],g={START_SYNCHRONIZING_EVENT_NAME:"start",STOP_SYNCHRONIZING_EVENT_NAME:"stop",MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:10,MAX_WAIT_TIME_TO_RESTART:3E4,DEBUG_MODE:!1},h=function(a){return f.every(function(b){return"undefined"!==typeof a[b]})},c=function(a,b){this.entity=a;this.settings=e.extend({},g,b||{});this.controlSyncState={};this.recoveryTimeoutTasks={};a=function(a,b,c){h(c)?a(c):this.displayLogMessage("Invalid payload, missing required params",
b,c)};d.bind("synchrony."+this.settings.START_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.enableSynchronization.bind(this)));d.bind("synchrony."+this.settings.STOP_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.disableSynchronization.bind(this)))};c.prototype.getOrCreateControlSyncState=function(a){return this.controlSyncState[a]=this.controlSyncState[a]||{DISABLED_SYNC_STATUS:!1,RECOVERY_TIMER_RUNNING:!1,CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:0}};c.prototype.enableDebug=function(a){this.settings.DEBUG_MODE=
"undefined"!==typeof a?a:!0};c.prototype.displayLogMessage=function(){if(this.settings.DEBUG_MODE){var a=Array.prototype.slice.call(arguments);a.splice(0,0,"DEBUG: "+(new Date).toLocaleTimeString());console.log.apply(console,a)}};c.prototype.disableSynchronization=function(a){var b=a.id;this.getOrCreateControlSyncState(b).DISABLED_SYNC_STATUS=!0;this.clearAutoRecoveryTimer(b);this.setAutoRecoveryTimer(a);this.entity.stop(b);this.displayLogMessage("Stoping entity synchronization",b,e.extend(!0,{},
this.controlSyncState))};c.prototype.enableSynchronization=function(a){a=a.id;this.getOrCreateControlSyncState(a).DISABLED_SYNC_STATUS=!1;this.clearAutoRecoveryTimer(a);this.entity.start(a);this.displayLogMessage("Starting entity synchronization",a,e.extend(!0,{},this.controlSyncState))};c.prototype.clearAutoRecoveryTimer=function(a){var b=this.getOrCreateControlSyncState(a);clearTimeout(this.recoveryTimeoutTasks[a]);delete this.recoveryTimeoutTasks[a];b.RECOVERY_TIMER_RUNNING=!1};c.prototype.setAutoRecoveryTimer=
function(a){var b=a.id,c=this.getOrCreateControlSyncState(b);c.RECOVERY_TIMER_RUNNING=!0;this.recoveryTimeoutTasks[b]=setTimeout(function(){this.displayLogMessage("Auto recovery has been triggered",b);this.clearAutoRecoveryTimer(b);c.DISABLED_SYNC_STATUS=!1;c.RECOVERY_TIMER_RUNNING=!1;c.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED++;d.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.failed-to-restart",data:{id:b}});c.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED>=this.settings.MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED&&
(this.displayLogMessage("Auto recovery has been triggered too many times for the same action",b,this.controlSyncState[b].CONSECUTIVE_AUTO_RECOVERY_TRIGGERED),d.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.consecutive-failed-to-restart",data:{id:b}}));this.entity.start(b)}.bind(this),a.maxWaitTimeToRestart||this.settings.MAX_WAIT_TIME_TO_RESTART)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/telepointer-cleaner.js' */
define("confluence-collaborative-editor-plugin/telepointer-cleaner",["confluence-editor-reliable-save/reliable-save","jquery"],function(a,c){a.registerCleanupFunction(function(a){var b=c("\x3cdiv\x3e");b.append(a);b.find(".synchrony-container, .synchrony-tp").remove();return b.html()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/editor-blanket.js' */
define("confluence-collaborative-editor-plugin/editor-blanket",["ajs","jquery","confluence/meta","confluence-editor/support/atlassian-editor-support"],function(l,a,m,h){var c,d;function f(b){switch(b){case "block":c="editor-block";d="aria-disabled";e="";break;default:c="editor-loading editor-loading-spinner",d="aria-busy",e="editor-loading"}b=a("#editpageform, #createpageform");b.addClass(c);b.attr(d,!0);a("#content-title").attr("tabindex",-1);a("#wysiwygTextarea_ifr").attr("tabindex",-1);a(".aui-toolbar2-primary").addClass(e)}
function k(){var b=a("#editpageform, #createpageform");b.removeClass(c);b.attr(d,!1);a("#rte").css("opacity",1).addClass("editor-blanket-ease-in");a("#content-title").attr("tabindex",1);a("#wysiwygTextarea_ifr").attr("tabindex",100);a("#content-title-div").css("opacity",1).addClass("editor-blanket-ease-in");a(".aui-toolbar2-primary").removeClass(e);e=d=c=void 0}function g(){a("#rte").css("opacity",1);a("#content-title-div").css("opacity",1)}var e=d=c=void 0;return{applyBlanket:function(a){h.isCollaborativeContentType()&&
"pending"===a.state()?(f(),a.done(k)):g()},showEditor:g,showBlanket:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-auth.js' */
define("confluence-collaborative-editor-plugin/synchrony-auth",["jquery","ajs","confluence/meta","confluence/legacy","confluence-collaborative-editor-plugin/synchrony-util"],function(k,d,l,m,f){function n(c,a){f.time("confluence.editor.synchrony.token");var b=a&&a.errorType?"?errorType\x3d"+a.errorType:"";k.ajax({dataType:"json",method:"GET",url:encodeURI(d.contextPath()+"/rest/synchrony/1.0/token/"+m.getContentId()+"/generate"+b)}).done(function(a){l.set("synchrony-token",a.synchronyToken);l.set("synchrony-expiry",
a.synchronyExpiry);g=0;c.resolve(a.synchronyToken);e&&(e.onConfluenceConnectedState(),e.onTokenRenewedState());d.trigger("dismiss.editor.error.message",{messageKey:"synchrony-token-expired",enablePublish:!0});d.debug("Synchrony JWT token updated.");f.timeEnd("confluence.editor.synchrony.token")}).fail(function(){g++;10<=g&&d.trigger("editor.error.message",{messageKey:"synchrony-token-expired",message:"We couldn\u0027t process your request, as it was missing a required security token. Copy your work, then re-submit the form or reload the page.",disablePublish:!0});e&&(e.onConfluenceDisconnectedState(),
e.onTokenExpiredState());d.log(a?a.message:"Confluence failed to renew JWT token.");c.reject("token")})}function h(c){var a=k.Deferred(),b;if(b=!c)b=parseInt(f.retrieveMetadata("synchrony-expiry")),b=isNaN(b)?!1:b>Date.now()/1E3;b?a.resolve(f.retrieveMetadata("synchrony-token")):(d.log("["+new Date+"] Synchrony JWT expired or invalid, retrieving new token."),n(a,c));return a.promise()}var e,g=0;return{init:function(c){e=c},performRequest:function(c){return h().pipe(c).pipe(function(a){var b="error"===
a[1]&&a[0].responseText?JSON.parse(a[0].responseText):a[0];return"error"===a[1]&&b.type&&b.type.match(/^jwt\//)?h({errorType:b.type,message:b.message}).pipe(c):a})},getTokenPromise:h}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/unsupported-extension.js' */
define("confluence-collaborative-editor-plugin/unsupported-extension","ajs jquery confluence/legacy confluence-editor/editor/page-editor-message window confluence-collaborative-editor-plugin/editor-blanket".split(" "),function(a,c,d,e,f,g){function h(){var b=a.Rte.getEditor().getBody();b.hasAttribute("data-gramm")&&b.hasAttribute("data-gramm_id")&&(a.trigger("synchrony.stop",{id:"confluence.editor.block.by.grammarly",maxWaitTimeToRestart:31536E6}),a.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.block"}),
b.setAttribute("contentEditable",!1),c(b).find(".contentLayout2 .innerCell").each(function(){this.setAttribute("contentEditable",!1)}),g.showBlanket("block"),d.Editor.UI.setButtonsState(!1,d.Editor.UI.buttons),e.handleMessage("collaborative-editor-unsupported-extension",{type:"error",title:"Grammarly isn\u0027t supported",message:a.format("The Grammarly extension doesn\u0027\u0027t play well with collaborative editing. Disable it and \u003ca {0}\u003ereload the page\u003c/a\u003e to keep working.",'href\x3d"#" id\x3d"collabGrammarlyReload"')}),c("#collabGrammarlyReload").click(function(){a.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.grammarly.reload.click"});f.location.reload();return!1}),a.trigger("synchrony-unsupported-extension"))}return{check:function(){h()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-entity.js' */
define("confluence-collaborative-editor-plugin/synchrony-entity","jquery ajs confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/unsupported-extension confluence-collaborative-editor-plugin/util/is-valid-uri".split(" "),function(c,d,l,f,m,n){function g(a){return function(b){return null===b||a.test(b)}}function k(a){var b=g(/^[\w\.\-\+%]+$/i),e=g(/^[\w-]+$/),h=g(/^data:image\/png;base64,([\w+\/%\-]+)=*$/),
p=a.whitelists.tinymce.attributes.src;return c.extend({},a.whitelists.tinymce,{styles:c.extend({},a.whitelists.tinymce.styles,{"padding-top":!1,"padding-right":!1,"padding-bottom":!1,"padding-left":!1,padding:!1,display:b,"list-style-type":b}),attributes:c.extend({},a.whitelists.tinymce.attributes,{"confluence-query-params":!0,"data-element-title":!0,"data-ref":!0,accesskey:!0,datetime:!0,"data-anchor":!0,"data-encoded-xml":!0,"data-highlight-class":!0,"data-highlight-colour":!0,"data-space-key":!0,
"data-username":!0,"data-emoticon-name":e,"data-hipchat-emoticon":e,"data-entity-id":!0,"data-entity-type":!0,"data-favourites-bound":!0,"data-macro-id":!0,"data-macro-name":!0,"data-macro-schema-version":!0,"data-macro-body-type":!0,"data-macro-parameters":!0,"data-macro-default-parameter":!0,"data-atlassian-layout":!0,"data-placeholder-type":!0,"data-layout":!0,"data-title":!0,"data-type":!0,"data-inline-task-id":!0,"data-inline-tasks-content-id":!0,"data-base-url":!0,"data-linked-resource-id":!0,
"data-linked-resource-type":!0,"data-linked-resource-version":!0,"data-linked-resource-default-alias":!0,"data-linked-resource-container-version":!0,"data-linked-resource-content-type":!0,"data-unresolved-comment-count":!0,"data-location":!0,"data-image-height":!0,"data-image-width":!0,"data-attachment-copy":!0,"data-content-title":!0,"data-filename":!0,username:!0,src:function(a){return h(a)||p(a)},href:n}),classes:function(a){switch(a){case "mceSelected":case "active-resizable":return!1;default:return!0}},
elements:c.extend({},a.whitelists.tinymce.elements,{time:!0,mark:!0,label:!0,form:!0})})}function r(a,b,e){var h=k(a);return{profile:"tinymce",selectionCorrections:!1,telepointer:{refreshOnResize:!0,label:{hover:!0,movement:1E3,text:function(a){try{return(a.fullname||"Anonymous").charAt(0).toUpperCase()}catch(q){d.log(q)}return"\x26#9786;"}}},tinymce:{monkeyPatchUndoManager:!0,instance:b},whitelist:function(b){var c="node"===b.type,d="attribute"===b.type&&"data-title"===b.name;
return b.domNode===e?c||d:a.isWhitelisted(h,b)},domReadHook:function(){d.trigger("cursor-target-refresh");m.check()}}}return{bind:function(a,b,e,c,d){return a.entity({url:f.getServiceUrl(),entityId:f.getEntityId(),jwt:l.getTokenPromise,initRev:d.confRev,history:c,presence:!0,useFallback:f.getXhrFallbackFlag()}).bind(e,r(a,b,e))},makeWhitelist:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/url-parser.js' */
define("confluence-collaborative-editor-plugin/util/url-parser",["window"],function(b){return{parseUrl:function(c){var a=b.document.createElement("a");a.href=c;return{protocol:a.protocol.replace(":",""),hostname:a.hostname,port:a.port,pathname:"/"===a.pathname?"":a.pathname,search:a.search,hash:a.hash.substr(a.hash.indexOf("#")+1,a.hash.length),host:a.host}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/location-provider.js' */
define("confluence-collaborative-editor-plugin/util/location-provider",["window"],function(a){return{getLocation:function(){return a.location}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/editor-format-fixer.js' */
define("confluence-collaborative-editor-plugin/util/editor-format-fixer",["underscore","confluence/meta","confluence-collaborative-editor-plugin/util/url-parser"],function(p,n,k){var r=function(a){a=a.querySelectorAll("a[data-linked-resource-id][data-linked-resource-type\x3d'userinfo'][userkey]");Array.prototype.forEach.call(a,function(a){a.removeAttribute("data-linked-resource-id")});return a.length};return{fixStaleBaseUrl:function(a){var q=0;for(var l=n.get("base-url"),f=k.parseUrl(l),g=a.querySelectorAll("img[data-base-url]"),
h=0;h<g.length;h++){var b=g[h],c=k.parseUrl(b.attributes["data-base-url"].value);if(!p.isEqual(c,f)){var d=b.attributes.src.value,e=b.attributes["data-image-src"].value.replace(c.pathname,f.pathname);c=d.replace(c.pathname,f.pathname);b.setAttribute("data-base-url",l);b.setAttribute("data-image-src",e);b.setAttribute("src",c);q++}}l=0;f=k.parseUrl(n.get("base-url"));g=a.querySelectorAll("img[data-macro-name\x3d'view-file']");for(h=0;h<g.length;h++)for(b=g[h],e=b.attributes.src.value,c=["/rest/documentConversion/latest/",
"/plugins/servlet/confluence/placeholder/unknown-attachment?"],d=0;d<c.length;d++){var m=e.indexOf(c[d]);-1!=m&&e.substr(0,m)!==f.pathname&&(m=f.pathname+e.substr(m),b.setAttribute("src",m),l++)}f=0;g=n.get("base-url");h=k.parseUrl(g);a=a.querySelectorAll("a[data-base-url][href][data-linked-resource-type\x3d'page'],a[data-base-url][href][data-linked-resource-type\x3d'blogpost'],a[data-base-url][href][data-linked-resource-type\x3d'comment'],a[data-base-url][href][data-linked-resource-type\x3d'space'],a[data-base-url][href][data-linked-resource-type\x3d'attachment'],a[data-base-url][href][data-linked-resource-type\x3d'custom']");
for(b=0;b<a.length;b++)e=a[b],c=k.parseUrl(e.attributes["data-base-url"].value),p.isEqual(c,h)||(d=k.parseUrl(e.attributes.href.value),c=g+d.pathname.replace(c.pathname,"")+d.search+(d.hash?"#"+d.hash:""),e.setAttribute("data-base-url",g),e.setAttribute("href",c),f++);return q+l+f},fixMentions:function(a){return r(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-handlers.js' */
define("confluence-collaborative-editor-plugin/synchrony-handlers","underscore jquery ajs confluence/meta confluence/analytics-support confluence/legacy confluence-editor/editor/page-editor-message confluence-collaborative-editor-plugin/lib/SyncManager confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-presence confluence-collaborative-editor-plugin/util/location-provider confluence-collaborative-editor-plugin/util/url-parser confluence-collaborative-editor-plugin/util/editor-format-fixer confluence-collaborative-editor-plugin/editor-blanket confluence/api/event window".split(" "),
function(F,h,c,f,G,n,w,H,k,l,I,J,v,x,K,b,p){function y(a,d){d.contributors&&(z=d.contributors,b.unbind(a,y))}function L(a){t=!0;q.val(a.rev.toString())}function M(a){q.val(a.rev.toString());b.trigger("synchrony.entity.ack",{pendingChanges:0<a.pending.length})}function N(){r.onDisconnectedState();c.log("Synchrony disconnected!")}function O(a){if("null/no-such-sequence"===a.errorType||"null/entity-evicted"===a.errorType||"hub.error/locked"===a.errorType){b.trigger("analyticsEvent",{name:"confluence.editor.data.evicted.error",
data:{errorType:a.errorType,onLoad:!t,afterReload:null!==p.sessionStorage.getItem(u())}});e.destroy();b.trigger("synchrony.history.evicted");a=null===p.sessionStorage.getItem(u());var d=t?"\u003cb\u003eWe couldnt sync your changes\u003c/b\u003e\u003cbr/\u003eCopy the changes you want to keep, then refresh the page to continue editing.":a?"Reloading this page to get it back in sync.":"\u003cb\u003eIts taking a while to sync this page\u003c/b\u003e\u003cbr/\u003eGive it a minute, then refresh the page to start editing. Contact your Confluence admin if this keeps happening.";b.trigger("editor.error.message",{disablePublish:!0,close:"never",message:d});if(t)r.onDisconnectedState();
else K.showBlanket("block"),a&&(p.sessionStorage.setItem(u(),"false"),p.location.reload());P()}else"fatal"===a.level&&b.trigger("editor.error.message",{disablePublish:!0})}function P(){p.onerror=function(a,d,b,e,c){if(!(d||b||e||c)){if(A)return!0;A=!0}else if(c&&c.message&&"entity destroyed"===c.message)return!0;return!1}}function u(){return"_reload_for_"+f.get("draft-id")}function Q(a){k.timeEnd("confluence.editor.synchrony.connect");c.log("Synchrony connected.");I.appendTo(a.sid,e,z);r.onConnectedState(e);
b.trigger("synchrony.connected");l.fixTinymceCaretContainer(m,g);p.sessionStorage.removeItem(u())}function B(a,d,b){return{origin:"synchrony",cause:a,messageKey:d,disablePublish:b}}function R(a){function d(c){c.pending.length||(e.off("ack",d),q.val(c.rev.toString()),b.resolve(a))}var b=h.Deferred();e.ackState().pending.length?(e.on("ack",d),setTimeout(function(){e.off("ack",d);b.reject(B("timeout"))},5E3)):b.resolve(a);return h.when(b,C).promise()}function D(a){return(a=k.getLatestRevisionWithAttr(a.revisions,
"user"))?a.meta.user:"Anonymous"}function S(a){w.handleMessage("editor.synchrony.page-published",{type:"info",message:c.format("{0} published this page.",c.escapeHtml(a)),close:"auto"});b.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.publish"});b.trigger("editor-shared-drafts-published")}function T(a){if("remote"===a.updateType){q.val(a.revisions[a.revisions.length-1].rev.toString());k.hasRevisionTrigger(a.revisions,"reset")&&(w.handleMessage("editor.synchrony.revert-page",
{type:"info",message:c.format("{0} reverted to a previous version of this page.",c.escapeHtml(D(a)))}),f.set("has-collaborated",!1),E(),b.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.revert"}),b.trigger("editor-shared-drafts-discarded"),n.Editor.heartbeat());k.hasRevisionTrigger(a.revisions,"publish")&&(l.isUnpublished()&&(f.set("new-page",!1),f.set("page-id",n.getContentId()),f.set("draft-id","0"),n.Editor.isLimitedModeEnabled()||n.Editor.UI.setButtonState(!0,h("#rte-button-discard"))),
f.set("has-collaborated",!1),E(),S(D(a)),n.Editor.heartbeat());k.hasRevisionType(a.revisions,"external")&&b.trigger("editor.external.change");var d=k.getLatestRevisionWithAttr(a.revisions,"confVersion");d&&d.meta.confVersion&&(h('meta[name\x3d"page-version"]').attr("content",d.meta.confVersion),h('meta[name\x3d"ajs-page-version"]').attr("content",d.meta.confVersion),f.set("page-version",d.meta.confVersion))}setTimeout(function(){if("init"===a.updateType||"remote"===a.updateType)b.trigger("editor.remote.change"),
l.readTitleFromRootElement(m);"init"==a.updateType&&(U(J.getLocation())?g.undoManager.ignore(function(){var a=x.fixStaleBaseUrl(m);0<a&&G.publish("collab.edit.format.stale.fix.count",{staleformatfixed:a})}):c.log("Request url does not match the configured base url. Not performing fixStaleBaseUrl()."),g.undoManager.ignore(function(){x.fixMentions(m)}));l.fixTinymceCaretContainer(m,g);"local"===a.updateType&&(g.undoManager.hasUndo()||g.setDirty(!1),b.trigger("editor.local.change"))},0)}function E(){0===
e.ackState().pending.length&&g.setDirty(!1)}function U(a){var b=f.get("context-path"),c=v.parseUrl(f.get("base-url"));a=v.parseUrl(a);b=v.parseUrl(a.protocol+"://"+a.host+b);return F.isEqual(c,b)}var q,r,g,m,e,C,z=[],t=!1,A=!1;b.bind("editor-heartbeat",y);return{handle:function(a,b,c,f){k.time("confluence.editor.synchrony.connect");e=a;g=b;r=c;C=f.pipe(null,function(a){e.destroy();r.onDisconnectedState();return B(a,"collaborative-editor-load-failure",!0)});q=h("#syncRev");m=g.getBody();e.on("init",
L).on("update",T).on("ack",M).on("connected",Q).on("disconnected",N).on("error",O);new H(e,{DEBUG_MODE:!0});l.bindPostPasteFix();l.readTitleFromRootElement(m);n.Editor.overrideBeforeSave(R);h("#content-title").keyup(l.writeTitleToRootElement)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-editor.js' */
define("confluence-collaborative-editor-plugin/synchrony-editor","window jquery ajs confluence/legacy confluence-collaborative-editor-plugin/editor-blanket confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-entity confluence-collaborative-editor-plugin/synchrony-handlers confluence-editor/support/atlassian-editor-support confluence-editor/loader/collaborative-helper".split(" "),
function(h,f,c,m,B,d,r,z,C,M,N,O){function t(a){f('meta[name\x3d"ajs-collaborative-editor-status"]').attr("content",a)}function P(){return!c.Rte.isQuickEdit}function Q(){var a=f.Deferred();c.$(function(){c.$("body").addClass("synchrony-active");u=new (require("confluence-collaborative-editor-plugin/status-indicator-view"))({el:"#pluggable-status",model:new Backbone.Model({minActiveTime:500})});z.init(u);a.resolve()});return a}function v(a){if(!0!==D){switch(a){case "timeout":a="The editor didn\u0027t load this time";
var b="The connection timed out. If it happens again, speak to your Confluence admin. You may be using a proxy server that prevents WebSocket connections.\u003c/br\u003e\u003ca href=\u0022#\u0022 id=\u0022websocketRetry\u0022\u003eTry again\u003c/a\u003e&nbsp;.&nbsp;\u003ca href=\u0022https://confluence.atlassian.com/display/CONFKB/Confluence+throws+The+editor+didn%27t+load+this+time+error+when+trying+to+edit+a+page\u0022 target=\u0022_blank\u0022 id=\u0022websocketFindmore\u0022\u003eFind out more\u003c/a\u003e";break;case "synchrony-requests":w=!0;a="";b="Something went wrong after loading the editor. Copy your unsaved changes and refresh the page to keep editing.";break;case "limited-mode":w=!0;a="";b="Something went wrong while loading the editor, please try again.";break;default:w=!0,a="",b="This page is taking longer to load than usual. Give it a few moments, then try refreshing. Still having issues? Contact your Confluence admin."}c.trigger("editor.error.message",{title:a,messageKey:"collaborative-editor-load-failure",message:b,disablePublish:!0,close:"manual"})}}
function E(){c.trigger("dismiss.editor.error.message",{messageKey:"collaborative-editor-load-failure",enablePublish:!0})}function F(a,b){var e=f.Deferred();a.done(function(){d.timeEnd(b)},e.resolve);a.fail(e.resolve);return e.promise()}function G(a,b){var e="error"===b[1]&&b[0].responseText?JSON.parse(b[0].responseText):"",g=!1;"invalid-ancestor"===e.type?g="synchrony":"out-of-order-revision"===e.type&&(g="confluence");return g?(c.log("Performing synchrony recovery"),f.ajax({url:c.contextPath()+"/rest/synchrony/1.0/content/"+
m.getContentId()+"/recovery?behind\x3d"+g+"\x26conflictingRev\x3d"+e["conflicting-rev"],type:"PUT"}),"synchrony-requests"):"success"!==b[1]&&"success"!==a[1]||"success"!==b[1]&&"duplicate-mismatch"!==e.type?(c.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.failure",data:{type:e.type,contentId:m.getContentId()}}),"synchrony-requests"):!1}function H(a){return z.performRequest(function(b){d.time("confluence.editor.synchrony.snapshot");return F(f.ajax({type:"POST",
url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?state-at\x3d@head\x26state-format\x3dtype-tagged\x26rewrite-request\x3dtrue\x26cached\x3d"+a),contentType:"text/plain",dataType:"json",data:JSON.stringify({headers:{"content-type":"application/json","x-token":b},method:"GET"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.snapshot")})}function R(a){return a.syncRev||!r.isUnpublished()||0!==a.raw.length&&!/^\s+$/.test(a.raw)?r.isContentEmpty(a.raw)?(c.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.blank-content",
data:{contentId:m.getContentId()}}),f.Deferred().resolve([{},"success"])):z.performRequest(function(b){d.time("confluence.editor.synchrony.CR");return F(f.ajax({type:"POST",url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?optimistic\x3dtrue\x26rewrite-request\x3dtrue"),dataType:"json",contentType:"text/plain",data:JSON.stringify({body:{ancestor:a.syncRev,rev:a.confRev,state:{format:"html",value:a.html},merges:{master:{meta:{type:"client-reconciliation"}}}},headers:{"content-type":"application/json",
"x-token":b},method:"PUT"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.CR")}):f.Deferred().resolve([{},"success"])}function S(a){d.time("confluence.editor.synchrony");f.when(Date.now(),a).pipe(function(a){t("on");var b=Date.now();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.loaded",data:{durationMillis:b-a,contentId:m.getContentId()}});c.trigger("rte-collab-ready");d.timeEnd("confluence.editor.synchrony");d.timeEnd("confluence.editor")})}function T(){var a=x("synchrony.connected synchrony.connected.fake");
x("synchrony.connected synchrony.connected.fake synchrony-unsupported-extension",3E4).fail(function(b){v(b);c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.load.timeout",data:{contentId:m.getContentId()}});U();I=!0;a.done(function(){w||(J=!0,E())})})}function V(a,b,e){var g=l._initialiseSynchrony(),A=x("synchrony.connected.fake"),k=x(null);b.pipe(function(){setTimeout(k.reject,3E4,"synchrony-requests")});var K=l._initialiseCollabEditingComponents(k),p=Date.now(),h=null,n=null;c.DarkFeatures.isEnabled("synchrony-pessimistic-snapshot")||
(h=g.pipe(function(){return H(!0)}),h.done(function(a){n=a[1]}));var q=f.when(a,g).pipe(function(){return!h||"rejected"===h.state()||"error"===n||6E5<Date.now()-p?H(!1):h});e.pipe(function(){T();S(A);B.applyBlanket(A)});b.pipe(function(a){var b=g.pipe(function(){return R(a)});q=f.when(q,g).pipe(function(a,b){d.time("confluence.editor.synchrony.unmarshal");var c=a;"success"===a[1]&&(c=[{stateAt:a[0].stateAt,state:b.unmarshal(a[0].state.value)},a[1]]);d.timeEnd("confluence.editor.synchrony.unmarshal");
return c});f.when(q,b).pipe(function(a,b){(a=G(a,b))?k.reject(a):k.resolve()});return c.DarkFeatures.isEnabled("synchrony-pessimistic-CR")||"synchrony-ack"!==a.syncRevSource&&!r.isUnpublished()?f.when(a,e,q,b,K):(c.debug("confluence.editor.synchrony: content up to date, not waiting for CR"),k.fail(v),f.when(a,e,q,[{},"success"],K))}).pipe(function(a,b,e,g){if(!l._bindEditor(a,b,e,g,k))return c.trigger("analyticsEvent",{name:"confluence.synchrony.bind.failure",data:{contentId:m.getContentId()}}),f.Deferred().reject("editor-binding-failed");
A.resolve()}).fail(function(a){e.always(function(){"synchrony-not-enabled"!==a&&(c.log("Failed to load the collaborative editor",a),v(a),c.$(function(){u.onDisconnectedState()}),t("failed"),c.trigger("analyticsEvent",{name:"confluence.synchrony.error",data:{error:a,contentId:m.getContentId()}}))})})}function x(a,b,e){var g=f.Deferred();a&&c.bind(a,function p(b,e){c.debug("confluence.editor.synchrony.event: "+b.type+"."+b.namespace);c.unbind(a,p);g.resolve(e)});b&&setTimeout(g.reject,b,e||"timeout");
return g}function n(a,b,e,g,h){var k=h||f.Deferred();if(d.isEditorInitialised()||b&&d.synchronyReady())return L(k,e);c.bind(a,function W(b,d){c.debug("confluence.editor.event "+b.type+"."+b.namespace);k.always(function(){c.unbind(a,W)});L(k,e,d,g)});return k}function L(a,b,e,c){return d.synchronyReady()?!c||c()?(b=b?b(e):e)&&b.error?a.reject(b.error):a.resolve(b):a:a.reject("synchrony-not-enabled")}function U(){f("#websocketRetry").on("click",function(){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.retry.click"});
h.location.reload();return!1});f("#websocketFindmore").on("click",function(){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.findmore.click"})})}var l={};d.time("confluence.editor.synchrony.jsLoad");var u,w=!1,D=!1,J=!1,I=!1,y;f(h).bind("beforeunload",function(){J||c.trigger("analyticsEvent",{name:"confluence.synchrony.exit.before.connecting",data:{afterTimeout:I,contentId:m.getContentId()}})});c.bind("synchrony.history.evicted",function(a){D=!0});l._bindEditor=function(a,
b,e,g,h){d.time("confluence.editor.synchrony.init");if(G(e,g))return null;g=f("#syncRev");var k=null;"success"===e[1]&&(e=e[0],k={base:{rev:Synchrony.rev(e.stateAt),state:e.state}},g.val(k.base.rev.toString()));c.log("Synchrony will load with contentId: ",m.getContentId());try{var l=b.getBody();l.setAttribute("data-title",a.title);y=C.bind(Synchrony,b,l,k,a);M.handle(y,b,u,h);c.trigger("editor.remote.change");b.setDirty(!1);d.timeEnd("confluence.editor.synchrony.init");return y}catch(p){return c.logError(p),
null}};l._initialiseCollabEditingComponents=function(a){var b=Q();f(h).one("synchrony.connected.fake",function(c){"connected.fake"===c.namespace&&(b.resolve(),a.resolve(),E(),t("fake"))});return b};l._initialiseSynchrony=function(){d.time("confluence.editor.synchrony.deps");(function(a){var b=a.Synchrony=a.Synchrony||{};if(!b.ready){var c=b._cbs=b._cbs||[];b.ready=function(a){c.push(a)}}var d=function(){1===b.state&&(b.SockJS=a.SockJS,b.init())};if(a.SockJS)b.init&&d();else{var f=a._sockjs_onload;
a._sockjs_onload=function(){d();f&&f.apply(this,arguments)}}})(h);var a=f.Deferred();Synchrony.ready(a.resolve);return f.when(a.promise(),d.loadScript(["/js/vendor/sockjs.min.js","/js/synchrony.min.js"])).pipe(function(a){d.timeEnd("confluence.editor.synchrony.deps");c.log("Synchrony successfully initialised.");return a})};l.init=function(){if(N.isCollaborativeContentType()){var a=n("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready",!0),b=n("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready rte-collab-editor-loaded",
!1),e=n("rte-collaborative-content-ready rte-initial-raw-content-ready",!1,r.getContent),d=n("rte-collab-editor-loaded",!1,c.Rte.getEditor);d=n("rte-ready rte-begin-collab-editing",!1,c.Rte.getEditor,P,d);a.pipe(function(){V(b.promise(),e.promise(),d.promise())});e.fail(v);c.trigger("synchrony-events-bound");d.fail(function(a){"synchrony-not-enabled"===a&&(B.showEditor(),t("off"),c.log("Synchrony is not available in this context."))})}};l.register=function(){O.registerPlugin(l)};l.getSynchronisedEditorContent=
function(){var a=y.ackState();if(a.rev){var b=Synchrony.makeDom(a.state,{document,whitelist:C.makeWhitelist(Synchrony)});return{content:require("tinymce").activeEditor.serializer.serialize(b),syncRev:a.rev.toString()}}c.logError("Synchrony hasn't acked any data, can't fetch draft data");return null};d.timeEnd("confluence.editor.synchrony.jsLoad");return l});require("confluence/module-exporter").safeRequire("confluence-collaborative-editor-plugin/synchrony-editor",function(h){h.register();h.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:trigger', location = '/includes/js/trigger.js' */
define("confluence/trigger",["jquery","window"],function(b,c){return function(a,d){a=new b.Event(a);b(d||c.top.document).trigger(a);return!a.isDefaultPrevented()}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/trigger","AJS.jiraTrigger");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:keyboard', location = '/includes/js/api/keyboard.js' */
define("confluence/api/keyboard",["jquery"],function(f){function b(a,b,c){h[b]=a;i[a]=b;c&&(j[b]=!0);return a}function g(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!==a.which&&0!==a.charCode?a.which:null}function k(a){var a=a.originalEvent||a,b=e.specialKeyEntered(a);if(b)return b;if(f.browser.mozilla){if("keypress"===a.type&&(a=g(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var e={},h={},i={},
j={},c=e.SpecialKey={BACKSPACE:b("backspace",8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",
116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return f.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return h[a]};c.toKeyCode=function(a){return i[a]};c.isAscii=function(a){return!!j[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};e.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=g(a),
null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===c.SPACE)))return String.fromCharCode(a)};e.specialKeyEntered=function(a){a=a.originalEvent||a;if(f.browser.mozilla){if("keypress"===a.type){var b=g(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};e.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===e.SpecialKey.eventType()){var b=e.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");
a.ctrlKey&&b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=k(a)))return d+a}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/keyboard","AJS.Keyboard");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/class.js' */
define("confluence/class",["jquery"],function(f){var j=function(d){var a=function(){};a.prototype=d;return new a},i=!1,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,k=function(){};k.extend=function(){function d(){!i&&this.init&&this.init.apply(this,arguments)}var a,g=this.prototype;if(1<arguments.length){var c=f.makeArray(arguments);a=c.pop();var h;f.each(c,function(b,a){h=h?h.extend(a):a});return h.extend(this.prototype).extend(a)}a=arguments[0];i=!0;c=new this;i=!1;for(var b in a)if(c[b]="function"===
typeof a[b]&&"function"===typeof g[b]&&l.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof g[b]){var e=j(a[b]);f.each(g[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=j(e[a]);f.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/class","Class");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/control.js' */
define("confluence/control","confluence/class confluence/trigger confluence/api/logger confluence/api/keyboard jquery document".split(" "),function(k,l,i,g,d,e){return k.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if(typeof b==="string")for(var c in this._events[a])d(e).delegate(b,c,this._getDispatcher(a,c));else{b=d(b);for(c in this._events[a]){b.bind(c,this._getDispatcher(a,
c));i.debug("Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}},_unassignEvents:function(a,b){if(typeof b==="string")for(var c in this._events[a])d(e).undelegate(b,c,this._getDispatcher(a,c));else{b=d(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var f=d._data(b[0],"events");if(f)for(c in f)if(c in this._events[a]){for(var m=this._getDispatcher(a,c),j=f[c],h=0;h<j.length;h++)if(j[h]===m){j.splice(h,1);break}i.debug("Control unbound eventType '"+
c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=a+"/"+b;if(!this._dispatchers)this._dispatchers={};if(!this._dispatchers[c]){var e=this._events[a][b],f=this;this._dispatchers[c]=function(c){i.debug("Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+f.type+"'");return e.call(f,c,d(this))}}return this._dispatchers[c]},_isValidInput:function(){return true},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=g.SpecialKey,c=
g.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=g.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return l(a,this)},_supportsBoxShadow:function(){var a=e.body.style;return a.WebkitBoxShadow!==void 0||a.MozBoxShadow!==
void 0||a.boxShadow!==void 0},_setOptions:function(a){var b,c,a=a||{};if(a instanceof d||typeof a==="string"||typeof a==="object"&&a.nodeName)a={element:a};b=d(a.element);c=b.getOptionsFromAttributes();this.options=d.extend(true,this._getDefaultOptions(a),c,a);if(b.length===0)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(b>=0)return a.selectionEnd>b?-1:b;if(e.selection){b=e.selection.createRange();if(b.text.length===0){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",
b);return c.text.length}}return-1},_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/control","AJS.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/api/mouse.js' */
define("confluence/api/mouse",["jquery","window"],function(d,e){var b={MotionDetector:function(){this.reset()}};b.MotionDetector.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.MotionDetector.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(e.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.MotionDetector.prototype.unbind=function(){this._handler&&
(d(e.top.document).unbind("mousemove",this._handler),this.reset())};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/mouse","AJS.Mouse");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/group.js' */
define("confluence/group",["confluence/control","confluence/api/logger","jquery"],function(d,e,c){return d.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=c.inArray(a,this.items);if(0>b)throw Error("Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",
a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){e.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==
this.items.length&&(0>this.index?this.items[0].trigger("focus"):this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=c.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===c.inArray(a.target,this.items)&&(this.index=
-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},keys:{}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/group","AJS.Group");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.js' */
define("confluence/select-grid",["ajs","jquery","confluence/templates","confluence/group","confluence/control"],function(g,d,j,e,m){var e=e.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=d(j.SelectGrid.gridOutline()),c=b.find("thead tr");d(a.columns).each(function(a,b){var f=d("<th></th>").addClass(b.getClassName()).text(b.heading);c.append(f)});this.gridContainer=d(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=
a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,h){d.isFunction(c)&&(h=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new n({row:a,data:b,
callback:h,getRowId:this.getRowId,selectionCallback:h});this.addItem(a);return a},clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,h=[];d(a).each(function(a,f){var g=c.columns,e,i,k,l;e=d("<tr></tr>");d(g).each(function(a,b){i={outerClass:b.getClassName(f)||"",href:b.getHref&&b.getHref(f)||"",innerClass:b.getInnerClass&&b.getInnerClass(f)||"",title:b.getTitle&&b.getTitle(f)||"",text:b.getText(f)||""};k=i.href?"cellWithLink":"cellWithoutLink";
l=j.SelectGrid[k](i);e.append(l)});e.attr("data-id",c.getRowId(f));h.push(c._addRow(e,f,b,c.selectionCallback))});return h},update:function(a){this.clear();!a||!a.length?g.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?g.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==
a)return this.items[b];g.debug("SelectGrid.findItem didn't find item, returning null.");return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():g.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}}),n=m.extend({init:function(a){this.type=
"SelectableRow";this.$row=d(a.row);this.$row.data("properties",a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);g.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},
selectRow:function(){this.trigger("focus")}});e.Column=function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/select-grid","AJS.SelectGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SelectGrid.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_ignored) {
  return '<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.gridOutline.soyTemplateName = 'Confluence.Templates.SelectGrid.gridOutline';
}


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><a class="' + soy.$$escapeHtml(opt_data.innerClass) + '" href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithLink';
}


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><span class="' + soy.$$escapeHtml(opt_data.innerClass) + '" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.text) + '</span></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithoutLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithoutLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/result-grid.js' */
define("confluence/result-grid",["ajs","jquery","confluence/control"],function(d,g,l){return l.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,k,h,j,e,i;f=a.gridContainer||g(a.baseElement).find(".data-table");f.length||d.debug("gridContainer for AJS.ResultGrid not found!");k=function(b){return b.id};c=new d.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||k,dontShiftFocus:a.dontShiftFocus});e=a.messageHandler||d.MessageHandler({baseElement:g(a.baseElement).find(".message-panel")});
i=a.noResultMessage||"There are no results.";g.extend(this,{update:function(b,a){e.clearMessages();h&&(h(),j.remove(),h=null);c.clear();if(!b||!b.length){c.hide();var m=g.isFunction(i)?i(a):i;e.displayMessages(m);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?d.debug("ResultGrid.prependAndSelect called with no data, returning."):(e.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){e.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!h){var d,e;d=b/2-73;e=a/2-73;j=g("<div></div>").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);h=Raphael.spinner(j[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/result-grid","AJS.ResultGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-jquery', location = '/includes/js/breadcrumbs-jquery.js' */
define("confluence/breadcrumbs-jquery",["jquery","confluence/templates"],function(e,h){return function(a){var i=this,f=[],b=0,c=a.length-1,d=a[b],j=i.closest(".breadcrumbs-container").width(),g=function(){return i.width()<j};for(f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));b++<c;)d=a[b],f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));this.html(f.join(""));a=e("li a span",this);a.each(function(a){0!==a&&a!==c&&e(this).shortenUntil(g)});
e(a.get(0)).shortenUntil(g);e(a.get(c)).shortenUntil(g);return this}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/breadcrumbs-jquery","jQuery.fn.renderBreadcrumbs");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
define("confluence/dialog-breadcrumbs",["ajs","jquery","confluence/meta","confluence/templates"],function(b,d,e,k){var h={},l=function(a,e,f){var g=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+"/pages/breadcrumb.action",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==
a.type&&/peopledirectory\.action$/.test(c[0].url);)c.shift();"page"===a.type&&(c[1]&&/pages\.action/.test(c[1].url))&&c.splice(1,1);c.type=a.type;h[g]=c;e(c,b)}}})};return{getBreadcrumbsDefault:l,Breadcrumbs:function(a,h){var f=0;return{update:function(g,j){a.html(k.Dialog.breadcrumbLoading());var m=f+=1,c=function(){return m!==f?(b.debug("Breadcrumb response for ",g," is stale, ignoring."),!0):!1};(h||l)(g,function(f,h){if(!c())if("success"!==h||!f)a.html(k.Dialog.breadcrumbError());else{var i=g.spaceKey;
a.renderBreadcrumbs(f);if(!(i=i!==e.get("space-key")))a:{for(i=1;i<f.length;i++)if(f[i].title===e.get("page-title")){i=!1;break a}i=!0}i?(j.clearErrors(),d(j.moveButton).prop("disabled",!1)):(j.error("You cannot move a page to be underneath itself or its children."),d("li:last-child",a).addClass("warning"))}},function(d){c()||(a.html(k.Dialog.breadcrumbError()),404===d.status&&j.error("The specified page was not found."))})}}},getBreadcrumbsLegacy:function(a,e,f){if(!a.id)throw Error("id is a required parameter in 'options'");
if(!a.type)throw Error("type is a required parameter in 'options'");var g=a.id+":"+a.type;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+b.REST.getBaseUrl()+"breadcrumb",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==a.type&&/peopledirectory.action$/.test(c[0].url);)c.shift();c.type=a.type;h[g]=c;e(c,b)}}})}}});
require("confluence/module-exporter").safeRequire("confluence/dialog-breadcrumbs",function(b){var d=require("ajs"),e=require("confluence/legacy");d.toInit(function(){d.MoveDialog||(d.MoveDialog={});d.MoveDialog.Breadcrumbs=b.Breadcrumbs;d.MoveDialog.getBreadcrumbs=b.getBreadcrumbsDefault;d.Breadcrumbs={};d.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs||(e.Dialogs={});e.Dialogs.Breadcrumbs=d.Breadcrumbs;e.Dialogs.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs.Breadcrumbs.Controller=
b.Breadcrumbs;e.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=b.getBreadcrumbsDefault})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_ignored) {
  return '<li><a class="' + soy.$$escapeHtml(opt_data.className) + '" title="' + soy.$$escapeHtml(opt_data.title) + '" tabindex="-1"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbItem.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbItem';
}


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_ignored) {
  return '<li class="loading"><span>' + soy.$$filterNoAutoescape('Loading breadcrumbs...') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbLoading.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbLoading';
}


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_ignored) {
  return '<li class="warning last"><span>' + soy.$$escapeHtml('Error retrieving breadcrumbs.') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbError.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbError';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = '/includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(c,a){var b=null;return{get:function(){return b?b:{spaceName:a.get("space-name"),spaceKey:a.get("space-key"),parentPageTitle:a.get("parent-page-title")}},set:function(a){b=a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-location","Confluence.PageLocation");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--8cfcf1af69', location = 'aui.chunk.df872207de84ebab59a4--d4e1042efaa57145cc2d.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--8cfcf1af69"],{iwe4:function(t,e,i){},rNKm:function(t,e,i){var s,a,l;
/*! jQuery Fancy File Input plugin - v2.0.4 - 2018-11-23
* Copyright (c) 2018 Atlassian Pty Ltd; Licensed Apache-2.0 */void 0===(l=this)&&void 0!==window&&(l=window),s=[i("oDIA")],void 0===(a=function(t){return l.FancyFileInput=function(t){"use strict";var e=/^.*[\\\/]/,i=/\{0\}/gi,s=function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:document.documentMode}();function a(e,i){var s=t(e).data("FancyFileInput");if(s)return s;i=t.extend({},a.defaults,i),this.el=e,this.$el=t(e),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=t("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return a.defaults={buttonText:"Browse",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},a.prototype._addLabelText=function(){var e=t('label[for="'+this.el.id+'"]');e.length&&this.$el.attr("aria-label",e.text())},a.prototype.createLabel=function(e){var i=this.$el.parent(".ffi[data-ffi-button-text]");return i.length||(i=this.$el.wrap(t("<label>",{class:"ffi","data-ffi-button-text":e})).parent()),i},a.prototype.isDisabled=function(){return this.$el.is(":disabled")},a.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(i,t)},a.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,t.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,t.proxy(this.change,this)).on("keydown"+this._eventNamespace,t.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,t.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,t.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,t.proxy(this.focus,this)).on("blur"+this._eventNamespace,t.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,t.proxy(this.clear,this))},a.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},a.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},a.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},a.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},a.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},a.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),s&&!this.isFocused&&(this.isFocused=!0,setTimeout((function(){t.$el.blur(),t.$el.focus()}),0))},a.prototype.blur=function(){s&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},a.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},a.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},a.prototype.keydown=function(t){var e=t.which,i=9;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),s&&e===i){var a=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout((function(){a.$el.prop("disabled",!1).blur()}),0)}},a.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},a.prototype.change=function(){var t,i="";this.checkValidity(),(t=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(i=t.replace(e,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(i),this.fireEvent("value-changed")},a.prototype.setFieldText=function(t){var e="data-ffi-value";t.length?(this.$label.attr(e,t),this.fireEvent("value-added")):(this.$label.removeAttr(e),this.fireEvent("value-cleared"))},t.fn.fancyFileInput=function(e){return this.each((function(){var i=new a(this,e);t(this).data("FancyFileInput",i)}))},a}(t)}.apply(e,s))||(t.exports=a)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.file-select', location = 'aui.chunk.38e3146b3dd6c6efbde4--9f98556b2d59fd2d3d33.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.file-select"],{"7hWp":function(i,u,c){"use strict";c.r(u),c.d(u,"FancyFileInput",(function(){return a}));c("6fSn"),c("iwe4");var n=c("rNKm"),a=c.n(n).a}},[["7hWp","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--8cfcf1af69","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d7c46c2734","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence/legacy"],function(c,g,m){function j(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function k(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function l(a){var b={};"A"===a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function i(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;
c=c.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return m.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&
this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&
this.classes.length?-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&
"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},isExternalLink:function(){return!this.isCustomAtlassianContentLink()},showsBreadcrumbs:function(){return!0},getTarget:function(){return this.attrs.target},setTarget:function(a){a?this.attrs.target=a:this.removeTarget()},removeTarget:function(){this.attrs&&this.attrs.target&&delete this.attrs.target}};
if(a&&a.attrs){var f={},h=null;c.each(a.attrs,function(a,b){"class"==a?h=b:f[a]=b});a.attrs=f;if(h){var d=h.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};e.fromData=function(a){return f(a)};e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:l(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=c(a),h=j(a),d=!h&&i(a.firstChild,a.lastChild);return f({attrs:l(a),body:{isEditable:d,isImage:!!h,html:e.html(),imgName:k(h),
text:b}})};e.fromSelection=function(a,b,c,e){var b=j(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3===d.nodeType?!0:i(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&i(a.start,
a.end)}return f({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:k(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":g.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,"data-linked-resource-content-type":a.contentType,href:g.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:g.escapeHtml(a.title),text:g.escapeHtml(a.title)},classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]=
"userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:g.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:g.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))};return e});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence/legacy","tinymce"],function(d,e,f,h){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=h.confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),f.Link.fromSelectedAnchor(c,
b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.Link.fromSelection(c,g,a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-adapter","Confluence.Editor.LinkAdapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
define("confluence-link-browser/link-browser",["ajs","confluence/legacy","jquery"],function(b,o,h){function r(){if(!f.prop("disabled")){f.prop("disabled",!0);b.debug("link-browser.js: submit");i.preSubmit&&i.preSubmit();var a=c.getLink();b.DarkFeatures.isEnabled(s)||a.removeTarget();n();a.insert();b.trigger("closed.link-browser")}}function n(){k.hide().remove();b.Rte.BookmarkManager.restoreBookmark()}function p(){n();b.trigger("closed.link-browser")}function t(a,f,l){var d=f.key,f=f.label,e=d+"-panel",
g=o.Templates.LinkBrowser[d+"Panel"]({atlToken:b.Meta.get("atl-token")});k.addPanel(f,g,e,e+"-id");var a=k.get("panel:"+a),j=l.tabs[d];j.panelObj=a;j.key=d;j.createPanel({baseElement:h(a[0].body)});a[0].onblur=j.onDeselect;a[0].onselect=function(){var a=!!j.hasBreadcrumbs;b.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);j.onSelect();c.refresh(a);i=j};return j}var s="link.openInNewWindow",k,c,f,i;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",
open:function(a){h(function(){h('.ffi input[type="file"]#file_0').fancyFileInput()});if(h(".aui-dialog:visible").length)return null;a=a||{};b.Rte.BookmarkManager.storeBookmark();a.linkInfo=a.linkInfo||o.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var q=a,a={OPEN_IN_NEW_WINDOW_DARK_FEATURE:s,tabs:{},setLink:function(u,a){c.setLink(u,a)},getLink:function(){return c.getLink()},getSelectedDataTableItem:function(){return h(".data-table:visible tr.selected")},linkValid:function(a){f.prop("disabled",
!a)},focusLinkText:function(){c.focusLinkText()||(b.debug("LinkBrowser: focusing submit button"),f.focus())},getLinkText:function(){return c.getLinkText()},isLinkTextVisible:function(){return c.isLinkTextVisible()},isNewWindowCheckboxVisible:function(){return c.isNewWindowCheckboxVisible()},hasBreadcrumbs:function(a){return c.hasBreadcrumbs(a)},getLocationPresenter:function(){return c},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},
moveLocationPanel:function(a){c.moveLocationPanel(a)},restoreLocationPanel:function(){c.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var c=this.tabs.weblink;i!=c?b.debug("Cannot set URL "+a+" on hidden Web Link panel"):c.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return i!=a?(b.debug("Cannot get URL on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},
getSubmitButtonText:function(){return f.text()},isSubmitButtonEnabled:function(){return f.is(":enabled")},isVisible:function(){return this.popup.isVisible()},showOpenInNewWindowCheckbox:function(a){return c.showOpenInNewWindowCheckbox(a)},getAdvancedTextField:function(){var a=this.tabs.advanced;return i!=a?(b.debug("Cannot get link text on hidden advanced panel"),null):a.getLink()},setAdvancedTextField:function(a){var c=this.tabs.advanced;i!=c?b.debug("Cannot set link text on hidden advanced panel"):
c.setLink(a)},submit:r,cancel:p},l=q.linkInfo,d=l.isNewLink(),e,g;e=new b.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:p,onSubmit:r});g=d?"Insert link":"Edit link";d=d?"Insert":"Save";e.addHeader(g);e.addButton(d,r);e.addCancel("Cancel",p);e.addHelpText("Hint: type \u0022[\u0022 in the editor to see a list of suggested pages and insert a link.");g=h("#insert-link-dialog .dialog-tip");
g.attr("title",g.text());h("#insert-link-dialog .dialog-components .dialog-title").prepend(o.Templates.LinkBrowser.helpLink());f=e.get("button:0")[0].item;f.attr("id","link-browser-insert");f.prop("disabled",!0);k=e;a.popup=k;b.trigger("dialog-created.link-browser",[a]);c=o.Editor.LinkBrowser.LinkInfoPresenter(a);c.setLinkBody(l.body);q=q.panelKey;e=h("#link-browser-tab-items").find("div").map(function(){var a=h(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,
b){return a.weight-b.weight});var j="template"!==b.Meta.get("content-type");e=h.grep(e,function(a){return j||"attachments"!==a.key});var n;g=null;for(var d=0,v=e.length;d<v;d++){var m=t(d,e[d],a);0===d&&(n=m);!l.isNewLink()&&h.isFunction(m.handlesLink)&&m.handlesLink(l)?(g=m,m.openedLink=l):q==m.key&&(g=m)}g?a.popup.overrideLastTab():g=n;i=g;k.popup.element.find(".dialog-page-body:first").append(c.getContainer());i.panelObj.select();i.openedLink=null;k.show();b.trigger("dialog-shown.link-browser",
k);return a},cancel:p}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser","Confluence.Editor.LinkBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
define("confluence-link-browser/link-browser-location",["jquery","confluence/legacy","ajs","confluence/dialog-breadcrumbs"],function(k,B,i,s){return function(t){function m(){return i.escapeHtml(u())}function u(){return b.val()}function v(a){j.closest(".row").toggleClass("hidden",!a);e.toggleClass("has-breadcrumbs",!!a)}function w(a){var c=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=c[2],d=c[3],f=c[5],e=c[7],c=c[9],b="";a&&(b=a.toLowerCase()+":");d&&(b+=d);b+=n(f);e&&(b+=
"?"+n(e));c&&(b+="#"+n(c));return b}function n(a){var c={"'":"%27","\\[":"%5B","\\]":"%5D","`":"%60","\\\\":"%5C"},d;for(d in c)c.hasOwnProperty(d)&&(a=a.replace(RegExp(d,"g"),c[d]));return a}function x(){return b.is(":visible")}function y(a,c){i.trigger("analyticsEvent",{name:a,data:{resourceType:c.getResourceType(),isExternal:c.isExternalLink()}})}var e,j,o,f,g,b,p,z,A,q,l,r,h;e=k(B.Templates.LinkBrowser.locationPanel());j=e.find("#breadcrumbs-container");o=s.Breadcrumbs(j,s.getBreadcrumbsLegacy);
g=e.find("#link-open-in-new-window");z=e.find(".link-image");A=e.find(".link-mixed");l=e.find("#link-image-filename");q=e.find("#link-mixed-content");p=e.find(".link-text");b=p.find("input");b.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!==a.keyCode&&b.removeClass("default-alias")});g.change(function(){g.prop("checked")?("attachment"!==f.getResourceType()&&f.setTarget("_blank"),y("editor.linkBrowser.location.openInNewWindow.checked",f)):(f.removeTarget(),y("editor.linkBrowser.location.openInNewWindow.unchecked",
f))});return{setLink:function(a,c){i.debug("Link Browser: setting link : "+a);var d=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""===m()||b.hasClass("default-alias"))b.addClass("default-alias"),b.val(d);if(c&&a.getResourceId()&&a.getResourceType()){var e={clearErrors:function(){},error:function(){},select:function(a){o.update(a,e)}},d={id:a.getResourceId(),type:a.getResourceType()};o.update(d,e)}v(c);i.DarkFeatures.isEnabled(t.OPEN_IN_NEW_WINDOW_DARK_FEATURE)?(g.prop("checked")&&
a.setTarget("_blank"),g.prop("checked","_blank"===a.getTarget())):a.removeTarget();f=a;t.linkValid(f&&f.isHrefValid())},getLink:function(){if(!f)return null;var a=r;a||((a=m())||(a=f.getDefaultAlias()||f.getHref()),a={html:a});f.body=a;f.attrs.href=w(f.attrs.href);return f},refresh:function(a){f&&v(a)},setLinkBody:function(a){r||(a.isEditable?b.val(a.text):a.isImage?l.text(a.imgName):q.text(a.text),r=a.isEditable?null:a,p.toggleClass("hidden",!a.isEditable),z.toggleClass("hidden",!a.isImage),A.toggleClass("hidden",
a.isEditable||a.isImage))},getContainer:function(){return e},isLinkTextVisible:x,isLinkImageVisible:function(){return l.is(":visible")},isNewWindowCheckboxVisible:function(){return g.is(":visible")},isNewWindowCheckboxChecked:function(){return g.prop("checked")},isLinkMixedContentVisible:function(){return q.is(":visible")},focusLinkText:function(){return x()?(i.debug("LinkInfoPresenter.focusLinkText focusing alias"),b.select(),!0):!1},getLinkText:m,getRawLinkText:u,getLinkImageName:function(){return l.text()},
moveLocationPanel:function(a){h||(h=e.find(".row:not(.hidden) .field-group"),h.each(function(a,d){k(d).data("original-parent",k(d).parent())}));h.appendTo(a);e.hide()},restoreLocationPanel:function(){h&&h.each(function(a,c){var d=k(c);d.data("original-parent")&&(d.appendTo(d.data("original-parent")),d.removeData("original-parent"))});e.show();h=null},hasBreadcrumbs:function(a){if(!j.is(":visible"))return!1;var c=a.length,d=j.find("li");if(d.length!==c)return!1;for(var b=0;b<c;b++)if(d.eq(b).text()!==
a[b])return!1;return!0},showOpenInNewWindowCheckbox:function(a){g.closest(".row").toggleClass("hidden",!a)},encodeURLSafely:w}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser-location","Confluence.Editor.LinkBrowser.LinkInfoPresenter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
define("confluence-link-browser/link-browser-tab-search",["jquery","ajs","document","confluence/legacy","confluence/page-location"],function(d,b,n,i,o){return{dialogCreatedLinkBrowserSearch:function(n,j){var c,e,f,m,p=b.REST.getBaseUrl()+"search.json",k=function(a,b){i.Link.isLink(a)||(a=i.Link.fromREST(a));b&&c.val(a.attrs["data-linked-resource-default-alias"]);j.setLink(a,!0);j.focusLinkText()},l=function(a){b.debug("link-browser-tab-search.js: doing search");c.trigger("hide.autocomplete");var g=
d.trim(c.val());g?(f.loading(),b.getJSONWrap({url:p,data:{search:"site",query:g,spaceKey:e.val()},successCallback:function(b){d.isFunction(a)?(f.update(b.result),a()):f.updateAndSelect(b.result);c.trigger("hide.autocomplete")},messageHandler:m})):d.isFunction(a)&&a()};j.tabs.search={hasBreadcrumbs:!0,createPanel:function(a){var g=a.baseElement;c=g.find("#link-search-text");e=g.find("#search-panel-space");var h=o.get();e.find("option:eq(1)").text(h.spaceName).val(h.spaceKey);e.change(function(){c.attr("data-spacekey",
e.val());c.trigger("clearCache.autocomplete")});i.Binder.autocompleteSearch(c.parent());c.bind("selected.autocomplete-content",function(a,b){b.searchFor?l():(f.clear(),k(b.content,!1))});h=[b.SelectGrid.Column({key:"title",heading:"Title",getHref:function(a){return b.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),b.SelectGrid.Column({key:"space",heading:"Space",getText:function(a){return a.space&&
a.space.title||""}}),b.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];m=b.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new b.ResultGrid({baseElement:a.baseElement,columns:h,selectionCallback:function(a,b){k(b)},noResultMessage:"No search results found.",
dontShiftFocus:function(){return d(c).add(e).is(":focus")}});g.find(".search-form").submit(function(){l();return!1}).keydown(function(a){13===a.keyCode&&!d(".aui-dropdown:visible .active",this).length&&(d("#search-panel-button").focus(),a.stopPropagation())})},onSelect:function(){b.debug("Link Browser Search panel selected");var a=this.openedLink;a?(b.debug("Link Browser Search panel setting link info"),k(a,!0)):c.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&
!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(b.Meta.get("content-id"))},doSearch:function(a,b){c.val(a);l(b)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return c}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-search",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserSearch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
define("confluence-link-browser/link-browser-tab-history",["ajs","confluence/legacy"],function(a,h){return{dialogCreatedLinkBrowserHistory:function(i,d){var e=a.REST.makeUrl("session/history.json?max-results=20"),f,g;d.tabs.recentlyviewed={createPanel:function(c){var e=[a.SelectGrid.Column({key:"title",heading:"Title",getHref:function(b){return a.REST.findLink(b.link)},getInnerClass:function(b){return b.iconClass||"content-type-"+b.type}}),a.SelectGrid.Column({key:"space",
heading:"Space",getText:function(b){return b.space&&b.space.title||""}}),a.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(b){return b.lastModifiedDate&&b.lastModifiedDate.friendly||""},getTitle:function(b){return b.lastModifiedDate&&b.lastModifiedDate.date||""}})];g=a.MessageHandler({baseElement:c.baseElement.find(".message-panel")});f=new a.ResultGrid({baseElement:c.baseElement,
columns:e,getRowId:function(b){return b.attachmentId},selectionCallback:function(b,a){var c=h.Link.fromREST(a);d.setLink(c);d.focusLinkText()},messageHandler:g,noResultMessage:"You have no recently viewed content."})},onSelect:function(){f.loading();a.getJSONWrap({url:e,messageHandler:g,successCallback:function(c){f.update(c.content);a.trigger("updated.link-browser-recently-viewed")}})}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-history",function(a){require("ajs").bind("dialog-created.link-browser",a.dialogCreatedLinkBrowserHistory)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
define("confluence-link-browser/link-browser-tab-attachment",["jquery","ajs","confluence/legacy"],function(h,a,j){return{dialogCreatedLinkBrowserAttachment:function(m,i){var f=a.REST.makeUrl("content/"+a.Meta.get("attachment-source-content-id")+"/attachments.json"),g,k,l,d;i.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(b,c){var e=b.baseElement.find(".attach-file-form");g=h.extend({getUploaderController:function(){return j.AttachmentUploader({baseElement:e},function(){return{onUploadSuccess:function(a){for(var b=
0,c=a.length;b<c;b++)a[b].type="attachment";d.prependAndSelect(a)}}})}},c&&c(b));k=g.getUploaderController(b);l=k.getMessageHandler();var f=[a.SelectGrid.Column({key:"title",heading:"Name",getHref:function(b){return b.link?a.REST.findLink(b.link):b.url},getInnerClass:function(a){return a.iconClass}}),a.SelectGrid.Column({key:"size",heading:"Size",getText:function(a){return a.niceFileSize}}),a.SelectGrid.Column({key:"comment",
heading:"Comment"})];d=new a.ResultGrid({baseElement:b.baseElement,columns:f,selectionCallback:function(b,c){var d=j.Link.fromREST(c);d.attrs["data-linked-resource-container-id"]=a.Meta.get("content-id");if(h.isArray(c.link))for(var e=0,f=c.link.length;e<f;e++){var g=c.link[e];"download"===g.rel&&(d.attrs.href=g.href)}i.setLink(d);i.focusLinkText()},noResultMessage:"There are no files on this page."})},onSelect:function(){var b=this.openedLink,c=i.getLink();
d.loading();a.getJSONWrap({url:f,messageHandler:l,successCallback:function(e){d.update(e.attachment);c?"attachment"==c.getResourceType()&&d.select(c.getResourceId()):b?d.select(b.getResourceId()):e.attachment.length&&d.select(e.attachment[0].id);a.debug("Loaded attachments")}})},handlesLink:function(b){return b.isToAttachmentOnSamePage(a.Meta.get("content-id"))}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-attachment",function(h){var a=require("ajs");"template"!==a.Meta.get("content-type")&&a.bind("dialog-created.link-browser",h.dialogCreatedLinkBrowserAttachment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
define("confluence-link-browser/link-browser-tab-weblink",["ajs","jquery","confluence/legacy"],function(d,k,h){return{dialogCreatedLinkBrowserWeblink:function(n,c){function e(){return k.trim(b.val())}function f(){var a=e();if(!(d.Validate.url(a)||0===a.indexOf("mailto:"))){if(d.Validate.email(a))a="mailto:"+a;else{if(l.test(a))return;a="http://"+a}d.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=h.Link.makeExternalLink(a);c.setLink(a)}}function i(){var a=e();(a=a?h.Link.makeExternalLink(a):
null)&&c.setLink(a)}function m(){f();i()}var b,g,j,l=/[:/]/;j=c.tabs.weblink={createPanel:function(a){g=a.baseElement;b=g.find("input[name='destination']");b.keyup(function(){i()});b.change(f);b.bind("paste",function(){d.debug("Link Browser web link url pasted");setTimeout(m,0)})},onSelect:function(){d.DarkFeatures.isEnabled(c.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&c.showOpenInNewWindowCheckbox(!0);c.moveLocationPanel(g.find("form:first"));this.openedLink&&(j.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));
setTimeout(function(){b.focus()})},onDeselect:function(){c.restoreLocationPanel();c.showOpenInNewWindowCheckbox(!1)},preSubmit:f,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},getURL:e}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-weblink",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserWeblink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
define("confluence-link-browser/link-browser-tab-advanced",["jquery","ajs","confluence/legacy","confluence/api/constants","confluence/meta"],function(g,e,l,m,i){return{dialogCreatedLinkBrowserAdvanced:function(p,d){var c,f,h,k,n=function(b){b=g(b);if(b.length){var a=b.find("a:first");a.length?a.hasClass("unresolved")?(b=a.attr("shortcut-key"),a=a.attr("data-space-key"),b?f.text(e.format("{0} is not a recognized shortcut",b)):a&&f.text(e.format("{0} is not a recognized space",
a))):(b=l.Link.fromNode(a[0],c.val()),d.setLink(b)):f.text("The markup provided is not valid link markup")}},o=function(b,a,c){e.debug("Error during conversion: textStatus = "+a+", errorThrown = "+c);f.text("An internal server error occurred")},j=d.tabs.advanced={createPanel:function(b){h=b.baseElement;c=h.find("input[name='advanced-link']");f=h.find("div[name='advanced-error']");h.find("form").keydown(function(a){13===a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});
c.keyup(function(){clearTimeout(k);f.text("");c.val()&&(k=setTimeout(function(){var a=c.val(),a=a.replace(/\[/g,"\\[").replace(/]/g,"\\]"),a={wiki:"["+a+"]",entityId:i.get("content-id"),spaceKey:i.get("space-key"),contextType:i.get("content-type")};g.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:m.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:g.toJSON(a),dataType:"text",success:n,error:o,timeout:1E4})},200))})},setLink:function(b){c.val(b);c.keyup();c.change()},getLink:function(){return c.val()},
onSelect:function(){e.DarkFeatures.isEnabled(d.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&d.showOpenInNewWindowCheckbox(!0);d.moveLocationPanel(h.find("form:first"));this.openedLink&&(this.openedLink.isShortcutLink()?j.setLink(this.openedLink.getShortcut()):this.openedLink.getResourceId()?j.setLink(this.openedLink.getDefaultAlias()):j.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){c.focus()})},onDeselect:function(){d.restoreLocationPanel();d.showOpenInNewWindowCheckbox(!1)},
handlesLink:function(b){return b.isShortcutLink()||b.hasAnchor()}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-advanced",function(g){require("ajs").bind("dialog-created.link-browser",g.dialogCreatedLinkBrowserAdvanced)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_ignored) {
  return '<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="' + soy.$$escapeHtml('Search for \x26lsquo;{0}\x26rsquo;') + '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">' + soy.$$escapeHtml('All content') + '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.searchPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.searchPanel';
}


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_ignored) {
  return '<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.recentlyviewedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.recentlyviewedPanel';
}


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_ignored) {
  return '<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" class="aui"><p>' + soy.$$escapeHtml('Link to a file that is attached to this page or attach a new one.') + '</p><div class="upload-field field-group"><label for="file_0">' + soy.$$escapeHtml('Upload file') + '</label><label id="fancy-file-upload" class="ffi" data-ffi-button-text="Browse"><input type="file" name="file_0" id="file_0"></label><input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" /></form><div class="upload-in-progress upload-field hidden">' + soy.$$escapeHtml('Upload in progress...') + '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.attachmentsPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.attachmentsPanel';
}


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">' + soy.$$escapeHtml('Address') + '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">' + soy.$$escapeHtml('Web, email or any other internet address') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.weblinkPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.weblinkPanel';
}


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="advanced-desc title">' + soy.$$filterNoAutoescape(AJS.format('Here you can insert a link into the page using \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki markup\x3c/a\x3e.',"https://docs.atlassian.com/confluence/docs-713/Links")) + '</div><div class="field-group"><label id="advanced-label" for="advanced-link">' + soy.$$escapeHtml('Link') + '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">' + soy.$$escapeHtml('To insert a link to a new page, type in the desired page title.') + '<br/>' + soy.$$escapeHtml('To insert an anchor link, type #anchorname.') + '</div><div name="advanced-error" class="advanced-error error"></div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.advancedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.advancedPanel';
}


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_ignored) {
  return '<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">' + soy.$$escapeHtml('Link location') + '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">' + soy.$$escapeHtml('Link text') + '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-open-in-new-window hidden"><div class="field-group"><div class="checkbox"><input type="checkbox" class="checkbox" name="open-in-new-window" tabindex="0" id="link-open-in-new-window"><label for="link-open-in-new-window" id="open-window-label">' + soy.$$escapeHtml('Open in new tab/window') + '</label></div></div></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">' + soy.$$escapeHtml('Link image') + '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">' + soy.$$escapeHtml('Link text') + '</label><span id="link-mixed-content"></span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.locationPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.locationPanel';
}


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-713/Links") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.helpLink.soyTemplateName = 'Confluence.Templates.LinkBrowser.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields \x3e input").appendTo("form.editor")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(f){function h(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(d){var e=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(e)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(d,e)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function g(a,b){h(b,function(b,e){b=a.val();a.empty();_.each(e,function(b){var c=
b.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==c&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==c&&(b.templateId||b.contentBlueprintId)&&(c=f("\x3coption\x3e\x3c/option\x3e").text(b.name),c.attr("data-template-id",b.templateId),c.attr("data-blueprint-module-complete-key",b.blueprintModuleCompleteKey),c.attr("data-content-blueprint-id",b.contentBlueprintId),c.attr("data-create-result",b.createResult),
c.val(b.templateId||b.contentBlueprintId),a.append(c))});a.val(b)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),d=b.input.val();a=function(){var a=b.input.val();a!=d&&g(AJS.MacroBrowser.fields.templateName.input,a);d=a};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||"Create from template";
g(f("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,d){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.ImageAttributes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">' + soy.$$escapeHtml('Title text') + '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="' + ((opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '') + '"><div class="description">' + soy.$$escapeHtml('Appears when the cursor hovers over the image') + '</div></div><div class="field-group"><label for="image-alt-attribute">' + soy.$$escapeHtml('Alt text') + '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="' + ((opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '') + '"><div class="description">' + soy.$$escapeHtml('Used by screen readers and when the image cannot be shown') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.ImageAttributes.content.soyTemplateName = 'Confluence.Templates.Editor.ImageAttributes.content';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
define("confluence-image-attributes/image-attributes-panel",["jquery","ajs","confluence/legacy"],function(f,h,g){return function(){function k(){var a=c.val();d.attr({"data-element-title":a,title:l(d.attr("data-location"),a),alt:e.val()})}function m(){c.val()===e.val()&&(c.bind("input.chained",function(a){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}))}function l(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}h.bind("dialog-created.image-properties",
function(a,b){d=f(b.img);a=f(g.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=a.find("#image-title-attribute");e=a.find("#image-alt-attribute");m();g.Editor.ImageProps.registerPanel(n,a,p,k)});var n="image-attributes",p="image-attributes-panel",d,c,e}});require("confluence/module-exporter").safeRequire("confluence-image-attributes/image-attributes-panel",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy"],function(a,b){return{init:function(a){a.on("init",function(){a.addCommand("mceConfimage",b.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants".split(" "),function(d,m,n,j,o,r){var p=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,q=function(a,b,f,c,e){if(c){a.width=b>=e?e:b;a.style.maxWidth=""}else{a.height=f>=e?e:f;a.style.maxHeight=""}},k;k={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var f=d(a),c;c=b.destination;
c=k.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;f.toggleClass("confluence-content-image-border",!!b.border);f.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=p.length;c<e;c++){var h=p[c],g=b[h];g!==false&&g!=null?f.attr(h,g):f.removeAttr(h)}o.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+"/rest/tinymce/1/embed/placeholder/image",
data:d.toJSON(a),dataType:"text",success:function(a){k.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var f,c=k.isScaledByWidth(),e=d(a);f=c?j.Confluence.PropertyPanel.Image.getPresetImageSize("large"):n.get("content-type")==="comment"?j.Confluence.PropertyPanel.Image.getPresetImageSize("small"):j.Confluence.PropertyPanel.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",f+"px");var h=o.activeEditor,g="_"+ +new Date,i=d("<div></div>").append(e.attr("id",g));
h.selection.setContent(i.html());var l=h.dom.get(g);h.dom.setAttrib(l,"id","");if(!e.hasClass("confluence-external-resource")){g=e.attr("data-image-width");i=e.attr("data-image-height");if(g===void 0&&i===void 0){g=e.attr("width");i=e.attr("height")}q(l,g,i,c,f);this.updateThumbnailAttribute(l)}d(l).one("load",function(){e.hasClass("confluence-external-resource")&&q(this,this.width,this.height,c,f);j.Rte.showSelection(function(){b||j.trigger("trigger.property-panel",{elem:l});h.undoManager.add()});
h.fire("Change")})},updateThumbnailAttribute:function(a){var b=a.width,f=a.height;if(b||f){var c=d(a),e=c.attr("data-image-width"),h=c.attr("data-image-height"),g=n.get("max-thumb-width"),i=n.get("max-thumb-height"),a=!this.isRemoteImg(a.src)&&this.isThumbnailUsable(b,f,e,h,g,i);c.attr("thumbnail",a);c.toggleClass("confluence-thumbnail",a)}},isRemoteImg:function(a){var b=j.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,b,f,c,e,d){if(a){if(a>
e)return false;if(f===void 0&&c===void 0)return true;e=f/c;return e>=1?true:e*d>=a}a=b;if(a>d)return false;if(f===void 0&&c===void 0)return true;d=c/f;return d>=1?true:d*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&
!b.attr("height")};if(!k.isRemoteImg(a.destination)&&!d(b).hasClass("confluence-external-resource")){var f=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{m.log("ERROR: could not parse page id from image url "+b);b="0"}f.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:k}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var m=require("tinymce");m.confluence.ImageProperties=d.ImageProperties;m.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links",["ajs","jquery","confluence/legacy","tinymce","window"],function(a,e,i,j,k){var h=0;return{name:"link",canHandleElement:function(a){return a.is("a")&&"#"!=a.attr("href")&&!a.hasClass("unresolved")},handle:function(f){var c=f.containerEl,g=f.ed,b=function(c){return a.Rte.getEditor().translate(c)},f={anchorIframe:a.Rte.getEditorFrame()},d=0===(c.getAttribute("href")||"").indexOf("#"),b=[{className:"link-property-panel-goto-button",
text:b("propertypanel.links_goto"),tooltip:d?b("propertypanel.links_goto_disabled_tooltip"):c.href,href:c.href,disabled:d,click:function(){a.Confluence.PropertyPanel.destroy();var b=k.open(c.href,j.isIE?"_blank":"confluence-goto-link-"+a.params.pageId+"-"+h);b.focus();b.opener=null}},{className:"link-property-panel-edit-button",text:b("propertypanel.links_edit"),tooltip:b("propertypanel.links_edit_tooltip"),disabled:e(c).hasClass("createlink")||!c.href,click:function(){a.Confluence.PropertyPanel.destroy();
g.selection.select(c);i.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:b("propertypanel.links_unlink"),tooltip:b("propertypanel.links_unlink_tooltip"),click:function(){a.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}}],d=[];a.trigger("link-property-panel-buttons.created",{buttons:d,link:c});b=b.concat(d);a.Confluence.PropertyPanel.createFromButtonModel(this.name,c,b,f);h++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(a){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",a)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery confluence/legacy document confluence/macro-js-overrides underscore".split(" "),function(b,m,d,s,n,t,u){var o=[],p=[],l={},k="__PROPERTY_PANEL_SPACER",v=[{key:k}];return{name:"macro",registeredEvents:o,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function i(){var c="macro-placeholder-property-panel-remove-button";e.length>
0&&e[e.length-1].key==k&&(c=c+" first");h.push({className:c,text:"Remove",click:function(){b.Confluence.PropertyPanel.destroy();b.Rte.getEditor().execCommand("mceConfRemoveMacro",j)}});if(g.attr("data-macro-parameters")){var a=s.MacroParameterSerializer.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in a){c=function(c){return function(b){a["atlassian-macro-output-type"]=c;g.attr("data-macro-parameters",s.MacroParameterSerializer.serialize(a));
c=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("active"):d(".macro-placeholder-property-panel-display-inline-button").removeClass("active");d(b).addClass("active")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"Display on new line",selected:a["atlassian-macro-output-type"]=="BLOCK",click:c("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",
tooltip:"Display inline",selected:a["atlassian-macro-output-type"]=="INLINE",click:c("INLINE")})}}d.each(o,function(){(!this.macroName||this.macroName==f)&&d(n).bind(q(this.id,this.macroName),this.handler)});c=p;f&&l[f]&&(c=c.concat(l[f]));d.each(c,function(){try{this(j,h,w)}catch(c){b.debug("Property panel init handler failed for : "+f+".  Is global handler : "+(d.inArray(this,p)>-1),c)}});if(h.length>0){var c=b.Confluence.PropertyPanel.createFromButtonModel("macro",
j,h,w),x=t.getFunction(f,"propertyPanelIFrameInjector");x&&x(c)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){var j=a.containerEl,g=d(j),f,e=[],a=!g.hasClass("editor-inline-macro"),y=!g.hasClass("wysiwyg-unknown-macro"),h=[],w={originalHeight:a&&g.height(),anchorIframe:b.Rte.getEditorFrame()},q=function(c,a){return c+"-button-click"+(a?a+".macro":"")+".property-panel"};if(y){var r=d.Deferred();f=g.attr("data-macro-name");if(b.MacroBrowser.getMacroMetadata(f))e=b.MacroBrowser.getMacroMetadata(f).buttons;
(a=t.getFunction(f,"getControls"))?a(function(a){var b=e,a=u.filter(a,function(a){return a.type==="button"}),a=u.map(a,function(a){return{key:a.key,label:a.name.value}});e=b.concat(v).concat(a).concat(v);r.resolve()}):r.resolve();r.done(function(){var a="macro-placeholder-property-panel-edit-button";e.length>0&&e[0].key==k&&(a=a+" last");h.push({className:a,text:"Edit",click:function(){b.Confluence.PropertyPanel.destroy();m.confluence.macrobrowser.editMacro(g)}});
d.each(e,function(a,c){if(c.key!=k){var i="macro-property-panel-"+c.key;a>0&&e[a-1].key==k&&(i=i+" first");a<e.length-1&&e[a+1].key==k&&(i=i+" last");h.push({className:i,text:c.label,parameterName:c.key,click:function(){d(n).trigger(q(c.key),g);d(n).trigger(q(c.key,f),g);b.Confluence.PropertyPanel.destroy()}})}})}).then(i())}else i()}},registerButtonHandler:function(a,b,d){Array.isArray(a)||(a=[a]);a.forEach(function(a){o.push({id:a,handler:b,macroName:d})})},registerInitHandler:function(a,b){if(b){l[b]=
l[b]||[];l[b].push(a)}else p.push(a)},yieldButtonFor:function(a,b){var j;d.each(a,function(){this.parameterName&&this.parameterName==b&&(j=this)});return j}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(b){var m=require("ajs");m.bind("init.rte",function(){m.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/legacy confluence/api/browser confluence/property-panel".split(" "),function(f,g,s,F,v,w,G,h){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("active")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),d=d.height(),f=v.get("max-thumb-width"),
g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;c.one("load",function(){l(b);q(a);a.width=
Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("active")}function C(a){f(".image-border-toggle").toggleClass("active",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=true;k.updateImageElement(c,a);s.isGecko&&
g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(!isNaN(b)){b<D?b=D:b>E&&(b=E);return b}return null}
var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&
!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.translate(a)},i=function(a){return{className:["image-size-"+a,"editor-resize","resize-"+a].join(" "),text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);
g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);
w.Editor.LinkBrowser.open()}});i.push({className:"image-link-remove",text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-link",click:function(){h.destroy();j.selection.select(c);w.Editor.LinkBrowser.open()}});
for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},
setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("active")}}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs"],function(d,a){function l(){h||(h=d("#image-properties-tab-items > div").map(function(){var a=d(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return h}function m(){var a=c.popup.element,b=650/60,e=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),
f=e.find(".loading-data");e.css({width:e.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],g;for(g in i)b=i[g],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);d.when.apply(d,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function o(){c.hide().remove()}var c,h,i={},n;return{init:function(){n||(h=null,0<l().length&&(n=!0,a.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"Properties",tooltip:"Set additional image properties",click:function(h,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});a.Confluence.PropertyPanel.destroy();d("#image-properties-dialog").remove();c=new a.ConfluenceDialog({id:"image-properties-dialog",
onSubmit:m});a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("Image Properties");c.addSubmit("Save",m);c.addCancel("Cancel",o);for(var e=c,f=l(),g=0;g<f.length;g++){var j=f[g],k=i[j.key];k&&e.addPanel(j.label,k.content,k.panelClass,j.key)}1===f.length&&e.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
define("confluence-templates/variable-manager",["confluence/api/event","jquery"],function(f,g){function i(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function h(c){return g.extend(!0,{},e.defaults[c]||e.defaults.string)}var e=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];return b},contains:function(a){return!!c[a]},
get:function(a){return c[a]},getAll:function(){return g.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(i)},add:function(a,b){c[a]=b||h();f.trigger("add.confluence-variable",{name:a,details:g.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];f.trigger("delete.confluence-variable",{name:a,details:g.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,f.trigger("rename.confluence-variable",{oldName:a,newName:b,details:g.extend(!0,
{},details)}))},createDefault:h}};e.defaultVariableManager=e();e.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}};return e});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-manager",function(f){require("confluence/legacy").VariableManager=f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
define("confluence-templates/variable-placeholder",["ajs","jquery"],function(a,d){return{component:{insertPlaceholder:function(c,e){var b;b="$"+c;var f=a.Rte.getEditor();a.Rte.BookmarkManager.storeBookmark();b={title:b,src:a.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(c),"data-variable-name":c,"class":"template-variable",alt:"$"+c};e&&d.extend(b,e);b=d("<img/>").attr(b);f.selection.setNode(b[0])}},init:function(){d(a.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(a){a.preventDefault()})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-placeholder",function(a){require("confluence/legacy").VariablePlaceHolder=a.component;require("ajs").bind("init.rte",a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
define("confluence-templates/variable-toolbar",["ajs","document","confluence/api/event","jquery","confluence/legacy"],function(e,k,h,f,c){return{init:function(){h.bind("init.rte",function(){var g=c.VariableManager.defaultVariableManager,a=f("#template-menu"),i=a.find(".variables-list");h.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=g.getSortedNames(),j=b.length,d="";i.toggleClass("hidden",!j);for(var a=0;a<j;a++)d+=c.Templates.Variables.renderVariableItem({variableName:"$"+
b[a],tooltip:e.format("Insert the \u0027\u0027{0}\u0027\u0027 field into the page for the template user to fill out.",b[a])});i.html(d)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!g.contains(b)&&g.add(b);c.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=c.Editor.Autocompleter.Manager.getInputDrivenDropdown();e.Rte.getEditor().focus();(!a||a.inactive)&&c.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});f(k).bind("showLayer",
function(b,c,d){"dropdown"===c&&d.$.closest(a).length&&d.reset()})})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-toolbar",function(e){e.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/autocomplete-settings-variables.js' */
define("confluence-templates/autocomplete-settings-variables",["confluence/legacy","ajs"],function(d,c){return function(){function e(a,b){return{callback:function(c){c.replaceWithSelectedSearchText();!f.contains(a)&&f.add(a);d.VariablePlaceHolder.insertPlaceholder(a,b)},name:c.escapeHtml(a),href:"#"}}function i(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}var f=d.VariableManager.defaultVariableManager;return{ch:"$",cache:!1,endChars:[],dropDownDelay:0,
preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"Variable suggestions":"Variable suggestions"},getAdditionalLinks:function(a,b){var e=d.unescapeEntities(b);return f.get(e)||0===b.length?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=a.plainText();a.replaceWithSelectedSearchText();!f.contains(b)&&f.add(b);d.VariablePlaceHolder.insertPlaceholder(b,
void 0)},name:c.format("Create variable \u0027\u0027{0}\u0027\u0027",b)}]},getDataAndRunCallback:function(a,b,c){var g,k,a=d.unescapeEntities(b),j=f.find(a),h=[],l=[];for(g in j)j.hasOwnProperty(g)&&h.push(g);h.sort(i);a=0;for(k=h.length;a<k;a++)g=h[a],l.push(e(g,j[g]));c([l],b)},update:function(){}}}});
require("confluence/module-exporter").safeRequire("confluence-templates/autocomplete-settings-variables",function(d){var c=require("ajs"),e=require("confluence/legacy"),i=require("confluence/meta");c.bind("init.rte",function(){var c=require("tinymce");"template"===i.get("content-type")&&(e.Editor.Autocompleter||(e.Editor.Autocompleter=c.confluence.Autocompleter),e.Editor.Autocompleter.Settings.$=d())})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/property-panel-variables.js' */
define("confluence-templates/property-panel-variables",["ajs","jquery","confluence/legacy"],function(b,a,h){return{name:"variable",canHandleElement:function(a){return a.hasClass("template-variable")},handle:function(f){function l(d){b.debug("clicked type: "+d);var c=a("#property-panel");c.find(".panel-buttons").toggleClass("no-inputs","string"===d);c.find(".textarea-section,.list-section,.string-section").addClass("hidden");c.find("."+d+"-section").removeClass("hidden");"textarea"===d?(a("#variable-property-panel-textarea-rows").val(e.rows),
a("#variable-property-panel-textarea-columns").val(e.columns)):"list"===d&&a("#variable-property-panel-list-values").val(e.options.join(","))}function i(d,b,c){return{className:"variable-property-panel-type-item variable-property-panel-type-"+d,text:b,tooltip:c,selected:m===d,click:function(){e.type=d;e=j.createDefault(d);j.add(k,e);a(".variable-property-panel-type-item").removeClass("selected");a(".variable-property-panel-type-"+d).addClass("selected");l(d)}}}function g(a){return m===a?"":" hidden"}
if(!("click"!==f.e.type&&"mouseup"!==f.e.type)){var f=f.containerEl,n=a(f),k,c=[],o={originalHeight:n.height(),anchorIframe:b.Rte.getEditorFrame()};k=n.attr("data-variable-name");var j=h.VariableManager.defaultVariableManager,e=j.get(k),m=e&&e.type||"string";c.push(i("string","Text","Single line text input field."));c.push(i("textarea","Multi-line Text","Multi-line text input field."));
c.push(i("list","List","Drop down list."));c.push(null);c.push({className:"editable textarea-section"+g("textarea"),tooltip:"Number of rows to display for the field.",html:'<input id="variable-property-panel-textarea-rows"/>'});c.push({className:"variable-property-panel-textarea-split textarea-section"+g("textarea"),tooltip:"",html:"<span>x</span>"});c.push({className:"editable textarea-section"+
g("textarea"),tooltip:"Number of columns to display for the field.",html:'<input id="variable-property-panel-textarea-columns"/>'});c.push(null);c.push({className:"editable list-section"+g("list"),tooltip:"Enter each item for the list, separating each with a comma.",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});b.Confluence.PropertyPanel.createFromButtonModel("variable",f,c,o);l(e.type);a("#variable-property-panel-textarea-rows").change(function(){e.rows=
+a(this).val()||h.VariableManager.defaults.textarea.rows});a("#variable-property-panel-textarea-columns").change(function(){e.columns=+a(this).val()||h.VariableManager.defaults.textarea.columns});a("#variable-property-panel-list-values").change(function(){var d,b,c,f=a(this).val().split(",");e.options=[];d=0;for(b=f.length;d<b;d++)(c=a.trim(f[d]))&&e.options.push(c)});a("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(b){13===
b.which&&a(this).blur()})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-templates/property-panel-variables","AJS.Confluence.PropertyPanel.Variable",function(b){var a=require("ajs");a.bind("init.rte",function(){a.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
define("confluence-templates/variable-marshaller",["ajs","jquery","confluence/legacy"],function(d,b,p){function q(c){var a=c.attr("data-variable-type");return"textarea"===a?{type:a,rows:+c.attr("data-variable-rows")||i,columns:+c.attr("data-variable-columns")||r}:"list"===a?{type:a,options:c.find("li").map(function(){return b(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function m(){var c=b(d.Rte.getEditor().getBody()).find("img[data-variable-name]"),a={};b.map(c,function(c){var f=
{};b(c).attr("data-variable-raw-xhtml")&&(f={"data-variable-raw-xhtml":!0});a[b(c).attr("data-variable-name")]=f});return a}var i=5,r=100;return function(){function c(a){for(var b in a)a.hasOwnProperty(b)&&!f.contains(b)&&(d.debug("adding: ",b),f.add(b,a[b]))}var a=d.Rte.getEditor(),i=b(a.getBody()),f=p.VariableManager.defaultVariableManager;a.on("GetContent",function(a){var d=b("<div></div>"),i=b("<ul></ul>").attr("data-variable-declarations","true"),e;d.append(i);var n=m();c(n);var o=f.getAll(),
l;for(l in o)if(n.hasOwnProperty(l)){var j=l;e=o[l];var g=void 0,k=void 0,g=e.type,h=b("<li></li>");h.attr("data-variable-name",j);h.attr("data-variable-type",g);h.text(j);if("textarea"===g)h.attr("data-variable-rows",e.rows),h.attr("data-variable-columns",e.columns);else if("list"===g){g=b("<ul></ul>");j=void 0;for(j in e.options)k=e.options[j],k=b("<li></li>").text(k).attr("data-variable-option",k),g.append(k);h.append(g)}e=h;i.append(e)}a.content=d.html()+a.content});a=i.find("ul[data-variable-declarations]");
a.remove();a.find("li[data-variable-name]").each(function(){var a=b(this);f.add(a.attr("data-variable-name"),q(a))});c(m())}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-marshaller",function(d){require("ajs").bind("init.rte",d)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Variables.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_ignored) {
  return '<li class="dropdown-item" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltip) + '"><a href="#" class="item-link variable-item" title="' + soy.$$escapeHtml(opt_data.variableName) + '" data-variable-name="' + soy.$$escapeHtml(opt_data.variableName) + '">' + soy.$$escapeHtml(opt_data.variableName) + '</a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Variables.renderVariableItem.soyTemplateName = 'Confluence.Templates.Variables.renderVariableItem';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-editor-resources', location = '/js/slow-edit-handler.js' */
require(["confluence/fh/utils/dom","ajs"],function(c,a){a.toInit(function(){var b=a.Meta.get("browse-page-tree-mode");if("create"===b||"edit"===b)c.addClassToPage(),$("#content").css({paddingRight:0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:edit-resources', location = 'js/edit-init.js' */
require(["ajs","confluence/meta","confluence/share-page/service/share-page","confluence/share-page/service/share-dialog-loader","confluence/dark-features"],function(b,a,f,g,h){function d(){if("page"===a.get("content-type")||"blogpost"===a.get("content-type")){var c=b.$;if(h.isEnabled("react.share.dialog")){var d=c("\x3cdiv\x3e").addClass("invite-to-edit-container").tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"});d.append(c("\x3cspan\x3e").attr("id",
"share-react-link"));c("#rte-toolbar").prepend(d);g.init("share-react-link","edit")}else{c("#rte-toolbar").prepend(c(document.createElement("div")).prop("id","#inviteToEditLink".replace("#","")).addClass("aui-button").addClass("invite-to-edit-button").html('\x3cspan class\x3d"invite-plus-icon"\x3e\x3c/span\x3e').tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"}));var e=c("#inviteToEditLink");c="page"===a.get("content-type")?"Let\u0027s work together on this page":
"Let\u0027s work together on this blog post";f.initDialog("#inviteToEditLink","inviteToEditPopup",{},{heading:"Invite people to edit",notePlaceholder:c,link:function(){return require("confluence/share-page/fetch/content-info")(a.get("content-id"),"draft").pipe(function(b){return a.get("base-url")+b._links.edit})},entityId:function(){return a.get("draft-id")},restriction:function(){return require("confluence/share-page/fetch/content-restrictions")(a.get("content-id")).pipe(function(a){var c=
{};if(a.read.restrictions.user.size||a.read.restrictions.group.size||a.update.restrictions.user.size||a.update.restrictions.group.size)c.type="restrict",c.message="Restrictions on this page may prevent people viewing or editing.";return c})},copyOption:"invite",shareType:"edit",contentType:a.get("content-type"),errorText:"An unexpected error occurred. Please try again.",beforeLoad:function(){e.find(".invite-plus-icon").css("visibility","hidden");e.spin()},afterLoad:function(){e.find(".invite-plus-icon").css("visibility","visible");
e.spinStop()}})}}}"collaborative"===a.get("edit-mode")&&a.get("remote-user")&&(b.Rte.getEditor()&&b.Rte.getEditor().initialized?d():b.bind("rte-collab-ready",d))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.pattern.toolbar1', location = 'aui.chunk.d9b5b002a569fea96067--abe37b305b10dc1232e8.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.pattern.toolbar1"],{DHJP:function(i,n,t){"use strict";t.r(n)}},[["DHJP","runtime"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
define("confluence-keyboard-shortcuts/tinymce-plugin",["ajs","confluence-keyboard-shortcuts/confluence-keyboard-shortcuts"],function(e,b){return{init:function(a){e.debug("Init Editor Keyboard shortcuts plugin");for(var c=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},d=1;7>d;d++)a.addCommand("FormatBlock-h"+d,c("h"+d));a.addCommand("FormatBlock-p",c("p"));a.addCommand("FormatBlock-pre",c("pre"));a.addCommand("FormatBlock-blockquote",c("blockquote"));a.addCommand("mceConfShortcutDialog",
b.keyboardShortcuts.openDialog);a.ui.registry.addButton("help",{text:"confluence.conf_shortcuts_help_desc",onAction:function(){a.execCommand("mceConfShortcutDialog")}})},getInfo:function(){var a=require("tinymce");return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/tinymce-plugin",function(e){var b=require("tinymce");b.create("tinymce.plugins.KeyboardShortcutsPlugin",e);b.PluginManager.add("keyboardshortcuts",b.plugins.KeyboardShortcutsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){function r(){AJS.bind("dialog-created.image-properties",function(a,d){b=d.img;l()?b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth?Confluence.Editor.ImageProps.registerPanel("image-effects",g("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),"image-effects-panel",null):Confluence.Editor.ImageProps.registerPanel("image-effects",g(),"image-effects-panel",t):Confluence.Editor.ImageProps.registerPanel("image-effects",g("Image effects can\u0027t be applied to web images"),
"image-effects-panel",null)});AJS.bind("dialog-before-show.image-properties",function(){m();n(h(e(b)))})}function u(){var a=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});a.addHeader("Add Image Effect");a.addPanel("",g(),"");m();a.addSubmit("Save",function(){p(v,w).done(function(){a.hide()})});a.addCancel("Close",function(){a.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,
{create:function(d){b=d[0];d=h(d);var c=!l();return{className:"image-effects",text:"Effects...",tooltip:c?"Image effects can\u0027t be applied to web images":"Add an image effect like drop shadow or picture frame",click:function(){if(b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth)return alert("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),!1;n(h(e(b)));AJS.Confluence.PropertyPanel.destroy();a.show()},disabled:c,selected:!!d}}})}function x(a,
d){var c=a.attr("src"),b=y.exec(c),e=d?"effects\x3d"+d:"";b?c=c.replace(b[2],e):d&&(c=c+(-1!=c.indexOf("?")?"\x26":"?")+e);a.attr("src",c);a.attr("data-mce-src",c);d=(d=a.attr("confluence-query-params"))?(b=q.exec(d))?d.replace(b[2],e):d+"\x26"+e:e;a.attr("confluence-query-params",d)}function h(a){a=a.attr("confluence-query-params");if(a=q.exec(a))return a[3]}function n(a){e(".image-effect-preview.selected").removeClass("selected");a?e(f).each(function(d,c){if(c.effects==a)return e(e(".image-effect-preview")[d]).addClass("selected"),
!1}):e(".image-effect-preview.image-effect-none").addClass("selected");k=a}function g(a){return a?'\x3cdiv class\x3d"aui-message aui-message-warning warning"\x3e\x3cspan class\x3d"aui-icon icon-warning"\x3e\x3c/span\x3e'+a+"\x3c/div\x3e":'\x3cdiv class\x3d"image-effects"\x3e\x3cul class\x3d"image-list"\x3e\x3c/ul\x3e\x3c/div\x3e'}function m(){for(var a=e("div.image-effects ul.image-list"),d=Math.floor(22*Math.random())+1,c=0;c<f.length;c++){var b=e('\x3cli class\x3d"attached-image image-effect-preview'+
(f[c].effects?"":" image-effect-none")+'"\x3e\x3cdiv class\x3d"image-container"\x3e\x3cimg class\x3d"thumbnail" src\x3d"'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview\x3dtrue\x26id\x3d"+d+"\x26effects\x3d"+f[c].effects+'" title\x3d"'+f[c].name+'" style\x3d"margin-top: 5px"\x3e\x3c/div\x3e\x3cspan class\x3d"caption filename" title\x3d"'+f[c].name+'"\x3e'+f[c].name+"\x3c/span\x3e\x3c/li\x3e");b.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});a.append(b);
b.click(f[c],function(a){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");k=a.data.effects})}}function l(){return!e(b).hasClass("confluence-external-resource")}function t(){return p()}function p(a,d){function c(){d&&d();f.resolve();b.onload=null;tinyMCE.activeEditor.undoManager.add()}var f=e.Deferred();a&&a();b.onload=c;a=b.src;x(e(b),k);b.src==a&&c();return f}function v(){var a=dialog.popup.element,b=650/60,c=e('\x3cdiv class\x3d"image-properties-loading-blanket"\x3e\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo(a.find(".dialog-page-body")),
f=c.find(".loading-data");c.css({width:c.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042})}function w(){var a=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove()}var b,y=/(\?|&)(effects=[^&]+)($|&)/,q=/(^|&)(effects=([^&]+))($|&)/,k=null,f=[];f.push({name:"None",
effects:null});f.push({name:"Taped",effects:"border-simple,blur-border,tape"});f.push({name:"Instant Camera",effects:"border-polaroid,blur-border"});f.push({name:"Curl Shadow",effects:"border-simple,shadow-kn"});f.push({name:"Snapshot",effects:"border-simple,blur-border"});f.push({name:"Drop Shadow",effects:"drop-shadow"});Confluence.Editor.ImageProps?
r():u()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(b,c){function a(){var h=AJS.Meta.get("content-type");var g=AJS.Meta.getBoolean("new-page")?"create":"edit";var f=c("body");var d=f.hasClass("edit")||f.hasClass("create");if(d&&h&&g){if(AJS.Meta.getBoolean("collaborative-content")){var e="confluence."+h+"."+g+".collaborative.view";b.start({key:e,isInitial:true});AJS.bind("rte-collab-ready",function(){b.end({key:e});b.start({key:e+".connected"})});AJS.bind("synchrony.connected",function(){b.end({key:e+".connected"})})}else{if(!AJS.Meta.getBoolean("collaborative-content")){b.start({key:"confluence."+h+"."+g+".view",ready:".active-richtext",isInitial:true})}}}}c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(g,e){var j=moment(g.startDate).startOf("month");var f=moment(e).startOf("month");var d=c.DateUtilities.getNumberOfMonths(j,f);var i=d*Roadmap.MONTH_WIDTH;var h=c.DateUtilities.getMilisecondsFromStartMonth(e)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(e);return Math.round(i+h)},getPosXOnWeekTimeline:function(g,d){var e=moment(g.startDate).startOf("isoWeek");var f=moment(d).diff(e,"weeks",true);var h=f*Roadmap.WEEK_WIDTH;return Math.round(h)},getWidthTimeline:function(f,e){var d=e.duration;if(f.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){d*=Roadmap.MONTH_WIDTH}else{d*=Roadmap.WEEK_WIDTH}return d<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(d-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(i,h){var d=Math.floor(h/Roadmap.MONTH_WIDTH);var g=moment(i.startDate).startOf("month");var e=g.add(d,"months").toDate();var f=Math.abs(h)%Roadmap.MONTH_WIDTH;if(f!==0&&d<0){f=Roadmap.MONTH_WIDTH-f}var j=c.DateUtilities.getMilisecondsInMonth(e)*f/Roadmap.MONTH_WIDTH;return new Date(e.getTime()+j)},getWeekStartDateByPosition:function(f,e){var h=moment(f.startDate).startOf("isoWeek");var d=e/Roadmap.WEEK_WIDTH;var g=d*c.DateUtilities.MILLISECONDS_A_WEEK;return new Date(h.valueOf()+g)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}};c.ColorHelper={resetColorCounts:function(){a.each(Roadmap.COLORS,function(d){d.count=0})},findColor:function(d){return a.find(Roadmap.COLORS,function(e){return e.lane===d.lane})},adjustColorCount:function(e,f){var d=c.ColorHelper.findColor(e);if(d){d.count=d.count+f}},getColor:function(){return a.min(Roadmap.COLORS,function(d){return d.count})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.DateUtilities={MILLISECONDS_A_DAY:86400000,MILLISECONDS_A_WEEK:604800000,parseDate:function(e){var d=moment(e,Roadmap.SHORT_DATE_FORMAT,true);if(d.isValid()){return d}d=moment(e,Roadmap.TWO_YY_SHORT_DATE_FORMAT,true);return d.isValid()?d:null},getDateStringFromDate:function(e,d){if(d){return moment(e).format(d)}return moment(e).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(e,d){return moment(e,d||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(e,d){var g=moment(e),f=moment(d);return f.diff(g,"months")},getMilisecondsInMonth:function(d){return moment(d).daysInMonth()*c.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(d){return d.getTime()-moment(d).startOf("month").valueOf()},calculateDurationInformation:function(d){var g=c.DateUtilities.getMilisecondsInMonth(d.toDate());var e=c.DateUtilities.getMilisecondsFromStartMonth(d.toDate());var f=g-e;return{totalMillisOfMonth:g,millisFromStartMonth:e,millisRemainingOfMonth:f,durationOfMonth:e/g,remainingDurationOfMonth:f/g}},convertToWeekDuration:function(e,g){var l=moment(e);var j=l.clone();var m=c.DateUtilities.calculateDurationInformation(l);if(g<=m.remainingDurationOfMonth){var f=g*m.totalMillisOfMonth;j=j.add(f,"ms")}else{j=j.add(m.millisRemainingOfMonth,"ms");g=g-m.remainingDurationOfMonth;var h=Math.floor(g);if(h>0){j=j.add(h,"months")}var k=g%1;var i=c.DateUtilities.getMilisecondsInMonth(j.toDate());var d=k*i;j.add(d,"ms")}return j.diff(l,"weeks",true)},convertToMonthDuration:function(e,j){var k=moment(e);var f=j*c.DateUtilities.MILLISECONDS_A_WEEK;var i=k.clone().add(f,"ms");var h=i.get("year")*12+i.get("month");h=h-(k.get("year")*12+k.get("month"));var l=c.DateUtilities.calculateDurationInformation(k);if(h===0){return f/l.totalMillisOfMonth}else{var g=l.remainingDurationOfMonth;var d=c.DateUtilities.calculateDurationInformation(i);g=g+d.durationOfMonth;g=g+(h-1);return g}}};c.FieldUtilities={fixDatePickerFields:function(d){var e=d.find("input[data-aui-dp-uuid]");e.each(function(f,g){var i=b(g),h=i.attr("data-aui-dp-uuid");i.on("click focus",function(){var j=b("[data-aui-dp-popup-uuid="+h+"]");if(AJS.version<="5.4.5"){var k=j.datepicker("option","onSelect");j.datepicker("option","onSelect",function(m,l){k(m,l);i.change()})}j.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"New Bar",description:"",startDate:new Date(),duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"New Lane",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(a.length===0){return 0}var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"Marker"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var d=[];var c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);var b=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);if(!c||!b){d.push({name:"date",message:"Enter dates in yy-mm-dd"})}else{if(c.diff(b)>=0){d.push({name:"endDate",message:"Start date needs to be before the end date"})}else{if(b.diff(c,"years",true)>Roadmap.TIMELINE_YEARS_LIMIT){d.push({name:"endDate",message:AJS.format("You cannot plan more than {0} years ahead.",Roadmap.TIMELINE_YEARS_LIMIT)})}}}return d.length>0?d:false},calculateTimelineColumns:function(){var d=this.get("startDate");var f=this.get("endDate");var c=[];var e;if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){e=moment(d).clone().startOf("month");var b=moment(f).clone().endOf("month");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.MONTH_FORMAT),year:e.get("year")});e.add(1,"months")}while(e.diff(b)<0)}else{e=moment(d).clone().startOf("isoWeek");var a=moment(f).clone().endOf("isoWeek");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.WEEK_FORMAT),year:e.get("year")});e.add(1,"weeks")}while(e.diff(a)<0)}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"Roadmap Planner",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);var c=new Roadmap.Markers(this.get("markers"));this.set("markers",c);var b=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",b)},parse:function(a){if(!a.timeline){return Roadmap.getDefaultRoadmapData()}return this.fromMacroData(a)},fromMacroData:function(c){var b=c.timeline;b.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.endDate);var a=c.lanes;_.each(a,function(e){var f=e.bars;_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(g.startDate);if(!g.id){g.id=Confluence.Roadmap.Helper.guid()}});e.bars=f});c.lanes=a;var d=c.markers;_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(e.markerDate)});c.markers=d;return c},toMacroData:function(){var c=this.toJSON();var b=c.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;c.timeline=b;var a=c.lanes.toJSON();_.each(a,function(e){var f=e.bars.toJSON();_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(g.startDate)});e.bars=f});c.lanes=a;var d=c.markers.toJSON();_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.markerDate)});c.markers=d;return c},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d;d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('Add lane'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('Add bar'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('Add marker'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('View by'), options: [{text: 'Months', value: 'MONTH'}, {text: 'Weeks', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error"></div></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){a.bindAll(this,"render")},render:function(){b(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();return this},onAddBarClick:function(i){i.preventDefault();var d=this.model.get("lanes").at(0);var c=d.get("bars");var g=this.model.get("timeline");var f=this.model.get("timeline").get("startDate");var h=g.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?moment(f).startOf("month"):moment(f).startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:d.getNumberOfRows(),startDate:h.toDate()}))},onAddLaneClick:function(d){d.preventDefault();var c=this.model.get("lanes");c.add(new Roadmap.Lane())},onAddMarkerClick:function(f){var g=this.model.get("markers");var d=this.model.get("timeline");var h=moment(d.get("startDate"));var c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?h.date(15):h.isoWeekday(4);g.add(new Roadmap.Marker({markerDate:c.toDate()}))},onTimelineOptionChange:function(d){var c=this.model.get("timeline");c.set({displayOption:this.$timelineSelect.val()})},_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline()},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var c=this;a.each(c.newTimeline.validationError,function(d){c.$timelineError.append(d.message)})},_applyNewTimeline:function(){var c=this.model.get("timeline");var e=Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val());var d=Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());c.set({startDate:e.toDate(),endDate:d.toDate()});this._showTimeLineFormat()},_showTimeLineFormat:function(){var c=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("startDate"),Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("endDate"),Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();if(this.newTimeline.isValid()){this._applyNewTimeline()}else{this._showTimelineErrors()}},_setupTimelineOptionsForm:function(){var e=this.model.get("timeline");var g=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("startDate"),Roadmap.SHORT_DATE_FORMAT),c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("endDate"),Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(g);this.$endDateInput.val(c);this.newTimeline.set({startDateString:g,endDateString:c});this.$timelineSelect.val(e.get("displayOption"));var f={overrideBrowserDefault:true,firstDay:1};this.$startDateInput.datePicker(f);this.$endDateInput.datePicker(f);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};var c={};c.Helper=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){a.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(d){if(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){return{left:c.Helper.getPosXOnMonthTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}}return{left:c.Helper.getPosXOnWeekTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}},getBarDuration:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?(d/Roadmap.MONTH_WIDTH):(d/Roadmap.WEEK_WIDTH)},getBarStartDate:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?c.Helper.getMonthStartDateByPosition(this.model.attributes,d):c.Helper.getWeekStartDateByPosition(this.model.attributes,d)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){a.bindAll(this,"render")},render:function(){var c=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:c}));return this},updateHeight:function(c){this.$el.height(c)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.InlineDialogView=Backbone.View.extend({initialize:function(c){a.bindAll(this,"_onDocumentClick","_onKeyDown","_shouldHide","_onHide");this._trigger=c.trigger;this._dialogOptions=c.dialogOptions;this._reset();var d=this;b(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){d.hide()})},_shouldHideWhenClick:function(c){return !b.contains(this._inlineDialog[0],c.target)},_createInlineDialog:function(d,f){var e,g=this;function h(l,k,j){g._getContent(l);j()}function c(){g._onBeforeShow();a.delay(function(){AJS.InlineDialog.current=null;g._onShow();b(document).on({click:g._onDocumentClick,keydown:g._onKeyDown})},g._inlineDialog.getOptions().fadeTime)}var i={hideCallback:this._onHide,initCallback:c,noBind:true,persistent:true,preHideCallback:this._shouldHide};if(f&&f.isSideInlineDialog){a.extend(i,{calculatePositions:a.compose(this._calculateSidePositions,this._getSideDimensions),offsetX:8,offsetY:0});if(Raphael.version){a.extend(i,{getArrowPath:this._getSideArrowPath})}}e=new AJS.InlineDialog(d,"roadmap-dialog",h,a.extend({},i,f));return e},_onHide:function(){b(document).off({click:this._onDocumentClick,keydown:this._onKeyDown})},hide:function(){this._inlineDialog.remove()},_onDocumentClick:function(c){this._shouldHideWhenClick(c)&&this.hide()},_onBeforeShow:b.noop,_onKeyDown:function(f){var c=f.which===b.ui.keyCode.ESCAPE,d=b(f.target).is(":input");if(c&&!d){this.hide()}},_onShow:b.noop,_reset:function(){this._inlineDialog=this._createInlineDialog(this._trigger,this._dialogOptions);this.setElement(this._inlineDialog)},_shouldHide:function(){return true},show:function(){this._inlineDialog.show()},disable:function(){this.$el.find(":input").attr("disabled","disabled")},enable:function(){this.$el.find(":input").removeAttr("disabled")},_onSubmit:function(){throw new Error("DialogView subclasses must implement _onSubmit().")},_getSideDimensions:function(e,i,p,c){var k=c.container.toLowerCase()!=="body";var d=AJS.$(c.container);var l=k?AJS.$(c.container).parent():AJS.$(window);var n=k?d.offset():{left:0,top:0};var j=k?l.offset():{left:0,top:0};var g=i.target;var q=g.offset();var m=g[0].getBoundingClientRect&&g[0].getBoundingClientRect();var f=m?m.width:g.outerWidth();if(c.timelineWidth){var h=g.position();if(h.left+f>c.timelineWidth){f=c.timelineWidth-h.left-1}}var o={screenPadding:10,arrowMargin:5,window:{top:j.top,left:j.left,scrollTop:l.scrollTop(),scrollLeft:l.scrollLeft(),width:l.width(),height:l.height()},scrollContainer:{width:d.width(),height:d.height()},trigger:{top:q.top-n.top,left:q.left-n.left,width:f,height:m?m.height:g.outerHeight()},dialog:{width:e.width(),height:e.height(),offset:{top:c.offsetY,left:c.offsetX}},arrow:{height:e.find(".arrow").outerHeight()}};return o},_calculateSidePositions:function(i){var g=i.screenPadding;var h=i.window;var o=i.trigger;var y=i.dialog;var f=i.arrow;var s=i.scrollContainer;var A={top:o.top-h.scrollTop,left:o.left-h.scrollLeft};var t=Math.floor(o.height/2);var q=Math.floor(y.height/2);var p=Math.floor(f.height/2);var x=A.left-y.offset.left-g;var B=s.width-A.left-o.width-y.offset.left-g;var u=x>=y.width;var e=B>=y.width;var w=!e&&u?"left":"right";var k=A.top+t-p;var m=h.height-k-f.height;g=Math.min(g,k-i.arrowMargin);g=Math.min(g,m-i.arrowMargin);var l=Math.max(A.top-g,0);var c=Math.max(h.height-A.top-o.height-g,0);var d=Math.max(q-t-y.offset.top-l,0);var v=Math.max(q-t+y.offset.top-c,0);var j=d||-v||0;var r={top:o.top+t-q+y.offset.top+j,left:w==="right"?o.left+o.width+y.offset.left:o.left-y.width-y.offset.left};var z="w";var n={position:"absolute",top:q-p-j};if(w==="right"){n.right="auto";n.left=Raphael.version?"-7px":"0px"}else{n.right="-7px";n.left="auto";z="e"}return{dialogLocation:w,popupCss:r,arrowCss:n,gravity:z}},_getSideArrowPath:function(c){return c.dialogLocation==="right"?"M8,0L0,8,8,16":"M8,0L16,8,8,16"},refresh:function(){this._inlineDialog&&this._inlineDialog.refresh()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('Link page') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('Create page') + '</a></div>' : '') + '</div><div class="clear"></div><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: 'Delete bar', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a href=' + soy.$$escapeHtml("") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Save'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Cancel'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
(function(g){g.fn.editInPlace=function(h){var i=g.extend({},g.fn.editInPlace.defaults,h);d(i);e(i.saving_image);return this.each(function(){var j=g(this);if(j.data("editInPlace")){return}j.data("editInPlace",true);new f(i,j).init()})};g.fn.editInPlace.defaults={url:"",bg_over:"#ffc",bg_out:"transparent",hover_class:"",form_extra_classes:[],show_buttons:false,save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',params:"",field_type:"text",field_extra_classes:[],default_text:"(Click here to add text)",use_html:false,textarea_rows:10,textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:undefined,saving_image:"",saving_animation_color:"transparent",value_required:false,disable_submit_when_empty:false,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:false,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:false,success:null,error:null,error_sink:function(h,i){alert(i)},preinit:null,postclose:null,delegate:null,isAutoCompleteField:false};var c={shouldOpenEditInPlace:function(j,i,h){},willOpenEditInPlace:function(i,h){},didOpenEditInPlace:function(i,h){},shouldCloseEditInPlace:function(j,i,h){},willCloseEditInPlace:function(i,h){},didCloseEditInPlace:function(i,h){},missingCommaErrorPreventer:""};function f(h,i){this.settings=h;this.dom=i;this.originalValue=null;this.didInsertDefaultText=false;this.shouldDelayReinit=false}g.extend(f.prototype,{init:function(){this.setDefaultTextIfNeccessary();this.connectOpeningEvents()},reinit:function(){if(this.shouldDelayReinit){return}this.triggerCallback(this.settings.postclose,this.dom);this.triggerDelegateCall("didCloseEditInPlace");this.markEditorAsInactive();this.connectOpeningEvents()},setDefaultTextIfNeccessary:function(){if(""!==this.dom.html()){return}this.dom.html(this.settings.default_text);this.didInsertDefaultText=true},connectOpeningEvents:function(){var h=this;this.dom.bind("mouseenter.editInPlace",function(){h.addHoverEffect()}).bind("mouseleave.editInPlace",function(){h.removeHoverEffect()}).bind("click.editInPlace",function(i){h.openEditor(i)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){if(this.settings.hover_class){this.dom.addClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_over)}},removeHoverEffect:function(){if(this.settings.hover_class){this.dom.removeClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_out)}},openEditor:function(h){if(!this.shouldOpenEditor(h)){return}this.disconnectOpeningEvents();this.removeHoverEffect();this.removeInsertedDefaultTextIfNeccessary();this.saveOriginalValue();this.markEditorAsActive();this.replaceContentWithEditor();this.setInitialValue();this.workAroundMissingBlurBug();this.connectClosingEventsToEditor();this.triggerDelegateCall("didOpenEditInPlace")},shouldOpenEditor:function(h){if(this.isClickedObjectCancelled(h.target)){return false}if(false===this.triggerCallback(this.settings.preinit,this.dom)){return false}if(false===this.triggerDelegateCall("shouldOpenEditInPlace",true,h)){return false}if(this.settings.isAutoCompleteField&&g(h.target).hasClass("link-page-title")){return false}return true},removeInsertedDefaultTextIfNeccessary:function(){if(!this.didInsertDefaultText||this.dom.html()!==this.settings.default_text){return}this.dom.html("");this.didInsertDefaultText=false},isClickedObjectCancelled:function(j){if(!this.settings.cancel){return false}var h=g(j).parents().andSelf();var i=h.filter(this.settings.cancel);return 0!==i.length},saveOriginalValue:function(){if(this.settings.use_html){this.originalValue=this.dom.html()}else{this.originalValue=a(this.dom.text())}},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(h){h=h||this.settings.default_text;if(this.settings.use_html){this.dom.html(h)}else{this.dom.text(h)}},workAroundMissingBlurBug:function(){var h=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(h).blur()},replaceContentWithEditor:function(){var m=this.createEditorElement();var h="inplace_form";if(this.settings.form_extra_classes instanceof Array){h=h+" "+this.settings.form_extra_classes.join(" ")}this.dom.html('<form class="'+h+'" style="display: inline; margin: 0; padding: 0;"></form>');var j=this.dom.find("form");j.append(m);if(this.settings.show_buttons){var i=g('<div class="inline-edit-buttons"></div>');var k=g(this.settings.save_button);k.addClass("inplace_save");i.append(k);var l=g(this.settings.cancel_button);l.addClass("inplace_cancel");i.append(l);j.append(i)}},createEditorElement:function(){if(-1===g.inArray(this.settings.field_type,["text","textarea","select"])){throw"Unknown field_type <fnord>, supported are 'text', 'textarea' and 'select'"}var h=null;if("select"===this.settings.field_type){h=this.createSelectEditor()}else{if("text"===this.settings.field_type){h=g('<input type="text" '+this.inputNameAndClass()+' size="'+this.settings.text_size+'" />')}else{if("textarea"===this.settings.field_type){h=g("<textarea "+this.inputNameAndClass()+' rows="'+this.settings.textarea_rows+'"  cols="'+this.settings.textarea_cols+'" />')}}}return h},setInitialValue:function(){var h=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue);var i=this.dom.find(":input");i.val(h);if(i.val()!==h){i.val("")}},inputNameAndClass:function(){var h="inplace_field";if(this.settings.field_extra_classes instanceof Array){h=h+" "+this.settings.field_extra_classes.join(" ")}return' name="inplace_value" class="'+h+'"'},createSelectEditor:function(){var m=g("<select"+this.inputNameAndClass()+'><option disabled="true" value="">'+this.settings.select_text+"</option></select>");var j=this.settings.select_options;if(!g.isArray(j)){j=j.split(",")}for(var k=0;k<j.length;k++){var h=j[k];if(!g.isArray(h)){h=h.split(":")}var n=a(h[1]||h[0]);var o=a(h[0]);var l=g("<option>").val(n).text(o);m.append(l)}return m},connectClosingEventsToEditor:function(){var k=this;function j(l){if(!k.settings.isAutoCompleteField){k.handleCancelEditor(l)}return false}function h(l){k.handleSaveEditor(l);return false}var i=this.dom.find("form");i.find(".inplace_field").focus().select();i.find(".inplace_cancel").click(j);i.find(".inplace_save").click(h);if(!this.settings.show_buttons){if("save"===this.settings.on_blur){i.find(".inplace_field").blur(h)}else{i.find(".inplace_field").blur(j)}}i.keyup(function(l){var m=27;if(m===l.which){return j()}});this.bindInputKeyup();i.submit(h)},bindSubmitOnEnterInInput:function(){if("textarea"===this.settings.field_type){return}var h=this;this.dom.find(":input").keyup(function(i){var j=13;if(j===i.which){return h.dom.find("form").submit()}})},bindInputKeyup:function(){if("textarea"===this.settings.field_type){return}var i=this;var h=this.dom.find(":input");var j=this.dom.find(".inplace_save");h.keyup(function(k){var l=13;if(l===k.which){return i.dom.find("form").submit()}else{if(i.settings.disable_submit_when_empty){if(g.trim(h.val()).length){j.removeAttr("disabled")}else{j.attr("disabled","disabled")}}}})},handleCancelEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=this.dom.find(":input").val();i=this.triggerDelegateCall("willCloseEditInPlace",i);this.restoreOriginalValue();this.reinit()},handleSaveEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=g.trim(this.dom.find(":input").val());i=this.triggerDelegateCall("willCloseEditInPlace",i);if(this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(i)){this.handleCancelEditor(h);return}if(this.didForgetRequiredText(i)){if(this.settings.disable_submit_when_empty){return}this.handleCancelEditor(h);this.reportError("Error: You must enter a value to save this field");return}this.showSaving(i);if(this.settings.callback){this.handleSubmitToCallback(i)}else{this.handleSubmitToServer(i)}},didForgetRequiredText:function(h){return this.settings.value_required&&(""===h||undefined===h||null===h)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(h){return !this.settings.save_if_nothing_changed&&this.originalValue===h},showSaving:function(i){if(this.settings.callback&&this.settings.callback_skip_dom_reset){return}var h=i;if(b(this.settings.saving_text)){h=this.settings.saving_text}if(b(this.settings.saving_image)){h=g("<img />").attr("src",this.settings.saving_image).attr("alt",h)}this.dom.html(encodeURIComponent(h))},handleSubmitToCallback:function(h){this.enableOrDisableAnimationCallbacks(true,false);var i=this.triggerCallback(this.settings.callback,this.id(),h,this.originalValue,this.settings.params,this.savingAnimationCallbacks());if(this.settings.callback_skip_dom_reset){}else{if(undefined===i){this.reportError("Error: Failed to save value: "+h);this.restoreOriginalValue()}else{this.dom.html(i)}}if(this.didCallNoCallbacks()){this.enableOrDisableAnimationCallbacks(false,false);this.reinit()}},handleSubmitToServer:function(h){var j=this.settings.update_value+"="+encodeURIComponent(h)+"&"+this.settings.element_id+"="+this.dom.attr("id")+((this.settings.params)?"&"+this.settings.params:"")+"&"+this.settings.original_html+"="+encodeURIComponent(this.originalValue)+"&"+this.settings.original_value+"="+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(true,false);this.didStartSaving();var i=this;g.ajax({url:i.settings.url,type:"POST",data:j,dataType:"html",complete:function(k){i.didEndSaving()},success:function(l){var k=l||i.settings.default_text;i.dom.html(k);i.triggerCallback(i.settings.success,l)},error:function(k){i.dom.html(i.originalHTML);if(i.settings.error){i.triggerCallback(i.settings.error,k)}else{i.reportError("Failed to save value: "+k.responseText||"Unspecified Error")}}})},triggerCallback:function(i){if(!i){return}var h=Array.prototype.slice.call(arguments,1);return i.apply(this.dom[0],h)},triggerDelegateCall:function(j,i,h){if(!this.settings.delegate||!g.isFunction(this.settings.delegate[j])){return i}var k=this.settings.delegate[j](this.dom,this.settings,h);return(undefined===k)?i:k},reportError:function(h){this.triggerCallback(this.settings.error_sink,this.id(),h)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var h=this;return{didStartSaving:function(){h.didStartSaving()},didEndSaving:function(){h.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(i,h){this.didStartSaving.enabled=i;this.didEndSaving.enabled=h},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(h){if(!this[h].enabled){throw new Error("Cannot call "+h+" now. See documentation for details.")}},didStartSaving:function(){this.assertCanCall("didStartSaving");this.shouldDelayReinit=true;this.enableOrDisableAnimationCallbacks(false,true);this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving");this.shouldDelayReinit=false;this.enableOrDisableAnimationCallbacks(false,false);this.reinit();this.stopSavingAnimation()},startSavingAnimation:function(){var h=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){h.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(true).css({backgroundColor:""})},missingCommaErrorPreventer:""});function d(h){if(h.url||h.callback){return}throw new Error("Need to set either url: or callback: option for the inline editor to work.")}function e(i){if(""===i){return}var h=new Image();h.src=i}function a(h){return h.replace(/^\s+/,"").replace(/\s+$/,"")}function b(h){if(undefined===h||null===h){return false}if(0===h.length){return false}return true}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.BarDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click .link-new-page":"_goToCreateLinkPage","click .link-update-page":"_goToUpdateLinkPage"},initialize:function(){a.bindAll(this,"_onPageLinkOpen","_onPageLinkSelectCompleted","_onPageLinkCallback","_onPageLinkBlur","_goToCreateLinkPage");this.options.dialogOptions={width:260,timelineWidth:this.options.timelineWidth,isSideInlineDialog:true,renderOption:this.options.renderOption,linkPageEditable:this.options.linkPageEditable,createLinkPageCallback:this.options.createLinkPageCallback};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.barDialog({bar:a.extend({},this.model.attributes,{description:AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g,"<br />")}),renderOption:this.options.dialogOptions.renderOption,linkPageEditable:this.options.dialogOptions.linkPageEditable}))},_onBeforeShow:function(){this.fields=this._getFields();this._setupInlineEdit()},_getFields:function(){return{$title:this.$el.find("#bar-title"),$description:this.$el.find(".bar-description"),$pageLink:this.$el.find(".bar-page-link"),$pageLinkNew:this.$el.find(".link-new-page"),$pageLinkUpdate:this.$el.find(".link-update-page")}},_setupInlineEdit:function(){var f=this;var d=this.fields;var i=this.options.dialogOptions.renderOption.editInplace;var e={form_extra_classes:["aui"],hover_class:"editable-field-hover aui-icon-small aui-iconfont-edit",field_extra_classes:["text"],show_buttons:true,save_button:Confluence.Templates.Roadmap.inlineEditSaveButton(),cancel_button:Confluence.Templates.Roadmap.inlineEditCancelButton(),error_sink:null,use_html:true,default_text:"Click to add description.",delegate:{shouldOpenEditInPlace:function(){f.$el.find(".inplace_cancel").trigger("click")},didCloseEditInPlace:function(){setTimeout(function(){f.refresh()},0)}}};i.title&&d.$title.editInPlace(c.extend(true,{},e,{callback:function(j,k){f.options.updateTitle(k);return AJS.escapeHtml(k)},value_required:true,disable_submit_when_empty:true,delegate:{willOpenEditInPlace:function(){f.refresh();d.$title.find(".text").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_TITLE)}}}));(c.trim(d.$description.text())==="")?d.$description.addClass("empty-field"):d.$description.removeClass("empty-field");var g=c.extend(true,{},e,{field_type:"textarea",field_extra_classes:["textarea"],value_required:false,save_if_nothing_changed:true,callback:function(j,k){k=c.trim(k);f.options.updateDescription(k);if(k===""){k="Click to add description.";c(this).addClass("empty-field")}else{c(this).removeClass("empty-field");Confluence.Roadmap.Analytics.addDescription()}return AJS.escapeHtml(k).replace(/\r?\n/g,"<br />")},delegate:{willOpenEditInPlace:function(){f.refresh();d.$description.find(".textarea").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);return f.model.attributes.description.replace(/<br\s*[\/]?>/gi,"\n")}}});i.description&&d.$description.editInPlace(g);var h=c.extend(true,{},e,{isAutoCompleteField:true,show_buttons:false,default_text:"",field_extra_classes:["text","autocomplete-confluence-content"],delegate:{willOpenEditInPlace:f._onPageLinkOpen,didCloseEditInPlace:function(){if(a.isEmpty(d.$pageLink.data("linkData"))){d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show()}}},on_blur:null,callback:f._onPageLinkCallback});i.pageLink&&this.options.dialogOptions.linkPageEditable&&this.fields.$pageLink.editInPlace(h)},_onPageLinkOpen:function(e){var f=this;e.append('<div class="link-page-dropdown" />');var g=e.find(".autocomplete-confluence-content");g.attr({placeholder:"Search page","data-dropdown-target":"#inline-dialog-roadmap-dialog .link-page-dropdown","data-none-message":"No matches found"});Confluence.Binder.autocompleteConfluenceContent(e);g.bind("selected.autocomplete-content",this._onPageLinkSelectCompleted);g.on("blur",function(){setTimeout(f._onPageLinkBlur,150)});var d=this.model.attributes.pageLink;this.fields.$pageLink.data("linkData",d);if(!a.isEmpty(d)){return d.title}return true},_onPageLinkSelectCompleted:function(d,g){d.stopPropagation();var f=this.fields.$pageLink.find(".autocomplete-confluence-content");var e=g.content;f.val(e.title);this.fields.$pageLink.data("linkData",g.content);a.defer(this._onPageLinkBlur)},_onPageLinkBlur:function(){var d=this.fields.$pageLink.find(".autocomplete-confluence-content");var f=c.Event("keyup");f.which=AJS.keyCode.ENTER;d.trigger(f)},_onPageLinkCallback:function(e,f){var d=(f==="")?{}:this.fields.$pageLink.data("linkData");return this._updatePageLink(d)},_updatePageLink:function(e){if(e.id===this.model.attributes.pageLink.id){return}var d=this.fields;if(a.isEmpty(e)){this.options.updatePageLink({});d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show();return "No linked page"}else{var f=a.pick(e,"id","title","type","spaceKey","wikiLink");if(!e.spaceKey){f.spaceKey=e.space.key}this.options.updatePageLink(f);d.$pageLink.show();d.$pageLinkNew.hide();d.$pageLinkUpdate.hide();if(this.options.renderOption.isEditMode){Confluence.Roadmap.Analytics.addPageLinkEditMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")>0?AJS.Meta.get("page-id"):AJS.Meta.get("draft-id"),isDraft:AJS.Meta.get("page-id")<=0})}else{Confluence.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")})}return Confluence.Templates.Roadmap.buildPageLink({pageLink:e,isEditMode:this.options.renderOption.isEditMode})}},_onDeleteClick:function(){this.options.deleteBar();this.remove()},_goToCreateLinkPage:function(f){var e=this.options.dialogOptions;if(e.createLinkPageCallback){var d=a.bind(e.createLinkPageCallback,{me:this},f);d()}},_goToUpdateLinkPage:function(d){d.preventDefault();this.fields.$pageLink.show();this.fields.$pageLinkNew.hide();this.fields.$pageLinkUpdate.hide();this.fields.$pageLink.click()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink=(function(f,a){Roadmap.trackingBars=[];function c(j,k){var g={};if(parseInt(j.pageId)<=0){j.parentPageId=AJS.Meta.get("parent-page-id")}var h=f.param(j);var i=window.open(AJS.contextPath()+"/plugins/roadmap/create-page.action?"+h,"_blank");i.opener=null;b(j.roadmapBarId).done(function(l){Roadmap.trackingBars.push(j.roadmapBarId)});f(window).off("focus");f(window).on("focus",function(){if(!Roadmap.trackingBars.length){f(window).off("focus")}a.each(Roadmap.trackingBars,function(l){d(l).done(function(n){var m=n.status;if(m=="REDEEM"){e(l);k({barId:l,pageLink:f.parseJSON(n.pageLink)})}else{if(m=="UNKNOWN"){e(l)}}})})})}function e(g){Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(g),1)}function b(g){return f.ajax({contentType:"application/json",type:"PUT",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/PENDING"})}function d(g){return f.ajax({contentType:"application/json",type:"GET",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/status"})}return{addCreateLinkPageListener:c}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder"></div><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Macro unavailable') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3eThe roadmap macro has been deprecated as of version 12. You can still view your existing roadmap macros but you will no longer be able to edit them or create new ones.\x3c/p\x3e\x3cp\x3ePlease use our new Roadmap Planner macro to plan your roadmap.\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Add bar'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename lane'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete lane'}, iconClass: 'aui-icon-small delete-icon'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename marker'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete marker'}, iconClass: 'aui-icon-small delete-icon'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('Lane color') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title"></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({text: 'Insert', id: 'roadmapInsertBtn'}) + aui.buttons.button({text: 'Cancel', type: 'link', id: 'roadmapCancelBtn'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(b,a){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var c=this;this.$el.draggable({opacity:0.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",snapMode:"inner",snapTolerance:17,scroll:true,zIndex:4020,helper:function(){return c.$el.clone().addClass("roadmap-bar-clone").data("View",c)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var c=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:c.left+"px",width:c.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(d){this.$el.resizable("option","maxWidth",d);var c=this.$el.resizable("option","minWidth");if(d<c){this.$el.resizable("option","minWidth",d)}},_beforeResize:function(d,c){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(d))},_checkHandleDirection:function(c){var d=b(c.toElement?c.toElement:c.originalEvent.target);if(d.hasClass("ui-resizable-w")){return"left"}else{if(d.hasClass("ui-resizable-e")){return"right"}}throw"Unsupport resize direction handling = "+d},_updateBar:function(d,c){if(c.originalPosition.left!=c.position.left){this.model.set({startDate:this.options.timelineView.getBarStartDate(c.position.left),duration:this.options.timelineView.getBarDuration(c.element.outerWidth())})}else{if(c.originalSize.width!=c.size.width){this.model.set("duration",this.options.timelineView.getBarDuration(c.element.outerWidth()))}}},appendTo:function(c){this.$el.appendTo(c)},updateColor:function(c){this.$el.css({"background-color":c.bar,"border-color":c.lane,color:c.text})},updatePositionLeft:function(c){this.$el.css("left",c)},_onDragStop:function(d,c){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(c){this.options.deleteBar=c},_showDialog:function(c){if(!b(c.target).is(".ui-resizable-handle")){this._barDialog&&this._barDialog.remove();this._barDialog=this._createDialog();this._barDialog.show();Confluence.Roadmap.Analytics.openBarDialogInEdit()}},_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:true,editInplace:{title:true,pageLink:true,description:true}},linkPageEditable:true,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(c){this.model.set("title",c);this.$el.attr("title",c);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(c))},_updateDescription:function(c){this.model.set("description",c)},_updatePageLink:function(c){this.model.set("pageLink",c)},_onDragstart:function(d,c){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[c])},_onDropOver:function(d,c){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;if(Roadmap.DragDrop.barDraggingOver&&c.helper.data("isAddingNewRow")!==true){c.helper.addClass("roadmap-bar-overlapped")}},_onDropOut:function(f,d){var c=this;delete Roadmap.DragDrop.barDraggingOver[c.cid];d.helper.removeClass("roadmap-bar-overlapped");a.each(Roadmap.DragDrop.barDraggingOver,function(g){var e=d.helper.data("isAddingNewRow")!==true;if(e){if(typeof g==="string"){d.helper.addClass("roadmap-bar-overlapped")}else{if(g.className==="roadmap-bar-row"){g.$el.addClass("roadmap-bar-drag-hover")}}}})},_goToCreateLinkPage:function(f){f.preventDefault();var e=this.me;var c=parseInt(AJS.Meta.get("page-id"));var d=c>0?c:AJS.Meta.get("parent-page-id");var g={roadmapBarId:e.model.id,roadmapContentId:d,updateRoadmap:false};Confluence.RoadmapLink.addCreateLinkPageListener(g,function(i){var h=e._updatePageLink(i.pageLink);e.fields.$pageLink.html(h)})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(b,a){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){a.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var c=this;this.$el.droppable({greedy:true,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(f,d){Roadmap.DragDrop.barDraggingOver[c.cid]=c;if(d.helper.data("isAddingNewRow")!==true){var g=b(this);g.closest(".roadmap-content").find(".new-row-placeholder").remove()}else{c.$el.removeClass("roadmap-bar-drag-hover")}},out:function(){var d=b(this);delete Roadmap.DragDrop.barDraggingOver[c.cid];d.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(g,f){var d=a.reject(Roadmap.DragDrop.barDraggingOver,function(e){return(typeof e==="object")}).length>0;if(!f.helper.hasClass("roadmap-bar-overlapped")&&!d){b(this).trigger("BarView.drop",[{$barViewHelper:f.helper,$barViewOriginal:f.draggable,$barRow:b(this)},f])}}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(b,a){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){a.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var f=this.options.$barRow;var c=this.options.renderBottom===false?(this.margin*-1):f.height();var e=f.index()===0;var d=(e)?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:f.position().top+c-d,width:f.width()})},_onDrop:function(d,c){this.$el.trigger("BarView.drop",[{barRowNewView:this},c])},_onDropOver:function(d,c){this.$el.trigger("BarRowNew.dropover",[this,c])},_onDropOut:function(d,c){this.$el.trigger("BarRowNew.dropout",[this,c])}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.LaneDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){a.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};c(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){c("#lane-color-picker").hide()});b.prototype.initialize.call(this,this.options)},_getContent:function(d){var g=this.options.lane.model.get("color").lane;d.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:g}));this.$el.find(".aui-button").tooltip({gravity:"s"});var e=this;var f=this.$el.find("#lane-color-picker .color-item");f.click(function(i){i.preventDefault();var h=Roadmap.COLORS[f.index(this)];if(h.lane!=g){e.options.changeColor(h)}c("#lane-color-picker").hide()})},_getDialogWidth:function(){var e=29;var f=51;var d=2;if(this.options.canDelete){d++}return d*e+f},_onDeleteClick:function(){this.options.deleteLane();this.remove()},_onRenameClick:function(){if(!this._laneRenameDialog){this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane})}this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){c("#lane-color-picker").hide();b.prototype._onHide.call(this)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=c.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(f){var g=d.trim(this.controls.$laneTitle.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$laneTitle.select()},_onRenameButtonClick:function(e){e.preventDefault();this.hide();var f=this.controls.$laneTitle.val();this.options.lane.renameTitle(f)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=b.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){if(!this._markerRenameDialog){this._markerRenameDialog=new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker})}this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=c.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(f){var g=d.trim(this.controls.$title.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$title.select()},_onSaveButtonClick:function(f){f.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete","_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(d){var c=this._newBarRowView();var e=this._newBarView(d);c.$el.append(e.render().$el);this._$laneContent.append(c.$el);this._barViews.push(e);this.$el.trigger("BarView.add",e);a.defer(this._updateLaneHeight)})},render:function(){var c=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),1);var d=this.model.get("bars").models;d=a.sortBy(d,function(e){return e.attributes.rowIndex});a.each(d,function(e){var f=c._newBarView(e);c._barViews.push(f)});this._renderBars();a.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(c){this.model.set("title",c);this.$el.find(".roadmap-lane-title").attr("title",c);this.$el.find(".title-inner").html(AJS.escapeHtml(c));this._updateLaneHeight()},_updateLaneHeight:function(){var d=this.$el.find(".title-inner");d.hide();var c=this._$laneContent.outerHeight();d.width(c-2*Roadmap.LANE_PADDING);d.show()},_barBeforeResize:function(e,k){var l=e.$el;var g=Math.ceil(l.outerWidth()-l.width());var j;if(k=="left"){var f=this._getNearestBarView(e,k);var c=f==null?0:f.position().left+f.width()+g;var d=l.position().left-c;j=l.width()+d}else{var i=this._getNearestBarView(e,k);var h=i==null?this._getLaneContentWidth()-g:i.position().left-g;j=h-l.position().left}e.updateMaxWidth(j-Roadmap.BAR_MARGIN)},_renderBars:function(){var c=this;this._$laneContent=this.$el.find(".roadmap-lane-content");var d={};a.each(this._barViews,function(f){var g="row-"+f.model.get("rowIndex");var e=d[g];if(!e){e=c._newBarRowView(f.model.get("rowIndex"));d[g]=e}e.$el.append(f.render().$el);c._$laneContent.append(e.$el)})},_newBarRowView:function(){var c=new Roadmap.BarRowView();this._barRowViews.push(c);return c},_newBarView:function(c){var d=new Roadmap.BarView({model:c,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});d.on("beforeResize",a.bind(this._barBeforeResize,this));return d},_getNearestBarView:function(d,e){var f=a.filter(d.options.lane._barViews,function(g){return g.model.get("rowIndex")===d.model.get("rowIndex")});var c=null;if(e=="left"){a.each(f,function(g){if(g.$el.position().left<d.$el.position().left&&(c==null||g.$el.position().left>c.$el.position().left)){c=g}})}else{a.each(f,function(g){if(g.$el.position().left>d.$el.position().left&&(c==null||g.$el.position().left<c.$el.position().left)){c=g}})}return c!=null?c.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(i,k,l){var n=!!k.barRowNewView;var f=l.draggable.data("View");var m=f.model;var h=f.options.lane;var j=(h.cid===this.cid);var g=this.model.get("bars");var o=l.position.left;var d=this.options.timelineView.getBarStartDate(o);if(j&&g.models.length===1&&n){return}f.updatePositionLeft(o);f.updateColor(this.model.get("color"));m.attributes.startDate=d;if(n){var c=this._newBarRowView();k.barRowNewView.$el.replaceWith(c.$el);f.appendTo(c.$el)}else{f.appendTo(k.$barRow)}l.helper.remove();if(!j){f.options.lane.removeEmptyRow();g._byId[m.id]=m;this._barViews.push(f);f.updateDeleteBar(this._deleteBar);h.model.get("bars").remove(m);g.models.push(m);h._barViews.splice(a.indexOf(h._barViews,f),1);this.updateRowIndex(h.$el);f.options=a.extend(f.options,{color:this.model.get("color"),lane:this});h._updateLaneHeight()}this.removeEmptyRow();this.updateRowIndex(this.$el);this._updateLaneHeight()},updateRowIndex:function(c){c.find(".roadmap-bar-row").each(function(e,d){b(d).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(h,f){var g=b(f).data("View");if(g){g.model.attributes.rowIndex=e}})})},removeEmptyRow:function(){var c=0;a.each(this._barRowViews,function(d){if(d.isEmptyRow()){d.remove();c++}});return !!c},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(c){if(this._laneDialog){this._laneDialog.remove();delete this._laneDialog}this.options.canDelete=c},_deleteBar:function(c){this.model.get("bars").remove(c.model);this._barViews.splice(a.indexOf(this._barViews,c),1);c.remove();if(this.removeEmptyRow()){this.updateRowIndex(this.$el);this._updateLaneHeight();this.$el.trigger("BarRowView.remove")}},_addBar:function(){var c=this.model.get("bars");var e=this.options.timelineView.model;var f=moment(e.get("startDate"));var d=e.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?f.startOf("month"):f.startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:d.toDate()}))},_changeColor:function(c){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.model.set("color",c);Confluence.Roadmap.ColorHelper.adjustColorCount(c,1);this.$el.find(".roadmap-lane-title").css({"background-color":c.lane,color:c.text});a.each(this._barViews,function(d){d.updateColor(c)})},addNewBarRow:function(h){var g=this._$laneContent.find(".roadmap-bar-row");var c=[];var d=function(){g.each(function(){var k=b(this);var j=k.index()===0;if(j){var l=new Roadmap.BarRowNewView({$barRow:k,renderBottom:false});k.before(l.render().$el);c.push(l)}var i=new Roadmap.BarRowNewView({$barRow:k});k.after(i.render().$el);c.push(i)})};if(g.length==0){this.addDefaultBarRow()}else{var e=g.find(".roadmap-bar");if(e.length>0){var f=(e.length>0)&&(e.length==1)&&(e.attr("cid")===h.attr("cid"));if(!f){d()}}}return c},addDefaultBarRow:function(){var c=this._newBarRowView();this._$laneContent.append(c.$el)},_onBarRowNewDropover:function(f,d,c){if(!a.isEmpty(Roadmap.DragDrop.barDraggingOver)){a.each(Roadmap.DragDrop.barDraggingOver,function(e){e.$el&&e.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")})}Roadmap.DragDrop.barDraggingOver[d.cid]=d;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",true)},_onBarRowNewDropout:function(f,d,c){c.helper.data("isAddingNewRow",false);delete Roadmap.DragDrop.barDraggingOver[d.cid];a.each(Roadmap.DragDrop.barDraggingOver,function(e){if(typeof e==="string"){c.helper.addClass("roadmap-bar-overlapped")}else{if(e.className==="roadmap-bar-row"&&c.helper.data("isAddingNewRow")!==true){e.$el.addClass("roadmap-bar-drag-hover")}}})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){a.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var d=this.options.roadmap._timelineView.model;var c;if(d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){c=Confluence.Roadmap.Helper.getPosXOnMonthTimeline(d.attributes,this.model.get("markerDate"))}else{c=Confluence.Roadmap.Helper.getPosXOnWeekTimeline(d.attributes,this.model.get("markerDate"))}if(c<0||c>this.options.roadmap._timelineView.$el.width()){return false}this.$el.css({left:(c+Roadmap.LANE_TITLE_WIDTH)+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());a.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(g,f){var c=f.position.left-Roadmap.LANE_TITLE_WIDTH;var d=this.options.roadmap._timelineView.model.attributes;var h;if(d.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){h=Confluence.Roadmap.Helper.getMonthStartDateByPosition(d,c)}else{h=Confluence.Roadmap.Helper.getWeekStartDateByPosition(d,c)}this.model.set("markerDate",h)},_onDragStart:function(d,c){this.options.roadmap.hideDialog()},_onMarkerClick:function(c){if(!b(c.target).hasClass("marker-title")){return}this._markerDialog&&this._markerDialog.remove();this._markerDialog=this._createMarkerDialog();this._markerDialog.show()},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(c){this.$el.height(c+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(d){this.model.set("title",d);var c=this.$el.find(".marker-title");c.attr("title",d);c.html(AJS.escapeHtml(d)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){a.bindAll(this,"render");this.listenTo(this.model.get("lanes"),"add",function(c){var d=new Roadmap.LaneView({model:c,timelineView:this._timelineView,canDelete:true});if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(true)}this._laneViews.push(d);this.$roadmapContent.append(d.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(c){var d=new Roadmap.MarkerView({model:c,roadmap:this});this.$roadmapMarker.append(d.render().$el);this._markerViews.push(d)});this.listenTo(this.model.get("timeline"),"change",function(){if(this._isTimelineChanged()){this._calculateMinWidthOfABar();this._timelineView.update();this._timelineColumnView.update();this.$roadmapContent.empty();a.each(this._laneViews,function(c){c.remove()});this._laneViews=[];this._renderLanes();this.$roadmapMarker.empty();this._markerViews=[];this._renderMarkers();this._updateDragArea()}})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var c=this;this.model.get("markers").each(function(d){var e=new Roadmap.MarkerView({model:d,roadmap:c});c.$roadmapMarker.append(e.render().$el);c._markerViews.push(e)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var d=this;this._updateLaneWidth();var c=this.model.get("lanes").models.length>1;this.model.get("lanes").each(function(e){var f=new Roadmap.LaneView({model:e,timelineView:d._timelineView,canDelete:c});d._laneViews.push(f);d.$roadmapContent.append(f.render().$el)});this._setupLaneReordering()},_onAddBar:function(d,c){this._updateTimelineColumnHeight();var e=c.$el;if(!this._isInViewScreen(e)){this._scrollToBar(e)}},_renderToolbar:function(){var d=b("#"+this.options.dialogId+" .aui-dialog2-content");d.find(".roadmap-toolbar").remove();var c=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});d.prepend(c.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(c){return b.inviewport(c,{threshold:-200})},_scrollToBar:function(c){this.options.roadmapEditorPopup.scrollTop(c.parent().position().top);this.options.roadmapEditorPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},_onDeleteLane:function(d,c){this.model.get("lanes").remove(c.model);this._laneViews.splice(a.indexOf(this._laneViews,c),1);c.remove();this._updateTimelineColumnHeight();if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(false)}},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var c=this._getLaneHeight();this._timelineColumnView.updateHeight(c);a.each(this._markerViews,function(d){d.updateHeight(c)})},hideDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},removeDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(f,d){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];a.each(this._laneViews,function(e){c._barRowNewViewList.push(e.addNewBarRow(d.helper))})},_updateDragArea:function(){var c=this.$roadmapContainer.find(".roadmap-drag-area");c.css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){a.each(a.flatten(this._barRowNewViewList),function(c){c.remove()});delete this._barRowNewViewList;a.each(this._laneViews,function(c){c.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:0.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(d,c){return b(c).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(d,c){this.hideDialog();this._timelineColumnView.$el.hide();c.placeholder.css({height:Math.min(c.helper.height(),100),width:c.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));c.helper.find(".roadmap-lane-content").css({width:c.helper.width()-(c.helper.find(".roadmap-lane-title").outerWidth()+c.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(h,g){this._timelineColumnView.$el.show();var d=g.item.attr("cid");var f=a.find(this._laneViews,function(e){return e.cid===d});var c=f.model;var i=this.model.get("lanes");i.remove(c);i.models.splice(g.item.index(),0,c);i._byId[c.cid]=c},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var d=function(f,e){if(f.getMonth()!==e.getMonth()||f.getYear()!==e.getYear()){return true}return false};var c=this.model.get("timeline");return d(c._previousAttributes.startDate,c.attributes.startDate)||d(c._previousAttributes.endDate,c.attributes.endDate)},_isWeekChanged:function(){var c=function(l,k){var j=moment(l);var i=moment(k);return j.get("year")===i.get("year")&&j.isoWeek()===i.isoWeek()};var d=this.model.get("timeline");var g=d._previousAttributes.startDate;var h=d.attributes.startDate;var f=d._previousAttributes.endDate;var e=d.attributes.endDate;return !(c(g,h)&&c(f,e))},_isTimelineChanged:function(){var d=this.model.get("timeline");var c=d.changed.displayOption;if(c){this.model.updateDurationUnit(d.get("displayOption"))}else{c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged()}return c},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap=Confluence.Roadmap||{};Confluence.Roadmap.Analytics=(function(f,j){var c={INSERT:"confluence.roadmap.insert",CREATE:"confluence.roadmap.create",EDIT:"confluence.roadmap.edit",EDIT_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.editmode.open_bar_dialog",ADD_DESCRIPTION:"confluence.roadmap.editmode.add_description",ADD_PAGE_LINK:"confluence.roadmap.editmode.add_page_link"},VIEW_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.viewmode.open_bar_dialog",CLICK_PAGE_LINK:"confluence.roadmap.viewmode.click_page_link",ADD_PAGE_LINK:"confluence.roadmap.viewmode.add_page_link"}};function h(o,p){AJS.trigger("analytics",{name:o,data:p})}function m(p){var o=0;j.each(p.lanes,function(q){o=o+q.bars.length});return{lanes:p.lanes.length,bars:o,markers:p.markers.length,months:Confluence.Roadmap.DateUtilities.getNumberOfMonths(p.timeline.startDate,p.timeline.endDate)+1}}function k(){h(c.INSERT)}function d(p){var o=m(p);h(c.CREATE,o)}function e(p){var o=m(p);h(c.EDIT,o)}function a(){h(c.EDIT_ACTIONS.OPEN_BAR_DIALOG)}function n(){h(c.VIEW_ACTIONS.OPEN_BAR_DIALOG)}function b(){h(c.VIEW_ACTIONS.CLICK_PAGE_LINK)}function l(){h(c.EDIT_ACTIONS.ADD_DESCRIPTION)}function g(o){h(c.EDIT_ACTIONS.ADD_PAGE_LINK,o)}function i(o){h(c.VIEW_ACTIONS.ADD_PAGE_LINK,o)}return{insertRoadmap:k,createRoadmap:d,editRoadmap:e,openBarDialogInEdit:a,addDescription:l,addPageLinkEditMode:g,addPageLinkViewMode:i,openBarDialogInView:n,clickPageLink:b}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return(b<=a(c).offset().left-d.threshold)||a(c).offset().left<0};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(){var g,d,a,c,e;var f="~~~~~";AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(l){var n=function(s,q,r,t){var p=r?r.split(f):[];var o=q?q.split(f):[];if(!_.isEmpty(p)){$.ajax({type:"POST",contentType:"application/json",url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(p,o),roadmapSpace:AJS.Meta.get("space-key")}),success:function(u){_.each(s.lanes,function(v){_.chain(v.bars).filter(function(w){return _.contains(p,w.id)}).each(function(w){if(u[w.id]){w.pageLink=u[w.id]}})});t&&t()},error:function(u){AJS.log(u);t&&t()}})}else{t&&t()}},m=function(p){var q=[];var o=[];p.lanes.forEach(function(r){r.bars.forEach(function(s){if(!_.isEmpty(s.pageLink)){var t=s.pageLink.wikiLink.replace(/[\][]/g,"");q.push(_.escape(t));o.push(s.id)}})});return{pageLinks:q.join(f),mapLinks:o.join(f)}};if(l.params&&l.params.timeline!=="true"){var i="roadmap-deprecation-dialog";var j=$(Confluence.Templates.Roadmap.deprecationDialog({id:i}));AJS.dialog2(j).on("hide",function(){$("#"+i).remove()}).on("show",function(){$("#dialog-close-button",j).click(function(o){o.preventDefault();AJS.dialog2("#"+i).hide()})}).show();return false}var h;var k=function(){var p="confluence-roadmap-dialog";var t="roadmap-popup-panel";var s;if(typeof g=="undefined"){g=aui.dialog.dialog2({id:p,size:"xlarge",titleText:"Insert Roadmap Planner",content:Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:t}),footerActionContent:Confluence.Templates.Roadmap.footerActionContent(),modal:true});d=$(g).appendTo($("body"));d.find("#roadmapInsertBtn").on("click",function(y){c.removeDialog();var v=c.model.toMacroData();var w=encodeURIComponent(JSON.stringify(v));var x=hex_md5(w);var z=m(v);var u={timeline:"true",source:w,hash:x,title:encodeURIComponent(v.title),pagelinks:z.pageLinks,maplinks:z.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:u});c.remove();s.hide();if(e){Confluence.Roadmap.Analytics.createRoadmap(v)}else{Confluence.Roadmap.Analytics.editRoadmap(v)}});d.find("#roadmapCancelBtn").on("click",function(u){c.removeDialog();c.remove();s.hide()});a=d.find(".roadmap-editor-popup")}s=AJS.dialog2("#"+p).show();var o=$("#"+t);var q=o.find(".roadmap-view");if(!q.length){q=$('<div class="roadmap-view"/>');o.append(q)}var r=new Roadmap.Roadmap(h,{parse:true});c=new Roadmap.RoadmapEditorView({model:r,dialogId:p,el:q,roadmapEditorPopup:a});c.render();b()};if(l.params&&l.params.source){e=false;h=JSON.parse(decodeURIComponent(l.params.source));n(h,l.params.pagelinks,l.params.maplinks,k)}else{e=true;Confluence.Roadmap.Analytics.insertRoadmap();k()}}});function b(){setTimeout(function(){if(d&&d.is(":visible")){var k=d.height(),j=d.find(".aui-dialog2-header").outerHeight(),l=d.find(".aui-dialog2-footer").outerHeight(),i=d.find("#roadmap-editor-toolbar").outerHeight(),h=d.find(".roadmap-editor-popup");h.css("height",k-j-l-i)}},0)}$(window).resize(function(){b();c&&c.resize()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT="YYYY-MM-DD";Roadmap.TWO_YY_SHORT_DATE_FORMAT="YY-MM-DD";Roadmap.DATE_FORMAT="YYYY-MM-DD HH:mm:ss";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=Roadmap.BAR_PADDING*2+Roadmap.BAR_BORDER*2;Roadmap.MONTH_BAR_MIN_WIDTH=Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){var a=moment(new Date()).hours(0).minutes(0).seconds(0).milliseconds(0).toDate();var b=moment(a).add(11,"months").toDate();return{title:"Roadmap Planner",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},lanes:[{title:"Lane 1",color:Roadmap.COLORS[0],bars:[{title:"Bar 1",description:"This is the first bar.",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"Bar 2",description:"This is the second bar.",startDate:new Date(a),duration:1,rowIndex:1}]},{title:"Lane 2",color:Roadmap.COLORS[1],bars:[{title:"Bar 3",description:"This is the third bar.",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"Marker 1",markerDate:moment(a).date(15).toDate()}]}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:include_macro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var c=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id");AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(a,b){a=AJS.$(b).attr("data-macro-default-parameter");a=c+"/plugins/servlet/confluence/include-page-macro/goto?location\x3d"+encodeURIComponent(a)+"\x26contentId\x3d"+d;(b=window.open(a,AJS.$.browser&&AJS.$.browser.msie?"_blank":"confluence-goto-link-include-macro-"+b.id))&&b.focus()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.multimedia:macro-browser-smart-fields', location = 'javascript/macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia",["swf","avi","mov","mp4","mpeg","mpg","wmv","wma","mp3","ram","rm"])})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.soy' */
// This file was automatically generated from page-layout.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.PageLayout.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageLayout == 'undefined') { Confluence.Templates.PageLayout = {}; }


Confluence.Templates.PageLayout.contentLayout = function(opt_data, opt_ignored) {
  return '<div class="contentLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.contentLayout.soyTemplateName = 'Confluence.Templates.PageLayout.contentLayout';
}


Confluence.Templates.PageLayout.cellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.cellLayout';
}


Confluence.Templates.PageLayout.smallCellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell aside"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.smallCellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.smallCellLayout';
}


Confluence.Templates.PageLayout.headerLayout = function(opt_data, opt_ignored) {
  return '<div class="header"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.headerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.headerLayout';
}


Confluence.Templates.PageLayout.footerLayout = function(opt_data, opt_ignored) {
  return '<div class="footer"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.footerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.footerLayout';
}


Confluence.Templates.PageLayout.columnLayout = function(opt_data, opt_ignored) {
  return '<div class="columnLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.columnLayout.soyTemplateName = 'Confluence.Templates.PageLayout.columnLayout';
}


Confluence.Templates.PageLayout.emptyLayout2 = function(opt_data, opt_ignored) {
  return '<div class="contentLayout2">' + Confluence.Templates.PageLayout.emptySection2(null) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptyLayout2.soyTemplateName = 'Confluence.Templates.PageLayout.emptyLayout2';
}


Confluence.Templates.PageLayout.emptySection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptySection2.soyTemplateName = 'Confluence.Templates.PageLayout.emptySection2';
}


Confluence.Templates.PageLayout.newSection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.newSection2.soyTemplateName = 'Confluence.Templates.PageLayout.newSection2';
}


Confluence.Templates.PageLayout.cell2 = function(opt_data, opt_ignored) {
  return '<div class="cell ' + soy.$$escapeHtml(opt_data.type) + '" data-type="' + soy.$$escapeHtml(opt_data.type) + '"><div class="innerCell">' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cell2.soyTemplateName = 'Confluence.Templates.PageLayout.cell2';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout",["jquery","ajs","tinymce"],function(d,e,f){function j(a){a=d(a.getBody());if(a.children(".contentLayout").length)return!1;a.children(".contentLayout2");return!0}var i=function(a){var e=d("#pagelayout-menu"),h=d(".icon-check",e);i=function(a){var c=h.not(".hidden"),a=h.siblings("."+a.name).siblings();c.addClass("hidden");a.removeClass("hidden")};i(a)};return{init:function(a){function l(){j(a)||f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())||
f.webkit||e.Rte.editorFocus(a)}function h(){f.isGecko&&setTimeout(function(){a.focus();a.dom.getRoot().focus()},1)}function k(g){var b=d("#pagelayout-menu").parent(),e=d("#page-layout-2-group");if(!g||!g.selection)j(a)?(b.addClass("hidden"),e.removeClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout2(a),f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&d(a.getBody()).attr("contenteditable","true")):(b.removeClass("hidden"),e.addClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout(a),
f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())?c.body.attr("contenteditable","true"):h(),i(c.getLayout()))}var c;this.ed=a;"comment"!==e.Meta.get("content-type")&&(a.on("init",function(){a.undoManager.clear();a.undoManager.add();k();e.bind("editor.remote.change editor.local.change",function(){a.undoManager.ignore(function(){c.setup()})});e.bind("rte-ready",function(){var c=d('[contenteditable="true"]',a.getBody()),b=!1!==e.Meta.get("editor-auto-focus");c.attr("contenteditable",
"false");c.attr("contenteditable","true");b&&e.Rte.editorFocus(a)});a.on("SetContent",l);if(j(a))a.on("Undo",function(){f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&c.body.attr("contenteditable","true");h()})}),d("#pagelayout-menu").delegate("li.dropdown-item a","click",function(){a.execCommand("mcePageLayout",!1,f.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(this))}),a.addCommand("mcePageLayoutInitialize",function(){a.undoManager.add();c.createInitialLayoutIfNone()}),
a.addCommand("mcePageLayout",function(g,b){a.undoManager.add();c.setLayout(b);i(c.getLayout())}),a.addCommand("mcePageLayoutAddSection",function(g,b){a.undoManager.add();c.addSection&&c.addSection(b&&b.section)}),a.addCommand("mcePageLayoutChangeSection",function(g,b){a.undoManager.add();c.changeSection&&c.changeSection(b&&b.layout,b&&b.section)}),a.addCommand("mcePageLayoutRemoveSection",function(g,b){a.undoManager.add();c.removeSection&&c.removeSection(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionUp",
function(g,b){a.undoManager.add();c.moveSectionUp&&c.moveSectionUp(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionDown",function(g,b){a.undoManager.add();c.moveSectionDown&&c.moveSectionDown(b&&b.section)}),a.on("SetContent",k),a.on("click",function(c){var b=d(c.target);b.is("div.cell")&&b.children(".innerCell").focus();if(f.isWebKit&&(c.target===a.getBody()||c.target===a.getBody().parentNode))b=b.find(".innerCell"),b.length&&(a.execCommand("selectAll"),c=c.target!==a.getBody(),a.selection.collapse(c))}),
a.on("keyup",function(c){var b=c.keyCode;if(8!==b&&46!==b)return!0;b=a.selection.getRng(!0).startContainer;if(d(b).closest(".contentLayout,.contentLayout2",a.getBody()).length&&(b=d(b).closest(".innerCell"))&&b.length&&a.dom.isEmpty(b.clone()[0]))b.html('<p><br data-mce-bogus="1"></p>'),c.preventDefault(),a.selection.select(b[0].firstElementChild.firstChild,!0),a.selection.collapse(!0)}))},execCommand:function(a){if("selectAll"===a){var a=this.ed,e=a.getBody(),d,f;if("true"==a.dom.getAttrib(e,"contenteditable"))return!1;
d=a.dom.select(".innerCell",e);e=d[0];d=d[d.length-1];f=a.dom.createRng();f.setStart(e,0);f.setEnd(d,d.childNodes.length);a.selection.setRng(f);return!0}return!1},disableContent:function(){this.ed.dom.setAttribs(this.ed.dom.select("div.innerCell"),{contenteditable:!1});this.ed.dom.setStyle(this.ed.dom.select(".wiki-content .contentLayout2"),"user-select","auto")},getInfo:function(){return{longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",
version:"1.0"}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout",function(d){var e=require("tinymce");e.create("tinymce.plugins.PageLayoutPlugin",d);e.PluginManager.add("pagelayoutplugin",e.plugins.PageLayoutPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.js' */
define("confluence-page-layout/pagelayout/page-layout",["jquery","confluence/templates","ajs"],function(c,k,r){var h=function(a){this.editor=a;this.body=c(a.getBody());this.setup()};h.DEFAULT_LAYOUT={name:"pagelayout-none",columns:0};h.prototype.setup=function(){var a=c(".contentLayout",this.body);a.length?(n(a),o(a,this.body,this.editor),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};h.prototype.setLayout=function(a){var g=require("tinymce"),b;b=c(".contentLayout",this.body);
if(h.getLayoutOptions(b).name!==a.name){r.trigger("analyticsEvent",{name:"PageLayoutEvent.pageLayoutChanged",data:{name:a.name}});if(1===b.length)b=b.clone();else{var d=this.editor;b=this.body;var e=k.PageLayout.contentLayout(),d=d.dom.create("div");d.innerHTML=e;b=c(d).children().html(b.html())}n(b);var e=b,d=c(".columnLayout > .cell",e).length,i=a.name,j=a.columns,f;if(0===d){f=e.html();for(e.html(k.PageLayout.columnLayout());d!==j.length;)p(e),d++}i=i.substring(i.indexOf("-")+1);i=i.substring(0,
Math.max(0,i.indexOf("-"))||void 0);c(".columnLayout",e).attr("class","columnLayout "+i+"Columns");if(j)for(c(".columnLayout > .cell",e).each(function(a,b){void 0!==j[a]&&c(b).attr("class","cell "+j[a])});d!==j.length;)if(d<j.length)p(e),d++;else{var i=c(".columnLayout .cell:nth-child("+d+") .innerCell",e),s=c(".columnLayout > .cell:nth-child("+(d-1)+") .innerCell",e),t=l(i);s.append(t);i.parent().remove();d--}else{var m="";c(".columnLayout > .cell",e).each(function(){m+=l(c(".innerCell",this))});
c(".columnLayout",e).replaceWith(m)}f&&q(e).html(f);a.header?(f=b,c(".header",f).length||f.prepend(k.PageLayout.headerLayout())):(e=b,f=c(".header",e),e=q(e),d=l(c(".innerCell",f)),e.length?(e.prepend(d),f.remove()):f.replaceWith(d));a.footer?(f=b,c(".footer",f).length||f.append(k.PageLayout.footerLayout())):(e=b,f=c(".footer",e),e=c(".columnLayout > .cell:last-child .innerCell",e),d=l(c(".innerCell",f)),e.length?(e.append(d),f.remove()):f.replaceWith(d));h.needsContentEditableBody(a)?(b=b.contents().unwrap(),
this.body.attr("contenteditable","true")):(o(b,this.body,this.editor),b.attr("data-atlassian-layout",JSON.stringify(a)));this.body.empty().append(b);g.isIE&&this.editor.dom.setRoot();b=this.editor;a=b.selection;g=a.getRng(!0);f=c('[contenteditable="true"]',b.getBody());f.length?(b.focus(),f[0].focus(),b=f.children()[0],g.setStart(b,0),g.setEnd(b,0),a.setRng(g)):b.focus()}};h.prototype.getLayout=function(){var a=c(".contentLayout",this.body);return a.length&&a.attr("data-atlassian-layout")?JSON.parse(a.attr("data-atlassian-layout")):
h.DEFAULT_LAYOUT};h.getLayoutOptions=function(a){return(a=(a.jquery?a:c(a)).attr("data-atlassian-layout"))?JSON.parse(a):h.DEFAULT_LAYOUT};h.needsContentEditableBody=function(a){return!(a.header||a.footer||a.columns)};var l=function(a){a=a.jquery?a:c(a);if(a.length)for(var g=a[0].childNodes,b=0;b<g.length;b++){var d=g[b];if(!("P"===d.nodeName&&1===d.childNodes.length&&"BR"===d.firstChild.nodeName))return a.html()}return""},n=function(a){for(var g,b,a=c(".cell, .header, .footer",a),d=0,e=a.length;d<
e;d++)g=c(a[d]),b=g.html(),c(".innerCell",g).length||(g.removeAttr("contenteditable"),g.html('<div class="innerCell">'+b+"</div>"))},o=function(a,g,b){var d=require("tinymce");g.attr("contenteditable","false");c(".innerCell",a).each(function(){var a=c(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")});d.isIE&&g.delegate(".innerCell","focus.pageLayout",function(){b.dom.settings.root_element=this})},q=function(a){return c(".columnLayout > .cell:first-child .innerCell",
a)},p=function(a){return c(".columnLayout",a).append(k.PageLayout.cellLayout())};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout","tinymce.plugins.PageLayoutPlugin.PageLayout");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout-2.js' */
define("confluence-page-layout/pagelayout/page-layout-2",["jquery","confluence/templates","ajs"],function(g,n,f){function p(a,b,d){var c=a.find(".cell"),e=c.length,f=g(),k=b.cells.length,i=[],l=[],h,j;a.attr("class","columnLayout");a.addClass(b.id);a.attr("data-layout",b.id);h=0;for(j=e;h<j;h++)l=c.eq(h).detach(),i.push(s(l.children(".innerCell")));h=0;for(j=k;h<j;h++)f=f.add(n.PageLayout.cell2({type:b.cells[h].type||""}));if(e<=k)l=i;else{l=i.slice(0,k);h=k;for(j=e;h<j;h++)l[k-1]+=i[h]}a.prepend(f);
h=0;for(j=k;h<j;h++)f.eq(h).find(".innerCell").html(l[h]);o(a,d)}var e=function(a){this.editor=a;this.body=g(a.getBody());this.setup()};e.prototype.setup=function(){var a=this.body.find(".contentLayout2");a.length?(o(a,this.body),this.body.find("> p").each(function(){""===this.id.trim()&&0===this.classList.length&&g(this).remove()}),this.body.find(".contentLayout2 .cell").filter(function(){return 1<g(this).find(".innerCell").length}).each(function(a,d){for(var c=g(d).find(".innerCell"),e=c[0],f=1;f<
c.length;f++){var i=g(c[f]);g(e).append(i.children());i.remove()}}),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};e.prototype.addSection=function(a){var b=this,d=g(n.PageLayout.newSection2()),c=a||i(this.body,this.editor,!0);if(c.length){var r=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(d,r,b.body,b.editor);c.after(d)});m(this.editor,d);f.trigger("editor.page-layout.add-section",{section:d})}else this.createInitialLayoutIfNone()};e.prototype.changeSection=
function(a,b){var d=this;e.isPageLayout()||this.createInitialLayoutIfNone();var c=b||i(this.body,this.editor,!1);if(c.length){var g=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(c,a,d.body,d.editor)});m(this.editor,c);f.trigger("editor.page-layout.change-layout",{section:c,originalLayout:g,currentLayout:a})}};e.prototype.removeSection=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next(),d=a.prev(),c;b.length?(c=b,a.remove()):d.length?
(c=d,a.remove()):(a.closest(".contentLayout2").remove(),a=this.body.find(".contentLayout2").find(".columnLayout").first(),a.length?c=a:(a=this.editor,a.getBody().setAttribute("contenteditable",!0),a.setContent("<p></p>"),q(a),a=g("#rte-button-pagelayout-2"),a.hasClass("active")&&a.click()));c&&c.length&&m(this.editor,c);f.trigger("editor.page-layout.remove-section",{})}};e.prototype.moveSectionUp=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.prev();b.length&&(a.detach(),
b.before(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-up",{section:a})}};e.prototype.moveSectionDown=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next();b.length&&(a.detach(),b.after(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-down",{section:a})}};e.prototype.createInitialLayoutIfNone=function(){if(!e.isPageLayout()){var a=g(n.PageLayout.emptyLayout2()),b=a.find(".innerCell"),d=this.body.children().detach();b.append(d);this.body.append(a);
o(a,this.body);q(this.editor)}};e.isPageLayout=function(){return!!g(f.Rte.getEditor().getBody()).find("div.contentLayout2").length};e.needsContentEditableBody=function(){return!e.isPageLayout()};e.Layouts=[{id:"single",icon:"1col",name:"Single column section",cells:[{type:"normal"}]},{id:"two-equal",icon:"2col",name:"Two column section",cells:[{type:"normal"},{type:"normal"}]},{id:"two-left-sidebar",icon:"2col-right",name:"Two column section with left side-bar",
cells:[{type:"aside"},{type:"normal"}]},{id:"two-right-sidebar",icon:"2col-left",name:"Two column section with right side-bar",cells:[{type:"normal"},{type:"aside"}]},{id:"three-equal",icon:"3col",name:"Three column section",cells:[{type:"normal"},{type:"normal"},{type:"normal"}]},{id:"three-with-sidebars",icon:"3col-center",name:"Three column section with side-bars",cells:[{type:"sidebars"},{type:"normal"},{type:"sidebars"}]}];e.Layouts.get=
function(a){for(var b=e.Layouts,d=0,c=b.length;d<c;d++)if(b[d].id===a)return b[d];return null};e.Layouts.findNearestSection=function(a){var b=f.Rte.getEditor(),d=g(b.getBody());return i(d,b,a)};var s=function(a){a=g(a);if(a.length)for(var b=a[0].childNodes,d=0;d<b.length;d++){var c=b[d];if(!("P"===c.nodeName&&1===c.childNodes.length&&"BR"===c.firstChild.nodeName))return a.html()}return""},i=function(a,b,d){b=g(b.selection.getRng(!0).startContainer).closest(".columnLayout");!b.length&&d&&(b=a.find(".columnLayout").last());
return b},o=function(a,b){b.attr("contenteditable","false");g(".innerCell",a).each(function(){var a=g(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")})},q=function(a){var b=a.selection,d=b.getRng(!0),c=g('[contenteditable="true"]',a.getBody());c.length?(a.focus(),c[0].focus(),a=c.children()[0],d.setStart(a,0),d.setEnd(a,0),b.setRng(d)):a.focus()},m=function(a,b){var d=a.selection,c=d.getRng(!0),e=b.find('[contenteditable="true"]').first(),g=e.children();g.length?
(a.focus(),e[0].focus(),e=g[0],c.setStart(e,0),c.setEnd(e,0),d.setRng(c),f.Rte.showElement(e)):a.focus()};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout-2","tinymce.plugins.PageLayoutPlugin.PageLayout2");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout-toolbar.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",["jquery","ajs","tinymce","document","confluence/legacy"],function(d,b,e,f,a){var i=function(a){var a=a||e.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection(),c=a.attr("data-layout"),a=d("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),c=a.find(".pl2-layout-"+c).closest(".aui-button");c.hasClass("active")||(a.filter(".active").removeClass("active"),c.addClass("active"))};return{initContextToolbars:function(p,
c){var j=d(f),m=d("#page-layout-2"),g=d("#rte-button-pagelayout-2");c.addCommand("mcePageLayoutsToolbar",function(){g.hasClass("active")?j.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(j.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:a.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),i(),c.execCommand("mcePageLayoutInitialize"));g.toggleClass("active")});g.click(function(a){a.preventDefault();m.hasClass("disabled")||c.execCommand("mcePageLayoutsToolbar",
!1,null)});c.on("NodeChange",function(a){a=d(a.element).closest(".columnLayout");i(a)});for(var k=e.plugins.PageLayoutPlugin.PageLayout2.Layouts,l=[],n=function(b){l.push(new a.Editor.Toolbar.Components.Button({text:b.name,iconClass:"aui-icon aui-icon-small aui-iconfont-layout-"+b.icon+"-large",click:function(){c.execCommand("mcePageLayoutChangeSection",!1,{layout:b})}}))},h=0,o=k.length;h<o;h++)n(k[h]);return{Buttons:[new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Add section",
id:"add-layout-section",tooltip:"Add a new section below",iconClass:"aui-icon aui-icon-small aui-iconfont-add",click:function(){c.execCommand("mcePageLayoutAddSection")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Remove section",id:"remove-layout-section",tooltip:"Remove the current section",iconClass:"aui-icon aui-icon-small aui-iconfont-delete",click:function(){c.execCommand("mcePageLayoutRemoveSection")}})]),
new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Move up",id:"move-up-layout-section",tooltip:"Move section up",iconClass:"aui-icon aui-icon-small aui-iconfont-up",click:function(){c.execCommand("mcePageLayoutMoveSectionUp")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Move down",id:"move-down-layout-section",tooltip:"Move section down",
iconClass:"aui-icon aui-icon-small aui-iconfont-down",click:function(){c.execCommand("mcePageLayoutMoveSectionDown")}})]),new a.Editor.Toolbar.Components.Group(l,{id:"pagelayout2-toolbar",text:"Apply layout",groupClass:"layouts"}),new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({text:"Close toolbar",iconClass:"aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){c.execCommand("mcePageLayoutsToolbar",!1,
null)}})],{groupClass:"close"})],Events:[]}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",function(d){var b=require("confluence/meta"),e=require("jquery"),f=require("document"),a=require("confluence/legacy");"comment"!==b.get("content-type")&&e(f).bind("initContextToolbars.Toolbar",function(b,e){a.Editor.PageLayoutToolbar=d.initContextToolbars(b,e)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:space-page-picker-shim', location = 'js/space-page-picker-shim.js' */
define("confluence-inline-tasks/space-page-picker-shim",["confluence-ui-components/js/space-page-picker"],function(d){function e(a){var b={page:[],space:[]};if(!a)return b;a.split(",").forEach(function(a){a=a.split(":");b[a[0]].push(a[1])});return b}return{build:function(a){return d.build(a)},setValue:function(a,b){return d.setValue(a,b)},splitStringToMap:e,combineMapToString:function(a){var b=a.space;a=a.page;var c=[];b&&(c=c.concat(_.map(b.split(","),function(a){return"space:"+a})));a&&(c=c.concat(_.map(a.split(","),
function(a){return"page:"+a})));return c.join(",")},getValueAsMap:function(a){return e(a.val())}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/macro-browser-overrides.js' */
define("confluence-inline-tasks/macro-browser-overrides",["jquery","ajs","confluence/templates","confluence-macro-browser/macro-browser","confluence-inline-tasks/space-page-picker-shim"],function(e,h,k,f,d){return{fields:{string:{spaceAndPage:function(a){var b=a.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page",g=e(k.MacroBrowser.macroParameter()),c=g.find("input[type\x3d'text']");c.addClass(b).attr("data-none-message","Not found");
a.required&&c.keyup(f.processRequiredParameters);c.auiSelect2(d.build({multiple:a.multiple,orgElement:c,inputSpaceId:"legacy-macro-param-spaces",inputSpaceCatId:"legacy-macro-param-space-cats",inputPageId:"legacy-macro-param-pages"}));return f.Field(g,c,{setValue:function(a){d.setValue(a,c)}})}}},beforeParamsSet:function(a){var b=d.combineMapToString({page:a.pages,space:a.spaces});b&&(a.spaceAndPage=b);delete a.pages;delete a.spaces;return a},beforeParamsRetrieved:function(a){var b=d.splitStringToMap(a.spaceAndPage);
b.page.length&&(a.pages=b.page.join(","));b.space.length&&(a.spaces=b.space.join(","));delete a.spaceAndPage;return a}}});require("confluence/module-exporter").safeRequire("confluence-inline-tasks/macro-browser-overrides",function(e){require("confluence-macro-browser/macro-browser").setMacroJsOverride("tasks-report-macro",e)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:confluence-inlineTasks-utils', location = '/js/util.js' */
define("confluence-inline-tasks/util",["jquery"],function(b){return{NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(a){a=
b(a);var c=require("tinymce");a.attr({contenteditable:!1,"class":"non-editable",onselectstart:"return false;"});c.isIE&&a.attr({contenteditable:!0,unselectable:"on",oncontrolselect:"return false;"})}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/util","Confluence.InlineTasks.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:datepicker1', location = '/js/date-picker1.js' */
define("confluence-inline-tasks/date-picker1",["jquery","ajs","confluence-editor/utils/tinymce-node-utils"],function(d,h){function f(t,b){var l;var c={};var v=A++;var a=d(t);a.attr("data-aui-dp-uuid",v);b=d.extend(void 0,f.prototype.defaultOptions,b);c.getField=function(){return a};c.getOptions=function(){return b};var C=function(){var e,p,m;c.hide=function(){k.hide()};c.show=function(){k.show()};c.setDate=function(a){"undefined"!==typeof e&&e.datepicker("setDate",a)};c.getDate=function(){if("undefined"!==
typeof e)return e.datepicker("getDate")};var t=function(B){m.off();if(b.hint){var g=d("\x3cdiv/\x3e").addClass("aui-datepicker-hint");g.append("\x3cspan/\x3e").text(b.hint);m.append(g)}e=d("\x3cdiv/\x3e");e.attr("data-aui-dp-popup-uuid",v);m.append(e);g={dateFormat:b.dateFormat,defaultDate:a.val(),maxDate:a.attr("max"),minDate:a.attr("min"),nextText:"\x3e",onSelect:function(d){a.val(d);a.change();c.hide();p=!0;a.focus();b.onSelect&&b.onSelect.call(this,d)},onChangeMonthYear:function(){setTimeout(k.refresh,
0)},prevText:"\x3c"};d.extend(g,B);-1<b.firstDay&&(g.firstDay=b.firstDay);"undefined"!==typeof a.attr("step")&&h.debug("WARNING: The date picker polyfill currently does not support the step attribute!");e.datepicker(g);d("body").on("keydown",q);a.on("focusout keydown",w);a.on("propertychange keyup input paste",x)};var q=function(b){var g=d(b.target),e=g.closest(m).length||g.is(a),f=g.closest(".ui-datepicker-header").length;!e&&!f||b.keyCode===h.keyCode.ESCAPE?c.hide():g[0]!==a[0]&&b.preventDefault()};
var w=function(){u||(d("body").on("focus blur click mousedown","*",q),u=!0)};var y=function(){p?p=!1:c.show()};var x=function(){d(this).val()&&(e.datepicker("setDate",a.val()),e.datepicker("option",{maxDate:a.attr("max"),minDate:a.attr("min")}))};c.destroyPolyfill=function(){c.hide();a.attr("placeholder",null);a.off("propertychange keyup input paste",x);a.off("focus click",y);a.off("focusout keydown",w);d("body").off("keydown",q);f.prototype.browserSupportsDateField&&(a[0].type="date");"undefined"!==
typeof e&&e.datepicker("destroy");delete c.destroyPolyfill;delete c.show;delete c.hide};var u=p=!1;b.languageCode in f.prototype.localisations||(b.languageCode="");var z=f.prototype.localisations,r="",n=9>h.versionDetails.major?240:255;"large"===z.size&&(n=325,r="aui-datepicker-dialog-large");n={hideCallback:function(){d("body").off("focus blur click mousedown","*",q);u=!1;l&&l._datePickerPopup&&delete l._datePickerPopup},hideDelay:null,noBind:!0,persistent:!0,closeOthers:!1,width:n};b.position&&
(n.calculatePositions=function(a,c){a=d(a[0]);return b.position.call(this,a,c)});var k=h.InlineDialog(a,void 0,function(a,b,c){"undefined"===typeof e&&(m=a,t(z));if(l=d(b).closest(".aui-inline-dialog").get(0))l._datePickerPopup=k;c()},n);k.addClass("aui-datepicker-dialog");k.addClass(r);a.on("focus click",y);a.attr("placeholder",b.dateFormat);b.overrideBrowserDefault&&f.prototype.browserSupportsDateField&&(a[0].type="text",r=a[0].getAttribute("value"))&&(a[0].value=r)};c.reset=function(){"function"===
typeof c.destroyPolyfill&&c.destroyPolyfill();f.prototype.browserSupportsDateField&&!b.overrideBrowserDefault||C()};c.reset();return c}var A=0;f.prototype.browserSupportsDateField=h.DatePicker.prototype.browserSupportsDateField;f.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:d("html").attr("lang")||"en-AU",dateFormat:d.datepicker.W3C};f.prototype.localisations=h.DatePicker.prototype.localisations;d.fn.inlineTasksDatePicker1=function(d){return new f(this,d)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:dateutil', location = '/js/dateutil.js' */
define("confluence-inline-tasks/dateutil","jquery ajs moment confluence/position confluence-inline-tasks/util confluence-inline-tasks/date-picker1".split(" "),function(k,l,p,n,q){var f={PATTERN_INSERTING:"DD-MM-YYYY",PATTERN_LOZENGE:"DD MMM YYYY",PATTERN_INSIDE_TIME_ELE:"YYYY-MM-DD",convertDateIntoHtml:function(a,b,d,e){e||(e=f.PATTERN_INSERTING);d||(d="");b||(b="\x3ctime\x3e");var c=k("\x3cdiv\x3e");e=a.format(e);0<=b.indexOf("time")?(a=k(b,{datetime:a.format(f.PATTERN_INSIDE_TIME_ELE)}),q.addContentEditableIfApplicable(a)):
a=k(b);d&&a.attr("class",d);a.text(e);c.append(a);return c.html()},insertDateIntoCurrentCursor:function(a,b,d,e,c){var g=require("tinymce"),h=require("confluence-editor/utils/tinymce-node-utils");g=g.activeEditor;a=f.convertDateIntoHtml(a,b,d,e);a=k(a,g.getDoc())[0];h=h.replaceSelection(a);c&&g.execCommand("mceInsertContent",!1,c,{skip_undo:!0});c={context:k(g.selection.getRng(!0).startContainer).closest("li[data-inline-task-id]").length?"task":"page",trigger:"character"};l.trigger("analyticsEvent",
{name:"confluence-spaces.date.added",data:c});return h},parse:function(a,b){b||(b=f.PATTERN_INSIDE_TIME_ELE);a=p(k.trim(a),b,!0);return a.isValid()?a:null},format:function(a,b){b||(b=f.PATTERN_INSIDE_TIME_ELE);return a?a.format(b):null},guessPartialDate:function(a,b){if(null==a)return null;a=k.trim(a.replace(/[-\.\/]/g,"-"));a=a.split("-");for(var d=p().format(b).split("-"),e=0;3>e;e++)a[e]||(a[e]=d[e]),/^\d$/.test(a[e])&&(a[e]="0"+a[e]);return f.parse(a.join("-"),b)},datepicker:{POSITION_ABOVE:!0,
POSITION_BELOW:!1,POSITION_RIGHT:!0,POSITION_LEFT:!1,dropDownStillFitsVertically:function(a,b,d){return a===this.POSITION_ABOVE?b.above>=d:b.below>=d},dropDownStillFitsHorizontally:function(a,b,d){return a===this.POSITION_RIGHT?b.right>=d:b.left>=d},getPreferredHorizontalPosition:function(a,b){return a.right>=b?this.POSITION_RIGHT:a.left>=b?this.POSITION_LEFT:a.right>a.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(a,b){return a.below>=b?this.POSITION_BELOW:a.above>=
b?this.POSITION_ABOVE:a.below>a.above?this.POSITION_BELOW:this.POSITION_ABOVE},calculateDatepickerPosition:function(a){var b=this;return function(d,e){var c=require("confluence-editor/editor/atlassian-editor");e=require("confluence-editor/editor/atlassian-editor-content");c=c.Rte.getEditorFrame();void 0===n.spaceLeftRight&&(n.spaceLeftRight=function(a,b){b=b.position().left;return{left:b,right:k(a).width()-b}});var g=n.spaceAboveBelow(c,a);var h=n.spaceLeftRight(c,a);var f=e.offset(a);e=d.outerHeight(!0);
d=d.outerWidth(!0);var r=e+16;var l=d+0;c=b.POSITION_BELOW;var m=b.POSITION_RIGHT;c&&(b.dropDownStillFitsVertically(c,g,r)||(c=null));c||(c=b.getPreferredVerticalPosition(g,r));m&&(b.dropDownStillFitsHorizontally(m,h,r)||(m=null));m=b.getPreferredHorizontalPosition(h,l);g=c===b.POSITION_ABOVE?f.top-e-16:f.top+a.height()+16;h=m===b.POSITION_RIGHT?f.left-0:f.left+a.outerWidth()-d;g={top:g,left:h};m=m===b.POSITION_RIGHT?a.outerWidth()/2:d-a.outerWidth()/2;if(0>m||m>d)m=d/10;return{displayAbove:c,popupCss:g,
arrowCss:{left:m,top:c===b.POSITION_ABOVE?e:-8}}}},getHintTextOfDatePicker:function(a){return a?"Select a due date for this task.":"Select a date."},create:function(a){var b=a.$attachTo,d=a.$positionTo,e=a.startDate,c=a.onSelect;a=a.isSetDueDate;var g=k("\x3cinput\x3e").attr("type","date").addClass("aui-date-picker").css("display","none"),h=g.inlineTasksDatePicker1({overrideBrowserDefault:!0,dateFormat:"yy-mm-dd",languageCode:l.Meta.get("user-locale")&&
l.Meta.get("user-locale").split("_")[0],position:this.calculateDatepickerPosition(d),onSelect:function(a){c(f.parse(a));n()},hint:this.getHintTextOfDatePicker(a)}),n=function(){h&&h.destroyPolyfill&&h.destroyPolyfill();g&&g.remove();k(".aui-datepicker-dialog").remove();g=h=null};h.show();h.setDate(f.format(e));k(".aui-datepicker-dialog .aui-datepicker-hint").addClass(a?"set-duedate":"set-date");b.before(g);return{die:function(){n()},show:function(){h.show()},hide:function(){h.hide()},getContainer:function(){return g},
setDate:function(a){var b=f.guessPartialDate(a,f.PATTERN_INSERTING);l.debug("Set date: "+a);b&&h.setDate(f.format(b))},placeDatePicker:function(){var a=l.InlineDialog.current;(a=a&&a.popup)&&a.refresh()}}}}};return f});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/dateutil","Confluence.InlineTasks.DateUtil",function(k){var l=require("ajs"),p=require("underscore"),n=require("confluence/meta"),q=require("moment");l.toInit(function(){var f=function(a,b,c){return b&&"en_us"===b.toLowerCase()?"MM"+c+"DD"+c+"YYYY":p.uniq(a.replace(/[^MDY]/g,"").split("")).join(c).replace("D","DD").replace("M","MM").replace("Y","YYYY")},a=n.get("user-locale");a&&q.lang(a.split("_")[0].toLowerCase());
var b=n.get("user-date-pattern");b&&(k.PATTERN_LOZENGE=b.toUpperCase(),k.PATTERN_INSERTING=f(b.toUpperCase(),a,"-"),k.PATTERN_INSERTING_ALTERNATE=f(b.toUpperCase(),a,"/"))})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/de.js' */
(function(c){"function"===typeof define&&define.amd?define(["moment"],c):"object"===typeof exports?module.exports=c(require("../moment")):c(window.moment)})(function(c){function a(b,a,c,d){b={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[b+" Tage",b+" Tagen"],M:["ein Monat","einem Monat"],MM:[b+" Monate",b+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[b+" Jahre",b+" Jahren"]};return a?b[c][0]:b[c][1]}return c.lang("de",{months:"Januar Februar Mrz April Mai Juni Juli August September Oktober November Dezember".split(" "),
monthsShort:"Jan. Febr. Mrz. Apr. Mai Jun. Jul. Aug. Sept. Okt. Nov. Dez.".split(" "),weekdays:"Sonntag Montag Dienstag Mittwoch Donnerstag Freitag Samstag".split(" "),weekdaysShort:"So. Mo. Di. Mi. Do. Fr. Sa.".split(" "),weekdaysMin:"So Mo Di Mi Do Fr Sa".split(" "),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",
lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:a,mm:"%d Minuten",h:a,hh:"%d Stunden",d:a,dd:a,M:a,MM:a,y:a,yy:a},ordinal:"%d.",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/es.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){var b="ene. feb. mar. abr. may. jun. jul. ago. sep. oct. nov. dic.".split(" "),c="ene feb mar abr may jun jul ago sep oct nov dic".split(" ");return a.lang("es",{months:"enero febrero marzo abril mayo junio julio agosto septiembre octubre noviembre diciembre".split(" "),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:
b[a.month()]},weekdays:"domingo lunes martes mircoles jueves viernes sbado".split(" "),weekdaysShort:"dom. lun. mar. mi. jue. vie. sb.".split(" "),weekdaysMin:"Do Lu Ma Mi Ju Vi S".split(" "),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+
(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:"%d",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/fr.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("fr",{months:"janvier fvrier mars avril mai juin juillet aot septembre octobre novembre dcembre".split(" "),monthsShort:"janv. fvr. mars avr. mai juin juil. aot sept. oct. nov. dc.".split(" "),weekdays:"dimanche lundi mardi mercredi jeudi vendredi samedi".split(" "),weekdaysShort:"dim. lun. mar. mer. jeu. ven. sam.".split(" "),
weekdaysMin:"Di Lu Ma Me Je Ve Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},
ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/ja.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("ja",{months:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),monthsShort:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),weekdays:"      ".split(" "),weekdaysShort:"".split(""),weekdaysMin:"".split(""),longDateFormat:{LT:"Ahm",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDLT",
LLLL:"YYYYMDLT dddd"},meridiem:function(a,b,c){return 12>a?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/en-gb.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("en-gb",{months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},
ordinal:function(a){var b=a%10;return a+(1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat&&Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"Date"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(h){var b=window.Confluence||{};b.Editor=b.Editor||{};b.Editor.AutoComplete=b.Editor.AutoComplete||{};var c=b.InlineTasks.Util.KEY,l=b.InlineTasks.DateUtil,e=b.Editor.AutoComplete;e.SETTING_DEFAULT={leadingChar:"",isDataValid:function(a){return!1},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};e.Manager=function(a){this.ed=AJS.Rte.getEditor();this.settings=h.extend({},e.SETTING_DEFAULT,a);this.log=AJS.debug;this.control=null};e.Manager.prototype={start:function(a){AJS.trigger("synchrony.stop",
{id:"confluence.date-autocomplete-manager.plugin"});this.log("startAutoComplete - Started");var c=h.extend({},this.settings,a);this.control=b.Editor.Autocompleter.Control(this.ed,c);if(!this.control)return!1;this.attachEventsToControl();c.onAfterStart&&c.onAfterStart({date:a.date,isTriggerFromOrphan:a.isTriggerFromOrphan?!0:!1});return!0},attachEventsToControl:function(){var a=this,b=a.control,e=a.log,m=a.settings;if("function"===typeof this.settings.onBeforeDie){var g=this.control.die,k=!1;this.control.die=
function(){k||(k=!0,a.settings.onBeforeDie.apply(a.control,arguments),a.dateInserted()?(g.apply(a.control,[!0]),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})):g.apply(a.control,arguments))}}var n=_.bind(_.throttle(a.settings.onScroll,40),this);h.extend(b,{onBeforeKey:function(d,b){d.keyCode!==c.ESCAPE&&d.keyCode!==c.ENTER&&a.control&&a.control.getContainer().addClass("isDirty");return d.keyCode===c.DOWN||d.keyCode===c.UP||d.keyCode===c.ENTER?(tinymce.dom.Event.cancel(d),
!1):d.keyCode===c.ESCAPE||d.keyCode===c.TAB||d.keyCode===c.BACKSPACE&&!b?(e("autoCompleteControl.onBeforeKey - killing autoCompleteControl"),this.die(d.keyCode===c.BACKSPACE),!1):!0},onKeyPress:function(a,f){f=AJS.$.browser.msie?a.keyCode:a.which;if(a.keyCode===c.ENTER)return tinymce.dom.Event.cancel(a),!1;a=String.fromCharCode(f);this.settings.endChars.includes(a)&&(e("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character"),b.die());return!0},onAfterKey:function(d,f){var g=
h("#autocomplete-trigger",a.control.getContainer()),k=g.text();return 0<g.length&&k!==a.settings.leadingChar?(e("after","dying because of: trigger text is modified"),a.reset(),!1):d.keyCode===c.ENTER?(m.isDataValid(f)?b.update(f):(e("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+f),b.die(!1)),!1):a.dateInserted()&&10<f.length&&!l.parse(f,[l.PATTERN_INSERTING,l.PATTERN_INSERTING_ALTERNATE])||d.keyCode===c.SPACE?(a.reset(),!1):!0},onDeath:function(){a.reset()},onScroll:function(){a.isAlive()&&
n()}})},isAlive:function(){return this.control&&!this.control.dying},reset:function(){this.control&&(this.control.die(),this.control=null,AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete-manager.plugin"}))},dateInserted:function(a){return!0===a?this.control.getContainer().addClass("hasDateInserted"):!1===a?this.control.getContainer().removeClass("hasDateInserted"):this.control.getContainer().hasClass("hasDateInserted")},dirty:function(a){return!0===a?this.control.getContainer().addClass("isDirty"):
this.control.getContainer().hasClass("isDirty")},reattach:function(){var a=b.Editor.Autocompleter.Control.removeOrphanedControl();return a&&a.leadingChar===this.settings.leadingChar?(this.reset(),this.start({backWords:1,isTriggerFromOrphan:!0})):!1}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(e,k){var n=Confluence.InlineTasks.Util,m=n.NODE_TYPE,h=n.KEY,g=Confluence.InlineTasks.DateUtil,l=null,d=null,p=!1,q=k.dom.TreeWalker,f={initDateAutoCompleteObject:function(a){Confluence.Editor.Autocompleter||(Confluence.Editor.Autocompleter=k.confluence.Autocompleter);Confluence.Editor.Autocompleter.Settings["//"]={ch:"//",endChars:[],update:function(b,c){d.picker.die();(b=c==g.PATTERN_INSERTING.toLowerCase()?moment():g.guessPartialDate(c,g.PATTERN_INSERTING))&&g.insertDateIntoCurrentCursor(b,
"\x3ctime\x3e","",g.PATTERN_LOZENGE,"\x26nbsp;");d.dateInserted()&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"});d.reset();a.undoManager.add();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})}};d=new Confluence.Editor.AutoComplete.Manager({leadingChar:"//",isDataValid:function(b){return!d.dirty()||null!=g.guessPartialDate(b,g.PATTERN_INSERTING)},onBeforeDie:function(){d.picker&&d.picker.die();if(d.control){var b=e(d.control.getContainer());
d.dirty()||b.find("#autocomplete-search-text").remove()}},onAfterStart:function(b){b&&b.date?(f.fillPlaceholderDateAutoComplete(a,b.date,!0),d.dirty(!0),d.dateInserted(!0)):b&&!b.isTriggerFromOrphan&&(f.fillPlaceholderDateAutoComplete(a,g.PATTERN_INSERTING.toLowerCase(),!1),d.dateInserted(!1));b=d.control.text();b=g.guessPartialDate(b,g.PATTERN_INSERTING)||moment();f.bindDatePickerToAutoComplete(b)},onScroll:function(){d.picker&&d.picker.placeDatePicker()}})},activateDateAutocomplete:function(a,b,
c){a=Object.assign({},c,b);a.hasOwnProperty("insertedFromMenu")||(a.insertedFromMenu=!1);if(!d.isAlive()&&!d.start(a)&&!a.insertedFromMenu)return l.execCommand("mceInsertContent",!1,"//",{skip_undo:!0}),!1},bindDatePickerToAutoComplete:function(a){var b=d.control&&d.control.getContainer();if(b.length){b.addClass("date-autocomplete");b.find("#autocomplete-search-text span").addClass("inserting");var c=f.isInsideTaskAndFirstTimeNode(b);d.picker=g.datepicker.create({$attachTo:b,$positionTo:b,startDate:a,
onSelect:function(b){d.control.update(b.format(g.PATTERN_INSERTING))},isSetDueDate:c})}},fillPlaceholderDateAutoComplete:function(a,b,c){var f=d.control.getContainer().find("#autocomplete-search-text span");f.text(AJS.Rte.HIDDEN_CHAR+b);var e=a.dom.createRng();e.setStart(f[0].firstChild,1);e.setEnd(f[0].firstChild,b.length+1);c&&e.collapse(!1);a.selection.setRng(e)},autocompleteDoubleSlash:function(a,b){a=b.handlerManager;var c=b.ed;b=b.createHandler;b=b(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){c.execCommand("mceConfInsertDateAutocomplete",
!1,{},{skip_undo:!0})},!0,"#autocomplete");a.registerHandler(47,b)},registerTriggerDoubleSlash:function(a){a.addCommand("mceConfInsertDateAutocomplete",f.activateDateAutocomplete);a.addCommand("confMenuInsertDate",function(){AJS.trigger("analytics",{name:"editor.insert-data-from-menu"});l.execCommand("mceConfInsertDateAutocomplete",!1,{insertedFromMenu:!0},{skip_undo:!0})}.bind(this));AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(a){return a&&a.nodeType===
m.ELEMENT_NODE&&"time"===a.tagName.toLowerCase()},getTimeNodeAtCursor:function(a){a||(a=l);var b=a.selection.getNode();if(f.isTimeNode(b))return b;b=a.selection.getStart();if(f.isTimeNode(b))return b;b=a.selection.getEnd();if(f.isTimeNode(b))return b},makeTimeNodesUnEditable:function(a){a.each(function(){var b=e(this);""===e.trim(b.text())&&b.remove();k.isWebKit&&b.remove("br.Apple-interchange-newline");n.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(a){a.each(function(){var b=
e(this);this.previousSibling&&this.previousSibling.nodeType===m.TEXT_NODE&&""!==this.previousSibling.nodeValue||b.before(AJS.Rte.HIDDEN_CHAR);this.nextSibling&&this.nextSibling.nodeType===m.TEXT_NODE&&""!==this.previousSibling.nodeValue||b.after(AJS.Rte.HIDDEN_CHAR)})},putCursorAtEdge:function(a,b,c){(c=!!c)?b.nextSibling&&b.nextSibling.nodeType===m.TEXT_NODE||e(b).after(a.dom.doc.createTextNode("")):b.previousSibling&&b.previousSibling.nodeType===m.TEXT_NODE||e(b).before(a.dom.doc.createTextNode(""));
var d=a.selection.dom.createRng();d.selectNode(c?b.nextSibling:b.previousSibling);d.collapse(c);a.selection.setRng(d)},findFirstTimeNodeInClosestBlock:function(a,b,c){var d=new q(b,a.getBody()),e=b,g=0;do{if(1==g&&f.isTimeNode(b))return b;var h=c?b.previousSibling:b.nextSibling;b!==e&&h&&(a.dom.isBlock(b)||a.dom.isBlock(h))&&g++}while((b=c?d.next():d.prev())&&2>g)},findFirstTimeNodeNearby:function(a,b,c){var d=b,e=new q(b,a.getBody());do{if(f.isTimeNode(b))return b;if(a.dom.isBlock(b)||b!==d&&b.nodeType===
m.TEXT_NODE&&""!==b.nodeValue)break}while(b=c?e.next():e.prev())},convertInvalidTimeNodeToPlainText:function(a){a.each(function(){var b=e(this),a=b.attr("datetime");g.parse(a)||(b.before(b.text()),b.remove())})},isInsideTaskAndFirstTimeNode:function(a){a=e(a);var b=a.closest("ul.inline-task-list \x3e li[data-inline-task-id]");return b.length?b.find("time, span.date-autocomplete")[0]===a[0]:!1}},w=function(a){a=a.keyCode;if(a===h.BACKSPACE||a===h.DELETE){a=a===h.DELETE;var b=l.selection.getRng(!0),
c=b.startContainer,d=c;if(c.nodeType!=m.TEXT_NODE||(a?b.startOffset==c.nodeValue.length:0==b.startOffset))c.nodeType===m.ELEMENT_NODE&&(d=a?c.childNodes.length===b.startOffset?c:c.childNodes.item(b.startOffset):0===b.startOffset?c:c.childNodes.item(b.startOffset-1)),(a=f.findFirstTimeNodeNearby(l,d,a))&&l.dom.remove(a)}},x=function(a){var b=e(a.target);if(b.is("time")){AJS.trigger("synchrony.stop",{id:"confluence.date-autocomplete.plugin"});var c=b.closest("li[data-inline-task-id]").length?"task":
"page";AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:{mode:"editor",context:c}});var d=b.closest("body"),h=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");k.die();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})};d.one("keydown click",h);a=g.parse(b.attr("datetime"));var l=f.isInsideTaskAndFirstTimeNode(b),k=g.datepicker.create({$attachTo:b,$positionTo:b,startDate:a,onSelect:function(a){var e=a.format(g.PATTERN_INSIDE_TIME_ELE);a=a.format(g.PATTERN_LOZENGE);
e!==b.attr("datetime")&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:{context:c}});b.attr("datetime",e);b.text(a);d.unbind("keydown click",h);AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})},isSetDueDate:l});a=_.bind(_.throttle(function(){k&&AJS.Rte.isAnyPartShown(b)?k.placeDatePicker():h()},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",a)}},y=function(a){var b=a.keyCode;b===h.UP||b===h.DOWN||b===h.LEFT||b===h.RIGHT||b===h.HOME||b===
h.END||b===h.PAGEDOWN||b===h.PAGEUP||a.metaKey||a.ctrlKey||a.altKey||!d.control||!d.picker||(a=d.control.text(),d.picker.setDate(a))},z=function(){var a=e(l.dom.doc).find("time");f.makeTimeNodesUnEditable(a);f.wrapTimeNodesWithHiddenChar(a)},r=function(a,b,c){f.convertInvalidTimeNodeToPlainText(e(c.node).find("time"))},t=function(a,b,c){a=e(c.node).find("time");f.makeTimeNodesUnEditable(a)},u=function(a,b,c){if(f.getTimeNodeAtCursor(l))return c.content="",!1},A=function(a){var b=a.keyCode;if(b===
h.UP||b===h.DOWN){a=l.selection.getRng(!0);var c=a.startContainer,d=c;b=b===h.DOWN;c.nodeType===m.ELEMENT_NODE&&(d=b?c.childNodes.length===a.startOffset?c:c.childNodes.item(a.startOffset):0===a.startOffset?c:c.childNodes.item(a.startOffset-1));(a=f.findFirstTimeNodeInClosestBlock(l,d,b))&&f.wrapTimeNodesWithHiddenChar(e(a))}},B=function(a){a=a.element.nodeType===m.TEXT_NODE?a.element.parentNode:a.element;f.isTimeNode(a)&&(p||1<l.selection.getRng().startOffset?f.putCursorAtEdge(l,a,!0):f.putCursorAtEdge(l,
a,!1))},v=function(){d&&d.reattach()},C={init:function(a){f.initDateAutoCompleteObject(a);f.registerTriggerDoubleSlash(a);l=a;a.on("contextmenu",function(){d.reset()});a.on("SetContent",z);a.on("click",x);a.on("keyup",y);k.isWebKit&&(a.on("keydown",A),a.on("init",function(){e(document).bind("postPaste",t)}),a.on("remove",function(){e(document).unbind("postPaste",t)}));a.on("keyup",function(b){p=b.keyCode===h.RIGHT;var c=a.selection.getRng(!0),d=c.commonAncestorContainer,e=!!d&&d.data;e&&!AJS.$(d).closest("pre,.text-placeholder").length&&
(String.prototype.slice.apply(e,[-11]),48<=b.keyCode&&57>=b.keyCode||96<=b.keyCode&&105>=b.keyCode)&&(b=String.prototype.slice.apply(e,[-10]),/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/.test(e)&&g.parse(b,[g.PATTERN_INSERTING,g.PATTERN_INSERTING_ALTERNATE])&&(c.setStart(c.commonAncestorContainer,c.endOffset-b.length),a.undoManager.add(),a.undoManager.beforeChange(),a.selection.setRng(c),a.execCommand("mceConfInsertDateAutocomplete",!1,{date:b},{skip_undo:!0}),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})))});
k.isGecko&&(a.on("keydown",w),a.on("init",function(){e(document).bind("prePaste",u)}),a.on("remove",function(){e(document).unbind("prePaste",u)}));if(k.isWebKit||k.isGecko)a.on("NodeChange",B);a.on("Undo",v);a.on("Redo",v);a.on("init",function(){e(document).bind("postPaste",r)});a.on("remove",function(){e(document).unbind("postPaste",r);AJS.unbind("confluence.editor.registerHandlers",f.autocompleteDoubleSlash)});AJS.bind("editor.remote.change",function(){f.makeTimeNodesUnEditable(e(a.dom.doc).find("time"))})},
getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:k.majorVersion+"."+k.minorVersion}}};(function(){k.create("tinymce.plugins.DateAutocomplete",C);k.PluginManager.add("dateautocomplete",k.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(a){a.plugins+=",dateautocomplete"})})()})(AJS.$,tinymce);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reconcile-unknown-attachments:property-panel-unknown-image-placeholder', location = 'js/unknown-image-placeholder-property-panel.js' */
define("confluence-editor/unknown-attachment/property-panel",["wrm/context-path","ajs"],function(d,a){a&&a.Rte&&a.Rte.BootstrapManager?a.Rte.BootstrapManager.addOnInitCallback(function(){const c=a.Rte.getEditor();c?c.onClick.add(function(a,b){b=b.target;"IMG"===b.nodeName&&b.hasAttribute("src")&&0<=b.getAttribute("src").indexOf(d()+"/plugins/servlet/confluence/placeholder/unknown-attachment")&&a.execCommand("mceConfimage")}):a.log("Could not get Editor from adapter")}):a.log("Could not initialize property panel onclick handler on Confluence.Editor")});
require("confluence-editor/unknown-attachment/property-panel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-v4', location = 'js/editor-v4-init.js' */
require(["ajs","jquery","wrm/require"],function(b,d,c){b.Rte.BootstrapManager.addOnInitCallback(function(){c(["wrc!com.atlassian.confluence.plugins.drag-and-drop:editor-drop-handler"]).then(function(){require(["confluence-drag-and-drop/editor-drop-handler"],function(a){a.initialiseOverlay();a.initialise()})})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'lib/rivets.js' */
'use strict';(function(){var q=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){return function(){return a.apply(b,arguments)}},y=[].slice,A={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)A.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};var f={binders:{},components:{},formatters:{},adapters:{},config:{prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",
preloadData:!0,handler:function(a,b,c){return this.call(a,b,c.view.models)}}};if("jQuery"in window){var t="on"in jQuery.prototype?["on","off"]:["bind","unbind"];var B=t[0];var C=t[1];f.Util={bindEvent:function(a,b,c){return jQuery(a)[B](b,c)},unbindEvent:function(a,b,c){return jQuery(a)[C](b,c)},getInputValue:function(a){a=jQuery(a);return"checkbox"===a.attr("type")?a.is(":checked"):a.val()}}}else f.Util={bindEvent:function(){return"addEventListener"in window?function(a,b,c){return a.addEventListener(b,
c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}(),unbindEvent:function(){return"removeEventListener"in window?function(a,b,c){return a.removeEventListener(b,c,!1)}:function(a,b,c){return a.detachEvent("on"+b,c)}}(),getInputValue:function(a){var b;if("checkbox"===a.type)return a.checked;if("select-multiple"===a.type){var c=[];var d=0;for(b=a.length;d<b;d++){var e=a[d];e.selected&&c.push(e.value)}return c}return a.value}};f.KeypathParser=function(){function a(){}a.parse=function(b,a,d){var c,
g;var m=[];d={"interface":d,path:""};var f=c=0;for(g=b.length;c<g;f=c+=1)f=b.charAt(f),0<=q.call(a,f)?(m.push(d),d={"interface":f,path:""}):d.path+=f;m.push(d);return m};return a}();f.TextTemplateParser=function(){function a(){}a.types={text:0,binding:1};a.parse=function(b,a){var c;var e=[];var g=b.length;for(c=0;c<g;){var m=b.indexOf(a[0],c);if(0>m){e.push({type:this.types.text,value:b.slice(c)});break}else{0<m&&c<m&&e.push({type:this.types.text,value:b.slice(c,m)});c=m+a[0].length;m=b.indexOf(a[1],
c);if(0>m){a=b.slice(c-a[1].length);b=e[e.length-1];(null!=b?b.type:void 0)===this.types.text?b.value+=a:e.push({type:this.types.text,value:a});break}c=b.slice(c,m).trim();e.push({type:this.types.binding,value:c});c=m+a[1].length}}return e};return a}();f.Observer=function(){function a(b,a,d,e){this.view=b;this.model=a;this.keypath=d;this.callback=e;this.unobserve=h(this.unobserve,this);this.realize=h(this.realize,this);this.value=h(this.value,this);this.publish=h(this.publish,this);this.read=h(this.read,
this);this.set=h(this.set,this);this.adapter=h(this.adapter,this);this.update=h(this.update,this);this.initialize=h(this.initialize,this);this.parse=h(this.parse,this);this.parse();this.initialize()}a.prototype.parse=function(){var b,a;var d=this.view.adapters;var e=[];for(g in d)(b=d[g])&&e.push(g);if(a=this.keypath[0],0<=q.call(e,a)){b=this.keypath[0];var g=this.keypath.substr(1)}else b=this.view.config.rootInterface,g=this.keypath;this.tokens=f.KeypathParser.parse(g,e,b);return this.key=this.tokens.pop()};
a.prototype.initialize=function(){this.objectPath=[];this.target=this.realize();if(null!=this.target)return this.set(!0,this.key,this.target,this.callback)};a.prototype.update=function(){var b;if((b=this.realize())!==this.target){null!=this.target&&this.set(!1,this.key,this.target,this.callback);null!=b&&this.set(!0,this.key,b,this.callback);var a=this.value();this.target=b;if(this.value()!==a)return this.callback()}};a.prototype.adapter=function(b){return this.view.adapters[b["interface"]]};a.prototype.set=
function(b,a,d,e){b=b?"subscribe":"unsubscribe";return this.adapter(a)[b](d,a.path,e)};a.prototype.read=function(b,a){return this.adapter(b).read(a,b.path)};a.prototype.publish=function(b){if(null!=this.target)return this.adapter(this.key).publish(this.target,this.key.path,b)};a.prototype.value=function(){if(null!=this.target)return this.read(this.key,this.target)};a.prototype.realize=function(){var b,a,d;var e=this.model;var g=null;var m=this.tokens;var f=a=0;for(d=m.length;a<d;f=++a){var k=m[f];
null!=e?(null!=this.objectPath[f]?e!==(b=this.objectPath[f])&&(this.set(!1,k,b,this.update),this.set(!0,k,e,this.update),this.objectPath[f]=e):(this.set(!0,k,e,this.update),this.objectPath[f]=e),e=this.read(k,e)):(null==g&&(g=f),(b=this.objectPath[f])&&this.set(!1,k,b,this.update))}null!=g&&this.objectPath.splice(g);return e};a.prototype.unobserve=function(){var b,a,d;var e=this.tokens;var g=a=0;for(d=e.length;a<d;g=++a){var m=e[g];(b=this.objectPath[g])&&this.set(!1,m,b,this.update)}if(null!=this.target)return this.set(!1,
this.key,this.target,this.callback)};return a}();f.View=function(){function a(b,a,d){var c,g,m;this.els=b;this.models=a;this.options=null!=d?d:{};this.update=h(this.update,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.select=h(this.select,this);this.build=h(this.build,this);this.componentRegExp=h(this.componentRegExp,this);this.bindingRegExp=h(this.bindingRegExp,this);this.els.jquery||this.els instanceof Array||
(this.els=[this.els]);var l=["config","binders","formatters","adapters"];d=0;for(m=l.length;d<m;d++){b=l[d];this[b]={};if(this.options[b]){var k=this.options[b];for(c in k)a=k[c],this[b][c]=a}k=f[b];for(c in k)a=k[c],null==(g=this[b])[c]&&(g[c]=a)}this.build()}a.prototype.bindingRegExp=function(){return new RegExp("^"+this.config.prefix+"-")};a.prototype.componentRegExp=function(){return new RegExp("^"+this.config.prefix.toUpperCase()+"-")};a.prototype.build=function(){var b;this.bindings=[];var a=
[];var d=this.bindingRegExp();var e=this.componentRegExp();var g=function(b){return function(a,c,d,e){var g,m;var l={};var k=function(){var b;var a=e.split("|");var c=[];var d=0;for(b=a.length;d<b;d++)m=a[d],c.push(m.trim());return c}();var h=function(){var b;var a=k.shift().split("\x3c");var c=[];var d=0;for(b=a.length;d<b;d++)g=a[d],c.push(g.trim());return c}();var p=h.shift();l.formatters=k;if(h=h.shift())l.dependencies=h.split(/\s+/);return b.bindings.push(new f[a](b,c,d,p,l))}}(this);var m=function(b){return function(c){var l,
h,k,p;if(0>q.call(a,c)){if(3===c.nodeType){var n=f.TextTemplateParser;if((k=b.config.templateDelimiters)&&(l=n.parse(c.data,k)).length&&(1!==l.length||l[0].type!==n.types.text)){var r=0;for(p=l.length;r<p;r++)k=l[r],n=document.createTextNode(k.value),c.parentNode.insertBefore(n,c),1===k.type&&g("TextBinding",n,null,k.value);c.parentNode.removeChild(c)}}else if(e.test(c.tagName)){var u=c.tagName.replace(e,"").toLowerCase();b.bindings.push(new f.ComponentBinding(b,c,u))}else if(null!=c.attributes){p=
c.attributes;k=0;for(r=p.length;k<r;k++)if(l=p[k],d.test(l.name)){u=l.name.replace(d,"");if(!(h=b.binders[u])){var v=b.binders;for(n in v){var t=v[n];if("*"!==n&&-1!==n.indexOf("*")){var x=new RegExp("^"+n.replace("*",".+")+"$");x.test(u)&&(h=t)}}}h||(h=b.binders["*"]);if(h.block){x=c.childNodes;var w=0;for(h=x.length;w<h;w++)u=x[w],a.push(u);w=[l]}}r=w||c.attributes;n=0;for(k=r.length;n<k;n++)l=r[n],d.test(l.name)&&(u=l.name.replace(d,""),g("Binding",c,u,l.value))}k=c.childNodes;c=[];n=0;for(l=k.length;n<
l;n++)u=k[n],c.push(u);r=[];k=0;for(n=c.length;k<n;k++)l=c[k],r.push(m(l));return r}}}(this);var l=this.els;var k=0;for(b=l.length;k<b;k++){var h=l[k];m(h)}};a.prototype.select=function(b){var a;var d=this.bindings;var e=[];var g=0;for(a=d.length;g<a;g++){var m=d[g];b(m)&&e.push(m)}return e};a.prototype.bind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.bind())}return d};a.prototype.unbind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=
a.length;e<b;e++){var g=a[e];d.push(g.unbind())}return d};a.prototype.sync=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.sync())}return d};a.prototype.publish=function(){var b;var a=this.select(function(b){return b.binder.publishes});var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.publish())}return d};a.prototype.update=function(b){var a;null==b&&(b={});for(m in b){var d=b[m];this.models[m]=d}var e=this.bindings;var g=[];d=0;for(a=e.length;d<
a;d++){var m=e[d];g.push(m.update(b))}return g};return a}();f.Binding=function(){function a(b,a,d,e,g){this.view=b;this.el=a;this.type=d;this.keypath=e;this.options=null!=g?g:{};this.update=h(this.update,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.set=h(this.set,this);this.eventHandler=h(this.eventHandler,this);this.formattedValue=h(this.formattedValue,this);this.setBinder=h(this.setBinder,this);this.formatters=
this.options.formatters||[];this.dependencies=[];this.model=void 0;this.setBinder()}a.prototype.setBinder=function(){var b;if(!(this.binder=this.view.binders[this.type])){var a=this.view.binders;for(b in a){var d=a[b];if("*"!==b&&-1!==b.indexOf("*")){var e=new RegExp("^"+b.replace("*",".+")+"$");e.test(this.type)&&(this.binder=d,this.args=(new RegExp("^"+b.replace("*","(.+)")+"$")).exec(this.type),this.args.shift())}}}this.binder||(this.binder=this.view.binders["*"]);if(this.binder instanceof Function)return this.binder=
{routine:this.binder}};a.prototype.formattedValue=function(b){var a;var d=this.formatters;var e=0;for(a=d.length;e<a;e++){var g=d[e];var m=g.split(/\s+/);g=m.shift();g=this.view.formatters[g];(null!=g?g.read:void 0)instanceof Function?b=g.read.apply(g,[b].concat(y.call(m))):g instanceof Function&&(b=g.apply(null,[b].concat(y.call(m))))}return b};a.prototype.eventHandler=function(b){var a;var d=(a=this).view.config.handler;return function(c){return d.call(b,this,c,a)}};a.prototype.set=function(b){var a;
b=b instanceof Function&&!this.binder["function"]?this.formattedValue(b.call(this.model)):this.formattedValue(b);return null!=(a=this.binder.routine)?a.call(this,this.el,b):void 0};a.prototype.sync=function(){var a,c;if(this.model!==this.observer.target){var d=this.dependencies;var e=0;for(a=d.length;e<a;e++){var g=d[e];g.unobserve()}this.dependencies=[];if(null!=(this.model=this.observer.target)&&null!=(c=this.options.dependencies)&&c.length)for(d=this.options.dependencies,e=0,a=d.length;e<a;e++)g=
d[e],g=new f.Observer(this.view,this.model,g,this.sync),this.dependencies.push(g)}return this.set(this.observer.value())};a.prototype.publish=function(){var a,c,d;var e=f.Util.getInputValue(this.el);var g=this.formatters.slice(0).reverse();var m=0;for(a=g.length;m<a;m++){var l=g[m];l=l.split(/\s+/);var k=l.shift();null!=(c=this.view.formatters[k])&&c.publish&&(e=(d=this.view.formatters[k]).publish.apply(d,[e].concat(y.call(l))))}return this.observer.publish(e)};a.prototype.bind=function(){var a,c;
null!=(a=this.binder.bind)&&a.call(this,this.el);this.observer=new f.Observer(this.view,this.view.models,this.keypath,this.sync);this.model=this.observer.target;if(null!=this.model&&null!=(c=this.options.dependencies)&&c.length){var d=this.options.dependencies;a=0;for(c=d.length;a<c;a++){var e=d[a];e=new f.Observer(this.view,this.model,e,this.sync);this.dependencies.push(e)}}if(this.view.config.preloadData)return this.sync()};a.prototype.unbind=function(){var a,c;null!=(a=this.binder.unbind)&&a.call(this,
this.el);this.observer.unobserve();var d=this.dependencies;var e=0;for(c=d.length;e<c;e++)a=d[e],a.unobserve();return this.dependencies=[]};a.prototype.update=function(a){var b;null==a&&(a={});this.model=this.observer.target;this.unbind();null!=(b=this.binder.update)&&b.call(this,a);return this.bind()};return a}();f.ComponentBinding=function(a){function b(a,b,e){var c;this.view=a;this.el=b;this.type=e;this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.update=h(this.update,this);this.locals=
h(this.locals,this);this.component=f.components[this.type];this.attributes={};this.inflections={};var d=this.el.attributes||[];b=0;for(e=d.length;b<e;b++)a=d[b],(c=a.name,0<=q.call(this.component.attributes,c))?this.attributes[a.name]=a.value:this.inflections[a.name]=a.value}z(b,a);b.prototype.sync=function(){};b.prototype.locals=function(a){var b,c;null==a&&(a=this.view.models);var g={};var f=this.inflections;for(b in f){var l=f[b];var k=l.split(".");var h=0;for(c=k.length;h<c;h++)l=k[h],g[b]=(g[b]||
a)[l]}for(b in a)f=a[b],null==g[b]&&(g[b]=f);return g};b.prototype.update=function(a){var b;return null!=(b=this.componentView)?b.update(this.locals(a)):void 0};b.prototype.bind=function(){var a;if(null!=this.componentView)return null!=(a=this.componentView)?a.bind():void 0;a=this.component.build.call(this.attributes);(this.componentView=new f.View(a,this.locals(),this.view.options)).bind();return this.el.parentNode.replaceChild(a,this.el)};b.prototype.unbind=function(){var a;return null!=(a=this.componentView)?
a.unbind():void 0};return b}(f.Binding);f.TextBinding=function(a){function b(a,b,e,g,f){this.view=a;this.el=b;this.type=e;this.keypath=g;this.options=null!=f?f:{};this.sync=h(this.sync,this);this.formatters=this.options.formatters||[];this.dependencies=[]}z(b,a);b.prototype.binder={routine:function(a,b){return a.data=null!=b?b:""}};b.prototype.sync=function(){return b.__super__.sync.apply(this,arguments)};return b}(f.Binding);f.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(a){if(!a.hasOwnProperty(this.id)){var b=
this.counter++;this.weakmap[b]={callbacks:{}};Object.defineProperty(a,this.id,{value:b})}return this.weakmap[a[this.id]]},stubFunction:function(a,b){var c=a[b];var d=this.weakReference(a);var e=this.weakmap;return a[b]=function(){var b,f,l,k;var h=c.apply(a,arguments);var v=d.pointers;for(b in v){var p=v[b];var q=null!=(l=null!=(k=e[b])?k.callbacks[p]:void 0)?l:[];var t=0;for(f=q.length;t<f;t++)p=q[t],p()}return h}},observeMutations:function(a,b,c){var d,e;if(Array.isArray(a)){var g=this.weakReference(a);
if(null==g.pointers){g.pointers={};var f="push pop shift unshift sort reverse splice".split(" ");var l=0;for(e=f.length;l<e;l++){var k=f[l];this.stubFunction(a,k)}}null==(d=g.pointers)[b]&&(d[b]=[]);if(0>q.call(g.pointers[b],c))return g.pointers[b].push(c)}},unobserveMutations:function(a,b,c){var d,e;if(Array.isArray(a&&null!=a[this.id])&&(d=null!=(e=this.weakReference(a).pointers)?e[b]:void 0)&&(a=d.indexOf(c),0<=a))return d.splice(a,1)},subscribe:function(a,b,c){var d=this.weakReference(a).callbacks;
if(null==d[b]){d[b]=[];var e=a[b];Object.defineProperty(a,b,{enumerable:!0,get:function(){return e},set:function(g){return function(f){var m;if(f!==e){e=f;var k=d[b].slice();var h=0;for(m=k.length;h<m;h++)c=k[h],0<=q.call(d[b],c)&&c();return g.observeMutations(f,a[g.id],b)}}}(this)})}0>q.call(d[b],c)&&d[b].push(c);return this.observeMutations(a[b],a[this.id],b)},unsubscribe:function(a,b,c){var d=this.weakmap[a[this.id]].callbacks[b];c=d.indexOf(c);0<=c&&d.splice(c,1);return this.unobserveMutations(a[b],
a[this.id],b)},read:function(a,b){return a[b]},publish:function(a,b,c){return a[b]=c}};f.binders.text=function(a,b){return null!=a.textContent?a.textContent=null!=b?b:"":a.innerText=null!=b?b:""};f.binders.html=function(a,b){return a.innerHTML=null!=b?b:""};f.binders.show=function(a,b){return a.style.display=b?"":"none"};f.binders.hide=function(a,b){return a.style.display=b?"none":""};f.binders.enabled=function(a,b){return a.disabled=!b};f.binders.disabled=function(a,b){return a.disabled=!!b};f.binders.checked=
{publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)===(null!=b?b.toString():void 0):a.checked=!!b}};f.binders.unchecked={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;
return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)!==(null!=b?b.toString():void 0):a.checked=!b}};f.binders.value={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c,d,e;if(null!=window.jQuery){if(a=jQuery(a),(null!=b?b.toString():void 0)!==(null!=(c=a.val())?c.toString():void 0))return a.val(null!=b?b:"")}else if("select-multiple"===a.type){if(null!=
b){var g=[];var f=0;for(d=a.length;f<d;f++)c=a[f],g.push(c.selected=(e=c.value,0<=q.call(b,e)));return g}}else if((null!=b?b.toString():void 0)!==(null!=(f=a.value)?f.toString():void 0))return a.value=null!=b?b:""}};f.binders["if"]={block:!0,bind:function(a){if(null==this.marker){var b=[this.view.config.prefix,this.type].join("-").replace("--","-");var c=a.getAttribute(b);this.marker=document.createComment(" rivets: "+this.type+" "+c+" ");a.removeAttribute(b);a.parentNode.insertBefore(this.marker,
a);return a.parentNode.removeChild(a)}},unbind:function(){var a;return null!=(a=this.nested)?a.unbind():void 0},routine:function(a,b){if(!!b===(null==this.nested)){if(b){b={};var c=this.view.models;for(e in c){var d=c[e];b[e]=d}var e={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:this.view.options.config};(this.nested=new f.View(a,b,e)).bind();return this.marker.parentNode.insertBefore(a,this.marker.nextSibling)}a.parentNode.removeChild(a);
this.nested.unbind();return delete this.nested}},update:function(a){var b;return null!=(b=this.nested)?b.update(a):void 0}};f.binders.unless={block:!0,bind:function(a){return f.binders["if"].bind.call(this,a)},unbind:function(){return f.binders["if"].unbind.call(this)},routine:function(a,b){return f.binders["if"].routine.call(this,a,!b)},update:function(a){return f.binders["if"].update.call(this,a)}};f.binders["on-*"]={"function":!0,unbind:function(a){if(this.handler)return f.Util.unbindEvent(a,this.args[0],
this.handler)},routine:function(a,b){this.handler&&f.Util.unbindEvent(a,this.args[0],this.handler);return f.Util.bindEvent(a,this.args[0],this.handler=this.eventHandler(b))}};f.binders["each-*"]={block:!0,bind:function(a){var b;if(null==this.marker){var c=[this.view.config.prefix,this.type].join("-").replace("--","-");this.marker=document.createComment(" rivets: "+this.type+" ");this.iterated=[];a.removeAttribute(c);a.parentNode.insertBefore(this.marker,a);a.parentNode.removeChild(a)}else{var d=this.iterated;
c=0;for(b=d.length;c<b;c++)a=d[c],a.bind()}},unbind:function(a){var b;if(null!=this.iterated){var c=this.iterated;var d=[];var e=0;for(b=c.length;e<b;e++)a=c[e],d.push(a.unbind());return d}},routine:function(a,b){var c;var d=this.args[0];b=b||[];if(this.iterated.length>b.length){var e=Array(this.iterated.length-b.length);var g=0;for(e=e.length;g<e;g++){var h=this.iterated.pop();h.unbind();this.marker.parentNode.removeChild(h.els[0])}}var l=g=0;for(e=b.length;g<e;l=++g){var k=b[l];h={index:l};h[d]=
k;if(null==this.iterated[l]){l=this.view.models;for(p in l)k=l[p],null==h[p]&&(h[p]=k);k=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker;l={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:{}};var r=this.view.options.config;for(c in r){var q=r[c];l.config[c]=q}l.config.preloadData=!0;q=a.cloneNode(!0);h=new f.View(q,h,l);h.bind();this.iterated.push(h);this.marker.parentNode.insertBefore(q,k.nextSibling)}else this.iterated[l].models[d]!==
k&&this.iterated[l].update(h)}if("OPTION"===a.nodeName){var p=this.view.bindings;d=[];b=0;for(c=p.length;b<c;b++)a=p[b],a.el===this.marker.parentNode&&"value"===a.type?d.push(a.sync()):d.push(void 0);return d}},update:function(a){var b={};for(f in a){var c=a[f];f!==this.args[0]&&(b[f]=c)}var d=this.iterated;var e=[];var f=0;for(c=d.length;f<c;f++)a=d[f],e.push(a.update(b));return e}};f.binders["class-*"]=function(a,b){var c=" "+a.className+" ";if(!b===(-1!==c.indexOf(" "+this.args[0]+" ")))return a.className=
b?""+a.className+" "+this.args[0]:c.replace(" "+this.args[0]+" "," ").trim()};f.binders["*"]=function(a,b){return null!=b?a.setAttribute(this.type,b):a.removeAttribute(this.type)};f.factory=function(a){a._=f;a.binders=f.binders;a.components=f.components;a.formatters=f.formatters;a.adapters=f.adapters;a.config=f.config;a.configure=function(a){var b;null==a&&(a={});for(b in a){var d=a[b];f.config[b]=d}};return a.bind=function(a,c,d){null==c&&(c={});null==d&&(d={});a=new f.View(a,c,d);a.bind();return a}};
t={};f.factory(t);define("rivets",t)}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'data/DataManager.js' */
'use strict';define("confluence-hipchat-emoticons/data/DataManager",["ajs","jquery"],function(h,d){var e,b=[],c={},f=function(a){a&&(c={},a.forEach(function(a){c[a.shortcut]=a}))},g=function(){return d.ajax({url:h.contextPath()+"/rest/emoticons/1.0/",type:"get",dataType:"json",cache:!1}).then(function(a){localStorage.setItem("hipchat.emoticons.data",JSON.stringify(a));b=a.hipchat;f(b);return d.Deferred().resolve(a)})};return{initializeData:function(){var a=JSON.parse(localStorage.getItem("hipchat.emoticons.data"));
a&&(b=a.hipchat,f(b));e=g()},loadRemoteData:g,getAuthoritativeEmoticons:function(){return e},getHipChatEmoticon:function(a){return c[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'insertion/EmoticonInserter.js' */
'use strict';define("confluence-hipchat-emoticons/insertion/EmoticonInserter",["ajs"],function(e){return{insertEmoticon:function(a,f){var b=e.Rte.getEditor();if(f){var c=$(b.getContainer()),d=null;if(c.parents("#comments-section").length)d="comment";else if(c.parents(".ic-comment-container").length)d="inlinecomment";else if(c.parents("#editpageform").length||c.parents("#createpageform").length)d=c.parents(".blogpost").length?"blog":"page";d&&e.trigger("analyticsEvent",{name:"confluence.hipchat.emoticons.insert."+
f,data:{shortcut:a.shortcut,source:d}})}a=b.dom.createHTML("img",a.name?{src:a.url,alt:a.name+" "+a.shortcut,title:a.name+" "+a.shortcut,border:0,"class":"emoticon emoticon-"+a.name,"data-emoticon-name":a.name}:{src:a.url,alt:"("+a.shortcut+")",title:"("+a.shortcut+")",border:0,"class":"emoticon emoticon-"+a.shortcut,"data-hipchat-emoticon":a.shortcut});b.execCommand("mceInsertContent",!1,a,{skip_undo:!0});b.undoManager.beforeChange();b.undoManager.add()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/CompletionManager.js' */
'use strict';define("confluence-hipchat-emoticons/completion/CompletionManager","ajs jquery underscore confluence-hipchat-emoticons/completion/Utilities confluence-hipchat-emoticons/data/DataManager confluence-hipchat-emoticons/insertion/EmoticonInserter".split(" "),function(f,h,q,g,k,l){function m(c,a,b){if(!a)throw Error("text node is null");3!=a.nodeType&&(a=a.childNodes[b-1],b=a.length);for(;a&&3==a.nodeType;a=a.previousSibling){-1==b&&(b=a.nodeValue.length);if(b>c)return{container:a,offset:b-
c};if(b==c){b=0;for(c=a.parentNode;a.previousSibling;)a=a.previousSibling,b++;return{container:c,offset:b}}c-=b;b=-1}return null}var n=/\(([A-Za-z0-9]+)$/,p=function(c){if(41===g.getCharCode(c)){var a=f.Rte.getEditor(),b=g.getTextFromPreviousSiblingTextNodes(a.selection.getRng(!0));if(b=n.exec(b))if(b=b[1],b=k.getHipChatEmoticon(b)){a.execCommand("mceInsertContent",!1,")");a.undoManager.beforeChange();a.undoManager.add();var d=a.selection.getRng(!0);g.getTextFromPreviousSiblingTextNodes(d);var e=
m(b.shortcut.length+1+1,d.commonAncestorContainer,d.startOffset);d.setStart(e.container,e.offset);e=h(d.commonAncestorContainer);a.selection.setRng(d);e.closest(".wysiwyg-macro-body").length&&d.toString()==e.text()?(e[0].innerHTML="\x3cbr\x3e",a.selection.select(e[0].childNodes[0]),a.selection.collapse(!0)):a.execCommand("delete",!1,{},{skip_undo:!0});l.insertEmoticon(b,"autoformat");tinymce.dom.Event.cancel(c);c=!1}else c=!0;else c=!0;return c}};return{start:function(){f.Rte.BootstrapManager.addOnInitCallback(function(){f.Rte.getEditor().on("keypress",
p,!0)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/Utilities.js' */
'use strict';define("confluence-hipchat-emoticons/completion/Utilities",["jquery"],function(d){return{getTextFromPreviousSiblingTextNodes:function(b){if(!b||!b.collapsed)throw Error("range is null or not collapsed");var a=b.startContainer;var c=b.startOffset;if(1==a.nodeType&&0<c)if(a=a.childNodes[b.startOffset-1],3==a.nodeType)c=a.nodeValue.length;else return"";else if(3!=a.nodeType)return"";b=a.nodeValue.substring(0,c);for(a=a.previousSibling;a&&3==a.nodeType;a=a.previousSibling)b=a.nodeValue+b;
return b},getCharCode:function(b){return d.browser.msie?b.keyCode:b.which}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/DialogEmoticon.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/DialogEmoticon",["underscore"],function(b){var c=function(a){this.name=a.name;this.shortcut=a.shortcut;this.fullShortcut=a.fullShortcut;this.url=a.url;this.onClick=a.onClick&&b.bind(a.onClick,this,this);this.visible=!0;this._initializeCaption(a)};b.extend(c.prototype,{onKeypress:function(a){13==a.keyCode&&this.click()},_initializeCaption:function(a){a.selectedText?(this.selectedCaptionPortion=a.selectedText,a=this.fullShortcut.indexOf(this.selectedCaptionPortion),
this.leftCaptionPortion=this.fullShortcut.substring(0,a),this.rightCaptionPortion=this.fullShortcut.substring(a+this.selectedCaptionPortion.length)):(this.leftCaptionPortion=this.fullShortcut,this.rightCaptionPortion=this.selectedCaptionPortion="")}});return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialog.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialog","ajs jquery rivets underscore confluence-hipchat-emoticons/dialog/DialogEmoticon confluence-hipchat-emoticons/dialog/EmoticonDialogModel confluence-hipchat-emoticons/dialog/Templates".split(" "),function(c,d,e,f,a,g,h){a=function(){var a=new g({dialog:this}),b=d(h.emoticonDialog({auiVersion:parseInt(c.version)}))[0];document.body.appendChild(b);this._dialog=c.dialog2(b);e.bind(b,a);d(b.querySelector(".loading-spinner")).spin("large");
this._dialog.on("show",function(){a.update(a.filterText="")})};f.extend(a.prototype,{show:function(){this._dialog.show()},close:function(){this._dialog.hide()}});return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialogModel.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialogModel",["ajs","underscore","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/insertion/EmoticonInserter","confluence-hipchat-emoticons/dialog/DialogEmoticon"],function(d,h,e,f,g){var c=function(b){var a=this;this.close=function(){b.dialog.close()};this.onFilterSubmit=function(a){return a.preventDefault()};this.onFilterUpdate=function(){a.update(this.value)};var c=function(b){f.insertEmoticon(b);a.close()},
k=function(b){f.insertEmoticon(b,"gallery");a.close()};this.isAdmin=d.Meta.getBoolean("is-admin");this.isHipChatIntegrated=!1;this.loadEmoticons=function(){var b=a.isError?e.loadRemoteData():e.getAuthoritativeEmoticons();a.isLoading=!0;a.isError=!1;a.showEmoticons=!1;a.showHipChatEmoticons=!1;b.then(function(b){a.isLoading=!1;a.hipchatEmoticons=b.hipchat.map(function(a){return new g({shortcut:a.shortcut,fullShortcut:"("+a.shortcut+")",url:a.url,onClick:k})});a.confluenceEmoticons=b.confluence.map(function(a){return new g({name:a.name,
shortcut:a.shortcut,fullShortcut:a.shortcut,url:a.url,onClick:c})});a.showEmoticons=!0;a.showHipChatEmoticons=!!d.Meta.get("remote-user");a.allEmoticons=h.union(a.confluenceEmoticons,a.hipchatEmoticons);a.isHipChatIntegrated=b.hipchatIntegrated;setTimeout(function(){document.querySelector("#hipchat-emoticons-filter").focus();document.querySelector("#hipchat-emoticons-filter").select()},100)}).fail(function(){a.isError=!0;a.isLoading=!1})}.bind(this);this.loadEmoticons()};c.prototype.update=function(b){this._previousFilterText!==
b&&(this._previousFilterText=b,(this.allEmoticons||[]).forEach(function(a){a.visible=0<=a.fullShortcut.indexOf(b)}))};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.HipChatEmoticons.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.HipChatEmoticons == 'undefined') { Confluence.Templates.HipChatEmoticons = {}; }
if (typeof Confluence.Templates.HipChatEmoticons.Dialog == 'undefined') { Confluence.Templates.HipChatEmoticons.Dialog = {}; }


Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="insert-hipchat-emoticon-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Insert emoticon') + '</h2><div class="aui-dialog2-header-secondary"><form class="aui" action="#"><input id="hipchat-emoticons-filter" class="text medium-field" type="search" rv-show="showEmoticons" rv-value="filterText" rv-on-keyup="onFilterUpdate" rv-on-submit="onFilterSubmit" placeholder="' + soy.$$escapeHtml('Search') + '"></form></div>' + ((opt_data.auiVersion < 9) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Cancel') + '</span></a>' : '<button class="aui-close-button" type="button" aria-label="' + soy.$$escapeHtml('Cancel') + '"></button>') + '</header><div class="aui-dialog2-content"><div class="emoticon-gallery"><div rv-show="isLoading" class="loading-spinner"></div><div rv-show="isError" class="error"><p><span class="aui-icon aui-icon-large aui-iconfont-error"></span></p><p>Oh dear, it seems we had some trouble loading your emoticons. Please click the button below to try loading them again.</p><p><button class="aui-button aui-button-primary" id="hipchat-emoticons-error-rety" rv-on-click="loadEmoticons">Retry</button></p></div><div rv-show="showEmoticons" class="emoticons-panel confluence-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Confluence') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons(null) + '</div><div rv-show="showHipChatEmoticons" class="emoticons-panel hipchat-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Hipchat') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons(null) + '<div rv-hide="isHipChatIntegrated" class="aui-message info"><span rv-show="isAdmin">' + soy.$$filterNoAutoescape(AJS.format('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. {0}Click here{1} to integrate.','<a target="_blank" href="' + "" + '/plugins/servlet/hipchat/configure">','</a>')) + '</span><span rv-hide="isAdmin">' + soy.$$filterNoAutoescape('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. Please contact your administrator for integration.') + '</span></div></div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-link close-button" rv-on-click="close">' + soy.$$escapeHtml('Cancel') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog';
}


Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons = function(opt_data, opt_ignored) {
  return '<div class="confluence-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'confluenceEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons = function(opt_data, opt_ignored) {
  return '<div class="hipchat-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'hipchatEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater = function(opt_data, opt_ignored) {
  return '<div rv-show="emoticon.visible" rv-each-emoticon="' + soy.$$escapeHtml(opt_data.modelDataAttribute) + '" class="gallery-item" rv-data-shortcut="emoticon.shortcut" rv-data-full-shortcut="emoticon.fullShortcut" rv-on-click="emoticon.onClick" rv-on-keydown="emoticon.onKeypress" tabindex="0"><img rv-src="emoticon.url"><br/><span class="caption"><span rv-text="emoticon.leftCaptionPortion"></span><strong rv-text="emoticon.selectedCaptionPortion"></strong><span rv-text="emoticon.rightCaptionPortion"></span></span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/Templates.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/Templates",function(){return window.Confluence.Templates.HipChatEmoticons.Dialog});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'menu/MenuItemOverrider.js' */
'use strict';define("confluence-hipchat-emoticons/menu/MenuItemOverrider",["ajs","jquery","confluence-hipchat-emoticons/dialog/EmoticonDialog"],function(d,a,c){return{start:function(){var b=null;a(".content-emoticon").off("click").on("click",function(a){b||(b=new c);b.show();a.preventDefault()})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'hipchat-emoticons.js' */
'use strict';define("confluence-hipchat-emoticons",["jquery","confluence-hipchat-emoticons/completion/CompletionManager","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/menu/MenuItemOverrider"],function(c,d,a,e){c(document).on("postPaste",function(b,d,a){b=c("img",a.node);b.data("hipchatEmoticon")&&b.removeClass("confluence-embedded-image confluence-external-resource")});return{start:function(){a.initializeData();d.start();e.start()}}});AJS.bind("init.rte",function(){require("confluence-hipchat-emoticons").start()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(packet&&packet.origin&&packet.origin!=="null"&&typeof packet.data==="string"){if(packet.origin===location.origin){process(gadgets.json.parse(packet.data))}else{AJS.$.get(AJS.contextPath()+"/rest/whitelist/1/check",{url:packet.origin}).done(function(result){if(result&&result.inbound&&result.inbound===true){process(gadgets.json.parse(packet.data))}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}).fail(function(jqXHR,textStatus,errorThrown){AJS.log("RPC: REST "+textStatus,errorThrown)})}}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"undefined origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(g){AJS.MacroBrowser.setMacroJsOverride("gadget",{postPreview:function(b,c){b=b.contentWindow.AJS;for(var a={},d=g("#macro-param-div-preferences input").val().split("\x26"),e=0,f=d.length;e<f;e++){var h=d[e].split("\x3d");try{a[decodeURI(h[0])]=decodeURI(h[1])}catch(q){}}c.needsConfig&&b&&!a.isConfigured&&(c=g("#macro-browser-dialog .dialog-button-panel .ok"),g("#save-warning-span").addClass("gadget-not-configured-warning").text("Please complete the configuration in the preview area first").removeClass("hidden"),
c.prop("disabled",!0))},beforeParamsSet:function(b,c){var a=b.preferences;if(!c&&a){c=a.split("\x26");a=0;for(var d=c.length;a<d;a++){var e=c[a].split("\x3d");b[decodeURI(e[0])]=decodeURI(e[1])}}return b},updateMacroParametersForPreview:function(b){b.forceWrite=!0;return b},manipulateMarkup:function(b){if(AJS.MacroBrowser.gadgetPrefsChanged){b=top.document.getElementById("macro-insert-container");b=g("#macro-param-div-preferences input",b);var c="",a;for(a in AJS.MacroBrowser.gadgetPrefs)0!=c.length&&
(c+="\x26"),c=c+encodeURI(a)+"\x3d"+encodeURI(AJS.MacroBrowser.gadgetPrefs[a]);b.val(c)}},getMacroDetailsFromSelectedMacro:function(b,c){for(var a=c.params.url,d=0,e=b.length;d<e;d++){var f=b[d];if(f.macroName===c.name&&f.gadgetUrl===a)return f}},beforeParamsRetrieved:function(b,c,a){var d="";if(c.nonHiddenUserPrefs){var e=!0,f={},h=b.preferences;if(h){h=h.split("\x26");for(var g=0,n=h.length;g<n;g++){var m=h[g].split("\x3d"),p=decodeURI(m[0]);m=decodeURI(m[1]);f[p]=m}}for(var k in a)f[k]=a[k];for(var l in f){a:{a=
c.formDetails.parameters;for(k=0;k<a.length;k++)if(a[k].name==l){a=f[l]==a[k].defaultValue;break a}AJS.log("Unable to find matching param for "+l);a=!1}a||(e||(d+="\x26"),e=!1,d=d+encodeURI(l)+"\x3d"+encodeURI(f[l]))}b.preferences=d}return b}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.Editor.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_ignored) {
  return '<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.fileIcon) + '"></span>' + soy.$$escapeHtml(opt_data.fileName) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader.soyTemplateName = 'Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel","jquery underscore ajs confluence/legacy confluence/jsUri tinymce vfm/view-file-macro-utils".split(" "),function(f,m,e,q,w,l,h){function x(a,c){var b=m.find(Object.keys(n),function(a){return n[a]===c});if(b)for(var d=0,e=a.length;d<e;d++){var g=a[d],f=g.className.replace(" active","");-1!==f.indexOf("macro-property-panel-"+b)&&(f+=" active");g.className=f}}function y(a){var c=m.reject(a,function(a){return-1<a.className.indexOf("macro-placeholder-property-panel-edit-button")||
-1<a.className.indexOf("macro-placeholder-property-panel-remove-button")});a.splice(0,a.length);for(var b=0;b<c.length;b++)a.push(c[b])}function r(a,c){a=new w(a);""!==a.getQueryParamValue("height")&&a.replaceQueryParam("height",c);return a.toString()}function t(a){a=a.attr("data-macro-parameters");for(var c=[],b="",d=0;d<a.length;d++){var e=a[d];"\\"===e?(b+=e,d+1!==a.length&&(b+=a[++d])):"|"===e?(c.push(b),b=""):b+=e}c.push(b);return c}function u(a,c){a=t(a);return(a=m.find(a,function(a){return 0<=
a.indexOf(c+"\x3d")}))?a.split("\x3d")[1]:null}function p(a,c){if(-1===f(a).attr("class").indexOf("active")){e.Confluence.PropertyPanel.destroy();var b=Object.keys(n),d=f(a).attr("class");for(a=0;a<b.length;a++)if(-1!==d.indexOf(b[a])){var k=n[b[a]];d=f(c);d.attr("height",k);var g=d.attr("src");null!=g&&0<=g.indexOf("/servlet/view-file-macro/placeholder")&&(d.attr("src",r(d.attr("src"),k)),d.attr("data-mce-src",r(d.attr("data-mce-src"),k)),l.isGecko&&e.Rte.getEditor().execCommand("mceRepaint",!1));
k="height\x3d"+k;g=t(d);var h=u(d,"height");h?(h=m.indexOf(g,"height\x3d"+h),g[h]=k):g.push(k);d.attr("data-macro-parameters",g.join("|"));l.activeEditor.undoManager.add();f(c).click();d=l.activeEditor.getDoc().createRange();d.setStartBefore(c);d.setEndAfter(c);l.activeEditor.getDoc().getSelection().addRange(d);e.trigger("analyticsEvent",{name:"confluence.view-file.resize."+b[a].substring(b[a].lastIndexOf("-")+1,b[a].length)});break}}}function z(){e.bind("created.property-panel",function(a,c){var b=
f(c.anchor);if("view-file"===b.attr("data-macro-name")){a=q.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var d=u(b,"name");b=h.getParameterByName(b.attr("src"),"mimeType");b=e.Confluence.FileTypesUtils.getAUIIconFromMime(b);a=f(a({fileName:d,fileIcon:b}));c.panel.find(".aui-property-panel").prepend(a);c.shouldFlip&&c.tip.css({top:c.panel.outerHeight()})}})}var n={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"},v=[{className:"macro-property-panel-view-file-size-small editor-resize resize-small",
text:"",tooltip:"Small thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:p},{className:"macro-property-panel-view-file-size-medium editor-resize resize-medium",text:"",tooltip:"Medium thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:p},{className:"macro-property-panel-view-file-size-large editor-resize resize-large",text:"",tooltip:"Large thumbnail",
iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:p},null,{className:"macro-property-panel-view-file-convert-to-link",text:"Show as link",tooltip:"Show as link",click:function(a,c){e.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});e.Confluence.PropertyPanel.destroy();(function(a){a=h.getParameterByName(f(a).attr("src"),"attachmentId");
a=e.REST.makeUrl("attachment/"+a+".json");f.ajax({type:"GET",url:a,contentType:"application/json; charset\x3dutf-8",dataType:"json"}).success(function(a){a=q.Link.fromREST(a).insert();l.activeEditor.undoManager.add();l.activeEditor.focus();a.click()})})(c)}}];return{init:function(){e.Confluence.PropertyPanel.Macro.registerInitHandler(function(a,c,b){y(c);a=f(a);b=a.attr("data-mce-src");if(!(b&&-1<b.indexOf("placeholder/unknown-attachment"))){b=0;for(var d=v.length;b<d;b++)c.push(v[b]);(a=a.attr("height"))||
(a="comment"===e.Meta.get("content-type")?h.DEFAULT_HEIGHT_IN_COMMENT:h.DEFAULT_HEIGHT);x(c,a)}},"view-file");z()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(e,c,f,g){function h(d){if(d){var a=e(d);d=a.attr("data-linked-resource-type");a=a.attr("data-linked-resource-content-type");return c.MacroBrowser.getMacroMetadata("view-file")&&"attachment"===d&&!(a&&0===a.indexOf("image"))}return!1}function k(d){var a=c.REST.makeUrl("attachment/"+e(d).attr("data-linked-resource-id")+".json");e.ajax({type:"GET",url:a,contentType:"application/json; charset\x3dutf-8",
dataType:"json"}).success(function(b){var a={name:b.fileName};c.Data.get("content-id")!==b.ownerId&&(a.page=b.parentTitle,a.space=b.space.key,"blogpost"===b.parentContentType&&(b=b.createdDate.date.split("-"),a.date=b[0]+"/"+b[1]+"/"+b[2].substring(0,2)+"/"));a.height="comment"===c.Meta.get("content-type")?g.DEFAULT_HEIGHT_IN_COMMENT:g.DEFAULT_HEIGHT;a={contentId:c.Meta.get("content-id")||"0",macro:{name:"view-file",params:a}};f.confluence.MacroUtils.insertMacro(a,d).done(function(a){e(a).click();
const b=f.activeEditor.getDoc().createRange();b.setStartBefore(a);b.setEndAfter(a);f.activeEditor.getDoc().getSelection().addRange(b)})})}return{init:function(){c.bind("link-property-panel-buttons.created",function(d,a){d=a.buttons;var b=a.link;h(b)&&d.push({className:"link-property-panel-convert-to-thumbnail-button",text:"Show as thumbnail",tooltip:"Show as thumbnail",click:function(){c.Confluence.PropertyPanel.destroy();
k(b);c.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller","ajs jquery underscore tinymce vfm/view-file-macro-utils vfm/services/conversion-service".split(" "),function(u,k,n,g,b,p){function r(){if(g.activeEditor&&h){var a=k("img[data-macro-name\x3d'view-file'][src*\x3d'thumbnailStatus\x3d"+b.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!\x3d'"+b.THUMBNAIL_STATUS_ERROR+"']",g.activeEditor.dom.doc);if(0<a.length){var q=!1;a.each(function(){var a=k(this).attr("src"),l=b.getParameterByName(a,"attachmentId");
a=b.getParameterByName(a,"version");c[l]&&c[l].version===a||(c[l]={version:a},q=!0)});q&&(d=b.THUMBNAIL_POLLING_PERIOD);p.postThumbnailConversionResults(c).then(function(a){g.activeEditor&&h&&(n.each(a,function(a,e){if(c[e]){var d=k("img[data-macro-name\x3d'view-file'][src*\x3d'attachmentId\x3d"+e+"']",g.activeEditor.dom.doc),f=c[e].version;d.attr("data-thumbnail-status",a);a===b.THUMBNAIL_STATUS_CONVERTED?(a=d.attr("src"),f=p.getThumbnailUrl(e,f),f=b.addParamsToUrl(f,{attachmentId:e,mimeType:b.getParameterByName(a,
"mimeType")}),d.attr("src",f),delete c[e]):a===b.THUMBNAIL_STATUS_ERROR&&delete c[e]}}),d=n.isEmpty(c)?b.THUMBNAIL_POLLING_PERIOD:d*t,m())})}else 0===a.length&&(d=b.THUMBNAIL_POLLING_PERIOD,m())}}function m(){h=!0;a&&clearTimeout(a);a=setTimeout(r,d)}var a,h=!1,c={},d=b.THUMBNAIL_POLLING_PERIOD,t=b.THUMBNAIL_POLLING_BACKOFF_RATIO;return{startPolling:m,stopPolling:function(){a&&(clearTimeout(a),a=void 0);h=!1;c={};d=b.THUMBNAIL_POLLING_PERIOD}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,b,d,e,c){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(a){}});d.init();e.init()});b.create("tinymce.plugins.ViewFilePoller",{init:function(b){a.bind("rte-ready",function(){c.startPolling()});a.bind("rte-destroyed",function(){c.stopPolling()})}});b.PluginManager.add("viewFilePoller",b.plugins.ViewFilePoller);
a.Rte.BootstrapManager.addTinyMcePluginInit(function(a){a.plugins+=",viewFilePoller"})},void 0,!0);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.tabs', location = 'aui.chunk.4eae21fe7bc1aecf042f--5ba0ee22cdcd2bc7337a.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.tabs"],{zCVu:function(t,a,e){"use strict";e.r(a),e.d(a,"TabContainerEl",(function(){return W})),e.d(a,"TabPaneEl",(function(){return I})),e.d(a,"TabItemEl",(function(){return D}));e("FStl"),e("Q0fs"),e("XHZH"),e("gjsO");var i=e("JFi+"),n=e("QFBp"),s=e("+x/D"),r=e("KloK"),o=e("OEua");function c(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var e=Object(s.a)(t),i=a||!1;e.each((function(){var t=Object(s.a)(this);t.attr("id")||t.attr("id",Object(o.a)(i))}))}Object(r.a)("_addID",c);var u=c;function d(t){return(t=Object(s.a)(t)).prop("scrollWidth")>t.prop("clientWidth")}Object(r.a)("isClipped",d);var l=d,b=e("4dFR"),p=window.skateTemplateHtml;function f(t){let a=Object(s.a)(t),e=String(a.attr("href")||"").trim();return 0===e.indexOf("#")?e.substr(1):null}function h(t){let a=f(t);return a?document.getElementById(a):null}var v={totalTabsWidth:function(t,a){var e=this.totalVisibleTabWidth(t),i=0;return a.find("li").each((function(t,a){i+=parseInt(a.getAttribute("data-aui-tab-width"))})),e+i},totalVisibleTabWidth:function(t){var a=0;return t.each((function(t,e){a+=Object(s.a)(e).outerWidth()})),a},removeResponsiveDropdown:function(t,a){t.remove(),a.remove()},createResponsiveDropdownTrigger:function(t,a){var e='<li class="menu-item aui-tabs-responsive-trigger-item">\n            <a\n                class="aui-dropdown2-trigger aui-tabs-responsive-trigger aui-dropdown2-trigger-arrowless"\n                id="aui-tabs-responsive-trigger-'.concat(a,'"\n                aria-haspopup="true"\n                aria-controls="aui-tabs-responsive-dropdown-').concat(a,'"\n                href="#aui-tabs-responsive-dropdown-').concat(a,'">...</a>\n            </li>');return t.append(e),t.find(".aui-tabs-responsive-trigger-item")},createResponsiveDropdown:function(t,a){var e='<div class="aui-dropdown2 aui-tabs-responsive-dropdown" id="aui-tabs-responsive-dropdown-'+a+'"><ul></ul></div>';return t.append(e),t.find("#aui-tabs-responsive-dropdown-"+a)},findNewVisibleTabs:function(t,a,e){function i(t,a,e){return t+a<=e}for(var n=0,r=0;i(n,e,a)&&r<t.length;r++){n+=Object(s.a)(t[r]).outerWidth(!0)}return t.slice(0,r-1)},moveVisibleTabs:function(t,a,e){for(var i=e.find("a").attr("aria-controls"),n=Object(s.a)("#"+i),r=this.findNewVisibleTabs(t,a.outerWidth(),e.parent().outerWidth(!0)),o=r.length-1,c=t.length-1;c>=o;c--){var u=Object(s.a)(t[c]);this.moveTabToResponsiveDropdown(u,n,e)}return Object(s.a)(r)},moveTabToResponsiveDropdown:function(t,a,e){var i=t.find("a");t.attr("data-aui-tab-width",t.outerWidth(!0)),i.addClass("aui-dropdown2-radio aui-tabs-responsive-item"),t.hasClass("active-tab")&&(i.addClass("aui-dropdown2-checked"),e.addClass("active-tab")),a.find("ul").prepend(t)},moveInvisibleTabs:function(t,a,e){function i(t){return t>0}for(var n=0;i(a)&&n<t.length;n++){var r=Object(s.a)(t[n]),o=parseInt(r.attr("data-aui-tab-width"),10);o<a&&this.moveTabOutOfDropdown(r,e),a-=o}},moveTabOutOfDropdown:function(t,a){t.find("a").hasClass("aui-dropdown2-checked")&&(t.addClass("active-tab"),a.removeClass("active-tab")),t.children("a").removeClass("aui-dropdown2-radio aui-tabs-responsive-item aui-dropdown2-checked"),a.before(t)}};function m(t){var a=Object(s.a)(t);if(!a.hasClass("aui-tabs-responsive-trigger")){var e=h(a);if(e){var n=Object(s.a)(e);n.addClass("active-pane").siblings(".tabs-pane").removeClass("active-pane");var r=a.parents(".aui-tabs").find(".aui-tabs-responsive-trigger-item a").attr("aria-controls"),o=Object(s.a)(document.getElementById(r));if(o.find("li a").attr("aria-checked",!1).removeClass("checked aui-dropdown2-checked"),o.find("li").removeClass("active-tab"),a.parent("li.menu-item").addClass("active-tab").siblings(".menu-item").removeClass("active-tab"),a.hasClass("aui-tabs-responsive-item")){var c=n.parent(".aui-tabs").find("li.menu-item:not(.aui-tabs-responsive-trigger-item)");c.removeClass("active-tab"),c.find("a").removeClass("checked").removeAttr("aria-checked")}a.hasClass("aui-tabs-responsive-item")&&n.parent(".aui-tabs").find("li.menu-item.aui-tabs-responsive-trigger-item").addClass("active-tab"),a.closest(".tabs-menu").find("a").attr("aria-selected","false"),a.attr("aria-selected","true"),a.trigger("tabSelect",{tab:a,pane:n})}else i.a("Cannot switch to tab panel because it does not exist. Check whether the tab link href is correct.",t)}}function g(t){return void 0!==t.attr("data-aui-persist")&&"false"!==t.attr("data-aui-persist")}function w(t){var a=t.attr("id"),e=t.attr("data-aui-persist");return"_internal-aui-tabs-"+(a||"")+(e&&"true"!==e?"-"+e:"")}function k(t){A.change(Object(s.a)(t.target).closest("a")),t&&t.preventDefault()}function O(t){t.forEach((function(t,a){!function(t,a){var e=Object(s.a)(t),i=e.find(".tabs-menu").first(),n=i.find("li:not(.aui-tabs-responsive-trigger-item)"),r=i.find(".aui-tabs-responsive-trigger").parent(),o=r.find("a"),c=o.attr("aria-controls"),u=Object(s.a)(document.getElementById(c)).attr("aria-checked",!1),d=u.length>0,l=v.totalTabsWidth(n,u)>e.outerWidth();if(!d&&l&&(r=v.createResponsiveDropdownTrigger(i,a),u=v.createResponsiveDropdown(e,a)),o.attr("aria-controls","aui-tabs-responsive-dropdown-"+a),o.attr("id","aui-tabs-responsive-trigger-"+a),o.attr("href","#aui-tabs-responsive-trigger-"+a),u.attr("id","aui-tabs-responsive-dropdown-"+a),l){var b=v.moveVisibleTabs(n.toArray(),e,r),p=v.totalVisibleTabWidth(b),f=e.outerWidth()-p-r.outerWidth(!0);if(f>0){var h=u.find("li");v.moveInvisibleTabs(h.toArray(),f,r)}e.hasClass("aui-tabs-disabled")||u.on("click","a",k),i.is(":visible")&&i.hide().show()}d&&!l&&(u.find("li").each((function(){v.moveTabOutOfDropdown(Object(s.a)(this),r)})),v.removeResponsiveDropdown(u,r))}(t,a)}))}function j(){return Object(s.a)('.aui-tabs.horizontal-tabs[data-aui-responsive]:not([data-aui-responsive="false"]), aui-tabs[responsive]:not([responsive="false"])').toArray()}function C(t){var a=Object(s.a)(t);if(t.setAttribute("role","application"),!a.data("aui-tab-events-bound")){var e=a.children("ul.tabs-menu");e.attr("role","tablist"),e.children("li").attr("role","presentation"),e.find("> .menu-item a").each((function(){var t,a,e;t=this,a=Object(s.a)(t),e=h(a),f(t)||i.a('A tab link must use an anchor link (e.g., <a href="#a-valid-id"></a>) to work correctly.',t),e?(u(a),a.attr("role","tab"),Object(s.a)(e).attr("aria-labelledby",a.attr("id")),a.parent().hasClass("active-tab")?a.attr("aria-selected","true"):a.attr("aria-selected","false")):i.c("A tab panel could not be found with the tab link's configured href. Check whether the tab link href is correct.",t)})),e.on("click","a",k),a.data("aui-tab-events-bound",!0),function(t){[].slice.call(t.querySelectorAll(".tabs-pane")).forEach(y)}(t)}}function T(){var t=Object(s.a)(".aui-tabs:not(.aui-tabs-disabled)");t.each((function(){C(this)})),function(t){for(var a=0,e=t.length;a<e;a++){var n=t.eq(a),s=t.get(a);if(g(n)&&window.localStorage)if(n.attr("id")){var r=window.localStorage.getItem(w(n));if(r){var o=s.querySelector('a[href$="'.concat(r,'"]'));o&&m(o)}}else i.c("A tab group must specify an id attribute if it specifies data-aui-persist.")}}(t)}function y(t){t.setAttribute("role","tabpanel")}var A={setup:function(){!function(){const t=Object(n.debounce)(O,200);t(j()),Object(s.a)(window).on("resize",(()=>t(j())))}(),T(),Object(s.a)(".aui-tabs.vertical-tabs").find("a").each((function(){var t=Object(s.a)(this);t.attr("title")||l(t)&&t.attr("title",t.text())}))},change:function(t){var a=Object(s.a)(t),e=a.closest(".aui-tabs");m(a),g(e)&&window.localStorage&&function(t){var a=t.closest(".aui-tabs");if(a.attr("id")){var e=f(t);e&&window.localStorage.setItem(w(a),"#"+e)}else i.c("A tab group must specify an id attribute if it specifies data-aui-persist.")}(a)}};Object(s.a)(A.setup);const W=Object(b.a)("aui-tabs",{created:function(t){Object(s.a)(t).addClass("aui-tabs horizontal-tabs"),b.a.init(t),C(t)},template:p('<ul class="tabs-menu">','<content select="li[is=aui-tabs-tab]"></content>',"</ul>",'<content select="aui-tabs-pane"></content>'),prototype:{select:function(t){var a,e=Object(s.a)((a=this,a.querySelectorAll("aui-tabs-pane"))).index(t);return e>-1&&A.change(function(t){return t.querySelectorAll("li[is=aui-tabs-tab]")}(this)[e].children[0]),this}}}),D=Object(b.a)("aui-tabs-tab",{extends:"li",created:function(t){Object(s.a)(t).addClass("menu-item")},template:p('<a href="#">',"<strong>","<content></content>","</strong>","</a>")}),I=Object(b.a)("aui-tabs-pane",{attached:function(t){var a=Object(s.a)(function(t){return Object(s.a)(t).closest("aui-tabs").get(0)}(t)),e=Object(s.a)(t),i=a.find("aui-tabs-pane").index(e),n=new D,r=Object(s.a)(n);e.addClass("tabs-pane"),n.firstChild.setAttribute("href","#"+t.id),p.wrap(n).textContent=e.attr("title"),0===i&&e.addClass("active-pane"),e.hasClass("active-pane")&&r.addClass("active-tab"),e.siblings("ul").append(n)},template:p("<content></content>")});Object(r.a)("tabs",A)}},[["zCVu","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.5f851f97df","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.ed86a19e01","aui.splitchunk.084821f40b","aui.splitchunk.2e16019fb9","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.e5af17b48e","aui.splitchunk.f154095da3","aui.splitchunk.36cd9d521c","aui.splitchunk.4248e12b20","aui.splitchunk.b548966f06"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:2a69e02bdf04122e2e9e96d058fa48b6', location = 'build/2a69e02bdf04122e2e9e.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[11],{16:function(e,t,a){"use strict";var r=a(10),i=a(0),n=a(13),l=a.n(n),o={contents:null,tfs:{},panels:[],init:function(){var e=this;$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"GET",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/license",dataType:"json",success:function(t){t&&(e.initFilters(),e.bindEvents(),AJS.Rte.Content.editorResetContentChanged())}})},initFilters:function(){var e=this;e.contents=$("#wysiwygTextarea_ifr").contents(),e.toolbar=$("#rte-toolbar"),e.contents.find('[data-macro-name="table-filter"]').each((function(){e.createFilter($(this))}))},bindEvents:function(){var e=this,t=function(t){t.attributes&&t.attributes["data-macro-name"]&&"table-filter"===t.attributes["data-macro-name"].value?e.createFilter($(t)):t.querySelectorAll&&$(t.querySelectorAll('[data-macro-name="table-filter"]')).each((function(){e.createFilter($(this))}))};if(window.MutationObserver){new MutationObserver((function(e){e.forEach((function(e){Array.prototype.forEach.call(e.addedNodes,(function(e){t(e)}))}))})).observe(e.contents[0],{childList:!0,subtree:!0})}else e.contents.bind("DOMNodeInserted",(function(e){t(e.target)}));AJS.bind("created.property-panel",(function(t,a){if("macro"==a.type){var r=$(a.anchor);if("table-filter"==r.attr("data-macro-name")){var i=r.attr("id"),n=e.tfs[i];if(n&&n.tables.length)e.toolbar.find(".tablefilter-outer-wrapper").data("id")==i?a.panel.find(".macro-property-panel-show-tf").addClass("hide-tf").addClass("visible").find(".panel-button-text").text("Hide filter"):a.panel.find(".macro-property-panel-show-tf").removeClass("hide-tf").addClass("visible").find(".panel-button-text").text("Show filter");else a.panel.find(".macro-property-panel-show-tf").hide()}}})),$(document).bind("enableContextToolbarRow.Toolbar",(function(){$(o.toolbar.find(".tablefilter-outer-wrapper")).appendTo(o.toolbar)})),e.bindSave(),tinymce.activeEditor.onUndo.listeners?(tinymce.activeEditor.onUndo.listeners.push({cb:function(){e.updateFilters()}}),tinymce.activeEditor.onRedo.listeners.push({cb:function(){e.updateFilters()}})):(tinymce.activeEditor.onUndo.add((function(){e.updateFilters()})),tinymce.activeEditor.onRedo.add((function(){e.updateFilters()})));var a,n=function(e,t){var a=$("<div/>").append(t.content),n=a.find('table[data-macro-name="table-filter"], table[data-macro-name="pivot-table"], table[data-macro-name="table-chart"], table[data-macro-name="table-joiner"]').each((function(e){var t=$(this),a=Confluence.MacroParameterSerializer.deserialize(t.attr("data-macro-parameters"));a.id=(new Date).getTime()+e+"_"+i.a.hashCode(this.outerHTML),t.attr("id",a.id),t.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(a))}));if(r.a.prototype.tableWrapper=a.find(".tablefilter-table-wrapper"),r.a.prototype.tables=r.a.prototype.tableWrapper.find("table"),r.a.prototype.editorMacro=!0,r.a.prototype.makeTablesScrollable(),0===n.length){var l=a.find("table.tf-copy-table");l.length&&(l.removeClass("tf-copy-table"),l.find("tr").filter((function(){return!i.a.isRowVisible(this)})).remove(),l.find(".fake").removeClass("fake").filter((function(){return"none"===this.style.display})).remove(),l.find(".tf-hidden-column, .tf-header-hidden").remove(),l.find('[class*="tf-rowspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-rowspan-\d+/))})),l.find('[class*="tf-colspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-colspan-\d+/))})))}t.content=a.html()},l=function(){clearTimeout(a),a=setTimeout((function(){$.each(e.tfs,(function(t,a){if(0==a.tableWrapper.closest("body").length){var r=e.contents.find('[id="'+t+'"]');r.length&&(r.attr("id",""),e.panels[t]&&(e.panels[t].remove(),e.panels[t]=null),e.createFilter(r))}}))}),100)},s=tinymce.activeEditor.plugins.confluencepaste||tinymce.activeEditor.plugins.aePaste;s.onPreProcess?(s.onPreProcess.listeners.push({cb:n}),s.onPostProcess.listeners.push({cb:l})):(tinymce.activeEditor.on("PastePreProcess",(function(e){n(tinymce.activeEditor,e)})),tinymce.activeEditor.on("PastePostProcess",l)),$("#content-title").bind("focus click",(function(){e.toolbar.find(".tablefilter-outer-wrapper .disabled").removeClass("disabled").removeAttr("disabled"),e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.contents.click((function(){e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.toolbar.delegate(".tablefilter-outer-wrapper .aui-buttons.close","click",(function(){var e=o.toolbar.find(".tablefilter-outer-wrapper"),t=e.data("id");e.hide(),$("body").append(e),$("#inline-dialog-tf-add-filter-"+t).hide(),"false"==$("#filter-menu-view-"+t+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+t).trigger("aui-button-invoke")})),e.toolbar.delegate(".aui-iconfont-remove-row","mousedown",(function(){var e=$(tinymce.activeEditor.selection.getNode());e.is("td,th")&&(e=e.parent()),e.children('[rowspan="-1"]').attr("rowspan","1")}))},bindSave:function(){var e=this;setTimeout((function(){!Confluence.Editor.UI.isButtonEnabled||Confluence.Editor.UI.isButtonEnabled(Confluence.Editor.UI.saveButton)?(AJS.Editor.addSaveHandler((function(){e.destroyFilters()})),AJS.bind("rte-changeMode",(function(t,a){a==Confluence.Editor.MODE_PREVIEW?e.destroyFilters():a==Confluence.Editor.MODE_RICHTEXT&&($(".tablefilter-outer-wrapper").remove(),e.initFilters())}))):e.bindSave()}),200)},createFilter:function(e){var t=o,a=Confluence.MacroParameterSerializer.deserialize(e.attr("data-macro-parameters"));if(e.data("tf-init")||0!==e.find('[data-macro-name="pivot-table"],[data-macro-name="table-joiner"],[data-macro-name="table-filter"]').length)t.tfs[a.id]&&(t.tfs[a.id].tables.trigger("destroy"),t.makeTablesSortable(t.tfs[a.id]));else{if(t.contents.find('[id="'+a.id+'"]').length>1)return;if(e.data("tf-init",!0),e.attr("id",a.id),e.find(".wysiwyg-macro-body:eq(0)").addClass("tablefilter-table-wrapper"),t.panels[a.id])return t.tfs[a.id].tableWrapper=e.find(".tablefilter-table-wrapper"),t.tfs[a.id].getTable(),t.tfs[a.id].normalizeTable(),t.tfs[a.id].addNumbering(),t.tfs[a.id].appendSparklines(),t.tfs[a.id].bindDOMChange(),t.tfs[a.id].makeTablesScrollable(),t.tfs[a.id].filterTable(),t.tfs[a.id].tables.trigger("destroy"),t.tfs[a.id].editorMacro=e,t.makeTablesSortable(t.tfs[a.id]),void t.bindSynchronyFiltration(e,t.tfs[a.id]);var i=a["cell-width"]?a["cell-width"].split(","):[],n=a.default?a.default.split(","):[],s=a.inverse?a.inverse.split(","):[],d=a.labels?a.labels.split(""):[],c=0,f=0,b=0,p=null!=a.column?a.column.split(","):[],u=t.getFilterObjects(p,d,n,i,s,c,f,b);c+=p.length,f+=p.length,b+=p.length,p=null!=a.userfilter?a.userfilter.split(","):[];var h=t.getFilterObjects(p,d,n,i,s,c,f,b);c+=p.length,f+=p.length,b+=p.length,p=null!=a.numberfilter?a.numberfilter.split(","):[];var m=t.getFilterObjects(p,d,n,i,s,c,-1,b);c+=p.length,b+=p.length,p=null!=a.datefilter?a.datefilter.split(","):[];var g=t.getFilterObjects(p,d,n,i,s,c,-1,b);c+=p.length,b+=p.length;var v=(p="true"==a.globalFilter?["Global filter"]:[]).length?t.getFilterObjects(p,d,n,i,s,c,f,b)[0]:null;c+=p.length,f+=p.length,b+=p.length;var y=(p="true"==a.hideColumns?["Hide columns"]:[]).length?t.getFilterObjects(p,d,n,i,s,c,f,b)[0]:null;c+=p.length,f+=p.length,b+=p.length,p=null!=a.iconfilter?a.iconfilter.split(","):[];var w=t.getFilterObjects(p,d,n,i,s,c,f,b),F=$(l.a.panel({macroId:a.id,pageId:AJS.params.pageId,comboBoxes:u,edits:h,numberFilters:m,dateFilters:g,globalFilter:v,hideColumns:y,iconFilters:w,showNRows:a.showNRows,hideLabels:a.hidelabels,disableSave:a.disableSave,hideControls:a.hideControls,hidePane:!1,fd:!1,editable:!0,isEditor:!0}));F.addClass("toolbar-contextual"),F.append(l.a.editorCloseButton()),t.panels[a.id]=F,$("body").append(F);var C=$.extend(!0,{},a);C.macroParams=a,C.showNRows=C.showNRows||"all",C.heightValue=C.heightValue||"",C.numbering=C.numbering||"",C.sorts=a.sort?$.map(a.sort.split(","),(function(e){return e.replace(/\/g,",")})):[],C.separator=C.separator?C.separator.replace("Point (.)",".").replace("Comma (,)",","):".",C.pageId=AJS.params.pageId,C.sparkline="true"==C.sparkline,C.sparkName=C.sparkName||"",C.isLockEnabled=!0,C.thousandSeparator=(a.thousandSeparator||"").replace("\\u0020"," "),C.tabs=!1,C.editorMacro=e,t.tfs[a.id]=new r.a(C),t.tfs[a.id].showTable(!0),t.makeTablesSortable(t.tfs[a.id]),F.hide();var S=o.toolbar.find(".tablefilter-outer-wrapper");S.length>0&&0===t.tfs[S.data("id")].tableWrapper.parents("body").length&&(S.remove(),F.show(),F.find(".enableLock:visible").click(),o.toolbar.append(F)),t.bindSynchronyFiltration(e,t.tfs[a.id])}},bindSynchronyFiltration:function(e,t){e.attr("type")?(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):t.showOrHideTables(),window.MutationObserver&&new MutationObserver((function(){e.data("tf-self")?e.data("tf-self",!1):(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type"))))})).observe(e[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["type"]})},makeTablesSortable:function(e){e.sorting=!0,e.setMutationObserver(!0),e.tables.tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat,textExtraction:function(e){return i.a.getEditorCellText($(e))}}),e.sorting=!1,e.setMutationObserver(!0)},destroyFilters:function(){var e=this;$.each(e.tfs,(function(t,a){e.destroyFilter(a),e.cleanMacro(t),e.removePanel(t)})),e.tfs={}},cleanMacro:function(e){return this.contents.find('[id="'+e+'"]').data("tf-init",!1).attr("id","")},removePanel:function(e){this.panels[e]&&(this.panels[e].remove(),this.panels[e]=null)},destroyFilter:function(e){e.numbering="",e.fixedRows=0,e.editorSave=!0,e.showTableWithoutFilters(),e.addNumbering(),e.makeTablesScrollable(),e.tables.find(".fake").remove(),e.tables.trigger("destroy"),e.tables.find(".tablesorter-header").removeClass("tablesorter-header"),e.tables.find(".pivot-header").removeClass("pivot-header"),e.tables.find('[data-mce-style="display: none;"]').removeAttr("data-mce-style"),e.tables.find(".tf-sparkline-header, .tf-sparkline-container, .total-row, .total-col, .tf-header-hidden").remove(),e.tables.each((function(){$(this).data("fixed-header",!1)}))},updateFilters:function(){var e=this;$.each(e.tfs,(function(t,a){if(a.editorMacro.parent().length)a.tables.trigger("destroy"),e.makeTablesSortable(a),a.bindDOMChange();else{var r=e.cleanMacro(t);e.removePanel(t),e.createFilter(r)}}))},getFilterObjects:function(e,t,a,r,i,n,l,o){var s=[];return $.each(e,(function(e,d){var c=n+e,f=a.length>c?a[c].replace(/\/g,",").trim():"",b=f?f.replace(new RegExp("-Empty-","g"),"").split("&&"):[],p=f.split("->");s.push({label:t.length>o+e&&t[o+e]||d,name:d,defaultValue:f,columnWidth:l>-1&&r.length>l+e&&r[l+e]||"150",options:b,defaultFromValue:p[0],defaultToValue:p.length>1?p[1]:"",inverse:i.length>c&&"true"==i[c]})})),s}};t.a=o}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:editor-extensions', location = 'build/editor-extensions.js' */
!function(t){function e(e){for(var o,i,s=e[0],c=e[1],l=e[2],u=0,f=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);for(d&&d(e);f.length;)f.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],o=!0,s=1;s<r.length;s++){var c=r[s];0!==n[c]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=r[0]))}return t}var o={},n={18:0},a=[];function i(e){if(o[e])return o[e].exports;var r=o[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=o,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(r,o,function(e){return t[e]}.bind(null,o));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window.webpackJsonpTFAC=window.webpackJsonpTFAC||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=c;a.push([87,0,1,3,4,2,7,11]),r()}({12:function(t,e){t.exports=jQuery},67:function(module,exports,__webpack_require__){function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var jQuery=__webpack_require__(12),$=__webpack_require__(12);(function(){!function($){$.extend({tablesorterEditor:new function(){this.version="2.3.10";var parsers=[],widgets=[];function log(t){"undefined"!=typeof console&&void 0!==console.log||alert(t)}function benchmark(t,e){log(t+" ("+((new Date).getTime()-e.getTime())+"ms)")}function getElementText(t,e,r){if(!e)return"";var o=t.config,n=o.textExtraction,a="";return a="simple"===n?o.supportsTextContent?e.textContent:e.childNodes[0]&&e.childNodes[0].hasChildNodes()?e.childNodes[0].innerHTML:e.innerHTML:"function"==typeof n?n(e,t,r):"object"===_typeof(n)&&n.hasOwnProperty(r)?n[r](e,t,r):o.supportsTextContent?e.textContent:$(e).text(),$.trim(a)}function getParserById(t){var e,r=parsers.length;for(e=0;e<r;e++)if(parsers[e].id.toLowerCase()===t.toString().toLowerCase())return parsers[e];return!1}function detectParserForColumn(t,e,r,o){for(var n,a=parsers.length,i=!1,s="",c=!0;""===s&&c;)e[++r]?(s=getElementText(t,i=e[r].cells[o],o),t.config.debug&&log("Checking if value was empty on row "+r+", column: "+o+": "+s)):c=!1;for(n=1;n<a;n++)if(parsers[n].is(s,t,i))return parsers[n];return parsers[0]}function buildParserCache(t,e){var r,o,n,a,i,s,c,l=t.config,d=$(t.tBodies).filter(":not(."+l.cssInfoBlock+")"),u=$.tablesorterEditor,f="";if(0!==d.length){if((r=d[0].rows)[0])for(o=[],n=r[0].cells.length,a=0;a<n;a++)i=e.filter(':not([colspan])[data-column="'+a+'"]:last,[colspan="1"][data-column="'+a+'"]:last'),s=l.headers[a],c=getParserById(u.getData(i,s,"sorter")),l.empties[a]=u.getData(i,s,"empty")||l.emptyTo||(l.emptyToBottom?"bottom":"top"),l.strings[a]=u.getData(i,s,"string")||l.stringTo||"max",c||(c=detectParserForColumn(t,r,r.length>1?0:-1,a)),l.debug&&(f+="column:"+a+"; parser:"+c.id+"; string:"+l.strings[a]+"; empty: "+l.empties[a]+"\n"),o.push(c);return l.debug&&log(f),o}}function buildCache(t){var e,r,o,n,a,i,s,c,l,d=t.tBodies,u=t.config,f=u.parsers;for(u.cache={},u.debug&&(l=new Date),i=0;i<d.length;i++)if(u.cache[i]={row:[],normalized:[]},!$(d[i]).hasClass(u.cssInfoBlock)){for($(d[i]).addClass("tablesorter-hidden"),e=d[i]&&d[i].rows.length||0,r=d[i].rows[0]&&d[i].rows[0].cells.length||0,n=0;n<e;++n)if(!$(d[i].rows[n]).hasClass("tablesorter-header"))if(c=[],(s=$(d[i].rows[n])).hasClass(u.cssChildRow))u.cache[i].row[u.cache[i].row.length-1]=u.cache[i].row[u.cache[i].row.length-1].add(s);else{for(u.cache[i].row.push(s),a=0;a<r;++a)o=getElementText(t,s[0].cells[a],a),c.push(f[a].format(o,t,s[0].cells[a],a));c.push(u.cache[i].normalized.length),u.cache[i].normalized.push(c)}$(d[i]).removeClass("tablesorter-hidden")}u.debug&&benchmark("Building cache for "+e+" rows",l)}function getWidgetById(t){var e,r,o=widgets.length;for(e=0;e<o;e++)if((r=widgets[e])&&r.hasOwnProperty("id")&&r.id.toLowerCase()===t.toLowerCase())return r}function applyWidget(t,e){var r,o,n,a=t.config,i=a.widgets,s=i.length;for(a.debug&&(r=new Date),o=0;o<s;o++)(n=getWidgetById(i[o]))&&(!0===e&&n.hasOwnProperty("init")?n.init(t,widgets,n):!e&&n.hasOwnProperty("format")&&n.format(t));a.debug&&benchmark("Completed "+(!0===e?"initializing":"applying")+" widgets",r)}function appendToTable(t,e){var r,o,n,a,i,s,c,l,d,u,f,p=t.config,h=t.tBodies,g=[],m=p.cache;for(p.debug&&(f=new Date),l=0;l<h.length;l++)if(!$(h[l]).hasClass(p.cssInfoBlock)){for($(h[l]).addClass("tablesorter-hidden"),i=document.createDocumentFragment(),r=m[l].row,a=(n=(o=m[l].normalized).length)?o[0].length-1:0,s=0;s<n;s++)if(u=o[s][a],g.push(r[u]),!p.appender||!p.removeRows)for(d=r[u].length,c=0;c<d;c++)i.appendChild(r[u][c]);t.tBodies[l].appendChild(i),$(h[l]).removeClass("tablesorter-hidden")}p.appender&&p.appender(t,g),p.debug&&benchmark("Rebuilt table",f),e||applyWidget(t),$(t).trigger("sortEnd",t)}function computeThIndexes(t){var e,r,o,n,a,i,s,c,l,d,u,f,p=[],h={},g=$(t).find("tr:has(td,th):first");for(e=0;e<g.length;e++)for(i=g[e].cells,r=0;r<i.length;r++){for(c=(s=(a=i[r]).parentNode.rowIndex)+"-"+a.cellIndex,l=a.rowSpan||1,d=a.colSpan||1,void 0===p[s]&&(p[s]=[]),o=0;o<p[s].length+1;o++)if(void 0===p[s][o]){u=o;break}for(h[c]=u,$(a).attr({"data-column":u}),o=s;o<s+l;o++)for(void 0===p[o]&&(p[o]=[]),f=p[o],n=u;n<u+d;n++)f[n]="x"}return h}function formatSortingOrder(t){return/^d/i.test(t)||1===t}function buildHeaders(t){var e,r,o,n,a,i=computeThIndexes(t),s=t.config,c=$.tablesorterEditor;return s.headerList=[],s.debug&&(n=new Date),a=$(t).find(s.selectorHeaders).each((function(t){r=$(this),e=s.headers[t],s.onRenderHeader&&s.onRenderHeader.apply(r,[t]),this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(c.getData(r,e,"sortInitialOrder")||s.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,"false"===c.getData(r,e,"sorter")&&(this.sortDisabled=!0),this.lockedOrder=!1,void 0!==(o=c.getData(r,e,"lockedOrder")||!1)&&!1!==o&&(this.order=this.lockedOrder=formatSortingOrder(o)?[1,1,1]:[0,0,0]),this.sortDisabled||r.addClass(s.cssHeader),s.headerList[t]=this,r.parent().addClass(s.cssHeader)})),t.config.debug&&(benchmark("Built headers:",n),log(a)),a}function isValueInArray(t,e){var r,o=e.length;for(r=0;r<o;r++)if(e[r][0]===t)return!0;return!1}function setHeadersCss(t,e,r){var o,n,a,i,s=[],c=[t.config.cssDesc,t.config.cssAsc];for(e.removeClass(c.join(" ")).each((function(){this.sortDisabled||(s[this.column]=$(this))})),i=r.length,n=0;n<i;n++)if(2!==r[n][1]&&(s[r[n][0]]&&s[r[n][0]].addClass(c[r[n][1]]),o=e.filter('[data-column="'+r[n][0]+'"]'),i>1&&o.length))for(a=0;a<o.length;a++)o[a].sortDisabled||$(o[a]).addClass(c[r[n][1]])}function fixColumnWidth(t){if(t.config.widthFixed){var e=$("<colgroup>");$("tr:first td",t.tBodies[0]).each((function(){e.append($("<col>").css("width",$(this).width()))})),$(t).prepend(e)}}function updateHeaderSortCount(t,e){var r,o,n,a=t.config,i=e.length;for(r=0;r<i;r++)o=e[r],(n=a.headerList[o[0]])&&(n.count=o[1]%(a.sortReset?3:2))}function getCachedSortType(t,e){return t&&t[e]&&t[e].type||""}function multisort(table,sortList){var dynamicExp,col,mx=0,dir=0,tc=table.config,l=sortList.length,bl=table.tBodies.length,sortTime,i,j,k,c,cache,lc,s,e,order,orgOrderCol;for(tc.debug&&(sortTime=new Date),k=0;k<bl;k++){for(dynamicExp="var sortWrapper = function(a,b) {",cache=tc.cache[k],lc=cache.normalized.length,i=0;i<l;i++){if(c=sortList[i][0],order=sortList[i][1],s=/n/i.test(getCachedSortType(tc.parsers,c))?"Numeric":"Text",s+=0===order?"":"Desc",e="e"+i,/Numeric/.test(s)&&tc.strings[c]){for(j=0;j<lc;j++)col=Math.abs(parseFloat(cache.normalized[j][c])),mx=Math.max(mx,isNaN(col)?0:col);dir="boolean"==typeof tc.string[tc.strings[c]]?(0===order?1:-1)*(tc.string[tc.strings[c]]?-1:1):tc.strings[c]&&tc.string[tc.strings[c]]||0}dynamicExp+="var "+e+" = sort"+s+"(table,a["+c+"],b["+c+"],"+c+","+mx+","+dir+"); ",dynamicExp+="if ("+e+") { return "+e+"; } ",dynamicExp+="else { "}for(orgOrderCol=cache.normalized&&cache.normalized[0]?cache.normalized[0].length-1:0,dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];",i=0;i<l;i++)dynamicExp+="}; ";dynamicExp+="return 0; ",dynamicExp+="}; ",eval(dynamicExp),cache.normalized.sort(sortWrapper)}tc.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time",sortTime)}function sortText(t,e,r,o){if(e===r)return 0;var n,a,i,s,c,l,d,u,f=t.config,p=f.string[f.empties[o]||f.emptyTo],h=$.tablesorterEditor.regex;if(""===e&&0!==p)return"boolean"==typeof p?p?-1:1:-p||-1;if(""===r&&0!==p)return"boolean"==typeof p?p?1:-1:p||1;if("function"==typeof f.textSorter)return f.textSorter(e,r,t,o);if(n=e.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=r.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),a=parseInt(e.match(h[2]))||1!==n.length&&e.match(h[1])&&Date.parse(e),s=parseInt(r.match(h[2]))||a&&r.match(h[1])&&Date.parse(r)||null){if(a<s)return-1;if(a>s)return 1}for(u=Math.max(n.length,i.length),d=0;d<u;d++){if(c=!(n[d]||"").match(h[3])&&parseFloat(n[d])||n[d]||0,l=!(i[d]||"").match(h[3])&&parseFloat(i[d])||i[d]||0,isNaN(c)!==isNaN(l))return isNaN(c)?1:-1;if(_typeof(c)!==_typeof(l)&&(c+="",l+=""),c<l)return-1;if(c>l)return 1}return 0}function sortTextDesc(t,e,r,o){if(e===r)return 0;var n=t.config,a=n.string[n.empties[o]||n.emptyTo];return""===e&&0!==a?"boolean"==typeof a?a?-1:1:a||1:""===r&&0!==a?"boolean"==typeof a?a?1:-1:-a||-1:"function"==typeof n.textSorter?n.textSorter(r,e,t,o):sortText(t,r,e)}function getTextValue(t,e,r){if(e){var o,n=t.length,a=e+r;for(o=0;o<n;o++)a+=t.charCodeAt(o);return r*a}return 0}function sortNumeric(t,e,r,o,n,a){if(e===r)return 0;var i=t.config,s=i.string[i.empties[o]||i.emptyTo];return""===e&&0!==s?"boolean"==typeof s?s?-1:1:-s||-1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:s||1:(isNaN(e)&&(e=getTextValue(e,n,a)),isNaN(r)&&(r=getTextValue(r,n,a)),e-r)}function sortNumericDesc(t,e,r,o,n,a){if(e===r)return 0;var i=t.config,s=i.string[i.empties[o]||i.emptyTo];return""===e&&0!==s?"boolean"==typeof s?s?-1:1:s||1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:-s||-1:(isNaN(e)&&(e=getTextValue(e,n,a)),isNaN(r)&&(r=getTextValue(r,n,a)),r-e)}function checkResort(t,e,r){var o=t[0];!1!==e?t.trigger("sorton",[o.config.sortList,function(){t.trigger("updateComplete"),"function"==typeof r&&r(o)}]):(t.trigger("updateComplete"),"function"==typeof r&&r(o))}this.defaults={widthFixed:!1,cancelSelection:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",usNumberFormat:!0,delayInit:!1,headers:{},ignoreCase:!0,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:null,widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,onRenderHeader:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerSortUp",cssChildRow:"expand-child",cssDesc:"tablesorter-headerSortDown",cssHeader:"tablesorter-header",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"tr:has(td,th):first td, tr:has(td,th):first th",selectorRemove:"tr.remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},this.benchmark=benchmark,this.hasInitialized=!1,this.construct=function(t){return this.each((function(){if(0!==this.tBodies.length){var e,r,o,n,a,i,s,c,l,d,u=$.metadata;this.config={},(o=$.extend(!0,this.config,$.tablesorterEditor.defaults,t)).debug&&$.data(this,"startoveralltimer",new Date),r=$(this).addClass(o.tableClass),$.data(this,"tablesorter",o),o.supportsTextContent="x"===$("<span>x</span>")[0].textContent,o.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,null:0,top:!0,bottom:!1},e=buildHeaders(this),o.parsers=buildParserCache(this,e),o.delayInit||buildCache(this),fixColumnWidth(this),e.bind("mousedown.tablesorter mouseup.tablesorter",(function(t,u){if(t.ctrlKey||t.metaKey){if("mousedown"===t.type)return d=(new Date).getTime(),!o.cancelSelection;if(!0!==u&&(new Date).getTime()-d>500)return!1;if(o.delayInit&&!o.cache&&buildCache(r[0]),!this.sortDisabled){if(r.trigger("sortStart",r[0]),$(this),i=!t[o.sortMultiSortKey],this.count=(this.count+1)%(o.sortReset?3:2),o.sortRestart&&(n=this,e.each((function(){this===n||!i&&$(this).is("."+o.cssDesc+",."+o.cssAsc)||(this.count=-1)}))),n=this.column,i){if(o.sortList=[],null!==o.sortForce)for(s=o.sortForce,a=0;a<s.length;a++)s[a][0]!==n&&o.sortList.push(s[a]);if((l=this.order[this.count])<2&&(o.sortList.push([n,l]),this.colSpan>1))for(a=1;a<this.colSpan;a++)o.sortList.push([n+a,l])}else if(isValueInArray(n,o.sortList))for(a=0;a<o.sortList.length;a++)c=o.sortList[a],l=o.headerList[c[0]],c[0]===n&&(c[1]=l.order[l.count],2===c[1]&&(o.sortList.splice(a,1),l.count=-1));else if((l=this.order[this.count])<2&&(o.sortList.push([n,l]),this.colSpan>1))for(a=1;a<this.colSpan;a++)o.sortList.push([n+a,l]);if(null!==o.sortAppend)for(s=o.sortAppend,a=0;a<s.length;a++)s[a][0]!==n&&o.sortList.push(s[a]);return r.trigger("sortBegin",r[0]),setHeadersCss(r[0],e,o.sortList),multisort(r[0],o.sortList),appendToTable(r[0]),!1}}})),o.cancelSelection&&e.each((function(){this.onselectstart=function(){return!1}})),r.bind("update",(function(t,n,a){$(o.selectorRemove,this).remove(),o.parsers=buildParserCache(this,e),buildCache(this),checkResort(r,n,a)})).bind("updateCell",(function(t,e,n,a){var i,s=this,c=$(this).find("tbody"),l=c.index($(e).closest("tbody"));i=[c.eq(l).find("tr").index($(e).closest("tr")),e.cellIndex],s.config.cache[l].normalized[i[0]][i[1]]=o.parsers[i[1]].format(getElementText(s,e,i[1]),s,e,i[1]),checkResort(r,n,a)})).bind("addRows",(function(t,e,n,i){var s,c=e.filter("tr").length,l=[],d=e[0].cells.length,u=$(this).find("tbody").index(e.closest("tbody"));for(s=0;s<c;s++){for(a=0;a<d;a++)l[a]=o.parsers[a].format(getElementText(this,e[s].cells[a],a),this,e[s].cells[a],a);l.push(o.cache[u].row.length),o.cache[u].row.push([e[s]]),o.cache[u].normalized.push(l),l=[]}checkResort(r,n,i)})).bind("sorton",(function(t,r,n,a){$(this).trigger("sortStart",this);var i=o.headerList.length;o.sortList=[],$.each(r,(function(t,e){e[0]<i&&o.sortList.push(r[t])})),updateHeaderSortCount(this,o.sortList),setHeadersCss(this,e,o.sortList),multisort(this,o.sortList),appendToTable(this,a),"function"==typeof n&&n(this)})).bind("appendCache",(function(t,e){appendToTable(this,e)})).bind("applyWidgetId",(function(t,e){getWidgetById(e).format(this)})).bind("applyWidgets",(function(t,e){applyWidget(this,e)})).bind("destroy",(function(t,e){$.tablesorterEditor.destroy(this,e)})),r.data()&&void 0!==r.data().sortlist?o.sortList=r.data().sortlist:u&&r.metadata()&&r.metadata().sortlist&&(o.sortList=r.metadata().sortlist),applyWidget(this,!0),o.sortList.length>0?r.trigger("sorton",[o.sortList,{},!o.initWidgets]):o.initWidgets&&applyWidget(this),this.hasInitialized=!0,o.debug&&$.tablesorterEditor.benchmark("Overall initialization time",$.data(this,"startoveralltimer")),r.trigger("tablesorter-initialized",this),"function"==typeof o.initialized&&o.initialized(this)}}))},this.destroy=function(t,e){var r=$(t),o=t.config;r.find("thead:first .tablesorter-resizer").remove(),r.unbind("update updateCell addRows sorton appendCache applyWidgetId applyWidgets destroy mouseup mouseleave").find(o.selectorHeaders).unbind("click mousedown mousemove mouseup").removeClass(o.cssHeader+" "+o.cssAsc+" "+o.cssDesc),!1!==e&&r.removeClass(o.tableClass)},this.addParser=function(t){var e,r=parsers.length,o=!0;for(e=0;e<r;e++)parsers[e].id.toLowerCase()===t.id.toLowerCase()&&(o=!1);o&&parsers.push(t)},this.addWidget=function(t){widgets.push(t)},this.formatFloat=function(t,e){if("string"!=typeof t||""===t)return t;t=!1!==e.config.usNumberFormat?t.replace(/,/g,""):t.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(t)&&(t=t.replace(/^\s*\(/,"-").replace(/\)/,""));var r=parseFloat(t);return isNaN(r)?$.trim(t):r},this.isDigit=function(t){return/^[\-+(]?\d+[)]?$/.test(t.replace(/[,.'\s]/g,""))},this.regex=[/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i,/^0/],this.characterEquivalents={a:"",A:"",c:"",C:"",e:"",E:"",i:"",I:"",o:"",O:"",S:"",u:"",U:""},this.replaceAccents=function(t){var e,r="[",o=this.characterEquivalents;if(!this.characterRegex){for(e in this.characterRegexArray={},o)"string"==typeof e&&(r+=o[e],this.characterRegexArray[e]=new RegExp("["+o[e]+"]","g"));this.characterRegex=new RegExp(r+"]")}if(this.characterRegex.test(t))for(e in o)"string"==typeof e&&(t=t.replace(this.characterRegexArray[e],e));return t},this.getData=function(t,e,r){var o,n,a="",i=$(t);return i.length?(o=!!$.metadata&&i.metadata(),n=" "+(i.attr("class")||""),!i.data()||void 0===i.data(r)&&void 0===i.data(r.toLowerCase())?o&&void 0!==o[r]?a+=o[r]:e&&void 0!==e[r]?a+=e[r]:n&&n.match(" "+r+"-")&&(a=n.match(new RegExp(" "+r+"-(\\w+)"))[1]||""):a+=i.data(r)||i.data(r.toLowerCase()),$.trim(a)):""},this.clearTableBody=function(t){$(t.tBodies).filter(":not(."+t.config.cssInfoBlock+")").empty()}}})();var ts=$.tablesorterEditor;$.fn.extend({tablesorterEditor:ts.construct}),ts.addParser({id:"text",is:function(t,e,r){return!0},format:function(t,e,r,o){var n=e.config;return t=$.trim(n.ignoreCase?t.toLocaleLowerCase():t),n.sortLocaleCompare?ts.replaceAccents(t):t},type:"text"}),ts.addParser({id:"currency",is:function(t){return/^\(?[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+/.test(t)},format:function(t,e){return ts.formatFloat(t.replace(/[^\w,. \-()]/g,""),e)},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(t){return/^\d{2,3}[\.]\d{2,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(t)},format:function(t,e){var r,o,n=t.split("."),a="",i=n.length;for(r=0;r<i;r++)2===(o=n[r]).length?a+="0"+o:a+=o;return ts.formatFloat(a,e)},type:"numeric"}),ts.addParser({id:"url",is:function(t){return/^(https?|ftp|file):\/\//.test(t)},format:function(t){return $.trim(t.replace(/(https?|ftp|file):\/\//,""))},type:"text"}),ts.addParser({id:"isoDate",is:function(t){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},format:function(t,e){return ts.formatFloat(""!==t&&new Date(t.replace(/-/g,"/")).getTime()||"",e)},type:"numeric"}),ts.addParser({id:"percent",is:function(t){return/\d%\)?$/.test(t)},format:function(t,e){return ts.formatFloat(t.replace(/%/g,""),e)},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(t){return t.match(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/)},format:function(t,e){return ts.formatFloat(new Date(t).getTime()||"",e)},type:"numeric"}),ts.addParser({id:"date",is:function(t,e){try{return TableUtils.parseDate(t,e.config.dateFormat,e.config.locale),!0}catch(t){return!1}},format:function(t,e){try{return TableUtils.parseDate(t,e.config.dateFormat,e.config.locale).getTime()}catch(t){return""}},type:"numeric"}),ts.addParser({id:"shortDate",is:function(t){return/^(\d{2}|\d{4})[\/\-\,\.\s+]\d{2}[\/\-\.\,\s+](\d{2}|\d{4})$/.test(t)},format:function(t,e,r,o){var n=e.config,a=n.headerList[o],i=a.shortDateFormat;return void 0===i&&(i=a.shortDateFormat=ts.getData(a,n.headers[o],"dateFormat")||n.dateFormat),t=t.replace(/\s+/g," ").replace(/[\-|\.|\,]/g,"/"),"mmddyyyy"===i?t=t.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2"):"ddmmyyyy"===i?t=t.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1"):"yyyymmdd"===i&&(t=t.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3")),ts.formatFloat(new Date(t).getTime()||"",e)},type:"numeric"}),ts.addParser({id:"time",is:function(t){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(t)},format:function(t,e){return ts.formatFloat(new Date("2000/01/01 "+t).getTime()||"",e)},type:"numeric"}),ts.addParser({id:"digit",is:function(t){return ts.isDigit(t)},format:function(t,e){return ts.formatFloat(t.replace(/[^\w,. \-()]/g,""),e)},type:"numeric"}),ts.addParser({id:"metadata",is:function(t){return!1},format:function(t,e,r){var o=e.config,n=o.parserMetadataName?o.parserMetadataName:"sortValue";return $(r).metadata()[n]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(t){var e,r,o,n,a,i,s,c=t.config,l=new RegExp(c.cssChildRow,"i"),d=$(t).children("tbody:not(."+c.cssInfoBlock+")"),u=["even","odd"];for(u=c.widgetZebra&&c.hasOwnProperty("css")?c.widgetZebra.css:c.widgetOptions&&c.widgetOptions.hasOwnProperty("zebra")?c.widgetOptions.zebra:u,c.debug&&(i=new Date),s=0;s<d.length;s++)(e=$(d[s])).children("tr").length>1&&(n=0,r=e.find("tr:visible"),e.addClass("tablesorter-hidden"),r.each((function(){o=$(this),l.test(this.className)||n++,a=n%2==0,o.removeClass(u[a?1:0]).addClass(u[a?0:1])})),e.removeClass("tablesorter-hidden"));c.debug&&ts.benchmark("Applying Zebra widget",i)}})}(jQuery)}).call(window)},68:function(t,e,r){},87:function(t,e,r){"use strict";r.r(e);r(67);var o=r(16);!function(t){try{AJS.bind("init.rte",(function(){function e(e,r){Confluence.Editor.tableToolbar?Confluence.Editor.tableToolbar.Buttons.splice(Confluence.Editor.tableToolbar.Buttons.length-r,0,e):t(document).bind("createContextToolbarRow.Toolbar.tf",(function(){var o=t(tinymce.activeEditor.plugins.customtoolbar.getToolbarRow());if(o.length){t(document).unbind("createContextToolbarRow.Toolbar.tf");var n=o.children();n.eq(n.length-r-1).after(e.render())}}))}var r=function(){var e=t(tinymce.activeEditor.selection.getNode());return e.is("table")||(e=e.parents("table").eq(0)),tinymce.activeEditor.selection.select(e[0]),e},n=function(e){if(!t("#rte-toolbar-row-default").is(".disabled")){var o,n=r(),a='<table class="wysiwyg-macro" data-macro-name="table-filter" data-macro-parameters="" data-macro-schema-version="1" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body">'+AJS.Rte.getEditor().serializer.serialize(n.clone()[0],{forced_root_block:!1})+"</td></tr></tbody></table>";t.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/definition",async:!1,data:t.toJSON({contentId:AJS.params.contentId||AJS.Meta.get("content-id")||AJS.params.pageId||AJS.Meta.get("page-id"),macroHtml:a}),dataType:"text",success:function(e){o=t.secureEvalJSON(e)}}),tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:e,selectedMacro:o})}};e(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Filter table data",iconClass:"table-filter-insert",click:function(){n("table-filter")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a pivot table",iconClass:"pivot-table-insert",click:function(){n("pivot-table")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a chart from data series",iconClass:"table-chart-insert",click:function(){n("table-chart")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Join, merge and query tables",iconClass:"table-joiner-insert",click:function(){n("table-joiner")}})]),2);var a=t("#wysiwygTextarea_ifr")[0].contentDocument;e(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Copy table",iconClass:"tf-copy-table",click:function(){if(!t("#rte-toolbar-row-default").is(".disabled")){tinymce.activeEditor.focus();var e=tinymce.activeEditor.selection.getRng(),o=r().addClass("tf-copy-table");a.execCommand("copy"),tinymce.activeEditor.selection.setRng(e),o.removeClass("tf-copy-table")}}})]),2),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("unwrap-tf",(function(e,r){AJS.Rte.BookmarkManager.storeBookmark();var n=t(r),a=o.a.tfs[n.attr("id")];a&&o.a.destroyFilter(a),AJS.Rte.getEditor().selection.select(r),AJS.Rte.getEditor().execCommand("mceInsertContent",!1,n.find(".wysiwyg-macro-body").html()),AJS.Rte.BookmarkManager.restoreBookmark()}))}))}catch(t){}}(jQuery);r(68)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:tf-editor-resources', location = 'build/tf-editor.js' */
!function(e){function t(t){for(var r,a,l=t[0],u=t[1],f=t[2],p=0,s=[];p<l.length;p++)a=l[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&s.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(c&&c(t);s.length;)s.shift()();return i.push.apply(i,f||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,l=1;l<n.length;l++){var u=n[l];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={29:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var l=window.webpackJsonpTFAC=window.webpackJsonpTFAC||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var f=0;f<l.length;f++)t(l[f]);var c=u;i.push([86,0,1,3,4,2,7,11]),n()}({69:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var r=n(16);try{AJS.bind("init.rte",(function(){r.a.init(),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("show-tf",(function(e,t){var n=$(t),o=r.a.toolbar.find(".tablefilter-outer-wrapper"),i=o.data("id");if(o.hide(),$("body").append(o),$("#inline-dialog-tf-add-filter-"+i).hide(),"false"==$("#filter-menu-view-"+i+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+i).trigger("aui-button-invoke"),!$(".macro-property-panel-show-tf").hasClass("hide-tf")){var a=r.a.panels[n.attr("id")];a.show(),a.find(".enableLock:visible").click(),r.a.toolbar.append(a)}})),$("body").delegate("button:has(.aui-iconfont-table-split, .aui-iconfont-table-col-left, .aui-iconfont-table-col-right, .aui-iconfont-table-row-remove, .aui-iconfont-table-col-remove, .table-split-cells, .table-insert-column-before,.table-insert-column-after, .table-delete-row, .table-delete-column)","mouseup",(function(){if(!$(this).is(".disabled")){var e=$(tinymce.activeEditor.selection.getNode());e.is("table")||(e=e.parents("table").eq(0)),e.find(".fake").remove()}}))}))}catch(e){}n(69)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.playsql.requirementyogi:requirement-rte', location = 'js/requirement-rte.js' */
!function(){var __webpack_modules__={8049:function(){AJS.$((function($){var $tooltipables=$(".ry-tooltipable");$tooltipables.tooltip&&($tooltipables.tooltip({delayIn:0}),$(".ry-tooltipable-html").tooltip({delayIn:0,html:!0}))}))},6828:function(){function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}window.RY=window.RY||{};var RY=window.RY;RY.ellipse=function(message,length){return void 0===length&&(length=300),message&&message.length>length+10&&(message=message.substring(0,length)+""),message},RY.extractMessageFromXHR=function(jqXHR,length){var html=jqXHR.status+"-"+jqXHR.statusText;if(jqXHR.responseText){var text=jqXHR.responseText,position=text.indexOf("<message>");-1!==position&&(text=text.substr(position+"<message>".length));var indexOfTag=text.indexOf("<h3>Cause</h3>");-1!==indexOfTag&&(text=(text=(text=text.substr(indexOfTag)).replace(/<.*?>/g,"")).replace(/\s+/g," "));var errorFixAction=null,errorFixUrl=null;if("{"===text.charAt(0)||"["===text.charAt(0))try{var json=JSON.parse(text);if(json){if(json.errors&&json.errors.length>0){text="";var _step,_iterator=_createForOfIteratorHelper(json.errors);try{for(_iterator.s();!(_step=_iterator.n()).done;){var jiraError=_step.value;jiraError.applicationName&&jiraError.message?text+=jiraError.message+" (for "+jiraError.applicationName+" at "+jiraError.applicationUrl+")":text+=jiraError}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else json.message&&(text=json.message);errorFixUrl=json.errorFixUrl,errorFixAction=json.errorFixAction}}catch(err){}html+=": "+AJS.escapeHtml(RY.ellipse(text,300)),errorFixUrl&&(html+='<p><a href="'+AJS.escapeHtml(errorFixUrl)+'">'+(AJS.escapeHtml(errorFixAction)||"Click here to fix")+"</a></p>")}return html},RY.createXHRErrorHandler=function(message,onlyIfOAuthError){return function(jqXHR){(!onlyIfOAuthError||jqXHR.responseText&&-1!==jqXHR.responseText.toLowerCase().indexOf("oauth"))&&AJS.flag({type:"error",title:message,body:RY.extractMessageFromXHR(jqXHR,300)})}},RY.displayApplinkError=function(title,json){if(json.error){var html=json.error;json.errorFixUrl&&(html+='<br><a href="'+AJS.escapeHtml(json.errorFixUrl)+'">'+AJS.escapeHtml(json.errorFixAction||"Authenticate")+"</a>"),AJS.flag({type:"error",title:title,body:html})}},RY.bindFirst=function(event,handlerFn,$jQueryObject){if("string"!=typeof event)throw"the first argument should be an event";if("function"!=typeof handlerFn)throw"the second argument should be an event handler";if(!($jQueryObject instanceof jQuery))throw"the third argument should be a jQuery Object";$jQueryObject.on(event,handlerFn);var handlers=$("body").data("events")[event.split(".")[0]],handler=handlers.pop();handlers.splice(0,0,handler)},RY.getApplinks=function(callback){RY.getApplinks.cache?callback&&window.setTimeout((function(){callback(RY.getApplinks.cache)}),0):$.ajax({url:AJS.contextPath()+"/rest/jira-integration/1.0/servers",type:"GET",success:function(data){for(var jiraData=[],i=0;i<data.length;i++)jiraData.push({id:data[i].id,instance:data[i].name});RY.getApplinks.cache=jiraData,callback&&callback(jiraData)},error:RY.createXHRErrorHandler("Error getting the Jira applinks from the server")})},RY.decodeURIComponent=function(paramValue){var encodedWithoutPlus=(paramValue||"").replace(/\+/g," ");return decodeURIComponent(encodedWithoutPlus)},RY.decodedQueryParam=function(param,uri){var paramValue=uri.queryKey[param];return RY.decodeURIComponent(paramValue)},RY.btoa=function(text){var utf8Text=encodeURIComponent(text).replace(/%([0-9A-F]{2})/g,(function(match,p1){return String.fromCharCode("0x"+p1)}));return btoa(utf8Text)},RY.atob=function(base64EncodedUnicodeString){var percentEncodedText=atob(base64EncodedUnicodeString).split("").map((function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)})).join("");return decodeURIComponent(percentEncodedText)},RY.encodeMacroParam=function(param){return null==param?param:encodeURIComponent(param)},RY.decodeMacroParam=function(param){return null==param?param:decodeURIComponent(param)},RY.forEachInMessageBean=function(messages,callback){if(messages){if(messages.success){var _step2,_iterator2=_createForOfIteratorHelper(messages.success);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){callback("success",_step2.value)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}if(messages.info){var _step3,_iterator3=_createForOfIteratorHelper(messages.info);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){callback("info",_step3.value)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}if(messages.warnings){var _step4,_iterator4=_createForOfIteratorHelper(messages.warnings);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){callback("warning",_step4.value)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(messages.errors){var _step5,_iterator5=_createForOfIteratorHelper(messages.errors);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){callback("error",_step5.value)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}},RY.showMessageBean=function(title,messages){RY.forEachInMessageBean(messages,(function(type,messageText){AJS.flag({type:type,title:title,body:AJS.escapeHtml(messageText)})}))},RY.htmlBuilder=function(element,attributes){function parseChildren(parent,attributes){if("string"==typeof attributes)parent.insertAdjacentHTML("beforeend",attributes);else if(attributes instanceof Element)parent.appendChild(attributes);else{if(!(attributes instanceof Array))throw"Unrecognized html element: "+JSON.stringify(attributes);var _step6,_iterator6=_createForOfIteratorHelper(attributes);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){parseChildren(parent,_step6.value)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}}var el=document.createElement(element);if(attributes instanceof Array)parseChildren(el,attributes);else if(attributes instanceof Element)el.appendChild(attributes);else if("string"==typeof attributes)el.innerHTML=attributes;else if(attributes instanceof Object)for(var _i=0,_Object$keys=Object.keys(attributes);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];"html"==key?parseChildren(el,attributes[key]):"text"==key?el.appendChild(document.createTextNode(attributes[key])):el.setAttribute(key,attributes[key])}return el},String.prototype.startsWith||(String.prototype.startsWith=function(search,startingAt){return this.substr(startingAt||0,search.length)===search}),String.prototype.endsWith||(String.prototype.endsWith=function(search,startingAt){return startingAt<this.length?startingAt|=0:startingAt=this.length,this.substr(startingAt-search.length,search.length)===search}),RY.renderTestResultsToEmoji=function(tests){for(var _i2=0,_Object$keys2=Object.keys(tests);_i2<_Object$keys2.length;_i2++){var _step7,_iterator7=_createForOfIteratorHelper(tests[_Object$keys2[_i2]]);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var testRef=_step7.value;testRef.result&&(RY.replaceEmojis?(testRef.resultRendered=RY.replaceEmojis(testRef.result)||null,testRef.resultEmojiOnly=RY.extractEmojiOnly&&RY.extractEmojiOnly(testRef.result)):testRef.resultRendered=testRef.result)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}},RY.isEmptyObj=function(obj){return!(Object.keys(obj).length>0)&&JSON.stringify(obj)===JSON.stringify({})},RY.parseJSONSafe=function(value,defaultValue){if(!value)return defaultValue||null;try{return JSON.parse(value)}catch(e){return defaultValue||null}},RY.getUncheckedRequirements=function(queryString){var $checkboxes=$(".checkbox-requirement:not(:checked)");if(0===$checkboxes.length)return queryString;var result=queryString?"("+queryString+")":"";return $checkboxes.each((function(){var key=$(this).data("requirement-key");key&&-1==key.toString().indexOf("'")&&(result&&(result+=" AND "),result+="NOT key = '"+key+"'")})),result},RY.parseUrl=function(url){var urlToParse=url;0===urlToParse.indexOf("?")&&(urlToParse=urlToParse.substring(1));for(var queryString={},variables=urlToParse.split("&"),i=0;i<variables.length;i++)if(-1!==variables[i].indexOf("=")){var pair=variables[i].split("=");if(pair.length>1){var key=decodeURIComponent(pair[0]),value=decodeURIComponent(pair[1].replace(/\+/g,"%20"));void 0===queryString[key]?queryString[key]=value:"string"==typeof queryString[key]?queryString[key]=[queryString[key],value]:queryString[key].push(value)}}return queryString},RY.rebuildUrl=function(url,newParams){var params=RY.parseUrl(url);return params=Object.assign(params,newParams),"?"+RY.param(params)},RY.ajax=function(options){return new Promise((function(resolve,reject){$.ajax(options).done(resolve).fail(reject)}))},RY.quoteSearchTerm=function(term){return"'"+term.replace(/([\\'])/g,"\\$1")+"'"},RY.param=function(params){if(!params)return"";for(var keys=Object.keys(params),i=0;i<keys.length;i++){var param1=params[keys[i]];null==param1&&delete params[keys[i]]}return $.param(params)},RY.escapeForSearch=function(term){return term.replace(/([^a-zA-Z0-9&_\u00C0-\uFFEF])/g,"\\$1")},RY.isInt=function(str){var value=parseFloat(str);return!isNaN(value)&&Number.isInteger(value)}}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}!function(){"use strict";__webpack_require__(6828),__webpack_require__(8049);var extendedMode=void 0,fetched=!1,ExtendedMode={fetch:function(){fetched||(fetched=!0,$.ajax({url:AJS.contextPath()+"/rest/reqs/1/misc/nospace/extended-mode",type:"GET",success:function(data){extendedMode="true"===data}}))},isExtendedMode:function(){return ExtendedMode.fetch(),extendedMode},isValidRequirementKey:function(key){return!!key&&(this.isExtendedMode()?/^[\u0020-\u002E\u0030-\u005B\u005D-\u007E\u00A0-\uFFEF]+$/.test(key):/^[a-zA-Z_.0-9-]+$/.test(key))}};function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}AJS.bind("init.rte",(function(){function getPageId(){var commentId=AJS.Meta.get("comment-id");if(commentId&&"0"!=commentId)return commentId;var contentId=AJS.Meta.get("content-id");if(contentId&&"0"!=contentId)return contentId;var pageId=AJS.Meta.get("page-id");return pageId&&"0"!=pageId?pageId:void 0}function getCurrentPageDef(){var pageId=getPageId();if(pageId)return{pageId:pageId}}function getNextNode(node){if(node.firstChild)return node.firstChild;for(;node;){if(node.nextSibling)return node.nextSibling;node=node.parentNode}}function isInTableRow(node,container){for(;node;){if("TR"==node.nodeName)return!0;if(node==container)return!1;if(node==node.parentNode)return!1;node=node.parentNode}return!1}function getSelectedNewMacro(){var selectedElement=AJS.Rte.getEditor().selection.getEnd();return selectedElement&&selectedElement.getAttribute&&"requirement"==selectedElement.getAttribute("data-macro-name")&&!selectedElement.getAttribute("data-macro-parameters")?selectedElement:null}var oldPreviewOnLoad=AJS.MacroBrowser.previewOnload;AJS.MacroBrowser.previewOnload=function(){if(AJS.MacroBrowser.dialog.activeMetadata)return oldPreviewOnLoad.apply(this,arguments)};var PlaySQL=window.PlaySQL||{};PlaySQL.Requirements=PlaySQL.Requirements||{},PlaySQL.Requirements.macroPropertyPanel=PlaySQL.Requirements.macroPropertyPanel||{},PlaySQL.Requirements.macroPropertyPanel.suggestedKeys=[],AJS.MacroBrowser.setMacroJsOverride("requirement",{opener:function(macro){ExtendedMode.fetch(),$(tinymce.confluence.macrobrowser.getCurrentNode()).is("img")||PlaySQL.Requirements.macroPropertyPanel.insertMacros()}}),PlaySQL.Requirements.debounce=function(callback,delay){var lastCall=void 0;return function(){var now=Date.now();return!(lastCall&&lastCall+delay>now)&&(lastCall=now,callback.apply(this,arguments),!0)}},PlaySQL.Requirements.throttle=function(callback,delay){var args,that,nextTimeout=void 0;return function(){args=arguments,that=this,nextTimeout||(nextTimeout=window.setTimeout((function(){nextTimeout=void 0,callback.apply(that,args)}),delay))}},PlaySQL.Requirements.macroPropertyPanel.insertMacroWithParams=function(name,params,node){tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId()||"0",macro:{name:name,params:params,defaultParameterValue:"",body:void 0}},node)},PlaySQL.Requirements.macroPropertyPanel.insertMacro=function(){AJS.Rte.BookmarkManager.storeBookmark();var macroRenderRequest={contentId:AJS.Meta.get("content-id")||"0",macro:{name:"requirement",params:{},defaultParameterValue:void 0,body:void 0}};tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest),AJS.Rte.BookmarkManager.restoreBookmark();var countDown=30;window.setTimeout((function openPropertyPanel(){var selectedElement=getSelectedNewMacro();selectedElement?(tinymce.activeEditor.selection.select(selectedElement),$(selectedElement).click()):--countDown>0&&window.setTimeout(openPropertyPanel,100)}),100)};var ajaxToCreateRequirements=function(spaceKey,key,callbackSuccess,callbackError){return function(parameters){var providedJson,baseUrl=AJS.contextPath()+"/rest/reqs/1/requirement2/"+encodeURIComponent(spaceKey)+"/"+encodeURIComponent(key);parameters=parameters||{},getPageId()&&(parameters.pageId=getPageId()),parameters.providedJson&&(providedJson=parameters.providedJson,delete parameters.providedJson);var url=baseUrl+"?"+$.param(parameters);$.ajax({url:url,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({page:getCurrentPageDef(),spaceKey:spaceKey,providedJson:providedJson})}).done(callbackSuccess).fail(callbackError)}},deletedKeysHandler=function(callback,payload){AJS.Meta.getBoolean("is-space-admin")?confirm("This requirement key used to exist, and your administrator chose not to reassign keys. Since you are administrator, do you want to bypass this setting and reuse this key?")&&(payload.override=!0,callback(payload)):alert("This requirement key used to exist, and your administrator chose not to reassign keys. Only the space administrators can reassign keys. Please use another key.")};function fetchRequirementDetails(macroNode,macroParameters,spaceKey){spaceKey=macroParameters.spaceKey||spaceKey;var fields=macroParameters.fields||"";$.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+encodeURIComponent(spaceKey)+"/"+encodeURIComponent(macroParameters.key)+"?"+$.param({expand:"references",v:macroParameters.baseline}),type:"GET",contentType:"application/json; charset=utf-8"}).done((function(data){var $button=$(".macro-panel .panel-buttons .aui-button").last();if(macroParameters.key==data.key&&(1==data.references.length&&(data.references=[]),data.references.length||data.htmlExcerpt)){$button.after(PlaySQL.Requirements.Rte.detailRte({requirement:data,currentPageId:getPageId(),isOriginal:"DEFINITION"==macroParameters.type,fields:fields}));var $propertyPanel=$("#property-panel-requirement-detail");$propertyPanel.on("click",".property-panel-visible-fields",(function(){macroParameters.fields=$propertyPanel.find(".property-panel-visible-fields:checked").map((function(){return $(this).attr("name")+","})).toArray().join("");var $macroNode=$(macroNode);$macroNode.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(macroParameters));var macroName=$macroNode.attr("data-macro-name");tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId(),macro:{name:macroName,params:macroParameters,defaultParameterValue:"",body:void 0}},macroNode),AJS.Confluence.PropertyPanel.destroy()}))}}))}function searchOnThePage(callback,keyTemplate){if(keyTemplate&&keyTemplate.length>1)list=[keyTemplate];else{var $macroInstances=$(".editor-inline-macro[data-macro-name=requirement]",AJS.Rte.getEditor().getDoc()),allKeys=[],groups={},lastGroup=void 0;$macroInstances.each((function(){var parameters=Confluence.MacroParameterSerializer.deserialize($(this).attr("data-macro-parameters"));if(parameters.key){if("DEFINITION"===parameters.type){var key=RY.decodeMacroParam(parameters.key);if(!key||!ExtendedMode.isValidRequirementKey(key))return!0;var group=key.replace(/[0-9]+$/,""),number=parseInt(key.substr(group.length))+1,padding=key.length-group.length,groupDescription=groups[group];groupDescription?(isNaN(groupDescription.number)||groupDescription.number<number)&&(groupDescription.number=number,groupDescription.padding=Math.max(groupDescription.padding,padding),groupDescription.key=key):groups[group]={prefix:group,number:number,key:key,padding:padding},lastGroup=group,allKeys.push({key:key,group:group})}}else allKeys.length>0&&(allKeys[allKeys.length-1].cursor=!0),lastGroup&&(groups[lastGroup].cursor=!0)}));var list=$.map(groups,(function(group){for(var paddedNumber=""+group.number;paddedNumber.length<group.padding;)paddedNumber="0"+paddedNumber;return group.prefix+paddedNumber}));0===list.length&&list.push("REQ-001"),list.length>10&&(list=list.slice(-10))}var spaceKey=AJS.Meta.get("space-key");$.ajax({url:AJS.contextPath()+"/rest/reqs/1/rte/"+encodeURIComponent(spaceKey)+"/suggestAtInitialization",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(list)}).done((function(data){var suggestions=$.map(data.suggestedKeys,(function(key){return{html:"Create "+key,key:key,searchText:key,spaceKey:spaceKey,action:"CREATE"}}));showMessages(data.messages),callback(suggestions)})).error((function(data){showMessages([data.responseText])}))}function showMessages(messages){messages&&messages.length>0&&AJS.flag({type:"error",title:"Requirement Yogi",close:"auto",body:messages.map(AJS.escapeHtml).join("\n<br>")})}function addSuggestedKeys(suggestions){for(var existing=PlaySQL.Requirements.macroPropertyPanel.suggestedKeys,i=0;i<suggestions.length;i++){for(var key=suggestions[i].key,spaceKey=suggestions[i].spaceKey,found=!1,j=0;j<existing.length;j++)if(existing[j].key==key&&existing[j].spaceKey==spaceKey){found=!0;break}found||existing.push(suggestions[i])}updateSuggestions()}function updateSuggestions(){var suggestions=PlaySQL.Requirements.macroPropertyPanel.suggestedKeys,$input=$("#property-panel-requirement-key"),value=($input.val()||"").toUpperCase(),$ul=$input.parent().find("ul").first(),$lis=$ul.children(),usableKey=PlaySQL.Requirements.usableKey,countCreateSuggestions=0,hasExactMatch=!1;if(0!=$ul.length){$ul.empty(),suggestions.sort((function(a,b){return a.key>b.key?1:a.key<b.key?-1:0}));for(var i=0;i<suggestions.length;i++){var keyUpperCase=suggestions[i].key.toUpperCase(),priority="CREATE"==suggestions[i].action&&keyUpperCase==value?14:"CREATE"==suggestions[i].action&&0==keyUpperCase.indexOf(value)?13:"CREATE"==suggestions[i].action&&-1!=keyUpperCase.indexOf(value)?12:"CREATE"==suggestions[i].action?11:0==keyUpperCase.indexOf(value)?10:-1!=keyUpperCase.indexOf(value)?9:-1!=suggestions[i].searchText.toUpperCase().indexOf(value)?3:0;if(0!=priority&&!("CREATE"==suggestions[i].action&&++countCreateSuggestions>10)){14==priority&&(hasExactMatch=!0);var $newElement=$("<li>",{html:suggestions[i].html,"data-key":suggestions[i].key,"data-space-key":suggestions[i].spaceKey,"data-action":suggestions[i].action,"data-priority":priority});if(hasMatchingLI($lis,suggestions[i])&&$newElement.addClass("selected"),0==$ul.children().size())$ul.append($newElement);else{var $children=$ul.children(),$insertBefore=null;$children.each((function(){if(($(this).attr("data-priority")||1)<priority)return $insertBefore=$(this),!1})),null!=$insertBefore?$insertBefore.before($newElement):$ul.append($newElement)}}}if(value&&!hasExactMatch){var spaceKey=AJS.escapeHtml(AJS.Meta.get("space-key"));if(ExtendedMode.isValidRequirementKey(value)){if(usableKey){var $li=$("<li>",{html:"Create "+AJS.escapeHtml(value),"data-key":AJS.escapeHtml(value),"data-space-key":spaceKey,"data-action":"CREATE"});hasMatchingLI($lis,{key:value,spaceKey:spaceKey,action:"CREATE"})&&$li.addClass("selected"),$ul.prepend($li)}}else $ul.prepend($("<li>",{html:"'"+AJS.escapeHtml(value)+"': Invalid key.","data-key":"","data-action":"NOOP"}))}}}function hasMatchingLI($lis,suggestion){$lis.filter((function(index,item){var $item=$(item);return $item.attr("data-key")==suggestion.key&&$item.attr("data-space-key")==suggestion.spaceKey&&$item.attr("data-action")==suggestion.action})).hasClass("selected")}function getIframe(name){if("parent"==name)return window.top.document;if("macro-preview"==name)var $iframe=$("#macro-preview-iframe");if(0==$iframe.size())throw"No iframe "+name;return $iframe[0].contentWindow.document}PlaySQL.Requirements.macroPropertyPanel.insertMacros=function(){var mceSelectedTDs=tinymce.activeEditor.contentDocument.querySelectorAll(".mceSelected, td[data-mce-selected], th[data-mce-selected]"),isMCESelection=mceSelectedTDs&&mceSelectedTDs.length>0,result=null;function insertRequirementFor(element,offset,newRequirementKey,index,deletePreviousContents){var waitTime=100*Math.max(0,index-10)+(index>200?3e3+100*Math.max(0,index-200):0);window.setTimeout((function(){var placeholderNode;if(element.parentNode){3==element.nodeType&&(element=element.parentNode);for(var tdNode=element;tdNode&&"TR"!=tdNode.nodeName&&"TD"!=tdNode.nodeName&&tdNode!=tdNode.parentNode;)tdNode=tdNode.parentNode;if(tdNode&&tdNode.classList.contains("numberingColumn")&&$(tdNode).closest("table").find("> tbody > tr > .numberingColumn").removeClass("numberingColumn").removeAttr("contenteditable"),deletePreviousContents)for(;element.firstChild;)element.removeChild(element.firstChild);var tempNodeId="tmp-node-id-"+(new Date).getTime();(placeholderNode=AJS.Rte.getEditor().getDoc().createElement("span")).setAttribute("id",tempNodeId),element.insertBefore(placeholderNode,element.firstChild),tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId(),macro:{name:"requirement",params:{key:RY.encodeMacroParam(newRequirementKey),type:"DEFINITION"},defaultParameterValue:"",body:void 0}},placeholderNode)}}),waitTime)}if(!tinymce.activeEditor.selection.isCollapsed()||isMCESelection){var nodes=function(range){var nodes=[],mceSelectedTDs=tinymce.activeEditor.contentDocument.querySelectorAll(".mceSelected, td[data-mce-selected], th[data-mce-selected]");if(mceSelectedTDs&&mceSelectedTDs.length>0){for(var valid=!0,rows=[],i=0;i<mceSelectedTDs.length;i++){var td=mceSelectedTDs[i],text=$(td).text().trim();if("TD"!=td.nodeName&&"TH"!=td.nodeName){valid=!1;break}var tr=$(td).closest("tr")[0];-1==rows.indexOf(tr)&&(rows.push(tr),nodes.push([td,0,text]))}if(valid)return nodes;nodes=[]}var node=range.startContainer;for(nodes.push([node,range.startOffset]);node&&node!=range.endContainer;)node!=range.startContainer&&("P"==node.nodeName||"LI"==node.nodeName?isInTableRow(node,range.commonAncestorContainer)||nodes.push([node,0]):"TR"==node.nodeName&&"TD"==(td=node.childNodes[0]).nodeName&&nodes.push([td,0])),node=getNextNode(node);if(1==nodes.length){var $node0=$(nodes[0][0]),_text=$node0.text();if(_text&&"requirement".startsWith(_text))nodes=[];else{var $parentCell=$node0.closest("th,td");1==$parentCell.length&&$parentCell.text()===_text&&(nodes[0]=[$parentCell[0],0,_text])}}return nodes}(tinymce.activeEditor.selection.getRng());nodes.length>0&&(searchOnThePage((function(suggestions){for(var suggestion0=suggestions&&suggestions.length>0&&suggestions[0].key||"REQ-001",prefix=suggestion0.replace(/[0-9]+$/,""),number=suggestion0.substr(prefix.length),numberPadding=number.length,isSeeminglyNumbered=!0,i=0;i<nodes.length;i++)if(!nodes[i][2]||!ExtendedMode.isValidRequirementKey(nodes[i][2])){AJS.log("RY: Node "+nodes[i][2]+" is not a requirement key, so in the dialog we'll suggest to create keys."),isSeeminglyNumbered=!1;break}$("body").append(PlaySQL.Requirements.Rte.insertionOptionsInRte({prefix:prefix,number:number,numberPadding:numberPadding,quantity:nodes.length,isSeeminglyNumbered:isSeeminglyNumbered,firstExample:nodes[0][2]})),AJS.dialog2("#ry-insertion-options-dialog").show();var $dialog=$("#ry-insertion-options-dialog");function submitForm(){var prefix;$dialog.find(".ry-insertion-errors").empty();var payload,mode=$("#mode-selection").is(":checked"),replaceNodes=!1,spaceKey=AJS.Meta.get("space-key");if(mode){if(!(prefix=$("#ry-insertion-prefix-2").val().trim()))for(var _i=0;_i<nodes.length;_i++)if(!/[^0-9]/.test(nodes[_i][2]))return void $dialog.find(".ry-insertion-errors").text("You must set a prefix, since '"+nodes[_i][2]+"' is not a valid key.");var keys=nodes.map((function(node){return ExtendedMode.isExtendedMode()?prefix+node[2]:prefix+node[2].replace(/[^a-zA-Z0-9-_.%\*\+\^$\@\u00A1-\uFFEF]+/g,"-")}));payload={mode:"provided",providedJson:JSON.stringify(keys)},replaceNodes=!0}else{prefix=$("#ry-insertion-prefix").val();var numberString=$("#ry-insertion-number").val(),numberPadding=numberString.length,number=parseInt(numberString);if(isNaN(number))return void $dialog.find(".ry-insertion-errors").text("'"+numberString+"' is not a number.");payload={mode:"suggest",suggestPrefix:prefix,suggestStart:number,suggestPadding:numberPadding,suggestQuantity:nodes.length}}!function(nodes,replaceNodes,payload,$dialog,spaceKey){var preConfiguredAjaxCall=ajaxToCreateRequirements(spaceKey,"WHATEVER",(function(data){if(data.status)switch(data.status){case"CREATED":for(var i=0;i<nodes.length;i++){var node=nodes[i][0];nodes[i][1],insertRequirementFor(node,0,data.reqList[i].key,i,replaceNodes)}break;case"CONFLICT":AJS.flag({type:"error",title:"Conflict",body:"There are conflicting requirement keys: "+data.note});break;case"DELETED_KEY":deletedKeysHandler(preConfiguredAjaxCall,payload);break;case"BAD_REQUEST":AJS.flag({type:"error",title:"Bad request",body:data.note});break;default:alert("Couldn't create this requirement key. Try again or check whether this requirement exists.")}AJS.dialog2("#ry-insertion-options-dialog").hide()}),(function(jqXHR,errorMessage,errorObject){var message=RY.extractMessageFromXHR(jqXHR,300);if(409==jqXHR.status)try{var reqKey=JSON.parse(jqXHR.responseText)[0].key;reqKey&&(message="Wait a minute. Why does "+reqKey+" already exist? We can't override it, please use keys that are available.")}catch(err){}$dialog.find(".ry-insertion-errors").html(message)}));preConfiguredAjaxCall(payload)}(nodes,replaceNodes,payload,$dialog,spaceKey)}$dialog.find("input[name=mode]").click((function(){"mode-selection"===$(this).attr("id")?($dialog.find(".show-if-mode-selection").removeClass("hidden"),$dialog.find(".show-if-mode-generate").addClass("hidden")):($dialog.find(".show-if-mode-selection").addClass("hidden"),$dialog.find(".show-if-mode-generate").removeClass("hidden"))})),$dialog.find("#ry-insertion-submit").click((function(e){e.preventDefault(),submitForm()})),$dialog.find("form").on("keypress",(function(e){13!=e.which||e.shiftKey||e.metaKey||e.ctrlKey||(e.preventDefault(),submitForm())})),$dialog.find("#ry-insertion-close").click((function(e){AJS.dialog2("#ry-insertion-options-dialog").hide()}))})),result="there are several items")}"there are several items"!=result&&PlaySQL.Requirements.macroPropertyPanel.insertMacro()},tinymce.activeEditor.addCommand("ryInsertMacro",(function(){ExtendedMode.fetch(),PlaySQL.Requirements.macroPropertyPanel.insertMacros()})),PlaySQL.Requirements.macroPropertyPanel.searchForRequirement=PlaySQL.Requirements.throttle((function(){var key=$("#property-panel-requirement-key").val();if(key){var spaceKey=AJS.Meta.get("space-key");$.ajax({url:AJS.contextPath()+"/rest/reqs/1/rte/"+encodeURIComponent(spaceKey)+"/suggest2?"+$.param({q:key,suggest:3}),type:"GET",contentType:"application/json; charset=utf-8"}).done((function(data){PlaySQL.Requirements.macroPropertyPanel.suggestedKeys=PlaySQL.Requirements.macroPropertyPanel.suggestedKeys.filter((function(suggestion){return suggestion&&"LINK"==suggestion.action})),PlaySQL.Requirements.usableKey=data.isUsableKey;var suggestions=$.map(data.searchResults,(function(requirement){var link,excerpt=$("<div>",{html:requirement.htmlExcerpt}).text()||"",searchText=excerpt;excerpt=(excerpt=excerpt.replace(/\s+/g," ")).length>103?excerpt.substr(0,100)+"...":excerpt;var url=requirement.genericUrl||null;return link=url?$("<span>",{html:$("<a>",{href:AJS.contextPath()+url,html:"&#8663",title:"This hyperlink goes to the requirement itself. You probably want to click on the black text instead, to select the requirement. Just saying.",target:"_blank"})}).html()+" <b>"+AJS.escapeHtml(requirement.key)+"</b>":AJS.escapeHtml(requirement.key),requirement.spaceKey&&requirement.spaceKey!=spaceKey&&(link+=" (in space "+AJS.escapeHtml(requirement.spaceKey)+")"),{html:link+": "+AJS.escapeHtml(excerpt),searchText:searchText,key:requirement.key,spaceKey:requirement.spaceKey,action:"LINK"}}));if(data.suggestedKeys){var _step,_iterator=_createForOfIteratorHelper(data.suggestedKeys);try{for(_iterator.s();!(_step=_iterator.n()).done;){var suggestedKey=_step.value;suggestions.push({html:"Create "+AJS.escapeHtml(suggestedKey||""),searchText:suggestedKey,key:suggestedKey,spaceKey:spaceKey,action:"CREATE"})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}addSuggestedKeys(suggestions),showMessages(data.messages)}))}}),600),PlaySQL.Requirements.macroPropertyPanel.addSuggestedKeys=addSuggestedKeys,PlaySQL.Requirements.macroPropertyPanel.updateSuggestions=updateSuggestions,AJS.Confluence.PropertyPanel.Macro.registerInitHandler((function(macroNode,buttons){var parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters"));var i,query=parameters.query,columnsJson=parameters.columnsJson,savedQueryId=parameters.savedQueryId;query||columnsJson||savedQueryId?function(){function transformHtmlLinksToRequirementsLink(){function transformIntoStatusMacro(text){return function(lozenge){var parameters={colour:"Link"===text?"Yellow":"Blue",title:text};PlaySQL.Requirements.macroPropertyPanel.insertMacroWithParams("status",parameters,lozenge)}}function forEach(nodeList,callback){for(var i=0;i<nodeList.length;i++)callback(nodeList[i])}var currentSpaceKey=AJS.Meta.get("space-key"),baselinesName=tinymce.activeEditor.contentDocument.querySelectorAll(".requirement-baseline-name"),jiraLozenge=tinymce.activeEditor.contentDocument.querySelectorAll(".requirement-jira-lozenge"),dependencyLozenge=tinymce.activeEditor.contentDocument.querySelectorAll(".requirement-dependency-lozenge"),pageLinkLozenge=tinymce.activeEditor.contentDocument.querySelectorAll(".requirement-link-lozenge"),links=tinymce.activeEditor.contentDocument.querySelectorAll(".requirement-link-macro");forEach(baselinesName,(function(baseline){$(baseline).remove()})),forEach(links,(function(link){var $link=$(link),spaceKey=$link.attr("data-space-key"),key=$link.attr("data-requirement-key"),baseline=$link.attr("data-requirement-baseline"),parameters={freetext:"Link",key:RY.encodeMacroParam(key),spaceKey:spaceKey,type:"LINK",baseline:baseline};parameters.spaceKey===currentSpaceKey&&delete parameters.spaceKey,parameters.baseline||delete parameters.baseline,PlaySQL.Requirements.macroPropertyPanel.insertMacroWithParams("requirement",parameters,link)})),forEach(dependencyLozenge,(function(lozenge){var $lozenge=$(lozenge),$a=$lozenge.parent().find("a"),$relationship=$lozenge.parent().find("span.requirement-dependency-relationship");if($a.length){var spaceKey,baseline,key=$a.find("span.requirement-dependency-key").text().trim(),$spaceKey=$a.find("span.requirement-cross-space-key");$spaceKey.size()&&(spaceKey=$spaceKey.text().trim());var $baseline=$a.find("span.requirement-dependency-baseline");$baseline.size()&&(baseline=$baseline.text().trim());var parameters={freetext:"Link",key:RY.encodeMacroParam(key),type:"LINK",spaceKey:spaceKey};spaceKey||delete parameters.spaceKey,baseline&&(parameters.baseline=baseline),$lozenge.remove(),$relationship.size()&&$relationship.remove(),PlaySQL.Requirements.macroPropertyPanel.insertMacroWithParams("requirement",parameters,$a[0])}})),forEach(pageLinkLozenge,transformIntoStatusMacro("Link")),forEach(jiraLozenge,transformIntoStatusMacro("Jira"))}for(i=0;i<buttons.length;i++)"macro-property-panel-ry-report-transform-to-static-html"===buttons[i].className&&(buttons[i].click=function(){var url,spaceKey=parameters.spaceKey||AJS.Meta.get("space-key"),params={};parameters.query&&(params.query=parameters.query),params.includeDeleted="true"==parameters.includeDeleted,params.withJira=parameters.withJira,params.ceoId=AJS.Meta.get("content-id"),columnsJson||parameters.savedQueryId?(parameters.savedQueryId&&(params.savedQueryId=parameters.savedQueryId),parameters.savedQuerySpaceKey&&(params.savedQuerySpaceKey=parameters.savedQuerySpaceKey),params.columnsJson=parameters.columnsJson,url=AJS.contextPath()+"/rest/reqs/1/rte/"+encodeURIComponent(spaceKey)+"/traceability/transform-to-html?"+$.param(params)):(parameters.columns&&(params.columns=parameters.columns),params.sameSpace="false"!==parameters.sameSpace,url=AJS.contextPath()+"/rest/reqs/1/rte/"+encodeURIComponent(spaceKey)+"/report/transform-to-html?"+$.param(params));var $macroNode=$(macroNode);$.ajax({url:url,type:"GET",success:function(html){html=(html=(html=(html=(html=(html=(html=(html=html.replace(/[\s][\s]+/g," ")).replace(/<\/li>[\s]+/g,"</li>")).replace(/<\/ul>[\s]+/g,"</ul>")).replace(/<\/td>[\s]+/g,"</td>")).replace(/<\/tr>[\s]+/g,"</tr>")).replace(/(<t[dh][ a-zA-Z"=-]*>)[\s]+/g,"$1")).replace(/<ul>[\s]+/g,"<ul>")).replace(/<li>[\s]+/g,"<li>"),$macroNode.after(html),$macroNode.remove(),AJS.Confluence.PropertyPanel.destroy(),transformHtmlLinksToRequirementsLink()},error:RY.createXHRErrorHandler("Error while transforming the macro into a static content:")})})}():buttons.splice(function(buttons,className){for(var i=0;i<buttons.length;i++)if(buttons[i].className==className)return i;return 1/0}(buttons,"macro-property-panel-ry-report-transform-to-static-html"),1)}),"requirement-report"),window.setTimeout((function(){$("a.requirement-macro, a.requirement-link-macro",AJS.Rte.getEditor().getDoc()).removeClass("requirement-macro requirement-link-macro aui-label requirement-needs-excerpt conf-macro output-inline")}),5e3),AJS.Confluence.PropertyPanel.Macro.registerInitHandler((function(macroNode,buttons){function getIndexOfButton(buttons,className){for(var i=0;i<buttons.length;i++)if(buttons[i].className==className)return i;return 1/0}var html;buttons.splice(getIndexOfButton("macro-placeholder-property-panel-edit-button"),1);var parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters")),spaceKey=AJS.Meta.get("space-key");if(parameters&&parameters.key){var deleteMacro;!function(){var reqKey=RY.decodeMacroParam(parameters.key);for(i=0;i<buttons.length;i++)"macro-property-panel-requirement-key"!=buttons[i].className?"macro-placeholder-property-panel-remove-button"==buttons[i].className?(deleteMacro=buttons[i].click,buttons[i].click=function(){"DEFINITION"===parameters.type&&($.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+encodeURIComponent(spaceKey)+"/"+encodeURIComponent(reqKey),type:"DELETE"}),PlaySQL.Requirements.macroPropertyPanel.suggestedKeys=PlaySQL.Requirements.macroPropertyPanel.suggestedKeys.filter((function(suggestion){return suggestion.key!==reqKey}))),deleteMacro()}):"macro-property-panel-requirement-view-detail"==buttons[i].className?(buttons[i].text="View detail of "+reqKey,buttons[i].href=AJS.contextPath()+"/requirementyogi/list.action?"+$.param({key:parameters.spaceKey||spaceKey,queryString:reqKey}),buttons[i].click=function(){window.open(this.href,"_blank")}):"macro-property-panel-requirement-transform-to-link"===buttons[i].className?"DEFINITION"===parameters.type?buttons[i].click=function($button,macroNode){toggleRequirementsTypeTo("link",macroNode),AJS.Confluence.PropertyPanel.destroy()}:(buttons.splice(i,1),i--):"macro-property-panel-requirement-transform-to-definition"===buttons[i].className?"DEFINITION"===parameters.type?(buttons.splice(i,1),i--):buttons[i].click=function($button,macroNode){toggleRequirementsTypeTo("definition",macroNode),AJS.Confluence.PropertyPanel.destroy()}:"macro-property-panel-requirement-change-version"==buttons[i].className&&("DEFINITION"===parameters.type?(buttons.splice(i,1),i--):(buttons[i].click=function($button,macroNode){$.ajax({url:AJS.contextPath()+"/rest/reqs/1/misc/"+encodeURIComponent(parameters.spaceKey||spaceKey)+"/history?"+$.param({reqs:[reqKey],expand:"excerpt"}),type:"GET",dataType:"json"}).done((function(data){var $button=$(".macro-panel .panel-buttons .aui-button").last(),history=data[reqKey];history&&($("#property-panel-requirement-detail, #property-panel-select-baseline").remove(),$button.after(PlaySQL.Requirements.Rte.selectBaselineInHistory({history:history,current:parameters.baseline})),$("#property-panel-select-baseline").on("click",".ry-select-baseline",(function(){var value=$(this).attr("data-baseline");value?parameters.baseline=value:delete parameters.baseline;var $macroNode=$(macroNode);$macroNode.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(parameters));var macroName=$macroNode.attr("data-macro-name");tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId(),macro:{name:macroName,params:parameters,defaultParameterValue:"",body:void 0}},macroNode),AJS.Confluence.PropertyPanel.destroy()})))}))},parameters.baseline&&(buttons[i].text="v. "+parameters.baseline))):(buttons.splice(i,1),i--);fetchRequirementDetails(macroNode,parameters,parameters.spaceKey||spaceKey)}()}else{var viewRequirementButton=buttons.splice(getIndexOfButton("macro-property-panel-requirement-key"),1)[0];html='<input id="property-panel-requirement-key" class="editable last first" autocomplete="off" ',window.MSInputMethodContext&&document.documentMode?html+=">":html+='placeholder="Enter requirement key">',html+='<ul id="property-panel-requirement-ul"><li data-key="REQ-001">Example: REQ-001</li></ul>',viewRequirementButton.html=html,buttons.push(viewRequirementButton);for(var i=0;i<buttons.length;i++)switch(buttons[i].className){case"macro-property-panel-requirement-transform-to-definition":case"macro-property-panel-requirement-transform-to-link":case"macro-property-panel-requirement-view-detail":case"macro-property-panel-requirement-change-version":buttons.splice(i,1),i--}PlaySQL.Requirements.macroPropertyPanel.suggestedKeys=PlaySQL.Requirements.macroPropertyPanel.suggestedKeys.filter((function(suggestion){return suggestion&&"LINK"==suggestion.action})),window.setTimeout((function(){!function(macroNode){function chooseItem($inputBox){var key=$inputBox.val(),spaceKey=$inputBox.attr("data-space-key"),action=$inputBox.attr("data-action");if(ExtendedMode.isValidRequirementKey(key)){if(null==spaceKey&&(spaceKey=AJS.Meta.get("space-key")),AJS.Confluence.PropertyPanel.destroy(),"template"===AJS.Meta.get("content-type")&&"LINK"!==action){var parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters"));return parameters.keyTemplate=RY.encodeMacroParam(key),parameters.type="DEFINITION",void insertMacro({name:"requirement",params:parameters},macroNode)}var preconfiguredAjaxCall=ajaxToCreateRequirements(spaceKey,key,(function(data){if(data.status)switch(data.status){case"CREATED":(parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters"))).key=RY.encodeMacroParam(key),parameters.type="DEFINITION",delete parameters.keyTemplate,insertMacro({name:"requirement",params:parameters},macroNode);break;case"CONFLICT":var parameters;(parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters"))).key=RY.encodeMacroParam(key),parameters.type="LINK",parameters.freetext="Link",spaceKey!=AJS.Meta.get("space-key")&&(parameters.spaceKey=spaceKey),delete parameters.keyTemplate;var existingRequirement=data.reqList&&data.reqList[0];existingRequirement.key&&(parameters.key=RY.encodeMacroParam(existingRequirement.key),insertMacro({name:"requirement",params:parameters},macroNode));break;case"DELETED_KEY":deletedKeysHandler(preconfiguredAjaxCall,{});break;default:alert("Couldn't create this requirement key. Try again or check whether this requirement exists.")}}),(function(jqXHR,errorMessage,errorObject){402==jqXHR.status?alert("Couldn't create the requirement for the following reason: "+jqXHR.responseText):alert("Couldn't create this requirement key: "+RY.extractMessageFromXHR(jqXHR,300))}));preconfiguredAjaxCall()}function insertMacro(macroDetails,macroNode){var selectedMacro=macroNode||getSelectedNewMacro();selectedMacro&&(PlaySQL.Requirements.macroPropertyPanel.insertMacroWithParams(macroDetails.name,macroDetails.params,selectedMacro),AJS.Rte.BookmarkManager.restoreBookmark())}}$("#property-panel-requirement-key").on("keypress",(function(e){13===e.which&&chooseItem($(this))})).on("keydown",(function(e){if(40===e.which||38===e.which){e.preventDefault();var $li,$inputBox=$(this),$allLis=$inputBox.parent().find("li");if(0===$allLis.length)return!1;if(0===$allLis.filter(".selected").length?$li=40===e.which?$allLis.first().addClass("selected"):$allLis.last().addClass("selected"):($li=$allLis.filter(".selected").removeClass("selected"),$li=40===e.which?$li.next().addClass("selected"):$li.prev().addClass("selected")),$li&&$li.length>0){$inputBox.val($li.attr("data-key")),$inputBox.attr("data-space-key",$li.attr("data-space-key")),$inputBox.attr("data-action",$li.attr("data-action"));var li=$li[0],ul=$li.parent()[0];ul.scrollTop=Math.max(0,li.offsetTop-ul.offsetTop-10)}return!1}})).on("input",(function(e){$(this).attr("data-space-key",null),$(this).attr("data-action",null),PlaySQL.Requirements.macroPropertyPanel.updateSuggestions(),PlaySQL.Requirements.macroPropertyPanel.searchForRequirement()})),window.setTimeout((function(){$("#property-panel-requirement-key").focus(),window.setTimeout((function(){$("#property-panel-requirement-key").focus()}),50)}),0),$("#property-panel-requirement-key").parent().on("click","li",(function(e){var $target=$(e.target);if(!$(e.target).is("a")){var $li=$(this),key=$li.attr("data-key"),spaceKey=$li.attr("data-space-key"),action=$li.attr("data-action"),$inputBox=$("#property-panel-requirement-key");return key?($target.addClass("selected"),$inputBox.val(key),$inputBox.attr("data-space-key",spaceKey),$inputBox.attr("data-action",action),chooseItem($inputBox),!1):void 0}}))}(macroNode),searchOnThePage((function(suggestions){suggestions.length>0&&addSuggestedKeys(suggestions)}),parameters.keyTemplate)}),0)}}),"requirement"),$(document).on("postPaste",(function(event,plugin,pasteData){function parseUri(str){for(var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,(function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)})),uri}parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};if(pasteData&&pasteData.node){var $links=$(pasteData.node).find("a");$links.filter("a.requirement-macro, a.requirement-link-macro").removeClass("requirement-macro requirement-link-macro aui-label requirement-needs-excerpt conf-macro output-inline");var replacements=[],stamp=(new Date).getTime();$links.each((function(){try{if(!this.href||"string"!=typeof this.href)return;var macroData=function(uri){if(!isConfluence(uri))return;if(0==uri.path.indexOf(AJS.contextPath()+"/requirementyogi/traceability.action"))return function(uri){var json=RY.decodedQueryParam("traceabilityMatrixColumnsJson",uri),spaceKey=RY.decodedQueryParam("key",uri),savedQueryId=RY.decodedQueryParam("savedQueryId",uri),savedQuerySpaceKey=RY.decodedQueryParam("savedQuerySpaceKey",uri),sort=RY.decodedQueryParam("sort",uri),limit=RY.decodedQueryParam("limit",uri),queryString=RY.decodedQueryParam("queryString",uri),includeDeleted=RY.decodedQueryParam("includeDeleted",uri),withJira=RY.decodedQueryParam("withJira",uri),params={};queryString&&(params.query=queryString);sort&&(params.orderBy=sort);limit&&(params.limit=limit);includeDeleted&&(params.includeDeleted=includeDeleted);withJira&&(params.withJira=withJira);json&&(params.columnsJson=RY.btoa(json));savedQueryId?(params.savedQueryId=savedQueryId,params.savedQuerySpaceKey=savedQuerySpaceKey||spaceKey):spaceKey&&(params.spaceKey=spaceKey);return params.freetext="Traceability Matrix",{name:"requirement-report",params:params}}(uri);if(0==uri.path.indexOf(AJS.contextPath()+"/requirementyogi/estimate.action"))return void console.log("Insert as a macro for estimates is not supported.");if(0==uri.path.indexOf(AJS.contextPath()+"/requirementyogi/list.action"))return function(uri){var spaceKey=RY.decodedQueryParam("key",uri),queryString=RY.decodedQueryParam("queryString",uri),includeDeleted=RY.decodedQueryParam("includeDeleted",uri),params={};params.query=queryString||"key ~ '%'";includeDeleted&&(params.includeDeleted=includeDeleted);spaceKey&&(params.spaceKey=spaceKey);return{name:"requirement-report",params:params}}(uri);if(0==uri.path.indexOf(AJS.contextPath()+"/requirementyogi/diff.action"))return function(uri){var jsonParams=RY.decodedQueryParam("diffConfig",uri);if(jsonParams){var params={};params.diffJson=RY.btoa(jsonParams),params.freetext="RY Diff";var limit=parseInt(RY.decodedQueryParam("limit",uri))||void 0;limit&&(params.limit=limit);var macro={name:"requirement-report",params:params}}return macro}(uri);if(0==uri.path.indexOf(AJS.contextPath()+"/requirements/"))return function(uri){var macro,prefix=AJS.contextPath()+"/requirements/";uri.subpath=uri.path.substr(prefix.length);var parts=uri.subpath.split("/");if(2!=parts.length&&3!=parts.length)return null;var spaceKey=RY.decodeURIComponent(parts[0]);spaceKey!=AJS.Meta.get("space-key")&&spaceKey||(spaceKey=void 0);var requirementKey=RY.decodeURIComponent(parts[1]);if(!requirementKey)return null;if(2==parts.length)macro={name:"requirement",params:{key:RY.encodeMacroParam(requirementKey),spaceKey:spaceKey,type:"LINK",freetext:"Link"}};else{var baseline=parts[2];macro={name:"requirement",params:{key:RY.encodeMacroParam(requirementKey),spaceKey:spaceKey,baseline:baseline,type:"LINK",freetext:"Link"}}}return macro}(uri);function isConfluence(uri){if(!uri)return!1;var isConfluence=!0;return isConfluence=(isConfluence=isConfluence&&uri.authority===document.location.host)&&(!AJS.contextPath()||0===uri.path.indexOf(AJS.contextPath()))}}(parseUri(this.href.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")));if(macroData){macroData.defaultParameterValue="",macroData.body=void 0;var tempNodeId="tmp-node-id-"+ ++stamp;this.setAttribute("id",tempNodeId),replacements.push({id:tempNodeId,data:macroData})}}catch(err){AJS.error("Error while trying to transform links in the pasted data",err)}})),replacements.length>0&&window.setTimeout((function next(){if(replacements.length>0){var replacement=replacements.pop(),element=$("#"+replacement.id,AJS.Rte.getEditor().getDoc())[0];element?tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId(),macro:replacement.data},element).always(next):next()}}),0)}})),AJS.Confluence.PropertyPanel.Macro.registerInitHandler((function(macroNode,buttons){var parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters")),button=buttons.splice(1,1);buttons.push(button);var texts=[];parameters.property?parameters.value?texts.push(parameters.property+" = '"+parameters.value+"'"):texts.push("Column name: "+parameters.property):"true"==parameters.title&&texts.push("Used for title"),"true"==parameters.wholedoc?"true"==parameters.ignore?texts.push("Ignore all columns in this document"):texts.push("Applies to whole document"):"true"==parameters.ignore&&"true"==parameters.ignoreDependencies?texts.push("Column is ignored for properties"):"true"==parameters.ignore?texts.push("Column used for dependencies"):"true"==parameters.ignoreDependencies&&texts.push("Column used for properties"),button.className="property-panel-ry-property-summary",button.text=texts.join(", "),window.setTimeout((function(){$(".property-panel-ry-property-summary").replaceWith((function(){return $("<span>",{class:"property-panel-ry-property-summary last",html:$(this).contents()})}))}),0)}),"requirement-property");var updateRYReportMacroDescriptionInterval=void 0;function updateRYReportMacroDescription(){try{var macroIframe=getIframe("macro-preview")}catch(err){updateRYReportMacroDescriptionInterval&&clearInterval(updateRYReportMacroDescriptionInterval)}var $hiddenSpan=$("#ry-report-macro-baseline-flag",macroIframe);if(0!=$hiddenSpan.size()){var baseline=$hiddenSpan.attr("data-baseline");try{var parentIframe=getIframe("parent")}catch(error){updateRYReportMacroDescriptionInterval&&clearInterval(updateRYReportMacroDescriptionInterval)}var query=$("#macro-param-div-query .macro-param-input",parentIframe).val(),$description=$("#macro-param-div-query .macro-param-desc",parentIframe);if(-1!=query.indexOf("$currentBaseline")){var text="On this page, this query is equivalent to: "+(query=query.replace(/\$currentBaseline/g,baseline));$description.text()!=text&&$description.text(text)}else $description.text("Use the search tool to test this query.")}}function openTabWithTraceabilityMatrix(parameters){if(parameters){var url=null;parameters.columnsJson?url=AJS.contextPath()+"/requirementyogi/traceability.action?"+$.param({key:parameters.spaceKey||AJS.Meta.get("space-key"),queryString:parameters.query||"",json1:parameters.columnsJson,limit:void 0,orderBy:parameters.sort}):parameters.savedQueryId&&(url=AJS.contextPath()+"/requirementyogi/traceability.action?"+$.param({key:parameters.savedQuerySpaceKey||AJS.Meta.get("space-key"),savedQueryId:parameters.savedQueryId,limit:void 0,orderBy:parameters.sort})),url&&window.open(url,"_blank")}}function removeToggleRequirementsTypeDialog(){AJS.dialog2("#transform-requirements-type").hide(),$("#transform-requirements-type").remove()}function toggleRequirementsTypeTo(type,macroNode){if("LINK"!==(type=type.toUpperCase())&&"DEFINITION"!==type)throw new TypeError("The type should be either link or definition");var originalMacros=function(type){if("LINK"!==(type=type.toUpperCase())&&"DEFINITION"!==type)throw new TypeError("The type should be either link or definition");var deserializedMacroParams,macros=[];return $(".editor-inline-macro[data-macro-parameters$='type="+type+"']",AJS.Rte.getEditor().getDoc()).each((function(index,macro){(deserializedMacroParams=Confluence.MacroParameterSerializer.deserialize(macro.getAttribute("data-macro-parameters"))).spaceKey||macros.push({params:deserializedMacroParams,macroNode:macro})})),macros}("DEFINITION"===type?"LINK":"DEFINITION").sort((function(a,b){return a.params.key<b.params.key?-1:a.params.key>b.params.key?1:0}));$("body").append(PlaySQL.Requirements.Rte.toggleRequirementsTypeDialog({macros:originalMacros.map((function(macro){return{key:RY.decodeMacroParam(macro.params.key),selected:macro.macroNode===macroNode}})),type:type})),AJS.dialog2("#transform-requirements-type").on("show",(function(){$("#select-all-requirements").on("click",(function(e){e.preventDefault();var isSelected="select"===$(this).attr("data-action");isSelected?($(this).text("Deselect All"),$(this).attr("data-action","deselect")):($(this).text("Select All"),$(this).attr("data-action","select")),$(".toggle-requirements-type-checkbox").each((function(index,element){isSelected?$(element).attr("checked","on"):$(element).removeAttr("checked")}))})),$("#select-guessed-requirements").on("click",(function(e){e.preventDefault();var listDefinitions=new Set;$(".toggle-requirements-type-checkbox").each((function(){var $checkbox=$(this),key=$checkbox.attr("name");listDefinitions.has(key)?$checkbox.attr("checked","on"):(listDefinitions.add(key),$checkbox.removeAttr("checked"))}))})),$("#toggle-requirements-type").on("click",(function(event){event.preventDefault();var allElements=[];$(".toggle-requirements-type-checkbox").each((function(index,element){!function(key,isChecked,allElements){for(var found=!1,i=allElements.length-1;i>=0;i--)if(allElements[i].key===key){found=!0;break}found?allElements[i].checkedOccurrences.push(isChecked):allElements.push({key:key,checkedOccurrences:[isChecked]})}(element.getAttribute("name"),$(element).is(":checked"),allElements)}));var checkedElements=allElements.filter((function(element){return element.checkedOccurrences.reduce((function(a,b){return a||b}))}));checkedElements.forEach((function(element){!function(key,checkedOccurrences,originalMacros){for(var occurrence=-1,i=0;i<originalMacros.length;i++)if(RY.decodeMacroParam(originalMacros[i].params.key)===key&&checkedOccurrences[++occurrence]){var parameters,$macroNode;parameters=originalMacros[i].params,$macroNode=$(originalMacros[i].macroNode),parameters.type=type,parameters.freetext="DEFINITION"===type?"":"Link",$macroNode.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(parameters));var macroName=$macroNode.attr("data-macro-name");tinymce.confluence.MacroUtils.insertMacro({contentId:Confluence.Editor.getContentId(),macro:{name:macroName,params:parameters,defaultParameterValue:"",body:void 0}},originalMacros[i].macroNode)}}(element.key,element.checkedOccurrences,originalMacros)})),removeToggleRequirementsTypeDialog()}))})).on("hide",removeToggleRequirementsTypeDialog).show(),AJS.$("#close-transform-requirements-type").click(removeToggleRequirementsTypeDialog)}AJS.MacroBrowser.setMacroJsOverride("requirement-report",{updateMacroParametersForPreview:function(params){return null==updateRYReportMacroDescriptionInterval&&(updateRYReportMacroDescriptionInterval=window.setInterval(updateRYReportMacroDescription,2e3)),params},beforeParamsSet:function(paramMap,inserting){if(paramMap.diffJson){paramMap.diffJson=RY.atob(paramMap.diffJson);try{var diffJson=JSON.parse(paramMap.diffJson);void 0!==diffJson.queryString&&void 0!==diffJson.queryString2&&(paramMap.query=diffJson.queryString,paramMap.queryForDiff=diffJson.queryString2,delete diffJson.queryString,delete diffJson.queryString2,paramMap.diffJson=JSON.stringify(diffJson))}catch(err){}}var hiddenFields,title;switch(paramMap.columnsJson&&(paramMap.columnsJson=RY.atob(paramMap.columnsJson),paramMap.columns="(Not editable)"),paramMap.diffJson?"DIFF":paramMap.savedQueryId?"SAVED_QUERY":paramMap.columnsJson?"TRACEABILITY":"SEARCH"){case"DIFF":hiddenFields=["includeDeleted","sameSpace","columns","columnsJson","savedQueryId","savedQuerySpaceKey","sort","display"],title="RY Report: Diff (not editable)";break;case"SEARCH":hiddenFields=["queryForDiff","diffJson","columnsJson","savedQueryId","savedQuerySpaceKey"];break;case"SAVED_QUERY":title="RY Report: Saved traceability matrix",hiddenFields=["queryForDiff","query","diffJson","columns","columnsJson","display"];break;case"TRACEABILITY":title="RY Report: Traceability matrix",hiddenFields=["queryForDiff","diffJson","columns","savedQueryId","savedQuerySpaceKey","display"]}return window.setTimeout((function(){if(title){var div=$("#macro-details-page .macro-desc")[0];div&&2===div.childNodes.length&&(div.childNodes[0].textContent=title+" \n")}if(hiddenFields)for(var i=0;i<hiddenFields.length;i++){var _div=document.getElementById("macro-param-div-"+hiddenFields[i]);_div&&$(_div).addClass("hidden")}}),0),paramMap},beforeParamsRetrieved:function(paramMap,macro,sharedParamMap){if(paramMap.diffJson){var diffJson=paramMap.diffJson;try{var diffJsonParsed=JSON.parse(diffJson);diffJsonParsed.queryString=paramMap.query,diffJsonParsed.queryString2=paramMap.queryForDiff,delete paramMap.query,delete paramMap.queryForDiff,diffJson=JSON.stringify(diffJsonParsed)}catch(err){}paramMap.diffJson=RY.btoa(diffJson)}return paramMap.columnsJson&&(paramMap.columnsJson=RY.btoa(paramMap.columnsJson),paramMap.columns=""),paramMap}}),AJS.Confluence.PropertyPanel.Macro.registerInitHandler((function(macroNode,buttons){for(var i=0;i<buttons.length;i++){var button=buttons[i];if("macro-placeholder-property-panel-edit-button"==button.className){var parameters=Confluence.MacroParameterSerializer.deserialize($(macroNode).attr("data-macro-parameters"));parameters&&(parameters.columnsJson||parameters.savedQueryId)&&(button.className="macro-placeholder-property-panel-view-button",button.text="View in traceability matrix",button.click=function($button,macroNode){openTabWithTraceabilityMatrix(parameters)})}}}),"requirement-report")}))}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.playsql.requirementyogi:requirement-rte', location = 'js/requirement-rte.soy' */
// This file was automatically generated from requirement-rte.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace PlaySQL.Requirements.Rte.
 */

if (typeof PlaySQL == 'undefined') { var PlaySQL = {}; }
if (typeof PlaySQL.Requirements == 'undefined') { PlaySQL.Requirements = {}; }
if (typeof PlaySQL.Requirements.Rte == 'undefined') { PlaySQL.Requirements.Rte = {}; }


PlaySQL.Requirements.Rte.detailRte = function(opt_data, opt_ignored) {
  var output = '';
  if (! opt_data.isOriginal || opt_data.requirement.references.length != 0 || opt_data.requirement.issues.length != 0) {
    output += '<div id="property-panel-requirement-detail">' + ((! opt_data.isOriginal) ? '<div class="quote">&#8220;</div><p>' + PlaySQL.Requirements.Rte.checkboxRte(soy.$$augmentMap(opt_data, {field: 'description'})) + soy.$$filterNoAutoescape(opt_data.requirement.htmlExcerpt) + '</p>' : '');
    if (opt_data.requirement.references.length != 0 || opt_data.requirement.issues.length != 0 || opt_data.requirement.properties.length != 0) {
      output += '<p>See also:</p><ul>';
      if (! opt_data.isOriginal && opt_data.requirement.properties.length != 0) {
        var propertyList19 = opt_data.requirement.properties;
        var propertyListLen19 = propertyList19.length;
        for (var propertyIndex19 = 0; propertyIndex19 < propertyListLen19; propertyIndex19++) {
          var propertyData19 = propertyList19[propertyIndex19];
          output += (propertyData19.display) ? '<li>' + PlaySQL.Requirements.Rte.checkboxRte(soy.$$augmentMap(opt_data, {field: '@' + propertyData19.key})) + soy.$$escapeHtml(propertyData19.key) + ': ' + soy.$$filterNoAutoescape(propertyData19.value) + '</li>' : '';
        }
      }
      output += (opt_data.requirement.origin) ? '<li><a href="' + soy.$$escapeHtml(opt_data.requirement.origin.url) + '">' + soy.$$escapeHtml(opt_data.requirement.origin.title) + '</a> (Original definition)</li>' : '';
      var linkList38 = opt_data.requirement.references;
      var linkListLen38 = linkList38.length;
      for (var linkIndex38 = 0; linkIndex38 < linkListLen38; linkIndex38++) {
        var linkData38 = linkList38[linkIndex38];
        output += '<li><a href="' + soy.$$escapeHtml(linkData38.url) + '">' + soy.$$escapeHtml(linkData38.title) + '</a>&nbsp;' + ((linkData38.pageId == opt_data.currentPageId) ? '(This page)' : '(Link)') + '</li>';
      }
      var linkList51 = opt_data.requirement.issues;
      var linkListLen51 = linkList51.length;
      for (var linkIndex51 = 0; linkIndex51 < linkListLen51; linkIndex51++) {
        var linkData51 = linkList51[linkIndex51];
        output += '<li><a href="' + soy.$$escapeHtml(linkData51.url) + '">' + soy.$$escapeHtml(linkData51.issueKey) + '</a> ' + soy.$$escapeHtml(linkData51.title) + ' <span class="aui-lozenge aui-lozenge-new">Jira</span> (' + soy.$$escapeHtml(linkData51.relationship) + ')</li>';
      }
      output += '</ul>';
    }
    output += '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.Rte.detailRte.soyTemplateName = 'PlaySQL.Requirements.Rte.detailRte';
}


PlaySQL.Requirements.Rte.checkboxRte = function(opt_data, opt_ignored) {
  return '<input type="checkbox" name="' + soy.$$escapeHtml(opt_data.field) + '" class="checkbox property-panel-visible-fields" ' + ((('' + opt_data.fields).indexOf('' + (opt_data.field + ',')) != -1) ? ' checked="on" ' : '') + ' />';
};
if (goog.DEBUG) {
  PlaySQL.Requirements.Rte.checkboxRte.soyTemplateName = 'PlaySQL.Requirements.Rte.checkboxRte';
}


PlaySQL.Requirements.Rte.insertionOptionsInRte = function(opt_data, opt_ignored) {
  return '<section id="ry-insertion-options-dialog" class="aui-dialog2 aui-dialog2-medium" data-aui-remove-on-hide="true" data-aui-focus-selector="' + ((opt_data.isSeeminglyNumbered) ? '#ry-insertion-prefix-2' : '#ry-insertion-prefix') + '" role="dialog"><!-- Dialog header --><header class="aui-dialog2-header"><!-- The dialog\'s title --><h2 class="aui-dialog2-header-main">Insert the Requirement macro</h2><!-- Close icon --><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Close</span></a></header><!-- Main dialog content --><div class="aui-dialog2-content"><form class="aui"><p>This will create one macro for each of the ' + soy.$$escapeHtml(opt_data.quantity) + ' lines.</p><p class="ry-insertion-errors" style="color: red;"></p>' + ((opt_data.isSeeminglyNumbered) ? '<fieldset class="group"><legend><span>Mode</span></legend><div class="radio"><input class="radio" type="radio" name="mode" id="mode-selection" checked><label for="mode-selection">Use selected text as keys</label><div class="description">Requires that the selected text already contains numbered requirements with a prefix.</div></div><div class="radio"><input class="radio" type="radio" name="mode" id="mode-generate"><label for="mode-generate">Generate numbers automatically</label><div class="description">The macros will be inserted before the selection.</div></div></fieldset>' : '') + '<div class="field-group ' + ((opt_data.isSeeminglyNumbered) ? 'hidden' : '') + ' show-if-mode-generate"><label for="ry-insertion-prefix">Prefix and first number</label><input class="text medium-field" type="text" id="ry-insertion-prefix" name="ry-insertion-prefix" value="' + soy.$$escapeHtml(opt_data.prefix) + '"><input class="text short-field" type="number" id="ry-insertion-number" name="ry-insertion-number" value="' + soy.$$escapeHtml(opt_data.number) + '"  min="0"><div class="description">(Mandatory) A prefix, and the first number of your requirements. Don\'t forget to pad with leading 0s, so requirements are sorted when in alphabetical order.</div></div>' + ((opt_data.isSeeminglyNumbered) ? '<div class="field-group show-if-mode-selection"><label for="ry-insertion-prefix-2">Prefix</label><input class="text short-field" type="text" id="ry-insertion-prefix-2" name="ry-insertion-prefix-2" value=""><input class="text short-field" type="text" value="' + soy.$$escapeHtml(opt_data.firstExample) + '" disabled><div class="description">(Optional) A prefix to insert before the requirement numbers. It is mandatory when the selection only contains numbers.</div></div>' : '') + '</form></div><!-- Dialog footer --><footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><div class="aui-dialog2-footer-actions"><button id="ry-insertion-submit" class="aui-button aui-button-primary">Insert</button><button id="ry-insertion-close" class="aui-button aui-button-link">Cancel</button></div><!-- Hint text is rendered on the left of the footer --><div class="aui-dialog2-footer-hint">Requirement Yogi (Alt + Shift + R)</div></footer></section>';
};
if (goog.DEBUG) {
  PlaySQL.Requirements.Rte.insertionOptionsInRte.soyTemplateName = 'PlaySQL.Requirements.Rte.insertionOptionsInRte';
}


PlaySQL.Requirements.Rte.selectBaselineInHistory = function(opt_data, opt_ignored) {
  var output = '<ul id="property-panel-select-baseline">';
  var itemList102 = opt_data.history;
  var itemListLen102 = itemList102.length;
  for (var itemIndex102 = 0; itemIndex102 < itemListLen102; itemIndex102++) {
    var itemData102 = itemList102[itemIndex102];
    output += '<li class="ry-select-baseline ' + ((opt_data.current == itemData102.baseline) ? ' selected ' : '') + '" data-baseline="' + soy.$$escapeHtml(itemData102.baseline != null ? itemData102.baseline : '') + '">' + ((itemData102.baseline) ? (itemData102.baselineName) ? soy.$$escapeHtml(itemData102.baselineName) + ' (v' + soy.$$escapeHtml(itemData102.baseline) + ')' : 'v. ' + soy.$$escapeHtml(itemData102.baseline) : '(current)') + '&nbsp;&ndash;&nbsp;"' + soy.$$escapeHtml(itemData102.textExcerptEllipsed) + '"' + ((itemData102.modified) ? '&nbsp;<span class="aui-lozenge aui-lozenge-new">Changed</span>' : '') + '</li>';
  }
  output += ((opt_data.history.length <= 1) ? '<li>There is no baseline for this requirement. It\'s a nice feature which helps versioning your requirements&nbsp; (<a href="https://documentation.play-sql.com/display/RY/Baselines+and+versioning" target="_blank">Documentation</a>)</li>' : '') + '</ul>';
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.Rte.selectBaselineInHistory.soyTemplateName = 'PlaySQL.Requirements.Rte.selectBaselineInHistory';
}


PlaySQL.Requirements.Rte.toggleRequirementsTypeDialog = function(opt_data, opt_ignored) {
  var output = '';
  var typeLabel__soy136 = opt_data.type == 'LINK' ? 'links' : 'definitions';
  output += '<section id="transform-requirements-type" class="aui-dialog2 aui-dialog2-medium" role="dialog" ><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">Transform requirements to ' + soy.$$escapeHtml(typeLabel__soy136) + '</h2><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Close</span></a></header><div class="aui-dialog2-content"><p>Select the macros you want to transform into ' + soy.$$escapeHtml(typeLabel__soy136) + ':</p><br /><form class="aui"><fieldset class="group" style="overflow-y: scroll;">' + ((opt_data.macros.length > 1) ? '<a href="#" id="select-all-requirements" data-action="select">Select All</a>' + ((opt_data.type == 'LINK') ? '&nbsp;&mdash;&nbsp;<a href="#" id="select-guessed-requirements">Every second definition</a>' : '') : '');
  var macroList148 = opt_data.macros;
  var macroListLen148 = macroList148.length;
  for (var macroIndex148 = 0; macroIndex148 < macroListLen148; macroIndex148++) {
    var macroData148 = macroList148[macroIndex148];
    output += '<div class="checkbox"><input class="checkbox toggle-requirements-type-checkbox" type="checkbox" name="' + soy.$$escapeHtml(macroData148.key) + '" style="margin-left: 0"' + ((macroData148.selected) ? 'checked="on"' : '') + '><label for="' + soy.$$escapeHtml(macroData148.key) + '">' + soy.$$escapeHtml(macroData148.key) + '</label></div>';
  }
  output += '</fieldset></form></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary" id="toggle-requirements-type">Transform</button><button class="aui-button aui-button-link" id="close-transform-requirements-type">Cancel</button></div><div class="aui-dialog2-footer-hint">Only requirements on this space can be transformed</div></footer></section>';
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.Rte.toggleRequirementsTypeDialog.soyTemplateName = 'PlaySQL.Requirements.Rte.toggleRequirementsTypeDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = 'templates/mentions.soy' */
// This file was automatically generated from mentions.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Mentions.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Mentions == 'undefined') { Confluence.Templates.Mentions = {}; }


Confluence.Templates.Mentions.userNotFoundResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error no-result">' + soy.$$escapeHtml('Sorry, we can\x27t find that person') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.userNotFoundResult.soyTemplateName = 'Confluence.Templates.Mentions.userNotFoundResult';
}


Confluence.Templates.Mentions.searchFailureResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error search-failure"><div class="search-failure-title">' + soy.$$escapeHtml('Something went wrong') + '</div><div class="search-failure-body">' + soy.$$escapeHtml('We can\x27t fetch people right now. Try again in a few minutes.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.searchFailureResult.soyTemplateName = 'Confluence.Templates.Mentions.searchFailureResult';
}


Confluence.Templates.Mentions.loadingPlaceholder = function(opt_data, opt_ignored) {
  return '<div class="mention-loading"><div class="avatar-placeholder"></div><div class="text-container"><div class="text-placeholder lg"></div><div class="text-placeholder sm"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.loadingPlaceholder.soyTemplateName = 'Confluence.Templates.Mentions.loadingPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js-target/bundle.js' */
define("confluence-mentions", ["ajs","confluence/meta","jquery","confluence/legacy","confluence/templates","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","tinymce","confluence/storage-manager","confluence/dark-features","confluence/analytics-support","confluence-link-browser/link-object","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_16__, __WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_37__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 20);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    exports.default = {
        CURRENT: 'current',
        RELATED: 'related',
        RECENT: 'recent',
        SERVER: 'server'
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(29), __webpack_require__(37), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _lruCache, _storageManager, _userSupplierKeys) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var LRU = _interopRequireDefault(_lruCache).default;

    var StorageManager = _interopRequireDefault(_storageManager).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Returns users from a localstorage-backed LRU (least-recently-used) cache, and adds entries to that cache.
     */
    var inMemoryCache = void 0;
    var persistentCache = void 0;

    var CACHE_PREFIX = 'mentions';
    var CACHE_ID = 'recently-mentioned-users';
    var CACHE_ITEMS_KEY = 'items';

    /**
     * The maximum number of recently-mentioned users to keep in the cache.
     * @type {number}
     */
    var RECENT_USER_LIMIT = 20;
    /**
     * WaterTightValidation means that any users at or past this expiry _must_ be refreshed before being displayed in the UI.
     * @type {{expireTimeMillis: number}}
     */
    var WATERTIGHT_VALIDATION = { expireTimeMillis: 29 * 24 * 60 * 60 * 1000 }; //29 days in millis
    /**
     * EarlyValidation means that any users at or past this expiry _should_ be refreshed after the UI is completed (so as to not block users)
     * @type {{expireTimeMillis: number}}
     */
    var EARLY_VALIDATION = { expireTimeMillis: 7 * 24 * 60 * 60 * 1000 }; //7 days in millis
    /**
     * stores the enums used for calls to {getStaleUsers()}.
     * @type {{WATERTIGHT_VALIDATION: {expireTimeMillis: number}, EARLY_VALIDATION: {expireTimeMillis: number}}}
     */
    var ValidationType = { WATERTIGHT_VALIDATION: WATERTIGHT_VALIDATION, EARLY_VALIDATION: EARLY_VALIDATION };

    // Lazy-initialise to avoid interacting with localStorage when it isn't required.
    function loadCache() {
        inMemoryCache = LRU(RECENT_USER_LIMIT);
        persistentCache = new StorageManager(CACHE_PREFIX, CACHE_ID);

        var recentUsersDump = persistentCache.getItem(CACHE_ITEMS_KEY);
        if (recentUsersDump) {
            var recentUsersJson = JSON.parse(recentUsersDump);
            inMemoryCache.load(recentUsersJson);
        }
    }

    function getUsers() {
        return new Promise(function (resolve) {
            inMemoryCache || loadCache();

            // Add users with order of most-recently-mentioned first
            var users = [];
            var index = 0;
            inMemoryCache.forEach(function (user) {
                user.supplier = UserSupplier.RECENT;
                user.role = null;
                user.sortIndex = index++;
                users.push(user);
            });
            AJS.debug('Found ' + users.length + ' recently-mentioned users');
            resolve(users);
        });
    }

    /**
     * Store a recently-mentioned User in the cache.
     * @param user
     * @param refreshed {Boolean} true if the user is from the server. This will update the timestamp of the last refresh to now().
     *                            Defaults to false if not passed in.
     */
    function store(user, refreshed) {
        inMemoryCache || loadCache();
        var oldUser = inMemoryCache.peek(user.username);
        var oldRefreshDate = oldUser ? oldUser.refreshedAt || 0 : 0;
        var refreshedAt = refreshed || !oldUser ? new Date().getTime() : oldRefreshDate;
        inMemoryCache.set(user.username, Object.assign({}, user.model ? user.model : user, { timestamp: user.timestamp, refreshedAt: refreshedAt }));
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    function remove(username) {
        inMemoryCache || loadCache();
        inMemoryCache.del(username);
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    /**
     * A stale user is one which has not been refreshed from the server for X days or more, X being calculated from the validation type.
     * @param validationType {{expireTimeMillis: number}} an enum to flag what kind of stale users to return. Use a value from ValidationType
     * @return {Array} a list of stale usersnames (NOTE: not the user objects - just the usernames)
     */
    function getStaleUsers(validationType) {
        inMemoryCache || loadCache();
        var stale = [];
        var now = new Date().getTime();
        //use a hack to iterate the keys to prevent the LRU from changing the ordering
        var existingKeys = inMemoryCache.keys();
        existingKeys.map(function (k) {
            return [inMemoryCache.peek(k), k];
        }).forEach(function (entry) {
            var val = entry[0];
            var key = entry[1];
            if (!val.refreshedAt || now - val.refreshedAt > validationType.expireTimeMillis) {
                stale.push(key);
            }
        });
        return stale;
    }

    function refresh(users) {
        inMemoryCache || loadCache();
        users.forEach(function (user) {
            if (inMemoryCache.has(user.username)) {
                var entry = inMemoryCache.peek(user.username);
                var timestamp = entry.timestamp || 0;
                //treat no timestamp as though it is stale, and refresh it
                if (!user.timestamp || !timestamp || user.timestamp > timestamp) {
                    store(user, true);
                }
            }
        });
    }

    // Used in tests
    function _clear() {
        loadCache();
    }

    exports.default = {
        getUsers: getUsers,
        store: store,
        remove: remove,
        getStaleUsers: getStaleUsers,
        refresh: refresh,
        _clear: _clear,
        RECENT_USER_LIMIT: RECENT_USER_LIMIT,
        ValidationType: ValidationType
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(41), __webpack_require__(13)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _currentUserSupplier, _userCache) {
    'use strict';

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var CurrentUserSupplier = _interopRequireDefault(_currentUserSupplier).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _slicedToArray = function () {
        function sliceIterator(arr, i) {
            var _arr = [];
            var _n = true;
            var _d = false;
            var _e = undefined;

            try {
                for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                    _arr.push(_s.value);

                    if (i && _arr.length === i) break;
                }
            } catch (err) {
                _d = true;
                _e = err;
            } finally {
                try {
                    if (!_n && _i["return"]) _i["return"]();
                } finally {
                    if (_d) throw _e;
                }
            }

            return _arr;
        }

        return function (arr, i) {
            if (Array.isArray(arr)) {
                return arr;
            } else if (Symbol.iterator in Object(arr)) {
                return sliceIterator(arr, i);
            } else {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }
        };
    }();

    "use strict";

    /**
     *
     * @param {string}   query              User's query
     * @param {object}   editor             the currently-active editor
     */
    function search(query, editor) {

        var serverUsersPromise = ServerUsersSupplier.getUsers(query);
        var relatedUsersPromise = RelatedUsersSupplier.getUsers(editor);
        var recentUsersPromise = RecentUsersSupplier.getUsers();
        var currentUserPromise = CurrentUserSupplier.getCurrentUser();

        var fastPromises = [relatedUsersPromise, recentUsersPromise, currentUserPromise];

        return {
            client: Promise.all(fastPromises).then(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 3),
                    relatedUsers = _ref2[0],
                    recentUsers = _ref2[1],
                    currentUser = _ref2[2];

                UserCache.addAll(relatedUsers);
                UserCache.addAll(recentUsers, true);
                if (currentUser) {
                    // May be undefined if anonymous.
                    UserCache.add(currentUser, true);
                }
            }),
            server: serverUsersPromise.then(function (serverUsers) {
                UserCache.addAll(serverUsers);
                RecentUsersSupplier.refresh(serverUsers);
            })
        };
    }

    function prefetchSuppliers(editor) {
        var waterTightValidationCheck = RecentUsersSupplier.getStaleUsers(RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        if (waterTightValidationCheck.length > 0) {
            //found some users whose stale for longer than 30 days. Must revalidate and delete if needed, before showing in UI.
            deleteStaleUsers(waterTightValidationCheck, RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        }
        // This will load related users into the cache in 'service/content-users/users-related-to-content'.
        RelatedUsersSupplier.getUsers(editor);
    }

    function deleteStaleUsers(usersToCheck, validationType) {
        ServerUsersSupplier._searchWithUsernames(usersToCheck).then(function (resultUsers) {
            RecentUsersSupplier.refresh(resultUsers);
            //if users are still stale after a refresh, it means they've not been returned by the server
            //time to delete 'em
            var usersToDelete = RecentUsersSupplier.getStaleUsers(validationType);
            usersToDelete.forEach(function (u) {
                return RecentUsersSupplier.remove(u);
            });
        });
    }

    // Reset any of the suppliers that hold state. Used in testing.
    function reset() {
        RelatedUsersSupplier.reset();
        ServerUsersSupplier.reset();
        RecentUsersSupplier._clear();
    }

    exports.default = {
        search: search,
        prefetchSuppliers: prefetchSuppliers,
        deleteStaleUsers: deleteStaleUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(24), __webpack_require__(25)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _draftContentSupplier, _usersRelatedToContent) {
    'use strict';

    var getDraft = _interopRequireDefault(_draftContentSupplier).default;

    var UsersRelatedToContent = _interopRequireDefault(_usersRelatedToContent).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     Returns users related to the Content currently in the Editor, optionally filtered by a search string.
    
     You can test this logic in your browser console against a running instance by running something like :
    
     `require('confluence-mentions').userSuppliers.contentRelated.getUsers().then((result) => { window.relatedUsers = result; });`
    
     and then viewing the `window.relatedUsers` value.
     */
    function getUsers(editor) {
        var content = getDraft(editor);
        return UsersRelatedToContent.getUsers(content);
    }

    /*
     We assume that all useful information is returned in the getUsersRelatedTo call.
     */
    function isExhausted() {
        return true;
    }

    // Clears the related user cache, used in testing.
    function reset() {
        UsersRelatedToContent.reset();
    }

    exports.default = {
        getUsers: getUsers,
        isExhausted: isExhausted,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _i18n) {
    'use strict';

    var I18n = _interopRequireDefault(_i18n).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var newRole = function newRole(role) {
        return {
            role: role,
            i18n: I18n('user.role.' + role)
        };
    }; /**
        A simple User Role bean that can provide its i18n'd display name.
        */
    exports.default = {
        CREATOR: newRole('creator'),
        CONTRIBUTOR: newRole('contributor'),
        COMMENTER: newRole('commenter'),
        ANCESTOR_COMMENTER: newRole('ancestorCommenter') // never shown, but available
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var i18nMap = {
        'user.role.creator': "Creator",
        'user.role.contributor': "Contributor",
        'user.role.commenter': "Commenter",
        'user.supplier.recent': "Recent"
    }; /**
        A way to get the i18nTransformer away from all-the-JS, this module allows clients to get I18n text using
        dynamic keys. Normally the i18nTransformer would fail to handle this and the developer would be forced to add
       
        "foo100"
       
        entries for each case. By extracting those invocations of AJS.I18n.getText to a single place, we can plan for a future
        where the transformer is not necessary and we can serve one set of JS resources for all locales.
       
        A future improvement might be to generate an i18n.js file directly from a plugin's
        i18n.properties file at build time.
        */

    exports.default = function (key) {
        // TODO - could interpolate args, etc. dT
        return i18nMap[key];
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 9 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(11), __webpack_require__(2), __webpack_require__(3), __webpack_require__(12), __webpack_require__(39), __webpack_require__(1), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _legacy, _meta, _jquery, _userRanker, _serverUserCache, _userSupplierKeys, _luceneQuery) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Confluence = _interopRequireDefault(_legacy).default;

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var UserRanker = _interopRequireDefault(_userRanker).default;

    var Cache = _interopRequireDefault(_serverUserCache).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var LuceneQuery = _interopRequireDefault(_luceneQuery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Wait this long after REST call triggers before actually doing a search - results in fewer HTTP requests.
     */
    var DEBOUNCE_WAIT_MS = 250;

    // 1 char query is now supported by CQL.
    var MIN_CHARS_TO_SEARCH = 1;

    var limit = 100;
    var cache = Cache(limit);

    /**
     * The id of the last timeout to be created for a REST call. We cancel this timeout if
     * a scheduled call becomes stale.
     */
    var lastTimeout = void 0;

    /**
     Returns users from the backend via a CQL search.
     */
    function getUsers(query) {
        return new Promise(function (resolve, reject) {

            if (!query || query.length < MIN_CHARS_TO_SEARCH) {
                // No query - no server results.
                return resolve([]);
            }

            AJS.debug('server-users-supplier: Looking in cache for ' + query);
            var cacheEntry = cache.getClosest(query);
            if (cacheEntry) {
                AJS.debug('server-users-supplier: Found cache entry with query ' + cacheEntry.query);
                if (cacheEntry.query === query) {
                    // Exact match - just serve these results.
                    return resolve(cacheEntry.users);
                }

                // Not an exact match. Might need a REST call, but we can show results based on what we have cached.
                var rankedUsers = UserRanker(cacheEntry.users, query);
                cache.add(query, rankedUsers);

                // TODO Always resolve with what we have from the cache - this is information that can be put in front of
                // the user immediately. We then decide whether to follow up the local results with remote ones.
                // However, we need the ability to 'resolve' multiple times - to call the render once with the cached
                // results and again (if not debounced, stale, etc, etc) with the server results.
                if (cacheEntry.isExhausted) {
                    return resolve(rankedUsers);
                }

                // Else we might be searching for "John" but "Joh" already has >={limit} users.
                // We need to hit the server!
                // TODO - can we resolve multiple times?
            }

            var contextPath = Meta.get('context-path');
            var escapedQuery = LuceneQuery.escape(query);
            var queryParameters = {
                cql: 'user ~ "' + Confluence.unescapeEntities(escapedQuery) + '"',
                start: 0,
                limit: limit
            };
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    AJS.debug('server-users-supplier: Adding user to cache: ' + user.username);
                    return user;
                });
                cache.add(query, users);
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     * Forces a search for exact usernames. Use this to ensure the cached entries in
     * other suppliers are not stale.
     * @param usernames {Array} Array of username strings
     * @returns {Promise} a promise which will resolve with an array of user objects from the search that matched any of the input usernames.
     * @private
     */
    function _searchWithUsernames(usernames) {
        return new Promise(function (resolve, reject) {
            if (!usernames || usernames.length === 0) {
                return resolve([]);
            }
            var contextPath = Meta.get('context-path');
            var queryParameters = {
                cql: 'user in (' + usernames.map(function (u) {
                    return '"' + u + '"';
                }).join(",") + ')',
                start: 0,
                limit: usernames.length
            };
            AJS.debug('querying with \'' + queryParameters.cql + '\'');
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    return user;
                });
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     If a given search returns less that the specified limit, we say that that query is exhausted - adding more
     characters to the query will return a subset of users from the shorter query.
     */
    function isExhausted(query) {
        return true;
    }

    // Flushes the cache between tests.
    function reset() {
        cache.reset();
        AJS.debug('server-users-supplier: Cache reset');
    }

    exports.default = {
        getUsers: getUsers,
        _searchWithUsernames: _searchWithUsernames,
        isExhausted: isExhausted,
        reset: reset,
        DEBOUNCE_WAIT_MS: DEBOUNCE_WAIT_MS
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(11), __webpack_require__(38)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _legacy, _fuse) {
    'use strict';

    var Confluence = _interopRequireDefault(_legacy).default;

    var Fuse = _interopRequireDefault(_fuse).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Details for these options are available at http://fusejs.io/, but the basic gist is:
     *
     * - tokenize is required so that first and last names are searched from their first character
     * - matchAllTokens so that tokenize will match all words in the query
     * - threshold close to 0 to avoid unhelpful results, but this can be tweaked because...
     * - shouldSort will put the best matches at the top of the result array.
     * - location means that matching should start at the beginning of words, which is usually
     *     what name searches will want
     */
    /**
     * Ranks users, given a query.
     */
    var options = {
        includeMatches: true,
        includeScore: true,
        tokenize: true,
        matchAllTokens: true,
        threshold: 0.1,
        location: 0,
        distance: 0,
        maxPatternLength: 16,
        minMatchCharLength: 1,
        keys: [{
            name: 'displayName',
            weight: 0.7
        }, {
            name: 'username',
            weight: 0.3
        }]
    };

    exports.default = function (users, query) {
        if (!query) {
            return users;
        }

        // TODO Depending on what kind of setup is done in the Fuse constructor, we might want to
        // optimise by keeping an instance around that has all of the users currently-known to the
        // frontend: including cached Server search results.
        var fuse = new Fuse(users, options);
        var results = fuse.search(Confluence.unescapeEntities(query));
        return results.map(function (result) {
            var item = result.item;
            item.fuseMatches = result.matches;
            item.fuseScore = result.score;
            return item;
        });
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    /**
     * Where all the aggregation and caching happens
     */
    "use strict";

    function _toConsumableArray(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {
                arr2[i] = arr[i];
            }

            return arr2;
        } else {
            return Array.from(arr);
        }
    }

    var userCache = new Map();

    /**
     * Updates the incoming User object to split "displayName" into "firstName" and "lastNames" to aid Fuse matching.
     * @param user
     * @private
     */
    function _splitNames(user) {
        if (!user || !user.displayName) {
            return;
        }

        // We store first and last names separately to enable search weightings in Fuse.
        // JS String.split doesn't quite do what we need so we just use a substring.
        var firstSpace = user.displayName.indexOf(' ');
        if (firstSpace > 0) {
            user.firstName = user.displayName.substring(0, firstSpace);
            user.lastNames = user.displayName.substring(firstSpace + 1);
        } else {
            // A user display name in a language without spaces. Setting the firstName should work in most cases.
            user.firstName = user.displayName;
            user.lastNames = '';
        }
    }

    function _isStaleEntry(user) {
        if (!userCache.has(user.username)) {
            return true;
        }
        var entry = userCache.get(user.username);
        var timestamp = entry.timestamp || 0;
        return user.timestamp > timestamp;
    }

    exports.default = {
        /**
         * Will add the user to the user cache, if it's not already present.
         * @param {user}    user     A single user in API format
         * @param {boolean} force    if true, any cached user with the same username will be replaced with this user
         */
        add: function add(user) {
            var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

            // Existing cache entries may have a different Supplier for a given user - don't overwrite.
            if (user && user.hasOwnProperty("username") && (force === true || _isStaleEntry(user))) {
                _splitNames(user);
                userCache.set(user.username, user);
            }
        },

        /**
         * Will add all the supplied users by individually calling add
         * @param users an array of users
         */
        addAll: function addAll(users, force) {
            var _this = this;

            users.forEach(function (user) {
                _this.add(user, force);
            });
        },

        /**
         * @returns an array of all the users in the cache
         */
        getAll: function getAll() {
            return [].concat(_toConsumableArray(userCache.values()));
        },

        /**
         * Used for testing
         * @private
         */
        _get: function _get(username) {
            return userCache.get(username);
        },

        /**
         * Used for testing
         * @private
         */
        _clear: function _clear() {
            userCache.clear();
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(5), __webpack_require__(13), __webpack_require__(42), __webpack_require__(49), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _userSupplierManager, _userCache, _pipelines, _executor, _scoreBooster) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var userSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    var Pipelines = _interopRequireDefault(_pipelines).default;

    var PipelineExecutor = _interopRequireDefault(_executor).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * The maximum number of Users that will be displayed in the Mentions dropdown.
     */
    var DISPLAY_LIMIT = 5;
    var NON_BREAKING_SPACE = String.fromCharCode(160);

    // The last query to be triggered, used when server responses return out of order and we need to skip the render of
    // stale responses.
    var latestQuery = void 0;

    /**
     *
     * @param {string}   query              User's query
     * @param {function} renderCallback     Callback function to render the results
     * @param {function} selectedUser       (optional) the currently-selected user in the dropdown
     * @param {object} editor               the currently-active editor
     */
    function searchAndRender(query, renderCallback, selectedUser, editor) {
        // Trim the query but don't convert to lowercase just yet - the ranker should handle this. (i.e. upper case
        // letters could be weighted higher in matches).
        // Note that 160 is the non-breaking-space character and is not handled by trim().
        // It IS handled by $.trim(str) but noooooo, noooooo.
        query = query.replace(NON_BREAKING_SPACE, ' ').trim();
        latestQuery = query;

        var promises = userSupplierManager.search(query, editor);

        promises.client.then(function () {
            resolveClientUsers();
            // Guarantee that server results are handled after local ones - chain the promises!
            promises.server.then(resolveServerUsers, renderErrorOnReject);
        }, renderErrorOnReject);

        function resolveClientUsers() {
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, false);
        }

        function resolveServerUsers() {
            // We could in future wrap the renderCallback so that if the server render would have the same values as the
            // client render, we skip it and avoid a browser repaint.
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, true);
        }

        function renderErrorOnReject() {
            var iterator = new PipelineExecutor(Pipelines.error(renderCallback));
            iterator.execute([]);
        }
    }

    function renderPipeline(users, query, renderCallback, selectedUser, isServerCall) {
        var context = {
            query: query,
            latestQuery: latestQuery,
            selectedUser: selectedUser,
            isServerCall: isServerCall,
            DISPLAY_LIMIT: DISPLAY_LIMIT
        };

        var pipeline = void 0;
        if (!query) {
            pipeline = Pipelines.default(renderCallback);
        } else {
            pipeline = isServerCall ? Pipelines.server(renderCallback) : Pipelines.client(renderCallback);
        }

        var executor = new PipelineExecutor(pipeline, context);
        executor.execute(users);
    }

    // Called during testing to clear caches.
    function reset() {
        userSupplierManager.reset();
        UserCache._clear();
        ScoreBooster.reset();
    }

    exports.default = {
        searchAndRender: searchAndRender,
        prefetchSuppliers: userSupplierManager.prefetchSuppliers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    exports.default = {
        resultWithHtml: function resultWithHtml(html) {
            return {
                html: html
            };
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_16__;

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    'use strict';

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var suggestedUsers = [];

    /**
     * When searching for a user you're likely to want a user you've recently mentioned, even if other Fuse matches have
     * slightly better (lower) scores. For now we boost all recent matches, but we could adjust this to only the recent match
     * with the best score.
     *
     * Also, contributors should bubble to the top in the search results, at least until the search token is compelling enough
     * to switch.
     */
    function boostScores(users, next, context) {
        var query = context && context.query || '';
        if (query.indexOf(' ') > 0) {
            // Don't boost on supplier once multiple names are being added - the user seems to know who they're after so
            // let Fuse do its job.
            return next(users);
        }

        // The pipeline could be ensuring that users passed down the pipe are immutable, but for now just clone. fuseScore
        // should NOT be making its way into the user cache.
        var boostedUsers = users.map(function (userIn) {
            var user = Object.assign({}, userIn);
            if (suggestedUsers.includes(user.username)) {
                user.fuseScore /= 1000; // keep ordering for multiple matched suggestions
            } else if (typeof user.fuseScore === 'number') {
                switch (user.supplier) {
                    case UserSupplier.RECENT:
                        user.fuseScore /= 5;
                        break;
                    case UserSupplier.RELATED:
                        user.fuseScore /= 10;
                        break;
                }
            }
            return user;
        });
        return next(boostedUsers);
    }

    function setSuggestedUsers(users, next) {
        suggestedUsers = users.map(function (user) {
            return user.username;
        });
        return next(users);
    }

    function reset() {
        suggestedUsers = [];
    }

    exports.default = {
        boostScores: boostScores,
        setSuggestedUsers: setSuggestedUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_18__;

/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(21);


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(22), __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _editorPluginInit, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _tinymce) {
    'use strict';

    var editorPluginInit = _interopRequireDefault(_editorPluginInit).default;

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    function init(e, context) {
        var editor = context && context.editor; // in case the initCallback internal code breaks API

        tinymce.create('tinymce.plugins.InsertMentions', {
            init: editorPluginInit(editor),

            getInfo: function getInfo() {
                return {
                    longname: 'Insert Mentions',
                    author: 'Atlassian',
                    authorurl: 'http://www.atlassian.com',
                    version: tinymce.majorVersion + "." + tinymce.minorVersion
                };
            }
        });

        tinymce.PluginManager.add('insertmentions', tinymce.plugins.InsertMentions);
    }

    /**
     * This is the main export from the Mentions module set.
     */
    exports.default = {
        init: init,
        userSuppliers: {
            // Users from localstorage
            recent: RecentUsersSupplier,
            // Users from the server
            serverSearch: ServerUsersSupplier,
            // Users from the front-end cache of the Content in the editor
            contentRelated: RelatedUsersSupplier
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(3), __webpack_require__(23), __webpack_require__(14), __webpack_require__(18), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _jquery, _autocompleteAdapter, _Mentions, _autocompleteManager, _autocompleteSettings) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var $ = _interopRequireDefault(_jquery).default;

    var Adapter = _interopRequireDefault(_autocompleteAdapter).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    var AutocompleteSettings = _interopRequireDefault(_autocompleteSettings).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function activateMentions() {
        AJS.EventQueue.push({ name: 'confluencementioninsert' });
        AutocompleteManager.shortcutFired("@");
    }

    function onClickEvent(event) {
        event.stopPropagation();
        event.preventDefault();
        AJS.Rte.getEditor().focus();
        activateMentions();
    }

    function editorPluginInit(editor) {
        AJS.EventQueue = AJS.EventQueue || [];
        Mentions.prefetchSuppliers(editor);

        AutocompleteSettings.Settings["@"] = {
            ch: "@",
            cache: true,
            endChars: [],
            dropDownClassName: "autocomplete-mentions fabric",
            autocompleteClassNames: "fabric",
            dropDownDelay: 0, // No delay needed because there is no AJAX request involved
            selectFirstItem: true,
            minLengthForGetData: 1,
            displayHandler: function displayHandler(user) {
                // Use Jquery to encode the user name
                return $('<div/>').text(user.name).html();
            },

            getHeaderText: function getHeaderText() {
                return null; // HACK this could be an option in core, the header is currently being hidden with CSS.
            },

            getAdditionalLinks: function getAdditionalLinks(autoCompleteControl, value, callback) {
                var additionalLinks = [];
                if (callback) callback(value, additionalLinks);
                return additionalLinks;
            },

            /**
             *
             * @param autoCompleteControl
             * @param value     The user's input
             * @param {function} renderResults  function to run with the resulting users (from input-driven-dropdown in
             *                                  Core)
             */
            getDataAndRunCallback: function getDataAndRunCallback(autoCompleteControl, value, renderResults) {
                Adapter.search(autoCompleteControl, value, renderResults, editor);
            },

            /**
             * Overrides the confluence/highlighter used to highlight query term matches in results
             */
            // For now, this override is ignored: we're getting better results from the default highlighter than with the
            // highlighting based on Fuse.js output.
            // Highlighter,

            update: Adapter.insert
        };

        $('#insertmention-button').on('click', onClickEvent);

        if (AJS.Rte.Placeholder && AJS.Rte.Placeholder.addPlaceholderType) {
            AJS.Rte.Placeholder.addPlaceholderType({
                type: 'mention',
                label: "User mention",
                tooltip: "Instructional text is replaced with suggested people when a person types."
            });
        }
    }

    exports.default = editorPluginInit;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(14), __webpack_require__(4), __webpack_require__(5), __webpack_require__(50), __webpack_require__(2), __webpack_require__(52), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _Mentions, _recentUsersSupplier, _userSupplierManager, _mentionAnalytics, _meta, _linkObject, _tinymce) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    var UserSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var MentionsAnalytics = _interopRequireDefault(_mentionAnalytics).default;

    var Meta = _interopRequireDefault(_meta).default;

    var Link = _interopRequireDefault(_linkObject).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    var BASE_URL = Meta.get('base-url');

    function search(autoCompleteControl, value, renderResults, editor) {
        MentionsAnalytics.updateSession(autoCompleteControl);

        // The && guard here can be removed once the core tinymce3/plugins/autocomplete/autocomplete-manager.js code is released.
        // Hacky try catch to work around CONFSRVDEV-3101 and CONFSRVDEV-3138
        var selectedUser = void 0;
        try {
            var selectedItem = autoCompleteControl.getCurrentItem && autoCompleteControl.getCurrentItem();
            selectedUser = selectedItem && selectedItem.model;
        } catch (ignored) {
            console.log('Error retrieving currently-selected autoComplete item');
            console.log(ignored);
        }

        // renderResults likes a 2D array, and the query tokens in an array for highlighting
        var tokens = value && value.split(' ') || [];
        var render = function render(results, next, context) {
            return renderResults([results], value, null, tokens, context);
        };
        Mentions.searchAndRender(value, render, selectedUser, editor);
    }

    function insert(autoCompleteControl, user) {
        MentionsAnalytics.publishEventForSelection(user, autoCompleteControl.analytics);

        // Add this user to the cache - it will be retrieved with the recent-users-supplier module.
        RecentUsers.store(user);

        var earlyValidationCheck = RecentUsers.getStaleUsers(RecentUsers.ValidationType.EARLY_VALIDATION);
        if (earlyValidationCheck.length > 0) {
            //asynchronously attempt to update the recently mentioned cache to remove any stale users, after the UI insert is completed
            setTimeout(function () {
                return UserSupplierManager.deleteStaleUsers(earlyValidationCheck, RecentUsers.ValidationType.EARLY_VALIDATION);
            }, 0);
        }

        var link = {
            attrs: {
                href: user.link,
                'userkey': user.model.userKey, // required to unmarshall ResourceIdentifier
                'data-base-url': BASE_URL,
                'data-linked-resource-type': 'userinfo',
                'data-linked-resource-default-alias': user.name
            },
            body: {
                html: AJS.escapeHtml(user.name)
            },
            classes: ['confluence-link']
        };
        Link.fromData(link).insert();
        tinymce.activeEditor.selection.setContent(" ");
    }

    // Called during testing
    function reset() {
        Mentions.reset();
    }

    exports.default = {
        search: search,
        insert: insert,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    // Adapted from confluence-quick-edit/src/main/resources/jscripts/handlers/comment.js.
    /**
     Supplies the Content API model object associated with the current draft in the editor.
    
     This is basically a shim for something that the Editor JS API *should* provide but currently doesn't
     */
    function getParameter(url, paramName) {
        if (!url) {
            return '';
        }
        var regex = new RegExp("[?&]" + paramName + "=(\\d+)");
        var match = url.match(regex);
        return match && match.length > 1 ? match[1] : '';
    }

    function safeGetDraft(editor) {
        if (!editor) {
            return null;
        }

        try {
            return getDraft(editor);
        } catch (e) {
            // This might happen if the Editor is being initialised in a context we don't yet support.
            console.error(e.message);
            return null;
        }
    }

    function getDraft(editor) {
        var id = Meta.get('page-id');

        var form = editor.formElement;
        var action = form.action || '';

        if (action.indexOf('/doaddcomment.action') > -1 || action.indexOf('/doeditcomment.action') > -1 || $(form).closest('.ic-sidebar').length) {
            var commentId = getParameter(action, "commentId") || '0';

            var content = {
                id: commentId,
                type: 'comment',
                status: 'draft',
                container: {
                    id: id
                }
            };

            var parentCommentId = getParameter(action, "parentId");
            if (parentCommentId) {
                content.ancestors = [{
                    id: parentCommentId
                }];
            }

            return content;
        }

        var previewContainer = $(form).closest('.cp-container');
        if (previewContainer.length) {
            // This is a comment for a Preview. Until we have a proper API, scrape the DOM and shed a single tear.
            var previewTitle = previewContainer.find('.cp-file-title').text().replace(/"/g, "\\\"");
            // CONFSRVDEV-11704 because the previewer can be triggered from like million places, and because we suck
            // and don't set the alias for attachment titles consistently , which means we need to look for them with spaces
            // a well as with + for space
            var alternateTitle = escape(previewTitle.replace(/\s/g, "+"));
            var $element = $('body').find('*[data-linked-resource-default-alias="' + previewTitle + '"], *[data-linked-resource-default-alias="' + alternateTitle + '"]');
            if ($element.length) {
                var attachmentId = $element.attr('data-linked-resource-id');
                // Again, until Previews exposes an API, and the Editor consumes it in a way that THIS code can consume,
                // we're limited in how Smart the suggestions here can be. For now, editing an existing comment or replying
                // to a comment are treated the same as creating a new comment.
                return {
                    id: 0,
                    type: 'comment',
                    status: 'draft',
                    container: {
                        id: attachmentId
                    }
                };
            }
        }

        var newPage = Meta.get('new-page');

        var type = Meta.get('content-type');
        return {
            id: newPage ? '0' : id,
            type: type,
            status: 'draft'
        };
    }

    exports.default = safeGetDraft;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery, _aggregateUsers, _restParameters, _relatedUserTransformer) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var aggregateUsers = _interopRequireDefault(_aggregateUsers).default;

    var getRestParameters = _interopRequireDefault(_restParameters).default;

    var flattenUsers = _interopRequireDefault(_relatedUserTransformer).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   Supplies Users that are related to a piece of Content, calculated from server data via the Content API.
                   */


    var cache = {};

    var getUsers = function getUsers(contentStub) {
        var restParams = getRestParameters(contentStub);
        if (!restParams) {
            // Will be null for new pages and blogposts: don't make a REST call, don't cache
            return Promise.resolve([]);
        }

        if (restParams.contentId in cache) {
            return cache[restParams.contentId];
        }

        var promise = new Promise(function (resolve, reject) {
            var contextPath = Meta.get('context-path');
            var url = contextPath + '/rest/api/content/' + restParams.contentId;
            var queryParameters = {
                expand: restParams.expand
            };

            $.getJSON(url, queryParameters, function (content) {
                resolve(flattenUsers(aggregateUsers(content)));
            }).fail(reject);
        });

        cache[restParams.contentId] = promise;
        return promise;
    };

    // Used in testing.
    function reset() {
        cache = {};
    }

    exports.default = {
        getUsers: getUsers,
        reset: reset,
        _cache: cache //exposed for testing
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole, _userSupplierKeys) {
    'use strict';

    var UserRole = _interopRequireDefault(_userRole).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    exports.default = function (content) {
        var relatedUsers = {};

        // Used to track users that have already been added to relatedUsers
        var usernames = new Set();

        // Skip anonymous users, disabled/deleted users, and users already in the result
        function shouldAddUser(user) {
            if (user.type === 'anonymous') {
                return false;
            }

            if (typeof user.status === 'undefined') {
                console.error("User status is undefined. Not adding to relatedUsers aggregate.");
                return false;
            }
            return user.status === 'current' && !usernames.has(user.username);
        }

        function addUser(user, role) {
            user.role = role;
            user.supplier = UserSupplier.RELATED;
            var roleKey = role.role;
            relatedUsers[roleKey] = relatedUsers[roleKey] || [];
            relatedUsers[roleKey].push(user);
            usernames.add(user.username);
        }

        function addUserWithRole(user, role) {
            if (shouldAddUser(user)) {
                addUser(user, role);
            }
        }

        var page = content.type === 'comment' ? content.container : content;

        // Only do this for content that has history
        if ('history' in page) {
            addUserWithRole(page.history.createdBy, UserRole.CREATOR);

            // Contributors are reversed to descending chronological order - users are more likely to mention contributors who
            // edited the content more recently.
            page.history.contributors.publishers.users.reverse().forEach(function (contributor) {
                addUserWithRole(contributor, UserRole.CONTRIBUTOR);
            });
        }

        if (content.type === 'comment' && content.ancestors) {
            // A new or existing comment that is a reply to another comment. We catch ancestor commenters before other
            // commenters because they are more likely to be mentioned.
            // Ancestor order is not reversed because they are already ordered youngest to oldest.
            content.ancestors.forEach(function (ancestorComment) {
                addUserWithRole(ancestorComment.version.by, UserRole.ANCESTOR_COMMENTER);
            });
        }

        if ('children' in page) {
            // Page commenters are also listed in reverse order
            page.children.comment.results.reverse().forEach(function (comment) {
                addUserWithRole(comment.version.by, UserRole.COMMENTER);
            });
        }

        return relatedUsers;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    /**
     Calculations the content id and expansions that should be used in the REST API call when building the
     list of users related to a piece of Content in the editor.
     */

    var PAGE_REST_EXPANSIONS = 'history.createdBy.status,history.contributors.publishers.users.status,children.comment.version.by.status';
    var COMMENT_REST_EXPANSIONS = 'ancestors.version.by.status,container.history.createdBy.status,container.history.contributors.publishers.users.status,container.children.comment.version.by.status';

    function restParams(id, expansions) {
        return {
            contentId: id,
            expand: expansions
        };
    }

    function isBlankId(val) {
        return !val || val === '0';
    }

    exports.default = function (contentStub) {
        if (!contentStub) {
            return null;
        }

        if (contentStub.type === 'page' || contentStub.type === 'blogpost') {
            var pageId = contentStub.id;
            if (isBlankId(pageId)) {
                // A new page/blogpost has no related users.
                return null;
            }
            // Editing an existing page or blogpost
            return restParams(pageId, PAGE_REST_EXPANSIONS);
        }

        if (contentStub.type === 'comment') {
            var commentId = contentStub.id;
            if (!isBlankId(commentId)) {
                // Editing an existing comment
                return restParams(commentId, COMMENT_REST_EXPANSIONS);
            }

            // A new comment: the stub will include the id of the comment it is replying to, unless this is a top-level
            // comment. NOTE: if we end up with access to a Draft comment, we should be able to use its id as the
            // content id, and not use the parent-comment or page ids here.
            var parentCommentId = contentStub.ancestors && contentStub.ancestors[0] && contentStub.ancestors[0].id;
            if (!isBlankId(parentCommentId)) {
                // A new reply
                return restParams(parentCommentId, COMMENT_REST_EXPANSIONS);
            }

            // A new top-level comment
            var _pageId = contentStub.container.id;
            return restParams(_pageId, PAGE_REST_EXPANSIONS);
        }
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole) {
    "use strict";

    var UserRole = _interopRequireDefault(_userRole).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Converts the map of users by role into a list of users.
     */

    exports.default = function (usersMap) {
        var transformedList = [];

        function addUsersWithRoleToList(userRole) {
            var users = usersMap[userRole.role];
            if (users && users.length) {
                transformedList = transformedList.concat(users);
            }
        }

        addUsersWithRoleToList(UserRole.CREATOR);
        addUsersWithRoleToList(UserRole.CONTRIBUTOR);
        addUsersWithRoleToList(UserRole.COMMENTER);
        addUsersWithRoleToList(UserRole.ANCESTOR_COMMENTER);

        return transformedList;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = LRUCache

// This will be a proper iterable 'Map' in engines that support it,
// or a fakey-fake PseudoMap in older versions.
var Map = __webpack_require__(30)
var util = __webpack_require__(32)

// A linked list to keep track of recently-used-ness
var Yallist = __webpack_require__(36)

// use symbols if possible, otherwise just _props
var hasSymbol = typeof Symbol === 'function'
var makeSymbol
if (hasSymbol) {
  makeSymbol = function (key) {
    return Symbol.for(key)
  }
} else {
  makeSymbol = function (key) {
    return '_' + key
  }
}

var MAX = makeSymbol('max')
var LENGTH = makeSymbol('length')
var LENGTH_CALCULATOR = makeSymbol('lengthCalculator')
var ALLOW_STALE = makeSymbol('allowStale')
var MAX_AGE = makeSymbol('maxAge')
var DISPOSE = makeSymbol('dispose')
var NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')
var LRU_LIST = makeSymbol('lruList')
var CACHE = makeSymbol('cache')

function naiveLength () { return 1 }

// lruList is a yallist where the head is the youngest
// item, and the tail is the oldest.  the list contains the Hit
// objects as the entries.
// Each Hit object has a reference to its Yallist.Node.  This
// never changes.
//
// cache is a Map (or PseudoMap) that matches the keys to
// the Yallist.Node object.
function LRUCache (options) {
  if (!(this instanceof LRUCache)) {
    return new LRUCache(options)
  }

  if (typeof options === 'number') {
    options = { max: options }
  }

  if (!options) {
    options = {}
  }

  var max = this[MAX] = options.max
  // Kind of weird to have a default max of Infinity, but oh well.
  if (!max ||
      !(typeof max === 'number') ||
      max <= 0) {
    this[MAX] = Infinity
  }

  var lc = options.length || naiveLength
  if (typeof lc !== 'function') {
    lc = naiveLength
  }
  this[LENGTH_CALCULATOR] = lc

  this[ALLOW_STALE] = options.stale || false
  this[MAX_AGE] = options.maxAge || 0
  this[DISPOSE] = options.dispose
  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false
  this.reset()
}

// resize the cache when the max changes.
Object.defineProperty(LRUCache.prototype, 'max', {
  set: function (mL) {
    if (!mL || !(typeof mL === 'number') || mL <= 0) {
      mL = Infinity
    }
    this[MAX] = mL
    trim(this)
  },
  get: function () {
    return this[MAX]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'allowStale', {
  set: function (allowStale) {
    this[ALLOW_STALE] = !!allowStale
  },
  get: function () {
    return this[ALLOW_STALE]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'maxAge', {
  set: function (mA) {
    if (!mA || !(typeof mA === 'number') || mA < 0) {
      mA = 0
    }
    this[MAX_AGE] = mA
    trim(this)
  },
  get: function () {
    return this[MAX_AGE]
  },
  enumerable: true
})

// resize the cache when the lengthCalculator changes.
Object.defineProperty(LRUCache.prototype, 'lengthCalculator', {
  set: function (lC) {
    if (typeof lC !== 'function') {
      lC = naiveLength
    }
    if (lC !== this[LENGTH_CALCULATOR]) {
      this[LENGTH_CALCULATOR] = lC
      this[LENGTH] = 0
      this[LRU_LIST].forEach(function (hit) {
        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)
        this[LENGTH] += hit.length
      }, this)
    }
    trim(this)
  },
  get: function () { return this[LENGTH_CALCULATOR] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'length', {
  get: function () { return this[LENGTH] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'itemCount', {
  get: function () { return this[LRU_LIST].length },
  enumerable: true
})

LRUCache.prototype.rforEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].tail; walker !== null;) {
    var prev = walker.prev
    forEachStep(this, fn, walker, thisp)
    walker = prev
  }
}

function forEachStep (self, fn, node, thisp) {
  var hit = node.value
  if (isStale(self, hit)) {
    del(self, node)
    if (!self[ALLOW_STALE]) {
      hit = undefined
    }
  }
  if (hit) {
    fn.call(thisp, hit.value, hit.key, self)
  }
}

LRUCache.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].head; walker !== null;) {
    var next = walker.next
    forEachStep(this, fn, walker, thisp)
    walker = next
  }
}

LRUCache.prototype.keys = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.key
  }, this)
}

LRUCache.prototype.values = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.value
  }, this)
}

LRUCache.prototype.reset = function () {
  if (this[DISPOSE] &&
      this[LRU_LIST] &&
      this[LRU_LIST].length) {
    this[LRU_LIST].forEach(function (hit) {
      this[DISPOSE](hit.key, hit.value)
    }, this)
  }

  this[CACHE] = new Map() // hash of items by key
  this[LRU_LIST] = new Yallist() // list of items in order of use recency
  this[LENGTH] = 0 // length of items in the list
}

LRUCache.prototype.dump = function () {
  return this[LRU_LIST].map(function (hit) {
    if (!isStale(this, hit)) {
      return {
        k: hit.key,
        v: hit.value,
        e: hit.now + (hit.maxAge || 0)
      }
    }
  }, this).toArray().filter(function (h) {
    return h
  })
}

LRUCache.prototype.dumpLru = function () {
  return this[LRU_LIST]
}

LRUCache.prototype.inspect = function (n, opts) {
  var str = 'LRUCache {'
  var extras = false

  var as = this[ALLOW_STALE]
  if (as) {
    str += '\n  allowStale: true'
    extras = true
  }

  var max = this[MAX]
  if (max && max !== Infinity) {
    if (extras) {
      str += ','
    }
    str += '\n  max: ' + util.inspect(max, opts)
    extras = true
  }

  var maxAge = this[MAX_AGE]
  if (maxAge) {
    if (extras) {
      str += ','
    }
    str += '\n  maxAge: ' + util.inspect(maxAge, opts)
    extras = true
  }

  var lc = this[LENGTH_CALCULATOR]
  if (lc && lc !== naiveLength) {
    if (extras) {
      str += ','
    }
    str += '\n  length: ' + util.inspect(this[LENGTH], opts)
    extras = true
  }

  var didFirst = false
  this[LRU_LIST].forEach(function (item) {
    if (didFirst) {
      str += ',\n  '
    } else {
      if (extras) {
        str += ',\n'
      }
      didFirst = true
      str += '\n  '
    }
    var key = util.inspect(item.key).split('\n').join('\n  ')
    var val = { value: item.value }
    if (item.maxAge !== maxAge) {
      val.maxAge = item.maxAge
    }
    if (lc !== naiveLength) {
      val.length = item.length
    }
    if (isStale(this, item)) {
      val.stale = true
    }

    val = util.inspect(val, opts).split('\n').join('\n  ')
    str += key + ' => ' + val
  })

  if (didFirst || extras) {
    str += '\n'
  }
  str += '}'

  return str
}

LRUCache.prototype.set = function (key, value, maxAge) {
  maxAge = maxAge || this[MAX_AGE]

  var now = maxAge ? Date.now() : 0
  var len = this[LENGTH_CALCULATOR](value, key)

  if (this[CACHE].has(key)) {
    if (len > this[MAX]) {
      del(this, this[CACHE].get(key))
      return false
    }

    var node = this[CACHE].get(key)
    var item = node.value

    // dispose of the old one before overwriting
    // split out into 2 ifs for better coverage tracking
    if (this[DISPOSE]) {
      if (!this[NO_DISPOSE_ON_SET]) {
        this[DISPOSE](key, item.value)
      }
    }

    item.now = now
    item.maxAge = maxAge
    item.value = value
    this[LENGTH] += len - item.length
    item.length = len
    this.get(key)
    trim(this)
    return true
  }

  var hit = new Entry(key, value, len, now, maxAge)

  // oversized objects fall out of cache automatically.
  if (hit.length > this[MAX]) {
    if (this[DISPOSE]) {
      this[DISPOSE](key, value)
    }
    return false
  }

  this[LENGTH] += hit.length
  this[LRU_LIST].unshift(hit)
  this[CACHE].set(key, this[LRU_LIST].head)
  trim(this)
  return true
}

LRUCache.prototype.has = function (key) {
  if (!this[CACHE].has(key)) return false
  var hit = this[CACHE].get(key).value
  if (isStale(this, hit)) {
    return false
  }
  return true
}

LRUCache.prototype.get = function (key) {
  return get(this, key, true)
}

LRUCache.prototype.peek = function (key) {
  return get(this, key, false)
}

LRUCache.prototype.pop = function () {
  var node = this[LRU_LIST].tail
  if (!node) return null
  del(this, node)
  return node.value
}

LRUCache.prototype.del = function (key) {
  del(this, this[CACHE].get(key))
}

LRUCache.prototype.load = function (arr) {
  // reset the cache
  this.reset()

  var now = Date.now()
  // A previous serialized cache has the most recent items first
  for (var l = arr.length - 1; l >= 0; l--) {
    var hit = arr[l]
    var expiresAt = hit.e || 0
    if (expiresAt === 0) {
      // the item was created without expiration in a non aged cache
      this.set(hit.k, hit.v)
    } else {
      var maxAge = expiresAt - now
      // dont add already expired items
      if (maxAge > 0) {
        this.set(hit.k, hit.v, maxAge)
      }
    }
  }
}

LRUCache.prototype.prune = function () {
  var self = this
  this[CACHE].forEach(function (value, key) {
    get(self, key, false)
  })
}

function get (self, key, doUse) {
  var node = self[CACHE].get(key)
  if (node) {
    var hit = node.value
    if (isStale(self, hit)) {
      del(self, node)
      if (!self[ALLOW_STALE]) hit = undefined
    } else {
      if (doUse) {
        self[LRU_LIST].unshiftNode(node)
      }
    }
    if (hit) hit = hit.value
  }
  return hit
}

function isStale (self, hit) {
  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {
    return false
  }
  var stale = false
  var diff = Date.now() - hit.now
  if (hit.maxAge) {
    stale = diff > hit.maxAge
  } else {
    stale = self[MAX_AGE] && (diff > self[MAX_AGE])
  }
  return stale
}

function trim (self) {
  if (self[LENGTH] > self[MAX]) {
    for (var walker = self[LRU_LIST].tail;
         self[LENGTH] > self[MAX] && walker !== null;) {
      // We know that we're about to delete this one, and also
      // what the next least recently used key will be, so just
      // go ahead and set it now.
      var prev = walker.prev
      del(self, walker)
      walker = prev
    }
  }
}

function del (self, node) {
  if (node) {
    var hit = node.value
    if (self[DISPOSE]) {
      self[DISPOSE](hit.key, hit.value)
    }
    self[LENGTH] -= hit.length
    self[CACHE].delete(hit.key)
    self[LRU_LIST].removeNode(node)
  }
}

// classy, since V8 prefers predictable objects.
function Entry (key, value, length, now, maxAge) {
  this.key = key
  this.value = value
  this.length = length
  this.now = now
  this.maxAge = maxAge || 0
}


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&
    process.env.npm_lifecycle_script === 'test')
  process.env.TEST_PSEUDOMAP = 'true'

if (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {
  module.exports = Map
} else {
  module.exports = __webpack_require__(31)
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9)))

/***/ }),
/* 31 */
/***/ (function(module, exports) {

var hasOwnProperty = Object.prototype.hasOwnProperty

module.exports = PseudoMap

function PseudoMap (set) {
  if (!(this instanceof PseudoMap)) // whyyyyyyy
    throw new TypeError("Constructor PseudoMap requires 'new'")

  this.clear()

  if (set) {
    if ((set instanceof PseudoMap) ||
        (typeof Map === 'function' && set instanceof Map))
      set.forEach(function (value, key) {
        this.set(key, value)
      }, this)
    else if (Array.isArray(set))
      set.forEach(function (kv) {
        this.set(kv[0], kv[1])
      }, this)
    else
      throw new TypeError('invalid argument')
  }
}

PseudoMap.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  Object.keys(this._data).forEach(function (k) {
    if (k !== 'size')
      fn.call(thisp, this._data[k].value, this._data[k].key)
  }, this)
}

PseudoMap.prototype.has = function (k) {
  return !!find(this._data, k)
}

PseudoMap.prototype.get = function (k) {
  var res = find(this._data, k)
  return res && res.value
}

PseudoMap.prototype.set = function (k, v) {
  set(this._data, k, v)
}

PseudoMap.prototype.delete = function (k) {
  var res = find(this._data, k)
  if (res) {
    delete this._data[res._index]
    this._data.size--
  }
}

PseudoMap.prototype.clear = function () {
  var data = Object.create(null)
  data.size = 0

  Object.defineProperty(this, '_data', {
    value: data,
    enumerable: false,
    configurable: true,
    writable: false
  })
}

Object.defineProperty(PseudoMap.prototype, 'size', {
  get: function () {
    return this._data.size
  },
  set: function (n) {},
  enumerable: true,
  configurable: true
})

PseudoMap.prototype.values =
PseudoMap.prototype.keys =
PseudoMap.prototype.entries = function () {
  throw new Error('iterators are not implemented in this version')
}

// Either identical, or both NaN
function same (a, b) {
  return a === b || a !== a && b !== b
}

function Entry (k, v, i) {
  this.key = k
  this.value = v
  this._index = i
}

function find (data, k) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k))
      return data[key]
  }
}

function set (data, k, v) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k)) {
      data[key].value = v
      return
    }
  }
  data.size++
  data[key] = new Entry(k, v, key)
}


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = __webpack_require__(34);

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = __webpack_require__(35);

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(33), __webpack_require__(9)))

/***/ }),
/* 33 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}

/***/ }),
/* 35 */
/***/ (function(module, exports) {

if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}


/***/ }),
/* 36 */
/***/ (function(module, exports) {

module.exports = Yallist

Yallist.Node = Node
Yallist.create = Yallist

function Yallist (list) {
  var self = this
  if (!(self instanceof Yallist)) {
    self = new Yallist()
  }

  self.tail = null
  self.head = null
  self.length = 0

  if (list && typeof list.forEach === 'function') {
    list.forEach(function (item) {
      self.push(item)
    })
  } else if (arguments.length > 0) {
    for (var i = 0, l = arguments.length; i < l; i++) {
      self.push(arguments[i])
    }
  }

  return self
}

Yallist.prototype.removeNode = function (node) {
  if (node.list !== this) {
    throw new Error('removing node which does not belong to this list')
  }

  var next = node.next
  var prev = node.prev

  if (next) {
    next.prev = prev
  }

  if (prev) {
    prev.next = next
  }

  if (node === this.head) {
    this.head = next
  }
  if (node === this.tail) {
    this.tail = prev
  }

  node.list.length--
  node.next = null
  node.prev = null
  node.list = null
}

Yallist.prototype.unshiftNode = function (node) {
  if (node === this.head) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var head = this.head
  node.list = this
  node.next = head
  if (head) {
    head.prev = node
  }

  this.head = node
  if (!this.tail) {
    this.tail = node
  }
  this.length++
}

Yallist.prototype.pushNode = function (node) {
  if (node === this.tail) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var tail = this.tail
  node.list = this
  node.prev = tail
  if (tail) {
    tail.next = node
  }

  this.tail = node
  if (!this.head) {
    this.head = node
  }
  this.length++
}

Yallist.prototype.push = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    push(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.unshift = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    unshift(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.pop = function () {
  if (!this.tail) {
    return undefined
  }

  var res = this.tail.value
  this.tail = this.tail.prev
  if (this.tail) {
    this.tail.next = null
  } else {
    this.head = null
  }
  this.length--
  return res
}

Yallist.prototype.shift = function () {
  if (!this.head) {
    return undefined
  }

  var res = this.head.value
  this.head = this.head.next
  if (this.head) {
    this.head.prev = null
  } else {
    this.tail = null
  }
  this.length--
  return res
}

Yallist.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.head, i = 0; walker !== null; i++) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.next
  }
}

Yallist.prototype.forEachReverse = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.prev
  }
}

Yallist.prototype.get = function (n) {
  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.next
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.getReverse = function (n) {
  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.prev
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.map = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.head; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.next
  }
  return res
}

Yallist.prototype.mapReverse = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.tail; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.prev
  }
  return res
}

Yallist.prototype.reduce = function (fn, initial) {
  var acc
  var walker = this.head
  if (arguments.length > 1) {
    acc = initial
  } else if (this.head) {
    walker = this.head.next
    acc = this.head.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = 0; walker !== null; i++) {
    acc = fn(acc, walker.value, i)
    walker = walker.next
  }

  return acc
}

Yallist.prototype.reduceReverse = function (fn, initial) {
  var acc
  var walker = this.tail
  if (arguments.length > 1) {
    acc = initial
  } else if (this.tail) {
    walker = this.tail.prev
    acc = this.tail.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = this.length - 1; walker !== null; i--) {
    acc = fn(acc, walker.value, i)
    walker = walker.prev
  }

  return acc
}

Yallist.prototype.toArray = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.head; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.next
  }
  return arr
}

Yallist.prototype.toArrayReverse = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.tail; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.prev
  }
  return arr
}

Yallist.prototype.slice = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {
    walker = walker.next
  }
  for (; walker !== null && i < to; i++, walker = walker.next) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.sliceReverse = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {
    walker = walker.prev
  }
  for (; walker !== null && i > from; i--, walker = walker.prev) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.reverse = function () {
  var head = this.head
  var tail = this.tail
  for (var walker = head; walker !== null; walker = walker.prev) {
    var p = walker.prev
    walker.prev = walker.next
    walker.next = p
  }
  this.head = tail
  this.tail = head
  return this
}

function push (self, item) {
  self.tail = new Node(item, self.tail, null, self)
  if (!self.head) {
    self.head = self.tail
  }
  self.length++
}

function unshift (self, item) {
  self.head = new Node(item, null, self.head, self)
  if (!self.tail) {
    self.tail = self.head
  }
  self.length++
}

function Node (value, prev, next, list) {
  if (!(this instanceof Node)) {
    return new Node(value, prev, next, list)
  }

  this.list = list
  this.value = value

  if (prev) {
    prev.next = this
    this.prev = prev
  } else {
    this.prev = null
  }

  if (next) {
    next.prev = this
    this.next = next
  } else {
    this.next = null
  }
}


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_37__;

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.2.0 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Fuse", [], factory);
	else if(typeof exports === 'object')
		exports["Fuse"] = factory();
	else
		root["Fuse"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
};

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var bitapRegexSearch = __webpack_require__(5);
var bitapSearch = __webpack_require__(7);
var patternAlphabet = __webpack_require__(4);

var Bitap = function () {
  function Bitap(pattern, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$isCaseSensitive = _ref.isCaseSensitive,
        isCaseSensitive = _ref$isCaseSensitive === undefined ? false : _ref$isCaseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

    _classCallCheck(this, Bitap);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: isCaseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength
    };

    this.pattern = this.options.isCaseSensitive ? pattern : pattern.toLowerCase();

    if (this.pattern.length <= maxPatternLength) {
      this.patternAlphabet = patternAlphabet(this.pattern);
    }
  }

  _createClass(Bitap, [{
    key: 'search',
    value: function search(text) {
      if (!this.options.isCaseSensitive) {
        text = text.toLowerCase();
      }

      // Exact match
      if (this.pattern === text) {
        return {
          isMatch: true,
          score: 0,
          matchedIndices: [[0, text.length - 1]]
        };
      }

      // When pattern length is greater than the machine word length, just do a a regex comparison
      var _options = this.options,
          maxPatternLength = _options.maxPatternLength,
          tokenSeparator = _options.tokenSeparator;

      if (this.pattern.length > maxPatternLength) {
        return bitapRegexSearch(text, this.pattern, tokenSeparator);
      }

      // Otherwise, use Bitap algorithm
      var _options2 = this.options,
          location = _options2.location,
          distance = _options2.distance,
          threshold = _options2.threshold,
          findAllMatches = _options2.findAllMatches,
          minMatchCharLength = _options2.minMatchCharLength;

      return bitapSearch(text, this.pattern, this.patternAlphabet, {
        location: location,
        distance: distance,
        threshold: threshold,
        findAllMatches: findAllMatches,
        minMatchCharLength: minMatchCharLength
      });
    }
  }]);

  return Bitap;
}();

// let x = new Bitap("od mn war", {})
// let result = x.search("Old Man's War")
// console.log(result)

module.exports = Bitap;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isArray = __webpack_require__(0);

var deepValue = function deepValue(obj, path, list) {
  if (!path) {
    // If there's no path left, we've gotten to the object we care about.
    list.push(obj);
  } else {
    var dotIndex = path.indexOf('.');
    var firstSegment = path;
    var remaining = null;

    if (dotIndex !== -1) {
      firstSegment = path.slice(0, dotIndex);
      remaining = path.slice(dotIndex + 1);
    }

    var value = obj[firstSegment];

    if (value !== null && value !== undefined) {
      if (!remaining && (typeof value === 'string' || typeof value === 'number')) {
        list.push(value.toString());
      } else if (isArray(value)) {
        // Search each item in the array.
        for (var i = 0, len = value.length; i < len; i += 1) {
          deepValue(value[i], remaining, list);
        }
      } else if (remaining) {
        // An object. Recurse further.
        deepValue(value, remaining, list);
      }
    }
  }

  return list;
};

module.exports = function (obj, path) {
  return deepValue(obj, path, []);
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function () {
  var matchmask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var minMatchCharLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

  var matchedIndices = [];
  var start = -1;
  var end = -1;
  var i = 0;

  for (var len = matchmask.length; i < len; i += 1) {
    var match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        matchedIndices.push([start, end]);
      }
      start = -1;
    }
  }

  // (i-1 - start) + 1 => i - start
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    matchedIndices.push([start, i - 1]);
  }

  return matchedIndices;
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern) {
  var mask = {};
  var len = pattern.length;

  for (var i = 0; i < len; i += 1) {
    mask[pattern.charAt(i)] = 0;
  }

  for (var _i = 0; _i < len; _i += 1) {
    mask[pattern.charAt(_i)] |= 1 << len - _i - 1;
  }

  return mask;
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var SPECIAL_CHARS_REGEX = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;

module.exports = function (text, pattern) {
  var tokenSeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : / +/g;

  var regex = new RegExp(pattern.replace(SPECIAL_CHARS_REGEX, '\\$&').replace(tokenSeparator, '|'));
  var matches = text.match(regex);
  var isMatch = !!matches;
  var matchedIndices = [];

  if (isMatch) {
    for (var i = 0, matchesLen = matches.length; i < matchesLen; i += 1) {
      var match = matches[i];
      matchedIndices.push([text.indexOf(match), match.length - 1]);
    }
  }

  return {
    // TODO: revisit this score
    score: isMatch ? 0.5 : 1,
    isMatch: isMatch,
    matchedIndices: matchedIndices
  };
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern, _ref) {
  var _ref$errors = _ref.errors,
      errors = _ref$errors === undefined ? 0 : _ref$errors,
      _ref$currentLocation = _ref.currentLocation,
      currentLocation = _ref$currentLocation === undefined ? 0 : _ref$currentLocation,
      _ref$expectedLocation = _ref.expectedLocation,
      expectedLocation = _ref$expectedLocation === undefined ? 0 : _ref$expectedLocation,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance;

  var accuracy = errors / pattern.length;
  var proximity = Math.abs(expectedLocation - currentLocation);

  if (!distance) {
    // Dodge divide by zero error.
    return proximity ? 1.0 : accuracy;
  }

  return accuracy + proximity / distance;
};

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bitapScore = __webpack_require__(6);
var matchedIndices = __webpack_require__(3);

module.exports = function (text, pattern, patternAlphabet, _ref) {
  var _ref$location = _ref.location,
      location = _ref$location === undefined ? 0 : _ref$location,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance,
      _ref$threshold = _ref.threshold,
      threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
      _ref$findAllMatches = _ref.findAllMatches,
      findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
      _ref$minMatchCharLeng = _ref.minMatchCharLength,
      minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

  var expectedLocation = location;
  // Set starting location at beginning text and initialize the alphabet.
  var textLen = text.length;
  // Highest score beyond which we give up.
  var currentThreshold = threshold;
  // Is there a nearby exact match? (speedup)
  var bestLocation = text.indexOf(pattern, expectedLocation);

  var patternLen = pattern.length;

  // a mask of the matches
  var matchMask = [];
  for (var i = 0; i < textLen; i += 1) {
    matchMask[i] = 0;
  }

  if (bestLocation !== -1) {
    var score = bitapScore(pattern, {
      errors: 0,
      currentLocation: bestLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });
    currentThreshold = Math.min(score, currentThreshold);

    // What about in the other direction? (speed up)
    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen);

    if (bestLocation !== -1) {
      var _score = bitapScore(pattern, {
        errors: 0,
        currentLocation: bestLocation,
        expectedLocation: expectedLocation,
        distance: distance
      });
      currentThreshold = Math.min(_score, currentThreshold);
    }
  }

  // Reset the best location
  bestLocation = -1;

  var lastBitArr = [];
  var finalScore = 1;
  var binMax = patternLen + textLen;

  var mask = 1 << patternLen - 1;

  for (var _i = 0; _i < patternLen; _i += 1) {
    // Scan for the best match; each iteration allows for one more error.
    // Run a binary search to determine how far from the match location we can stray
    // at this error level.
    var binMin = 0;
    var binMid = binMax;

    while (binMin < binMid) {
      var _score3 = bitapScore(pattern, {
        errors: _i,
        currentLocation: expectedLocation + binMid,
        expectedLocation: expectedLocation,
        distance: distance
      });

      if (_score3 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }

      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }

    // Use the result from this iteration as the maximum for the next.
    binMax = binMid;

    var start = Math.max(1, expectedLocation - binMid + 1);
    var finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;

    // Initialize the bit array
    var bitArr = Array(finish + 2);

    bitArr[finish + 1] = (1 << _i) - 1;

    for (var j = finish; j >= start; j -= 1) {
      var currentLocation = j - 1;
      var charMatch = patternAlphabet[text.charAt(currentLocation)];

      if (charMatch) {
        matchMask[currentLocation] = 1;
      }

      // First pass: exact match
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;

      // Subsequent passes: fuzzy match
      if (_i !== 0) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }

      if (bitArr[j] & mask) {
        finalScore = bitapScore(pattern, {
          errors: _i,
          currentLocation: currentLocation,
          expectedLocation: expectedLocation,
          distance: distance
        });

        // This match will almost certainly be better than any existing match.
        // But check anyway.
        if (finalScore <= currentThreshold) {
          // Indeed it is
          currentThreshold = finalScore;
          bestLocation = currentLocation;

          // Already passed `loc`, downhill from here on in.
          if (bestLocation <= expectedLocation) {
            break;
          }

          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }

    // No hope for a (better) match at greater error levels.
    var _score2 = bitapScore(pattern, {
      errors: _i + 1,
      currentLocation: expectedLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });

    if (_score2 > currentThreshold) {
      break;
    }

    lastBitArr = bitArr;
  }

  // Count exact matches (those with a score of 0) to be "almost" exact
  return {
    isMatch: bestLocation >= 0,
    score: finalScore === 0 ? 0.001 : finalScore,
    matchedIndices: matchedIndices(matchMask, minMatchCharLength)
  };
};

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Bitap = __webpack_require__(1);
var deepValue = __webpack_require__(2);
var isArray = __webpack_require__(0);

var Fuse = function () {
  function Fuse(list, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$caseSensitive = _ref.caseSensitive,
        caseSensitive = _ref$caseSensitive === undefined ? false : _ref$caseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng,
        _ref$id = _ref.id,
        id = _ref$id === undefined ? null : _ref$id,
        _ref$keys = _ref.keys,
        keys = _ref$keys === undefined ? [] : _ref$keys,
        _ref$shouldSort = _ref.shouldSort,
        shouldSort = _ref$shouldSort === undefined ? true : _ref$shouldSort,
        _ref$getFn = _ref.getFn,
        getFn = _ref$getFn === undefined ? deepValue : _ref$getFn,
        _ref$sortFn = _ref.sortFn,
        sortFn = _ref$sortFn === undefined ? function (a, b) {
      return a.score - b.score;
    } : _ref$sortFn,
        _ref$tokenize = _ref.tokenize,
        tokenize = _ref$tokenize === undefined ? false : _ref$tokenize,
        _ref$matchAllTokens = _ref.matchAllTokens,
        matchAllTokens = _ref$matchAllTokens === undefined ? false : _ref$matchAllTokens,
        _ref$includeMatches = _ref.includeMatches,
        includeMatches = _ref$includeMatches === undefined ? false : _ref$includeMatches,
        _ref$includeScore = _ref.includeScore,
        includeScore = _ref$includeScore === undefined ? false : _ref$includeScore,
        _ref$verbose = _ref.verbose,
        verbose = _ref$verbose === undefined ? false : _ref$verbose;

    _classCallCheck(this, Fuse);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: caseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength,
      id: id,
      keys: keys,
      includeMatches: includeMatches,
      includeScore: includeScore,
      shouldSort: shouldSort,
      getFn: getFn,
      sortFn: sortFn,
      verbose: verbose,
      tokenize: tokenize,
      matchAllTokens: matchAllTokens
    };

    this.setCollection(list);
  }

  _createClass(Fuse, [{
    key: 'setCollection',
    value: function setCollection(list) {
      this.list = list;
      return list;
    }
  }, {
    key: 'search',
    value: function search(pattern) {
      this._log('---------\nSearch pattern: "' + pattern + '"');

      var _prepareSearchers2 = this._prepareSearchers(pattern),
          tokenSearchers = _prepareSearchers2.tokenSearchers,
          fullSearcher = _prepareSearchers2.fullSearcher;

      var _search2 = this._search(tokenSearchers, fullSearcher),
          weights = _search2.weights,
          results = _search2.results;

      this._computeScore(weights, results);

      if (this.options.shouldSort) {
        this._sort(results);
      }

      return this._format(results);
    }
  }, {
    key: '_prepareSearchers',
    value: function _prepareSearchers() {
      var pattern = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var tokenSearchers = [];

      if (this.options.tokenize) {
        // Tokenize on the separator
        var tokens = pattern.split(this.options.tokenSeparator);
        for (var i = 0, len = tokens.length; i < len; i += 1) {
          tokenSearchers.push(new Bitap(tokens[i], this.options));
        }
      }

      var fullSearcher = new Bitap(pattern, this.options);

      return { tokenSearchers: tokenSearchers, fullSearcher: fullSearcher };
    }
  }, {
    key: '_search',
    value: function _search() {
      var tokenSearchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var fullSearcher = arguments[1];

      var list = this.list;
      var resultMap = {};
      var results = [];

      // Check the first item in the list, if it's a string, then we assume
      // that every item in the list is also a string, and thus it's a flattened array.
      if (typeof list[0] === 'string') {
        // Iterate over every item
        for (var i = 0, len = list.length; i < len; i += 1) {
          this._analyze({
            key: '',
            value: list[i],
            record: i,
            index: i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }

        return { weights: null, results: results };
      }

      // Otherwise, the first item is an Object (hopefully), and thus the searching
      // is done on the values of the keys of each item.
      var weights = {};
      for (var _i = 0, _len = list.length; _i < _len; _i += 1) {
        var item = list[_i];
        // Iterate over every key
        for (var j = 0, keysLen = this.options.keys.length; j < keysLen; j += 1) {
          var key = this.options.keys[j];
          if (typeof key !== 'string') {
            weights[key.name] = {
              weight: 1 - key.weight || 1
            };
            if (key.weight <= 0 || key.weight > 1) {
              throw new Error('Key weight has to be > 0 and <= 1');
            }
            key = key.name;
          } else {
            weights[key] = {
              weight: 1
            };
          }

          this._analyze({
            key: key,
            value: this.options.getFn(item, key),
            record: item,
            index: _i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }

      return { weights: weights, results: results };
    }
  }, {
    key: '_analyze',
    value: function _analyze(_ref2, _ref3) {
      var key = _ref2.key,
          _ref2$arrayIndex = _ref2.arrayIndex,
          arrayIndex = _ref2$arrayIndex === undefined ? -1 : _ref2$arrayIndex,
          value = _ref2.value,
          record = _ref2.record,
          index = _ref2.index;
      var _ref3$tokenSearchers = _ref3.tokenSearchers,
          tokenSearchers = _ref3$tokenSearchers === undefined ? [] : _ref3$tokenSearchers,
          _ref3$fullSearcher = _ref3.fullSearcher,
          fullSearcher = _ref3$fullSearcher === undefined ? [] : _ref3$fullSearcher,
          _ref3$resultMap = _ref3.resultMap,
          resultMap = _ref3$resultMap === undefined ? {} : _ref3$resultMap,
          _ref3$results = _ref3.results,
          results = _ref3$results === undefined ? [] : _ref3$results;

      // Check if the texvaluet can be searched
      if (value === undefined || value === null) {
        return;
      }

      var exists = false;
      var averageScore = -1;
      var numTextMatches = 0;

      if (typeof value === 'string') {
        this._log('\nKey: ' + (key === '' ? '-' : key));

        var mainSearchResult = fullSearcher.search(value);
        this._log('Full text: "' + value + '", score: ' + mainSearchResult.score);

        if (this.options.tokenize) {
          var words = value.split(this.options.tokenSeparator);
          var scores = [];

          for (var i = 0; i < tokenSearchers.length; i += 1) {
            var tokenSearcher = tokenSearchers[i];

            this._log('\nPattern: "' + tokenSearcher.pattern + '"');

            // let tokenScores = []
            var hasMatchInText = false;

            for (var j = 0; j < words.length; j += 1) {
              var word = words[j];
              var tokenSearchResult = tokenSearcher.search(word);
              var obj = {};
              if (tokenSearchResult.isMatch) {
                obj[word] = tokenSearchResult.score;
                exists = true;
                hasMatchInText = true;
                scores.push(tokenSearchResult.score);
              } else {
                obj[word] = 1;
                if (!this.options.matchAllTokens) {
                  scores.push(1);
                }
              }
              this._log('Token: "' + word + '", score: ' + obj[word]);
              // tokenScores.push(obj)
            }

            if (hasMatchInText) {
              numTextMatches += 1;
            }
          }

          averageScore = scores[0];
          var scoresLen = scores.length;
          for (var _i2 = 1; _i2 < scoresLen; _i2 += 1) {
            averageScore += scores[_i2];
          }
          averageScore = averageScore / scoresLen;

          this._log('Token score average:', averageScore);
        }

        var finalScore = mainSearchResult.score;
        if (averageScore > -1) {
          finalScore = (finalScore + averageScore) / 2;
        }

        this._log('Score average:', finalScore);

        var checkTextMatches = this.options.tokenize && this.options.matchAllTokens ? numTextMatches >= tokenSearchers.length : true;

        this._log('\nCheck Matches: ' + checkTextMatches);

        // If a match is found, add the item to <rawResults>, including its score
        if ((exists || mainSearchResult.isMatch) && checkTextMatches) {
          // Check if the item already exists in our results
          var existingResult = resultMap[index];
          if (existingResult) {
            // Use the lowest score
            // existingResult.score, bitapResult.score
            existingResult.output.push({
              key: key,
              arrayIndex: arrayIndex,
              value: value,
              score: finalScore,
              matchedIndices: mainSearchResult.matchedIndices
            });
          } else {
            // Add it to the raw result list
            resultMap[index] = {
              item: record,
              output: [{
                key: key,
                arrayIndex: arrayIndex,
                value: value,
                score: finalScore,
                matchedIndices: mainSearchResult.matchedIndices
              }]
            };

            results.push(resultMap[index]);
          }
        }
      } else if (isArray(value)) {
        for (var _i3 = 0, len = value.length; _i3 < len; _i3 += 1) {
          this._analyze({
            key: key,
            arrayIndex: _i3,
            value: value[_i3],
            record: record,
            index: index
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }
    }
  }, {
    key: '_computeScore',
    value: function _computeScore(weights, results) {
      this._log('\n\nComputing score:\n');

      for (var i = 0, len = results.length; i < len; i += 1) {
        var output = results[i].output;
        var scoreLen = output.length;

        var totalScore = 0;
        var bestScore = 1;

        for (var j = 0; j < scoreLen; j += 1) {
          var weight = weights ? weights[output[j].key].weight : 1;
          var score = weight === 1 ? output[j].score : output[j].score || 0.001;
          var nScore = score * weight;

          if (weight !== 1) {
            bestScore = Math.min(bestScore, nScore);
          } else {
            output[j].nScore = nScore;
            totalScore += nScore;
          }
        }

        results[i].score = bestScore === 1 ? totalScore / scoreLen : bestScore;

        this._log(results[i]);
      }
    }
  }, {
    key: '_sort',
    value: function _sort(results) {
      this._log('\n\nSorting....');
      results.sort(this.options.sortFn);
    }
  }, {
    key: '_format',
    value: function _format(results) {
      var finalOutput = [];

      this._log('\n\nOutput:\n\n', JSON.stringify(results));

      var transformers = [];

      if (this.options.includeMatches) {
        transformers.push(function (result, data) {
          var output = result.output;
          data.matches = [];

          for (var i = 0, len = output.length; i < len; i += 1) {
            var item = output[i];

            if (item.matchedIndices.length === 0) {
              continue;
            }

            var obj = {
              indices: item.matchedIndices,
              value: item.value
            };
            if (item.key) {
              obj.key = item.key;
            }
            if (item.hasOwnProperty('arrayIndex') && item.arrayIndex > -1) {
              obj.arrayIndex = item.arrayIndex;
            }
            data.matches.push(obj);
          }
        });
      }

      if (this.options.includeScore) {
        transformers.push(function (result, data) {
          data.score = result.score;
        });
      }

      for (var i = 0, len = results.length; i < len; i += 1) {
        var result = results[i];

        if (this.options.id) {
          result.item = this.options.getFn(result.item, this.options.id)[0];
        }

        if (!transformers.length) {
          finalOutput.push(result.item);
          continue;
        }

        var data = {
          item: result.item
        };

        for (var j = 0, _len2 = transformers.length; j < _len2; j += 1) {
          transformers[j](result, data);
        }

        finalOutput.push(data);
      }

      return finalOutput;
    }
  }, {
    key: '_log',
    value: function _log() {
      if (this.options.verbose) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }
  }]);

  return Fuse;
}();

module.exports = Fuse;

/***/ })
/******/ ]);
});
//# sourceMappingURL=fuse.js.map

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    /**
     * Stores user search results for the server-users-supplier
     */
    // TODO CONFSRVDEV-2015 - shouldn't store the same User object more than once. Should only store lists of keys in the query map,
    // and then have a separate cross-supplier Map of User objects by key. dT
    var cache = {};
    var queries = [];

    exports.default = function (limit) {
        return {
            add: function add(query, users) {
                cache[query] = {
                    query: query,
                    users: users,
                    isExhausted: users.length < limit
                };

                // Queries list is alph sorted descending so that longer queries are above the shorter queries that
                // they contain.
                queries.push(query);
                queries.sort();
                queries.reverse();
            },

            /**
             * Look in the cache for this query or a shorter one.
             */
            getClosest: function getClosest(query) {
                if (cache[query]) {
                    return cache[query];
                }

                // Else find the longest matching substring of the query.
                // The query list is sorted, so the first item found should be the longest one.
                var queryMatch = queries.find(function (subquery) {
                    return query.indexOf(subquery) === 0;
                });
                if (queryMatch) {
                    return cache[queryMatch];
                }

                return null; // just to make this obvious...
            },

            // Used in tests.
            reset: function reset() {
                cache = {};
                queries = [];
            }
        };
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function escape(query) {
        return [].map.call(query, function escapeSpecialCharacter(char) {
            if (char === '+' || char === '-' || char === '&' || char === '|' || char === '!' || char === '(' || char === ')' || char === '{' || char === '}' || char === '[' || char === ']' || char === '^' || char === '"' || char === '~' || char === '*' || char === '?' || char === ':' || char === '\\') return '\\' + char;
            return char;
        }).join('');
    }

    exports.default = {
        escape: escape
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _userSupplierKeys) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function getCurrentUser() {
        return new Promise(function (resolve) {

            var username = Meta.get('remote-user');
            if (!username) {
                // Anonymous user.
                return resolve();
            }

            var userKey = Meta.get('remote-user-key');
            var displayName = Meta.get('current-user-fullname');
            var path = Meta.get('current-user-avatar-uri-reference');

            resolve({
                type: "known",
                username: username,
                userKey: userKey,
                profilePicture: {
                    path: path,
                    width: 48,
                    height: 48
                },
                displayName: displayName,
                supplier: UserSupplier.CURRENT
            });
        });
    }

    exports.default = {
        getCurrentUser: getCurrentUser
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(16), __webpack_require__(43), __webpack_require__(12), __webpack_require__(44), __webpack_require__(15), __webpack_require__(46), __webpack_require__(47), __webpack_require__(48), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _templates, _resultPlaceholder, _userRanker, _userConverter, _utils, _defaultOrdering, _scoreLogger, _defaultFiltering, _scoreBooster) {
    'use strict';

    var Templates = _interopRequireDefault(_templates).default;

    var ResultPlaceholder = _interopRequireDefault(_resultPlaceholder).default;

    var SearchUsers = _interopRequireDefault(_userRanker).default;

    var ConvertUsers = _interopRequireDefault(_userConverter).default;

    var RenderUtils = _interopRequireDefault(_utils).default;

    var ensureDefaultOrder = _interopRequireDefault(_defaultOrdering).default;

    var scoreLogger = _interopRequireDefault(_scoreLogger).default;

    var filterServerResults = _interopRequireDefault(_defaultFiltering).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   * The contents of the UserCache is passed through the user pipeline which filters, ranks and modifies
                   * the list until we arrive at the final 5 elements to display.
                   *
                   * Want To add another function to the user pipeline? Easy...
                   *
                   * Define a function like the following and add it to a pipeline. Ordering is very important.
                   *
                   * @param results   The results array as supplied by the previous function
                   * @param next      Call this function and pass some results to trigger the next stage of the pipeline
                   * @param context   Some context about the current rendering request. See Mentions.js
                   *
                   * function pipelineTransformation(results, next, context) {
                   *      //Do some things on results
                   *      results.forEach((results) => transform(result))
                   *
                   *      //Remember to call next
                   *      next(results);
                   * }
                   */

    function filterUsingQuery(results, next, context) {
        next(SearchUsers(results, context.query));
    }

    function moveSelectedUserToTop(oldUsers, next, context) {
        if (!context.selectedUser) {
            return next(oldUsers);
        }

        var index = oldUsers.findIndex(function (user) {
            return user.username === context.selectedUser.username;
        });
        // Note that > -1 means that the user IS in the array. If index is 0, the user is already in the correct position
        // at the start of the array and there is nothing to do.
        if (index <= 0) {
            return next(oldUsers);
        }

        // Put this user at the start of the array.
        var user = oldUsers[index];
        var newUsers = oldUsers.slice(0); // clone the array to avoid modifying the original
        newUsers.splice(index, 1);
        newUsers.unshift(user);

        return next(newUsers);
    }

    /**
     * fuseScore is available on all user results for a query-term search, so we can sort at any point in the pipeline.
     */
    function sortOnScore(users, next) {
        if (users.length && typeof users[0].fuseScore === 'number') {
            // If the first result has a fuseScore they all will.
            users.sort(function (user1, user2) {
                return user1.fuseScore - user2.fuseScore;
            });
        }
        next(users);
    }

    function limit(array, next, context) {
        next(array.slice(0, context.DISPLAY_LIMIT));
    }

    // Called in the Server pipeline when there are no results.
    function userNotFound(results, next) {
        if (!results.length) {
            var notFoundResult = RenderUtils.resultWithHtml(Templates.Mentions.userNotFoundResult());
            results = [notFoundResult];
        }

        next(results);
    }

    function empty(results, next) {
        if (!results.length) {
            next([RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder())]);
        } else {
            next(results);
        }
    }

    function addErrorResult(results, next) {
        var failureResult = RenderUtils.resultWithHtml(Templates.Mentions.searchFailureResult());
        next([failureResult]);
    }

    /**
     * This function convert Users from API format to something that the Dropdown can display.
     *
     * All elements in the results array should be Users in API format.
     * If you want to add other elements to the results array, do this *after* convertUsers in the pipeline
     *
     * @param results
     * @param next
     */
    function convertUsers(results, next) {
        next(ConvertUsers(results));
    }

    // Don't continue the render if the query is stale.
    function staleServerResponseFilter(results, next, context) {
        if (context.latestQuery === context.query) {
            next(results);
        }
    }

    exports.default = {

        default: function _default(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterServerResults, ensureDefaultOrder, limit, ScoreBooster.setSuggestedUsers, convertUsers, renderCallback];
        },

        client: function client(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, convertUsers, ResultPlaceholder.startTimeout, empty, renderCallback];
        },
        server: function server(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, staleServerResponseFilter, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, scoreLogger, convertUsers, userNotFound, renderCallback];
        },

        error: function error(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, addErrorResult, renderCallback];
        },

        _functions: {
            moveSelectedUserToTop: moveSelectedUserToTop,
            sortOnScore: sortOnScore
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(15), __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _utils, _templates) {
    'use strict';

    var RenderUtils = _interopRequireDefault(_utils).default;

    var Templates = _interopRequireDefault(_templates).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var displayTimeout = void 0;

    function _padResults(results, context) {
        var additionalElements = context.DISPLAY_LIMIT - results.length;
        if (additionalElements > 0) {
            var placeholder = RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder());
            for (var index = 0; index < additionalElements; index++) {
                results.push(placeholder);
            }
        }
        return results;
    }

    function startTimeout(results, next, context) {
        displayTimeout = setTimeout(function () {
            results = _padResults(results, context);
            next(results);
        }, window.skeletonPlaceholder || 3000); // CONFSRVDEV-3833 Remove once an appropriate value has been found.
        next(results);
    }

    function cancelTimeout(results, next) {
        clearTimeout(displayTimeout);
        next(results);
    }

    exports.default = {
        startTimeout: startTimeout,
        cancelTimeout: cancelTimeout
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(8), __webpack_require__(1), __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _i18n, _userSupplierKeys, _darkFeatures) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var I18n = _interopRequireDefault(_i18n).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var DarkFeatures = _interopRequireDefault(_darkFeatures).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Converts Users from API format to something that the Dropdown can display.
     */
    var contextPath = Meta.get('context-path');

    function getProfilePicture(user) {
        if (user && user.profilePicture && Meta.get('can-view-profile')) {
            // HACK - work around CONFSRVDEV-2936 by removing the dud context-path from the path.
            return user.profilePicture.path.replace('/_' + contextPath, '/_');
        }
        return contextPath + '/images/icons/profilepics/anonymous.svg';
    }

    var converter = function converter(users) {
        var addRecentLozenge = DarkFeatures.isEnabled('smart.mentions.recent.lozenge');
        var linkBase = Meta.get('base-url') + '/display/~';

        return users.map(function (user) {
            var link = linkBase + user.username;

            var lozenge = user.supplier === UserSupplier.RELATED && user.role && user.role.i18n;

            if (!lozenge && addRecentLozenge) {
                // Including a lozenge for Recent helps us see why an item is promoted, but make it opt-in.
                lozenge = user.supplier === UserSupplier.RECENT && I18n('user.supplier.recent');
            }
            // Uncomment this line to see why the results are in the order they are.
            // const lozenge = "" + user.fuseScore;

            return {
                className: 'insert-mentions-dropdown-option',
                name: user.displayName,
                username: user.username,
                href: link, // only used if the user tries to middle-click/open-in-new-tab the dropdown item
                icon: getProfilePicture(user),
                lozenge: lozenge,
                link: link,
                model: user,
                fuseMatches: user.fuseMatches
            };
        });
    };

    // Available for unit testing.
    converter._getProfilePicture = getProfilePicture;

    exports.default = converter;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 45 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_45__;

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _recentUsersSupplier) {
    "use strict";

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
        return typeof obj;
    } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var supplierToScoreMap = {
        "current": 1,
        "recent": 2,
        "related": {
            "creator": 3,
            "contributor": 4,
            "commenter": 5
        },
        "server": 6
    };

    var MAX_SCORE = 100;

    function scoreUser(user) {
        var potentialScore = supplierToScoreMap[user.supplier];

        if (typeof potentialScore === "number") {
            if (typeof user.sortIndex === "number") {
                // This allows us to sort recent users coming out of the cache. The highest calculated score will be just < 3.
                potentialScore += user.sortIndex / (RecentUsers.RECENT_USER_LIMIT + 1);
            }
            return potentialScore;
        }

        // Not a number, probably another object, index into it with role
        // Otherwise, it might have been undefined
        return (typeof potentialScore === "undefined" ? "undefined" : _typeof(potentialScore)) === "object" ? potentialScore[user.role.role] : MAX_SCORE;
    }

    function ensureDefaultOrder(results, next) {
        var sorted = results.sort(function (user1, user2) {
            return scoreUser(user1) - scoreUser(user2);
        });
        next(sorted);
    }

    exports.default = ensureDefaultOrder;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    "use strict";

    exports.default = logScores;

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Just used during development, logs result score information to help us figure out reasons for result order.
     */
    function logScores(results, next, context) {
        if (context.query) {
            AJS.debug("*** Mentions *** user-pipeline/logger: Logging search results for " + context.query);

            results.forEach(function (user) {
                AJS.debug("*** Mentions *** user-pipeline/logger: " + user.displayName + " has a score of " + user.fuseScore);
            });
        }

        next(results);
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    "use strict";

    var DEFAULT_SUPPLIERS = [_userSupplierKeys.RECENT, _userSupplierKeys.CURRENT, _userSupplierKeys.RELATED];

    function filterServerResults(results, next) {
        var filteredUsers = results.filter(function (user) {
            return DEFAULT_SUPPLIERS.indexOf(user.supplier) !== -1;
        });
        next(filteredUsers);
    }

    exports.default = filterServerResults;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function PipelineExecutor(pipeline, context) {
        this.pipeline = pipeline;
        this.context = context;
    }

    PipelineExecutor.prototype.execute = function (input) {
        this._next(0, input);
    };

    PipelineExecutor.prototype._next = function (index, results) {
        this.pipeline[index](results, this._next.bind(this, index + 1), this.context);
    };

    exports.default = PipelineExecutor;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(51), __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _analyticsSupport, _autocompleteManager) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Analytics = _interopRequireDefault(_analyticsSupport).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function publishEventForSelection(user) {
        var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var idd = typeof AutocompleteManager.getInputDrivenDropdown === 'function' && AutocompleteManager.getInputDrivenDropdown();
        if (!idd || !user) {
            AJS.debug("Cannot publish 'confluence.mention.selection' analytics with missing dropdown, user or context.");
            return;
        }

        var query = idd._value || '';
        var dd = idd.dd;
        var index = dd && typeof dd.getFocusIndex === 'function' && dd.getFocusIndex();

        var analyticsData = {
            source: user.model.supplier,
            queryLength: query.length,
            queryWords: query.split(' ').length,
            index: index,
            numberOfSearches: context.numGetDataAndRunCallbackCalls
        };

        // By publishing the supplier source of the selected User, we can determine whether users are finding
        // the users they need from the Smart mentions or whether they still have to wait for the Dumb (server)
        // ones.
        Analytics.publish('confluence.mention.selection', analyticsData);
        AJS.debug("Published 'confluence.mention.selection' event with supplier: " + user.model.supplier);
    }

    /**
     * Updates the state of the current Mention interaction.
     * @param autoCompleteControl
     */
    function updateSession(autoCompleteControl) {
        autoCompleteControl.analytics = Object.assign({
            numGetDataAndRunCallbackCalls: 0
        }, autoCompleteControl.analytics);

        autoCompleteControl.analytics.numGetDataAndRunCallbackCalls += 1;
    }

    exports.default = {
        updateSession: updateSession,
        publishEventForSelection: publishEventForSelection
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_51__;

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_52__;

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_53__;

/***/ })
/******/ ])});;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js/smart-mentions-init.js' */
require([
    'confluence-editor/loader/tinymce-bootstrap',
    'confluence-mentions'
], function (BootstrapManager,
             Mentions) {
    // Main entry point to Smart Mentions logic. To lower page weight, we could potentially pull in the Mentions
    // bundle.js via a WRM.require on the bootstrap init.
    BootstrapManager.addOnInitCallback(Mentions.init);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*
 Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
 MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(b,k,p){function l(e,g){var a=this;a.$el=b(e);a.el=e;a.id=m++;a.$el.bind("destroyed",b.proxy(a.teardown,a));a.$clonedHeader=null;a.$originalHeader=null;a.cachedHeaderHeight=null;a.isSticky=!1;a.hasBeenSticky=!1;a.leftOffset=null;a.topOffset=null;a.init=function(){a.setOptions(g);a.$el.each(function(){var d=b(this);d.css("padding",0);a.$originalHeader=b("thead:first",this);a.$clonedHeader=a.$originalHeader.clone();d.trigger("clonedHeader.stickyTableHeaders",[a.$clonedHeader]);a.$clonedHeader.addClass("tableFloatingHeader");
a.$clonedHeader.css("display","none");a.$originalHeader.addClass("tableFloatingHeaderOriginal");a.$originalHeader.after(a.$clonedHeader);a.$printStyle=b('\x3cstyle type\x3d"text/css" media\x3d"print"\x3e.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}\x3c/style\x3e');a.$head.append(a.$printStyle)});a.updateWidth();a.toggleHeaders();a.bind()};a.destroy=function(){a.$el.unbind("destroyed",a.teardown);a.teardown()};a.teardown=function(){a.isSticky&&
a.$originalHeader.css("position","static");b.removeData(a.el,"plugin_stickyTableHeaders");a.unbind();a.$clonedHeader.remove();a.$originalHeader.removeClass("tableFloatingHeaderOriginal");a.$originalHeader.css("visibility","visible");a.$printStyle.remove();a.el=null;a.$el=null};a.bind=function(){a.$scrollableArea.on("scroll.stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.on("scroll.stickyTableHeaders"+a.id,a.setPositionValues),a.$window.on("resize.stickyTableHeaders"+a.id,a.toggleHeaders));
a.$scrollableArea.on("resize.stickyTableHeaders",a.toggleHeaders);a.$scrollableArea.on("resize.stickyTableHeaders",a.updateWidth)};a.unbind=function(){a.$scrollableArea.off(".stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.off(".stickyTableHeaders"+a.id,a.setPositionValues),a.$window.off(".stickyTableHeaders"+a.id,a.toggleHeaders));a.$scrollableArea.off(".stickyTableHeaders",a.updateWidth)};a.debounce=function(a,b){var d=null;return function(){var c=this,h=arguments;clearTimeout(d);
d=setTimeout(function(){a.apply(c,h)},b)}};a.toggleHeaders=a.debounce(function(){a.$el&&a.$el.each(function(){var d=b(this),h=a.isWindowScrolling?isNaN(a.options.fixedOffset)?a.options.fixedOffset.outerHeight():a.options.fixedOffset:a.$scrollableArea.offset().top+(isNaN(a.options.fixedOffset)?0:a.options.fixedOffset);var f=d.offset();var c=a.$scrollableArea.scrollTop()+h,e=a.$scrollableArea.scrollLeft(),g=a.options.cacheHeaderHeight?a.cachedHeaderHeight:a.$clonedHeader.height(),k=a.isWindowScrolling?
c>f.top:h>f.top;c=(a.isWindowScrolling?c:0)<f.top+d.height()-g-(a.isWindowScrolling?0:h);k&&c?(f=f.left-e+a.options.leftOffset,a.$originalHeader.css({position:"fixed","margin-top":a.options.marginTop,left:f,"z-index":3}),a.leftOffset=f,a.topOffset=h,a.$clonedHeader.css("display",""),a.isSticky||(a.isSticky=!0,a.updateWidth(),d.trigger("enabledStickiness.stickyTableHeaders")),a.setPositionValues()):a.isSticky&&(a.$originalHeader.css("position","static"),a.$clonedHeader.css("display","none"),a.isSticky=
!1,a.resetWidth(b("td,th",a.$clonedHeader),b("td,th",a.$originalHeader)),d.trigger("disabledStickiness.stickyTableHeaders"))})},0);a.setPositionValues=a.debounce(function(){var d=a.$window.scrollTop(),b=a.$window.scrollLeft();!a.isSticky||0>d||d+a.$window.height()>a.$document.height()||0>b||b+a.$window.width()>a.$document.width()||a.$originalHeader.css({top:a.topOffset-(a.isWindowScrolling?0:d),left:a.leftOffset-(a.isWindowScrolling?0:b)})},0);a.updateWidth=a.debounce(function(){if(a.isSticky){a.$originalHeaderCells||
(a.$originalHeaderCells=b("th,td",a.$originalHeader));a.$clonedHeaderCells||(a.$clonedHeaderCells=b("th,td",a.$clonedHeader));var d=a.getWidth(a.$clonedHeaderCells);a.setWidth(d,a.$clonedHeaderCells,a.$originalHeaderCells);a.$originalHeader.css("width",a.$clonedHeader.width());a.options.cacheHeaderHeight&&(a.cachedHeaderHeight=a.$clonedHeader.height())}},0);a.getWidth=function(d){var h=[];d.each(function(d){var c=b(this);if("border-box"===c.css("box-sizing"))c=c[0].getBoundingClientRect(),c=c.width?
c.width:c.right-c.left;else if("collapse"===b("th",a.$originalHeader).css("border-collapse"))if(k.getComputedStyle)c=parseFloat(k.getComputedStyle(this,null).width);else{var f=parseFloat(c.css("padding-left")),e=parseFloat(c.css("padding-right")),g=parseFloat(c.css("border-width"));c=c.outerWidth()-f-e-g}else c=c.width();h[d]=c});return h};a.setWidth=function(a,b,f){b.each(function(b){var c=a[b];f.eq(b).css({"min-width":c,"max-width":c})})};a.resetWidth=function(a,e){a.each(function(a){var c=b(this);
e.eq(a).css({"min-width":c.css("min-width"),"max-width":c.css("max-width")})})};a.setOptions=function(d){a.options=b.extend({},n,d);a.$window=b(a.options.objWindow);a.$head=b(a.options.objHead);a.$document=b(a.options.objDocument);a.$scrollableArea=b(a.options.scrollableArea);a.isWindowScrolling=a.$scrollableArea[0]===a.$window[0]};a.updateOptions=function(b){a.setOptions(b);a.unbind();a.bind();a.updateWidth();a.toggleHeaders()};a.init()}var m=0,n={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,
objHead:"head",objWindow:k,scrollableArea:k,cacheHeaderHeight:!1};b.fn.stickyTableHeaders=function(e){return this.each(function(){var g=b.data(this,"plugin_stickyTableHeaders");g?"string"===typeof e?g[e].apply(g):g.updateOptions(e):"destroy"!==e&&b.data(this,"plugin_stickyTableHeaders",new l(this,e))})}})(jQuery,window);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
define("sticky-table-headers/utils",["jquery"],function(c){var e=function(){return!c("body").hasClass("theme-documentation")};return{isAValidTable:function(a){a=c(a);var d;if(d=e()&&!a.hasClass("stickyTableHeaders")&&0< !a.closest(".columnLayout").length&&0< !a.parents("table").length&&a.find("\x3e thead:first").is(":visible")&&1===a.find("thead").children().length&&1===a.find(".confluenceTh").parent().length)d=0===a.find(".confluenceTh").siblings().length||0===a.find(".confluenceTh").siblings().not(".confluenceTh").length;
return d},bindHorizontalScrolling:function(a,d){var b=d||c(window);a.closest(".table-wrap").scroll(function(){b.trigger("scroll.stickyTableHeaders")})},moveHeaderRowsToTHead:function(a){c(a).each(function(){var a=c(this);if(!(0<a.find("\x3e thead").length)){var b=a.find("\x3e tbody \x3e :first-child \x3e :first-child.confluenceTh");!(0>=b.length||0<b.parent().find("\x3e .confluenceTh[rowspan]").length)&&0< !a.parents("table").length&&0< !a.closest(".columnLayout").length&&(b=c("\x3cthead /\x3e").append(b.parent()),
a.prepend(b))}})},isNotDocumentationTheme:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
define("sticky-table-headers/viewpage",["jquery","ajs","sticky-table-headers/utils"],function(c,h,d){var f,b,g,k=function(a,e){a=c(a).filter(function(){return d.isAValidTable(this)});a.stickyTableHeaders(e).addClass("stickyTableHeaders");g?g.add(a):g=a;e=function(a,e){g.stickyTableHeaders(e)};b&&h.unbind("sticky-table-headers.change.options",b);h.bind("sticky-table-headers.change.options",e);b=e;d.bindHorizontalScrolling(a)};return{initialize:function(){var a=c(".confluenceTable:not(.stickyTableHeaders)"),
e=c(window);if(d.isNotDocumentationTheme()){d.moveHeaderRowsToTHead(a);if(window.MutationObserver){a=document.querySelector("#page")||document.querySelector("#confluence-ui");var g=/sticky|tableFloating|confluenceTh/,b=new MutationObserver(c.debounce(function(a){for(var b=!1,c,d=0,f=a.length;d<f;d++)if(c=a[d].target.className,!g.test(c)){b=!0;break}b&&e.trigger("resize.stickyTableHeaders")},0));f&&f.unobserve&&f.unobserve();b.observe(a,{subtree:!0,attributes:!0,childList:!0});f=b}k(c(".confluenceTable"),
{cacheHeaderHeight:!0})}},setupTable:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
define("sticky-table-headers/editor",["ajs","jquery","sticky-table-headers/utils"],function(f,c,e){var h=function(a){var b={};b.objWindow=c(a.getWin());b.scrollableArea=b.objWindow;b.objDocument=c(a.getDoc());b.objHead=b.objDocument.find("head");return b},g=function(a,b){var d=f.Rte.getEditor();d&&(d=h(d),b=c.extend({},d,b),a=c(a).filter(function(){return e.isAValidTable(this)}),a.stickyTableHeaders(b).addClass("stickyTableHeaders"),e.bindHorizontalScrolling(a,b.objWindow))};return{initialize:function(){var a=
f.Rte.getEditor();a&&(a=c(a.getBody()).find(".confluenceTable"),e.moveHeaderRowsToTHead(a),g(a))},setupTable:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
define("sticky-table-headers",["ajs","sticky-table-headers/viewpage","sticky-table-headers/editor","skate"],function(a,d,b,c){var e=a.debounce(d.initialize,0);return{initialize:function(){a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")||c("confluenceTable",{type:c.types.CLASS,attached:function(a){e()}});a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")&&(a.bind("rte-ready",b.initialize),a.bind("rte-quick-edit-push-state",b.initialize),
a.bind("rte-quick-edit-push-hash",b.initialize))}}});require("sticky-table-headers").initialize();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:macro-analytics-bundle', location = 'frontend/bundles/macro-analytics.bundle.js' */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="http://localhost:8080/target/classes/frontend/bundles",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n={reportMacroInserted:function(e){var t=this.buildAnalyticData("Macro-Inserted",e);return this.reportAnalyticsToBackend(t)},reportMacroEdited:function(e){var t=this.buildAnalyticData("Macro-Edited",e);return this.reportAnalyticsToBackend(t)},reportMacrosDeleted:function(e){var t=this,r=(Array.isArray(e)?e:[e]).map(function(e){return t.buildAnalyticData("Macro-Deleted",e)});return this.reportAnalyticsToBackend(r)},buildAnalyticData:function(e,t){return{eventType:[e],spaceKey:[AJS.params.spaceKey],pageId:[AJS.params.pageId],macroName:[t]}},reportAnalyticsToBackend:function(e){var t=Array.isArray(e)?e:[e];return $.ajax({type:"POST",contentType:"application/json",async:!0,url:AJS.params.baseUrl+"/plugins/servlet/cfm/analytics/macro-usage",data:JSON.stringify(t)}).error(function(){})}};var a="com.adaptavist.confluence.contentFormattingMacros",o=function(e,t){for(var r=[],n=i(),a=e(),o=0;o<a.length;o++){var c=t(a[o]),u=n.filter(function(e){return e.macroName===c});1===u.length&&r.push(u[0])}return r};function i(){return AJS.MacroBrowser.metadataList.filter(function(e){return e.pluginKey===a})}var c=function(){return $("#wysiwygTextarea_ifr")[0].contentWindow.getSelection().getRangeAt(0).cloneContents().querySelectorAll("table.wysiwyg-macro, img.editor-inline-macro")},u=function(e){return e.dataset.macroName},d=function(){return $('div.aui-dropdown ol li.active a[class^="autocomplete-macro"]')},l=function(e){var t=$(e).attr("class");return t.substring("autocomplete-macro-".length+t.indexOf("autocomplete-macro-"))},s=function(){return $("div#macro-insert-container input.macro-name")},f=function(){return $("#avst-custom-dialog-macro-name")},m=function(e){return e.value},p=function(e,t){if("Insert"===e){var r=o(s,m);n.reportMacroInserted(r[0].macroName)}else if("InsertCustomDialog"===e){var a=o(f,m);n.reportMacroInserted(a[0].macroName)}else if("Save"===e){var i=o(c,u);n.reportMacroEdited(i[0].macroName)}else if("SaveCustomDialog"===e){var d=o(function(){return t},function(){return t.find("#avst-custom-dialog-macro-name").attr("value")});n.reportMacroEdited(d[0].macroName)}},v=function(e){if($(e.target).is('a[class*="autocomplete-macro"] span:first-child')){var t=o(d,l);if(!t.length)return;var r=t[0];r.anyParameterRequired||n.reportMacroInserted(r.macroName)}},g=function(e){var t=e.target;if(13===e.keyCode){var r=t.matches("div.macro-input-fields form div.macro-param-div .macro-param-input"),n="submit"===t.type,a=$("#macro-details-page").is(":visible")&&1===$("#macro-details-page").find(".button-panel-button.ok").size();if(!n&&(r||a)){var o=$("div#macro-details-page div.dialog-button-panel button.button-panel-button.ok")[0];p(o.innerText)}}},y=function(){var e=$(".macro-placeholder-property-panel-remove-button"),t=o(c,u);e.size()>0&&e.one("click.removeMacro",function(){n.reportMacrosDeleted([t[0].macroName])})},b=function(e){if(46===e.keyCode||8===e.keyCode){var t=o(c,u);if(!t||!t[0])return;var r=t.map(function(e){return e.macroName});n.reportMacrosDeleted(r)}else if(13===e.keyCode){if($("#autocomplete-dropdown li.active").size()){var a=$("#autocomplete-dropdown li.active").text(),d=(l=a,i().find(function(e){return e.title===l}));d&&!d.anyParameterRequired&&n.reportMacroInserted(d.macroName)}}var l},M=function(e,t){var r=e.target;if(function(e){return e.matches("#buttongroup-dialog #insertButtonGroup")}(r)){var n=r.innerText;p(n+"CustomDialog",t)}else p(e.target.innerText)};function k(){var e;$("#editPageLink").off("click.enterEditMode",k),document.addEventListener("click",y,!0),document.addEventListener("click",v,!0),document.addEventListener("keydown",g,!0),function e(t,r){var n=$(t);if(n.size())return n.ready(function(){r(n)});window.requestAnimationFrame(function(){return e(t,r)})}("#wysiwygTextarea_ifr",function(e){(e.get(0).contentDocument||e.get(0).contentWindow.document).addEventListener("keydown",b,!0)}),e=function(e){e.find(".button-panel-button.ok")[0].addEventListener("click",M(event,e),!0)},document.addEventListener("click",function(){var t=$("#buttongroup-dialog").size()?$("#buttongroup-dialog"):$("#macro-details-page");t.size()&&"hiddenButton"!==event.target.id&&e(t)},!0)}AJS.toInit(function(){AJS.Editor.isVisible()?k():$("#editPageLink").on("click.enterEditMode",k)})}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.Common.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.Common == 'undefined') { ContentFormatting.Macro.Common = {}; }


ContentFormatting.Macro.Common.requiredIcon = function(opt_data, opt_ignored) {
  return '<span class="aui-icon icon-required icon-required-moved"> required</span>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.requiredIcon.soyTemplateName = 'ContentFormatting.Macro.Common.requiredIcon';
}


ContentFormatting.Macro.Common.descriptionDesc = function(opt_data, opt_ignored) {
  return '<div class="description">' + soy.$$escapeHtml('Displayed below the field') + '</div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.descriptionDesc.soyTemplateName = 'ContentFormatting.Macro.Common.descriptionDesc';
}


ContentFormatting.Macro.Common.velocityValueLink = function(opt_data, opt_ignored) {
  return '' + soy.$$escapeHtml('ID (relating to data attribute)');
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.velocityValueLink.soyTemplateName = 'ContentFormatting.Macro.Common.velocityValueLink';
}


ContentFormatting.Macro.Common.footerContent = function(opt_data, opt_ignored) {
  return '<div class="custom-macro-footer"><div class="aui-group aui-group-split"><div class="aui-item"><a class="" href="' + soy.$$escapeHtml(opt_data.docHrefHtml) + '" target="_blank">' + soy.$$escapeHtml('Documentation') + '</a></div><div class="aui-item"><button class="aui-button aui-button-primary button-panel-button ok" id="insertButtonGroup" type="submit">' + soy.$$escapeHtml(opt_data.buttonTitle) + '</button><a class="aui-button aui-button-link" href="#" id="cancelButtonGroup">' + soy.$$escapeHtml('Cancel') + '</a></div></div></div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.footerContent.soyTemplateName = 'ContentFormatting.Macro.Common.footerContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/rest-table-macro.soy' */
// This file was automatically generated from rest-table-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.RestTable.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.RestTable == 'undefined') { ContentFormatting.Macro.RestTable = {}; }


ContentFormatting.Macro.RestTable.dialog = function(opt_data, opt_ignored) {
  return '' + aui.dialog.dialog2({id: 'buttongroup-dialog', titleText: opt_data.title, modal: true, size: 'xlarge', content: '' + ContentFormatting.Macro.RestTable.content(opt_data), footerActionContent: '' + ContentFormatting.Macro.Common.footerContent(soy.$$augmentMap(opt_data, {docHrefHtml: 'https://docs.adaptavist.com/display/CFM4CS/Restful+Table', buttonTitle: opt_data.buttonTitle}))});
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.dialog.soyTemplateName = 'ContentFormatting.Macro.RestTable.dialog';
}


ContentFormatting.Macro.RestTable.content = function(opt_data, opt_ignored) {
  var output = '<div class="module custom-macro-dialog"><form id="buttonGroupForm" class="aui rest-table"><div role="application" class="aui-tabs horizontal-tabs"><ul role="tablist" class="tabs-menu"><li role="presentation" class="menu-item active-tab"><a aria-selected="true" role="tab" id="link-details" href="#tabs-details"><strong>' + soy.$$escapeHtml('Macro Options') + '</strong></a></li></ul><div aria-hidden="false" role="tabpanel" class="tabs-pane active-pane" id="tabs-details"><input id="avst-custom-dialog-macro-name" type="hidden" value="rest-table"><fieldset class="details"><legend>' + soy.$$escapeHtml('Rest Table Details') + '</legend><div class="aui-group aui-group-split"><div class="aui-item group-label"><label for="restURL">' + soy.$$escapeHtml('Resource URL') + '</label><input id="restURL" name="restURL" type="text" value="' + soy.$$escapeHtml(opt_data.restURL ? opt_data.restURL : '') + '" class="text" required="required"/><div class="description">' + soy.$$escapeHtml('URL of json data for table') + '</div></div></div></fieldset><fieldset class="rows"><legend>' + soy.$$escapeHtml('Add Table Column') + '</legend><div class="aui-group"><div class="aui-item create-button-rows"><table class="aui" id="dataTable"><thead><tr><th class="buttonLabel">' + soy.$$escapeHtml('Header') + '</th><th class="buttonValue">' + ContentFormatting.Macro.Common.velocityValueLink(null) + '</th><th class="actions">' + soy.$$escapeHtml('Actions') + '</th></tr></thead><tbody>';
  var valueList34 = opt_data.values;
  var valueListLen34 = valueList34.length;
  for (var valueIndex34 = 0; valueIndex34 < valueListLen34; valueIndex34++) {
    var valueData34 = valueList34[valueIndex34];
    output += ContentFormatting.Macro.RestTable.addRestTableRow({rowIndex: valueIndex34, size: opt_data.values.length, label: valueData34.label, value: valueData34.value});
  }
  output += '</tbody></table></div></div></fieldset></div></div><button class="hiddenButton" id="hiddenButton" type="submit"></button></form></div>';
  return output;
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.content.soyTemplateName = 'ContentFormatting.Macro.RestTable.content';
}


ContentFormatting.Macro.RestTable.addRestTableRow = function(opt_data, opt_ignored) {
  return '<tr id="groupRow' + soy.$$escapeHtml(opt_data.rowIndex) + '"><td class="buttonLabel"><input class="text buttonInputLabel" name="buttonLabel" type="text" value="' + soy.$$escapeHtml(opt_data.label) + '"/></td><td class="buttonValue"><input class="text buttonInputValue" name="buttonValue" type="text" value="' + soy.$$escapeHtml(opt_data.value) + '"/></td><td class="actions"><input onclick="addRestTableRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" type="button" class="aui-button" value="+"/><input onclick="removeRestTableGroupRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" id="removeButton-' + soy.$$escapeHtml(opt_data.rowIndex) + '" type="button" class="aui-button" value="-" ' + ((opt_data.size == 1) ? 'disabled' : '') + '/></td></tr>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.addRestTableRow.soyTemplateName = 'ContentFormatting.Macro.RestTable.addRestTableRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'js/rest-table-macro.js' */
AJS.bind("init.rte", function () {

    //Model for a Rest Table
    function RestTable(params) {

        this.getRestURL = function () {
            return params === undefined ? '' : params.restURL;
        };


        this.getValues = function () {
            if (params === undefined) {
                return [{
                    label: '',
                    value: ''
                }];
            } else {
                var counter = Number(params['counter']);
                var values = [];

                //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
                for (var i = 0; i < counter; i++) {
                    values.push({
                        label: params[i.toString() + '_label'] === undefined ? "" : params[i.toString() + '_label'],
                        value: params[i.toString() + '_value'] === undefined ? "" : params[i.toString() + '_value']
                    });
                }
                return values;
            }
        };
    }

    //Fetches all Label/Values from each row, plus if it's selected.
    function getRowValues(values) {
        var counter = 0;

        //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
        AJS.$('[id^="groupRow"]').each(function () {
            var label = $(this).find("input[name='buttonLabel']").val();
            var value = $(this).find("input[name='buttonValue']").val();

            values[counter + '_label'] = label;
            values[counter + '_value'] = value;

            counter++;
        });

        values['counter'] = counter;

        return values;
    }

    function getRestTableParams() {
        var values = {
            restURL: AJS.$('#restURL').val()
        };

        return getRowValues(values);
    }

    function setupEvents() {
        // Setups Tabs in AJS
        AJS.tabs.setup();

        //Hooks up the Cancel Button
        AJS.$('#cancelButtonGroup').click(function (e) {
            e.preventDefault();
            AJS.dialog2('#buttongroup-dialog').remove();
        });

        //Hooks up the Insert Button
        // The hidden button is required to submit the form because the dialog submit button is outside the form element.
        AJS.$('#insertButtonGroup').click(function () {
            AJS.$('#buttonGroupForm').submit();
        });
    }

    function createRestTable(macro) {

        //Creates a new Rest Table object that holds the parameters
        var restTable = new RestTable(macro.params);

        var dialogAndButtonTitle = macro.body === undefined ?
            "Insert" :
            "Save";
        //Calls the dialog with Edit or Insert accordingly.
        AJS.dialog2(ContentFormatting.Macro.RestTable.dialog({
            title: dialogAndButtonTitle + ' ' + "\u0027Restful Table\u0027 Macro",
            buttonTitle: dialogAndButtonTitle,
            restURL: restTable.getRestURL(),
            values: restTable.getValues()
        })).show();

        AJS.$('#insertButtonGroup').on('click', function (event) {
            AJS.$('#hiddenButton').click();
        });

        AJS.$('#buttonGroupForm').on('submit', function (e) {
            e.preventDefault();

                var t = tinymce.confluence.macrobrowser;

                AJS.Rte.BookmarkManager.restoreBookmark();

                if (t.editedMacroDiv) {
                    delete t.editedMacroDiv;
                }

                //Saves the Macro. Since the values is an array, it needs to convert it to JSON and then parse it back to display.
                tinymce.confluence.macrobrowser.macroBrowserComplete({
                    name: "rest-table",
                    "bodyHtml": undefined,
                    "params": getRestTableParams(),
                    "values": restTable.getValues()
                });

                AJS.dialog2('#buttongroup-dialog').remove();
        });

        setupEvents();
    }

    AJS.MacroBrowser.setMacroJsOverride('rest-table', {opener: createRestTable});
});

//Adds a new row Macro
function addRestTableRow(rowIndex) {
    AJS.$('#dataTable > tbody > tr#groupRow' + rowIndex).after(ContentFormatting.Macro.RestTable.addRestTableRow({
        rowIndex: AJS.$('[id^="groupRow"]').length,
        label: '',
        value: ''
    }));

    AJS.$('[id^="removeButton-"]')[0].disabled = false;
}
//Removes a row from Macro
function removeRestTableGroupRow(rowIndex) {
    AJS.$('#groupRow' + rowIndex).remove();

    if (AJS.$('[id^="removeButton-"]').length == 1) {
        AJS.$('[id^="removeButton-"]')[0].disabled = true;
    }
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:analytics-resource', location = 'js/analytics/loader.js' */
window.define('stiltsoft/handy-macros/analytics/settings',
    ['exports',
        'ajs',
        'stiltsoft/handy-macros/analytics/operations'],
    function (exports, ajs, Operations) {

        const getContextPath = function () {
            return ajs.params.contextPath;
        };

        function getServerInfo() {
            return $.ajax({
                type: 'GET',
                async: true,
                url: getContextPath() + Operations.trackingUrl + "/info",
            }).promise();
        }

        function getSpaceInfo(spaceKey) {
            return $.ajax({
                type: 'GET',
                async: true,
                url: getContextPath() + "/rest/api/space/" + spaceKey,
            }).promise();
        }

        exports.fetch = function () {
            var spaceKey = ajs.params.spaceKey;
            return Operations.fetchState()
                .then(function (state) {
                    if (!state) {
                        return {state: false}
                    }
                    return Promise.all([getServerInfo(), getSpaceInfo(spaceKey)])
                        .then(function (responeses) {
                            return {
                                state: true,
                                pageId: ajs.params.pageId,
                                serverInfo: responeses[0],
                                spaceInfo: responeses[1]
                            }
                        })
                });
        };
    });

window.define('stiltsoft/handy-macros/analytics/loader',
    ['exports',
        'jquery',
        'stiltsoft/handy-macros/analytics/constants'
    ], function (exports, $, Constants) {

        function initGA(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        }

        var eventBuffer = [];
        var eventName = Constants.eventName;

        function defaultProcessEvent(eventActionName, payload) {
            console.log("Store in buffer", eventActionName, payload);
            eventBuffer.push({eventActionName, payload});
        }

        function getDimensionValues(dimensions, payload) {
            return dimensions.reduce(function (result, dimension) {
                const value = payload[dimension.name];
                if (value) {
                    result['dimension' + dimension.index] = value;
                } else {
                    console.log("Expected dimension not found", dimension);
                }
                return result;
            }, {});
        }

        function trackerProcessEvent(tracker) {
            return function (jqueryEvent, eventActionName, json) {
                const payload = JSON.parse(json);
                console.log('Send to GA', eventActionName, payload);
                const eventAction = Constants.EVENT_ACTION_BY_NAME[eventActionName];
                if (eventAction) {
                    const data = getDimensionValues(eventAction.dimensions, payload);
                    tracker.send('event', eventAction.category, eventAction.name, data);
                } else {
                    console.log("Event action not found", eventActionName);
                }
            }
        }

        function applyConfiguration(tracker, config) {
            console.log('Apply configuraton for GA', tracker, config);
            tracker.set('userId', config.serverInfo.userHash);
            tracker.set('dimension1', config.serverInfo.serverHash);
            tracker.set('dimension2', config.serverInfo.licenseTier);
            tracker.set('dimension3', config.serverInfo.pluginVersion);
            tracker.set('dimension4', config.serverInfo.licenseType);
            tracker.set('dimension5', config.serverInfo.deploymentType);
            tracker.set('dimension6', config.spaceInfo.type);
            tracker.set('page', config.pageId);
            return tracker;
        }

        function initAnalytics(trackingId, tracker, settings) {
            return Promise.resolve(applyConfiguration(tracker, settings));
        }

        exports.createAnalytics = function (settings) {
            console.log('Try create analytics');
            const trackingId = 'UA-18056811-44';

            if (trackingId) {
                initGA(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'gaHandy');
                $(document).on(eventName, defaultProcessEvent);
                const flags = {
                    alwaysSendReferrer: false,
                    anonymizeIp: true,
                    cookieFlags: 'secure;samesite=none',
                    cookieDomain: 'auto'
                };
                gaHandy('create', trackingId, flags);
                gaHandy(function (tracker) {
                    initAnalytics(trackingId, tracker, settings)
                        .then(function (tracker) {
                            tracker.send('pageview');
                            console.log("Process postponed events", eventBuffer.length);
                            var processEvent = trackerProcessEvent(tracker);
                            eventBuffer.forEach(function (event) {
                                processEvent(null, event.eventAction, event.payload);
                            })
                            console.log("GA enabled");
                            $(document).off(eventName, defaultProcessEvent);
                            $(document).on(eventName, processEvent);
                        });
                });
            }
        };
    });

window.require([
        'ajs',
        'stiltsoft/handy-macros/analytics/settings',
        'stiltsoft/handy-macros/analytics/loader'],
    function (ajs, Settings, Loader) {
        ajs.toInit(function () {
            Settings.fetch().then(function (settings) {
                if (settings.state) {
                    Loader.createAnalytics(settings);
                }
            });
        });
    });

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'soy/button-macro.soy' */
// This file was automatically generated from button-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HandyButtonMacro.
 */

if (typeof HandyButtonMacro == 'undefined') { var HandyButtonMacro = {}; }


HandyButtonMacro.colorDropDown = function(opt_data, opt_ignored) {
  return '<button id="handy-button-dd" class="aui-button aui-dropdown2-trigger" aria-owns="handy-button-colors" aria-haspopup="true"><a data-color="Blue"><span class="handy-button-color-preview" style="background: #3572b0;"></span>' + soy.$$escapeHtml('Blue') + '</a></button><div id="handy-button-colors" class="aui-style-default aui-dropdown2" style="z-index: 10000"><ul><li><a data-color="Blue"><span class="handy-button-color-preview" style="background: #3572b0;"></span>' + soy.$$escapeHtml('Blue') + '</a></li><li><a data-color="Green"><span class="handy-button-color-preview" style="background: #14892c;"></span>' + soy.$$escapeHtml('Green') + '</a></li><li><a data-color="Red"><span class="handy-button-color-preview" style="background: #d04437;"></span>' + soy.$$escapeHtml('Red') + '</a></li><li><a data-color="Yellow"><span class="handy-button-color-preview" style="background: #f6c342;"></span>' + soy.$$escapeHtml('Yellow') + '</a></li><li><a data-color="Gray"><span class="handy-button-color-preview" style="background: #f5f5f5; color: black; font-weight: bold;"></span>' + soy.$$escapeHtml('Gray') + '</a></li></ul></div>';
};
if (goog.DEBUG) {
  HandyButtonMacro.colorDropDown.soyTemplateName = 'HandyButtonMacro.colorDropDown';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'soy/tip-macro.soy' */
// This file was automatically generated from tip-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HandyTipMacro.
 */

if (typeof HandyTipMacro == 'undefined') { var HandyTipMacro = {}; }


HandyTipMacro.link = function(opt_data, opt_ignored) {
  return '<a href="#handytip-' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$filterNoAutoescape(opt_data.html) + '</a>';
};
if (goog.DEBUG) {
  HandyTipMacro.link.soyTemplateName = 'HandyTipMacro.link';
}


HandyTipMacro.dialog = function(opt_data, opt_ignored) {
  return '<section id="handy-tip-link-dialog" class="aui-dialog2 aui-dialog2-small" role="dialog" data-aui-modal="true" data-aui-remove-on-hide="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Edit Handy Tip Link') + '</h2></header><div class="aui-dialog2-content"><form class="aui"><div class="field-group"><label for="handy-tip-link-id">' + soy.$$escapeHtml('Handy Tip link id') + '</label><input id="handy-tip-link-id" class="text" type="text" value="' + soy.$$escapeHtml(opt_data.id) + '"></div></form></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button handy-tip-link-save">' + soy.$$escapeHtml('Save') + '</button><button class="aui-button aui-button-link handy-tip-link-cancel">' + soy.$$escapeHtml('Cancel') + '</button></div><div class="aui-dialog2-footer-hint"><a href="https://docs.stiltsoft.com/pages/viewpage.action?pageId=10650568" target="_blank">' + soy.$$escapeHtml('Documentation') + '</a></div></footer></section>';
};
if (goog.DEBUG) {
  HandyTipMacro.dialog.soyTemplateName = 'HandyTipMacro.dialog';
}


HandyTipMacro.panelGoToBtn = function(opt_data, opt_ignored) {
  return '<a href="#" class="aui-button link-property-panel-goto-button first"><span class="icon  "></span><span class="panel-button-text">' + soy.$$escapeHtml('Go to contents') + '</span></a>';
};
if (goog.DEBUG) {
  HandyTipMacro.panelGoToBtn.soyTemplateName = 'HandyTipMacro.panelGoToBtn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'js/status-macro.js' */
(function ($) {
    window.HandyStatusMacro = function () {
        var self = this;

        self.macro = null;
        self.macroParams = null;
        self.set = null;
        self.status = null;
        self.outline = null;
        self.setSelect = null;
        self.statusSelect = null;
        self.outlineInput = null;
    };

    HandyStatusMacro.prototype.init = function (onChange, onUnlicensed, onSetInit, onInitSetError, onStatusInit, saveAsync, onSave) {
        var self = this;

        self.onChange = onChange;
        self.onUnlicensed = onUnlicensed;
        self.onSetInit = onSetInit;
        self.onInitSetError = onInitSetError;
        self.onStatusInit = onStatusInit;
        self.saveAsync = saveAsync;
        self.onSave = onSave;
    };

    HandyStatusMacro.prototype.bindInputEvents = function () {
        var self = this;

        self.setSelect.bind('change', function () {
            if (self.set != self.setSelect.val()) {
                self.status = undefined;
            }
            self.set = self.setSelect.val();
            self.width = self.setSelect.find('option:selected').data('width');
            self.initStatusSelect();
        });

        self.statusSelect.bind('change', function () {
            self.status = self.statusSelect.val();
            self.macroParams["Status"] = self.statusSelect.find('option:selected').text();
            self.onChange();
        });

        self.outlineInput.bind('change', function () {
            self.outline = self.outlineInput.is(':checked');
            self.onChange();
        });
    };

    HandyStatusMacro.prototype.initInputs = function () {
        var self = this;

        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'GET',
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/status/get-macro',
            async: false,
            cache: false,
            dataType: 'json',
            data: {
                contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                id: self.macroParams['id']
            },
            success: function (data) {
                self.macroParams['id'] = data.id + '';
                self.set = data.set;
                self.status = data.status;
                self.outline = data.outline;
                self.labelled = data.labelled;
                self.prefix = data.prefix;
                self.width = data.width;
                self.initOutlineInput();
                self.initSetSelect();
                if (!data.licensed) {
                    self.setSelect.add(self.statusSelect).add(self.outlineInput).add($('.status-handy-outline')).hide();
                    self.onUnlicensed();
                }
            }
        });
    };

    HandyStatusMacro.prototype.initOutlineInput = function () {
        var self = this;
        self.outlineInput.prop('checked', self.outline);
    };

    HandyStatusMacro.prototype.initSetSelect = function () {
        var self = this;

        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'GET',
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/config/categories/get',
            dataType: 'json',
            data: {
                category: self.set,
                spaceKey: AJS.params.spaceKey
            },
            success: function (data) {
                self.setSelect.empty();
                AJS.params.currentUserFullname
                var globalOptions = $();
                var spaceOptions = $();
                var personalOptions = $();
                $.each(data, function (i, statusesSet) {
                    var selected = "";
                    if (self.set == statusesSet.id) {
                        selected = ' selected';
                    }
                    var disabled = statusesSet.isEmpty ? ' disabled title="' + "Set is empty" + '"' : '';
                    var width = statusesSet.viewType == 0 ? 88 : (statusesSet.width + 12);
                    var option = $("<option value='" + statusesSet.id + "'" + selected + disabled +
                        " data-parent='" + statusesSet.parent + "' data-width='" + width + "'></option>")
                        .text(statusesSet.name);

                    if (statusesSet.name.indexOf(AJS.params.spaceKey + ": ") === 0) {
                        spaceOptions = spaceOptions.add(option);
                    } else if (statusesSet.name.indexOf(AJS.params.currentUserFullname + ": ") === 0) {
                        personalOptions = personalOptions.add(option);
                    } else {
                        globalOptions = globalOptions.add(option);
                    }
                });

                addGroup(globalOptions, "Global");
                addGroup(spaceOptions, "Space");
                addGroup(personalOptions, "Personal");

                self.setSelect.trigger('change');
                self.onSetInit(data);
            },
            error: self.onInitSetError
        });

        function addGroup(options, label) {
            if (options.length) {
                var group = $('<optgroup label="' + label + '"></optgroup>');
                group.append(options);
                self.setSelect.append(group);
            }
        }
    };

    HandyStatusMacro.prototype.initStatusSelect = function () {
        var self = this;

        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'GET',
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/config/statuses/get',
            dataType: 'json',
            data: {
                category: self.set,
                status: self.status
            },
            success: function (data) {
                self.statusSelect.empty();
                if (data.statuses.length > 0) {
                    $.each(data.statuses, function (i, statusObject) {
                        var selected = "";
                        if (self.status == statusObject.id) {
                            selected = 'selected';
                        }

                        self.statusSelect.append($("<option value='" + statusObject.id + "'" + selected + "></option>").text(statusObject.title));
                    });

                    self.statusSelect.trigger('change');
                    self.onStatusInit();
                }
            }
        });
    };

    HandyStatusMacro.prototype.saveMacro = function () {
        var self = this;

        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'POST',
            cache: false,
            async: self.saveAsync,
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/status/change-macro',
            dataType: 'json',
            data: {
                contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                macroId: self.macroParams['id'],
                status: self.status,
                outline: self.outline,
                set: self.set,
                labelled: self.labelled,
                prefix: self.prefix
            },
            success: self.onSave
        });
    };

})(jQuery);



}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'js/editor/status-editor.js' */
window.define('stiltsoft/HandyStatusEditor',
    [
        'jquery'
    ],
    function ($) {

        var HandyStatusEditor = {

            statusMacro: null,
            macro: null,

            init: function () {
                var self = this;
                if (self.initialised) return;
                self.initialised = true;

                self.statusMacro = new HandyStatusMacro();
                var nop = function () {
                };
                self.statusMacro.init(self.statusMacro.saveMacro, nop, nop, nop, nop, true, function (data) {
                    self.statusMacro.macroParams.id = "" + data;
                    var src = '/plugins/servlet/status-handy/placeholder?set=' + self.statusMacro.set + '&outline=' +
                        self.statusMacro.outline + '&status=' + self.statusMacro.status + '&width=' + self.statusMacro.width;
                    self.macro.attr('src', Confluence.getContextPath() + src);
                    self.macro.attr('width', self.statusMacro.width);
                    self.macro.attr('data-mce-src', AJS.params.baseUrl + src);
                    self.macro.attr('data-macro-parameters', Confluence.MacroParameterSerializer.serialize(self.statusMacro.macroParams));
                });
                self.bindInsert();
            },

            bindInsert: function () {
                var self = this;

                self.iframe = $('#wysiwygTextarea_ifr');
                self.contents = self.iframe.contents();
                self.isDiary = self.iframe.parents(".sc-diary").length > 0 && self.iframe.parents(".entries").length === 0;

                var onInsert = function (target) {
                    if (target.attributes && target.attributes['data-macro-name'] && target.attributes['data-macro-name'].value === 'status-handy') {
                        self.updatePastedMacro($(target));
                    } else if (target.querySelectorAll) {
                        $(target.querySelectorAll('[data-macro-name="status-handy"]')).each(function () {
                            self.updatePastedMacro($(this));
                        });
                    }
                };

                var observerCallback = function (events) {
                    events.forEach(function (event) {
                        event.addedNodes.forEach(function (node) {
                            onInsert(node);
                        });
                    });

                    self.isDiary = false;
                };
                var observer = new MutationObserver(observerCallback);
                observer.observe(self.contents[0], {childList: true, subtree: true});

                AJS.bind("created.property-panel", function (e, data) {
                    if (data.type === 'macro') {
                        self.macro = $(data.anchor);
                        if (self.macro.attr('data-macro-name') === 'status-handy' && data.panel.find('label.status-handy-outline').length === 0) {
                            self.statusMacro.macroParams = Confluence.MacroParameterSerializer.deserialize(self.macro.attr('data-macro-parameters'));
                            self.initPanel(data.panel);
                            self.bindInputs();
                            self.statusMacro.onChange = function () {
                                var diff = $(window).width() - parseInt(data.panel.css('left')) - data.panel.width() - 25;
                                if (diff < 0) {
                                    data.panel.css('left', parseInt(data.panel.css('left')) + diff);
                                    var arrow = data.panel.find('.aui-tip-parent');
                                    arrow.css('left', parseInt(arrow.css('left')) - diff);
                                }
                                self.statusMacro.saveMacro();
                            };
                            self.statusMacro.bindInputEvents();
                            self.statusMacro.initInputs();
                        }
                    }
                });
            },

            initPanel: function (panel) {
                var self = this;

                self.statusMacro.setSelect = $("<select class='select macro-property-panel-status-handy-set'></select>");
                self.statusMacro.statusSelect = $("<select class='select macro-property-panel-status-handy-status'></select>");
                self.statusMacro.outlineInput = $("<input type='checkbox' class='checkbox macro-property-panel-status-handy-outline'>");
                self.cloneBtn = $('<button class="aui-button macro-placeholder-property-panel-clone-handy-set"' +
                    'title="' + "Copy the status set to your profile configuration and get a capability to modify these statuses" + '"><span class="icon aui-icon aui-icon-small aui-iconfont-add"></span></button>');
                var panelButtons = panel.find('.panel-buttons');
                panelButtons.append(self.statusMacro.setSelect);
                panelButtons.append(self.statusMacro.statusSelect);
                panelButtons.append(self.statusMacro.outlineInput);
                panelButtons.append(self.cloneBtn);
                self.statusMacro.setSelect.parent().wrap('<form class="aui status-handy-panel-form"></form>');
                self.statusMacro.outlineInput.before("<label class='status-handy-outline'>" + "Use outline style" + "</label>");
            },

            bindInputs: function () {
                var self = this;

                self.statusMacro.setSelect.change(function () {
                    var option = self.statusMacro.setSelect.find('option:selected');
                    var val = self.statusMacro.setSelect.val();
                    var isOwn = option.text().trim().indexOf(AJS.params.currentUserFullname) === 0;
                    var isCopied = self.statusMacro.setSelect.find('option[data-parent="' + val + '"]').length > 0;
                    if (isOwn || isCopied) {
                        self.cloneBtn.prop('disabled', true);
                        self.cloneBtn.attr('title', isOwn ? "This set is already in your profile." :
                            "You have a copy of this set in your profile configuration.");
                    } else {
                        self.cloneBtn.prop('disabled', false);
                        self.cloneBtn.attr('title', "Copy the status set to your profile configuration and get a capability to modify these statuses");
                    }
                });

                self.cloneBtn.click(function () {
                    self.cloneBtn.prop('disabled', true);
                    $.ajax({
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        type: 'POST',
                        cache: false,
                        async: false,
                        url: Confluence.getContextPath() + '/rest/status-macro/1.0/config/category/clone',
                        dataType: 'json',
                        data: {
                            id: self.statusMacro.setSelect.val()
                        },
                        success: function () {
                            self.statusMacro.initInputs();
                        }
                    });
                    return false;
                });
            },

            updatePastedMacro: function (macro) {
                var self = this;
                var macroParams = Confluence.MacroParameterSerializer.deserialize(macro.attr('data-macro-parameters'));

                if (self.isDiary || self.contents.find('img[data-macro-parameters*="id=' + macroParams.id + '"]').length > 1) {
                    $.ajax({
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        type: 'POST',
                        cache: false,
                        url: Confluence.getContextPath() + '/rest/status-macro/1.0/status/clone-macro',
                        dataType: 'json',
                        data: {
                            contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                            id: macroParams.id
                        },
                        success: function (id) {
                            macroParams.id = "" + id;
                            macro.attr('data-macro-parameters', Confluence.MacroParameterSerializer.serialize(macroParams));
                        }
                    });
                }
            }
        };

        return HandyStatusEditor;

    });

window.require(['ajs', 'stiltsoft/HandyStatusEditor'], function (AJS, HandyStatusEditor) {
    AJS.bind("init.rte", function () {
        HandyStatusEditor.init();
    });
});


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'js/editor/reminder-editor.js' */
(function ($) {

    AJS.bind("init.rte", function() {
        var onPastePreProcess = function(ed, o) {
            var elements = $('<div/>').append(o.content);
            elements.find('img[data-macro-name="handy-reminder"]').each(function() {
                var macro = $(this);
                var macroParams = Confluence.MacroParameterSerializer.deserialize(macro.data('macro-parameters'));
                $.ajax({
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    type: 'POST',
                    cache: false,
                    async: false,
                    url: Confluence.getContextPath() + '/rest/status-macro/1.0/reminder/clone-macro',
                    dataType: 'json',
                    data: {
                        contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                        id: macroParams.id
                    },
                    success: function(id) {
                        macroParams.id = "" + id;
                        macro.attr('data-macro-parameters', Confluence.MacroParameterSerializer.serialize(macroParams));
                    }
                });
            });
            o.content = elements.html();
        };

        var onPaste = tinymce.activeEditor.plugins.confluencepaste || tinymce.activeEditor.plugins.aePaste;
        if (onPaste.onPreProcess) {
            onPaste.onPreProcess.listeners.push({
                cb: onPastePreProcess
            });
        } else {
            tinymce.activeEditor.on("PastePreProcess", function (o) { onPastePreProcess(tinymce.activeEditor, o) });
        }
    });

})(jQuery);



}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'js/editor/button-editor.js' */
(function ($) {

    window.HandyButtonEditor = {

        init: function() {
            var self = this;
            self.bindInsert();
        },

        bindInsert: function() {
            var self = this;

            AJS.bind("created.property-panel", function (e, data) {
                if (data.type == 'macro') {
                    var macro = $(data.anchor);
                    if (macro.attr('data-macro-name') == 'button-handy' && data.panel.find('.button-handy-panel-form').length == 0) {
                        self.initPanel(data.panel, macro);

                        AJS.bind("destroyed.property-panel.handy", function() {
                            AJS.unbind("destroyed.property-panel.handy");
                            $('#handy-button-colors').hide();
                        });
                    }
                }
            });
        },

        initPanel: function(panel, macro) {
            var self = this;

            $('#handy-button-colors').remove();

            var nameInput = $("<input class='text macro-property-panel-button-handy-name'>");
            var urlInput = $("<input class='text macro-property-panel-button-handy-yrl autocomplete-confluence-content' data-none-message='" + "Not Found" + "'>");
            var colorSelect = $(HandyButtonMacro.colorDropDown());

            var panelButtons = panel.find('.panel-buttons');
            panelButtons.append(nameInput);
            panelButtons.append(colorSelect);
            panelButtons.append(urlInput);
            urlInput.wrap('<div class="handy-btn-url-wrapper"></div>');
            var arrow = panel.find('.property-panel-bottom-arrow');
            arrow.css('top', (parseInt(arrow.css('top')) + 35) + 'px');

            nameInput.parent().wrap('<form class="aui button-handy-panel-form"></form>');
            nameInput.before("<label class='button-handy-label'>" + "Label" + "</label>");
            urlInput.before("<label class='button-handy-label'>" + "Page title or URL" + "</label>");

            var params = Confluence.MacroParameterSerializer.deserialize(macro.attr('data-macro-parameters'));
            var colorBtn = panelButtons.find('#handy-button-dd');
            var as = panelButtons.find('#handy-button-colors a');

            colorBtn.html(as.filter('[data-color="' + params['color'] + '"]').clone());
            nameInput.val(params['name']);
            urlInput.val(params['link']);

            var diff = $(window).width() - parseInt(panel.css('left')) - panel.width() - 25;
            if (diff < 0) {
                panel.css('left', parseInt(panel.css('left')) + diff);
                var arrow = panel.find('.aui-tip-parent');
                arrow.css('left', parseInt(arrow.css('left')) - diff);
            }

            as.mouseup(function() {
                var a = $(this);
                var clone = a.clone();
                colorBtn.html(clone);
                params['color'] = a.data('color');
                self.saveMacro(params, macro);
            }).click(function() {
                colorBtn.trigger("aui-button-invoke");
                return false;
            });

            var timer = null;

            nameInput.bind('keyup', function() {
                if (timer) {
                    clearTimeout(timer);
                    timer = null;
                }
                timer = setTimeout(function() {
                    self.input = nameInput;
                    var val = nameInput.val().trim();
                    if (val && val != params['name']) {
                        params['name'] = val;
                        self.saveMacro(params, macro);
                    }
                }, 300);
            });

            urlInput.bind('keyup', function() {
                if (timer) {
                    clearTimeout(timer);
                    timer = null;
                }
                timer = setTimeout(function() {
                    self.input = urlInput;
                    var val = urlInput.val().trim();
                    if (val && val != params['link']) {
                        params['link'] = val;
                        self.saveMacro(params, macro);
                    }
                }, 300);
            });

            nameInput.add(urlInput).bind('keypress', function(e) {
                if (e.keyCode == 13) {
                    return false;
                }
            });

            Confluence.Binder.autocompleteConfluenceContent();
            self.bindAutocompleteUrlInput(urlInput);
        },

        saveMacro: function(params, macro) {
            $.ajax({
                type: 'POST',
                url: AJS.contextPath() + "/rest/tinymce/1/macro/placeholder",
                dataType: 'text',
                contentType: "application/json; charset=utf-8",
                data: $.toJSON({
                    contentId: AJS.Meta.get('content-id') || "0",
                    macro: {
                        name: 'button-handy',
                        params: params
                    }
                }),
                success: function(img) {
                    var $img = $(img);
                    macro.attr('src', $img.attr('src'));
                    macro.attr('height', $img.attr('height'));
                    macro.attr('width', $img.attr('width'));
                    macro.attr('data-macro-parameters', $img.attr('data-macro-parameters'));
                }
            });
        },

        bindAutocompleteUrlInput: function (input) {
            var container = input.parent();
            input.bind('keyup', function () {
                var value = input.val();
                container.toggleClass('hide-autocomplete', value.indexOf('http://') === 0 || value.indexOf('https://') === 0 || value.indexOf('#') !== -1);
            });

            input.bind('quick-search-loading-stop', function () {
                container.find('.aui-dropdown').width(input.outerWidth() - 2 + 'px');
            });
        }
    };

    AJS.bind("init.rte", function() {
        HandyButtonEditor.init();
    });

})(jQuery);



}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:status-editor-resources', location = 'js/editor/handy-tip-editor.js' */
(function ($, AnalyticsExtender) {

    const HandyTipEditor = {

        selector: 'a[href*="handytip-"]',

        init: function() {
            this.contents = $('#wysiwygTextarea_ifr').contents();
            this.bindInsert();
            this.bindPanel();
        },

        bindInsert: function() {
            const self = this;
            $('#macro-insert-list #insert-handy-tip').click(function() {
                AJS.Rte.getEditor().setDirty(true);
                const id = ("" + Math.random()).substring(2);
                if (self.insertHighlight(id)) {
                    console.log('Inserted');
                    self.sendAnalyticsInsertEvent('Handy Tip');

                    const macroRenderRequest = {
                        contentId: Confluence.Editor.getContentId(),
                        macro: {
                            name: 'handy-tip',
                            body: '',
                            params: {id: id}
                        }
                    };
                    tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest);
                }
                $(document).click();
                AJS.Rte.getEditor().focus();
                return false;
            });
        },

        insertHighlight: function (id) {
            const self = this;
            const editor = AJS.Rte.getEditor();
            const selection = editor.selection;
            const html = selection.getContent({'format': 'html'});
            if(html && html.length > 0) {
                if (this.hasSelectionTips($(selection.getStart()), $(selection.getEnd()), html)) {
                    alert("The selected text already contains a Handy Tip.");
                    return false;
                }

                const aLink = HandyTipMacro.link({id: id, html: html});
                tinymce.confluence.NodeUtils.replaceSelection(aLink);
                AJS.Rte.BookmarkManager.storeBookmark();
                
                return true;
            } else {
                alert("Please, select text to add a Handy Tip.");
                return false;
            }
        },

        hasSelectionTips: function(start, end, html) {
            return end.add(start).parents(this.selector).length || $('<div/>').append(html).find(this.selector).length;
        },

        bindPanel: function () {
            const self = this;

            AJS.bind("created.property-panel", function (e, data) {
                var link;
                if (data.type === 'image' && data.panel.find('.image-link-edit').length) {
                    link = $(data.anchor).parents('a');
                } else if (data.type === 'link') {
                    link = $(data.anchor);
                }

                if (link && link.length) {
                    const href = link.attr('href');
                    if (href.indexOf('handytip-') !== -1) {
                        const id = href.split('handytip-')[1];
                        const editBtn = data.panel.find('.link-property-panel-edit-button, .image-link-edit');

                        if (data.type === 'image') {
                            editBtn.before(HandyTipMacro.panelGoToBtn());
                            editBtn.removeClass('first');
                        }

                        const gotoBtn = data.panel.find('.link-property-panel-goto-button');

                        gotoBtn.removeClass('disabled').attr('aria-disabled', false).css('pointer-events', '');
                        gotoBtn.text("Go to contents");
                        gotoBtn.click(function () {
                            const macro = self.contents.find('.wysiwyg-macro[data-macro-name="handy-tip"][data-macro-parameters*="id=' + id + '"]');
                            self.contents.find('html').animate({
                                scrollTop: macro.offset().top - 50
                            }, {
                                duration: 400,
                                complete: function () {
                                    AJS.log(macro);
                                    macro.trigger('click');
                                }
                            });
                            return false;
                        });

                        editBtn.unbind('click').click(function () {
                            const dialog = $(HandyTipMacro.dialog({id: id}));
                            const saveBtn = dialog.find('.handy-tip-link-save');
                            const cancelBtn = dialog.find('.handy-tip-link-cancel');
                            const input = dialog.find('#handy-tip-link-id');

                            input.bind('input', function () {
                                saveBtn.prop('disabled', !input.val().trim());
                            });

                            saveBtn.click(function () {
                                link.attr('href', '#handytip-' + input.val().trim());
                                AJS.dialog2(dialog).hide();
                            });

                            cancelBtn.click(function () {
                                AJS.dialog2(dialog).hide();
                            });

                            AJS.dialog2(dialog).show();

                            return false;
                        });
                    }
                }
            });

            AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-handy-tip-link", function(e, macroNode) {
                const macro = $(macroNode);
                const id = Confluence.MacroParameterSerializer.deserialize(macro.attr('data-macro-parameters')).id;
                const link = self.contents.find('a[href*="handytip-' + id + '"]');
                self.contents.find('html').animate({
                    scrollTop: link.offset().top - 100
                }, {
                    duration: 400,
                    complete: function () {
                        tinymce.activeEditor.selection.select(link[0]);
                    }
                });
            });
        }
    };

    AnalyticsExtender.extendObject(HandyTipEditor);

    AJS.bind("init.rte", function() {
        HandyTipEditor.init();
    });

})(AJS.$,require('stiltsoft/handy-macros/analytics/client/extender'));




}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.playsql.playsql-base-plugin:playsql-macro-editor', location = 'assets/core/js/playsql-macro-editor.js' */
AJS.bind("init.rte", function() {
    var dialog;
    var editor = {
        html : function(){
            var src = PlaySQL.SPI.contextPath + '/plugins/servlet/I2SS/browser?' + $.param({
                    spaceKey: AJS.Meta.get('space-key'),
                    ceoId: AJS.Meta.get('content-id') || AJS.Meta.get('page-id')
                });
            var $iframe = $("<iframe></iframe>")
                .attr('id', 'playsql-editor-preview')
                .attr('src', src)
                .css('border', 'none');
            editor.iframe = $iframe[0];
            return $iframe;
        },
        init : function(body, params){
            this.body = body;
            if (typeof params == "string") {
                params = AJS.$.parseJSON(params);
            };
            this.params = params;
            var repeatHandler = window.setInterval(function(){
                var subWindow = editor.iframe.contentWindow;
                if (subWindow && subWindow.PlaySQLBrowser && subWindow.PlaySQLBrowser.initialized) {
                    window.clearInterval(repeatHandler);
                    subWindow.PlaySQLBrowser.synchronizeValues($.extend({sql:body}, params));
                    subWindow.PlaySQLBrowser.query();
                }
            }, 100);
        },
        /** Gather the configuration and the body, for example before a save */
        getMacroParams : function(){
            var subWindow = editor.iframe.contentWindow;
            if (!subWindow.PlaySQLBrowser || !subWindow.PlaySQLBrowser.initialized) {
                return;
            }

            var data = subWindow.PlaySQLBrowser.synchronizeValues();
            // Note that we should never save 'open-browser', because that would make the browser to open by default.
            var propertiesToSave = [/*'readonly'*/, 'space-key', 'context', 'timeout', 'user-parameters',
                'built-in-parameters', 'orderby', 'groupby'];
            this.params = {};
            for (var i = 0; i < propertiesToSave.length; i++) {
                var parameter = propertiesToSave[i];
                if (data[parameter]) {
                    this.params[parameter] = data[parameter];
                    // If using the current space, don't save it
                    if (parameter == 'context' && ('space:' + AJS.Meta.get('space-key')) == data[parameter]) {
                        delete this.params[parameter];
                    }
                }
            }
            if (data.sql) {
                this.body = data.sql;
            }
            return {
                body : this.body,
                params : this.params
            };
        }
    };

});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.playsql.playsql-base-plugin:playsql-macro-editor', location = 'assets/core/query/query-rte.js' */
/**
 * This file overrides the queryId field for the Macro Browser
 */
AJS.bind("init.rte", function() {
    var $ = AJS.$;
    function fillValues() {
        var context = PlaySQL.SPI.contextForPage,
            url = PlaySQL.SPI.baseUrl0("queries", context);
        $.ajax({
            url: url,
            type: 'GET',
            dataType: "json"
        }).done(function(data){
            var $select = $("#macro-param-queryId"),
                originalValue = $select.val();
            $select.empty();
            addValue($select, "undefined", "Select a value");
            for (var key in data) {
                if (!data.hasOwnProperty(key)) continue;
                addValue($select, key, data[key]);
            }
            setQueryId($select, originalValue);
            updateUserParameters();
        }).fail(function(data){
            AJS.logError("Can't fetch the list of queries for space:" + spaceKey)
        });
    }
    function addValue($select, value, text) {
        $select.append(AJS.$("<option/>", {
            value: value,
            text: text
        }));
    }
    function setQueryId($select, id) {
        $select.val(id);
        if (id != undefined && $select.val() !== id) {
            addValue($select, id, "Query");
            $select.val(id);
        }
    }
    var makeParameterDiv = AJS.MacroBrowser.makeParameterDiv;
    if (makeParameterDiv == null) {
        /**
         * This function existed until 5.6.0, so here's a copy for ulterior versions...
         */
        makeParameterDiv = function (metadata, param, jsOverride) {
            var t = AJS.MacroBrowser, field;
            var type = param.type.name;

            // Plugin point - other JS files can define more specific field-builders based on macro name, param name and
            // type.
            if (jsOverride) {
                var builder = jsOverride.fields && jsOverride.fields[type];
                if (builder && typeof builder != "function") {
                    // Types can be overridden for specific parameters - so the "type" object contains a "name" function.
                    builder = builder[param.name];
                }
                if (typeof builder == "function") {
                    field = builder.call(jsOverride, param);
                }
            }
            // If no override specific to the macro, look for general overrides specific to the parameter type.
            if (!field) {
                if (!(type in t.ParameterFields && typeof t.ParameterFields[type] == "function")) {
                    type = "string";
                }
                field = t.ParameterFields[type](param);
            }

            t.fields[param.name] = field;
            var paramDiv = field.paramDiv;
            var input = field.input;

            var paramId = "macro-param-" + param.name;
            paramDiv.attr("id", "macro-param-div-" + param.name);
            input.addClass("macro-param-input").attr("id", paramId);
            if (param.hidden) {
                paramDiv.hide();
            }

            // Use param label and desc or correct fallback.
            var pluginKey = metadata.pluginKey;
            if (param.displayName == AJS.MacroBrowser.Utils.makeDefaultKey(pluginKey, metadata.macroName, "param", param.name, "label")) {
                param.displayName = param.name;
            }
            if (param.description == AJS.MacroBrowser.Utils.makeDefaultKey(pluginKey, metadata.macroName, "param", param.name, "desc")) {
                param.description = "";
            }

            var labelText = param.displayName;
            if (param.required) {
                labelText += " *";
                paramDiv.addClass("required");  // set class against div, not input, to allow styling of label if nec
            }
            $("label", paramDiv).attr("for", paramId).text(labelText);

            if (param.description) {
                paramDiv.append(Confluence.Templates.MacroBrowser.macroParameterDesc({ description: param.description }));
            }
            return paramDiv;
        }
    }

    function updateUserParameters() {
        var queryIdField = AJS.MacroBrowser.fields["queryId"],
            queryId = queryIdField.getValue(),
            queryName = $("#macro-param-queryId option:selected").text(),
            oldQueryId = queryIdField.loadedQueryId,
            currentContext = AJS.MacroBrowser.fields['context'].getValue(),
            spaceKey = (currentContext.indexOf("space:") == 0 ? currentContext.substr(6) : AJS.Meta.get("space-key"));
        if (queryId === oldQueryId) {
            return;
        }
        queryIdField.loadedQueryId = queryId;
        // In IE8, make sure the MacroBrowser knows required fields have values
        AJS.MacroBrowser.paramChanged();

        AJS.MacroBrowser.fields["queryName"].setValue(queryName);

        for (var fieldName in AJS.MacroBrowser.fields) {
            if (fieldName.indexOf("user-parameter-") == 0) {
                AJS.MacroBrowser.fields[fieldName].remove();
            }
        }

        if (queryId == undefined || queryId == "undefined") {
            var $description = $("#macro-param-div-queryId .macro-param-desc"),
                $createLink = $("<a></a>", {
                        href : PlaySQL.SPI.contextPath + "/playsql-base-plugin/query-editor.action?key=" + spaceKey + "&create=true",
                        target : "_blank",
                        text : "or create a new query..."
                    });
            if ($description.size() == 0) {
                $description = $("#macro-param-div-queryId")
                    .append("<div class='macro-param-desc'></div>")
                    .find("div");
            }
            $description.unbind().empty().html($createLink);
        } else {
            var $description = $("#macro-param-div-queryId .macro-param-desc"),
                $editLink = $("<a></a>", {
                    href : PlaySQL.SPI.contextPath + "/playsql-base-plugin/query-editor.action?key=" + spaceKey + "&queryId=" + queryId,
                    text : "Edit the query...",
                    target : "_blank"
                });
            if ($description.size() == 0) {
                $description = $("#macro-param-div-queryId")
                    .append("<div class='macro-param-desc'></div>")
                    .find("div");
            }
            $description.unbind().empty().html($editLink);

            var url = PlaySQL.SPI.baseUrl0("queries", currentContext, queryId);
            $.ajax({
                url: url,
                type: 'GET',
                dataType: "json"
            }).done(function(data){
                if (!data || !data.userParameters)
                {
                    return;
                }
                var userParamList = data.userParameters,
                    queryName = data.label,
                    $macroFieldArea = $("#macro-insert-container .macro-input-fields"),
                    $form = $macroFieldArea.find("form"),
                    metadata = AJS.MacroBrowser.getMacroMetadata("playsql-query"),
                    userParam, name, $paramDiv, $input, field, value;
                // Update the query name, if required
                $macroFieldArea.find("#macro-param-queryId option[value='" + queryId + "']").text(queryName);
                AJS.MacroBrowser.fields["queryName"].setValue(queryName);

                // Since Confluence 5.6.0, .macro-input-fields contains a form and it's required to use it
                if ($form.length > 0) $macroFieldArea = $form;

                for (var i=0 ; i < userParamList.length ; i++) {
                    userParam = userParamList[i];
                    name = "user-parameter-" + userParam.name.replace(/[^\w]/gi, '');
                    $paramDiv = makeParameterDiv.call(AJS.MacroBrowser, metadata, {name: name, displayName: userParam.label, type: {name: "string"}});
                    $input = $paramDiv.find("input");
                    value = AJS.MacroBrowser.unknownParams[name];

                    $macroFieldArea.append($paramDiv);
                    field = AJS.MacroBrowser.Field($paramDiv, $input, {});
                    field.remove = (function($paramDiv, name, field) {
                        return function() {
                            AJS.MacroBrowser.unknownParams[name] = field.getValue();
                            $paramDiv.remove();
                        }
                    })($paramDiv, name, field);
                    field.userParameterName = name;
                    if (value != undefined) {
                        field.setValue(value);
                    } else if (userParam.defaultValue != undefined) {
                        field.setValue(userParam.defaultValue);
                    }
                    AJS.MacroBrowser.fields[name] = field;
                }
                $("#macro-browser-preview-link").click();
            }).fail(function(data){
                AJS.logError("Can't fetch the query for space:" + spaceKey)
            });
        }
    }

    /** Creates a new query, displays it in a new tab, and report its ID into
     * the drop-down
     */
    function createNewQuery() {
        var currentUser = AJS.Meta.get("current-user-fullname"),
            query = {
                label : "New query" + (currentUser ? " by " + currentUser: ""),
                sql : ""
            },
            context = PlaySQL.SPI.contextForPage,
            spaceKey = context.substr("space:".length);
            url = PlaySQL.SPI.baseUrl0("queries", context),
            windowUrl = PlaySQL.SPI.contextPath + "/playsql-base-plugin/query-editor.action?key=" + spaceKey + "&queryId=",
            //newTab = window.open(windowUrl, 'newtab'),
            $link = $(this);
        $link.unbind().text("Edit the query...");
        $.ajax({
            url: url,
            type: 'POST',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: JSON.stringify(query)
        }).done(function(data){
            if (data.id != undefined) {
                var windowNewUrl = windowUrl + data.id
                // Update the link
                $link.attr('href', windowNewUrl).attr("target", "newtab");
                // Reset the tab's url
                //newTab.location.href = newTab.location.href.replace(windowUrl, windowNewUrl);
                // Update the $select
                var $select = $("#macro-param-queryId");
                addValue($select, "" + data.id, query.label);
                setQueryId($select, "" + data.id);
            }
        }).fail(function(jqXHR, error, reason){
            AJS.logError("Error while attempting to create a query. " + error + " - " + reason);
        });
        return false;
    }

    var jsOverrides = {
        "fields" : {
            "string" : function(params, options){
                options = options || {};
                if (params && params.name != "queryId") {
                    return AJS.MacroBrowser.ParameterFields["string"](params, options);
                }

                var $paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var $select = $("select", $paramDiv);

                options.setValue = function(value) {
                    setQueryId($("#macro-param-queryId"), value);
                }

                fillValues();

                options.onchange = updateUserParameters;

                var field = AJS.MacroBrowser.Field($paramDiv, $select, options);
                field.updateQuery = function(){
                    updateUserParameters();
                    $("#macro-browser-preview-link").click();
                }
                return field;

            }
        },
        "beforeParamsSet": function(paramMap, inserting) {
            if (!paramMap["context"]) {
                paramMap["context"] = "space:" + AJS.Meta.get("space-key");
            }
            // This is a migration from older versions. It happens when we open the
            // Macro Browser.
            if (paramMap["hideRedCell"]) {
                paramMap["output-rendering"] = "POOR";
                delete paramMap["hideRedCell"];
            }
            if (paramMap["hideHeaders"]) {
                paramMap["output-rendering"] = "TEXT";
                delete paramMap["hideHeaders"];
            }
            return paramMap;
        },
        "beforeParamsRetrieved" : function(paramMap, macro, sharedParamMap) {
            for (var fieldName in paramMap) {
                if (fieldName.indexOf('user-parameter') == 0) {
                    delete paramMap[fieldName];
                }
            }
            for (var fieldName in AJS.MacroBrowser.fields) {
                if (fieldName.indexOf("user-parameter-") == 0) {
                    var userField = AJS.MacroBrowser.fields[fieldName],
                        val = userField.getValue(),
                        name = userField.userParameterName;
                    paramMap[name] = val;
                }
            }
            return paramMap;
        }
    };
    AJS.MacroBrowser.setMacroJsOverride("playsql-query", jsOverrides);


    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("playsql-edit-query", function(e, macroNode) {
        var parameters = PlaySQL.Helpers.parseMacroParams($(macroNode));
        if (!parameters) return;
        var queryId = parameters["queryId"];
        var context = parameters["context"];
        if (!queryId || !context || context.indexOf(":") == -1) return;
        var spaceKey = context.split("space:")[1] || AJS.Meta.get("space-key");
        if (queryId != undefined) {
            window.open(PlaySQL.SPI.contextPath + "/playsql-base-plugin/query-editor.action?" + $.param({
                key : spaceKey,
                queryId : queryId
            }));
        }
    });
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.playsql.playsql-base-plugin:playsql-macro-editor', location = 'assets/core/spreadsheet/spreadsheet-rte.js' */
/**
 * This file overrides the spreadsheetId field for the Macro Browser
 */
AJS.bind("init.rte", function() {
    var $ = AJS.$;
    var readonly = false;

    function generateJsOverrides(macroType) {
        function fillValues() {
            var context = PlaySQL.SPI.contextForPage;
            var url;

            if(macroType === 'SPREADSHEET') {
                url = PlaySQL.SPI.baseUrl(context, {
                    recentlyViewed: true,
                    includeQueries: false
                });
            } else if(macroType === 'CHART') {
                url = PlaySQL.SPI.baseUrl0('charts', context);
            }

            $.ajax({
                url: url,
                type: 'GET',
                dataType: "json"
            }).done(function(data, status, jqXHR){
                var $select = $("#macro-param-spreadsheetId"),
                    originalValue = $select.val(),
                    mode = jqXHR.getResponseHeader("X-MODE");
                $select.empty();
                addValue($select, ["", "Select a value"]);
                for (var key = 0 ; key < data.length ; key++) {
                    if (!data.hasOwnProperty(key)) continue;
                    addValue($select, data[key]);
                }
                setSpreadsheetId($select, originalValue);

                readonly = (mode != "READ_WRITE");
                updateUserParameters();
            }).fail(function(data){
                AJS.logError("Can't fetch the list of spreadsheets for " + context)
            });
        }
        function addValue($select, data) {
            var $target = $select,
                spreadsheetId = data[0],
                spreadsheetLabel = data[1],
                type = data[2];
            // types 'undefined' and 'SPREADSHEET' don't use an optgroup
            if (!!type) {
                if (macroType == "CHART" && type != "CHART") return;
                if (macroType == "SCRIPT" && type != "SCRIPT") return;
                if ((!macroType || macroType == "SPREADSHEET") && ["SCRIPT", "CHART"].indexOf(type) != -1) return;

                $target = $select.find("optgroup[data-key=" + type + "]");
                if ($target.size() == 0) {
                    var label = type == "JOINT_TABLE" ? "Joint Tables"
                        : type == "SPREADSHEET" ? "Spreadsheets"
                        : type == "QUERY" ? "Queries"
                        : type == "RECENTLY_VIEWED" ? "Recently viewed"
                        : type == "SCRIPT" ? "Scripts"
                        : type == "CHART" ? "Charts"
                        : type;
                    $select.append($("<optgroup>", {
                        "data-key": type,
                        "label": label
                    }));
                    $target = $select.find("optgroup[data-key=" + type + "]");
                }
            }

            $target.append(AJS.$("<option/>", {
                value: spreadsheetId,
                text: spreadsheetLabel,
                "data-type": type
            }));
        }
        function setSpreadsheetId($select, id) {
            $select.val(id);
            if (id != undefined && $select.val() !== id) {
                addValue($select, [id, id + " (invalid spreadsheet)"]);
                $select.val(id);
            }
        }
        function updateUserParameters() {
            var spreadsheetIdField = AJS.MacroBrowser.fields["spreadsheetId"],
                spreadsheetId = spreadsheetIdField.getValue(),
                oldSpreadsheetId = spreadsheetIdField.loadedSpreadsheetId,
                // spaceKey is the current space, in any case
                spaceKey = AJS.Meta.get("space-key"),
                // context is the context of the spreadsheet. Doesn't have to be space-based.
                context = "space:" + spaceKey,
                simpleSpreadsheetId = spreadsheetId;
            if (spreadsheetId === oldSpreadsheetId) {
                return;
            }
            spreadsheetIdField.loadedSpreadsheetId = spreadsheetId;
            if (spreadsheetId.indexOf(".") != -1) {
                context = spreadsheetId.split(".")[0];
                simpleSpreadsheetId = spreadsheetId.split(".")[1];
            }
            AJS.MacroBrowser.fields["context"].setValue(context);

            // In IE8, make sure the MacroBrowser knows required fields have values
            AJS.MacroBrowser.paramChanged();

            if (readonly) {
                // The space is read-only, but we could very well be willing to insert a spreadsheet from another space,
                // so we won't just remove everything.
                /*var $replaceAllParams = $("#macro-param-div-spreadsheetId");
                 $replaceAllParams.empty().html("This space is read-only. You cannot have Spreadsheets in this space.");
                 $replaceAllParams.parent().find(".macro-param-div:not(#macro-param-div-spreadsheetId)").remove();*/
            }

            var $description = $("#macro-param-div-spreadsheetId .macro-param-desc");
            if ($description.size() == 0) {
                $description = $("#macro-param-div-spreadsheetId")
                    .append("<div class='macro-param-desc'></div>")
                    .find("div");
            }
            if (!spreadsheetId || spreadsheetId == "undefined") {
                // No spreadsheet selected. Suggest to create one, if the space is read-write.
                if (readonly) {
                    $description.empty();
                } else {
                    var $createLink = '';
                    if(macroType === 'SPREADSHEET') {
                        $createLink = $("<a></a>", {
                            href: PlaySQL.SPI.contextPath + "/playsql-base-plugin/index.action?" + $.param({key: spaceKey}) + "#create-spreadsheet",
                            text: "or create a new spreadsheet...",
                            target: "_blank"
                        });
                    } else if(macroType === 'CHART') {
                        $createLink = $("<a></a>", {
                            href: PlaySQL.SPI.contextPath + "/playsql-base-plugin/chart-editor.action?key=" + spaceKey + "&create=true",
                            text: "or create a new chart...",
                            target: "_blank"
                        });
                    }
                    $description.empty().html($createLink);
                }
            } else {
                // Spreadsheet selected
                if (context.indexOf("space:") == 0) {
                    spaceKey = context.substring("space:".length);
                }
                var $macroFieldColumns = $("#macro-param-div-display-columns"),
                    $editLink = '';
                if(macroType === 'SPREADSHEET') {
                    $editLink = $("<a></a>", {
                        href : PlaySQL.SPI.contextPath + "/playsql-base-plugin/spreadsheet-editor.action?key=" + spaceKey + "&spreadsheetId=" + simpleSpreadsheetId,
                        text : "Edit the spreadsheet...",
                        target : "_blank"
                    });
                } else if(macroType === 'CHART') {
                    $editLink = $("<a></a>", {
                        href: PlaySQL.SPI.contextPath + "/playsql-base-plugin/chart-editor.action?key=" + spaceKey + "&id=" + simpleSpreadsheetId,
                        text: "Edit the chart...",
                        target: "_blank"
                    });
                }
                $description.empty().html($editLink);
                $macroFieldColumns.removeClass("managed").find(".managed-col").remove();

                var url = PlaySQL.SPI.baseUrl(context + "/" + simpleSpreadsheetId);
                $.ajax({
                    url: url,
                    type: 'GET',
                    dataType: "json"
                }).done(function(data){
                    if (!data || !data.tableDef) {
                        return;
                    }
                    var spreadsheetName = data.tableDef.label || data.tableDef.name,
                        $macroFieldArea = $("#macro-insert-container .macro-input-fields");
                    // Update the spreadsheet name, if required
                    $macroFieldArea.find("#macro-param-spreadsheetId option[value='" + spreadsheetId + "']").text(spreadsheetName);

                    // If known, list fields as tickboxes and let the user choose some more fields
                    $macroFieldColumns.addClass("managed");

                    function addColumn(name, label, custom, ticked, hidden) {
                        var $colDesc = $("<div></div>", {
                                "class": "checkbox",
                                html: "<input type='checkbox' class='managed-col checkbox'>"
                                + "<label class='managed-col'></label>"
                            }),
                            $input = $colDesc.find("input");
                        $label = $colDesc.find("label");

                        $input.attr("id", "display-" + name);
                        $label.attr("for", "display-" + name).text(label);
                        if (custom) {
                            $input.addClass("custom");
                            $label.addClass("custom");
                        }
                        if (ticked) {
                            $input.attr("checked", "on");
                        }
                        if (hidden) {
                            $input.addClass("hidden");
                            $label.addClass("hidden");
                        }
                        $macroFieldColumns.append($colDesc);
                    }

                    for (var i=0 ; i < data.tableDef.columns.length ; i++) {
                        var col = data.tableDef.columns[i],
                            hidden = col.name == "ID" || col.name == "POSITION";
                        addColumn(col.name, col.label, false, true, hidden);
                    }
                    // We'll deactivate that for now
                    // addColumn("add-field", "Add a calculated column...", true, false, false);

                    if (!$macroFieldColumns.attr("data-managed-events")) {
                        $macroFieldColumns.attr("data-managed-events", "true");
                        function editCol(colId) {
                            var $label = $("label[for='" + colId + "']");
                            var $newInput = $("<input>", {
                                id: "for-" + colId,
                                "class": "custom-col-label",
                                value: $label.text()
                            });
                            $label.replaceWith($newInput);
                            $newInput.focus().select();
                        }
                        $macroFieldColumns.on("change", "input.custom", function(){
                            var $checkbox = $(this),
                                $label = $checkbox.next(),
                                id = $checkbox.attr("id");
                            if (id == "display-add-field") {
                                // Create an ID and assign it
                                id = "display-" + $macroFieldColumns.find("input").size();
                                $checkbox.attr("id", id);
                                $label.attr("for", id).text("Write SQL formula");
                                addColumn("add-field", "Add a calculated column...", true, false);
                                editCol(id);
                            }
                        }).on("dblclick", "label.custom", function(){
                            var id = $(this).attr("for");
                            editCol(id);
                        }).on("blur", "input.custom-col-label", function(){
                            var id = $(this).attr("id").substr(4);
                            $(this).replaceWith($("<label>", {
                                "for": id,
                                text: $(this).val(),
                                "class": "managed-col custom"
                            }));
                        }).on("change", "input", function() {
                            var $checkboxes = $("#macro-param-div-display-columns input.checkbox"),
                                ticked = [],
                                unticked = [],
                                fields;
                            $checkboxes.each(function () {
                                var $cb = $(this),
                                    isTicked = $cb.is(":checked"),
                                    id = $cb.attr("id").substr(8);
                                if (isTicked) {
                                    ticked.push(id);
                                } else {
                                    unticked.push(id);
                                }
                            });
                            if (unticked.length == 0) {
                                fields = "*";
                            } else {
                                fields = "";
                                $.each(ticked, function(i, el) {
                                    if (i > 0) fields += ", ";
                                    fields += el;
                                });
                            }
                            AJS.MacroBrowser.fields["display-columns"].setValue(fields);
                        });
                    }
                }).fail(function(data){
                    AJS.logError("Can't fetch the spreadsheet for space:" + spaceKey)
                });
            }
            $("#macro-browser-preview-link").click();
        }

        return {
            "fields": {
                "string": function (params, options) {
                    options = options || {};
                    if (params && params.name == "spreadsheetId") {
                        var $paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                        var $select = $("select", $paramDiv);

                        options.setValue = function (value) {
                            setSpreadsheetId($("#macro-param-spreadsheetId"), value);
                        }

                        fillValues(macroType);

                        options.onchange = updateUserParameters;

                        var field = AJS.MacroBrowser.Field($paramDiv, $select, options);
                        field.updateSpreadsheet = updateUserParameters;
                        return field;
                    } else if (params && params.name == "display-columns") {
                        var $paramDiv = $(Confluence.Templates.MacroBrowser.macroParameter());
                        var $input = $("input", $paramDiv);

                        options.setValue = function (value) {
                            if ($input.data("working")) return;
                            $input.val(value);
                            $input.data("working", true);
                            var fields = value.split(/[", ]+/);
                            for (var i=0 ; i < fields.length ; i++) {
                                if ($.trim(fields[i]).length > 0) {
                                    var $el = $paramDiv.find("input.checkbox[id='display-" + $.trim(fields[i]) + "']");
                                    if ($el.size() > 0) {
                                        if (!$el.is(":checked")) {
                                            $el.attr("checked", "on");
                                        }
                                    }
                                }
                            }
                            $input.data("working", false);
                        }

                        return AJS.MacroBrowser.Field($paramDiv, $input, options);
                    } else {
                        return AJS.MacroBrowser.ParameterFields["string"](params, options);
                    }
                }
            },
            "beforeParamsSet": function (paramMap, inserting) {
                if (!paramMap["context"]) {
                    paramMap["context"] = "space:" + AJS.Meta.get("space-key");
                } else {
                    // Check spreadsheetId is: {context}.{ss}
                    var spreadsheetId = paramMap["spreadsheetId"];
                    if (spreadsheetId && spreadsheetId.indexOf(".") == -1) {
                        paramMap["spreadsheetId"] = paramMap["context"] + "." + spreadsheetId;
                    }
                }
                return paramMap;
            },
            "beforeParamsRetrieved": function (paramMap, macro, sharedParamMap) {
                var spreadsheetId = paramMap["spreadsheetId"];
                if (spreadsheetId && spreadsheetId.indexOf(".") != -1) {
                    paramMap["context"] = spreadsheetId.split(".")[0];
                    paramMap["spreadsheetId"] = spreadsheetId.split(".")[1];
                }
                return paramMap;
            }
        };
    }

    AJS.MacroBrowser.setMacroJsOverride("playsql-spreadsheet", generateJsOverrides('SPREADSHEET'));
    AJS.MacroBrowser.setMacroJsOverride("playsql-chart", generateJsOverrides('CHART'));

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("playsql-edit-spreadsheet", function(e, macroNode) {
        var parameters = $(macroNode).attr("data-macro-parameters");
        if (typeof parameters != "string") return;
        parameters = parameters.split("|");
        var spreadsheetId,
            spaceKey = AJS.Meta.get("space-key"),
            context = "space:" + spaceKey;
        for (var i=0 ; i < parameters.length ; i++) {
            if (parameters[i].indexOf("spreadsheetId=") == 0) {
                spreadsheetId = parameters[i].substr("spreadsheetId=".length);
            } else if (parameters[i].indexOf("context") == 0) {
                context = parameters[i].substr("context=".length);
                if (context.indexOf("space:") == 0) {
                    spaceKey = context.substr("space:".length);
                }
            }
        }
        if (spreadsheetId != undefined) {
            window.open(PlaySQL.SPI.contextPath + "/playsql-base-plugin/spreadsheet-editor.action?" + $.param({
                key : spaceKey,
                spreadsheetId : spreadsheetId
            }));
        }
    });
});


AJS.$(function ($) {
    var $doc = $(document).bind('postPaste', function (e, pl, o) {
        // Find out what is being pasted
        var $pasted = $(o.node),
            $table = $pasted.find("table.playsql, table.spreadsheet");
        if ($table.size() == 0) {
            // That's not a paste of a spreadsheet
            return;
        }
        var context = $table.attr("data-context") || $table.attr("data-context");
        var spreadsheetId = $table.attr("data-macro-spreadsheet-id");
        var queryId = $table.attr("data-macro-query-id");
        var theoreticalDisplayColumns = $table.attr("data-macro-display-columns");
        var columns = $table.find("thead tr.playsql-col-headers th:not(:first-child)").map(function(){return $(this).attr("data-name")});
        var $firstColumn = $table.find("thead tr.playsql-col-headers th:first-child");
        var idColumnName = $firstColumn.attr("data-name");
        var positionColumnName = $firstColumn.attr("data-metadata-name");
        var displayColumns = columns.length > 0 ? columns.toArray().join(", ") : theoreticalDisplayColumns;
        var theoreticalWhereClause = $table.attr("data-macro-where-clause");
        var rowIds = $table.find("tbody tr").map(function(){return $(this).attr("data-row-id");});
        // Check whether we want the first columns to be ID and POSITION, or PLAYSQL_ID/PLAYSQL_POSITION, or nothing (which breaks the macro).
        if (idColumnName) {
            if (positionColumnName) {
                displayColumns = idColumnName + "," + positionColumnName + "," + displayColumns;
            } else {
                displayColumns = idColumnName + "," + displayColumns;
            }
        } else {
            idColumnName = "ID";
        }
        var whereClause = rowIds.length > 0 ? '"' + idColumnName + '" in (' + rowIds.toArray().join(', ') + ")" : theoreticalWhereClause;
        if (spreadsheetId == undefined) {
            if (queryId != undefined) {
                spreadsheetId = "QUERY-" + queryId;
            }
        }

        var macroRenderRequest = {
            contentId: AJS.Meta.get('content-id') || "0",
            macro: {
                name: "playsql-spreadsheet",
                params: {
                    context: context,
                    "display-columns": displayColumns,
                    spreadsheetId: spreadsheetId,
                    "where-clause": whereClause
                },
                defaultParameterValue: undefined
            }
        };

        $table.find("thead tr.playsql-col-headers th").map(function(index, th){return $(th).attr("data-name")})

        // Yeah kill the copy-paste!
        o.node = document.createElement("p");
        o.content="<p></p>";
        AJS.log("A Play SQL spreadsheet paste was recognized");

        window.setTimeout(function(){
            // And paste our macro
            tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest);
        }, 0);
    });

    // Swap the handlers around, so our postPaste gets ahead of the others.
    var currentBindings = $doc.data('events')['postPaste'];
    if ($.isArray(currentBindings)) {
        currentBindings.unshift(currentBindings.pop());
    }
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte",function(){AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile",function(a,b){a=AJS.$(b);var c={};a.attr("data-macro-parameters")&&AJS.$.each(a.attr("data-macro-parameters").split("|"),function(a,b){a=b.split("\x3d");c[a[0]]=a[1]});window.open(AJS.Confluence.getBaseUrl()+"/display/~"+c.User).opener=null})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(d){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewdoc",["doc","docx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewpdf",["pdf"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewxls",["xls","xlsx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewppt",["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(b){var a=b.params[""]||b.params.name;if(a){var c=a.lastIndexOf(".");0<c&&(a=a.substring(c+1))&&("doc"==a&&"docx"==
a&&(b.name="viewdoc"),"pdf"==a&&(b.name="viewpdf"),"ppt"==a&&"pptx"==a&&(b.name="viewppt"),"xls"==a&&"xlsx"==a&&(b.name="viewxls"))}}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:a5e718a0ad93d5655dd4fbcdbabdc576', location = 'build/a5e718a0ad93d5655dd4.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[12],{11:function(e,t,a){"use strict";var l=a(4),n=a.n(l),o=a(0),r=a(14),s=a.n(r),i=new RegExp("TFaC-sq","g"),c=new RegExp("TFaC-dq","g"),p=new RegExp("TFaC-vd","g"),u=new RegExp("TFaC-bs","g"),f=new RegExp("TFaC-vq","g"),d=new RegExp("TFaC-vga","g"),m=new RegExp('"(.*?)"',"gm"),T=new RegExp("FROM (T\\d+) ((\\w* )?JOIN T\\* \\w* ((T\\d+)\\..+ = T\\*\\.(`.+?`)|([^\\s])))"),g=new RegExp("'([^']+?)' AS '(.+?)'","gi"),v={normalizeSql:function(e,t){var a,l=e.sql.replace(/\n/g," ");for(l=l.replace(/\\"/g,"TFaC-dq"),m.lastIndex=0;a=m.exec(l);){var n=a[0].length,r=a[1].replace(c,'"'),s=o.a.getAnyValueType(r,e.separator,e.worklog,!0,e.dateFormat,e.locales);null!=s?(r=""+v.getValue(r,s,e),l=l.replace(a[0],r)):(r=a[1],new RegExp("'|`|TFaC-dq").test(r)&&(r='"'+r.replace(/'/g,"TFaC-vq").replace(/`/g,"TFaC-vga").replace(c,"TFaC-vd")+'"',l=l.replace(a[0],r))),n-=r.length,m.lastIndex===a.index&&m.lastIndex++,m.lastIndex+=n}if(-1!==(l=l.replace(c,'"').replace(/\\'/g,"TFaC-sq").replace(/'/g,"`").replace(/\\/g,"TFaC-bs")).indexOf("FROM T*")){var i=l.indexOf("FROM T*"),p=v.findParentheses(l,i),u=l,f="",d="";-1!==p.start&&-1!==p.end&&(f=l.substring(0,p.start+1),d=l.substring(p.end),u=l.substring(p.start+1,p.end));var g=[];$.each(t.jsons,(function(e){g.push(u.replace("T*",e))})),g.length&&(l=f+g.join(" UNION ALL CORRESPONDING ")+d)}if(-1!==l.indexOf("JOIN T*")&&(a=T.exec(l))){var h=a[1],x=a[2],b=[],y=[a[4]];$.each(t.jsons,(function(e,t){h!==e&&(b.push(x.replace(a[4],y.join(" OR ")).replace(/T\*/g,e)),y.push(a[4].replace(a[5],e)))})),l=l.replace(x,b.join(" "))}return l},convertTablesToJSON:function(e,t){var a={},l={};return e.tables.forEach((function(e,n){if(e.length>0){var r=e[0];r.forEach((function(e,t){e.text?-1!==r[t].text.indexOf("`")&&-1!==r[t].text.indexOf("]")&&(r[t].text=r[t].text.replace(/`/g,"'")):r[t].text="_",r[t].text=r[t].text.replace(/\\/g,"TFaC-bs").replace(/'/g,"TFaC-sq"),l[r[t].text]||(l[r[t].text]={htmlColName:r[t].html})}));var s=[],i=[],c=[];e.forEach((function(e,a){if(a>0){var n={};e.forEach((function(e,a){if(!i[a]&&e.text){var c=o.a.getAnyValueType(e.text,t.separator,t.worklog,!0,t.dateFormat,t.locales);switch(s[a]=c,c){case 0:case 1:case 2:case 3:i[a]="number";break;default:i[a]="string"}}var p;try{null===(p=e.text?v.getValue(e.text,s[a],t):null)&&e.text&&(p=e.text)}catch(t){p=e.text}n[r[a].text]=p,l[r[a].text][p]=e.html})),c.push(n)}})),r.forEach((function(e,t){i[t]||(i[t]="string",s[t]=null)})),a["T"+(n+1)]={table:c,columns:r,fieldTypes:i,types:s}}})),{jsons:a,valueViewMap:l}},prepareAlaSql:function(e,t){n.a.options.cache=!1,$.each(n.a.tables,(function(e){n()("DROP TABLE "+e)})),$.each(e.jsons,(function(e,t){var a=[];t.columns.forEach((function(e,l){var n=e.text;n=-1!==n.indexOf("`")?"["+n+"] ":"`"+n+"` ",a.push(n+t.fieldTypes[l])}));var l="CREATE TABLE "+e+" ("+a.join(", ")+")";n()(l),n.a.tables[e].data=t.table})),n.a.fn.FORMATDATE=function(e){if("number"==typeof e){var a=new Date;a.setTime(e),e=a}return o.a.formatDate(e,t.dateFormat,t.locales)},n.a.fn.FORMATTIME=function(e){return o.a.formatDuration(e)},n.a.fn.FORMATWORKLOG=function(e){return o.a.formatWorklog(e,t.worklog)},n.a.fn.FORMATNUMBER=function(e){return t.formatDecimal.to(e)}},getFormattedCols:function(e,t){var a=this,l=[],n=[];return t.forEach((function(t){$.each(t,(function(t){if(-1===n.indexOf(t))if(n.push(t),e.valueViewMap[t])l.push({html:a.cleanCellHtml(e.valueViewMap[t].htmlColName),text:t});else{var o=a.unescapeColumn(t);l.push({html:s.a.tableTh({value:o}),text:t})}}))})),l},formatResult:function(e,t,a){var l=this,n={},r=l.getAliases(a.sql);$.each(e.jsons,(function(e,t){t.columns.forEach((function(e,a){n[e.text]=t.types[a]}))})),t.forEach((function(t){$.each(t,(function(i,c){if(null!=c){void 0===n[i]&&"number"==typeof c&&(n[i]=o.a.number),t[i]={type:0===n[i]?"number":""};var m,T=r[i];(m=e.valueViewMap[i]&&e.valueViewMap[i][c]||T&&e.valueViewMap[T]&&e.valueViewMap[T][c])?t[i].html=l.cleanCellHtml(m):(null!=n[i]&&void 0!==c?(o.a.date===n[i]&&(c=new Date(c)),t[i].html=o.a.formatAnyValueByType(c,n[i],(function(e){return a.formatDecimal.to(e)}),a.worklog,a.dateFormat,a.locales),!1===t[i].html&&(t[i].html=c)):(c="string"==typeof c?c.replace(p,'"').replace(u,"\\").replace(f,"'").replace(d,"`"):c,t[i].html=c),t[i].html=s.a.tableTd({cell:t[i]}))}else t[i]={html:s.a.tableTd({cell:{html:"",type:""}}),type:""}}))}))},getValue:function(e,t,a){if(null==t)return e;var l=o.a.parseAnyValueByType(t,e,a.separator,a.worklog,!0,a.dateFormat,a.locales);return l&&o.a.date===t&&(l=l.getTime()),(isNaN(l)||null===l)&&(l=null),l},unescapeColumn:function(e){return e.replace(i,"'").replace(u,"\\").replace(p,'"').replace(f,"'").replace(d,"`")},cleanCellHtml:function(e){var t=$(e).removeClass("fake pivot-hidden-column").removeAttr("rowspan").removeAttr("colspan","").css("display","");return t.removeClass(t.getClassStartsWith(/tf-rowspan-\d+/)),t.removeClass(t.getClassStartsWith(/tf-colspan-\d+/)),t.is("th")?t.addClass("confluenceTh"):t.addClass("confluenceTd"),t[0].outerHTML},findParentheses:function(e,t){for(var a=-1,l=0,n=t-1;n>=0;n--)if("("===e[n]){if(0===l){a=n;break}l--}else")"===e[n]&&l++;if(-1===a)return{start:-1,end:-1};var o=-1,r=0;for(n=t+1;n<e.length;n++)if(")"===e[n]){if(0===r){o=n;break}r--}else"("===e[n]&&r++;return{start:a,end:o}},getAliases:function(e){var t,a={};for(g.lastIndex=0;t=g.exec(e);)a[t[2]]=t[1];return a}};t.a=v},14:function(e,t){if(window.TableJoinerTemplate=window.TableJoinerTemplate||{},void 0===a)var a={};a.view=function(e,t){return'<div class="table-joiner" id="table-joiner-'+soy.$$escapeHtml(e.macroId)+'" data-id="'+soy.$$escapeHtml(e.macroId)+'" data-pageid="'+soy.$$escapeHtml(e.pageId)+'" data-sessionid="'+soy.$$escapeHtml(e.sessionId)+'" data-export-hash="'+soy.$$escapeHtml(e.exportHash)+'" data-tj-not-ready="true">'+(e.isEmail?"":(e.exportCSV||e.exportWord||e.exportPDF?'<div class="tj-exports">'+(e.exportCSV?'<button class="aui-button export-csv">'+soy.$$escapeHtml("Export to CSV")+"</button>":"")+(e.exportPDF?'<button class="aui-button export-pdf">'+soy.$$escapeHtml("Export to PDF")+"</button>":"")+(e.exportWord?'<button class="aui-button export-word">'+soy.$$escapeHtml("Export to Word")+"</button>":"")+"</div>":"")+'<div class="wrapper"><span class="loading"></span><div class="table-wrap"></div></div>')+'<div class="tj-source '+(e.showSource?"":"tj-hidden")+'">'+soy.$$filterNoAutoescape(e.body)+"</div></div>"},goog.DEBUG&&(a.view.soyTemplateName="TableJoinerTemplate.view"),a.table=function(e,t){for(var a='<table class="confluenceTable tfac-tj"><thead><tr>',l=e.cols,n=l.length,o=0;o<n;o++){var r=l[o];a+=soy.$$filterNoAutoescape(r.html)}a+="</tr></thead><tbody>";for(var s=e.res,i=s.length,c=0;c<i;c++){var p=s[c];a+="<tr>";for(var u=e.cols,f=u.length,d=0;d<f;d++){var m=u[d];a+=p[m.text]?soy.$$filterNoAutoescape(p[m.text].html):'<td class="confluenceTd"></td>'}a+="</tr>"}return a+="</tbody></table>"},goog.DEBUG&&(a.table.soyTemplateName="TableJoinerTemplate.table"),a.tableTh=function(e,t){return'<th class="confluenceTh">'+soy.$$escapeHtml(e.value)+"</th>"},goog.DEBUG&&(a.tableTh.soyTemplateName="TableJoinerTemplate.tableTh"),a.tableTd=function(e,t){return'<td class="confluenceTd '+soy.$$escapeHtml(e.cell.type)+'">'+soy.$$escapeHtml(e.cell.html)+"</td>"},goog.DEBUG&&(a.tableTd.soyTemplateName="TableJoinerTemplate.tableTd"),a.empty=function(e,t){return'<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Transformer macro.")+"</p></div>"},goog.DEBUG&&(a.empty.soyTemplateName="TableJoinerTemplate.empty"),a.noResult=function(e,t){return'<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("The query returned no rows.")+"</p></div>"},goog.DEBUG&&(a.noResult.soyTemplateName="TableJoinerTemplate.noResult"),a.error=function(e,t){return'<div class="aui-message error aui-message-error"><p>'+soy.$$escapeHtml(e.error)+"</p></div>"},goog.DEBUG&&(a.error.soyTemplateName="TableJoinerTemplate.error"),e.exports=a}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:84f9eb04b1f4bdc77c2a886afe017016', location = 'build/84f9eb04b1f4bdc77c2a.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[10],{21:function(t,e,i){var a,n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s,o){"use strict";"object"==r(e)?t.exports=o(i(17)):(a=[i(17)],void 0===(n=function(t){return s.dimple=o(t),s.dimple}.apply(e,a))||(t.exports=n))}(this,(function(t){"use strict";var e={version:"2.2.0",plot:{},aggregateMethod:{},axis:function(i,a,n,r,s,o){this.chart=i,this.position=a,this.categoryFields=null==s?n:[].concat(s),this.measure=r,this.timeField=s,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==o||o,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,i=[],a=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&e.data.length>0?i=i.concat(e.data):a=!0);a&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var e,i,a,n,r,s,o;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?t.timeFormat(this.tickFormat):t.format(this.tickFormat):this.showPercent?e=t.format(".0%"):this.useLog&&null!==this.measure?e=function(e){var i=Math.floor(Math.abs(e),0).toString().length,a=Math.min(Math.floor((i-1)/3),4),n="kmBT".substring(a-1,a),r="0"===Math.round(e/Math.pow(1e3,a)*10).toString().slice(-1)?0:1;return 0===e?0:t.format(",."+r+"f")(e/Math.pow(1e3,a))+n}:null!==this.measure?(i=Math.floor(Math.abs(this._max),0).toString(),a=Math.floor(Math.abs(this._min),0).toString(),(n=Math.max(a.length,i.length))>3?(r=Math.min(Math.floor((n-1)/3),4),s="kmBT".substring(r-1,r),o=n-3*r<=1?1:0,e=function(e){return 0===e?0:t.format(",."+o+"f")(e/Math.pow(1e3,r))+s}):(o=Math.max(-(this._tick_step?Math.floor(Math.log(this._tick_step)/Math.LN10):0),0),e=t.format(",."+o+"f"))):e=function(t){return t},e},this._getTimePeriod=function(){var e=this.timePeriod,i=30,a=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(e=a/1e3<=i?t.timeSecond:a/6e4<=i?t.timeMinute:a/36e5<=i?t.timeHour:a/864e5<=i?t.timeHay:a/6048e5<=i?t.timeWeek:a/26298e5<=i?t.timeMonth:t.timeYear),e},this._getTooltipText=function(e,i){if(this._hasTimeField())i[this.position+"Field"][0]&&e.push(this.timeField+": "+this._getFormat()(i[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach((function(t,a){null!=t&&i[this.position+"Field"][a]&&e.push(t+(i[this.position+"Field"][a]!==t?": "+i[this.position+"Field"][a]:""))}),this);else if(this._hasMeasure())switch(this.position){case"x":e.push(this.measure+": "+this._getFormat()(i.width));break;case"y":e.push(this.measure+": "+this._getFormat()(i.height));break;case"p":e.push(this.measure+": "+this._getFormat()(i.angle)+" ("+t.format(".0%")(i.piePct)+")");break;default:e.push(this.measure+": "+this._getFormat()(i[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){return null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(e)?Date.parse(e):new Date(e):t.timeParse(this.dateParseFormat)(e)},this._update=function(i){var a,n,r,s,o=[],l=this.ticks||10,c=function(t,i,a){var n,r,s=t.categoryFields[0],o=t._getAxisData(),l=s,c=!1,u=!0,h=null;for(n=0;n<o.length;n+=1)if(null!=(h=t._parseDate(o[n][s]))&&isNaN(h)){u=!1;break}return u||t.chart.series.forEach((function(e){e[i]===t&&e[a]._hasMeasure()&&(l=e[a].measure,c=!0)}),this),r=t._orderRules.concat({ordering:l,desc:c}),e._getOrderedList(o,s,r)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!i){if("y"!==this.position||null!==this._scale&&!i)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=t.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(c(t,"y","x"))}),this),this._scale=t.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=t.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(l)}}else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(c(t,"x","y"))}),this),this._scale=t.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=t.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(l)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach((function(t){t._scale=this._scale}),this),null!=i&&!1!==i||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(l).length>0)||"x"!==this.position&&"y"!==this.position||(n=(a=this._scale.ticks(l))[1]-a[0],r=((this._max-this._min)%n).toFixed(0),this._tick_step=n,0!==r&&(this._max=Math.ceil(this._max/n)*n,this._min=Math.floor(this._min/n)*n,this._update(!0))),s=null!=o&&o.length>0?this._scale.copy()(o[0]):this._min>0?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==s&&(this._previousOrigin=null===this._origin?s:this._origin,this._origin=s),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},chart:function(i,a){this.svg=i,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=a,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=t.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=i.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var i=0,a=0,n=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){n=a;break}null!=e&&e[0]!==this.axes[i].position[0]||(a+=1)}return n},this._getAllData=function(){var t=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(t=t.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach((function(e){null!==e.data&&void 0!==e.data&&e.data.length>0&&(t=t.concat(e.data))})),t},this._getData=function(i,a,n,r,s,o,l,c,u,h){var d,p,g=[],f=function(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach((function(t){i.push(e[t])}),this)),i},m={x:!1,y:!1,z:!1,p:!1,c:!1},y={x:[],y:[]},x={x:[],y:[],z:[],p:[]},v={min:null,max:null},b={x:[],y:[],z:[],p:[]},_=[],w={},S={x:0,y:0,z:0,p:0},k="",T=[],C=[],P=[],F="",A=[],L="",M=[],D="",I=[],B=[],V=i,O=[];for(p in this.storyboard&&this.storyboard.categoryFields.length>0&&(k=this.storyboard.categoryFields[0],T=e._getOrderedList(V,k,this.storyboard._orderRules)),o&&o._hasCategories()&&o._hasMeasure()&&(F=o.categoryFields[0],A=e._getOrderedList(V,F,o._orderRules.concat([{ordering:o.measure,desc:!0}]))),l&&l._hasCategories()&&l._hasMeasure()&&(L=l.categoryFields[0],M=e._getOrderedList(V,L,l._orderRules.concat([{ordering:l.measure,desc:!0}]))),u&&u._hasCategories()&&u._hasMeasure()&&(D=u.categoryFields[0],I=e._getOrderedList(V,D,u._orderRules.concat([{ordering:u.measure,desc:!0}]))),V.length>0&&a&&a.length>0&&(B=[].concat(r),C=[],a.forEach((function(t){void 0!==V[0][t]&&C.push(t)}),this),u&&u._hasMeasure()?B.push({ordering:u.measure,desc:!0}):h&&h._hasMeasure()?B.push({ordering:h.measure,desc:!0}):c&&c._hasMeasure()?B.push({ordering:c.measure,desc:!0}):o&&o._hasMeasure()?B.push({ordering:o.measure,desc:!0}):l&&l._hasMeasure()&&B.push({ordering:l.measure,desc:!0}),P=e._getOrderedList(V,C,B)),V.sort((function(t,e){var i,a,n,r,s,o,l=0;if(""!==k&&(l=T.indexOf(t[k])-T.indexOf(e[k])),""!==F&&0===l&&(l=A.indexOf(t[F])-A.indexOf(e[F])),""!==L&&0===l&&(l=M.indexOf(t[L])-M.indexOf(e[L])),""!==D&&0===l&&(l=I.indexOf(t[D])-M.indexOf(e[D])),C&&C.length>0&&0===l)for(i=[].concat(C),l=0,n=0;n<P.length;n+=1){for(a=[].concat(P[n]),s=!0,o=!0,r=0;r<i.length;r+=1)s=s&&t[i[r]]===a[r],o=o&&e[i[r]]===a[r];if(s||o){l=s&&o?0:s?-1:1;break}}return l})),V.forEach((function(t){var e,i,r,s,d,p=-1,y=f(o,t),x=f(l,t),v=f(c,t),b=f(u,t),_=[];if(a&&0!==a.length)for(r=0;r<a.length;r+=1)void 0===t[a[r]]?_.push(a[r]):_.push(t[a[r]]);else _=["All"];for(e=_.join("/")+"_"+y.join("/")+"_"+x.join("/")+"_"+b.join("/")+"_"+v.join("/"),i=0;i<g.length;i+=1)if(g[i].key===e){p=i;break}-1===p&&(s={key:e,aggField:_,xField:y,xValue:null,xCount:0,yField:x,yValue:null,yCount:0,pField:b,pValue:null,pCount:0,zField:v,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},g.push(s),p=g.length-1),(d=function(e,i){var a,r,s=!0,o={value:0,count:1},l={value:0,count:1},c="";null!==i&&(a=i.getFrameValue(),i.categoryFields.forEach((function(e,i){i>0&&(c+="/"),c+=t[e],s=c===a}),this)),null!=e&&s&&(r=g[p],e._hasMeasure()&&null!==t[e.measure]&&void 0!==t[e.measure]&&(-1===r[e.position+"ValueList"].indexOf(t[e.measure])&&r[e.position+"ValueList"].push(t[e.measure]),isNaN(parseFloat(t[e.measure]))&&(m[e.position]=!0),o.value=r[e.position+"Value"],o.count=r[e.position+"Count"],l.value=t[e.measure],r[e.position+"Value"]=n(o,l),r[e.position+"Count"]+=1))})(o,this.storyboard),d(l,this.storyboard),d(c,this.storyboard),d(u,this.storyboard),d(h,this.storyboard)}),this),o&&o._hasCategories()&&o.categoryFields.length>1&&void 0!==y.x&&(O=[],l._hasMeasure()&&O.push({ordering:l.measure,desc:!0}),y.x=e._getOrderedList(V,o.categoryFields[1],o._groupOrderRules.concat(O))),l&&l._hasCategories()&&l.categoryFields.length>1&&void 0!==y.y&&(O=[],o._hasMeasure()&&O.push({ordering:o.measure,desc:!0}),y.y=e._getOrderedList(V,l.categoryFields[1],l._groupOrderRules.concat(O)),y.y.reverse()),g.forEach((function(t){null!==o&&(!0===m.x&&(t.xValue=t.xValueList.length),d=o._hasMeasure()&&o._hasCategories()?(x.x[t.xField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0):(x.x[t.xField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0),x.x[t.xField.join("/")]=d),null!==l&&(!0===m.y&&(t.yValue=t.yValueList.length),d=l._hasMeasure()&&l._hasCategories()?(x.y[t.yField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0):(x.y[t.yField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0),x.y[t.yField.join("/")]=d),null!==u&&(!0===m.p&&(t.pValue=t.pValueList.length),d=(x.p[t.pField.join("/")]||0)+(u._hasMeasure()?Math.abs(t.pValue):0),x.p[t.pField.join("/")]=d),null!==c&&(!0===m.z&&(t.zValue=t.zValueList.length),d=(x.z[t.zField.join("/")]||0)+(c._hasMeasure()?Math.abs(t.zValue):0),x.z[t.zField.join("/")]=d),null!==h&&((null===v.min||t.cValue<v.min)&&(v.min=t.cValue),(null===v.max||t.cValue>v.max)&&(v.max=t.cValue))}),this),x.x)x.x.hasOwnProperty(p)&&(S.x+=x.x[p]);for(p in x.y)x.y.hasOwnProperty(p)&&(S.y+=x.y[p]);for(p in x.p)x.p.hasOwnProperty(p)&&(S.p+=x.p[p]);for(p in x.z)x.z.hasOwnProperty(p)&&(S.z+=x.z[p]);return g.forEach((function(e){var i,a,n,r,d=function(t,i,a){var n,r,o,l,c;null!=t&&(l=t.position,t._hasCategories()?t._hasMeasure()?(n=e[t.position+"Field"].join("/"),r=t.showPercent?x[t.position][n]/S[t.position]:x[t.position][n],-1===_.indexOf(n)&&(w[n]=r+(_.length>0?w[_[_.length-1]]:0),_.push(n)),o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!s?r:w[n],e[a]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&r<=0?r:0)):(e[l]=e["c"+l]=e[l+"Field"][0],e[a]=1,void 0!==y[l]&&null!==y[l]&&y[l].length>=2&&(e[l+"Offset"]=y[l].indexOf(e[l+"Field"][1]),e[a]=1/y[l].length)):(r=t.showPercent?e[l+"Value"]/x[i][e[i+"Field"].join("/")]:e[l+"Value"],n=e[i+"Field"].join("/")+(e[l+"Value"]>=0),c=b[l][n]=(null===b[l][n]||void 0===b[l][n]||"z"===l||"p"===l?0:b[l][n])+r,o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!s?r:c,e[a]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&r<=0?r:0)))};d(o,"y","width"),d(l,"x","height"),d(c,"z","r"),d(u,"p","angle"),null!==h&&null!==v.min&&null!==v.max&&(v.min===v.max&&(v.min-=.5,v.max+=.5),v.min=h.overrideMin||v.min,v.max=h.overrideMax||v.max,e.cValue=e.cValue>v.max?v.max:e.cValue<v.min?v.min:e.cValue,r=(n=t.scaleLinear().range([0,null===h.colors||1===h.colors.length?1:h.colors.length-1]).domain([v.min,v.max])(e.cValue))-Math.floor(n),e.cValue===v.max&&(r=1),h.colors&&1===h.colors.length?(i=t.rgb(h.colors[0]),a=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):h.colors&&h.colors.length>1?(i=t.rgb(h.colors[Math.floor(n)]),a=t.rgb(h.colors[Math.ceil(n)])):(i=t.rgb("white"),a=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),i.r=Math.floor(i.r+(a.r-i.r)*r),i.g=Math.floor(i.g+(a.g-i.g)*r),i.b=Math.floor(i.b+(a.b-i.b)*r),e.fill=i.toString(),e.stroke=i.darker(.5).toString())}),this),g},this._getDelay=function(t,i,a){return function(n){var r=0;return a&&i.staggerDraw&&(a.x._hasCategories()?r=e._helpers.cx(n,i,a)/i._widthPixels()*t:a.y._hasCategories()&&(r=(1-e._helpers.cy(n,i,a)/i._heightPixels())*t)),r}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach((function(t){var e,i,a,n,r,s=t.data||this.data||[],o=[].concat(t.categoryFields||"All"),l=this._getData(s,o,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),c=[],u={},h=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(h>d&&(h-=2*Math.PI),t.p&&o.length>0){if(t.x&&t.y){for(o.pop(),c=this._getData(s,["__dimple_placeholder__"].concat(o),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<l.length;e+=1)for((a=["__dimple_placeholder__"].concat(l[e].aggField)).pop(),t.x&&t.x._hasCategories()&&(a=a.concat(l[e].xField)),t.y&&t.y._hasCategories()&&(a=a.concat(l[e].yField)),n=a.join("|"),i=0;i<c.length;i+=1)if(r=[].concat(c[i].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(c[i].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(c[i].yField)),n===r.join("|")){l[e].xField=c[i].xField,l[e].xValue=c[i].xValue,l[e].xCount=c[i].xCount,l[e].yField=c[i].yField,l[e].yValue=c[i].yValue,l[e].yCount=c[i].yCount,l[e].zField=c[i].zField,l[e].zValue=c[i].zValue,l[e].zCount=c[i].zCount,l[e].x=c[i].x,l[e].y=c[i].y,l[e].r=c[i].r,l[e].xOffset=c[i].xOffset,l[e].yOffset=c[i].yOffset,l[e].width=c[i].width,l[e].height=c[i].height,l[e].cx=c[i].cx,l[e].cy=c[i].cy,l[e].xBound=c[i].xBound,l[e].yBound=c[i].yBound,l[e].xValueList=c[i].xValueList,l[e].yValueList=c[i].yValueList,l[e].zValueList=c[i].zValueList,l[e].cValueList=c[i].cValueList,l[e].pieKey=c[i].key,l[e].value=l.pValue,u[c[i].key]||(u[c[i].key]={total:0,angle:h}),u[c[i].key].total+=l[e].pValue;break}}else for(e=0;e<l.length;e+=1)l[e].pieKey="All",l[e].value=l.pValue,u[l[e].pieKey]||(u[l[e].pieKey]={total:0,angle:h}),u[l[e].pieKey].total+=l[e].pValue;for(e=0;e<l.length;e+=1)0===u[l[e].pieKey].total?l[e].piePct=0:l[e].piePct=l[e].pValue/u[l[e].pieKey].total,l[e].startAngle=u[l[e].pieKey].angle,l[e].endAngle=l[e].startAngle+l[e].piePct*(d-h),u[l[e].pieKey].angle=l[e].endAngle}t._positionData=l}),this)},this._handleTransition=function(t,i,a,n){var r=null;return 0===i?r=t:(r=t.transition().duration(i).delay(a._getDelay(i,a,n)),e._ease(r,a.ease)),r},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(i){null!==i._eventHandlers&&i._eventHandlers.length>0&&i._eventHandlers.forEach((function(a){var n,r=function(n){var r=new e.eventArgs;null!==i.chart.storyboard&&(r.frameValue=i.chart.storyboard.getFrameValue()),r.seriesValue=n.aggField,r.xValue=n.x,r.yValue=n.y,r.zValue=n.z,r.pValue=n.p,r.colorValue=n.cValue,r.seriesShapes=i.shapes,r.selectedShape=t.select(this),a.handler(r)};if(null!==a.handler&&"function"==typeof a.handler)if(null!==i._markers&&void 0!==i._markers)for(n in i._markers)i._markers.hasOwnProperty(n)&&i._markers[n].on(a.event,r);else i.shapes.on(a.event,r)}),this)},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,i,a,n){var r,s=null,o=null;if(null!=i&&(i=[].concat(i)),"string"==typeof t||t instanceof String)s=new e.axis(this,t,i,a,n),this.axes.push(s);else{if(o=t,(s=new e.axis(this,o.position,i,a,n))._hasMeasure()!==o._hasMeasure()?r="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":s._hasTimeField()!==o._hasTimeField()?r="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===s.categoryFields||void 0===s.categoryFields?0:s.categoryFields.length)!==(null===o.categoryFields||void 0===o.categoryFields?0:o.categoryFields.length)&&(r="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),r)throw r;o._slaves.push(s)}return s},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var i=this.addAxis("c",null,t);return i.colors=null==e?null:[].concat(e),i},this.addLegend=function(t,i,a,n,r,s){s=null==s?this.series:[].concat(s),r=null==r?"left":r;var o=new e.legend(this,t,i,a,n,r,s);return this.legends.push(o),o},this.addLogAxis=function(t,e,i){var a=this.addAxis(t,null,e,null);return null!=i&&(a.logBase=i),a.useLog=!0,a},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var a=null;return(a=null!=i?this.addAxis(t,i,e):this.addMeasureAxis(t,e)).showPercent=!0,a},this.addSeries=function(t,i,a){null!=a||(a=this.axes),null!=i||(i=e.plot.bubble);var n,r=null,s=null,o=null,l=null,c=null;return a.forEach((function(t){null!==t&&i.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===s&&"y"===t.position[0]?s=t:null===o&&"z"===t.position[0]?o=t:null===l&&"c"===t.position[0]?l=t:null===l&&"p"===t.position[0]&&(c=t))}),this),t&&(t=[].concat(t)),n=new e.series(this,t,r,s,o,l,c,i,e.aggregateMethod.sum,i.stacked),this.series.push(n),n},this.addTimeAxis=function(t,e,i,a){var n=this.addAxis(t,null,null,e);return n.tickFormat=a,n.dateParseFormat=i,n},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,i,a,n){return this._assignedColors[t]=new e.color(i,a,n),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new e.color("#80B1D3"),new e.color("#FB8072"),new e.color("#FDB462"),new e.color("#B3DE69"),new e.color("#FFED6F"),new e.color("#BC80BD"),new e.color("#8DD3C7"),new e.color("#CCEBC5"),new e.color("#FFFFB3"),new e.color("#BEBADA"),new e.color("#FCCDE5"),new e.color("#D9D9D9")],this.draw=function(e,i){e=e||0;var a,n,r=null,s=null,o=!1,l=!1,c=this._xPixels(),u=this._yPixels(),h=this._widthPixels(),d=this._heightPixels();return null!=i&&!1!==i||this._getSeriesData(),this.axes.forEach((function(t){t._scale=null}),this),this.axes.forEach((function(t){if(t._min=0,t._max=0,n=[],t._hasMeasure()){var e=!1;this.series.forEach((function(i){if(i._deepMatch(t)){var a=i._axisBounds(t.position);t._min>a.min&&(t._min=a.min),t._max<a.max&&(t._max=a.max),e=!0}}),this),e||this._getAllData().forEach((function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])}),this)}else t._hasTimeField()?(t._min=null,t._max=null,this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].timeField&&void 0!==e[t.position].timeField&&-1===n.indexOf(e[t.position].timeField)&&n.push(e[t.position].timeField)}),this),t._getAxisData().forEach((function(e){n.forEach((function(i){var a=t._parseDate(e[i]);(null===t._min||a<t._min)&&(t._min=a),(null===t._max||a>t._max)&&(t._max=a)}),this)}),this)):t._hasCategories()&&(t._min=0,a=[],this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].categoryFields[0]&&void 0!==e[t.position].categoryFields[0]&&-1===n.indexOf(e[t.position].categoryFields[0])&&n.push(e[t.position].categoryFields[0])}),this),t._getAxisData().forEach((function(t){n.forEach((function(e){-1===a.indexOf(t[e])&&a.push(t[e])}),this)}),this),t._max=a.length);null!==t._slaves&&void 0!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(e){e._min=t._min,e._max=t._max}),this),t._update(),null===r&&"x"===t.position?r=t:null===s&&"y"===t.position&&(s=t)}),this),this.axes.forEach((function(i){var a=!1,n=null,p=0,g=null,f=!1,m=0,y={l:null,t:null,r:null,b:null},x=0,v=0,b="",_=this,w=function(t){return null===n||0===e||a?t:_._handleTransition(t,e,_)},S=function(){var e=t.select(this).selectAll("text");return!i.measure&&i._max>0&&("x"===i.position?e.attr("x",h/i._max/2):"y"===i.position&&e.attr("y",d/i._max*-1/2)),i.categoryFields&&i.categoryFields.length>0&&(i!==r||null!==s.categoryFields&&0!==s.categoryFields.length||e.attr("y",u+d-s._scale(0)+9),i!==s||null!==r.categoryFields&&0!==r.categoryFields.length||e.attr("x",-1*(r._scale(0)-c)-9)),this},k=function(e){return function(){var i=t.select(this).attr("class")||"";return-1===i.indexOf(e)&&(i+=" "+e),i.trim()}};null===i.gridlineShapes?(i.showGridlines||null===i.showGridlines&&!i._hasCategories()&&(!o&&"x"===i.position||!l&&"y"===i.position))&&(i.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===i.position?o=!0:l=!0):"x"===i.position?o=!0:l=!0,null===i.shapes&&(i.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+i.position).each((function(){_.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),a=!0),i===r&&null!==s?(n="translate(0, "+(null===s.categoryFields||0===s.categoryFields.length?s._scale(0):u+d)+")",g="translate(0, "+(i===r?u+d:u)+")",p=-d):i===s&&null!==r?(n="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):c)+", 0)",g="translate("+(i===s?c:c+h)+", 0)",p=-h):"x"===i.position?(g=n="translate(0, "+(i===r?u+d:u)+")",p=-d):"y"===i.position&&(g=n="translate("+(i===s?c:c+h)+", 0)",p=-h),null!==n&&null!==i._draw&&(i._hasTimeField()?w(i.shapes).call(i._draw.ticks(i._getTimePeriod(),i.timeInterval).tickFormat(i._getFormat())).attr("transform",n).each(S):i.useLog?w(i.shapes).call(i._draw.ticks(4,i._getFormat())).attr("transform",n).each(S):w(i.shapes).call(i._draw.tickFormat(i._getFormat())).attr("transform",n).each(S),null!==i.gridlineShapes&&w(i.gridlineShapes).call(i._draw.tickSize(p,0,0).tickFormat("")).attr("transform",g)),w(i.shapes.selectAll("text")).attr("class",k(_.customClassList.axisLabel)).call((function(t){_.noFormats||t.style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),w(i.shapes.selectAll("path, line")).attr("class",k(_.customClassList.axisLine)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")})),null!==i.gridlineShapes&&(i.gridlineShapes.selectAll("path").remove(),w(i.gridlineShapes.selectAll("line")).attr("class",k(_.customClassList.gridline)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)}))),null!==i.measure&&void 0!==i.measure||(i.autoRotateLabel?i===r?(m=0,i.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/i.shapes.selectAll("text").nodes().length?(f=!0,i.shapes.selectAll("text").style("text-anchor","start").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")}))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===i.position&&(m=0,i.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/i.shapes.selectAll("text").nodes().length?(f=!0,i.shapes.selectAll("text").style("text-anchor","end").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")}))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==i.titleShape&&void 0!==i.titleShape&&i.titleShape.remove(),i.shapes.selectAll("text").each((function(){var t=this.getBBox();(null===y.l||-9-t.width<y.l)&&(y.l=-9-t.width),(null===y.r||t.x+t.width>y.r)&&(y.r=t.x+t.width),f?((null===y.t||t.y+t.height-t.width<y.t)&&(y.t=t.y+t.height-t.width),(null===y.b||t.height+t.width>y.b)&&(y.b=t.height+t.width)):((null===y.t||t.y<y.t)&&(y.t=t.y),(null===y.b||9+t.height>y.b)&&(y.b=9+t.height))})),"x"===i.position?(v=i===r?u+d+y.b+5:u+y.t-10,x=c+h/2):"y"===i.position&&(b="rotate(270, "+(x=i===s?c+y.l-10:c+h+y.r+20)+", "+(v=u+d/2)+")"),i.hidden||"x"!==i.position&&"y"!==i.position||null===i.title||(i.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+_.customClassList.axisTitle+" dimple-axis-"+i.position),i.titleShape.attr("x",x).attr("y",v).attr("text-anchor","middle").attr("transform",b).text(void 0!==i.title?i.title:null===i.categoryFields||void 0===i.categoryFields||0===i.categoryFields.length?i.measure:i.categoryFields.join("/")).each((function(){_.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),i===r?i.titleShape.each((function(){t.select(this).attr("y",v+this.getBBox().height/1.65)})):i===s&&i.titleShape.each((function(){t.select(this).attr("x",x+this.getBBox().height/1.65)})))}),this),this.series.forEach((function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)}),this),this.legends.forEach((function(t){t._draw()}),this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,i,a,n){return this.x=t,this.y=i,this.width=a,this.height=n,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,i,a,n){return this.x=t,this.y=i,this.width=0,this.height=0,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parentWidth(this.svg.node())-this._xPixels()-e._parseXPosition(a,this.svg.node())},this._heightPixels=function(){return e._parentHeight(this.svg.node())-this._yPixels()-e._parseYPosition(n,this.svg.node())},this},this.setStoryboard=function(t,i){return this.storyboard=new e.storyboard(this,t),null!=i&&(this.storyboard.onTick=i),this.storyboard}},color:function(e,i,a){this.fill=e,this.stroke=null==i?t.rgb(e).darker(.5).toString():i,this.opacity=null==a?.8:a},eventArgs:function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},legend:function(i,a,n,r,s,o,l){this.chart=i,this.series=l,this.x=a,this.y=n,this.width=r,this.height=s,this.horizontalAlign=o,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var i,a=this._getEntries(),n=0,r=0,s=0,o=0,l=this;this.shapes&&this.shapes.remove(),(i=this.chart._group.selectAll(".dimple-dont-select-any").data(a).enter().append("g").attr("class",(function(t){return"dimple-legend "+e._createClass(t.aggField)})).attr("opacity",1)).append("text").attr("class",(function(t){return"dimple-legend dimple-legend-text "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendLabel})).text((function(t){return t.key})).call((function(t){l.chart.noFormats||t.style("font-family",l.fontFamily).style("font-size",l._getFontSize()).style("shape-rendering","crispEdges")})).each((function(){var t=this.getBBox();t.width>n&&(n=t.width),t.height>r&&(r=t.height)})),i.append("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)})).attr("height",9).attr("width",15),r=(r<9?9:r)+l._getVerticalPadding(),n+=15+l._getHorizontalPadding(),i.each((function(i){s+n>l._widthPixels()&&(s=0,o+=r),o>l._heightPixels()?t.select(this).remove():(t.select(this).select("text").attr("x","left"===l.horizontalAlign?l._xPixels()+15+5+s:l._xPixels()+(l._widthPixels()-s-n)+15+5).attr("y",(function(){return l._yPixels()+o+this.getBBox().height/1.65})).attr("width",l._widthPixels()).attr("height",l._heightPixels()),t.select(this).select("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendKey+" "+t.css})).attr("x","left"===l.horizontalAlign?l._xPixels()+s:l._xPixels()+(l._widthPixels()-s-n)).attr("y",l._yPixels()+o).attr("height",9).attr("width",15).call((function(t){l.chart.noFormats||t.style("fill",i.fill).style("stroke",i.stroke).style("opacity",i.opacity).style("shape-rendering","crispEdges")})),s+=n)})),this.shapes=i},this._getEntries=function(){var t=[];return this.series&&this.series.forEach((function(e){e._positionData.forEach((function(i){var a,n=-1,r=e.plot.grouped&&!e.x._hasCategories()&&!e.y._hasCategories()&&i.aggField.length<2?"All":i.aggField.slice(-1)[0];for(a=0;a<t.length;a+=1)if(t[a].key===r){n=a;break}-1===n&&e.chart._assignedColors[r]&&(t.push({key:r,fill:e.chart._assignedColors[r].fill,stroke:e.chart._assignedColors[r].stroke,opacity:e.chart._assignedColors[r].opacity,css:e.chart._assignedClasses[r],series:e,aggField:i.aggField}),n=t.length-1)}))}),this),t},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){return isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){return isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return e._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.chart.svg.node())}},series:function(t,e,i,a,n,r,s,o,l,c){this.chart=t,this.x=i,this.y=a,this.z=n,this.c=r,this.p=s,this.plot=o,this.categoryFields=e,this.aggregate=l,this.stacked=c,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,i,a,n={min:0,max:0},r=null,s=null,o=[],l=0,c=this._positionData;return"x"===t?(r=this.x,s=this.y):"y"===t?(r=this.y,s=this.x):"z"===t?r=this.z:"p"===t?r=this.p:"c"===t&&(r=this.c),r.showPercent?c.forEach((function(t){t[r.position+"Bound"]<n.min&&(n.min=t[r.position+"Bound"]),t[r.position+"Bound"]>n.max&&(n.max=t[r.position+"Bound"])}),this):null===s||null===s.categoryFields||0===s.categoryFields.length?c.forEach((function(t){!this._isStacked()||"x"!==r.position&&"y"!==r.position?(t[r.position+"Value"]<n.min&&(n.min=t[r.position+"Value"]),t[r.position+"Value"]>n.max&&(n.max=t[r.position+"Value"])):t[r.position+"Value"]<0?n.min=n.min+t[r.position+"Value"]:n.max=n.max+t[r.position+"Value"]}),this):(e=r.position+"Value",i=s.position+"Field",a=[],c.forEach((function(t){var n=t[i].join("/"),r=a.indexOf(n);-1===r&&(a.push(n),r=a.length-1),void 0===o[r]&&(o[r]={min:0,max:0},r>=l&&(l=r+1)),this.stacked?t[e]<0?o[r].min=o[r].min+t[e]:o[r].max=o[r].max+t[e]:(t[e]<o[r].min&&(o[r].min=t[e]),t[e]>o[r].max&&(o[r].max=t[e]))}),this),o.forEach((function(t){void 0!==t&&(t.min<n.min&&(n.min=t.min),t.max>n.max&&(n.max=t.max))}),this)),n},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(t){e=e||this._deepMatch(t)}),this),e},this._dropLineOrigin=function(){var t=0,e=0,i={x:null,y:null},a={x:null,y:null};return this.chart.axes.forEach((function(t){"x"===t.position&&null===a.x?t._hasTimeField()?a.x=this.chart._xPixels():a.x=t._origin:"y"===t.position&&null===a.y&&(t._hasTimeField()?a.y=this.chart._yPixels()+this.chart._heightPixels():a.y=t._origin)}),this),this.chart.axes.forEach((function(n){"x"!==n.position||this.x.hidden?"y"!==n.position||this.y.hidden||(this._deepMatch(n)&&(0===e?i.x=a.x:1===e&&(i.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(this._deepMatch(n)&&(0===t?i.y=a.y:1===t&&(i.y=this.chart._yPixels())),t+=1)}),this),i},this._getTooltipFontSize=function(){return this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(t){var e=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach((function(i,a){null!=i&&null!==t.aggField[a]&&void 0!==t.aggField[a]&&e.push(i+(t.aggField[a]!==i?": "+t.aggField[a]:""))}),this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(e,t),this.y&&this.y._hasCategories()&&this.y._getTooltipText(e,t),this.z&&this.z._hasCategories()&&this.z._getTooltipText(e,t),this.p._getTooltipText(e,t)):(this.x&&this.x._getTooltipText(e,t),this.y&&this.y._getTooltipText(e,t),this.z&&this.z._getTooltipText(e,t)),this.c&&this.c._getTooltipText(e,t),e.filter((function(t,i){return e.indexOf(t)===i}))}},storyboard:function(t,e){null!=e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,i=0;e.storyLabel||(e.chart.axes.forEach((function(t){"x"===t.position&&(i+=1)}),e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(e.chart._heightPixels()/35>10?e.chart._heightPixels()/35:10)*(i>1?1.25:-1)).call((function(i){t.noFormats||i.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}))),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach((function(t){var e="";null!==this.categoryFields&&(this.categoryFields.forEach((function(i,a){a>0&&(e+="/"),e+=t[i]}),this),-1===this._categories.indexOf(e)&&(this._categories.push(e),this._categories.length))}),this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}}};return e.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},e.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},e.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},e.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},e.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},e.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,a,n){var r,s,o,l,c,u,h,d,p,g,f,m,y,x,v,b,_,w,S,k,T,C,P,F,A=a._positionData,L=[],M=null,D="dimple-series-"+i.series.indexOf(a),I=a.x._hasCategories()||a.y._hasCategories()?0:1,B=!1,V={},O=[],$=[],E=function(){return function(i,a,n,r){t.select(a).style("opacity",1),e._showPointTooltip(i,a,n,r)}},N=function(i){return function(a,n,r,s){t.select(n).style("opacity",s.lineMarkers||i.data.length<2?e._helpers.opacity(a,r,s):0),e._removeTooltip(a,n,r,s)}},H=function(t,r){e._drawMarkers(t,i,a,n,D,B,E(),N(t),r)},z=function(t,n){var r;return"step"===a.interpolation&&a[t]._hasCategories()?(r=e._helpers[t](n,i,a)+("y"===t?e._helpers.height(n,i,a):0),a[t].categoryFields.length<2&&(r+=("y"===t?1:-1)*e._helpers[t+"Gap"](i,a))):r=e._helpers["c"+t](n,i,a),parseFloat(r)},G=function(i,n){var r=t.line().x((function(t){return a.x._hasCategories()||!n?t.x:a.x[n]})).y((function(t){return a.y._hasCategories()||!n?t.y:a.y[n]}));return e._interpolate(r,i),r},W=function(t,e){return parseFloat(t)-parseFloat(e)},R=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},j=function(t,e,i){var a,n,r=e[e.length-1],s=9999,o=r;for(a=0;a<t.length;a+=1)t[a].x===r.x&&t[a].y===r.y||(n=180-Math.atan2(t[a].x-r.x,t[a].y-r.y)*(180/Math.PI))>i&&n<s&&(o=t[a],s=n);return e.push(o),s};for(r="step"===a.interpolation?"step-after":a.interpolation,f=e._getSeriesOrder(a.data||i.data,a),a.c&&(a.x._hasCategories()&&a.y._hasMeasure()||a.y._hasCategories()&&a.x._hasMeasure())&&(B=!0),a.x._hasCategories()?(P="x",F="y"):a.y._hasCategories()&&(P="y",F="x"),s=0;s<A.length;s+=1){for(c=[],h=-1,l=I;l<A[s].aggField.length;l+=1)c.push(A[s].aggField[l]);for(u=e._createClass(c),l=0;l<L.length;l+=1)if(L[l].keyString===u){h=l;break}-1===h&&(h=L.length,L.push({key:c,keyString:u,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:P&&A[s][P+"Field"]&&A[s][P+"Field"].length>=2?A[s][P+"Field"][0]:"All"})),L[h].data.push(A[s])}for(f&&L.sort((function(t,i){return e._arrayIndexCompare(f,t.key,i.key)})),s=0;s<L.length;s+=1){for(L[s].data.sort(e._getSeriesSortPredicate(i,a,f)),o=0;o<L[s].data.length;o+=1)L[s].points.push({x:z("x",L[s].data[o]),y:z("y",L[s].data[o])}),P&&(V[L[s].group]||(V[L[s].group]={}),V[L[s].group][L[s].points[L[s].points.length-1][P]]=a[F]._origin);m=L[s].points,"step"===a.interpolation&&m.length>1&&P&&(a.x._hasCategories()?(m.push({x:2*m[m.length-1].x-m[m.length-2].x,y:m[m.length-1].y}),V[L[s].group][m[m.length-1][P]]=a[F]._origin):a.y._hasCategories()&&(m=[{x:m[0].x,y:2*m[0].y-m[1].y}].concat(m),V[L[s].group][m[0][P]]=a[F]._origin,L[s].points=m))}for(v in V)if(V.hasOwnProperty(v)){for(b in O[v]=[],V[v])V[v].hasOwnProperty(b)&&O[v].push(parseFloat(b));O[v].sort(W)}for(s=0;s<L.length;s+=1){if(m=L[s].points,_=L[s].group,y=[],$=[],B&&e._addGradient(L[s].key,"fill-area-gradient-"+L[s].keyString,a.x._hasCategories()?a.x:a.y,A,i,n,"fill"),O[_]&&O[_].length>0)for(o=0,l=0;o<O[_].length;o+=1)O[_][o]>=m[0][P]&&O[_][o]<=m[m.length-1][P]&&((x={})[P]=O[_][o],x[F]=V[_][O[_][o]],y.push(x),m[l][P]>O[_][o]?$.push(x):($.push(m[l]),V[L[s].group][O[_][o]]=m[l][F],l+=1));else if(a._orderRules&&a._orderRules.length>0)$=m.concat(m[0]);else{m=m.sort(R),$.push(m[0]),C=0;do{C=j(m,$,C)}while($.length<=m.length&&($[0].x!==$[$.length-1].x||$[0].y!==$[$.length-1].y))}y=y.reverse(),w=G(r,"_previousOrigin")($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_previousOrigin")(y),T=-1===(k=G("linear","_previousOrigin")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].entry=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=G(r)($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r)(y),T=-1===(k=G("linear")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].update=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=G(r,"_origin")($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_origin")(y),T=-1===(k=G("linear","_origin")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].exit=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),L[s].color=i.getColor(L[s].key.length>0?L[s].key[L[s].key.length-1]:"All"),L[s].css=i.getClass(L[s].key.length>0?L[s].key[L[s].key.length-1]:"All")}i._tooltipGroup&&i._tooltipGroup.remove(),d=(M=a.shapes?a.shapes.data(L,(function(t){return t.key})):a._group.selectAll("."+D).data(L,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return D+" dimple-line "+t.keyString+" "+i.customClassList.areaSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return B?1:t.color.opacity})).style("fill",(function(t){return B?"url(#"+e._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill})).style("stroke",(function(t){return B?"url(#"+e._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",a.lineWeight)})).each((function(t){t.markerData=t.data,H(t,this)})),p=i._handleTransition(M.merge(d),n,i).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,H(t,this)})),g=i._handleTransition(M.exit(),n,i).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],H(t,this)})),e._postDrawHandling(a,p,g,n),a.shapes=a._group.selectAll("."+D)}},e.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(t,i,a){var n,r,s,o=i._positionData,l=null,c=["dimple-series-"+t.series.indexOf(i),"dimple-bar"],u=!i._isStacked()&&i.x._hasMeasure(),h=!i._isStacked()&&i.y._hasMeasure(),d="none";i.x._hasCategories()&&i.y._hasCategories()?d="both":i.x._hasCategories()?d="x":i.y._hasCategories()&&(d="y"),t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=i.shapes?i.shapes.data(o,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(o,(function(t){return t.key}))).enter().append("rect").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(i){var a=[];return a=(a=(a=a.concat(i.aggField)).concat(i.xField)).concat(i.yField),c.join(" ")+" "+e._createClass(a)+" "+t.customClassList.barSeries+" "+e._helpers.css(i,t)})).attr("x",(function(a){var n=i.x._previousOrigin;return"x"===d?n=e._helpers.x(a,t,i):"both"===d&&(n=e._helpers.cx(a,t,i)),n})).attr("y",(function(a){var n=i.y._previousOrigin;return"y"===d?n=e._helpers.y(a,t,i):"both"===d&&(n=e._helpers.cy(a,t,i)),n})).attr("width",(function(a){return"x"===d?e._helpers.width(a,t,i):0})).attr("height",(function(a){return"y"===d?e._helpers.height(a,t,i):0})).on("mouseover",(function(a){e._showBarTooltip(a,this,t,i)})).on("mouseleave",(function(a){e._removeTooltip(a,this,t,i)})).call((function(a){t.noFormats||a.attr("opacity",(function(a){return e._helpers.opacity(a,t,i)})).style("fill",(function(a){return e._helpers.fill(a,t,i)})).style("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),r=t._handleTransition(l.merge(n),a,t,i).attr("x",(function(a){return u?e._helpers.cx(a,t,i)-i.x.floatingBarWidth/2:e._helpers.x(a,t,i)})).attr("y",(function(a){return h?e._helpers.cy(a,t,i)-i.y.floatingBarWidth/2:e._helpers.y(a,t,i)})).attr("width",(function(a){return u?i.x.floatingBarWidth:e._helpers.width(a,t,i)})).attr("height",(function(a){return h?i.y.floatingBarWidth:e._helpers.height(a,t,i)})).call((function(a){t.noFormats||a.attr("fill",(function(a){return e._helpers.fill(a,t,i)})).attr("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),s=t._handleTransition(l.exit(),a,t,i).attr("x",(function(a){var n=i.x._origin;return"x"===d?n=e._helpers.x(a,t,i):"both"===d&&(n=e._helpers.cx(a,t,i)),n})).attr("y",(function(a){var n=i.y._origin;return"y"===d?n=e._helpers.y(a,t,i):"both"===d&&(n=e._helpers.cy(a,t,i)),n})).attr("width",(function(a){return"x"===d?e._helpers.width(a,t,i):0})).attr("height",(function(a){return"y"===d?e._helpers.height(a,t,i):0})),e._postDrawHandling(i,r,s,a),i.shapes=i._group.selectAll("."+c.join("."))}},e.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(t,i,a){var n,r,s,o=i._positionData,l=null,c=["dimple-series-"+t.series.indexOf(i),"dimple-bubble"];t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=i.shapes?i.shapes.data(o,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(o,(function(t){return t.key}))).enter().append("circle").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(i){var a=[];return a=(a=(a=(a=a.concat(i.aggField)).concat(i.xField)).concat(i.yField)).concat(i.zField),c.join(" ")+" "+e._createClass(a)+" "+t.customClassList.bubbleSeries+" "+e._helpers.css(i,t)})).attr("cx",(function(a){return i.x._hasCategories()?e._helpers.cx(a,t,i):i.x._previousOrigin})).attr("cy",(function(a){return i.y._hasCategories()?e._helpers.cy(a,t,i):i.y._previousOrigin})).attr("r",0).on("mouseover",(function(a){e._showPointTooltip(a,this,t,i)})).on("mouseleave",(function(a){e._removeTooltip(a,this,t,i)})).call((function(a){t.noFormats||a.attr("opacity",(function(a){return e._helpers.opacity(a,t,i)})).style("fill",(function(a){return e._helpers.fill(a,t,i)})).style("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),r=t._handleTransition(l.merge(n),a,t,i).attr("cx",(function(a){return e._helpers.cx(a,t,i)})).attr("cy",(function(a){return e._helpers.cy(a,t,i)})).attr("r",(function(a){return e._helpers.r(a,t,i)})).call((function(a){t.noFormats||a.attr("fill",(function(a){return e._helpers.fill(a,t,i)})).attr("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),s=t._handleTransition(l.exit(),a,t,i).attr("r",0).attr("cx",(function(a){return i.x._hasCategories()?e._helpers.cx(a,t,i):i.x._origin})).attr("cy",(function(a){return i.y._hasCategories()?e._helpers.cy(a,t,i):i.y._origin})),e._postDrawHandling(i,r,s,a),i.shapes=i._group.selectAll("."+c.join("."))}},e.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,a,n){var r,s,o,l,c,u,h,d,p,g,f,m=a._positionData,y=[],x=null,v="dimple-series-"+i.series.indexOf(a),b=a.x._hasCategories()||a.y._hasCategories()?0:1,_=!1,w=function(){return function(i,a,n,r){t.select(a).style("opacity",1),e._showPointTooltip(i,a,n,r)}},S=function(i){return function(a,n,r,s){t.select(n).style("opacity",s.lineMarkers||i.data.length<2?e._helpers.opacity(a,r,s):0),e._removeTooltip(a,n,r,s)}},k=function(t,r){e._drawMarkers(t,i,a,n,v,_,w(),S(t),r)},T=function(t,n){var r;return"step"===a.interpolation&&a[t]._hasCategories()?(a.barGap=0,a.clusterBarGap=0,r=e._helpers[t](n,i,a)+("y"===t?e._helpers.height(n,i,a):0)):r=e._helpers["c"+t](n,i,a),parseFloat(r.toFixed(1))},C=function(i,n){var r=t.line().x((function(t){return a.x._hasCategories()||!n?t.x:a.x[n]})).y((function(t){return a.y._hasCategories()||!n?t.y:a.y[n]}));return e._interpolate(r,i),r};for(r="step"===a.interpolation?"step-after":a.interpolation,f=e._getSeriesOrder(a.data||i.data,a),a.c&&(a.x._hasCategories()&&a.y._hasMeasure()||a.y._hasCategories()&&a.x._hasMeasure())&&(_=!0),s=0;s<m.length;s+=1){for(c=[],h=-1,l=b;l<m[s].aggField.length;l+=1)c.push(m[s].aggField[l]);for(u=e._createClass(c),l=0;l<y.length;l+=1)if(y[l].keyString===u){h=l;break}-1===h&&(h=y.length,y.push({key:c,keyString:u,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),y[h].data.push(m[s])}for(f&&y.sort((function(t,i){return e._arrayIndexCompare(f,t.key,i.key)})),s=0;s<y.length;s+=1){for(y[s].data.sort(e._getSeriesSortPredicate(i,a,f)),_&&e._addGradient(y[s].key,"fill-line-gradient-"+y[s].keyString,a.x._hasCategories()?a.x:a.y,m,i,n,"fill"),o=0;o<y[s].data.length;o+=1)y[s].points.push({x:T("x",y[s].data[o]),y:T("y",y[s].data[o])});"step"===a.interpolation&&y[s].points.length>1&&(a.x._hasCategories()?y[s].points.push({x:2*y[s].points[y[s].points.length-1].x-y[s].points[y[s].points.length-2].x,y:y[s].points[y[s].points.length-1].y}):a.y._hasCategories()&&(y[s].points=[{x:y[s].points[0].x,y:2*y[s].points[0].y-y[s].points[1].y}].concat(y[s].points))),y&&y[s]&&y[s].points&&1===y[s].points.length&&y[s].points.push({x:y[s].points[0].x,y:y[s].points[0].y}),y[s].entry=C(r,"_previousOrigin")(y[s].points),y[s].update=C(r)(y[s].points),y[s].exit=C(r,"_origin")(y[s].points),y[s].color=i.getColor(y[s].key.length>0?y[s].key[y[s].key.length-1]:"All"),y[s].css=i.getClass(y[s].key.length>0?y[s].key[y[s].key.length-1]:"All")}i._tooltipGroup&&i._tooltipGroup.remove(),d=(x=a.shapes?a.shapes.data(y,(function(t){return t.key})):a._group.selectAll("."+v).data(y,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return v+" dimple-line "+t.keyString+" "+i.customClassList.lineSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return _?1:t.color.opacity})).style("fill","none").style("stroke",(function(t){return _?"url(#"+e._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",a.lineWeight)})).each((function(t){t.markerData=t.data,k(t,this)})),p=i._handleTransition(x.merge(d),n,i).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,k(t,this)})),g=i._handleTransition(x.exit(),n,i).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],k(t,this)})),e._postDrawHandling(a,p,g,n),a.shapes=a._group.selectAll("."+v)}},e.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(i,a,n){var r,s,o,l=a._positionData,c=null,u=["dimple-series-"+i.series.indexOf(a),"dimple-pie"],h=function(t){return a.x&&a.y?e._helpers.r(t,i,a):i._widthPixels()<i._heightPixels()?i._widthPixels()/2:i._heightPixels()/2},d=function(t){var i=h(t);return a.outerRadius&&(i=e._parsePosition(a.outerRadius,i)),Math.max(i,0)},p=function(t){var i=0;return a.innerRadius&&(i=e._parsePosition(a.innerRadius,h(t))),Math.max(i,0)},g=function(e){return t.arc().innerRadius(p(e)).outerRadius(d(e))(e)},f=function(e){e.innerRadius=p(e),e.outerRadius=d(e);var i,a=t.interpolate(this._current,e);return i=t.arc().innerRadius((function(t){return t.innerRadius})).outerRadius((function(t){return t.outerRadius})),this._current=a(0),function(t){return i(a(t))}},m=function(t){return function(n){var r,s;return a.x&&a.y?(r=!t||a.x._hasCategories()?e._helpers.cx(n,i,a):a.x._previousOrigin,s=!t||a.y._hasCategories()?e._helpers.cy(n,i,a):a.y._previousOrigin):(r=i._xPixels()+i._widthPixels()/2,s=i._yPixels()+i._heightPixels()/2),"translate("+r+","+s+")"}};i._tooltipGroup&&i._tooltipGroup.remove(),r=(c=a.shapes?a.shapes.data(l,(function(t){return t.key})):a._group.selectAll("."+u.join(".")).data(l,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){var a=[];return a=(a=a.concat(t.aggField)).concat(t.pField),u.join(" ")+" "+e._createClass(a)+" "+i.customClassList.pieSeries+" "+e._helpers.css(t,i)})).attr("d",g).on("mouseover",(function(t){e._showBarTooltip(t,this,i,a)})).on("mouseleave",(function(t){e._removeTooltip(t,this,i,a)})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return e._helpers.opacity(t,i,a)})).style("fill",(function(t){return e._helpers.fill(t,i,a)})).style("stroke",(function(t){return e._helpers.stroke(t,i,a)}))})).attr("transform",m(!0)).each((function(t){this._current=t,t.innerRadius=p(t),t.outerRadius=d(t)})),s=i._handleTransition(c.merge(r),n,i,a).call((function(t){n&&n>0?t.attrTween("d",f):t.attr("d",g),i.noFormats||t.attr("fill",(function(t){return e._helpers.fill(t,i,a)})).attr("stroke",(function(t){return e._helpers.stroke(t,i,a)}))})).attr("transform",m(!1)),o=i._handleTransition(c.exit(),n,i,a).attr("transform",m(!0)).attr("d",g),e._postDrawHandling(a,s,o,n),a.shapes=a._group.selectAll("."+u.join("."))}},e._addGradient=function(t,i,a,n,r,s,o){var l=[].concat(t),c=r.svg.select("#"+e._createClass([i])),u=[],h=a.position+"Field",d=!0,p=[];n.forEach((function(t){-1===u.indexOf(t[h])&&t.aggField.join("_")===l.join("_")&&u.push(t[h])}),this),u=u.sort((function(t,e){return a._scale(t)-a._scale(e)})),null===c.node()&&(d=!1,c=r.svg.append("defs").append("linearGradient").attr("id",e._createClass([i])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===a.position?a._scale(u[0])+r._widthPixels()/u.length/2:0).attr("y1","y"===a.position?a._scale(u[0])-r._heightPixels()/u.length/2:0).attr("x2","x"===a.position?a._scale(u[u.length-1])+r._widthPixels()/u.length/2:0).attr("y2","y"===a.position?a._scale(u[u.length-1])-r._heightPixels()/u.length/2:0)),u.forEach((function(t,e){var i={},a=0;for(a=0;a<n.length;a+=1)if(n[a].aggField.join("_")===l.join("_")&&n[a][h].join("_")===t.join("_")){i=n[a];break}p.push({offset:Math.round(e/(u.length-1)*100)+"%",color:i[o]})}),this),d?r._handleTransition(c.selectAll("stop").data(p),s,r).attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})):c.selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}))},e._arrayIndexCompare=function(t,e,i){var a,n,r,s,o,l;for(n=0;n<t.length;n+=1){for(s=!0,o=!0,l=[].concat(t[n]),r=0;r<e.length;r+=1)s=s&&e[r]===l[r];for(r=0;r<i.length;r+=1)o=o&&i[r]===l[r];if(s||o){a=s&&o?0:s?-1:1;break}}return a},e._createClass=function(t){var e,i,a=[];if(i=function(t){var e=t.charCodeAt(0),i="-";return e>=65&&e<=90&&(i=t.toLowerCase()),i},t.length>0)for(e=0;e<t.length;e+=1)t[e]&&a.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,i));else a=["dimple-all"];return a.join(" ")},e._drawMarkerBacks=function(i,a,n,r,s,o){var l,c,u,h=["dimple-marker-back",s,i.keyString];n.lineMarkers&&(l=null===n._markerBacks||void 0===n._markerBacks||void 0===n._markerBacks[i.keyString]?n._group.selectAll("."+h.join(".")).data(i.markerData):n._markerBacks[i.keyString].data(i.markerData,(function(t){return t.key})),(u=o.nextSibling&&o.nextSibling.id?l.enter().insert("circle","#"+o.nextSibling.id):l.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker Back"])})).attr("class",(function(t){var i=[];return n.x._hasCategories()&&(i=i.concat(t.xField)),n.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+h.join(" ")})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._previousOrigin})).attr("r",0).attr("fill","white").attr("stroke","none"),a._handleTransition(l.merge(u),r,a).attr("cx",(function(t){return e._helpers.cx(t,a,n)})).attr("cy",(function(t){return e._helpers.cy(t,a,n)})).attr("r",2+n.lineWeight),c=a._handleTransition(l.exit(),r,a).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._origin})).attr("r",0),0===r?c.remove():c.each("end",(function(){t.select(this).remove()})),void 0!==n._markerBacks&&null!==n._markerBacks||(n._markerBacks={}),n._markerBacks[i.keyString]=l)},e._drawMarkers=function(i,a,n,r,s,o,l,c,u){var h,d,p,g=["dimple-marker",s,i.keyString];h=null===n._markers||void 0===n._markers||void 0===n._markers[i.keyString]?n._group.selectAll("."+g.join(".")).data(i.markerData):n._markers[i.keyString].data(i.markerData,(function(t){return t.key})),(p=u.nextSibling&&u.nextSibling.id?h.enter().insert("circle","#"+u.nextSibling.id):h.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker"])})).attr("class",(function(t){var i=[],r=a.getClass(t.aggField.length>0?t.aggField[t.aggField.length-1]:"All");return n.x._hasCategories()&&(i=i.concat(t.xField)),n.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+g.join(" ")+" "+a.customClassList.lineMarker+" "+r})).on("mouseover",(function(t){l(t,this,a,n)})).on("mouseleave",(function(t){c(t,this,a,n)})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._previousOrigin})).attr("r",0).attr("opacity",n.lineMarkers||i.data.length<2?i.color.opacity:0).call((function(t){a.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,a,n):i.color.stroke}))})),a._handleTransition(h.merge(p),r,a).attr("cx",(function(t){return e._helpers.cx(t,a,n)})).attr("cy",(function(t){return e._helpers.cy(t,a,n)})).attr("r",2+n.lineWeight).attr("opacity",n.lineMarkers||i.data.length<2?i.color.opacity:0).call((function(t){a.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,a,n):i.color.stroke}))})),d=a._handleTransition(h.exit(),r,a).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._origin})).attr("r",0),0===r?d.remove():d.each("end",(function(){t.select(this).remove()})),void 0!==n._markers&&null!==n._markers||(n._markers={}),n._markers[i.keyString]=h,e._drawMarkerBacks(i,a,n,r,s,u)},e._ease=function(e,i){if(e&&i&&"[object String]"===Object.prototype.toString.call(i)){switch(i){case"linear":i=t.easeLinear;break;case"poly":i=t.easePoly;break;case"quad":i=t.easeQuad;break;case"cubic":i=t.easeCubic;break;case"sin":i=t.easeSin;break;case"exp":i=t.easeExp;break;case"circle":i=t.easeCircle;break;case"elastic":i=t.easeElastic;break;case"back":i=t.easeBack;break;case"bounce":i=t.easeBounce}e.ease(i)}},e._getOrderedList=function(t,i,a){var n,r=[],s=[],o=[].concat(i),l=[].concat(i),c=[];return null!=a&&(c=c.concat(a)),(c=c.concat({ordering:o,desc:!1})).forEach((function(e){var i,a=[],n=[];if("function"==typeof e.ordering){if(t&&t.length>0)for(i in t[0])t[0].hasOwnProperty(i)&&-1===l.indexOf(i)&&l.push(i)}else if(e.ordering instanceof Array){for(i=0;i<e.ordering.length;i+=1)t&&t.length>0&&t[0].hasOwnProperty(e.ordering[i])&&n.push(e.ordering[i]),a.push(e.ordering[i]);n.length>a.length/2?l.concat(n):e.values=a}else l.push(e.ordering)}),this),n=e._rollUp(t,o,l),c.length>=1&&(c.forEach((function(t){var e=null!==t.desc&&void 0!==t.desc&&t.desc,i=t.ordering,a=[],n=function(t){var e,i=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){i=void 0;break}i+=parseFloat(t[e])}return i},s=function(t,e){var i=0,a=n(t),r=n(e);return isNaN(a)||isNaN(r)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?i=-1:t[0]>e[0]&&(i=1):i=Date.parse(t[0])-Date.parse(e[0]):i=parseFloat(a)-parseFloat(r),i};"function"==typeof i?r.push((function(t,a){return(e?-1:1)*i(t,a)})):t.values&&t.values.length>0?(t.values.forEach((function(t){a.push([].concat(t).join("|"))}),this),r.push((function(t,i){var n,r,s,l="",c="";for(s=0;s<o.length;s+=1)s>0&&(l+="|",c+="|"),l+=t[o[s]],c+=i[o[s]];return n=a.indexOf(l),r=a.indexOf(c),n=n<0?e?-1:a.length:n,r=r<0?e?-1:a.length:r,(e?-1:1)*(n-r)}))):[].concat(t.ordering).forEach((function(t){r.push((function(i,a){var n=0;return void 0!==i[t]&&void 0!==a[t]&&(n=s([].concat(i[t]),[].concat(a[t]))),(e?-1:1)*n}))}))})),n.sort((function(t,e){for(var i=0,a=0;i<r.length&&0===a;)a=r[i](t,e),i+=1;return a})),n.forEach((function(t){var e,i=[];if(1===o.length)s.push(t[o[0]]);else{for(e=0;e<o.length;e+=1)i.push(t[o[e]]);s.push(i)}}),this)),s},e._getSeriesOrder=function(t,i){var a=[].concat(i._orderRules),n=i.categoryFields,r=[];return null!=n&&n.length>0&&(null!==i.c&&void 0!==i.c&&i.c._hasMeasure()&&a.push({ordering:i.c.measure,desc:!0}),i.x._hasMeasure()&&a.push({ordering:i.x.measure,desc:!0}),i.y._hasMeasure()&&a.push({ordering:i.y.measure,desc:!0}),r=e._getOrderedList(t,n,a)),r},e._getSeriesSortPredicate=function(t,i,a){return function(n,r){var s=0;return i.x._hasCategories()&&(s=e._helpers.cx(n,t,i)-e._helpers.cx(r,t,i)),0===s&&i.y._hasCategories()&&(s=e._helpers.cy(n,t,i)-e._helpers.cy(r,t,i)),0===s&&a&&(s=e._arrayIndexCompare(a,n.aggField,r.aggField)),s}},e._helpers={cx:function(t,i,a){return null!==a.x.measure&&void 0!==a.x.measure?a.x._scale(t.cx):a.x._hasCategories()&&a.x.categoryFields.length>=2?a.x._scale(t.cx)+e._helpers.xGap(i,a)+(t.xOffset+.5)*((i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))*t.width):a.x._scale(t.cx)+i._widthPixels()/a.x._max/2},cy:function(t,i,a){return null!==a.y.measure&&void 0!==a.y.measure?a.y._scale(t.cy):null!==a.y.categoryFields&&void 0!==a.y.categoryFields&&a.y.categoryFields.length>=2?a.y._scale(t.cy)-i._heightPixels()/a.y._max+e._helpers.yGap(i,a)+(t.yOffset+.5)*((i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))*t.height):a.y._scale(t.cy)-i._heightPixels()/a.y._max/2},r:function(t,e,i){var a=0,n=1;return null===i.z||void 0===i.z?a=i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&i.radius>1&&(n=i.radius/i.z._scale(i.z._max)),a=i.z._hasMeasure()?i.z._scale(t.r)*n:i.z._scale(e._heightPixels()/100)*n),a},xGap:function(t,e){var i=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(i=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),i},xClusterGap:function(t,i,a){var n=0;return null!==a.x.categoryFields&&void 0!==a.x.categoryFields&&a.x.categoryFields.length>=2&&a.clusterBarGap>0&&!a.x._hasMeasure()&&(n=t.width*(i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))*(a.clusterBarGap>.99?.99:a.clusterBarGap)/2),n},yGap:function(t,e){var i=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(i=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),i},yClusterGap:function(t,i,a){var n=0;return null!==a.y.categoryFields&&void 0!==a.y.categoryFields&&a.y.categoryFields.length>=2&&a.clusterBarGap>0&&!a.y._hasMeasure()&&(n=t.height*(i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))*(a.clusterBarGap>.99?.99:a.clusterBarGap)/2),n},x:function(t,i,a){return a.x._hasTimeField()?a.x._scale(t.x)-e._helpers.width(t,i,a)/2:null!==a.x.measure&&void 0!==a.x.measure?a.x._scale(t.x):a.x._scale(t.x)+e._helpers.xGap(i,a)+t.xOffset*(e._helpers.width(t,i,a)+2*e._helpers.xClusterGap(t,i,a))+e._helpers.xClusterGap(t,i,a)},y:function(t,i,a){return a.y._hasTimeField()?a.y._scale(t.y)-e._helpers.height(t,i,a)/2:null!==a.y.measure&&void 0!==a.y.measure?a.y._scale(t.y):a.y._scale(t.y)-i._heightPixels()/a.y._max+e._helpers.yGap(i,a)+t.yOffset*(e._helpers.height(t,i,a)+2*e._helpers.yClusterGap(t,i,a))+e._helpers.yClusterGap(t,i,a)},width:function(t,i,a){return null!==a.x.measure&&void 0!==a.x.measure?Math.abs(a.x._scale(t.x<0?t.x-t.width:t.x+t.width)-a.x._scale(t.x)):a.x._hasTimeField()?a.x.floatingBarWidth:t.width*(i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))-2*e._helpers.xClusterGap(t,i,a)},height:function(t,i,a){return a.y._hasTimeField()?a.y.floatingBarWidth:null!==a.y.measure&&void 0!==a.y.measure?Math.abs(a.y._scale(t.y)-a.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))-2*e._helpers.yClusterGap(t,i,a)},opacity:function(t,e,i){return null!==i.c&&void 0!==i.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,i){return null!==i.c&&void 0!==i.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,i){return null!==i.c&&void 0!==i.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},e._interpolate=function(e,i){if(e&&i){if("[object String]"===Object.prototype.toString.call(i))switch(i){case"linear":i=t.curveLinear;break;case"linear-closed":i=t.curveLinearClosed;break;case"step":i=t.curveStep;break;case"step-before":i=t.curveStepBefore;break;case"step-after":i=t.curveStepAfter;break;case"basis":i=t.curveBasis;break;case"basis-open":i=t.curveBasisOpen;break;case"basis-closed":i=t.curveBasisClosed;break;case"bundle":i=t.curveBundle;break;case"cardinal":i=t.curveCardinal;break;case"cardinal-open":i=t.curveCardinalOpen;break;case"cardinal-closed":i=t.curveCardinalClosed;break;case"monotone":i=t.curveMonotoneX}e.curve(i)}},e._parentHeight=function(t){var e=t.getBoundingClientRect().height;return(!e||e<0)&&(e=t.clientHeight),e},e._parentWidth=function(t){var e=t.getBoundingClientRect().width;return(!e||e<0)&&(e=t.clientWidth),e},e._parsePosition=function(t,e){var i=0;return t&&t.toString().split(",").forEach((function(a){a&&(isNaN(a)?"%"===a.slice(-1)?i+=e*(parseFloat(a.slice(0,a.length-1))/100):"px"===a.slice(-2)?i+=parseFloat(a.slice(0,a.length-2)):i=t:i+=parseFloat(a))}),this),i<0&&(i=e+i),i},e._parseXPosition=function(t,i){return e._parsePosition(t,e._parentWidth(i))},e._parseYPosition=function(t,i){return e._parsePosition(t,e._parentHeight(i))},e._postDrawHandling=function(t,e,i,a){0===a?(e.each((function(e,i){t.afterDraw&&t.afterDraw(this,e,i)})),i.remove()):(e.on("end",(function(e,i){t.afterDraw&&t.afterDraw(this,e,i)})),i.call((function(){t.shapes&&t.shapes.exit().remove()})))},e._removeTooltip=function(t,e,i,a){i._tooltipGroup&&i._tooltipGroup.remove()},e._rollUp=function(t,e,i){var a=[];return e=null!=e?[].concat(e):[],t.forEach((function(t){var n=-1,r={},s=!0;a.forEach((function(i,a){-1===n&&(s=!0,e.forEach((function(e){s=s&&t[e]===i[e]}),this),s&&(n=a))}),this),-1!==n?r=a[n]:(e.forEach((function(e){r[e]=t[e]}),this),a.push(r),n=a.length-1),i.forEach((function(i){-1===e.indexOf(i)&&(void 0===r[i]&&(r[i]=[]),r[i]=r[i].concat(t[i]))}),this),a[n]=r}),this),a},e._showBarTooltip=function(e,i,a,n){var r,s,o,l,c,u,h=10,d=t.select(i),p=d.node().getBBox().x,g=d.node().getBBox().y,f=d.node().getBBox().width,m=d.node().getBBox().height,y=d.attr("opacity"),x=d.attr("fill"),v=n._dropLineOrigin(),b=t.rgb(t.rgb(x).r+.6*(255-t.rgb(x).r),t.rgb(x).g+.6*(255-t.rgb(x).g),t.rgb(x).b+.6*(255-t.rgb(x).b)),_=t.rgb(t.rgb(x).r+.8*(255-t.rgb(x).r),t.rgb(x).g+.8*(255-t.rgb(x).g),t.rgb(x).b+.8*(255-t.rgb(x).b)),w=n.getTooltipText(e),S=0,k=0,T=0,C=function(t,e){var i=d.node().getCTM(),n=a.svg.node().createSVGPoint();return n.x=t||0,n.y=e||0,n.matrixTransform(i)};null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),a._tooltipGroup=a.svg.append("g"),n.p||(u=n._isStacked()?1:f/2,n.x._hasCategories()||null===v.y||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",p<n.x._origin?p+u:p+f-u).attr("y1",g<v.y?g+m:g).attr("x2",p<n.x._origin?p+u:p+f-u).attr("y2",g<v.y?g+m:g).call((function(t){a.noFormats||t.style("fill","none").style("stroke",x).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",y)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",g<v.y?v.y-1:v.y+1),u=n._isStacked()?1:m/2,n.y._hasCategories()||null===v.x||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",p<v.x?p+f:p).attr("y1",g<n.y._origin?g+u:g+m-u).attr("x2",p<v.x?p+f:p).attr("y2",g<n.y._origin?g+u:g+m-u).call((function(t){a.noFormats||t.style("fill","none").style("stroke",x).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",y)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",p<v.x?v.x-1:v.x+1)),s=(r=a._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+a.customClassList.tooltipBox),r.selectAll(".dimple-dont-select-any").data(w).enter().append("text").attr("class","dimple-tooltip "+a.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){a.noFormats||t.style("font-family",n.tooltipFontFamily).style("font-size",n._getTooltipFontSize())})),r.each((function(){k=this.getBBox().width>k?this.getBBox().width:k,T=this.getBBox().width>T?this.getBBox().height:T})),r.selectAll("text").attr("x",0).attr("y",(function(){return(S+=this.getBBox().height)-this.getBBox().height/2})),s.attr("x",-5).attr("y",-5).attr("height",Math.floor(S+5)-.5).attr("width",k+10).attr("rx",5).attr("ry",5).call((function(t){a.noFormats||t.style("fill",_).style("stroke",b).style("stroke-width",2).style("opacity",.95)})),C(p+f+5+h+k).x<parseFloat(a.svg.node().getBBox().width)?(o=p+f+5+h,l=g+m/2-(S-(T-5))/2):C(p-(15+k)).x>0?(o=p-(15+k),l=g+m/2-(S-(T-5))/2):C(0,g+m+S+h+5).y<parseFloat(a.svg.node().getBBox().height)?(o=(o=(o=p+f/2-(10+k)/2)>0?o:h)+k<parseFloat(a.svg.node().getBBox().width)?o:parseFloat(a.svg.node().getBBox().width)-k-h,l=g+m+10):(o=(o=(o=p+f/2-(10+k)/2)>0?o:h)+k<parseFloat(a.svg.node().getBBox().width)?o:parseFloat(a.svg.node().getBBox().width)-k-h,l=g-S-(T-5)),c=C(o,l),r.attr("transform","translate("+c.x+" , "+c.y+")")},e._showPointTooltip=function(i,a,n,r){var s,o,l,c,u=10,h=t.select(a),d=parseFloat(h.attr("cx")),p=parseFloat(h.attr("cy")),g=parseFloat(h.attr("r")),f=e._helpers.opacity(i,n,r),m=h.attr("stroke"),y=r._dropLineOrigin(),x=t.rgb(t.rgb(m).r+.6*(255-t.rgb(m).r),t.rgb(m).g+.6*(255-t.rgb(m).g),t.rgb(m).b+.6*(255-t.rgb(m).b)),v=t.rgb(t.rgb(m).r+.8*(255-t.rgb(m).r),t.rgb(m).g+.8*(255-t.rgb(m).g),t.rgb(m).b+.8*(255-t.rgb(m).b)),b=0,_=0,w=0,S=r.getTooltipText(i);null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),n._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+n.customClassList.lineMarkerCircle).attr("cx",d).attr("cy",p).attr("r",g).call((function(t){n.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",m).style("stroke-width",1)})).transition().duration(375).ease(t.easeLinear).attr("r",g+r.lineWeight+2).call((function(t){n.noFormats||t.attr("opacity",1).style("stroke-width",2)})),null!==y.y&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d).attr("y1",p<y.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).attr("x2",d).attr("y2",p<y.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",p<y.y?y.y-1:y.y+1),null!==y.x&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d<y.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y1",p).attr("x2",d<y.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y2",p).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",d<y.x?y.x-1:y.x+1),o=(s=n._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+n.customClassList.tooltipBox),s.selectAll(".dont-select-any").data(S).enter().append("text").attr("class","dimple-tooltip "+n.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){n.noFormats||t.style("font-family",r.tooltipFontFamily).style("font-size",r._getTooltipFontSize())})),s.each((function(){_=this.getBBox().width>_?this.getBBox().width:_,w=this.getBBox().width>w?this.getBBox().height:w})),s.selectAll("text").attr("x",0).attr("y",(function(){return(b+=this.getBBox().height)-this.getBBox().height/2})),o.attr("x",-5).attr("y",-5).attr("height",Math.floor(b+5)-.5).attr("width",_+10).attr("rx",5).attr("ry",5).call((function(t){n.noFormats||t.style("fill",v).style("stroke",x).style("stroke-width",2).style("opacity",.95)})),d+g+5+u+_<parseFloat(n.svg.node().getBBox().width)?(l=d+g+5+u,c=p-(b-(w-5))/2):d-g-(15+_)>0?(l=d-g-(15+_),c=p-(b-(w-5))/2):p+g+b+u+5<parseFloat(n.svg.node().getBBox().height)?(l=(l=(l=d-(10+_)/2)>0?l:u)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-u,c=p+g+10):(l=(l=(l=d-(10+_)/2)>0?l:u)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-u,c=p-b-(w-5)),s.attr("transform","translate("+l+" , "+c+")")},e.filterData=function(t,e,i){var a=t;return null!==e&&null!==i&&(null!=i&&(i=[].concat(i)),a=[],t.forEach((function(t){null===t[e]?a.push(t):i.indexOf([].concat(t[e]).join("/"))>-1&&a.push(t)}),this)),a},e.getUniqueValues=function(t,e){var i=[];return null!=e&&(e=[].concat(e),t.forEach((function(t){var a="";e.forEach((function(e,i){i>0&&(a+="/"),a+=t[e]}),this),-1===i.indexOf(a)&&i.push(a)}),this)),i},e.newSvg=function(e,i,a){var n=null;if(null!=e||(e="body"),(n=t.select(e)).empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return n.append("svg").attr("width",i).attr("height",a)},e}))},22:function(t,e,i){"use strict";var a=i(3),n=i(0),r=(i(46),i(5)),s=i.n(r),o={initChartColorsDialog:function(t){var e,i="tf-chart-color-"+t.macroId,r=i+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:i,dialogId:r,options:{offsetX:-20,width:220,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){e=[];var i=t.getChartColorLabels(),n=[];return i.forEach((function(i,s){var o=t.colors[s%t.colors.length];e.push(o),n.push({color:o,field:i,id:r,variant:a.a.FIELD_VARIANTS.COLORS})})),s.a.inlineDialog({clazz:"tf-chart-colors-dialog",name:"chart-colors",inputs:n,dialogId:r})},applyCallback:function(){n.a.chartColors.forEach((function(t){-1==$.inArray(t,e)&&e.push(t)})),t.triggerSettingsButtonInvoke(),t.enableSaveBtn(),t.colors=e,t.colorKeyMap=function(t,e,i){return e.forEach((function(e,a){t[e]=i[a]})),t}({},t.getChartColorLabels(),e),t.colorsCache=t.colors.slice(),t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},bindsCallback:function(t){t.popup.find(".tfc-color:not(.selected)").on("click",(function(){var i=$(this);e[i.data("index")]=i.data("color"),t.popup.find("button .tfc-color").eq(i.data("index")).css("background",i.data("color")).attr("data-color",i.data("color"))}))},hideCallback:function(){t.controls.removeClass("active")}})},initInterpolationDialog:function(t){var e="tf-interpolation-dialog-"+t.macroId,i=e+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:e,dialogId:i,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,i){t.interpolation[e]||(t.interpolation[e]=t.defaultInterpolation),n.push({field:e,value:t.interpolation[e],variant:a.a.FIELD_VARIANTS.INTERPOLATION_SELECT})})),s.a.inlineDialog({clazz:"tf-interpolation-dialog",name:"interpolation",inputs:n,dialogId:i})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var i={};e.popup.find("form").find("select").each((function(t,e){var a=$(e);i[a.data("name")]=a.val()})),t.interpolation=i,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})},initLineSettingsDialog:function(t){var e="tf-line-settings-dialog-"+t.macroId,i=e+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:e,dialogId:i,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,i){t.lineSettings[e]||(t.lineSettings[e]={type:"solid",width:1.5}),n.push({field:e,value:t.lineSettings[e],variant:a.a.FIELD_VARIANTS.LINE_SETTINGS})})),s.a.inlineDialog({clazz:"tf-line-settings-dialog",name:"line-settings",inputs:n,dialogId:i})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var i={};e.popup.find("form").find(".field-group").each((function(t,e){var a=$(e),n=a.find("select"),r=n.data("name"),s=n.val(),o=Math.abs(parseFloat(a.find("input").val()||"1.5"));i[r]={type:s,width:o}})),t.lineSettings=i,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})}};e.a=o},3:function(t,e,i){"use strict";var a={FIELD_VARIANTS:{CHECKBOX:"checkbox",COLORS:"colors",INTERPOLATION_SELECT:"interpolation_select",LINE_SETTINGS:"line_settings",NUMBER:"number",SINGLE_SELECT:"single_select",TEXT:"text",RANGE:"range"},isMultiSelectFilter:function(t){return"icon"===t||"select_"===t||"hideColumns"===t},isAllColumnsFilter:function(t){return"global"===t||"hideColumns"===t},isRangeFilter:function(t){return"number_"===t||"date_"===t},fieldTypeToVariant:function(t){var e;switch(t){case"date_":case"number_":e=a.FIELD_VARIANTS.RANGE;break;case"hideColumns":case"select_":case"icon":e=a.FIELD_VARIANTS.SINGLE_SELECT;break;case"freetext_":case"global":default:e=a.FIELD_VARIANTS.TEXT}return e},initAJSDialog:function(t){return AJS.InlineDialog(t.container,t.dialogName,(function(e,i,a){return e.html(t.getContent()),a(),!1}),{initCallback:function(){var e=this;e.popup.find("#cancel-"+t.dialogId).click((function(){return e.hide(),"function"==typeof t.cancelCallback&&t.cancelCallback(),!1})),e.popup.find("#apply-"+t.dialogId).click((function(){return $(this).prop("disabled",!0),e.hide(),"function"==typeof t.applyCallback&&t.applyCallback(e),!1})),e.popup.find(".aui-dropdown2").click((function(){return!1})),"function"==typeof t.bindsCallback&&t.bindsCallback(e)},hideCallback:function(){"function"==typeof t.hideCallback&&t.hideCallback()},hideDelay:null,gravity:t.options.gravity||"n",persistent:t.options.persistent,width:t.options.width,offsetX:t.options.offsetX,noBind:t.options.noBind,addActiveClass:t.options.addActiveClass||!0})}};e.a=a},30:function(t,e,i){"use strict";var a=i(17);a.selection.prototype.filterByAttr=function(t,e){return this.filter((function(){return this.attributes[t].textContent===e}))},a.transition.prototype.filterByAttr=a.selection.prototype.filterByAttr;var n=a,r=i(18),s=i(21),o=i.n(s),l=i(42),c=i.n(l);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=0,p={header:{title:{text:"",color:"#333333",fontSize:18,font:"arial"},subtitle:{text:"",color:"#666666",fontSize:14,font:"arial"},location:"top-center",titleSubtitlePadding:8},footer:{text:"",color:"#666666",fontSize:14,font:"arial",location:"left"},size:{canvasHeight:500,canvasWidth:500,pieInnerRadius:"0%",pieOuterRadius:null},data:{sortOrder:"none",ignoreSmallSegments:{enabled:!1,valueType:"percentage",value:null},smallSegmentGrouping:{enabled:!1,value:1,valueType:"percentage",label:"Other",color:"#cccccc"},content:[]},labels:{outer:{format:"label",hideWhenLessThanPercentage:null,pieDistance:30},inner:{format:"percentage",hideWhenLessThanPercentage:null},mainLabel:{color:"#333333",font:"arial",fontSize:10},percentage:{color:"#dddddd",font:"arial",fontSize:10,decimalPlaces:0},value:{color:"#cccc44",font:"arial",fontSize:10},lines:{enabled:!0,style:"curved",color:"segment"},truncation:{enabled:!1,truncateLength:30},formatter:null},effects:{load:{effect:"default",speed:1e3},pullOutSegmentOnClick:{effect:"bounce",speed:300,size:10},highlightSegmentOnMouseover:!0,highlightLuminosity:-.2},tooltips:{enabled:!1,type:"placeholder",string:"",placeholderParser:null,styles:{fadeInSpeed:250,backgroundColor:"#000000",backgroundOpacity:.5,color:"#efefef",borderRadius:2,font:"arial",fontSize:10,padding:4}},misc:{colors:{background:null,segments:["#2484c1","#65a620","#7b6888","#a05d56","#961a1a","#d8d23a","#e98125","#d0743c","#635222","#6ada6a","#0c6197","#7d9058","#207f33","#44b9b0","#bca44a","#e4a14b","#a3acb2","#8cc3e9","#69a6f9","#5b388f","#546e91","#8bde95","#d2ab58","#273c71","#98bf6e","#4daa4b","#98abc5","#cc1010","#31383b","#006391","#c2643f","#b0a474","#a5a39c","#a9c2bc","#22af8c","#7fcecf","#987ac6","#3d3b87","#b77b1c","#c9c2b6","#807ece","#8db27c","#be66a2","#9ed3c6","#00644b","#005064","#77979f","#77e079","#9c73ab","#1f79a7"],segmentStroke:"#ffffff"},gradient:{enabled:!1,percentage:95,color:"#000000"},canvasPadding:{top:5,right:5,bottom:5,left:5},pieCenterOffset:{x:0,y:0},cssPrefix:null},callbacks:{onload:null,onMouseoverSegment:null,onMouseoutSegment:null,onClickSegment:null}},g=function(t){var e=t.cssPrefix,i=t.element,a=t.options;if(!(i instanceof HTMLElement||i instanceof SVGElement))return!1;if(!/[a-zA-Z][a-zA-Z0-9_-]*$/.test(e))return!1;if(!f.isArray(a.data.content))return!1;if(0===a.data.content.length)return!1;for(var n=[],r=0;r<a.data.content.length;r++)"number"!=typeof a.data.content[r].value||isNaN(a.data.content[r].value)||a.data.content[r].value<=0||n.push(a.data.content[r]);return t.options.data.content=n,!0},f={addSVGSpace:function(t){var e=t.element,i=t.options.size.canvasWidth,a=t.options.size.canvasHeight,r=t.options.misc.colors.background,s=n.select(e).append("svg:svg").attr("width",i).attr("height",a);return"transparent"!==r&&s.style("background-color",(function(){return r})),s},whenIdExists:function(t,e){var i=1,a=setInterval((function(){document.getElementById(t)&&(clearInterval(a),e()),i>1e3&&clearInterval(a),i++}),1)},whenElementsExist:function(t,e){var i=1,a=setInterval((function(){for(var n=!0,r=0;r<t.length;r++)if(!document.getElementById(t[r])){n=!1;break}n&&(clearInterval(a),e()),i>1e3&&clearInterval(a),i++}),1)},shuffleArray:function(t){for(var e,i,a=t.length;0!==a;)i=Math.floor(Math.random()*a),e=t[a-=1],t[a]=t[i],t[i]=e;return t},processObj:function(t,e,i){return"string"==typeof e?f.processObj(t,e.split("."),i):1===e.length&&void 0!==i?(t[e[0]]=i,t[e[0]]):0===e.length?t:f.processObj(t[e[0]],e.slice(1),i)},getDimensions:function(t){var e=document.getElementById(t),i=0,a=0;if(e){var n=e.getBBox();i=n.width,a=n.height}return{w:i,h:a}},rectIntersect:function(t,e){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y+e.h<t.y||e.y>t.y+t.h)},getColorShade:function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;for(var i="#",a=0;a<3;a++){var n=parseInt(t.substr(2*a,2),16);i+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16))).substr(n.length)}return i},initSegmentColors:function(t){for(var e=t.options.data.content,i=t.options.misc.colors.segments,a=[],n=0;n<e.length;n++)e[n].hasOwnProperty("color")?a.push(e[n].color):a.push(i[n]);return a},applySmallSegmentGrouping:function(t,e){var i;"percentage"===e.valueType&&(i=y.getTotalPieSize(t));for(var a=[],n=[],r=0,s=0;s<t.length;s++)if("percentage"===e.valueType){if(t[s].value/i*100<=e.value){n.push(t[s]),r+=t[s].value;continue}t[s].isGrouped=!1,a.push(t[s])}else{if(t[s].value<=e.value){n.push(t[s]),r+=t[s].value;continue}t[s].isGrouped=!1,a.push(t[s])}return n.length&&a.push({color:e.color,label:e.label,value:r,isGrouped:!0,groupedData:n}),a},showPoint:function(t,e,i){t.append("circle").attr("cx",e).attr("cy",i).attr("r",2).style("fill","black")},isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},m=function t(){var e,i,a,n,r,s,o=arguments[0]||{},l=1,c=arguments.length,h=!1,d=Object.prototype.toString,p=Object.prototype.hasOwnProperty,g={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},f={isFunction:function(t){return"function"===f.type(t)},isArray:Array.isArray||function(t){return"array"===f.type(t)},isWindow:function(t){return null!==t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null===t?String(t):g[d.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==f.type(t)||t.nodeType)return!1;try{if(t.constructor&&!p.call(t,"constructor")&&!p.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||p.call(t,e)}};for("boolean"==typeof o&&(h=o,o=arguments[1]||{},l=2),"object"===u(o)||f.isFunction(o)||(o={}),c===l&&(o=this,--l);l<c;l++)if(null!==(e=arguments[l]))for(i in e)a=o[i],o!==(n=e[i])&&(h&&n&&(f.isPlainObject(n)||(r=f.isArray(n)))?(r?(r=!1,s=a&&f.isArray(a)?a:[]):s=a&&f.isPlainObject(a)?a:{},o[i]=t(h,s,n)):void 0!==n&&(o[i]=n));return o},y={toRadians:function(t){return t*(Math.PI/180)},toDegrees:function(t){return t*(180/Math.PI)},computePieRadius:function(t){var e=t.options.size,i=t.options.misc.canvasPadding,a=e.canvasWidth-i.left-i.right,n=e.canvasHeight-i.top-i.bottom;"pie-center"!==t.options.header.location&&(n-=t.textComponents.headerHeight),t.textComponents.footer.exists&&(n-=t.textComponents.footer.h);var r,s,o=(a<(n=n<0?0:n)?a:n)/("none"===t.options.labels.outer.format?2:3);if(null!==e.pieOuterRadius)if(/%/.test(e.pieOuterRadius)){s=(s=(s=parseInt(e.pieOuterRadius.replace(/[\D]/,""),10))>99?99:s)<0?0:s;var l=a<n?a:n;if("none"!==t.options.labels.outer.format){var c=2*parseInt(t.options.labels.outer.pieDistance,10);l-c>0&&(l-=c)}o=Math.floor(l/100*s)/2}else o=parseInt(e.pieOuterRadius,10);/%/.test(e.pieInnerRadius)?(s=(s=(s=parseInt(e.pieInnerRadius.replace(/[\D]/,""),10))>99?99:s)<0?0:s,r=Math.floor(o/100*s)):r=parseInt(e.pieInnerRadius,10),t.innerRadius=r,t.outerRadius=o},getTotalPieSize:function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i].value;return e},sortPieData:function(t){var e=t.options.data.content;switch(t.options.data.sortOrder){case"none":break;case"random":e=f.shuffleArray(e);break;case"value-asc":e.sort((function(t,e){return t.value<e.value?-1:1}));break;case"value-desc":e.sort((function(t,e){return t.value<e.value?1:-1}));break;case"label-asc":e.sort((function(t,e){return t.label.toLowerCase()>e.label.toLowerCase()?1:-1}));break;case"label-desc":e.sort((function(t,e){return t.label.toLowerCase()<e.label.toLowerCase()?1:-1}))}return e},getPieTranslateCenter:function(t){return"translate("+t.x+","+t.y+")"},calculatePieCenter:function(t){var e=t.options.misc.pieCenterOffset,i=t.textComponents.title.exists&&"pie-center"!==t.options.header.location,a=t.textComponents.subtitle.exists&&"pie-center"!==t.options.header.location,n=t.options.misc.canvasPadding.top;i&&a?n+=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h:i?n+=t.textComponents.title.h:a&&(n+=t.textComponents.subtitle.h);var r=0;t.textComponents.footer.exists&&(r=t.textComponents.footer.h+t.options.misc.canvasPadding.bottom);var s=(t.options.size.canvasWidth-t.options.misc.canvasPadding.left-t.options.misc.canvasPadding.right)/2+t.options.misc.canvasPadding.left,o=(t.options.size.canvasHeight-r-n)/2+n;s+=e.x,o+=e.y,t.pieCenter={x:s,y:o}},rotate:function(t,e,i,a,n){n=n*Math.PI/180;var r=Math.cos,s=Math.sin;return{x:(t-i)*r(n)-(e-a)*s(n)+i,y:(t-i)*s(n)+(e-a)*r(n)+a}},translate:function(t,e,i,a){var n=y.toRadians(a);return{x:t+i*Math.sin(n),y:e-i*Math.cos(n)}},pointIsInArc:function(t,e,i){var a=i.innerRadius()(e),n=i.outerRadius()(e),r=i.startAngle()(e),s=i.endAngle()(e),o=t.x*t.x+t.y*t.y,l=Math.atan2(t.x,-t.y);return l=l<0?l+2*Math.PI:l,a*a<=o&&o<=n*n&&r<=l&&l<=s}},x={add:function(t,e,i){var a=x.getIncludes(i),n=t.options.labels,r=t.svg.insert("g","."+t.cssPrefix+"labels-"+e).attr("class",t.cssPrefix+"labels-"+e).selectAll("."+t.cssPrefix+"labelGroup-"+e).data(t.options.data.content).enter().append("g").attr("id",(function(i,a){return t.cssPrefix+"labelGroup"+a+"-"+e})).attr("data-index",(function(t,e){return e})).attr("class",t.cssPrefix+"labelGroup-"+e).style("opacity",0),s={section:e,sectionDisplayType:i};a.mainLabel&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentMainLabel"+a+"-"+e})).attr("class",t.cssPrefix+"segmentMainLabel-"+e).text((function(t,e){var i=t.label;return n.formatter?(s.index=e,s.part="mainLabel",s.value=t.value,s.label=i,i=n.formatter(s)):n.truncation.enabled&&t.label.length>n.truncation.truncateLength&&(i=t.label.substring(0,n.truncation.truncateLength)+"..."),i})).style("font-size",n.mainLabel.fontSize+"px").style("font-family",n.mainLabel.font).style("fill",n.mainLabel.color),a.percentage&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentPercentage"+a+"-"+e})).attr("class",t.cssPrefix+"segmentPercentage-"+e).text((function(t,e){var i=t.percentage;return n.formatter?(s.index=e,s.part="percentage",s.value=t.value,s.label=t.percentage,i=n.formatter(s)):i+="%",i})).style("font-size",n.percentage.fontSize+"px").style("font-family",n.percentage.font).style("fill",n.percentage.color),a.value&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentValue"+a+"-"+e})).attr("class",t.cssPrefix+"segmentValue-"+e).text((function(t,e){return s.index=e,s.part="value",s.value=t.value,s.label=t.value,n.formatter?n.formatter(s,t.value):t.value})).style("font-size",n.value.fontSize+"px").style("font-family",n.value.font).style("fill",n.value.color)},positionLabelElements:function(t,e,i){x["dimensions-"+e]=[],n.selectAll("."+t.cssPrefix+"labelGroup-"+e).each((function(i,a){var r=n.select(this).selectAll("."+t.cssPrefix+"segmentMainLabel-"+e),s=n.select(this).selectAll("."+t.cssPrefix+"segmentPercentage-"+e),o=n.select(this).selectAll("."+t.cssPrefix+"segmentValue-"+e);x["dimensions-"+e].push({mainLabel:null!==r.node()?r.node().getBBox():null,percentage:null!==s.node()?s.node().getBBox():null,value:null!==o.node()?o.node().getBBox():null})}));var a=x["dimensions-"+e];switch(i){case"label-value1":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width+5}));break;case"label-value2":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dy",(function(t,e){return a[e].mainLabel.height}));break;case"label-percentage1":n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width+5}));break;case"label-percentage2":n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width/2-a[e].percentage.width/2})).attr("dy",(function(t,e){return a[e].mainLabel.height}));break;case"value-percentage":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return a[e].percentage.width/2-a[e].value.width/2})).attr("dy",(function(t,e){return-a[e].percentage.height/2})),n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return a[e].percentage.height/2}));break;case"percentage-value":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return a[e].percentage.width/2-a[e].value.width/2})).attr("dy",(function(t,e){return a[e].percentage.height/2})),n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return-a[e].percentage.height/2}))}},computeLabelLinePositions:function(t){t.lineCoordGroups=[],n.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,i){return x.computeLinePosition(t,i)}))},computeLinePosition:function(t,e){var i,a,n,r,s=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),o=y.rotate(t.pieCenter.x,t.pieCenter.y-t.outerRadius,t.pieCenter.x,t.pieCenter.y,s),l=t.outerLabelGroupData[e].h/5,c=Math.floor(s/90);switch(2===c&&180===s&&(c=1),c){case 0:i=t.outerLabelGroupData[e].x-6-(t.outerLabelGroupData[e].x-6-o.x)/2,a=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 1:i=o.x+(t.outerLabelGroupData[e].x-o.x)/4,a=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 2:var u=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;i=o.x-(o.x-u)/4,a=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l;break;case 3:var h=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;i=h+(o.x-h)/4,a=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l}"straight"===t.options.labels.lines.style?t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:n,y:r}]:t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:i,y:a},{x:n,y:r}]},addLabelLines:function(t){var e=t.svg.insert("g","."+t.cssPrefix+"pieChart").attr("class",t.cssPrefix+"lineGroups").style("opacity",0).selectAll("."+t.cssPrefix+"lineGroup").data(t.lineCoordGroups).enter().append("g").attr("class",t.cssPrefix+"lineGroup"),i=n.line().curve(n.curveBasis).x((function(t){return t.x})).y((function(t){return t.y}));e.append("path").attr("d",i).attr("stroke",(function(e,i){return"segment"===t.options.labels.lines.color?t.options.colors[i]:t.options.labels.lines.color})).attr("stroke-width",1).attr("fill","none").style("opacity",(function(e,i){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&e.percentage<a||""===t.options.data.content[i].label?0:1}))},positionLabelGroups:function(t,e){"none"!==t.options.labels[e].format&&n.selectAll("."+t.cssPrefix+"labelGroup-"+e).style("opacity",0).attr("transform",(function(i,a){var n,r;if("outer"===e)n=t.outerLabelGroupData[a].x,r=t.outerLabelGroupData[a].y;else{var s=m(!0,{},t.pieCenter);if(t.innerRadius>0){var o=v.getSegmentAngle(a,t.options.data.content,t.totalSize,{midpoint:!0}),l=y.translate(t.pieCenter.x,t.pieCenter.y,t.innerRadius,o);s.x=l.x,s.y=l.y}var c=f.getDimensions(t.cssPrefix+"labelGroup"+a+"-inner"),u=c.w/2,h=c.h/4;n=s.x+(t.lineCoordGroups[a][0].x-s.x)/1.8,r=s.y+(t.lineCoordGroups[a][0].y-s.y)/1.8,n-=u,r+=h}return"translate("+n+","+r+")"}))},fadeInLabelsAndLines:function(t){var e="default"===t.options.effects.load.effect?t.options.effects.load.speed:1;setTimeout((function(){var e="default"===t.options.effects.load.effect?400:1;n.selectAll("."+t.cssPrefix+"labelGroup-outer").transition().duration(e).style("opacity",(function(e,i){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&e.percentage<a?0:1})),n.selectAll("."+t.cssPrefix+"labelGroup-inner").transition().duration(e).style("opacity",(function(e,i){var a=t.options.labels.inner.hideWhenLessThanPercentage;return null!==a&&e.percentage<a?0:1})),n.selectAll("g."+t.cssPrefix+"lineGroups").transition().duration(e).style("opacity",1),f.isFunction(t.options.callbacks.onload)&&setTimeout((function(){try{t.options.callbacks.onload()}catch(t){}}),e)}),e)},getIncludes:function(t){var e=!1,i=!1,a=!1;switch(t){case"label":e=!0;break;case"value":i=!0;break;case"percentage":a=!0;break;case"label-value1":case"label-value2":e=!0,i=!0;break;case"label-percentage1":case"label-percentage2":e=!0,a=!0;break;case"value-percentage":case"percentage-value":i=!0,a=!0}return{mainLabel:e,value:i,percentage:a}},computeOuterLabelCoords:function(t){t.svg.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,i){return x.getIdealOuterLabelPositions(t,i)})),x.resolveOuterLabelCollisions(t)},resolveOuterLabelCollisions:function(t){if("none"!==t.options.labels.outer.format){var e=t.options.data.content.length;x.checkConflict(t,0,"clockwise",e),x.checkConflict(t,e-1,"anticlockwise",e)}},checkConflict:function(t,e,i,a){var n,r;if(!(a<=1)){var s=t.outerLabelGroupData[e].hs;if(!("clockwise"===i&&"right"!==s||"anticlockwise"===i&&"left"!==s)){var o="clockwise"===i?e+1:e-1,l=t.outerLabelGroupData[e],c=t.outerLabelGroupData[o],u={labelHeights:t.outerLabelGroupData[0].h,center:t.pieCenter,lineLength:t.outerRadius+t.options.labels.outer.pieDistance,heightChange:t.outerLabelGroupData[0].h+1};if("clockwise"===i){for(n=0;n<=e;n++)if(r=t.outerLabelGroupData[n],!x.isLabelHidden(t,n)&&f.rectIntersect(r,c)){x.adjustLabelPos(t,o,l,u);break}}else for(n=a-1;n>=e;n--)if(r=t.outerLabelGroupData[n],!x.isLabelHidden(t,n)&&f.rectIntersect(r,c)){x.adjustLabelPos(t,o,l,u);break}x.checkConflict(t,o,i,a)}}},isLabelHidden:function(t,e){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&d.percentage<i||""===t.options.data.content[e].label},adjustLabelPos:function(t,e,i,a){var n,r,s,o;o=i.y+a.heightChange,r=a.center.y-o,n=Math.abs(a.lineLength)>Math.abs(r)?Math.sqrt(a.lineLength*a.lineLength-r*r):Math.sqrt(r*r-a.lineLength*a.lineLength),s="right"===i.hs?a.center.x+n:a.center.x-n-t.outerLabelGroupData[e].w,t.outerLabelGroupData[e].x=s,t.outerLabelGroupData[e].y=o},getIdealOuterLabelPositions:function(t,e){var i=n.select("#"+t.cssPrefix+"labelGroup"+e+"-outer").node();if(i){var a=i.getBBox(),r=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),s=t.pieCenter.x,o=t.pieCenter.y-(t.outerRadius+t.options.labels.outer.pieDistance),l=y.rotate(s,o,t.pieCenter.x,t.pieCenter.y,r),c="right";r>180?(l.x-=a.width+8,c="left"):l.x+=8,t.outerLabelGroupData[e]={x:l.x,y:l.y,w:a.width,h:a.height,hs:c}}}},v={effectMap:{none:n.easeLinear,bounce:n.easeBounce,linear:n.easeLinear,sin:n.easeSin,elastic:n.easeElastic,back:n.easeBack,quad:n.easeQuad,circle:n.easeCircle,exp:n.easeExp},create:function(t){var e=t.pieCenter,i=t.options.colors,a=t.options.effects.load,r=t.options.misc.colors.segmentStroke,s=t.svg.insert("g","#"+t.cssPrefix+"title").attr("transform",(function(){return y.getPieTranslateCenter(e)})).attr("class",t.cssPrefix+"pieChart"),o=n.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius).startAngle(0).endAngle((function(e){return e.value/t.totalSize*2*Math.PI})),l=s.selectAll("."+t.cssPrefix+"arc").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"arc"),c=a.speed;"none"===a.effect&&(c=0),l.append("path").attr("id",(function(e,i){return t.cssPrefix+"segment"+i})).attr("fill",(function(e,a){var n=i[a];return t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+a+")"),n})).style("stroke",r).style("stroke-width",1).transition().ease(n.easeCubicInOut).duration(c).attr("data-index",(function(t,e){return e})).attrTween("d",(function(e){var i=n.interpolate({value:0},e);return function(e){return t.arc(i(e))}})),t.svg.selectAll("g."+t.cssPrefix+"arc").attr("transform",(function(e,i){var a=0;return i>0&&(a=v.getSegmentAngle(i-1,t.options.data.content,t.totalSize)),"rotate("+a+")"})),t.arc=o},addGradients:function(t){var e=t.svg.append("defs").selectAll("radialGradient").data(t.options.data.content).enter().append("radialGradient").attr("gradientUnits","userSpaceOnUse").attr("cx",0).attr("cy",0).attr("r","120%").attr("id",(function(e,i){return t.cssPrefix+"grad"+i}));e.append("stop").attr("offset","0%").style("stop-color",(function(e,i){return t.options.colors[i]})),e.append("stop").attr("offset",t.options.misc.gradient.percentage+"%").style("stop-color",t.options.misc.gradient.color)},addSegmentEventHandlers:function(t){var e=n.selectAll("."+t.cssPrefix+"arc,."+t.cssPrefix+"labelGroup-inner,."+t.cssPrefix+"labelGroup-outer");e.on("click",(function(){var e,i=n.select(this);if(i.attr("class")===t.cssPrefix+"arc")e=i.select("path");else{var a=i.attr("data-index");e=n.select("#"+t.cssPrefix+"segment"+a)}var r=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onClickSegment,e,r),"none"!==t.options.effects.pullOutSegmentOnClick.effect&&(r?v.closeSegment(t,e.node()):v.openSegment(t,e.node()))})),e.on("mouseover",(function(){var e,i,a=n.select(this);if(a.attr("class")===t.cssPrefix+"arc"?e=a.select("path"):(i=a.attr("data-index"),e=n.select("#"+t.cssPrefix+"segment"+i)),t.options.effects.highlightSegmentOnMouseover){i=e.attr("data-index");var r=t.options.colors[i];e.style("fill",f.getColorShade(r,t.options.effects.highlightLuminosity))}t.options.tooltips.enabled&&(i=e.attr("data-index"),_.showTooltip(t,i));var s=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoverSegment,e,s)})),e.on("mousemove",(function(){_.moveTooltip(t)})),e.on("mouseout",(function(){var e,i,a=n.select(this);if(a.attr("class")===t.cssPrefix+"arc"?e=a.select("path"):(i=a.attr("data-index"),e=n.select("#"+t.cssPrefix+"segment"+i)),t.options.effects.highlightSegmentOnMouseover){i=e.attr("data-index");var r=t.options.colors[i];t.options.misc.gradient.enabled&&(r="url(#"+t.cssPrefix+"grad"+i+")"),e.style("fill",r)}t.options.tooltips.enabled&&(i=e.attr("data-index"),_.hideTooltip(t,i));var s=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoutSegment,e,s)}))},onSegmentEvent:function(t,e,i,a){if(f.isFunction(e)){var n=parseInt(i.attr("data-index"),10);e({segment:i.node(),index:n,expanded:a,data:t.options.data.content[n]})}},openSegment:function(t,e){t.isOpeningSegment||(t.isOpeningSegment=!0,v.maybeCloseOpenSegment(t),n.select(e).transition().ease(v.effectMap[t.options.effects.pullOutSegmentOnClick.effect]).duration(t.options.effects.pullOutSegmentOnClick.speed).attr("transform",(function(e,i){var a=t.arc.centroid(e),n=a[0],r=a[1],s=Math.sqrt(n*n+r*r),o=parseInt(t.options.effects.pullOutSegmentOnClick.size,10);return"translate("+n/s*o+","+r/s*o+")"})).on("end",(function(i,a){t.currentlyOpenSegment=e,t.isOpeningSegment=!1,n.select(e).attr("class",t.cssPrefix+"expanded")})))},maybeCloseOpenSegment:function(t){n.selectAll("."+t.cssPrefix+"expanded").size()>0&&v.closeSegment(t,n.select("."+t.cssPrefix+"expanded").node())},closeSegment:function(t,e){n.select(e).transition().duration(400).attr("transform","translate(0,0)").on("end",(function(i,a){n.select(e).attr("class",""),t.currentlyOpenSegment=null}))},getCentroid:function(t){var e=t.getBBox();return{x:e.x+e.width/2,y:e.y+e.height/2}},getSegmentAngle:function(t,e,i,a){var n,r=m({compounded:!0,midpoint:!1},a),s=e[t].value;if(r.compounded){n=0;for(var o=0;o<=t;o++)n+=e[o].value}void 0===n&&(n=s);var l=n/i*360;r.midpoint&&(l-=s/i*360/2);return l}},b={offscreenCoord:-1e4,addTitle:function(t){t.svg.selectAll("."+t.cssPrefix+"title").data([t.options.header.title]).enter().append("text").text((function(t){return t.text})).attr("id",t.cssPrefix+"title").attr("class",t.cssPrefix+"title").attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("text-anchor",(function(){return"top-center"===t.options.header.location||"pie-center"===t.options.header.location?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionTitle:function(t){var e,i=t.textComponents,a=t.options.header.location,n=t.options.misc.canvasPadding,r=t.options.size.canvasWidth,s=t.options.header.titleSubtitlePadding;e="top-left"===a?n.left:(r-n.right)/2+n.left,e+=t.options.misc.pieCenterOffset.x;var o=n.top+i.title.h;"pie-center"===a&&(o=t.pieCenter.y,i.subtitle.exists?o=o-(i.title.h+s+i.subtitle.h)/2+i.title.h:o+=i.title.h/4);t.svg.select("#"+t.cssPrefix+"title").attr("x",e).attr("y",o)},addSubtitle:function(t){var e=t.options.header.location;t.svg.selectAll("."+t.cssPrefix+"subtitle").data([t.options.header.subtitle]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"subtitle").attr("class",t.cssPrefix+"subtitle").attr("text-anchor",(function(){return"top-center"===e||"pie-center"===e?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionSubtitle:function(t){var e,i=t.options.misc.canvasPadding,a=t.options.size.canvasWidth;e="top-left"===t.options.header.location?i.left:(a-i.right)/2+i.left,e+=t.options.misc.pieCenterOffset.x;var n=b.getHeaderHeight(t);t.svg.select("#"+t.cssPrefix+"subtitle").attr("x",e).attr("y",n)},addFooter:function(t){t.svg.selectAll("."+t.cssPrefix+"footer").data([t.options.footer]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"footer").attr("class",t.cssPrefix+"footer").attr("text-anchor",(function(){var e="left";return"bottom-center"===t.options.footer.location?e="middle":"bottom-right"===t.options.footer.location&&(e="left"),e})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionFooter:function(t){var e,i=t.options.footer.location,a=t.textComponents.footer.w,n=t.options.size.canvasWidth,r=t.options.size.canvasHeight,s=t.options.misc.canvasPadding;e="bottom-left"===i?s.left:"bottom-right"===i?n-a-s.right:n/2,t.svg.select("#"+t.cssPrefix+"footer").attr("x",e).attr("y",r-s.bottom)},getHeaderHeight:function(t){var e;if(t.textComponents.title.exists){var i=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h;e="pie-center"===t.options.header.location?t.pieCenter.y-i/2+i:i+t.options.misc.canvasPadding.top}else if("pie-center"===t.options.header.location){var a=t.options.misc.canvasPadding.bottom+t.textComponents.footer.h;e=(t.options.size.canvasHeight-a)/2+t.options.misc.canvasPadding.top+t.textComponents.subtitle.h/2}else e=t.options.misc.canvasPadding.top+t.textComponents.subtitle.h;return e}},_={addTooltips:function(t){var e=t.svg.insert("g").attr("class",t.cssPrefix+"tooltips");e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"tooltip").attr("id",(function(e,i){return t.cssPrefix+"tooltip"+i})).style("opacity",0).append("rect").attr("rx",t.options.tooltips.styles.borderRadius).attr("ry",t.options.tooltips.styles.borderRadius).attr("x",-t.options.tooltips.styles.padding).attr("opacity",t.options.tooltips.styles.backgroundOpacity).style("fill",t.options.tooltips.styles.backgroundColor),e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).append("text").attr("fill",(function(e){return t.options.tooltips.styles.color})).style("font-size",(function(e){return t.options.tooltips.styles.fontSize})).style("font-family",(function(e){return t.options.tooltips.styles.font})).text((function(e,i){var a=t.options.tooltips.string;return"caption"===t.options.tooltips.type&&(a=e.caption),_.replacePlaceholders(t,a,i,{label:e.label,value:e.value,percentage:e.percentage})})),e.selectAll("."+t.cssPrefix+"tooltip rect").attr("width",(function(e,i){return f.getDimensions(t.cssPrefix+"tooltip"+i).w+2*t.options.tooltips.styles.padding})).attr("height",(function(e,i){return f.getDimensions(t.cssPrefix+"tooltip"+i).h+2*t.options.tooltips.styles.padding})).attr("y",(function(e,i){return-f.getDimensions(t.cssPrefix+"tooltip"+i).h/2+1}))},showTooltip:function(t,e){var i=t.options.tooltips.styles.fadeInSpeed;_.currentTooltip===e&&(i=1),_.currentTooltip=e,n.select("#"+t.cssPrefix+"tooltip"+e).transition().duration(i).style("opacity",(function(){return 1})),_.moveTooltip(t)},moveTooltip:function(t){n.selectAll("#"+t.cssPrefix+"tooltip"+_.currentTooltip).attr("transform",(function(e){var i=n.mouse(this.parentNode);return"translate("+(i[0]+t.options.tooltips.styles.padding+2)+","+(i[1]-2*t.options.tooltips.styles.padding-2)+")"}))},hideTooltip:function(t,e){n.select("#"+t.cssPrefix+"tooltip"+e).style("opacity",(function(){return 0})),n.select("#"+t.cssPrefix+"tooltip"+_.currentTooltip).attr("transform",(function(e,i){return"translate("+(t.options.size.canvasWidth+1e3)+","+(t.options.size.canvasHeight+1e3)+")"}))},replacePlaceholders:function(t,e,i,a){f.isFunction(t.options.tooltips.placeholderParser)&&t.options.tooltips.placeholderParser(i,a);return e.replace(/\{(\w+)\}/g,(function(t){var e=arguments[1];return a.hasOwnProperty(e)?a[arguments[1]]:arguments[0]}))}},w=function(t,e){if(this.element=t,"string"==typeof t){var i=t.replace(/^#/,"");this.element=document.getElementById(i)}var a={};m(!0,a,p,e),this.options=a,null!==this.options.misc.cssPrefix?this.cssPrefix=this.options.misc.cssPrefix:(this.cssPrefix="p"+h+"_",h++),g(this)&&(n.select(this.element).attr("d3pie","0.2.1"),S.call(this),k.call(this))};w.prototype.recreate=function(){g(this)&&(S.call(this),k.call(this))},w.prototype.redraw=function(){this.element.innerHTML="",k.call(this)},w.prototype.destroy=function(){this.element.innerHTML="",n.select(this.element).attr("d3pie",null)},w.prototype.getOpenSegment=function(){var t=this.currentlyOpenSegment;if(null!=t){var e=parseInt(n.select(t).attr("data-index"),10);return{element:t,index:e,data:this.options.data.content[e]}}return null},w.prototype.openSegment=function(t){(t=parseInt(t,10))<0||t>this.options.data.content.length-1||v.openSegment(this,n.select("#"+this.cssPrefix+"segment"+t).node())},w.prototype.closeSegment=function(t){v.maybeCloseOpenSegment(t)},w.prototype.updateProp=function(t,e){switch(t){case"header.title.text":var i=f.processObj(this.options,t);f.processObj(this.options,t,e),n.select("#"+this.cssPrefix+"title").html(e),(""===i&&""!==e||""!==i&&""===e)&&this.redraw();break;case"header.subtitle.text":var a=f.processObj(this.options,t);f.processObj(this.options,t,e),n.select("#"+this.cssPrefix+"subtitle").html(e),(""===a&&""!==e||""!==a&&""===e)&&this.redraw();break;case"callbacks.onload":case"callbacks.onMouseoverSegment":case"callbacks.onMouseoutSegment":case"callbacks.onClickSegment":case"effects.pullOutSegmentOnClick.effect":case"effects.pullOutSegmentOnClick.speed":case"effects.pullOutSegmentOnClick.size":case"effects.highlightSegmentOnMouseover":case"effects.highlightLuminosity":f.processObj(this.options,t,e);break;default:f.processObj(this.options,t,e),this.destroy(),this.recreate()}};var S=function(){this.options.data.content=y.sortPieData(this),this.options.data.smallSegmentGrouping.enabled&&(this.options.data.content=f.applySmallSegmentGrouping(this.options.data.content,this.options.data.smallSegmentGrouping)),this.options.colors=f.initSegmentColors(this),this.totalSize=y.getTotalPieSize(this.options.data.content);for(var t=this.options.labels.percentage.decimalPlaces,e=0;e<this.options.data.content.length;e++)this.options.data.content[e].percentage=T(this.options.data.content[e].value,this.totalSize,t);for(var i=0,a=0;a<this.options.data.content.length;a++)a===this.options.data.content.length-1&&(this.options.data.content[a].percentage=(100-i).toFixed(t)),i+=parseFloat(this.options.data.content[a].percentage)},k=function(){this.svg=f.addSVGSpace(this),this.textComponents={headerHeight:0,title:{exists:""!==this.options.header.title.text,h:0,w:0},subtitle:{exists:""!==this.options.header.subtitle.text,h:0,w:0},footer:{exists:""!==this.options.footer.text,h:0,w:0}},this.outerLabelGroupData=[],this.textComponents.title.exists&&b.addTitle(this),this.textComponents.subtitle.exists&&b.addSubtitle(this),b.addFooter(this);var t=this;f.whenIdExists(this.cssPrefix+"footer",(function(){b.positionFooter(t);var e=f.getDimensions(t.cssPrefix+"footer");t.textComponents.footer.h=e.h,t.textComponents.footer.w=e.w}));var e=[];this.textComponents.title.exists&&e.push(this.cssPrefix+"title"),this.textComponents.subtitle.exists&&e.push(this.cssPrefix+"subtitle"),this.textComponents.footer.exists&&e.push(this.cssPrefix+"footer"),f.whenElementsExist(e,(function(){if(t.textComponents.title.exists){var e=f.getDimensions(t.cssPrefix+"title");t.textComponents.title.h=e.h,t.textComponents.title.w=e.w}if(t.textComponents.subtitle.exists){var i=f.getDimensions(t.cssPrefix+"subtitle");t.textComponents.subtitle.h=i.h,t.textComponents.subtitle.w=i.w}if(t.textComponents.title.exists||t.textComponents.subtitle.exists){var a=0;t.textComponents.title.exists&&(a+=t.textComponents.title.h,t.textComponents.subtitle.exists&&(a+=t.options.header.titleSubtitlePadding)),t.textComponents.subtitle.exists&&(a+=t.textComponents.subtitle.h),t.textComponents.headerHeight=a}y.computePieRadius(t),y.calculatePieCenter(t),b.positionTitle(t),b.positionSubtitle(t),t.options.misc.gradient.enabled&&v.addGradients(t),v.create(t),x.add(t,"inner",t.options.labels.inner.format),x.add(t,"outer",t.options.labels.outer.format),x.positionLabelElements(t,"inner",t.options.labels.inner.format),x.positionLabelElements(t,"outer",t.options.labels.outer.format),x.computeOuterLabelCoords(t),x.positionLabelGroups(t,"outer"),x.computeLabelLinePositions(t),t.options.labels.lines.enabled&&"none"!==t.options.labels.outer.format&&x.addLabelLines(t),x.positionLabelGroups(t,"inner"),x.fadeInLabelsAndLines(t),t.options.tooltips.enabled&&_.addTooltips(t),v.addSegmentEventHandlers(t)}))},T=function(t,e,i){var a=t/e;return i<=0?Math.round(100*a):(100*a).toFixed(i)},C=w,P=i(7),F=i(23),A=i(8),L=i.n(A),M={};function D(t,e,i,a){if(t.endAngle-t.startAngle==0)return"M 0 0";var n=e*Math.cos(t.startAngle),r=i*Math.sin(t.startAngle),s=e*Math.cos(t.endAngle),o=i*Math.sin(t.endAngle),l=[];return l.push("M",n,r,"A",e,i,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",s,o,"L",a*s,a*o),l.push("A",a*e,a*i,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",a*n,a*r,"z"),l.join(" ")}function I(t,e,i,a){var n=t.startAngle>Math.PI?Math.PI:t.startAngle,r=t.endAngle>Math.PI?Math.PI:t.endAngle,s=e*Math.cos(n),o=i*Math.sin(n),l=e*Math.cos(r),c=i*Math.sin(r),u=[];return u.push("M",s,a+o,"A",e,i,"0 0 1",l,a+c,"L",l,c,"A",e,i,"0 0 0",s,o,"z"),u.join(" ")}function B(t,e,i,a,n){var r=t.startAngle<Math.PI?Math.PI:t.startAngle,s=t.endAngle<Math.PI?Math.PI:t.endAngle,o=n*e*Math.cos(r),l=n*i*Math.sin(r),c=n*e*Math.cos(s),u=n*i*Math.sin(s),h=[];return h.push("M",o,l,"A",n*e,n*i,"0 0 1",c,u,"L",c,a+u,"A",n*e,n*i,"0 0 0",o,a+l,"z"),h.join(" ")}function V(t,e,i,a,n,r,s){t.data(e).enter().append("text").attr("class","percent").attr("x",(function(t){var e=AJS.$("<span>"+s(t)+"</span>");e.appendTo("body");var n=e.width();e.remove();var r=a*i,o=Math.cos(.5*(t.startAngle+t.endAngle));return.5*(a-r)*o+r*o-n/2})).attr("y",(function(t){var e=n*i,a=Math.sin(.5*(t.startAngle+t.endAngle));return.5*(n-e)*a+e*a+r})).text((function(t){return s(t)})).style("fill",(function(t){return t.data.textColor})).each((function(t){this._current=t}))}M.getPercent=function(t){return Math.round(1e3*(t.endAngle-t.startAngle)/(2*Math.PI))/10+"%"},M.transition=function(t,e,i,a,r,s){var o=n.pie().sort(null).value((function(t){return t.value}))(e);n.select("#"+t).selectAll(".innerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return B(e(t),i+.5,a+.5,r,s)}})),n.select("#"+t).selectAll(".topSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return D(e(t),i,a,s)}})),n.select("#"+t).selectAll(".outerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return I(e(t),i-.5,a-.5,r)}})),n.select("#"+t).selectAll(".percent").data(o).transition().duration(750).attrTween("x",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return.6*i*Math.cos(.5*(e(t).startAngle+e(t).endAngle))}})).attrTween("y",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return.6*i*Math.sin(.5*(e(t).startAngle+e(t).endAngle))}})).text(M.getPercent)},M.draw=function(t,e,i,a,r,s,o,l,c,u,h){var d=n.pie().sort(null).value((function(t){return t.value}))(e),p=n.select("#"+t).append("g").attr("transform","translate("+i+","+a+")").attr("class","slices");p.selectAll(".innerSlice").data(d).enter().append("path").attr("class","innerSlice").style("fill",(function(t){return n.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return B(t,r+.5,s+.5,o,l)})).each((function(t){this._current=t})),p.selectAll(".topSlice").data(d).enter().append("path").attr("class","topSlice").style("fill",(function(t){return t.data.color})).style("stroke",(function(t){return t.data.color})).attr("d",(function(t){return D(t,r,s,l)})).each((function(t){this._current=t})),p.selectAll(".outerSlice").data(d).enter().append("path").attr("class","outerSlice").style("fill",(function(t){return n.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return I(t,r-.5,s-.5,o)})).each((function(t){this._current=t}));var g=l||.25,f=p.selectAll(".percent"),m=0;if(c){var y=function(){V(f,d,g,r,s,m,(function(t){return M.getPercent(t)})),m-=20},x=function(){V(f,d,g,r,s,m,(function(t){return h(t.value)})),m-=20};u.value_percentage?(m=20,x(),y()):u.percentage_value?(m=20,y(),x()):(m=10,u.value?x():y())}V(f,d,g,r,s,m,(function(t){return t.data.label}))};var O=M,E=(i(50),i(51),function(){var t=[],e={axisLength:600},i=null,a=null,r=n.timeFormat("%d%b"),s=null,o=null;function l(){}return l.init=function(){i=n.scaleTime().domain([t[0],t[1]]).range([0,e.axisLength]).clamp(!0),a=n.axisBottom(i).tickSize(5).ticks(s,o).tickFormat(r)},l.ticks=function(){return i.ticks(s,o).map((function(t){return i(t)}))},l.position=function(t){return i(t)},l.draw=function(t){t.call(a).selectAll("text").attr("transform","translate(0,0)")},l.getAxisLine=function(){return i},l.getAxis=function(){return a},l.domain=function(e){return arguments.length?(t=e,l):t},l.ticksConfig=function(t){return s=t.ticksSize,o=t.ticksStep,l},l.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return l},l.configValue=function(t,i){return e[t]=i,l},l.tickFormat=function(t){return arguments.length?(r=t,l):r},l}),N=function(){var t,e=1,i=[],a={},n=0,r={axisLength:null,barHeight:15,progressBarPorcHeight:100,barPadding:5,barMargin:5,minTaskBandHeight:30,mileStoneHeight:0};d.init=function(){for(var t,e=0,r=0,l=0;l<i.length;l++){t=i[l];var c=s(t);r=e+c+o(t),a[t]={taskIni:e,taskEnd:e+c,mStoneIni:e+c,mStoneEnd:r},e=r}return n=r,d},d.ticks=function(){for(var t,e,a=[],n=0;n<i.length;n++)t=i[n],e=c(t),a.push(d.scaleValue(e[0]));return null!=e&&a.push(d.scaleValue(e[1])),a},d.position=function(e){if(z(e,"startDate"))var i=t.taskTotalOverlaps(e),a=u(e.category)[0]+r.barMargin+i*(r.barHeight+r.barPadding);else{if(!z(e,"date"))return null;a=h(e.category)[0]+r.mileStoneHeight-6}return d.scaleValue(a)},d.draw=function(t){return t.selectAll("line.axisY").remove(),t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",d.scaleValue(n)).attr("class","axisY").attr("style","stroke:black"),t.selectAll("g").remove(),t.selectAll("g").data(i,(function(t){return t})).enter().append("g").attr("transform",l).append("text").attr("x","-5").attr("style","text-anchor: end").attr("class","tickY-label").text((function(t){return t})),t.selectAll("line.tickY").remove(),t.selectAll("line.tickY").data(d.ticks()).enter().append("line").attr("class","tickY").attr("x1","0").attr("y1",(function(t){return t})).attr("x2","-5").attr("y2",(function(t){return t})),d};var s=function(e){var i=t.categoryMaxOverlaps(e),a=r.minTaskBandHeight;return i>0&&(a=r.barMargin+(i-1)*(r.barHeight+r.barPadding)+r.barHeight+r.barMargin),a},o=function(){return r.mileStoneHeight},l=function(t){var e=c(t),i=e[0]+(e[1]-e[0])/2;return"translate(0,"+d.scaleValue(i)+")"};d.scaleValue=function(t){var e=1;return null!=r.axisLength&&n>0&&(e=r.axisLength/n),t*e};var c=function(t){return[a[t].taskIni,a[t].mStoneEnd]},u=function(t){return[a[t].taskIni,a[t].taskEnd]},h=function(t){return[a[t].mStoneIni,a[t].mStoneEnd]};function d(){}return d.overlappingResolver=function(e){return arguments.length?(t=e,d):t},d.categories=function(t){return arguments.length?(i=t,d):i},d.scale=function(t){return arguments.length?(e=t,d):e},d.config=function(t){if(!arguments.length)return r;for(var e in r)r[e]=t[e];return d},d.configValue=function(t,e){return r[t]=e,d},d.calculatedLength=function(){return n},d},H=function(){var t=[],e=[],i={},a=[];s.categories=function(e){return arguments.length?(t=e,s):t},s.tasks=function(t){return arguments.length?(e=t,i={},a=[],s):e},s.categoryMaxOverlaps=function(t){return a[t]?a[t].length:0},s.taskOverlaps=function(t){return i[t.id]},s.taskTotalOverlapsOld=function(t){var e=[];return function t(e,a){if(!z(i,e))return;for(var n=0;n<i[e].length;n++)t(i[e][n],a),a.push(i[e][n])}(t.id,e),e.filter((function(t,i){return e.indexOf(t)==i}))},s.taskTotalOverlaps=function(t){var e=t.id;return null!=i[e]?i[e].length:0};s.calculateOverlapping=function(){for(var e=0;e<t.length;e++){var i=[];a[t[e]]=i,n(t[e],i)}return s};var n=function(t,i){var a=e.filter((function(e){return e.category==t}));if(null!=a&&a.length>0)for(var n=0;n<a.length;n++)r(a[n],i)},r=function(t,e){for(var a,n,r=e.length,s=0;s<e.length;s++){if(!(t.startDate<e[s].endDate)){r=s;break}a=t,n=e[s],z(i,a.id)||(i[a.id]=[]),i[a.id].push(n.id)}e[r]=t};function s(){return s}return s};function z(t,e){var i=t.__proto__||t.constructor.prototype;return e in t&&(!(e in i)||i[e]!==t[e])}var G=function(t){var e={axisLength:600,barHeight:15,progressBarHeight:5},i=null,a=null,n=function(t){for(var e in a)t.on(e,a[e])};function r(){}return r.draw=function(a){a.append("rect").attr("y",0).attr("height",t.scaleValue(e.barHeight)).attr("width",i).attr("class",(function(t){return z(t,"class")?t.class+"-bar":"task-bar"})).attr("style",(function(t){return t.style})).attr("rx",3).attr("ry",3).call(n),a.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return z(t,"progress")?i(t):0})).attr("style",(function(t){return t.todoStyle})).attr("class","task-progress-bar-total"),a.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return z(t,"progress")?t.progress*i(t):0})).attr("class",(function(t){return z(t,"class")?t.class+"-progress-bar":"task-progress-bar"})).attr("style",(function(t){return t.doneStyle})).call(n),a.append("text").attr("y",(function(i){var a=t.scaleValue(e.barHeight);return null==i.progress?a/2+5:a-3})).attr("x",5).attr("class",(function(t){return z(t,"class")?t.class+"-label":"task-label"})).attr("style",(function(t){return t.labelStyle})).text((function(t){if(!t.label)return"";var e=i(t)-10,a=t.label,n=t.label.length;if(this.textContent=t.label,this.getComputedTextLength())for(;n>0&&this.getSubStringLength(0,n)>e;)n--;return n===t.label.length?a:0===n?"":a.substring(0,n)+""}))},r.eventHandlers=function(t){return arguments.length?(a=t,r):a},r.calculateBarWidth=function(t){return arguments.length?(i=t,r):i},r.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return r},r.configValue=function(t,i){return e[t]=i,r},r},W=function(){var t=null,e={mileStoneRadius:2},i=function(e){for(var i in t)e.on(i,t[i])};function a(){}return a.draw=function(t){t.append("polygon").attr("points","10,1 4,19.8 19,7.8 1,7.8 16,19.8").attr("class",(function(t){return z(t,"class")?t.class+"-mark":"milestone-mark"})).attr("style",(function(t){return t.style})).call(i),t.append("text").attr("x",2).attr("y",30).attr("style",(function(t){return t.style+";font-size: 14px"})).attr("class",(function(t){return z(t,"class")?t.class+"-label":"milestone-label"})).text((function(t){return t.label}))},a.eventHandlers=function(e){return arguments.length?(t=e,a):t},a.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return a},a.configValue=function(t,i){return e[t]=i,a},a},R=function(){var t=null,e={chartHeight:100};function i(){}return i.draw=function(t){t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",e.chartHeight).attr("class",(function(t){return z(t,"class")?t.class+"-line":"dateline-line"})).attr("style",(function(t){return t.style}));var i=t.append("text").attr("y",-4).attr("class",(function(t){return z(t,"class")?t.class+"-label":"dateline-label"})).style("text-anchor","middle").text((function(t){return t.label})),a=[];i.each((function(){var t=this.getBoundingClientRect(),e=0;a.some((function(i){if(i<t.x)return!0;e++})),a[e]=t.x+t.width,this.setAttribute("y",parseFloat(this.getAttribute("y"))+16*e),e>0&&(a[e]=a[e]+5,this.setAttribute("x",0))}))},i.eventHandlers=function(e){return arguments.length?(t=e,i):t},i.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return i},i.configValue=function(t,a){return e[t]=a,i},i},j=function(t,e,i){t=t;var a=Math.floor(1e6*Math.random()+1),r={top:20,right:40,bottom:140,left:150},s=(e=null,i=null,null),o=null,l="fit",c="%d/%b",u=null,h=null,d=!0,p=[],g=[],f=[],m=[],y=H(),x=N(),v=E(),b=G(x),_=W(),w=R(),S={task:{},milestone:{},dateline:{}},k=function(){return null!=e&&e>0?e:x.calculatedLength()},T=function(){return null!=i&&i>0?i-r.right-r.left-5:document.body.clientWidth-r.right-r.left-5},C=function(t){return"t_"+t.id},P=function(t){return"ms_"+t.id},F=function(t){return"translate("+v.position(t.startDate)+","+x.position(t)+")"},A=function(t){var e=L(t);return"translate("+e.x+","+e.y+")"},L=function(t){var e=v.position(t.date)-10,i=x.position(t),a=$.grep(g,(function(e){return e.category===t.category}));if(a.length){var n=a[0];a.some((function(e){if(!(e.startDate<=t.date))return!0;n=e})),i=x.position(n)+x.scaleValue(15)/2}return{x:e,y:i-10}},M=function(t){return"translate("+v.position(t.date)+",0)"},D=function(){return t.selectAll("svg").data([a],(function(t){return t})).selectAll(".gantt-chart")},I=function(t,e){var i=S[e],a=function(i){t.on(i,(function(t){S[e].hasOwnProperty(i)&&S[e][i](t)}))};for(var n in i)a(n)},B=function(){v.domain([s,o]).tickFormat(c).ticksConfig({ticksSize:u,ticksStep:h}).configValue("axisLength",T()),v.init(),null==p&&(p=function(t){var e={};t.map((function(t){e.hasOwnProperty(e,t.category)||(e[t.category]=!0)}));var i=[];for(var a in e)i.push(a);return i}(g)),x.overlappingResolver(y).categories(p),null!=e&&x.configValue("axisLength",e),x.init()},V=function(){var t=D(),e=t.select("g.yaxis-group");x.draw(e);var i=t.select("g.xaxis-group");i.attr("transform","translate(0, "+k()+")"),v.draw(i),i.selectAll(".tick").classed("minor",(function(t){return t.getMonth()}))},O=function(){var t=D().select("g.grid-group");t.selectAll("line.gridX").remove(),t.selectAll("line.gridX").data(v.ticks(),(function(t){return t})).enter().append("line").attr("class","gridX").attr("x1",(function(t){return t})).attr("x2",(function(t){return t})).attr("y1",0).attr("y2",k()).style("stroke","#ccc");var e=T();t.selectAll("line.gridY").remove(),t.selectAll("line.gridY").data(x.ticks(),(function(t){return t})).enter().append("line").attr("class","gridY").attr("x1",0).attr("x2",e).attr("y1",(function(t){return t})).attr("y2",(function(t){return t})).style("stroke","#ccc")},z=function(){var c;!function(t){if("fit"===l){if(void 0===t||t.length<1)return s=n.timeDay.offset(new Date,-3),void(o=n.timeHour.offset(new Date,3));s=t.reduce((function(t,e){return t.startDate<e.startDate?t:e})).startDate,o=t.reduce((function(t,e){return t.endDate>e.endDate?t:e})).endDate,v.domain([s,o]).init()}}(g),(c=t.selectAll("svg").data([a],(function(t){return t})).enter().append("svg").attr("class","chart").attr("width",i).attr("height",e).append("g").attr("class","gantt-chart").attr("transform","translate("+r.left+", "+r.top+")")).append("g").attr("class","grid-group"),c.append("g").attr("class","gantt-bars"),c.append("g").attr("class","yaxis-group"),c.append("g").attr("class","xaxis-group")},j=function(t){var e=16*(t.length-1);t.forEach((function(t,i){t.forEach((function(t){var a=L(t.d);AJS.$(t.el).attr("transform","translate("+a.x+","+(a.y-e+32*i)+")")}))}))},X=function(t){return t.endDate>s&&t.startDate<o},Y=function(t){return t.date>=s&&t.date<=o},K=function(t){return t.date>=s&&t.date<=o},U=function(t){var e=Math.max(s,t.startDate),i=Math.min(o,t.endDate);return v.position(i)-v.position(e)};function J(){return J}return J.draw=function(){t.selectAll("svg").data([a],(function(t){return t})).empty()?z():t.selectAll("svg").data([a],(function(t){return t})).selectAll("g.gantt-chart").attr("transform","translate("+r.left+", "+r.top+")");var e=g.filter(X);return y.tasks(e).calculateOverlapping(),B(),d&&O(),V(),function(t){var e=t.filter(X),i=D().select(".gantt-bars");i.selectAll("g").remove();var a=i.selectAll("g.g_task").data(e,C).enter().append("g").attr("class","g_task").attr("y",0).attr("transform",F);b.calculateBarWidth(U).eventHandlers(S.task).draw(a)}(g),function(t){var e=t.filter(K).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),i=D().select(".gantt-bars");i.selectAll("g.g_dateline").remove();var a=i.selectAll("g").data(e,(function(t){return t.date})).enter().append("g").attr("class","g_dateline").attr("y",0).attr("transform",M).call(I,"dateline");w.configValue("chartHeight",k()).eventHandlers(S.dateline).draw(a)}(m),function(t){var e=t.filter(Y).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),i=D().select(".gantt-bars");i.selectAll("g.g_mileStone").remove();var a=i.selectAll("g.g_milestone").data(e,P).enter().append("g").attr("class","g_milestone").attr("y",0).attr("transform",A);_.eventHandlers(S.milestone).draw(a);var n=[],r=[];a.each((function(t){var e=this.getBoundingClientRect();e.y=Math.round(e.y),n[e.y]||(n[e.y]=[],r[e.y]=[]);var i=0,a=!0,s=!1;n[e.y].some((function(t){if(t<e.x)s=!0;else{if(a=!1,s)return!0;i++}})),a&&(j(r[e.y]),n[e.y]=[],r[e.y]=[]),n[e.y][i]=e.x+e.width,r[e.y][i]||(r[e.y][i]=[]),r[e.y][i].push({el:this,d:t})})),r.forEach((function(t){j(t)}))}(f),n.select("body").select("svg").data([a],(function(t){return t})).style("height",k()+r.top+r.bottom),J},J.init=function(){z(),B()},J.getTimeAxisRenderer=function(){return v},J.margin=function(t){return arguments.length?(r=t,J):r},J.timeDomain=function(t){return arguments.length?(s=+t[0],o=+t[1],J):[s,o]},J.timeDomainMode=function(t){return arguments.length?(l=t,J):l},J.ticks=function(t){return u=t.ticksSize,h=t.ticksStep,J},J.container=function(e){return t=e,J},J.grid=function(t){return d=t,J},J.id=function(t){return arguments.length?(a=t,J):a},J.width=function(t){return arguments.length?(i=t,J):i},J.height=function(t){return arguments.length?(e=t,J):e},J.tickFormat=function(t){return arguments.length?(c=t,J):c},J.categories=function(t){return arguments.length?(p=t,y.categories(p),J):p},J.tasks=function(t){return arguments.length?(g=t,J):g},J.mileStones=function(t){return arguments.length?(f=t,J):f},J.dateLines=function(t){return arguments.length?(m=t,J):m},J.overlappingResolver=function(t){return arguments.length?(y=t,J):y},J.categoryAxisRenderer=function(t){return arguments.length?(x=t,J):x},J.taskRenderer=function(t){return arguments.length?(b=t,J):b},J.msRenderer=function(t){return arguments.length?(_=t,J):_},J.datelineRenderer=function(t){return arguments.length?(w=t,J):w},J.taskEventHandler=function(t,e){return S.task[t]=e,J},J.milestoneEventHandler=function(t,e){return S.milestone[t]=e,J},J.datelineEventHandler=function(t,e){return S.dateline[t]=e,J},J},X={draw:function(t,e,i){var a=this,s={nodeRadius:5,factorLegend:.85,radians:2*Math.PI,opacityArea:.1,padding:{left:20,right:20,top:20,bottom:20},maxValue:0,grid:!0};if(void 0!==i)for(var o in i)void 0!==i[o]&&(s[o]=i[o]);var l={},c={},u=[];e.forEach((function(t){c[t.aggregation]=Math.max(Math.max(t.value,c[t.aggregation]?c[t.aggregation]:0),s.maxValue),l[t.label]||(l[t.label]=[]),l[t.label].push({axis:t.aggregation,value:t.value}),-1===u.indexOf(t.aggregation)&&u.push(t.aggregation)}));var h=u.length;s.chartDimension={w:s.w-s.padding.left-s.padding.right,h:s.h-s.padding.top-s.padding.bottom},s.radius=Math.min(s.chartDimension.w/2,s.chartDimension.h/2),s.center={x:s.chartDimension.w/2+s.padding.left,y:s.radius+s.padding.top},s.angle=s.radians/h;var d=t.append("svg").attr("width",s.w).attr("height",s.center.y+s.radius+s.padding.bottom).append("g");if(s.maxValue>0&&s.grid){var p=[];if(s.scaleStep)for(var g=0;g<=s.maxValue;g=TableUtils.addFloats(g,s.scaleStep))p.push(g);else{var f=n.scaleLinear();f.domain([0,s.maxValue]),p=f.ticks(3)}p.forEach((function(t){if(t>0){var e=s.radius*t/s.maxValue;d.selectAll(".levels").data(u).enter().append("svg:line").attr("x1",(function(t,i){return s.center.x-e*Math.sin(i*s.angle)})).attr("y1",(function(t,i){return s.center.y-e*Math.cos(i*s.angle)})).attr("x2",(function(t,i){return s.center.x-e*Math.sin((i+1)*s.angle)})).attr("y2",(function(t,i){return s.center.y-e*Math.cos((i+1)*s.angle)})).attr("class","line").style("stroke","#d3d3d3").style("stroke-width","1px"),d.append("text").attr("class","axis-text").text(s.formatter(t,u[0])).style("font-size","14px").attr("y",s.center.y-e+19).attr("x",s.center.x+5)}}))}var m=d.selectAll(".axis").data(u).enter().append("g").attr("class","axis");m.append("line").attr("x1",s.center.x).attr("y1",s.center.y).attr("x2",(function(t,e){return s.center.x-s.radius*Math.sin(e*s.angle)})).attr("y2",(function(t,e){return s.center.y-s.radius*Math.cos(e*s.angle)})).attr("class","line").style("stroke","grey").style("stroke-width","1px"),m.append("text").attr("class","axis-text").text((function(t){return t})).style("font-size","14px").attr("text-anchor","middle").attr("transform",(function(t,e){var i=a.calcTextAngle(s,e);return"rotate("+i/Math.PI*180+" "+a.calcAxisTextX(s,e,i)+","+a.calcAxisTextY(s,e,i)+")"})).attr("x",(function(t,e){return a.calcAxisTextX(s,e,a.calcTextAngle(s,e))})).attr("y",(function(t,e){return a.calcAxisTextY(s,e,a.calcTextAngle(s,e))})),Object.keys(l).forEach((function(t,e){var i=l[t],r=[];d.selectAll(".nodes").data(i,(function(t,e){r.push([a.calcCY(s,t,c,e),a.calcCX(s,t,c,e)])})),r.push(r[0]),d.selectAll(".area").data([r]).enter().append("polygon").attr("class","radar-chart-serie"+e).attr("key",t).style("stroke-width","2px").style("stroke",s.color(t)).attr("points",(function(t){for(var e="",i=0;i<t.length;i++)e=e+t[i][0]+","+t[i][1]+" ";return e})).style("fill",(function(){return s.color(t)})).style("fill-opacity",s.opacityArea).on("mouseover",(function(){var t="polygon."+n.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",0),d.selectAll(t).transition(200).style("fill-opacity",.5)})).on("mouseout",(function(){d.selectAll("polygon").transition(200).style("fill-opacity",s.opacityArea)}))}));var y=Object(r.a)().attr("class","d3-tip chart"+s.id).offset([-8,0]).html((function(t){return t.key+" ("+s.formatter(t.data.value,t.data.axis)+")"}));return d.call(y),Object.keys(l).forEach((function(t,e){var i=l[t];d.selectAll(".nodes").data(i).enter().append("svg:circle").attr("class","radar-chart-serie"+e).attr("key",t).attr("r",s.nodeRadius).attr("cx",(function(t,e){return a.calcCY(s,t,c,e)})).attr("cy",(function(t,e){return a.calcCX(s,t,c,e)})).attr("data-id",(function(t){return t.axis})).style("fill",s.color(t)).style("fill-opacity",.9).on("mouseover",(function(e){y.show({key:t,data:e},this);var i="polygon."+n.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",.1),d.selectAll(i).transition(200).style("fill-opacity",.7)})).on("mouseout",(function(){y.hide(),d.selectAll("polygon").transition(200).style("fill-opacity",s.opacityArea)}))})),{svg:d,cfg:s}},calcCY:function(t,e,i,a){return t.center.x-t.radius*Math.sin(a*t.angle)*Math.max(e.value,0)/i[e.axis]},calcCX:function(t,e,i,a){return t.center.y-t.radius*Math.cos(a*t.angle)*Math.max(e.value,0)/i[e.axis]},calcAxisTextX:function(t,e,i){var a=e*t.angle;return t.center.x-t.radius*Math.sin(a)-(t.nodeRadius+4+9.5*Math.min(1,a+i))*Math.sin(a)},calcAxisTextY:function(t,e,i){var a=e*t.angle;return t.center.y-t.radius*Math.cos(a)-(t.nodeRadius+4+9.5*Math.min(1,a+i))*Math.cos(a)},calcTextAngle:function(t,e){var i=-e*t.angle;return i<-Math.PI/2&&i>1.5*-Math.PI&&(i+=Math.PI),i}},Y=i(22),K=i(0),U={saveChanges:function(t,e,i,a,n,r,s,o,l,c,u,h,d,p,g,f,m){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart",dataType:"json",data:{pageId:t,id:e,column:i,aggregation:a,type:$.trim(n),height:r,width:s,hide:o,version:p,colors:l,pieKeys:c,interpolation:g,is3D:u,lineSettings:f,innerLabels:m},success:h,error:function(t){TFUtils.showError(t,d)}})},saveDateFormat:function(t,e,i){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart/dateformat",dataType:"json",data:{pageId:t,id:e,dateformat:i}})}},J=i(2),q={SOLID:"solid",DASH:"dash",DOT:"circle"},Z=function(t){this.palette=K.a.chartColors,this.colors=t.colors?t.colors.split(","):[],this.pieKeys=t.pieKeys?t.pieKeys.split(""):[],this.visiblePieKeysLength=this.pieKeys.length,this.colorKeyMap=this.setColorKeyMap({},this.pieKeys,this.colors),this.macroId=t.macroId,this.pageId=t.pageId,this.dateFormat=t.dateFormat||"yy-mm-dd",this.dateFormat=this.dateFormat.replace("yyyy","yy"),this.hasTimeFormat=this.dateFormat.toLowerCase().indexOf("hh:mm")>=0,this.localeDateFormat=K.a.getLocaleDateFormat(this.dateFormat),this.separator=t.separator,this.worklog=K.a.getWorklog(t.worklog),this.columns=t.columns?t.columns.split(""):[],this.aggregation=t.aggregation?t.aggregation.split(""):[],this.aggregationCache=this.aggregation.slice(),this.columnsCache=this.columns.slice(),this.transpose="Horizontal"===t.dataorientation,this.grid=t.grid,this.legend=t.legend&&"none"!=t.legend,this.isLegendUnderGraph="under"==t.legend,this.xValueType=null,this.valueType=K.a.getValueType(t.minvalue,this.separator,this.worklog)||K.a.getValueType(t.maxvalue,this.separator,this.worklog)||K.a.getValueType(t.scalestep,this.separator,this.worklog)||null,this.minvalue=K.a.parseValueByType(this.valueType,t.minvalue,this.separator,this.worklog),this.minvalue=!1===this.minvalue?NaN:this.minvalue,this.maxvalue=K.a.parseValueByType(this.valueType,t.maxvalue,this.separator,this.worklog),this.maxvalue=!1===this.maxvalue?NaN:this.maxvalue,this.xminvalue=t.xminvalue,this.xmaxvalue=t.xmaxvalue,this.yminvalue=t.minvalue,this.ymaxvalue=t.maxvalue,this.scaleStep=K.a.parseValueByType(this.valueType,t.scalestep,this.separator,this.worklog),this.scaleStep=!1===this.scaleStep?NaN:this.scaleStep,this.xScaleStep=t.xscalestep,this.yScaleStep=t.scalestep,this.locale=K.a.getLocale(),this.title=t.title,this.xtitle=t.xtitle,this.ytitle=t.ytitle,this.isLog=t.isLog,this.isXLog=t.isXLog,this.titleHeight=t.title?20:0,this.xtitleHeight=t.xtitle?20:0,this.ytitleHeight=t.ytitle?20:0,this.showTrendLine="string"==typeof t.showTrendLine?"true"==t.showTrendLine:1==t.showTrendLine,this.tabs=t.tabs,this.hide=1==t.hide,this.textWidth=0,this.argumentWidth=0,this.lineSettings=t.lineSettings?t.lineSettings.split(","):{},this.version=3,this.interpolation=t.interpolation?t.interpolation.split(","):["Linear"],this.defaultInterpolation=t.version>=3?"Linear":this.interpolation[0],this.barColoringType=t.barColoringType,this.outerLabels=t.outerLabels,t.version>=3?(this.showInnerLabels="None"!==t.showInnerLabels,this.innerLabelsType={percentage:"Percentage"===t.showInnerLabels,value_percentage:"Value (Percentage)"===t.showInnerLabels,percentage_value:"Percentage (Value)"===t.showInnerLabels,value:"Value"===t.showInnerLabels||!t.showInnerLabels}):(this.showInnerLabels="string"==typeof t.showInnerLabels?"false"!=t.showInnerLabels:0!=t.showInnerLabels,this.innerLabelsType={}),bt(this.colors,this.palette),this.colorsCache=this.colors.slice(),this.trimParams(this.columns),this.trimParams(this.aggregation),"editor"!==this.macroId&&(this.initElements(t),this.initFormaters(),this.content.data("rendered")||(this.content.data("rendered",!0),this.isPivot&&(this.separator=this.pivotContent.data("decimalseparator")),this.getOriginalTable(),this.getDimension(),this.getType(),this.bindUpdate(),this.setChosen(),this.bindUI(),this.setControls(),this.draw(),this.bindTips(),this.bindPageResize()))};function Q(t,e,i){return t[e]||(t[e]=[0]),t[e].push(i),t}function tt(t){return"Line"===t||"Time Line"===t}function et(t){var e=t.prop("outerHTML");return!e&&window.XMLSerializer&&t.length&&(e=(e=(e=(new XMLSerializer).serializeToString(t[0])).replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")).substring(0,4)+' xmlns="http://www.w3.org/2000/svg"'+e.substring(4,e.length)),e}function it(t){var e=0;t.forEach((function(t){e+=t.value}));var i=0,a={},n=0,r=[],s=$.grep(t,(function(t){var s,o,l=Math.round(1e3*t.value/e)/10;if(t.percent=l,l>1)return!0;i+=t.value,n++,r.push({label:t.label,value:t.value,percent:l}),s=a,o=t.rowNumber,$.each(o,(function(t,e){s[t]||(s[t]=[]),s[t]=s[t].concat(e)})),a=s}));return i&&n>1&&s.push({label:"Other",value:i,percent:Math.round(1e3*i/e)/10,other:!0,rowNumber:a}),{data:s,smallData:r,count:n}}function at(t,e,i){var a=t;return a=Math.max(e,a),a=Math.min(i,a)}function nt(t,e,i){var a=0,n=0;return e.length===i.length?e.length&&(i[0].absTotal?n=i[0].absTotal:(n=0,i.forEach((function(t){n+=t.total})),i[0].absTotal=n)):i.some((function(e){if(e.label===t.label)return n=e.total,!0})),n&&(a=100*t.value/n),a.toFixed(1)+"%"}function rt(t){var e=ot(t);return(299*e.r+587*e.g+114*e.b)/1e3>=128?"black":"white"}function st(t,e){var i=ot(t);return i.r=Math.min(parseInt(i.r/e),255),i.g=Math.min(parseInt(i.g/e),255),i.b=Math.min(parseInt(i.b/e),255),"#"+i.r.toString(16)+i.g.toString(16)+i.b.toString(16)}function ot(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}}function lt(t,e){for(var i=[],a=Math.ceil(t[0]/e)*e;a<=t[1];a=K.a.addFloats(a,e))i.push(a);return i}function ct(t,e,i,a,n,r){var s=parseFloat(t);if(0==s)return"";var o=8*r(s).length+4,l=n?pt(e):gt(e);if(o>=l&&(a||o>=i-l)){if(s>0&&s<1e-4||s>99999.999)return s.toExponential(1);var c=5-Math.floor(s).toString().length;return r(parseFloat(s.toFixed(c>0?c:0)))}return r(s)}function ut(t,e,i,a){for(var n,r=0,s=[],o=St(t,i,a),l=n=o.width<=e?e/2-o.width/2:20,c=0;c<t.length;c++)0!==c&&n+o.values[c-1].width+o.values[c].width<e?n+=o.values[c-1].width:(s.push(c),r+=1,n=o.width<=e?e/2-o.width/2:20);return{rows:r,maxWidth:o.keysWidth,firstInRow:s,posX:l}}function ht(t){var e=t.offset().left,i=pt(t);return{left:e,right:e+i,width:i}}function dt(t){var e=t.offset().top,i=gt(t);return{top:e,bottom:e+i,height:i}}function pt(t){return t[0].getBoundingClientRect().width}function gt(t){return t[0].getBoundingClientRect().height}function ft(t,e){var i=ht(t);0!==i.width&&e.each((function(){for(var t=$(this),e=ht(t),a=13,n=parseFloat(t.attr("x"))||0;(e.left<i.left||e.right>i.right)&&a>0;){t.css("font-size",a--);var r=e.width;(e=ht(t)).left<i.left&&e.right<=i.right?(n=n+r-pt(t),t.attr("x",n)):e.right>i.right&&e.left>=i.left&&(n=n-r+pt(t),t.attr("x",n))}}))}function mt(t,e){var i=0,a=$("<span/>");return $("body").append(a),t.ticks().forEach((function(n){a[0].textContent=(e.tickFormat()||t.tickFormat())(n),i=Math.max(a.width(),i)})),a.remove(),i}function yt(t){return"M"+(t=t.map((function(t){return t.join(",")}))).join("L")+"Z"}function xt(){return $("body").css("font-family")}function vt(t,e,i,a){var n;e.selectAll(i).on("mouseover",(function(e){clearTimeout(n);var a=$(this);a.is(i)||(a=a.parent()),t.show(e,a[0])})).on("mouseout",(function(){n=setTimeout((function(){n=null,a.tipHover||t.hide()}),50)}))}function bt(t,e){e.forEach((function(e){-1===$.inArray(e,t)&&t.push(e)}))}function _t(t,e,i){var a=e.map((function(e,i){return t[e]})),n=a.filter((function(t){return t})),r=n.length;bt(n,i);var s=0;return bt(a=a.slice(0,e.length).map((function(i,a){return i||(i=n[(r+s++)%n.length],t[e[a]]=i),i})),i),a}function wt(t,e){return t.isGantt?t.ganttCatColors:t.multiple?t.chartKeys:t.pieKeys.slice(0,e)}function St(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,a=$("<span></span>");$("body").append(a);var n={values:kt(t,e),width:0,keysWidth:0};return n.values.forEach((function(t){t.view.length>35&&(t.view=t.view.substr(0,33)+""),t.width=parseInt(a.text(t.view).width())+i,n.width+=t.width,n.keysWidth=Math.max(n.keysWidth,t.width-i)})),a.remove(),n}function kt(t,e){var i=[],a=e?function(t){var e=t.concat().sort(),i=e[0],a=e[e.length-1],n=i.length,r=0;for(;r<n&&i.charAt(r)===a.charAt(r);)r++;return r}(t):0;return t.forEach((function(t){var e=a>3?t.substring(a):t;!e&&t&&(e="Total"),i.push({key:t,view:e})})),i}Z.prototype.initElements=function(t){var e=this;e.content=$('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+t.sessionId+'"]'),e.chartBody=e.content.find(".chart-body"),e.chartBody=K.a.addExcerpt(e.chartBody,"chart-body"),e.chartBody=K.a.addIframe(e.chartBody,"chart-body",(function(t){e.chartBody=t,e.getOriginalTable(),e.setControls(),e.draw()})),e.wrapper=e.content.find(".chart-wrapper"),e.svgWrapper=e.wrapper.find(".svg-wrapper"),e.chart=n.selectAll('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+t.sessionId+'"] .svg-wrapper'),e.canvas=e.content.find("canvas"),e.png=e.content.find("#pngdataurl"),e.columnSelect=e.content.find(".chart-column"),e.aggregationSelect=e.content.find(".chart-aggregation"),e.typeSelect=e.content.find(".chart-type"),e.is3DInput=e.content.find(".is3d"),e.is3D=e.is3DInput.is(":checked"),e.heightInput=e.content.find(".chart-height"),e.widthInput=e.content.find(".chart-width"),e.is3DWrapper=e.content.find(".is3d-wrapper"),e.noTableMessage=e.wrapper.find(".no-table-message"),e.badSettings=e.wrapper.find(".bad-settings-message"),e.wrongDateFormat=e.wrapper.find(".wrong-date-message"),e.noDataMessage=e.wrapper.find(".no-data-message"),e.logZeroMessage=e.wrapper.find(".log-zero-message"),e.loader=e.wrapper.find("#chart-loading"),e.controls=e.wrapper.find(".chart-controls"),e.settings=e.controls.find(".chart-settings"),e.menu=e.content.find("#chart-menu-view-"+e.macroId+"-"+e.pageId),e.showRawDataItem=e.menu.find(".chart-showrawdata"),e.hideRawDataItem=e.menu.find(".chart-hiderawdata"),e.selectColors=e.menu.find(".chart-change-color"),e.btn=e.menu.find(".chart-save").not("body.content-preview .chart-save"),e.download=e.menu.find(".save-as-png"),e.dateFormatInput=e.wrongDateFormat.find(".chart-date-format"),e.setInterpolationBtn=e.menu.find(".chart-set-interpolation"),e.changeLineSettingsBtn=e.menu.find(".chart-set-line-settings"),e.checkPivotContent()},Z.prototype.checkPivotContent=function(){this.pivotContent=this.chartBody.find(".pivot-content"),this.isPivot=this.pivotContent.length>0},Z.prototype.initFormaters=function(){var t=this;t.formatNum=L()({mark:t.separator,thousand:" "}),t.formatNumShort=L()({mark:t.separator,thousand:""}),t.formatNumTo=function(e,i){var a=K.a.formatValueByType(e,i&&t.valueType instanceof Object?t.valueType[i]:t.valueType,(function(e){return e>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog),n=i&&t.valueFormatter instanceof Object?t.valueFormatter[i]:t.valueFormatter;return n?n(a):a},t.formatNumToX=function(e){var i=K.a.formatValueByType(e,t.xValueType,(function(e){return e>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog);return t.xValueFormatter?t.xValueFormatter(i):i}},Z.prototype.trimParams=function(t){for(var e=0;e<t.length;e++)t[e]=t[e].replace("",""),t.indexOf(t[e])!==e&&t.splice(e--,1)},Z.prototype.getSaveParams=function(t){for(var e=[],i=0;i<t.length;i++)""==t[i]?e.push(""):e.push(t[i]);return e.length?e.join(""):void 0},Z.prototype.getDimension=function(){if(this.height=this.heightInput.val(),this.width=this.widthInput.val(),this.adaptiveDimensions=!1,K.a.isNumber(this.width))this.width=parseInt(this.width);else{for(var t=this.content;!t.is(":visible")&&t.length;)t=t.parent();this.width=t.width()-20;var e=$("body.content-preview").length>0;e||"none"===this.controls.css("display")||(this.width-=190),e&&(this.width=this.width>300?this.width:$(window.parent).width()-250),this.adaptiveDimensions=!0}K.a.isNumber(this.height)?this.height=parseInt(this.height):(this.height=Math.min(.7*window.innerHeight,600),this.height=this.height<300?300:this.height,this.adaptiveDimensions=!0)},Z.prototype.bindPageResize=function(){var t=this;if(t.widthInput.val().trim())t.resizeSensor&&t.resizeSensor.detach();else{var e=$(".wiki-content, .ac-content"),i=e.width();t.resizeSensor=new F.ResizeSensor(e[0],(function(){var a=e.width();Math.abs(a-i)>17&&(i=a,t.getDimension(),t.draw(!0))}))}},Z.prototype.getType=function(){this.type=this.typeSelect.val(),this.isTime=-1!=this.type.indexOf("Time"),this.isSeries="Line"==this.type||"Area"==this.type||"Stacked Area"==this.type,this.isArea=-1!=this.type.indexOf("Area"),this.isBar=this.type.indexOf("Bar")>=0||this.type.indexOf("Column")>=0,this.isGantt=this.type.indexOf("Gantt")>=0,this.isBubblePie="Bubble Pie"===this.type,this.isRadar="Radar"===this.type,this.multiple=this.isBar||this.isSeries||this.isTime||this.isGantt,this.isTime?(this.content.find("label.simple-text, label.series-text, label.bubble-text").hide(),this.content.find("label.time-text").show()):this.isSeries?(this.content.find("label.simple-text, label.time-text, label.bubble-text").hide(),this.content.find("label.series-text").show()):this.isBubblePie?(this.content.find("label.simple-text, label.time-text, label.series-text").hide(),this.content.find("label.bubble-text").show()):(this.content.find("label.time-text, label.series-text, label.bubble-text").hide(),this.content.find("label.simple-text").show()),this.isTime||this.isSeries||this.isGantt||this.isBubblePie||this.isRadar?(this.is3DWrapper.hide(),this.typeSelect.removeClass("short")):(this.is3DWrapper.show(),this.typeSelect.addClass("short"))},Z.prototype.getOriginalTable=function(){var t=this,e=t.tabs&&K.a.hasTabs(t.chartBody);t.originalTable=K.a.getTableNodes(t.chartBody).filter((function(){var t=$(this);return!(e&&K.a.hasInactiveTab(t))})),t.isPivot||(K.a.normalizeTable(t.originalTable),K.a.processMergedCells(t.originalTable)),t.originalTable.unbind("sortEnd.tfchart").bind("sortEnd.tfchart",(function(){t.sorting=!1,t.setMutationObserver(),t.getTable(),t.draw(!0)})).unbind("sortStart.tfchart").bind("sortStart.tfchart",(function(){t.sorting=!0,t.setMutationObserver()})),t.resetDateFormats(),K.a.setPaginationMsg(t.chartBody),t.getTable()},Z.prototype.resetDateFormats=function(){var t=this;t.dateFormats=[],t.locales=[],t.originalTable.each((function(){t.dateFormats.push([]),t.locales.push([])}))},Z.prototype.updateSettingsForPivot=function(){this.isPivot&&(this.columnSelect.parent().hide(),this.aggregationSelect.parent().hide(),this.columnHidden=!0,this.aggregationHidden=!0,(K.a.getRawColumns(this.tables).length>2||this.isGantt)&&(this.aggregationSelect.parent().show(),this.aggregationHidden=!1,this.columnSelect.parent().show(),this.columnHidden=!1))},Z.prototype.bindUpdate=function(){var t=this,e=function(e){e&&(t.getOriginalTable(),t.setControls()),t.draw()},i=[];t.chartBody.find(".pivot-content, .tablefilter-table-wrapper, .table-joiner").each((function(){i.push($(this).attr("id"))}));var a=t.chartBody.filter(".table-excerpt").length;i.length||a?t.chartBody.bind("tf-filtered pt-calculated tj-executed",(function(n,r){if(-1!==i.indexOf(r.id)||a)return e("tf-filtered"!==n.type||t.isPivot),a})):t.chartBody.bind("tf-filtered-charts",(function(){e(!1)}));var n=null;t.chartBody.bind("tf-jira-updated DOMCharacterDataModified changed.chk",(function(){clearTimeout(n),n=setTimeout((function(){e(!0)}),100)}));var r=function(i,a){if(!i.parents(".pivot-table").length)return!K.a.isIgnoreUpdateNode(i)&&(a.className===t.chartBody[0].className||K.a.hasRowForUpdate(i)||K.a.hasTableForUpdate(i)||K.a.hasCharsForUpdate(i,a))?(clearTimeout(n),n=setTimeout((function(){n=null,e(!0)}),100),!0):void 0};window.MutationObserver?(t.observer=new MutationObserver((function(t){t.some((function(t){if(t.addedNodes.length)return r($(t.addedNodes),t.target)}))})),t.setMutationObserver()):t.chartBody.bind("DOMNodeInserted",(function(t){r($(t.target),t.originalEvent.relatedNode)})),t.tabs&&K.a.onTabChange(t.chartBody,(function(){e(!0)})),t.chartBody.bind("tf-save",(function(){return t.content.trigger("tf-save"),!1})).bind("tf-export-ready",(function(e,i){return t.macroId===i.macroId}))},Z.prototype.setMutationObserver=function(){var t=this;if(t.observer)if(t.sorting)t.observer.disconnect();else{var e={childList:!0,subtree:!0};t.chartBody.each((function(){t.observer.observe(this,e)}))}},Z.prototype.setChosen=function(){this.setChosenSelect(this.columnSelect,this.columns,this.columnsCache,!0),this.setChosenSelect(this.aggregationSelect,this.aggregation,this.aggregationCache,!1)},Z.prototype.setChosenSelect=function(t,e,i,a){var n=this;t.chosenTF({max_selected_options:a&&n.isBubblePie?2:void 0,no_results_text:"No matches for",placeholder_text_multiple:"Click and start typing...",display_selected_options:!1,width:"178px"}).change((function(r,s){null!=s.selected?(t.find("option").filter((function(){return this.textContent==s.selected})).prop("selected","selected"),e.push(s.selected)):null!=s.deselected&&(t.find("option").filter((function(){return this.textContent==s.deselected})).prop("selected",!1),e.splice($.inArray(s.deselected,e),1)),a&&!n.isGantt&&(n.pieKeys=[],n.visiblePieKeysLength=0),i.length=0,$.merge(i,e),n.aggregationChange=!1,n.columnsChange=!1,n.enableSaveBtn(),n.draw()}));var r=t.parent().find(".chosen-choices");r.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var t=e.slice();if(e.length=0,r.find(".search-choice").each((function(){e.push(this.textContent)})),i.length=0,$.merge(i,e),!n.isGantt&&n.multiple){var a=n.colors.slice();t.forEach((function(t,i){var r=$.inArray(t,e);r>=0&&a.length>r&&(n.colors[r]=a[i])})),n.colorsCache=n.colors.slice()}n.btn.prop("disabled",!1),n.enableSaveBtn(),n.draw()}})},Z.prototype.bindUI=function(){var t=this;t.typeSelect.change((function(){t.getType(),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn(),t.enableSaveBtn(),t.draw()}));var e=null;t.heightInput.add(t.widthInput).bind("input",(function(){clearTimeout(e),e=setTimeout((function(){t.getDimension(),t.enableSaveBtn(),t.draw(),t.bindPageResize()}),330)})),t.is3DInput.change((function(){t.is3D=t.is3DInput.is(":checked"),t.enableSaveBtn(),t.draw()})),t.btn.click((function(e){t.btn.toggleClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").hide();var i,a,n=t.getChartColorLabels();t.type&&(t.type.indexOf("Line")>=0||t.type.indexOf("Area")>=0)&&(i=t.calcInterpolation(),t.type.indexOf("Line")>=0&&(a=t.calcLineSettings())),U.saveChanges(t.pageId,t.macroId,t.getSaveParams(t.columns),t.getSaveParams(t.aggregation),t.type,t.heightInput.val(),t.widthInput.val(),t.hide,t.colors.slice(0,n.length).join(","),t.pieKeys.slice(0,t.visiblePieKeysLength).join(""),t.is3D,void 0,t.content,t.version,i,a,t.getInnerLabelsParam()),t.content.trigger("tf-save",t.getExportEventData()),e.preventDefault()})),t.showRawDataItem.click((function(e){t.hide=!1,t.hideRawDataItem.parent().show(),t.showRawDataItem.parent().hide(),t.chartBody.removeClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()})),t.hideRawDataItem.click((function(e){t.hide=!0,t.showRawDataItem.parent().show(),t.hideRawDataItem.parent().hide(),t.chartBody.addClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()}));var i=t.menu.find(".export-file-pdf"),a=t.menu.find(".export-file-doc");void 0===P.saveAs?(i.hide(),a.hide()):(i.click((function(e){J.a.loadScriptsBeforeExport((function(){K.a.exportToPdf(t.chartBody.not(".table-excerpt"),!0)})),e.preventDefault()})),a.click((function(e){K.a.exportToDoc(t.chartBody.not(".table-excerpt"),!0),e.preventDefault()})));var n=Y.a.initChartColorsDialog(t),r=Y.a.initInterpolationDialog(t),s=Y.a.initLineSettingsDialog(t),o=!1;t.menu.find(".chart-change-color").click((function(e){o=!0,n.show(),t.controls.addClass("active"),e.preventDefault()})),t.setInterpolationBtn.click((function(e){o=!0,r.show(),t.controls.addClass("active"),e.preventDefault()})),t.changeLineSettingsBtn.click((function(e){o=!0,s.show(),t.controls.addClass("active"),e.preventDefault()})),t.controls.find(".aui-dropdown2").bind("aui-dropdown2-show",(function(){t.controls.addClass("active")})).bind("aui-dropdown2-hide",(function(){o?o=!1:t.controls.removeClass("active")}));var l=null;t.dateFormatInput.bind("change selected keyup",(function(e){var i=function(){t.dateFormat=t.dateFormatInput.val().trim(),t.resetDateFormats(),t.draw()&&U.saveDateFormat(t.pageId,t.macroId,t.dateFormat)};"keyup"===e.type?13===e.which&&i():(clearTimeout(l),l=setTimeout((function(){i()}),300))})),window.MSInputMethodContext&&document.documentMode&&t.download.click((function(){window.navigator.msSaveBlob(t.canvas[0].msToBlob(),"Chart.jpg")})),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn()},Z.prototype.calcInterpolation=function(){var t=this,e=[];return t.interpolation instanceof Array?t.chartKeys.forEach((function(i,a){e.push(a<t.interpolation.length?t.interpolation[a]:t.defaultInterpolation)})):t.chartKeys.forEach((function(i,a){e.push(t.interpolation[i]?t.interpolation[i]:t.defaultInterpolation)})),e.join(",")},Z.prototype.calcLineSettings=function(){var t=this,e=[];return t.lineSettings instanceof Array?t.chartKeys.forEach((function(i,a){e.push(a<t.lineSettings.length?t.lineSettings[a]:"solid-1.5")})):t.chartKeys.forEach((function(i,a){e.push(t.lineSettings[i]?t.lineSettings[i].type+"-"+t.lineSettings[i].width:"solid-1.5")})),e.join(",")},Z.prototype.getChartColorLabels=function(){return wt(this,this.visiblePieKeysLength)},Z.prototype.getAllChartColorLabels=function(){return wt(this,this.pieKeys.length)},Z.prototype.getTable=function(){var t=K.a.getTablesAndRowsFromTables(this.originalTable,K.a.mixedType,null,this.transpose);this.rows=t.rows,this.tables=t.tables},Z.prototype.setControls=function(){var t=this;t.updateSettingsForPivot();var e=K.a.getRawColumns(t.tables),i=e.slice().sort();if(t.columnSelect.empty(),t.aggregationSelect.empty(),i.length){t.tableColumnsCache&&($(t.tableColumnsCache).not(i).length>0||$(i).not(t.tableColumnsCache).length>0)&&(t.aggregationChange&&(t.aggregation.length=0,$.merge(t.aggregation,t.aggregationCache),t.multiple&&!t.isGantt&&(t.colors=t.colorsCache.slice())),t.columnsChange&&(t.columns.length=0,$.merge(t.columns,t.columnsCache))),t.tableColumnsCache=i.slice();var a=document.createDocumentFragment(),n=document.createDocumentFragment();$.each(i,(function(i,r){var s=$.inArray(r,t.columns)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.columns)>=0||$.inArray(r.replace(" "+"Total",""),t.columns)>=0)||!t.isPivot&&0==t.columns.length&&0==$.inArray(r,e)?'selected="selected"':"";a.appendChild($("<option "+s+"></option>").text(r)[0]),s=$.inArray(r,t.aggregation)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.aggregation)>=0||$.inArray(r.replace(" "+"Total",""),t.aggregation)>=0)||!t.isPivot&&0==t.aggregation.length&&1==$.inArray(r,e)?'selected="selected"':"",n.appendChild($("<option "+s+"></option>").text(r)[0])})),t.columnSelect.append(a),t.aggregationSelect.append(n),$.each(t.columns.slice(),(function(e,a){-1!=$.inArray(a,i)||t.isPivot&&(-1!=$.inArray(a+" "+"Total",i)||-1!=$.inArray(a.replace(" "+"Total",""),i))||(t.columns.splice($.inArray(a,t.columns),1),t.columnsChange=!0)})),$.each(t.aggregation.slice(),(function(e,a){if(-1==$.inArray(a,i)&&(!t.isPivot||-1==$.inArray(a+" "+"Total",i)&&-1==$.inArray(a.replace(" "+"Total",""),i))){var n=$.inArray(a,t.aggregation);t.aggregation.splice(n,1),t.aggregationChange=!0,t.multiple&&!t.isGantt&&t.colors.splice(t.aggregationCache.length-1,0,t.colors.splice(n,1)[0])}})),t.isPivot?(0==t.columns.length&&void 0!==e[0]&&(t.columns.push(e[0]),t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&void 0!==e[e.length-1]&&(t.aggregation.push(e[e.length-1]),t.aggregationSelect.find("option").filter((function(){return this.textContent===e[e.length-1]})).prop("selected",!0))):(0==t.columns.length&&(t.columns.push(e[0]),t.transpose&&e[0]&&t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&(t.aggregation.push(e[1]),t.transpose&&e[1]&&t.aggregationSelect.find("option").filter((function(){return this.textContent===e[1]})).prop("selected",!0)))}t.columnSelect.trigger("chosen:updated"),t.aggregationSelect.trigger("chosen:updated"),K.a.sortSelectedOptions(t.columnSelect,t.columns),K.a.sortSelectedOptions(t.aggregationSelect,t.aggregation)},Z.prototype.getDateFormat=function(t,e){return K.a.setDateFormatForColumn(this.dateFormats[t],this.locales[t],this.dateFormat,this.locale,this.localeDateFormat,e,this.rows[t],this.hasTimeFormat),this.workingDateFormat=this.dateFormats[t][e],this.dateFormats[t][e]},Z.prototype.calculateBubblePieData=function(t){var e=this,i=[];if(2!==e.columns.length||0===e.aggregation.length)return i;e.bubblePieSetting={},e.bubblePieSetting.axisX={title:e.columns[0],order:[]},e.bubblePieSetting.axisY={title:e.columns[1],order:[]},e.bubblePieSetting.indicator={valueType:null},e.bubblePieSetting.sameValuesCount={},e.bubblePieSetting.filterAggregation=[];var a=[],n=[];e.tables.forEach((function(r,s){r.forEach((function(r,o){if(0===o)a=r.slice(0);else if(t[s][o]){for(var l,c,u,h,d={},p=[],g=0,f=r.length;g<f;g++){var m=e.getDateFormat(s,g),y=e.locales[s][g];if(a[g]===e.bubblePieSetting.axisX.title&&r[g])null===e.xValueType&&(e.xValueType=K.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,y)),null!==e.xValueType?(l=K.a.parseAnyValueByType(e.xValueType,r[g],e.separator,e.worklog,!0,m,y),K.a.isNumber(l)&&e.xValueType===K.a.number&&!e.xValueFormatter&&(e.xValueFormatter=K.a.getNumberFormatter(r[g])),(void 0===e.bubblePieSetting.axisX.maxValue||e.bubblePieSetting.axisX.maxValue<l)&&(e.bubblePieSetting.axisX.maxValue=l),(void 0===e.bubblePieSetting.axisX.minValue||e.bubblePieSetting.axisX.minValue>l)&&(e.bubblePieSetting.axisX.minValue=l)):l=r[g],e.bubblePieSetting.axisX.order.includes(l)||e.bubblePieSetting.axisX.order.push(l);else if(a[g]===e.bubblePieSetting.axisY.title&&r[g])null===e.valueType&&(e.valueType=K.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,y)),n.push(r[g]),null!==e.valueType?(c=K.a.parseAnyValueByType(e.valueType,r[g],e.separator,e.worklog,!0,m,y),K.a.isNumber(c)&&e.valueType===K.a.number&&!e.valueFormatter&&(e.valueFormatter=K.a.getNumberFormatter(r[g])),(void 0===e.bubblePieSetting.axisY.maxValue||e.bubblePieSetting.axisY.maxValue<c)&&(e.bubblePieSetting.axisY.maxValue=c),(void 0===e.bubblePieSetting.axisY.minValue||e.bubblePieSetting.axisY.minValue>c)&&(e.bubblePieSetting.axisY.minValue=c)):c=r[g],e.bubblePieSetting.axisY.order.includes(c)||e.bubblePieSetting.axisY.order.push(c);else{if(!e.aggregation.includes(a[g])||!r[g])continue;null===e.bubblePieSetting.indicator.valueType&&(e.bubblePieSetting.indicator.valueType=K.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,y)),[K.a.number,K.a.worklog,K.a.duration].includes(e.bubblePieSetting.indicator.valueType)&&(h=K.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,y))===e.bubblePieSetting.indicator.valueType&&(u=K.a.parseAnyValueByType(h,r[g],e.separator,e.worklog,!0,m,y),e.bubblePieSetting.filterAggregation.includes(a[g])||e.bubblePieSetting.filterAggregation.push(a[g]),p.push({indicator:a[g],value:u>0?u:null}))}}p.length>0&&l&&c&&p.forEach((function(t){d[e.bubblePieSetting.axisX.title]=l,d[e.bubblePieSetting.axisY.title]=c,d.indicator=t.indicator,d.value=t.value,d.tableI=s,d.rowI=o,i.push(JSON.parse(JSON.stringify(d))),e.valueType!==K.a.number&&e.xValueType!==K.a.number&&e.valueType!==K.a.duration&&e.xValueType!==K.a.duration||(l=JSON.parse(JSON.stringify(l)),c=JSON.parse(JSON.stringify(c)),e.bubblePieSetting.sameValuesCount[l+"_"+c]>0?e.bubblePieSetting.sameValuesCount[l+"_"+c]+=1:e.bubblePieSetting.sameValuesCount[l+"_"+c]=1)}))}}))})),e.bubblePieSetting.filterAggregation.sort((function(t,i){return e.aggregation.indexOf(t)-e.aggregation.indexOf(i)})),e.pieKeys=e.bubblePieSetting.filterAggregation.slice(0),e.visiblePieKeysLength=e.pieKeys.length,e.colors=_t(e.colorKeyMap,e.pieKeys,e.palette),e.colorsCache=e.colors.slice(),e.calcBubbleChartExtremum(),e.filterBubbleChartData(i);var r=$("<span/>");return $("body").append(r),e.bubblePieSetting.axisY.longestTitle=r.text(K.a.getLongestWordInArr(n)).width()+9,r.remove(),i},Z.prototype.filterBubbleChartData=function(t){for(var e=this.bubblePieSetting.axisX.title,i=this.bubblePieSetting.axisY.title,a=this.bubblePieSetting.axisX.minValue,n=this.bubblePieSetting.axisX.maxValue,r=this.bubblePieSetting.axisY.minValue,s=this.bubblePieSetting.axisY.maxValue,o=t.length-1;o>=0;){var l=t[o][i],c=t[o][e],u=this.valueType===K.a.date?K.a.toDateObject(l):l,h=this.xValueType===K.a.date?K.a.toDateObject(c):c;n&&h>n||a&&h<a?t.splice(o,1):s&&u>s||r&&u<r?t.splice(o,1):(this.valueType!==K.a.number&&this.valueType!==K.a.duration||(t[o]["orig_"+i]=l,t[o][i]=parseFloat(l/this.bubblePieSetting.sameValuesCount[c+"_"+l])),this.xValueType!==K.a.number&&this.xValueType!==K.a.duration||(t[o]["orig_"+e]=c,t[o][e]=parseFloat(c/this.bubblePieSetting.sameValuesCount[c+"_"+l]))),o-=1}},Z.prototype.calculate=function(){var t=this,e=[],i={};t.ganttCategories=[],t.ganttCatColors=[],t.textWidth=0,t.argumentWidth=0,t.aggregationWidth=0,t.valueType=t.isRadar?{}:null,t.xValueType=null,t.valueFormatter=t.isRadar?{}:null,t.xValueFormatter=null,t.chartKeys=[];var a=$("<span></span>");a.appendTo("body"),t.columnWidth=0;var n=K.a.getRelevantRows(t.rows,t.transpose);if(t.isBubblePie)return t.calculateBubblePieData(n);var r=t.columnHidden,s=t.aggregationHidden;(t.isSeries||t.isTime)&&(r=t.aggregationHidden,s=t.columnHidden);var o=t.isSeries||t.isTime?t.aggregation:t.columns,l=t.isSeries||t.isTime?t.columns:t.aggregation;if($.each(o,(function(e,n){a.text(n),i[n]=[],t.columnWidth=Math.max(t.columnWidth,a.width())})),$.each(l,(function(e,n){a.text(n),i[n]=[],t.aggregationWidth=Math.max(t.aggregationWidth,a.width())})),t.tables.forEach((function(c,u){var h=[],d=[];$.each(o,(function(e,i){var a=r?t.isSeries||t.isTime?1:0:K.a.getCellPosition(c,i);h.push(a)})),$.each(l,(function(e,i){var a=s?t.isSeries||t.isTime?0:1:K.a.getCellPosition(c,i);d.push(a)})),h.length&&d.length&&c.forEach((function(r,s){s>0&&n[u][s]&&h.some((function(n,c){if(null!==n){var p=o[c],g=r[n];if(t.isGantt){var f={id:e.length,category:g,label:h.length>1?p:"",hint:g,rowNumber:Q({},u,s)},m=0,y=!1,x=t.textWidth;-1===$.inArray(g,t.ganttCategories)&&(t.ganttCategories.push(g),y=!0,t.ganttCatColors.push(g),d.length>2&&(t.ganttCatColors.push(g+" - Done"),t.ganttCatColors.push(g+" - Todo")))}if(d.forEach((function(n,o){if(null!=n){var c=l[o],y=r[n];if(t.isGantt){if(2==m)y=K.a.parseNumber(y,t.separator),K.a.isNumber(y)&&(y=y>1?y/100:y,f.progress=y);else try{if(!y)return!0;f.text=y,y=K.a.parseDate(y,t.getDateFormat(u,n),t.locales[u][n]),0==m?f.startDate=y:f.endDate=y}catch(t){return AJS.log("Error while parsing date '"+y+"': "+t),!0}m++}else{var x;t.isTime||t.isSeries?(x=p,d.length>1&&(x=h.length>1?x+" - "+c:c)):(x=c,!t.isRadar&&h.length>1&&(x=d.length>1?x+" - "+p:p)),i[x]||(i[x]=[]);var v=t.isRadar?g:x;if(-1===t.chartKeys.indexOf(v)&&t.chartKeys.push(v),t.isTime)try{if(!y)return!0;g&&null==t.valueType&&(t.valueType=K.a.getValueType(g,t.separator,t.worklog));var b=g;if(g=K.a.parseValueByType(t.valueType,g,t.separator,t.worklog),y=K.a.parseDate(y,t.getDateFormat(u,n),t.locales[u][n]),!K.a.isNumber(g))return!0;t.valueType!==K.a.number||t.valueFormatter||(t.valueFormatter=K.a.getNumberFormatter(b))}catch(t){return AJS.log("Error while parsing date '"+y+"': "+t),!0}else if(t.isSeries){g&&null==t.valueType&&(t.valueType=K.a.getValueType(g,t.separator,t.worklog)),y&&null==t.xValueType&&(t.xValueType=K.a.getValueType(y,t.separator,t.worklog));b=g;var _=y;if(g=K.a.parseValueByType(t.valueType,g,t.separator,t.worklog),y=K.a.parseValueByType(t.xValueType,y,t.separator,t.worklog),K.a.isNumber(g)&&t.valueType===K.a.number&&!t.valueFormatter&&(t.valueFormatter=K.a.getNumberFormatter(b)),K.a.isNumber(y)&&t.xValueType===K.a.number&&!t.xValueFormatter&&(t.xValueFormatter=K.a.getNumberFormatter(_)),!K.a.isNumber(g)||!K.a.isNumber(y))return!0}else if(t.isRadar){y&&null==t.valueType[x]&&(t.valueType[x]=K.a.getValueType(y,t.separator,t.worklog));_=y;y=K.a.parseValueByType(t.valueType[x],y,t.separator,t.worklog),K.a.isNumber(y)?t.valueType[x]!==K.a.number||t.valueFormatter[x]||(t.valueFormatter[x]=K.a.getNumberFormatter(_)):y=0}else{y&&null==t.valueType&&(t.valueType=K.a.getValueType(y,t.separator,t.worklog));_=y;if(y=K.a.parseValueByType(t.valueType,y,t.separator,t.worklog),!K.a.isNumber(y))return!0;t.valueType!==K.a.number||t.valueFormatter||(t.valueFormatter=K.a.getNumberFormatter(_))}t.isTime||t.isSeries?-1===i[x].indexOf(y.valueOf())?(e.push({label:g,value:y,key:x,aggregation:c,rowNumber:Q({},u,s)}),i[x].push(y.valueOf())):e.forEach((function(t){t.key===x&&t.value.valueOf()===y.valueOf()&&(t.label+=g,Q(t.rowNumber,u,s))})):-1===i[x].indexOf(g)?(e.push({label:g,value:y,key:p,aggregation:x,rowNumber:Q({},u,s)}),i[x].push(g)):e.forEach((function(t){t.aggregation===x&&t.label===g&&(t.value+=y,Q(t.rowNumber,u,s))}))}t.isTime||t.isSeries||(a.text(g),t.textWidth=Math.max(t.textWidth,a.width()))}})),t.isGantt){if(f.startDate){var v;for(e.push(f),f.endDate||(f.label=""),v=c+1;v<h.length;v++)if(null!==h[v]&&r[h[v]]){if(f.label)f.label+=": ";else if(!y){var b=f.category+": "+r[h[v]];t.ganttCatColors.push(b)}f.label+=r[h[v]],f.hint=(f.hint?f.hint+" - ":"")+r[h[v]],c=v;break}for(v=c+1;v<h.length;v++)null!==h[v]&&r[h[v]]&&(f.hint=(f.hint?f.hint+" - ":"")+r[h[v]]);if(!f.endDate&&!f.label&&!y){var _=f.category+": milestone";-1===t.ganttCatColors.indexOf(_)&&t.ganttCatColors.push(_)}}return!y||f.endDate&&f.startDate||(t.ganttCategories.splice(-1,1),t.textWidth=x),!y||f.endDate||f.startDate||t.ganttCatColors.splice(-1,1),!(y&&d.length>2)||void 0!==f.progress&&f.startDate&&f.endDate||(t.ganttCatColors.splice(-1,1),t.ganttCatColors.splice(-1,1)),!0}}}))}))})),a.remove(),(t.isSeries||t.isTime)&&e.sort((function(t,e){return t.value>e.value?1:-1})),t.isGantt&&"mono"===t.barColoringType)t.ganttCatColors=["Task","Task - Done","Task - Todo","Milestone","Event"];else if(!t.multiple||t.isGantt){var c=[];t.isGantt?c=t.ganttCatColors:$.each(i,(function(t,e){e.forEach((function(t){-1===c.indexOf(t)&&c.push(t)}))})),c&&(t.visiblePieKeysLength=c.length,t.pieKeys=c.concat(t.pieKeys.filter((function(t){return-1===c.indexOf(t)}))),t.colors=_t(t.colorKeyMap,t.pieKeys,t.palette),t.colorsCache=t.colors.slice())}else t.columns.forEach((function(e){var i=t.chartKeys.indexOf(e);i>=0&&t.chartKeys.push(t.chartKeys.splice(i,1)[0]),t.aggregation.forEach((function(i){var a=t.chartKeys.indexOf(i);a>=0&&t.chartKeys.push(t.chartKeys.splice(a,1)[0]);var n=i+" - "+e,r=t.chartKeys.indexOf(n);r>=0&&t.chartKeys.push(t.chartKeys.splice(r,1)[0])}))}));return e},Z.prototype.draw=function(t){var e=this;e.preventExport=t;var i=K.a.hasLoadingContent(e.chartBody);if(0===e.originalTable.length||i)return e.badSettings.hide(),e.logZeroMessage.hide(),void(e.chartBody.data("hasFrame")||i?(e.noTableMessage.hide(),e.loader.show()):(e.noTableMessage.show(),e.loader.hide()));if(!K.a.hasAnyTFACUnfinishedContent(e.originalTable,e.chartBody)){if(clearTimeout(e.timeoutDatePicker),!e.isTime&&!e.isGantt||$.datepicker){e.logZeroMessage.hide(),e.noTableMessage.hide(),e.badSettings.hide(),e.wrongDateFormat.hide(),e.noDataMessage.hide();var a=e.calculate();return e.calculatedData=a,e.clearTableHighlight(),e.svgWrapper.css({height:"",width:""}),e.svgWrapper.html(""),$("body").find("div.d3-tip.chart"+e.macroId+e.pageId).remove(),0===a.length?(0==e.columns.length||0==e.aggregation.length?e.badSettings.show():e.isTime||e.isGantt?(e.wrongDateFormat.show(),e.dateFormatInput.hasClass("autocomplete")||(K.a.dateFormatAutocomplete(e.dateFormatInput),e.dateFormatInput.addClass("autocomplete"))):e.noDataMessage.show(),e.loader.hide(),e.selectColors.hide(),e.setInterpolationBtn.hide(),e.changeLineSettingsBtn.hide(),e.download.hasClass("tf-disabled-link")||e.download.toggleClass("tf-disabled-link"),void e.controls.animate({opacity:1},100)):(e.loader.hide(),e.selectColors.show(),e.shiftInterpolationBtn(),e.shiftChangeLineSettingsBtn(),e.download.hasClass("tf-disabled-link")&&e.download.toggleClass("tf-disabled-link"),e.controls.css("opacity",""),e.drawChart(a),!0)}e.timeoutDatePicker=setTimeout((function(){e.draw()}),100)}},Z.prototype.drawChart=function(t){var e=this;clearTimeout(e.chartTimer),e.content.is(":visible")?("Donut"!==e.type||e.is3D?e.type.indexOf("Column")>=0?e.drawColumn(t):"Pie"!==e.type||e.is3D?e.type.indexOf("Bar")>=0?e.drawBar(t):-1!==e.type.indexOf("Area")||-1!==e.type.indexOf("Line")?e.drawSeries(t):"Donut"===e.type&&e.is3D?e.drawDonut3D(t,.4):"Pie"===e.type&&e.is3D?e.drawDonut3D(t,0):e.isGantt?e.drawGantt(t):e.isBubblePie?e.drawBubblePie(t):e.isRadar&&e.drawRadar(t):e.drawPie(t,0):e.drawPie(t,"40%"),e.isLog&&e.multiple&&e.svgWrapper.find('[y="NaN"], [x="NaN"], [d*="NaN"]').length&&(e.logZeroMessage.show(),e.svgWrapper.html("")),(e.is3D||"Donut"!==e.type&&"Pie"!==e.type)&&setTimeout((function(){e.convertToImage()}),100)):e.chartTimer=setTimeout((function(){e.drawChart(t)}),200)},Z.prototype.drawBubblePie=function(t){var e=this,i=o.a.newSvg(e.svgWrapper[0],e.width,e.height),a=new o.a.chart(i,t),n=e.setBubbleAxisX(a),r=e.setBubbleAxisY(a);e.bubblePieSetting.filterAggregation.map((function(t){a.assignColor(t,e.colorKeyMap[t],e.colorKeyMap[t],1)})),e.setBubbleAxisXScale(n),e.setBubbleAxisYScale(r),e.settingBubbleAxis(n,r),a.addMeasureAxis("p","value"),a.addMeasureAxis("z","value");var s=a.addSeries([e.bubblePieSetting.axisX.title,e.bubblePieSetting.axisY.title,"indicator"],o.a.plot.pie);null===e.xValueType&&n.addOrderRule(e.bubblePieSetting.axisX.order),null===e.valueType&&r.addOrderRule(e.bubblePieSetting.axisY.order),s.addOrderRule(e.bubblePieSetting.filterAggregation),s.tooltipFontSize="14px",e.calculateBubbleLegendSize();var l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight};a.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),a.draw(),e.formatExtremumAxesX(n,s,l,a),a.draw();var c,u,h=(c=0,n.shapes.selectAll("text").each((function(){c=Math.max(gt($(this)),c)})),c);l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+h+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight},e.addTitle(i,e.width+l.left-l.right,{top:0}),e.legend&&((u=a.addLegend(e.isLegendUnderGraph?l.left+e.bubblePieSetting.posX:e.width-l.right+10,e.isLegendUnderGraph?e.height-e.bubblePieSetting.legendHeight-20+(e.xtitleHeight?5:0):l.top,e.bubblePieSetting.legendWidth||e.width-l.left,e.bubblePieSetting.legendHeight,"left"))._getEntries=function(){var t=[];return St(e.bubblePieSetting.filterAggregation,e.isPivot).values.forEach((function(e){t.push({key:e.view,fill:a.getColor(e.key).fill,stroke:a.getColor(e.key).stroke,opacity:a.getColor(e.key).opacity,series:s,aggField:[e.key]})}),this),t}),a.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),a.draw(),e.formatExtremumAxesY(r,s,l,a),a.draw(),e.settingSeriesTooltip(s),e.eventHandlerSeries(s,t),e.formatDimpleAxisX(n),e.legend&&(e.formatBubbleLegend(u),e.eventHandleLegendClick(a,u,t)),s.shapes.style("opacity",(function(t){return null===t.angle?0:1}))},Z.prototype.drawPie=function(t,e){var i=this,a=i.calcGroupSize(i.chartKeys.length);i.addGroupTitle();var r=n.scaleOrdinal().range(i.colors);r.domain(i.pieKeys);var s=0,o=[];i.chartKeys.forEach((function(n){var l=$.grep(t,(function(t){return t.aggregation==n})),c=l,u=it(l);u.count>1&&(l=u.data);var h=[];c.forEach((function(t){-1!=$.inArray(t,l)&&t.value&&h.push(r(t.label))})),h.push("#a3acb2");var d={};(i.title||i.chartKeys.length>1)&&(d={title:{text:i.chartKeys.length>1?n:i.title,color:"#333333",fontSize:16,font:"arial"},location:"top-center"});var p=new C(i.svgWrapper[0],{header:d,data:{content:l},size:{canvasHeight:a.height,canvasWidth:a.width,pieInnerRadius:e},labels:{mainLabel:{fontSize:14},percentage:{color:function(t,e){return rt(h[e%h.length])},decimalPlaces:1,fontSize:14},value:{color:function(t,e){return rt(h[e%h.length])},fontSize:14},inner:{format:i.innerLabelsType.value_percentage?"value-percentage":i.innerLabelsType.percentage_value?"percentage-value":i.innerLabelsType.value?"value":i.showInnerLabels?"percentage":"none",hideWhenLessThanPercentage:4},outer:{format:"None"!==i.outerLabels?"label":"none"},formatter:function(t){var e=t.label;return"inner"===t.section&&("percentage"===t.part?e+="%":"value"===t.part&&(e=i.formatNumTo(t.value))),e}},tooltips:{enabled:!0,type:"placeholder",string:"{label}: {value} ({percentage}%)",placeholderParser:function(t,e){e.value=i.formatNumTo(e.value)},styles:{color:"white",backgroundColor:"black",backgroundOpacity:.8,padding:12,fontSize:14}},callbacks:{onload:function(){var t=$(p.svg._groups[0]),e=t.find('[class$="_segmentMainLabel-outer"]').css({fill:"#333","font-size":"14px","font-weight":"normal"});u.count>1&&e.last().css("font-style","italic"),s++,function(t,e){var i=ht(t);e.each((function(){var t=$(this),e=ht(t),a=parseFloat(t.attr("y"))||0;if(e.left<i.left||e.right>i.right){var n=e.width,r=Math.max(e.left,i.left),s=Math.min(e.right,i.right)-r,o=n-s;if(e.left<i.left){var l=parseFloat(t.attr("x"))||0;l+=o,t.attr("x",l)}var c=t.text(),u=Math.floor(c.length*s/n);if(u>0)for(var h=[];c.length>u;){t.text(c.substring(0,u)),c=c.substring(u);var d=t.clone();a+=7,d.text(c).attr("y",a),t.after(d),h.push(t),t=d,h.forEach((function(t){t.attr("y",(t.attr("y")||0)-7)}))}}}))}(t,e);var a=t.find('[class$="_segmentPercentage-inner"],[class$="_segmentValue-inner"]'),n=t.find('g[class$="_arc"]'),r=a.length/n.length;a.each((function(t){ft(n.eq(t/r),$(this))})),s==i.chartKeys.length&&i.convertToImage()},onClickSegment:function(t){i.clearTableHighlight(),t.expanded||i.highlightTable({rowNumber:t.data.rowNumber,column:t.data.aggregation.replace(" - "+t.data.key,"")}),o.forEach((function(e){if(p!==e){var a=e.getOpenSegment();a&&i.highlightTable({rowNumber:a.data.rowNumber,column:a.data.aggregation.replace(" - "+t.data.key,"")})}}))}},misc:{colors:{segments:h},canvasPadding:{top:20,right:20,bottom:20,left:20}}});o.push(p)}))},Z.prototype.drawDonut3D=function(t,e){var i=this,a=i.calcGroupSize(i.chartKeys.length),s=i.chartKeys.length>1?20:i.titleHeight,o=Math.min(a.width,a.height-s)/2;i.addGroupTitle();var l=n.scaleOrdinal().range(i.colors);l.domain(i.pieKeys);var c=[];i.hideTips=function(){for(var t=0;t<c.length;t++)c[t].hide()},i.chartKeys.forEach((function(u,h){var d=$.grep(t,(function(t){return t.aggregation===u})),p=d,g=it(d);g.count>1&&(d=g.data);var f=[];p.forEach((function(t){-1!==$.inArray(t,d)&&f.push(l(t.label))})),f.push("#a3acb2");var m=i.chart.append("svg").attr("width",a.width).attr("height",a.height);m.append("g").attr("id","donut3d"+i.macroId+i.pageId+h);var y=n.scaleOrdinal().range(f),x=d.map((function(t){return{label:t.label,value:t.value,color:y(t.label),textColor:rt(y(t.label)),other:t.other,rowNumber:t.rowNumber,name:u}}));O.draw("donut3d"+i.macroId+i.pageId+h,x,a.width/2,a.height/2,o,.7*o,.2*o,e,i.showInnerLabels,i.innerLabelsType,i.formatNumTo);var v,b=Object(r.a)().attr("class","d3-tip chart"+i.macroId+i.pageId).offset([-5,0]).html((function(t){var e=t.data.label+": "+i.formatNumTo(t.value)+" ("+O.getPercent(t)+")";return t.data.other&&g.smallData.forEach((function(t){e+="<br>"+t.label+": "+i.formatNumTo(t.value)+" ("+t.percent+"%)"})),e}));c.push(b),i.chartKeys.length>1?i.addTitle(m,a.width,{top:0},{title:u,titleHeight:s}):i.addTitle(m,a.width,{top:0}),m.call(b),m.selectAll(".topSlice, .percent").on("mouseover",(function(t){clearTimeout(v);var e=_.find(".percent").filter((function(){return this.textContent===t.data.label}));b.show(t,e[0]),e[0].__data__.data.other?b.style("font-style","italic"):b.style("font-style","normal")})).on("mouseout",(function(){v=setTimeout((function(){v=null,i.tipHover||b.hide()}),50)})),i.bindElementSelect(m,".topSlice",(function(t){return{rowNumber:t.__data__.data.rowNumber,column:i.getColumnNameForHighlight(t.__data__.data.name)}})),g.count>1&&i.svgWrapper.find("#donut3d"+i.macroId+i.pageId+h+".percent").last().css("font-style","italic");var _=$(m._groups[0]),w=_.find(".percent"),S=_.find(".topSlice");w.each((function(t){var e=$(this),i=S.eq(t%S.length);ft(i,e),function(t,e){var i=dt(t);if(0===i.height)return;e.each((function(){for(var t=$(this),e=dt(t),a=parseInt(t.css("font-size")),n=parseFloat(t.attr("y"))||0,r=parseFloat(t.attr("x"))||0;(e.top<i.top||e.bottom>i.bottom)&&a>0;){var s=pt(t);t.css("font-size",a--);var o=e.height;(e=dt(t)).top<i.top&&e.bottom<=i.bottom?(n=n+o-gt(t),t.attr("y",n),r+=(s-pt(t))/2,t.attr("x",r)):e.bottom>i.bottom&&e.top>=i.top&&(n=n-o+gt(t),t.attr("y",n),r-=(s-pt(t))/2,t.attr("x",r))}}))}(i,e)}))}))},Z.prototype.drawColumn=function(t){var e=this,i=0,a=e.type.indexOf("Stacked")>=0,s=e.convertData(t),o=e.isLog?n.scaleLog():n.scaleLinear(),l=n.axisLeft(o);e.isLog||l.tickFormat(e.formatNumTo);var c=n.min(a&&!e.isLog?s:t,(function(t){return a&&!e.isLog?t.min:t.value})),u=n.max(a?s:t,(function(t){return a?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,u<0&&(e.minvalue*=-1)),e.isLog&&(c=Math.pow(10,Math.floor(Math.log(c)/Math.LN10))),o.domain([isNaN(e.minvalue)?e.isLog?c:Math.min(0,c):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),isNaN(e.scaleStep)||l.tickValues(lt(o.domain(),e.scaleStep));var h=e.chart.append("svg"),d=h.append("g");e.argumentWidth=mt(o,l);var p=s.length*n.max(s,(function(t){return t.values.length})),g=ut(a?e.chartKeys.slice().reverse():e.chartKeys.slice(),Math.min(e.width,e.argumentWidth+20+e.ytitleHeight+20+200*p)-(e.argumentWidth+20+e.ytitleHeight)-20,e.isPivot),f={top:20+e.titleHeight+(e.titleHeight&&e.is3D?10:0),right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+g.maxWidth:20,bottom:20+e.xtitleHeight+(e.isLegendUnderGraph?20*(g.rows+1)+10:0),left:e.argumentWidth+20+e.ytitleHeight},m=Math.min(e.width,f.left+f.right+200*p)-f.left-f.right,y=e.height-f.top-f.bottom;h.attr("width",m+f.left+f.right).attr("height",e.height),d.attr("transform","translate("+f.left+","+f.top+")");var x=n.scaleBand().rangeRound([0,m]).padding(.1),v=n.scaleBand();o.range([y,0]);var b=n.scaleOrdinal().range(e.colors),_=n.axisBottom(x),w=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.name+" ("+e.formatNumTo(t.value)+")"}));e.addTitle(d,m,f),d.call(w),b.domain(e.chartKeys),x.domain(s.map((function(t){return t.label}))),v.domain(e.chartKeys).rangeRound([0,x.bandwidth()]);var S=isNaN(e.minvalue)?e.isLog?c:0:Math.max(0,e.minvalue);if(S=isNaN(e.maxvalue)?S:Math.min(e.maxvalue,S),e.xtitle)var k=d.append("text").attr("x",m/2).attr("y",y+f.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var T=d.append("text").attr("transform","rotate(-90)").attr("y",15-f.left).attr("class","axis-title").attr("x",-y/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var C,P=d.selectAll(".bar").data(s).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate("+x(t.label)+",0)"}));e.hideTips=function(){w.hide()};var F=P.selectAll("rect").data((function(t){return t.values})).enter(),A=function(t){return at(t.value,o.domain()[0],o.domain()[1])},L=function(t){return a?0:v(t.name)},M=function(t){if(a)return o(at(t.y1,o.domain()[0],o.domain()[1]));var e=A(t);return o(e)-o(Math.min(S,e))+o(S)},D=function(t){if(a)return o(at(t.y0,o.domain()[0],o.domain()[1]))-M(t);var e=A(t);return Math.abs(o(e)-o(S))},I=a?x.bandwidth():v.bandwidth();if(e.addBarTrendLine(d,a,t,s,x,o,b,I),e.is3D){I=parseInt(.8*I);var B=parseInt(I/4),V=function(t){if(!t.value)return yt([[0,0]]);var e=L(t)+I,i=M(t),a=i+D(t);return yt([[e,parseInt(i)],[e+B,i-20],[e+B,a-20],[e,a]])},O=function(t){if(!t.value)return yt([[0,0]]);var e=L(t),i=e+I,a=Math.ceil(M(t));return yt([[e,a],[e+B,a-20],[i+B,a-20],[i,a]])};F.append("path").attr("class","bar-top").attr("key",(function(t){return t.name})).attr("d",O).style("fill",(function(t){return st(b(t.name),.8)})),F.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",V).style("fill",(function(t){return st(b(t.name),.9)}))}if(F.append("rect").attr("class",e.is3D?"bar 3d":"bar").attr("width",I).attr("x",L).attr("y",M).attr("height",D).attr("key",(function(t){return t.name})).style("fill",(function(t){return b(t.name)})),!e.isLog)var E=d.append("g").attr("class","y axis").append("line").attr("y1",o(S)).attr("y2",o(S)).attr("x2",m);if(d.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").call(_).selectAll("text"),d.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),e.showInnerLabels){var N=$("<span id='inner-value-label-for-bar'></span>");$("body").append(N);var H=function(i,n,r){return e.formatBarInnerLabel((function(){return nt(i,t,s)}),(function(){return ct(i.value,$(r).parent().find(".bar").eq(n),y,a,!1,e.formatNumTo)}))};F.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var i=N.text(H(t,e,this)).width(),n=D(t);return i>n-5?a?0:5-M(t):-M(t)-n/2-i/2})).attr("y",(function(t){return a?x.bandwidth()/2:v(t.name)+v.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return H(t,e,this)})).style("font-size",(function(t,e){var i=N.text(H(t,e,this)).width(),n=D(t);return I<12||a&&i>n-5?0:14})).style("fill",(function(t,e){return N.text(H(t,e,this)).width()>D(t)-5?"black":rt(b(t.name))})).attr("transform",(function(){return"rotate(-90)"})),N.remove()}d.selectAll(".bar, .inner-value-label").on("mouseover",(function(t){clearTimeout(C);var e=$(this);e.is(".inner-value-label")&&(e=e.parent().find(".bar[key]").filterByAttr("key",t.name));var i=t;if(!t.name){var a=this.getAttribute("key");i=$.grep(t.values,(function(t){return t.name===a}))[0]}w.show(i,e[0])})).on("mouseout",(function(){C=setTimeout((function(){C=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(d,".bar");var z,G,W=parseFloat(e.svgWrapper.find("svg").attr("height")),R=function(t){e.textWidth>x.bandwidth()?(z="end",i=e.textWidth+10,G="translate(-14, 7) rotate(-90)",h.transition().duration(t).attr("height",W+e.textWidth),e.xtitle&&k.transition().duration(t).attr("y",y+f.bottom-15+e.textWidth-(e.isLegendUnderGraph?20*(g.rows+1):0))):(z="middle",i=22,G="translate(0, 0)",h.transition().duration(t).attr("height",W),e.xtitle&&k.transition().duration(t).attr("y",y+f.bottom-10-(e.isLegendUnderGraph?20*(g.rows+1):0))),d.selectAll(".x.axis text").transition().duration(t).attr("transform",G).style("text-anchor",z)};R(0);if(e.legend&&e.chartKeys.length>1){var j=e.chartKeys.slice();e.addLegend(d,m,y+e.xtitleHeight+i,f.top,b,a?j.reverse():j,e.isLegendUnderGraph,(function(i,r){var s=[];t.forEach((function(t){t.aggregation==i&&(t.hidden=!r),t.hidden||-1!=$.inArray(t.aggregation,s)||s.push(t.aggregation)}));var p=$.grep(t,(function(t){return!t.hidden}));if(p.length){var g=e.convertData(p);x.domain(g.map((function(t){return t.label}))),v.domain(s).rangeRound([0,x.bandwidth()]),c=e.isLog?c:n.min(a?g:p,(function(t){return a?t.min:t.value})),u=n.max(a?g:p,(function(t){return a?t.total:t.value})),o.domain([isNaN(e.minvalue)?e.isLog?c:Math.min(0,c):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),I=a?x.bandwidth():v.bandwidth(),e.is3D&&(I*=.8,B=parseInt(I/4)),isNaN(e.scaleStep)||l.tickValues(lt(o.domain(),e.scaleStep));var w=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");g.forEach((function(t){var i=d.selectAll("[label]").filterByAttr("label",t.label),n=function(){i.transition().duration(300).attr("transform",(function(t){return"translate("+x(t.label)+",0)"}))};r||n(),t.values.forEach((function(t){var n=M(t),r=D(t);if(i.selectAll(".bar[key]").filterByAttr("key",t.name).transition().duration(300).attr("width",I).attr("x",L(t)).attr("y",n).attr("height",r),e.is3D&&(i.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",V(t)),i.selectAll(".bar-top[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",O(t))),e.showInnerLabels){var s=i.selectAll("text[key]").filterByAttr("key",t.name),o=function(t,i){return e.formatBarInnerLabel((function(){return nt(t,p,g)}),(function(){return ct(t.value,$(i._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),y,a,!1,e.formatNumTo)}))}(t,s),l=w.text(o).width();s.transition().duration(300).attr("x",a?-n-(r/2+l/2):-n-(l>r?-5:r/2+l/2)).attr("y",a?I/2:v(t.name)+I/2).style("font-size",I<12||a&&l>r-5?0:14).style("fill",l>r-5?"black":rt(b(t.name))).text(o)}})),r&&n()})),w.remove(),d.selectAll(".x.axis").transition().duration(300).on("start",(function(){R(300)})).call(_).selectAll(".x.axis text").style("text-anchor",z).attr("transform",G),d.selectAll(".y.axis").transition().duration(300).on("start",(function(){f.left-=e.argumentWidth,e.argumentWidth=mt(o,l),f.left+=e.argumentWidth,h.transition().duration(300).attr("width",m+f.left+f.right),d.transition().duration(300).attr("transform","translate("+f.left+","+f.top+")"),e.ytitle&&T.transition().duration(300).attr("y",15-f.left)})).call(l),e.isLog||E.transition().duration(300).attr("y1",o(S)).attr("y2",o(S)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},Z.prototype.drawBar=function(t){var e=this,i=e.type.indexOf("Stacked")>=0,a=e.convertData(t),s=e.isLog?n.scaleLog():n.scaleLinear(),o=n.axisTop(s);e.isLog||o.tickFormat(e.formatNumTo);var l=n.min(i&&!e.isLog?a:t,(function(t){return i&&!e.isLog?t.min:t.value})),c=n.max(i?a:t,(function(t){return i?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,c<0&&(e.minvalue*=-1)),e.isLog&&(l=Math.pow(10,Math.floor(Math.log(l)/Math.LN10))),s.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),isNaN(e.scaleStep)||o.tickValues(lt(s.domain(),e.scaleStep));var u=e.chart.append("svg"),h=u.append("g");e.argumentWidth=mt(s,o);var d=ut(e.chartKeys.slice(),e.width-(e.textWidth+10+e.ytitleHeight)-40,e.isPivot),p=e.is3D?20:0,g={top:e.argumentWidth+30+e.titleHeight+e.xtitleHeight,right:p+(e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+d.maxWidth:40),bottom:10+(e.isLegendUnderGraph?20*(d.rows+1)+10:0),left:e.textWidth+10+e.ytitleHeight},f=e.width-g.left-g.right,m=e.height-g.top-g.bottom;s.range([0,f]);var y=n.scaleBand().rangeRound([0,m]).padding(.2),x=n.scaleBand(),v=n.scaleOrdinal().range(e.colors),b=n.axisLeft(y),_=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.name+" ("+e.formatNumTo(t.value)+")"}));u.attr("width",e.width).attr("height",e.height),h.attr("transform","translate("+g.left+","+g.top+")");var w=e.addTitle(h,f,g);if(h.call(_),v.domain(e.chartKeys),y.domain(a.map((function(t){return t.label}))),x.domain(e.chartKeys).rangeRound([0,y.bandwidth()]),e.xtitle)var S=h.append("text").attr("x",f/2).attr("y",e.titleHeight+20-g.top).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);e.ytitle&&h.append("text").attr("transform","rotate(-90)").attr("y",15-g.left).attr("class","axis-title").attr("x",-m/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var k=isNaN(e.minvalue)?e.isLog?l:0:Math.max(0,e.minvalue);k=isNaN(e.maxvalue)?k:Math.min(k,e.maxvalue);var T,C=h.selectAll(".bar").data(a).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate(0,"+y(t.label)+")"}));e.hideTips=function(){_.hide()};var P,F,A=C.selectAll("rect").data((function(t){return t.values})).enter(),L=function(t){return s(i?at(t.y0,s.domain()[0],s.domain()[1]):Math.min(k,at(t.value,s.domain()[0],s.domain()[1])))},M=function(t){return i?0:x(t.name)},D=function(t){return i?s(at(t.y1,s.domain()[0],s.domain()[1]))-L(t):Math.abs(s(at(t.value,s.domain()[0],s.domain()[1]))-s(k))},I=i?y.bandwidth():x.bandwidth();if(e.addBarTrendLine(h,i,t,a,y,s,v,I,!0),e.is3D){I=parseInt(.8*I);var B=parseInt(I/4),V=function(t){if(!t.value)return yt([[0,0]]);var e=L(t),i=e+D(t),a=M(t)+I;return yt([[e,a],[i,a],[i+p,a+B],[e+p,a+B]])},O=function(t){if(!t.value)return yt([[0,0]]);var e=L(t)+D(t),i=M(t),a=i+I;return yt([[e,i],[e+p,i+B],[e+p,a+B],[e,a]])};A.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",O).style("fill",(function(t){return st(v(t.name),.8)})),A.append("path").attr("class","bar-bottom").attr("key",(function(t){return t.name})).attr("d",V).style("fill",(function(t){return st(v(t.name),.9)}))}if(A.append("rect").attr("class","bar").attr("width",D).attr("x",L).attr("y",M).attr("height",I).attr("key",(function(t){return t.name})).style("fill",(function(t){return v(t.name)})),e.showInnerLabels){var E=$("<span id='inner-value-label-for-bar'></span>");$("body").append(E);var N=function(n,r){return e.formatBarInnerLabel((function(){return nt(n,t,a)}),(function(){return ct(n.value,r,f,i,!0,e.formatNumTo)}))};A.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var a=$(this).parent().find(".bar").eq(e),n=E.text(N(t,a)).width(),r=pt(a);return s(at(i?Math.min(t.y0,t.y1):Math.min(t.value,k),s.domain()[0],s.domain()[1]))+(n>r-5?r+5:(r-n)/2)})).attr("y",(function(t){return i?y.bandwidth()/2:x(t.name)+x.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return N(t,$(this).parent().find(".bar").eq(e))})).style("font-size",(function(t,e){var a=$(this).parent().find(".bar").eq(e),n=E.text(N(t,a)).width(),r=pt(a);return(i?y.bandwidth()<14||n>r-5:x.bandwidth()<14)?0:14})).style("fill",(function(t){return rt(v(t.name))})),E.remove()}h.selectAll(".bar, .inner-value-label").on("mouseover",(function(t){T&&(clearTimeout(T),T=null);var e=$(this);e.is(".inner-value-label")&&(e=e.parent().find(".bar[key]").filterByAttr("key",t.name));var i=t;if(!t.name){var a=this.getAttribute("key");i=$.grep(t.values,(function(t){return t.name==a}))[0]}_.show(i,e[0])})).on("mouseout",(function(){T=setTimeout((function(){T=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(h,".bar"),h.append("g").attr("class","x axis").call(o);var H=function(t,i){g.top-=e.argumentWidth,e.argumentWidth=mt(s,o),g.top+=e.argumentWidth,t>e.width/(e.argumentWidth+30)?(P="start",F="translate(12, -4) rotate(-65)",u.transition().duration(i).attr("height",e.height).selectAll("svg > g").attr("transform","translate("+g.left+","+g.top+")"),w&&w.transition().duration(i).attr("y",e.titleHeight-g.top),S&&S.transition().duration(i).attr("y",e.titleHeight+20-g.top)):(P="middle",F="translate(0, 0)",u.transition().duration(i).attr("height",e.height-e.argumentWidth).selectAll("svg > g").attr("transform","translate("+g.left+","+(g.top-e.argumentWidth)+")"),w&&w.transition().duration(i).attr("y",e.titleHeight-g.top+e.argumentWidth),S&&S.transition().duration(i).attr("y",e.titleHeight+20-g.top+e.argumentWidth)),h.selectAll(".x.axis text").transition().duration(i).style("text-anchor",P).attr("transform",F)};H(h.selectAll(".x.axis text").size(),0),h.append("g").attr("class","y axis").call(b);var z=h.append("g").attr("class","y axis").append("line").attr("x1",s(k)).attr("x2",s(k)).attr("y2",m);if(e.legend&&e.chartKeys.length>1){var G=e.chartKeys.slice();e.addLegend(h,f+p,m,g.top,v,G,e.isLegendUnderGraph,(function(a,r){var u=[];t.forEach((function(t){t.aggregation==a&&(t.hidden=!r),t.hidden||-1!=$.inArray(t.aggregation,u)||u.push(t.aggregation)}));var d=$.grep(t,(function(t){return!t.hidden}));if(d.length){var p=e.convertData(d);l=e.isLog?l:n.min(i?p:d,(function(t){return i?t.min:t.value})),c=n.max(i?p:d,(function(t){return i?t.total:t.value})),s.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),y.domain(p.map((function(t){return t.label}))),x.domain(u).rangeRound([0,y.bandwidth()]),isNaN(e.scaleStep)||o.tickValues(lt(s.domain(),e.scaleStep)),I=i?y.bandwidth():x.bandwidth(),e.is3D&&(I=parseInt(.8*I),B=parseInt(I/4));var g=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");p.forEach((function(t){var a=h.selectAll("[label]").filterByAttr("label",t.label),n=function(){a.transition().duration(300).attr("transform",(function(t){return"translate(0,"+y(t.label)+")"}))};r||n(),t.values.forEach((function(t){var n=a.selectAll(".bar[key]").filterByAttr("key",t.name),r=a.selectAll("text[key]").filterByAttr("key",t.name),o=D(t);if(n.transition().duration(300).attr("width",o).attr("x",L(t)).attr("y",M(t)).attr("height",I),e.is3D&&(a.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",O(t)),a.selectAll(".bar-bottom[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",V(t))),e.showInnerLabels){var l=$(r._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),c=function(t){return e.formatBarInnerLabel((function(){return nt(t,d,p)}),(function(){return ct(t.value,l,f,i,!0,e.formatNumTo)}))},u=c(t),h=g.text(c(t)).width(),m=s(at(i?Math.min(t.y0,t.y1):Math.min(t.value,k),s.domain()[0],s.domain()[1]));r.transition().duration(300).attr("x",m+(h>o-5?o+5:(o-h)/2)).attr("y",i?y.bandwidth()/2:x(t.name)+x.bandwidth()/2).style("font-size",(i?y.bandwidth()<14||h>o-5:x.bandwidth()<14)?0:14).style("fill",h>o-5?"black":rt(v(t.name))).text(u)}})),r&&n()})),g.remove();var m=h.append("g").attr("class","xaxis-tmp").call(o),_=h.selectAll(".xaxis-tmp .tick").size();m.remove(),h.selectAll(".x.axis").transition().duration(300).on("start",(function(){H(_,300)})).call(o).selectAll(".x.axis text").style("text-anchor",P).attr("transform",F),h.selectAll(".y.axis").transition().duration(300).call(b),z.transition().duration(300).attr("x1",s(k)).attr("x2",s(k)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},Z.prototype.drawSeries=function(t){var e=this,i=null,a=null,r=0,s=-1!==e.type.indexOf("Stacked"),o=e.chartKeys,l=K.a.parseValueByType(e.xValueType,e.xScaleStep,e.separator,e.worklog);if(l=isNaN(l)||!1===l?null:l,s&&e.convertSeriesDataStacked(t,o),e.isTime){try{i=K.a.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){i=null}try{a=K.a.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){a=null}var c=e.xScaleStep.indexOf("h")>-1?n.timeHour:e.xScaleStep.indexOf("w")>-1?n.timeWeek:e.xScaleStep.indexOf("m")>-1?n.timeMonth:e.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay;if(null==l){var u=t[t.length-1].value-t[0].value;u<864e6&&-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm")?(c=n.timeDay,l=1):e.workingDateFormat.indexOf("i")>=0?(c=n.timeMonth,l=3):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&u<31536e7?(c=n.timeYear,l=1):-1===e.workingDateFormat.indexOf("d")&&u<2592e7?(c=n.timeMonth,l=1):e.workingDateFormat.indexOf("w")>=0&&u<6048e6&&(c=n.timeWeek,l=1)}else l=Math.floor(l)}else i=K.a.parseValueByType(e.xValueType,e.xminvalue,e.separator,e.worklog),a=K.a.parseValueByType(e.xValueType,e.xmaxvalue,e.separator,e.worklog),i=isNaN(i)||!1===i?null:i,a=isNaN(a)||!1===a?null:a;if(0!==(t=$.grep(t,(function(t){return(null==i||t.value>=i)&&(null==a||t.value<=a)}))).length){var h=e.isTime?n.scaleTime():e.isXLog?n.scaleLog():n.scaleLinear(),d=e.isLog?n.scaleLog():n.scaleLinear(),p=n.axisBottom(h);if(e.isTime){var g=e.getTimeFormat();p.tickFormat(g),g}else e.isXLog||(p.tickFormat(e.formatNumToX),e.formatNumToX);var f=n.axisLeft(d);e.isLog||f.tickFormat(e.formatNumTo);var m=n.min(t,(function(t){return t.value})),y=n.max(t,(function(t){return t.value}));!e.isTime&&e.isXLog&&0==i&&(i=Number.MIN_VALUE,y<0&&(i*=-1)),h.domain([null==i?m:i,null==a?y:a]);var x=n.min(t,(function(t){return t.label})),v=n.max(t,(function(t){return s?t.y1:t.label}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,v<0&&(e.minvalue*=-1)),d.domain([isNaN(e.minvalue)?e.isLog?x:Math.min(0,x):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),ot(p),isNaN(e.scaleStep)||f.tickValues(lt(d.domain(),e.scaleStep));var b=e.chart.append("svg"),_=b.append("g");e.argumentWidth=mt(h,p),e.textWidth=Math.max(mt(d,f),e.argumentWidth/2);var w,S,k=ut(s?o.slice().reverse():o.slice(),e.width-(e.textWidth+20+e.ytitleHeight)-40,e.isPivot),T={top:20+e.titleHeight,right:e.legend&&!e.isLegendUnderGraph&&o.length>1?k.maxWidth+25:40,bottom:e.argumentWidth+25+e.xtitleHeight+(e.isLegendUnderGraph?20*(k.rows+1)+10:0),left:e.textWidth+20+e.ytitleHeight},C=e.width-T.left-T.right;if(h.range([0,C]),d.range([e.height,0]),b.attr("oncontextmenu","return false;").attr("width",e.width).attr("height",e.height+T.top+T.bottom),_.attr("transform","translate("+T.left+","+T.top+")"),e.addTitle(_,C,T),e.xtitle)var P=_.append("text").attr("x",C/2).attr("y",e.height+T.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var F=_.append("text").attr("transform","rotate(-90)").attr("y",20-T.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var A=function(t,i){T.bottom-=e.argumentWidth,e.argumentWidth=mt(h,p),T.bottom+=e.argumentWidth;var a=e.height+T.top+T.bottom;return t>C/(e.argumentWidth+10)?(w="end",r=e.argumentWidth+10,S="translate(-14, 7) rotate(-65)",e.xtitle&&P.transition().duration(i).attr("y",e.height+T.bottom-15-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))):(w="middle",r=22,S="translate(0, 0)",a-=e.argumentWidth,e.xtitle&&P.transition().duration(i).attr("y",e.height+T.bottom-e.argumentWidth-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))),_.selectAll(".x.axis text").transition().duration(i).style("text-anchor",w).attr("transform",S),a};_.append("clipPath").attr("id","clip"+e.macroId+e.pageId).append("rect").attr("x",1).attr("width",C).attr("height",e.height);var L,M,D=_.append("g").attr("clip-path","url(#clip"+e.macroId+e.pageId+")");_.append("path").datum(t),e.grid&&!e.isArea&&(L=_.append("g"),M=_.append("g"));var I=function(t){var i=$.inArray(t,o);return e.colors[i%e.colors.length]},B=n.nest().key((function(t){return t.key})).entries(t),V=e.isArea?"area":"line",O=1,E={};if(o.forEach((function(t){var i,a=$.grep(B,(function(e){return e.key===t}));if(i=e.isArea?n.area().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y0((function(t){return t.y0?d(t.y0):e.height})).y1((function(t){return d(s?t.y1:t.label)})):n.line().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y((function(t){return d(t.label)})),E[t]=i,a.length>0){if(a=a[0],tt(e.type)&&e.getLineType(a.key)===q.DOT)!function(t){var i=n.symbol().type(n.symbolCircle).size(100*e.getLineWidth(t.key));D.selectAll('path[key="'+t.key+'"]').data(t.values).enter().append("path").attr("key",t.key).attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})).attr("d",i()).style("fill",I(t.key))}(a);else{var r=D.append("path").attr("class",V).attr("d",i(a.values)).attr("key",a.key);e.isArea?r.style("fill",I(a.key)).style("opacity",O):(r.style("stroke",I(a.key)).style("stroke-width",e.getLineWidth(a.key)+"px"),tt(e.type)&&e.getLineType(a.key)===q.DASH&&r.style("stroke-dasharray","9, 6"))}s||(O*=.8),e.addTrendLine(a,_,h,d,I(a.key))}})),e.grid&&e.isArea&&(L=_.append("g"),M=_.append("g")),e.grid){var N=n.axisLeft(d).tickSize(-C,0,0).tickFormat(""),H=n.axisBottom(h).tickSize(e.height,0,0).tickFormat("");ot(H),isNaN(e.scaleStep)||N.tickValues(lt(d.domain(),e.scaleStep)),L.attr("class","grid").call(N).selectAll("line, .domain").attr("stroke",""),M.attr("class","grid").call(H).selectAll("line, .domain").attr("stroke","")}_.append("g").attr("class","x axis").attr("transform","translate(0,"+e.height+")").call(p).selectAll("text"),_.append("g").attr("class","y axis").call(f).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),b.attr("height",A(_.selectAll(".x.axis text").size(),0));var z=n.bisector((function(t){return t.value})).left,G={},W={};B.forEach((function(t){var i=_.append("g").attr("class","focus").style("display","none");i.append("circle").attr("r",4.5).style("fill",I(t.key));var a=$('<div class="d3-tip n chart'+e.macroId+e.pageId+'" style="position: absolute; pointer-events: all; box-sizing: border-box; display: none"></div>');e.svgWrapper.append(a),W[t.key]=a,G[t.key]=i}));var R=null;e.hideTips=function(){for(var t in G)G[t].style("display","none"),W[t].hide()};var j=n.drag(),X=!1;_.append("rect").attr("class","overlay").attr("width",C).attr("height",e.height).style("fill","none").on("mouseover",(function(){if(!X)for(var t in clearTimeout(R),G)G[t].style("display",""),W[t].show()})).on("mouseout",(function(){R=setTimeout((function(){R=null,e.tipHover||e.hideTips()}),50)})).on("mousemove",(function(){if(!X)if(n.event.altKey||n.event.ctrlKey||n.event.shiftKey)e.hideTips();else{var t=this,i=[];B.forEach((function(a){var r=G[a.key],o=h.invert(n.mouse(t)[0]),l=z(a.values,o,1),c=a.values[l-1],u=a.values[l],p=u&&o-c.value>u.value-o?u:c,f=h(p.value),m=d(s?p.y1:p.label);if(!isNaN(f)){if(f<0||f>C||m<0||m>e.height)return W[a.key].hide(),void r.style("display","none");r.style("display",""),r.attr("transform","translate("+f+","+m+")");var y=e.isTime?g(p.value):e.formatNumToX(p.value);W[a.key].show().text(e.formatNumTo(p.label)+" ("+y+")");var x=$(r._groups[0]).offset();x.top-=W[a.key].outerHeight()+6,x.left-=W[a.key].outerWidth()/2-4,i.push({key:a.key,offset:x,y:d(at(s?p.y1:p.label,d.domain()[0],d.domain()[1]))})}})),i.sort((function(t,e){return t.y-e.y}));var a=0;i.forEach((function(t){a>t.offset.top?(t.offset.top+=60,W[t.key].removeClass("n").addClass("s").offset(t.offset)):W[t.key].removeClass("s").addClass("n").offset(t.offset),a=t.offset.top+45}))}})).on("wheel",(function(){if(n.event.altKey||n.event.ctrlKey){n.event.preventDefault(),n.event.stopPropagation();var t=n.event.deltaY,i=n.mouse(this),a=C/10,r=i[0]/C*a,s=(1-i[0]/C)*a,o=e.height/10,l=i[1]/e.height*o,c=(1-i[1]/e.height)*o;t<0?(J.x1=h.invert(r),J.x2=h.invert(C-s),J.y2=d.invert(l),J.y1=d.invert(e.height-c)):(J.x1=Math.max(h.invert(-r),Z.x1),J.x2=Math.min(h.invert(C+s),Z.x2),J.y2=Math.min(d.invert(-l),Z.y2),J.y1=Math.max(d.invert(e.height+c),Z.y1)),nt()}})).call(j);var Y=h.domain(),U=d.domain(),J={x1:Y[0],y1:U[0],x2:Y[1],y2:U[1]},Z={x1:Y[0],y1:U[0],x2:Y[1],y2:U[1]};e.legend&&o.length>1&&e.addLegend(_,C,e.height+r+5+e.xtitleHeight,T.top,I,s?o.slice().reverse():o,e.isLegendUnderGraph,(function(r,l){t.forEach((function(t){t.key==r&&(t.hidden=!l,W[r].css("visibility",l?"":"hidden"),G[r].style("visibility",l?"":"hidden"))}));var c=$.grep(t,(function(t){return!t.hidden}));c.length&&(s&&e.convertSeriesDataStacked(c,o),m=!e.isTime&&e.isXLog?m:n.min(c,(function(t){return t.value})),y=n.max(c,(function(t){return t.value})),h.domain([null==i?m:i,null==a?y:a]),Y=h.domain(),h.domain([Y[0]>J.x1?Y[0]:J.x1,Y[1]<J.x2?Y[1]:J.x2]),x=n.min(c,(function(t){return t.label})),v=n.max(c,(function(t){return s?t.y1:t.label})),d.domain([isNaN(e.minvalue)?e.isLog?x:Math.min(0,x):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),U=d.domain(),d.domain([Math.max(U[0],J.y1),Math.min(U[1],J.y2)]),st($.grep(B,(function(t){return t.key==r&&(t.hidden=!l),!t.hidden}))))}));var Q=_.append("rect").attr("width",0).attr("height",0).attr("x",0).attr("y",0).attr("class","band"),et=[-1,-1];j.on("end",(function(){if(X=!1,0==n.event.sourceEvent.button&&!(n.event.sourceEvent.altKey||n.event.sourceEvent.ctrlKey||n.event.sourceEvent.shiftKey)){var t=n.mouse(this),e=-1==et[0]||et[0]==t[0]||et[1]==t[1];J.x1=h.invert(et[0]),J.x2=h.invert(t[0]),J.y1=d.invert(t[1]),J.y2=d.invert(et[1]);var i=et[0]>t[0];et=[-1,-1],Q.transition().attr("width",0).attr("height",0).attr("x",et[0]).attr("y",et[1]),e||(i?rt():nt())}})),j.on("drag",(function(){if(X=!0,e.hideTips(),0==n.event.sourceEvent.button){if(n.event.sourceEvent.altKey||n.event.sourceEvent.ctrlKey)return t=n.event.dx,i=n.event.dy,J.x1=h.invert(-t),J.x2=h.invert(C-t),J.y2=d.invert(-i),J.y1=d.invert(e.height-i),void nt(0);var t,i;if(n.event.sourceEvent.shiftKey)!function(t,i){J.x1=h.invert(t),J.x2=h.invert(C-t),J.y2=d.invert(-i),J.y1=d.invert(e.height+i),nt(0)}(n.event.dx,n.event.dy);else{var a=n.mouse(this);a[0]<et[0]?Q.attr("stroke","#14892c").attr("transform","translate("+a[0]+","+et[1]+")"):Q.attr("stroke","#707070"),a[1]<et[1]&&Q.attr("transform","translate("+a[0]+","+a[1]+")"),a[1]<et[1]&&a[0]>et[0]&&Q.attr("transform","translate("+et[0]+","+a[1]+")"),-1==et[0]&&(et=a,Q.attr("transform","translate("+et[0]+","+et[1]+")")),Q.transition().duration(1).attr("width",Math.abs(et[0]-a[0])).attr("height",Math.abs(et[1]-a[1]))}}}));var it=null}function nt(t){J.x1!=J.x2&&(J.x1>J.x2?rt():(h.domain([J.x1,J.x2]),J.y1>J.y2?d.domain([J.y2,J.y1]):d.domain([J.y1,J.y2]),st(B,t)))}function rt(){J={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2},h.domain(Y),d.domain(U),st(B)}function st(t,i){i=null==i?300:i;var a=_.transition().duration(i);if(t.forEach((function(t){a.selectAll(".line[key], .area[key]").filterByAttr("key",t.key).attr("d",E[t.key](t.values)),tt(e.type)&&e.getLineType(t.key)==q.DOT&&a.selectAll('path[key="'+t.key+'"]').attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})),e.showTrendLine&&a.selectAll(".trendline[key]").filterByAttr("key",t.key).attr("x1",h(t.trendData.x1)).attr("y1",d(t.trendData.y1)).attr("x2",h(t.trendData.x2)).attr("y2",d(t.trendData.y2))})),null!=l&&e.isSeries){var n=lt(h.domain(),l);p.tickValues(n),e.grid&&H.tickValues(n)}if(!isNaN(e.scaleStep)){n=lt(d.domain(),e.scaleStep);f.tickValues(n),e.grid&&N.tickValues(n)}var r=_.append("g").attr("class","xaxis-tmp").call(p),s=_.selectAll(".xaxis-tmp .tick").size();r.remove(),a.selectAll(".x.axis").call(p).selectAll(".x.axis text").style("text-anchor",w).attr("transform",S),a.selectAll(".y.axis").on("start",(function(){var t=e.textWidth;e.textWidth=Math.max(mt(d,f),e.argumentWidth/2),t-=e.textWidth,T.left-=t,e.width-=t,b.transition().duration(i).attr("width",e.width).attr("height",A(s,i)),_.transition().duration(i).attr("transform","translate("+T.left+","+T.top+")"),e.ytitle&&F.transition().duration(i).attr("y",20-T.left)})).call(f),e.grid&&(L.transition().duration(i).call(N).selectAll("line").attr("stroke",""),M.transition().duration(i).call(H).selectAll("line").attr("stroke","")),clearTimeout(it),it=setTimeout((function(){e.convertToImage({noExport:!0})}),i+100)}function ot(t){null!=l&&(e.isSeries?t.tickValues(lt(h.domain(),l)):c===n.timeDay&&1!==l?t.ticks(c.filter((function(t){return n.timeDay.count(0,t)%l==0}))):t.ticks(c.every(l)))}},Z.prototype.drawGantt=function(t){var e=this,i=n.scaleOrdinal().range(e.colors);i.domain(e.ganttCatColors);var a=[],s=[],o=[],l=[],c=[],u=[];if(t.forEach((function(t,n){if(t.endDate){var r="mono"===e.barColoringType?"Task":t.category;if(t.style="fill:"+i(r),t.doneStyle="fill:"+i(r+" - Done"),t.todoStyle="fill:"+i(r+" - Todo"),t.labelStyle="fill:"+rt(i(r)),t.label){var h=t.label.split(": ")[0];-1===o.indexOf(h)&&o.push(h)}e.hasTimeFormat||t.endDate.setHours(23,59,59);var d="";if(t.label){var p=t.label.split(": ");p.length>1&&(d="("+t.label.replace(p[0],"").replace(": ","")+")")}var g=Math.round((t.endDate-t.startDate)/864e5),f=t.progress>=0?" "+Math.round(100*t.progress)+"%":"";t.hint=t.category+" "+d+": "+g+" "+"days"+f,a.push(t)}else{var m=-1!==e.ganttCategories.indexOf(t.category),y=-1!==e.ganttCategories.indexOf(t.label);if(m||y){if(y&&u.push(t.label+"-"+t.startDate.getTime()),y||-1===u.indexOf(t.category+"-"+t.startDate.getTime())){var x=m?t.label:t.category,v=m?t.category:t.label,b=new RegExp("^"+v+" - ","g"),_="mono"===e.barColoringType?"Milestone":y?x:v+": "+(x||"milestone");l.push({id:n,category:v,label:x,date:t.startDate,style:"fill:"+i(_),hint:t.hint.replace(b,"")}),c.push(x)}}else{var w="mono"===e.barColoringType?"Event":t.category;s.push({date:t.startDate,style:"stroke:"+i(w),label:t.category||t.label,hint:t.hint,text:t.text})}}})),0!==a.length){if(1==o.length&&a.forEach((function(t){t.label=t.label.replace(o[0],"").replace(": ","")})),c.length){var h=s.slice();s=[],h.forEach((function(t,e){-1===c.indexOf(t.label)&&s.push(t)}))}a.sort((function(t,e){return t.startDate-e.startDate||(t.label>e.label?1:0)}));var d=null,p=null;try{d=K.a.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){}try{p=K.a.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){}if(d||(d=n.min([n.min(a,(function(t){return t.startDate})),n.min(l,(function(t){return t.date})),n.min(s,(function(t){return t.date}))])),!p){var g=$.grep(s,(function(t){return-1===["today","heute"].indexOf(t.text.toLowerCase())}));p=n.max([n.max(a,(function(t){return t.endDate})),n.max(l,(function(t){return t.date})),n.max(g,(function(t){return t.date}))]);var f=K.a.parseDate("today");if(g.length<s.length&&f>p)if(.25*(p-d)>f-p)p=f;else{var m=.25*(p-d)+p.getTime();(p=new Date).setTime(m),s.filter((function(t){return-1!==["today","heute"].indexOf(t.text.toLowerCase())}))[0].date=p}}var y=null,x=null,v=K.a.parseNumber(e.xScaleStep,e.separator);if(null!=(v=isNaN(v)||!1===v?null:v))y=e.xScaleStep.indexOf("h")>-1?n.timeHour:e.xScaleStep.indexOf("w")>-1?n.timeWeek:e.xScaleStep.indexOf("m")>-1?n.timeMonth:e.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,x=Math.floor(v);else{var b=a[a.length-1].endDate-a[0].startDate;b<864e6&&-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm")?(y=n.timeDay,x=1):e.workingDateFormat.indexOf("i")>=0?(y=n.timeMonth,x=3):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&b<31536e7?(y=n.timeYear,x=1):-1===e.workingDateFormat.indexOf("d")&&b<2592e7?(y=n.timeMonth,x=1):e.workingDateFormat.indexOf("w")>=0&&b<6048e6&&(y=n.timeWeek,x=1)}var _=j(e.chart).height(e.height).width(e.width).grid(e.grid).categories(e.ganttCategories).tasks(a).dateLines(s).mileStones(l).tickFormat(e.getTimeFormat()).ticks({ticksSize:y,ticksStep:x}).timeDomain([d,p]).timeDomainMode("fixed");_.init();var w=e.chart.selectAll("svg");e.argumentWidth=mt(_.getTimeAxisRenderer().getAxisLine(),_.getTimeAxisRenderer().getAxis());var S={top:20+e.titleHeight,right:40,bottom:e.argumentWidth+25+e.ytitleHeight,left:e.textWidth+20+e.xtitleHeight};_.margin(S).draw();var k=e.width-S.left-S.right,T=w.selectAll(".gantt-chart");if(e.addTitle(T,k,S),e.ytitle)var C=T.append("text").attr("x",k/2).attr("y",e.height+S.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);e.xtitle&&T.append("text").attr("transform","rotate(-90)").attr("y",20-S.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);!function(t,i){if(t>k/(e.argumentWidth+10)){var a="end",n="translate(-14, 7) rotate(-65)",r=e.height+S.top+S.bottom;w.transition().duration(i).attr("height",r).style("height",r+"px"),e.ytitle&&C.transition().duration(i).attr("y",e.height+S.bottom-10)}else{a="middle",n="translate(0, 0)";r=e.height+S.top+S.bottom-e.argumentWidth;w.transition().duration(i).attr("height",r).style("height",r+"px"),e.ytitle&&C.transition().duration(i).attr("y",e.height+S.bottom-10-e.argumentWidth)}w.selectAll(".xaxis-group text").transition().duration(i).style("text-anchor",a).attr("transform",n)}(w.selectAll(".xaxis-group text").size(),0);var P=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.hint}));e.hideTips=function(){P.hide()},w.call(P),vt(P,w,".g_task",e),vt(P,w,".g_dateline",e),vt(P,w,".g_milestone",e),e.bindElementSelect(w,".g_task")}},Z.prototype.drawRadar=function(t){var e=n.scaleOrdinal().range(this.colors);e.domain(this.chartKeys);var i=ut(this.chartKeys.slice(),this.width-40,this.isPivot),a={id:this.macroId+""+this.pageId,w:this.width,h:this.height,scaleStep:isNaN(this.scaleStep)?void 0:this.scaleStep,formatter:this.formatNumTo,color:e,padding:{left:20,right:this.legend&&!this.isLegendUnderGraph&&this.chartKeys.length>1?50+i.maxWidth:20,top:20+2*this.titleHeight,bottom:this.isLegendUnderGraph&&this.chartKeys.length>1?30+20*(i.rows+1):20},maxValue:isNaN(this.maxvalue)?0:this.maxvalue,grid:this.grid},r=X.draw(this.chart,t,a);if(this.addTitle(r.svg,2*r.cfg.center.x,{top:0}),this.legend&&this.chartKeys.length>1){var s=this.chartKeys.slice();this.addLegend(r.svg,r.cfg.center.x+r.cfg.radius+a.padding.left,r.cfg.center.y+r.cfg.radius+20,a.padding.top,e,s,this.isLegendUnderGraph,(function(){}))}},Z.prototype.addLegend=function(t,e,i,a,n,r,s,o){var l=0,c=-1,u=St(r,this.isPivot),h=t.selectAll(".legend").data(s?u.values:u.values.slice(0,(this.svgWrapper.find("svg").attr("height")-a)/20)).enter().append("g").attr("class","legend").attr("transform",(function(t,a){return s&&(0!==a&&l+u.values[a-1].width+t.width<e?l+=u.values[a-1].width:(c+=1,l=u.width<=e?e/2-u.width/2:20)),"translate("+(s?l:u.keysWidth+26)+","+(s?i+10+20*c:20*a)+")"})).on("click",(function(e){var i=t.selectAll("[key]").filterByAttr("key",e.key),a="hidden"==i.style("visibility")?1:0;$(this).css("opacity",0==a?.5:1),a||i.style("visibility","hidden"),o(e.key,a),a&&setTimeout((function(){t.selectAll("[key]").filterByAttr("key",e.key).style("visibility","")}),330)}));h.append("title").text("Click to hide/show this data"),h.append("rect").attr("x",s?0:e-18).attr("width",18).attr("height",18).style("fill",(function(t){return n(t.key)})),h.append("text").attr("x",(function(t){return s?t.width-8:e-21})).attr("y",9).attr("dy",".35em").style("text-anchor","end").text((function(t){return t.view}))},Z.prototype.formatBarInnerLabel=function(t,e){return this.innerLabelsType.percentage?t():this.innerLabelsType.value_percentage?e()+" ("+t()+")":this.innerLabelsType.percentage_value?t()+" ("+e()+")":e()},Z.prototype.addTitle=function(t,e,i,a){if(this.title||a&&a.title)return t.append("text").attr("x",e/2).attr("y",(a&&a.titleHeight?a.titleHeight:this.titleHeight)-i.top).attr("class","title").attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").style("fill","#333").text(a&&a.title?a.title:this.title)},Z.prototype.addGroupTitle=function(){var t=0;if(this.title&&this.chartKeys.length>1){var e=$(document.createElementNS("http://www.w3.org/2000/svg","text")).attr("class","_title").attr("x",this.width/2).attr("y",16).attr("text-anchor","middle").text(this.title).css({"font-size":"16px","font-family":xt(),"font-weight":"bold"}),i=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr("width",this.width).attr("height",17).append(e);this.svgWrapper.prepend(i),t=i.outerHeight()}this.svgWrapper.height(this.height+t+5).width(this.width)},Z.prototype.convertToImage=function(t){var e=this;if(document.hidden)$(document).one("visibilitychange",(function(){setTimeout((function(){e.convertToImage(t)}),1e3)}));else{e.svgWrapper.find(".axis").css("font-size","10"),e.svgWrapper.find(".axis path, .axis line, .xaxis-group path, .xaxis-group line").css({fill:"none",stroke:"#000","shape-rendering":"crispEdges"}),e.svgWrapper.find(".line").css({fill:"none"}),e.svgWrapper.find("text").css({"font-family":xt()}),e.svgWrapper.find(".axis-title").css({"font-size":"14px"}),e.svgWrapper.find(':not([class$="_tooltip"]) > text:not(.legend):not(.title):not(.percent):not(.axis-title):not(.milestone-label):not([class$="_title"]):not([class$="_segmentPercentage-inner"]):not([class$="_segmentValue-inner"]):not(.inner-value-label):not([class$="_segmentMainLabel-outer"]):not(.task-label)').css({fill:"#333","font-size":"14px","font-weight":"normal"}),e.svgWrapper.find(".grid .tick").css({stroke:"lightgrey","stroke-opacity":.7,"shape-rendering":"crispEdges"}),e.svgWrapper.find(".grid .path").css({"stroke-width":0}),e.svgWrapper.find('[class$="_title"]').css("font-weight","bold"),e.svgWrapper.find('[class$="_tooltips"], .focus').hide(),e.svgWrapper.find(".tickY, .axisY").css({stroke:"black","shape-rendering":"crispEdges"}),e.svgWrapper.find(".gridX").css({"shape-rendering":"crispEdges"}),e.svgWrapper.find(".tick").css("opacity","");var i=e.svgWrapper.find("svg");i.find("#p0_footer").remove(),i.attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg");var a=et(i);if("undefined"==typeof btoa||!a||$("body").hasClass("edit")||$("body").hasClass("content-preview"))e.download.hide();else{var n=e.canvas.attr("width",e.svgWrapper.width()).attr("height",e.svgWrapper.height())[0],r=e.svgWrapper.offset();i.each((function(s){var o=$(this),l=o.offset();if(a=et(o),c()(n,a,{offsetX:l.left-r.left,offsetY:l.top-r.top,ignoreDimensions:!0,ignoreClear:!0}),s===i.length-1){var u=n.getContext("2d");u.globalCompositeOperation="destination-over",u.fillStyle="#ffffff",u.fillRect(0,0,n.width,n.height);var h=n.toDataURL("image/jpeg",1),d='<img src="'+h+'">';e.png.html(d),e.download.attr("href",h),e.preventExport||t&&t.noExport||(clearTimeout(e.exportTimer),e.exportTimer=setTimeout((function(){e.content.trigger("tf-export-ready",e.getExportEventData())}),300))}})),e.svgWrapper.find('[class$="_tooltips"]').show()}}},Z.prototype.getExportEventData=function(){return{macroId:this.macroId,adaptiveDimensions:this.adaptiveDimensions,data:this.calculatedData,params:[this.type,this.columns,this.aggregation,this.hide,this.grid,this.legend,this.minvalue,this.maxvalue,this.xminvalue,this.xmaxvalue,this.scalestep,this.xscalestep,this.title,this.xtitle,this.ytitle,this.isLog,this.isXLog,this.colors,this.pieKeys,this.showInnerLabels,this.showTrendLine,this.worklog,this.interpolation,this.lineSettings]}},Z.prototype.convertData=function(t){var e=this,i=[],a=[];t.forEach((function(t){-1==$.inArray(t.label,a)&&a.push(t.label),i[t.label]||(i[t.label]={label:t.label,values:[]}),i[t.label].values[e.chartKeys.indexOf(t.aggregation)]={name:t.aggregation,value:t.value,label:t.label,rowNumber:t.rowNumber}}));var n=[];return a.forEach((function(t){n.push(i[t])})),n.forEach((function(t){for(var i=e.isLog?Number.MIN_VALUE:0,a=i,n=0;n<t.values.length;n++){var r=t.values[n];r?r.value>=0?(r.y0=i,i+=r.value,r.y1=i):(r.y1=a,a+=r.value,r.y0=a):t.values.splice(n--,1)}t.total=i,t.min=a})),n},Z.prototype.convertSeriesDataStacked=function(t,e){var i=[];e.forEach((function(e){t.forEach((function(t){t.key===e&&(i[t.value]||(i[t.value]=0),t.y0=i[t.value],t.y1=t.y0+t.label,i[t.value]+=t.label)}))}))},Z.prototype.calcGroupSize=function(t){var e=this.width/this.height,i=Math.ceil(Math.sqrt(t*e)),a=Math.ceil(t/i),n=this.width/i,r=this.height/a,s=Math.min(n,r),o=i-1,l=Math.ceil(t/o);return s<=Math.min(this.width/o,this.height/l)&&(n=this.width/o,r=this.height/l),{width:n,height:r}},Z.prototype.addBarTrendLine=function(t,e,i,a,n,r,s,o,l){var c=this;if(c.showTrendLine){var u={};e?(u._total_={key:"",values:[]},a.forEach((function(t){u._total_.values.push({value:t.label,label:t.total})}))):i.forEach((function(t){u[t.aggregation]||(u[t.aggregation]={key:t.aggregation,values:[]}),u[t.aggregation].values.push({value:t.label,label:t.value})}));var h=0;$.each(u,(function(e,i){c.addTrendLine(i,t,n,r,s(i.key),o*(.5+h++),l)}))}},Z.prototype.addTrendLine=function(t,e,i,a,n,r,s){if(this.showTrendLine){var o=t.values.map((function(t){return t.value})),l=o.map((function(t){return i(t)})),c=function(t,e){var i=function(t,e){return t+e},a=1*t.reduce(i)/t.length,n=1*e.reduce(i)/e.length,r=t.map((function(t){return Math.pow(t-a,2)})).reduce(i),s=e.map((function(t){return Math.pow(t-n,2)})).reduce(i),o=t.map((function(t,i){return(t-a)*(e[i]-n)})).reduce(i),l=o/r,c=n-a*l,u=Math.pow(o,2)/(r*s);return[l,c,u]}(l,t.values.map((function(t){return parseFloat(t.label)}))),u=i.domain()[i.domain().length-1];t.trendData={x1:o[0],y1:c[0]*l[0]+c[1],x2:u,y2:c[0]*i(u)+c[1]};var h=i(t.trendData.x1),d=a(t.trendData.y1),p=i(t.trendData.x2),g=a(t.trendData.y2);if(!(isNaN(d)||isNaN(g)||isNaN(h)||isNaN(p)))r=r||0,e.selectAll(".trendline[key]").filterByAttr("key",t.key).data([{}]).enter().append("line").attr("class","trendline").attr("clip-path","url(#clip"+this.macroId+this.pageId+")").attr("key",t.key).attr(s?"y1":"x1",h+r).attr(s?"x1":"y1",d).attr(s?"y2":"x2",p+r).attr(s?"x2":"y2",g).attr("stroke",n).attr("stroke-dasharray","10,10").attr("stroke-width",1)}},Z.prototype.enableSaveBtn=function(){this.btn.removeClass("tf-disabled-link"),this.controls.add(this.btn).find(".tfac-unsaved").show()},Z.prototype.shiftInterpolationBtn=function(){!this.type||-1===this.type.indexOf("Line")&&-1===this.type.indexOf("Area")?this.setInterpolationBtn.hide():this.setInterpolationBtn.show()},Z.prototype.shiftChangeLineSettingsBtn=function(){this.type&&-1!==this.type.indexOf("Line")?this.changeLineSettingsBtn.show():this.changeLineSettingsBtn.hide()},Z.prototype.bindTips=function(){var t=this;$("body").delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseover",(function(){t.tipHover=!0})).delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseout",(function(){t.tipHover=!1,t.hideTips()}))},Z.prototype.getTimeFormat=function(){var t=this;if(-1===t.workingDateFormat.toLowerCase().indexOf("hh:mm"))return function(e){return K.a.formatDate(e,t.workingDateFormat,t.locale)};var e=K.a.getDateFormatWithoutTime(t.workingDateFormat);return function(i){return 0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()?K.a.formatDate(i,e,t.locale):K.a.formatTime(i,t.workingDateFormat)}},Z.prototype.getInterpolation=function(t){return this.interpolation instanceof Array&&this.updateInterpolation(),this.interpolation[t]||(this.interpolation[t]=this.defaultInterpolation),function(t){switch(t){case"Linear":return n.curveLinear;case"Step":return n.curveStep;case"Natural cubic":return n.curveNatural;case"Monotone X cubic":return n.curveMonotoneX;case"Monotone Y cubic":return n.curveMonotoneY;case"Cubic CatmullRom":return n.curveCatmullRom;case"Cubic cardinal":return n.curveCardinal;case"Cubic basis":case"Straightened cubic basis":return n.curveBasis;default:return n.curveLinear}}(this.interpolation[t])},Z.prototype.getLineWidth=function(t){return this.lineSettings instanceof Array&&this.updateLineSettings(),this.lineSettings[t]&&this.lineSettings[t].width||1.5},Z.prototype.getLineType=function(t){return this.lineSettings instanceof Array&&this.updateLineSettings(),this.lineSettings[t]&&this.lineSettings[t].type||"solid"},Z.prototype.updateInterpolation=function(){var t=this,e={};t.chartKeys.forEach((function(i,a){e[i]=a<t.interpolation.length?t.interpolation[a]:t.defaultInterpolation})),t.interpolation=e},Z.prototype.updateLineSettings=function(){var t=this,e={};t.chartKeys.forEach((function(i,a){e[i]=a<t.lineSettings.length?{type:t.lineSettings[a].split("-")[0],width:parseFloat(t.lineSettings[a].split("-")[1])}:{type:"solid",width:1.5}})),t.lineSettings=e},Z.prototype.getInnerLabelsParam=function(){return this.showInnerLabels?this.innerLabelsType.value_percentage?"Value (Percentage)":this.innerLabelsType.percentage_value?"Percentage (Value)":this.innerLabelsType.percentage?"Percentage":this.innerLabelsType.value?"Value":"Donut"===this.type||"Pie"===this.type?"Percentage":"":"None"},Z.prototype.clearTableHighlight=function(){this.originalTable.removeClass("tf-chart-highlight"),this.rows.forEach((function(t){t.removeClass("tf-chart-highlight")})),this.originalTable.trigger("tf-chart-highlight-off")},Z.prototype.highlightTable=function(t){var e=this;e.originalTable.addClass("tf-chart-highlight"),$.each(t.rowNumber,(function(i,a){var n=e.rows[i];a.forEach((function(t){n.eq(t).addClass("tf-chart-highlight")})),e.originalTable.eq(i).trigger("tf-chart-highlight-on",{rowNumbers:a,column:t.column})}))},Z.prototype.bindElementSelect=function(t,e,i){var a=this;function r(t){a.clearTableHighlight();var r=n.select(t);r.classed("highlighted",!r.classed("highlighted")),a.svgWrapper.find(e+".highlighted").each((function(){a.highlightTable(i?i(this):{rowNumber:this.__data__.rowNumber,column:a.getColumnNameForHighlight(this.__data__.name)})}))}t.selectAll(e).on("click",(function(){r(this)})),t.selectAll("text.inner-value-label, text.percent").on("click",(function(){var t=$(this.parentNode),i=t.find(e);r(i.eq(t.find("text.inner-value-label, text.percent").index(this)%i.length)[0])}))},Z.prototype.getColumnNameForHighlight=function(t){return t?this.columns.length<2?t:t.substring(0,t.lastIndexOf(" - ")):""},Z.prototype.triggerSettingsButtonInvoke=function(){this.settings.trigger("aui-button-invoke"),this.settings.is(".active")&&this.settings.trigger("aui-button-invoke")},Z.prototype.formatBubbleLegend=function(t){var e=this,i=$("<span></span>");$("body").append(i);var a=[];t.shapes._groups[0].forEach((function(t,n){var r=$(t).children("text"),s=$(t).children("rect"),o=r.text();s.attr("height",18).attr("width",18),o.length>33&&(o=o.substr(0,33)+"...",r.text(o));var l=s.width()+5+i.text(o).width(),c=0,u=0;e.isLegendUnderGraph?(0===n||(e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?(0!==n&&(s.attr("y",a[n-1].signaturePosY+5+18),r.attr("y",a[n-1].signaturePosY+5+18)),c=+s.attr("x"),u=+s.attr("y"),r.attr("x",+r.attr("x")+3)):(c=a[n-1].signaturePosX+a[n-1].width+10,u=a[n-1].signaturePosY,s.attr("y",u)),r.attr("y",u+13),a.push({width:l,signaturePosX:c,signaturePosY:u}),0!==n&&((e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?0:(1,r.attr("x",+c+23),s.attr("x",+c)))):0!==n?(r.attr("y",+r.attr("y")+3+9*n),s.attr("y",+s.attr("y")+9*n)):r.attr("y",+r.attr("y")+3)})),i.remove()},Z.prototype.calcBubbleChartExtremum=function(){var t,e;if(this.xminvalue){var i=K.a.getAnyValueType(this.xminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);i===this.xValueType&&(this.bubblePieSetting.axisX.minValue=K.a.parseAnyValueByType(i,this.xminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.xmaxvalue){var a=K.a.getAnyValueType(this.xmaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);a===this.xValueType&&(this.bubblePieSetting.axisX.maxValue=K.a.parseAnyValueByType(a,this.xmaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.bubblePieSetting.axisX.maxValue<this.bubblePieSetting.axisX.minValue){var n=this.bubblePieSetting.axisX.minValue,r=this.bubblePieSetting.axisX.maxValue;this.bubblePieSetting.axisX.minValue=r,this.bubblePieSetting.axisX.maxValue=n}this.bubblePieSetting.axisX.maxValue===this.bubblePieSetting.axisX.minValue&&(this.xValueType===K.a.date?t=15768e6:this.xValueType===K.a.worklog?t=K.a.parseAnyValueByType(this.xValueType,"8h",this.separator,this.worklog,!0,this.dateFormat,this.locale):this.xValueType===K.a.number?t=K.a.parseAnyValueByType(this.xValueType,.5*this.bubblePieSetting.axisX.maxValue,this.separator,this.worklog,!0,this.dateFormat,this.locale):this.xValueType===K.a.duration&&(t=K.a.parseAnyValueByType(this.xValueType,"8:00",this.separator,this.worklog,!0,this.dateFormat,this.locale)),this.bubblePieSetting.axisX.maxValue=+this.bubblePieSetting.axisX.maxValue+t,this.bubblePieSetting.axisX.minValue=this.bubblePieSetting.axisX.minValue-t);if(this.yminvalue){var s=K.a.getAnyValueType(this.yminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);s===this.valueType&&(this.bubblePieSetting.axisY.minValue=K.a.parseAnyValueByType(s,this.yminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.ymaxvalue){var o=K.a.getAnyValueType(this.ymaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);o===this.valueType&&(this.bubblePieSetting.axisY.maxValue=K.a.parseAnyValueByType(o,this.ymaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.bubblePieSetting.axisY.maxValue<this.bubblePieSetting.axisY.minValue){var l=this.bubblePieSetting.axisY.minValue,c=this.bubblePieSetting.axisY.maxValue;this.bubblePieSetting.axisY.minValue=c,this.bubblePieSetting.axisY.maxValue=l}this.bubblePieSetting.axisY.maxValue===this.bubblePieSetting.axisY.minValue&&(this.valueType===K.a.date?e=15768e6:this.valueType===K.a.worklog?e=K.a.parseAnyValueByType(this.valueType,"8h",this.separator,this.worklog,!0,this.dateFormat,this.locale):this.valueType===K.a.number?e=K.a.parseAnyValueByType(this.valueType,.5*this.bubblePieSetting.axisY.maxValue,this.separator,this.worklog,!0,this.dateFormat,this.locale):this.valueType===K.a.duration&&(e=K.a.parseAnyValueByType(this.valueType,"8:00",this.separator,this.worklog,!0,this.dateFormat,this.locale)),this.bubblePieSetting.axisY.maxValue=+this.bubblePieSetting.axisY.maxValue+e,this.bubblePieSetting.axisY.minValue=this.bubblePieSetting.axisY.minValue-e)},Z.prototype.setBubbleAxisX=function(t){var e,i=this;if(i.xValueType===K.a.date){i.workingDateFormat=i.dateFormat;var a=i.getTimeFormat();(e=t.addTimeAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return a}}else i.xValueType===K.a.worklog?(e=t.addTimeAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return i.formatNumToX}:i.xValueType===K.a.number||i.xValueType===K.a.duration?(e=t.addMeasureAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return function(t){return i.formatNumToX(t)}}:(e=t.addCategoryAxis("x",i.bubblePieSetting.axisX.title),null!==i.xValueType&&(e._getFormat=function(){return i.formatNumToX}));return e},Z.prototype.setBubbleAxisY=function(t){var e,i=this;if(i.valueType===K.a.date){i.workingDateFormat=i.dateFormat;var a=i.getTimeFormat();(e=t.addTimeAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return a}}else i.valueType===K.a.worklog?(e=t.addTimeAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return i.formatNumTo}:i.valueType===K.a.number||i.valueType===K.a.duration?(e=t.addMeasureAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return function(t){return i.formatNumTo(t)}}:(e=t.addCategoryAxis("y",i.bubblePieSetting.axisY.title),null!==i.valueType&&(e._getFormat=function(){return i.formatNumTo}));return e},Z.prototype.setBubbleAxisXScale=function(t){if(this.bubblePieSetting.axisX.maxValue&&this.bubblePieSetting.axisX.minValue&&this.bubblePieSetting.axisX.maxValue>this.bubblePieSetting.axisX.minValue&&(t.overrideMax=this.bubblePieSetting.axisX.maxValue,t.overrideMin=this.bubblePieSetting.axisX.minValue,this.xScaleStep||this.xValueType!==K.a.date||this.bubblePieSetting.axisX.maxValue-this.bubblePieSetting.axisX.minValue<864e6&&(this.xScaleStep="1d"),this.xScaleStep)){var e=K.a.parseNumber(this.xScaleStep.toString(),this.separator);this.xValueType===K.a.date&&(t.timePeriod=this.xScaleStep.indexOf("h")>-1?n.timeHour:this.xScaleStep.indexOf("w")>-1?n.timeWeek:this.xScaleStep.indexOf("m")>-1?n.timeMonth:this.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,t.timeInterval=e),this.xValueType===K.a.worklog&&(t.timePeriod=this.xScaleStep.indexOf("h")>-1?n.timeHour:this.xScaleStep.indexOf("w")>-1?n.timeWeek:n.timeDay,t.timeInterval=e)}},Z.prototype.setBubbleAxisYScale=function(t){if(this.bubblePieSetting.axisY.maxValue&&this.bubblePieSetting.axisY.minValue&&this.bubblePieSetting.axisY.maxValue>this.bubblePieSetting.axisY.minValue&&(t.overrideMax=this.bubblePieSetting.axisY.maxValue,t.overrideMin=this.bubblePieSetting.axisY.minValue,this.yScaleStep||this.valueType!==K.a.date||this.bubblePieSetting.axisY.maxValue-this.bubblePieSetting.axisY.minValue<864e6&&(this.yScaleStep="1d"),this.yScaleStep)){var e=K.a.parseNumber(this.yScaleStep.toString(),this.separator);this.valueType===K.a.date&&(t.timePeriod=this.yScaleStep.indexOf("h")>-1?n.timeHour:this.yScaleStep.indexOf("w")>-1?n.timeWeek:this.yScaleStep.indexOf("m")>-1?n.timeMonth:this.yScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,t.timeInterval=e),this.valueType===K.a.worklog&&(t.timePeriod=this.yScaleStep.indexOf("h")>-1?n.timeHour:this.yScaleStep.indexOf("w")>-1?n.timeWeek:n.timeDay,t.timeInterval=e)}},Z.prototype.settingBubbleAxis=function(t,e){t.showGridlines=this.grid,e.showGridlines=this.grid,t.title=this.xtitle||"",e.title=this.ytitle||"",t.fontSize="14px",e.fontSize="14px"},Z.prototype.calculateBubbleLegendSize=function(){if(this.isLegendUnderGraph){var t=ut(this.bubblePieSetting.filterAggregation.slice(),this.width-(20+this.bubblePieSetting.axisY.longestTitle+5+this.ytitleHeight),this.isPivot,36);this.bubblePieSetting.legendHeight=25*(t.rows+1),this.bubblePieSetting.indexFirstLegendInRow=t.firstInRow,this.bubblePieSetting.posX=t.posX}else{var e=$("<span></span>");$("body").append(e);var i=K.a.getLongestWordInArr(this.bubblePieSetting.filterAggregation);this.bubblePieSetting.legendWidth=23+e.text(i).width(),this.bubblePieSetting.legendHeight=22*this.bubblePieSetting.filterAggregation.length,e.remove()}},Z.prototype.formatDimpleAxisX=function(t){t.shapes.selectAll("text").each((function(){if(!$(this).attr("transform"))return!1;var t=$(this).attr("transform").replace("rotate(90","rotate(-90").replace("translate(-5","translate("+(5-gt($(this))));$(this).attr("transform",t)})),this.xtitleHeight&&t.titleShape.attr("y",+t.titleShape.attr("y")+5)},Z.prototype.eventHandlerSeries=function(t,e){var i=this,a={},n={},r={};t.shapes.on("click",(function(t){var s="push",o=t.aggField[0],l=t.aggField[1],c=t.cy,u=t.cx,h=t.aggField[2];this.classList.contains("highlighted")?(this.classList.remove("highlighted"),s="remove"):this.classList.add("highlighted"),e.forEach((function(t){if(n[t.tableI]||(n[t.tableI]=[0]),-1===n[t.tableI].indexOf(t.rowI)&&n[t.tableI].push(t.rowI),t.indicator===h){if(i.valueType===K.a.number||i.valueType===K.a.duration){if(t["orig_"+i.bubblePieSetting.axisY.title]!==c)return}else if(t[i.bubblePieSetting.axisY.title]!==l)return;if(i.xValueType===K.a.number||i.xValueType===K.a.duration){if(t["orig_"+i.bubblePieSetting.axisX.title]!==u)return}else if(t[i.bubblePieSetting.axisX.title]!==o)return;"push"===s?(a[t.tableI]||(a[t.tableI]=[0],r[t.tableI]=[]),-1===a[t.tableI].indexOf(t.rowI)&&a[t.tableI].push(t.rowI),r[t.tableI].push(t.rowI)):(r[t.tableI].indexOf(t.rowI)>-1&&r[t.tableI].splice(r[t.tableI].indexOf(t.rowI),1),a[t.tableI].indexOf(t.rowI)>-1&&-1===r[t.tableI].indexOf(t.rowI)&&a[t.tableI].splice(a[t.tableI].indexOf(t.rowI),1),1===a[t.tableI].length&&delete a[t.tableI])}})),i.clearTableHighlight(),i.highlightTable({rowNumber:$.isEmptyObject(a)?n:a})}))},Z.prototype.eventHandleLegendClick=function(t,e,i){var a=this;t.legends=[];var r=o.a.getUniqueValues(i,"indicator");e.shapes.selectAll("rect").on("click",(function(e){var s=!1,l=[];r.forEach((function(t){t===e.aggField.slice(-1)[0]?s=!0:l.push(t)})),s?n.select(this).style("opacity",.2):(l.push(e.aggField.slice(-1)[0]),n.select(this).style("opacity",1)),r=l;var c=a.bubblePieSetting.axisX.title,u=a.bubblePieSetting.axisY.title;a.bubblePieSetting.sameValuesCount={},i.forEach((function(t){r.includes(t.indicator)&&(a.valueType!==K.a.number&&a.valueType!==K.a.duration&&a.xValueType!==K.a.number&&a.xValueType!==K.a.duration||(a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]>0?a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]+=1:a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]=1))}));var h=o.a.filterData(i,"indicator",r);h.forEach((function(t){a.valueType!==K.a.number&&a.valueType!==K.a.duration||(t[u]=parseFloat(t["orig_"+u]/a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+t["orig_"+u]])),a.xValueType!==K.a.number&&a.xValueType!==K.a.duration||(t[c]=parseFloat(t["orig_"+c]/a.bubblePieSetting.sameValuesCount[t[c]+"_"+(t["orig_"+c]||t[c])]))})),t.data=h,t.draw()}))},Z.prototype.settingSeriesTooltip=function(t){var e=this;t.getTooltipText=function(t){var i=function(t,i){return K.a.formatAnyValueByType(t,i,(function(t){return t>=1e4?e.formatNum.to(t):e.formatNumShort.to(t)}),e.worklog,e.dateFormat,e.locale)},a=null!==e.xValueType?i(t.cx,e.xValueType):t.cx,n=null!==e.valueType?i(t.cy,e.valueType):t.cy,r=null!==e.bubblePieSetting.indicator.valueType?i(t.cz,e.bubblePieSetting.indicator.valueType):t.cz;switch(e.getInnerLabelsParam()){case"Value (Percentage)":r+=" ("+Math.round(100*t.piePct)+"%)";break;case"Percentage (Value)":r=Math.round(100*t.piePct)+"% ("+r+")";break;case"Percentage":r=Math.round(100*t.piePct)+"%"}return[e.bubblePieSetting.axisX.title+": "+a,e.bubblePieSetting.axisY.title+": "+n,t.aggField[2]+": "+r]}},Z.prototype.formatExtremumAxesX=function(t,e,i,a){if(null!==this.xValueType||null!==this.valueType){var n=ht($(a.svg._groups[0])),r={left:0,right:0,tickXSize:0},s=0,o=0,l=0;t.shapes.selectAll("g").each((function(){s+=1})),r.left=n.left+i.left,r.right=n.right-i.right,r.tickXSize=n.width/s,e.shapes.each((function(){var t=ht($(this));t.left<r.left&&(l=Math.max(l,r.left-t.left)),t.right>r.right&&(o=Math.max(o,t.right-r.right))})),l>0&&null!==this.xValueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(l/r.tickXSize)),o>0&&null!==this.xValueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(o/r.tickXSize))}},Z.prototype.formatExtremumAxesY=function(t,e,i,a){if(null!==this.xValueType||null!==this.valueType){var n=dt($(a.svg._groups[0])),r={top:0,bottom:0,tickYSize:0},s=0,o=0,l=0;t.shapes.selectAll("g").each((function(){s+=1})),r.top=n.top+i.top,r.bottom=n.bottom-i.bottom,r.tickYSize=n.height/s,e.shapes.each((function(){var t=dt($(this));t.top<r.top&&(o=Math.max(o,r.top-t.top)),t.bottom>r.bottom&&(l=Math.max(l,t.bottom-r.bottom))})),o>0&&null!==this.valueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(o/r.tickYSize)),l>0&&null!==this.valueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(l/r.tickYSize))}},Z.prototype.setColorKeyMap=function(t,e,i){return e.forEach((function(e,a){t[e]=i[a]})),t};e.a=Z},46:function(t,e,i){},5:function(t,e){if(window.TFACInlineDialogTemplates=window.TFACInlineDialogTemplates||{},void 0===i)var i={};i.inlineDialog=function(t,e){var a='<form class="aui top-label inline-dialog-form tf-inline-dialog-form '+soy.$$escapeHtml(t.clazz)+'" id="'+soy.$$escapeHtml(t.name)+"-"+soy.$$escapeHtml(t.dialogId)+'">';if(""!=t.inputs){a+="<fieldset>";for(var n=t.inputs,r=n.length,s=0;s<r;s++){var o=n[s];a+='<div class="field-group"><label for="input-'+soy.$$escapeHtml(o.field)+"-"+soy.$$escapeHtml(s)+'">'+soy.$$escapeHtml(o.field)+(o.help?'<a href="'+soy.$$escapeHtml(o.help)+'" target="_blank"><span class="aui-icon aui-icon-small aui-iconfont-help tf-macro-editor-help"></span></a>':"")+"</label>"+i.field({input:o,index:s})+"</div>"}a+='</fieldset><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Save")+'" id="apply-'+soy.$$escapeHtml(t.dialogId)+'"/><a class="cancel" id="cancel-'+soy.$$escapeHtml(t.dialogId)+'">'+soy.$$escapeHtml("Cancel")+"</a></div></div>"}else a+='<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Filters are not specified")+'</p></div><div class="buttons-container"><div class="buttons"><a class="cancel" id="cancel-'+soy.$$escapeHtml(t.dialogId)+'">'+soy.$$escapeHtml("Cancel")+"</a></div></div>";return a+="</form>"},goog.DEBUG&&(i.inlineDialog.soyTemplateName="TFACInlineDialogTemplates.inlineDialog"),i.field=function(t,e){var i="";if("checkbox"==t.input.variant)i+='<input class="checkbox inverse-input" type="checkbox" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' checked="checked"':"")+"/>";else if("text"==t.input.variant)i+='<input type="text" class="text simple-input" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'"':"")+"/>";else if("number"==t.input.variant)i+='<input type="number" min="'+soy.$$escapeHtml(t.input.min)+'" max="'+soy.$$escapeHtml(t.input.max)+'" class="text simple-input" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'"':"")+"/>";else if("single_select"==t.input.variant){i+='<select class="select" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.isMultiple?"multiple":"")+(t.input.isIcon?' data-html="true"':"")+">";for(var a=t.input.selects,n=a.length,r=0;r<n;r++){var s=a[r];i+='<option value="'+soy.$$escapeHtml(s)+'"';for(var o=t.input.value,l=o.length,c=0;c<l;c++){i+=o[c]==s?' selected="selected"':""}i+=">"+soy.$$escapeHtml(s)+"</option>"}for(var u=t.input.fakeSelects,h=u.length,d=0;d<h;d++){var p=u[d];i+='<option value="'+soy.$$escapeHtml(p)+'" selected="selected">'+soy.$$escapeHtml(p)+"</option>"}i+="</select>"}else if("line_settings"==t.input.variant)i+='<select class="select line-settings-type" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-name="'+soy.$$escapeHtml(t.input.field)+'"><option value="solid"'+("solid"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Solid")+'</option><option value="dash"'+("dash"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Dash")+'</option><option value="circle"'+("circle"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Dot")+'</option></select><input class="line-settings-width text simple-input" type="number" min="0" max="100000" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="number"'+(t.input.value.width?'value="'+soy.$$escapeHtml(t.input.value.width)+'"':"")+"/>px";else if("interpolation_select"==t.input.variant)i+='<select class="select" data-name="'+soy.$$escapeHtml(t.input.field)+'" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'"><option value="Linear"'+("Linear"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Linear")+'</option><option value="Step"'+("Step"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Step")+'</option><option value="Natural cubic"'+("Natural cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Natural cubic")+'</option><option value="Monotone X cubic"'+("Monotone X cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Monotone X cubic")+'</option><option value="Monotone Y cubic"'+("Monotone Y cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Monotone Y cubic")+'</option><option value="Cubic CatmullRom"'+("Cubic CatmullRom"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic Catmull\ufffdRom")+'</option><option value="Cubic cardinal"'+("Cubic cardinal"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic cardinal")+'</option><option value="Cubic basis"'+("Cubic basis"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic basis")+'</option><option value="Straightened cubic basis"'+("Straightened cubic basis"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Straightened cubic basis")+"</option></select>";else if("colors"==t.input.variant){i+='<button class="aui-button aui-dropdown2-trigger" aria-owns="tf-chart-colors-'+soy.$$escapeHtml(t.index)+"-"+soy.$$escapeHtml(t.input.id)+'" aria-haspopup="true"><a class="tfc-color selected" data-color="'+soy.$$escapeHtml(t.input.color)+'" style="background: '+soy.$$escapeHtml(t.input.color)+';"></a></button><div id="tf-chart-colors-'+soy.$$escapeHtml(t.index)+"-"+soy.$$escapeHtml(t.input.id)+'" class="aui-style-default aui-dropdown2 tfc-color-dd"><ul>';for(var g=["#8eb021","#d04437","#3572b0","#f6c342","#654982","#f691b2","#2484c1","#65a620","#7b6888","#d8d23a","#e98125","#6ada6a","#0c6197","#e4a14b","#8cc3e9","#a3acb2","#69a6f9","#cc1010","#31383b"],f=g.length,m=0;m<f;m++){var y=g[m];i+='<li class="tfc-li-color"><a class="tfc-color" data-color="'+soy.$$escapeHtml(y)+'" style="background: '+soy.$$escapeHtml(y)+';" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li>'}i+='<li class="tfc-li-color"><a class="tfc-color" data-color="#000000" style="background: #000000;" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li><li class="tfc-li-color"><a class="tfc-color" data-color="#ffffff" style="background: #ffffff;" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li></ul></div>'}else if("range"==t.input.variant){var x=t.input.isDate?"date":"number";i+='<div class="'+soy.$$escapeHtml(x)+'s range" data-type="'+soy.$$escapeHtml(t.input.type)+'">'+soy.$$escapeHtml("from")+'<input type="text" class="text '+soy.$$escapeHtml(x)+' from" name="'+soy.$$escapeHtml(t.input.field)+"-from-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-from-"+soy.$$escapeHtml(t.index)+'" '+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'" ':"")+(t.input.isDate?' placeholder="'+soy.$$escapeHtml("Pick date")+'" ':"")+"/>"+soy.$$escapeHtml("to")+'<input type="text" class="text '+soy.$$escapeHtml(x)+' to" name="'+soy.$$escapeHtml(t.input.field)+"-to-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-to-"+soy.$$escapeHtml(t.index)+'" '+(t.input.valueTo?' value="'+soy.$$escapeHtml(t.input.valueTo)+'" ':"")+(t.input.isDate?' placeholder="'+soy.$$escapeHtml("Pick date")+'" ':"")+"/></div>"}return i},goog.DEBUG&&(i.field.soyTemplateName="TFACInlineDialogTemplates.field"),t.exports=i},50:function(t,e,i){},51:function(t,e,i){}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:69c25a18acc714def56d2fdd1a60c175', location = 'build/69c25a18acc714def56d.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[15],{19:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},4:function(e,t,r){"use strict";(function(e,n,a){var s,i,o;i=[],s=function(){var s=function(e,t,r,n){if(t=t||[],"function"!=typeof importScripts&&s.webworker){var a=s.lastid++;return s.buffer[a]=r,void s.webworker.postMessage({id:a,sql:e,params:t})}return 0===arguments.length?new P.Select({columns:[new P.Column({columnid:"*"})],from:[new P.ParamValue({param:0})]}):1===arguments.length&&e.constructor===Array?s.promise(e):("function"==typeof t&&(n=r,r=t,t=[]),"object"!=typeof t&&(t=[t]),"string"==typeof e&&"#"===e[0]&&"object"==typeof document?e=document.querySelector(e).textContent:"object"==typeof e&&e instanceof HTMLElement?e=e.textContent:"function"==typeof e&&(e=e.toString(),e=(/\/\*([\S\s]+)\*\//m.exec(e)||["","Function given as SQL. Plese Provide SQL string or have a /* ... */ syle comment with SQL in the function."])[1]),s.exec(e,t,r,n))};function i(){return null}s.version="0.5.5",s.debug=void 0;var u=function(){function e(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r}var t=[2,13],r=[1,104],n=[1,102],a=[1,103],i=[1,6],o=[1,42],u=[1,79],c=[1,76],l=[1,94],h=[1,93],d=[1,69],f=[1,101],p=[1,85],b=[1,64],E=[1,71],m=[1,84],v=[1,66],S=[1,70],T=[1,68],A=[1,61],y=[1,74],N=[1,62],C=[1,67],R=[1,83],O=[1,77],w=[1,86],I=[1,87],x=[1,81],D=[1,82],k=[1,80],L=[1,88],$=[1,89],M=[1,90],U=[1,91],_=[1,92],F=[1,98],P=[1,65],q=[1,78],G=[1,72],V=[1,96],B=[1,97],j=[1,63],H=[1,73],J=[1,108],Y=[1,107],W=[10,306,602,764],X=[10,306,310,602,764],K=[1,115],Q=[1,116],z=[1,117],Z=[1,118],ee=[1,119],te=[130,353,410],re=[1,127],ne=[1,126],ae=[1,134],se=[1,164],ie=[1,175],oe=[1,178],ue=[1,173],ce=[1,181],le=[1,185],he=[1,160],de=[1,182],fe=[1,169],pe=[1,171],be=[1,174],Ee=[1,183],ge=[1,166],me=[1,193],ve=[1,188],Se=[1,189],Te=[1,194],Ae=[1,195],ye=[1,196],Ne=[1,197],Ce=[1,198],Re=[1,199],Oe=[1,200],we=[1,201],Ie=[1,202],xe=[1,176],De=[1,177],ke=[1,179],Le=[1,180],$e=[1,186],Me=[1,192],Ue=[1,184],_e=[1,187],Fe=[1,172],Pe=[1,170],qe=[1,191],Ge=[1,203],Ve=[2,4,5],Be=[2,471],je=[1,206],He=[1,211],Je=[1,220],Ye=[1,216],We=[10,72,78,93,98,118,128,162,168,169,183,198,232,245,247,306,310,602,764],Xe=[2,4,5,10,72,76,77,78,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,183,185,187,198,280,281,282,283,284,285,286,287,288,306,310,420,424,602,764],Ke=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Qe=[1,249],ze=[1,256],Ze=[1,265],et=[1,270],tt=[1,269],rt=[2,4,5,10,72,77,78,93,98,107,118,128,131,132,137,143,145,149,152,154,156,162,168,169,179,180,181,183,198,232,245,247,265,266,270,271,273,280,281,282,283,284,285,286,287,288,290,291,292,293,294,295,296,297,298,299,302,303,306,310,312,317,420,424,602,764],nt=[2,162],at=[1,281],st=[10,74,78,306,310,505,602,764],it=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,193,198,206,208,222,223,224,225,226,227,228,229,230,231,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,302,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,344,356,368,369,370,373,374,386,389,396,400,401,402,403,404,405,406,408,409,417,418,420,424,426,433,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,514,515,516,517,602,764],ot=[2,4,5,10,53,72,89,124,146,156,189,266,267,290,306,335,338,339,396,400,401,404,406,408,409,417,418,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,517,602,764],ut=[1,562],ct=[1,564],lt=[2,503],ht=[1,569],dt=[1,580],ft=[1,583],pt=[1,584],bt=[10,78,89,132,137,146,189,296,306,310,470,602,764],Et=[10,74,306,310,602,764],gt=[2,567],mt=[1,602],vt=[2,4,5,156],St=[1,640],Tt=[1,612],At=[1,646],yt=[1,647],Nt=[1,620],Ct=[1,631],Rt=[1,618],Ot=[1,626],wt=[1,619],It=[1,627],xt=[1,629],Dt=[1,621],kt=[1,622],Lt=[1,641],$t=[1,638],Mt=[1,639],Ut=[1,615],_t=[1,617],Ft=[1,609],Pt=[1,610],qt=[1,611],Gt=[1,613],Vt=[1,614],Bt=[1,616],jt=[1,623],Ht=[1,624],Jt=[1,628],Yt=[1,630],Wt=[1,632],Xt=[1,633],Kt=[1,634],Qt=[1,635],zt=[1,636],Zt=[1,642],er=[1,643],tr=[1,644],rr=[1,645],nr=[2,287],ar=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,231,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],sr=[2,359],ir=[1,668],or=[1,678],ur=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,231,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],cr=[1,694],lr=[1,703],hr=[1,702],dr=[2,4,5,10,72,74,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],fr=[10,72,74,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],pr=[2,202],br=[1,725],Er=[10,72,78,93,98,118,128,162,168,169,183,232,245,247,306,310,602,764],gr=[2,163],mr=[1,728],vr=[2,4,5,112],Sr=[1,741],Tr=[1,760],Ar=[1,740],yr=[1,739],Nr=[1,734],Cr=[1,735],Rr=[1,737],Or=[1,738],wr=[1,742],Ir=[1,743],xr=[1,744],Dr=[1,745],kr=[1,746],Lr=[1,747],$r=[1,748],Mr=[1,749],Ur=[1,750],_r=[1,751],Fr=[1,752],Pr=[1,753],qr=[1,754],Gr=[1,755],Vr=[1,756],Br=[1,757],jr=[1,759],Hr=[1,761],Jr=[1,762],Yr=[1,763],Wr=[1,764],Xr=[1,765],Kr=[1,766],Qr=[1,767],zr=[1,770],Zr=[1,771],en=[1,772],tn=[1,773],rn=[1,774],nn=[1,775],an=[1,776],sn=[1,777],on=[1,778],un=[1,779],cn=[1,780],ln=[1,781],hn=[74,89,189],dn=[10,74,78,154,187,230,297,306,310,343,356,368,369,373,374,602,764],fn=[1,798],pn=[10,74,78,300,306,310,602,764],bn=[1,799],En=[1,805],gn=[1,806],mn=[1,810],vn=[10,74,78,306,310,602,764],Sn=[2,4,5,77,131,132,137,143,145,149,152,154,156,179,180,181,265,266,270,271,273,280,281,282,283,284,285,286,287,288,290,291,292,293,294,295,296,297,298,299,302,303,312,317,420,424],Tn=[10,72,78,93,98,107,118,128,162,168,169,183,198,232,245,247,306,310,602,764],An=[2,4,5,10,72,77,78,93,98,107,118,128,131,132,137,143,145,149,152,154,156,162,164,168,169,179,180,181,183,185,187,195,198,232,245,247,265,266,270,271,273,280,281,282,283,284,285,286,287,288,290,291,292,293,294,295,296,297,298,299,302,303,306,310,312,317,420,424,602,764],yn=[2,4,5,132,296],Nn=[1,844],Cn=[10,74,76,78,306,310,602,764],Rn=[2,738],On=[10,74,76,78,132,139,141,145,152,306,310,420,424,602,764],wn=[2,1161],In=[10,74,76,78,139,141,145,152,306,310,420,424,602,764],xn=[10,74,76,78,139,141,145,306,310,420,424,602,764],Dn=[10,74,78,139,141,306,310,602,764],kn=[10,78,89,132,146,189,296,306,310,470,602,764],Ln=[335,338,339],$n=[2,764],Mn=[1,869],Un=[1,870],_n=[1,871],Fn=[1,872],Pn=[1,881],qn=[1,880],Gn=[164,166,334],Vn=[2,444],Bn=[1,936],jn=[2,4,5,77,131,156,290,291,292,293],Hn=[1,951],Jn=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,124,128,129,130,131,132,134,135,137,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,314,315,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Yn=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Wn=[2,375],Xn=[1,958],Kn=[306,308,310],Qn=[74,300],zn=[74,300,426],Zn=[1,965],ea=[2,4,5,10,53,72,74,76,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],ta=[74,426],ra=[1,978],na=[1,977],aa=[1,984],sa=[10,72,78,93,98,118,128,162,168,169,232,245,247,306,310,602,764],ia=[1,1010],oa=[10,72,78,306,310,602,764],ua=[1,1016],ca=[1,1017],la=[1,1018],ha=[2,4,5,10,72,74,76,77,78,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,198,280,281,282,283,284,285,286,287,288,306,310,420,424,602,764],da=[1,1068],fa=[1,1067],pa=[1,1081],ba=[1,1080],Ea=[1,1088],ga=[10,72,74,78,93,98,107,118,128,162,168,169,183,198,232,245,247,306,310,602,764],ma=[1,1119],va=[10,78,89,146,189,306,310,470,602,764],Sa=[1,1139],Ta=[1,1138],Aa=[1,1137],ya=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Na=[1,1153],Ca=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,314,315,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Ra=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,315,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Oa=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,124,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,314,315,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],wa=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,124,128,129,130,131,132,134,135,137,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,314,315,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],Ia=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,314,320,321,322,323,324,325,326,330,331,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],xa=[2,406],Da=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,107,118,122,128,129,130,131,132,134,135,137,143,145,146,148,149,150,152,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,314,330,331,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],ka=[2,285],La=[2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],$a=[10,78,306,310,602,764],Ma=[1,1189],Ua=[10,77,78,143,145,152,181,302,306,310,420,424,602,764],_a=[10,74,78,306,308,310,464,602,764],Fa=[1,1200],Pa=[10,72,78,118,128,162,168,169,232,245,247,306,310,602,764],qa=[10,72,74,78,93,98,118,128,162,168,169,183,198,232,245,247,306,310,602,764],Ga=[2,4,5,72,76,77,78,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,185,187,280,281,282,283,284,285,286,287,288,420,424],Va=[2,4,5,72,74,76,77,78,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,185,187,280,281,282,283,284,285,286,287,288,420,424],Ba=[2,1085],ja=[2,4,5,72,74,76,77,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,185,187,280,281,282,283,284,285,286,287,288,420,424],Ha=[1,1252],Ja=[10,74,78,128,306,308,310,464,602,764],Ya=[115,116,124],Wa=[2,584],Xa=[1,1280],Ka=[76,139],Qa=[2,724],za=[1,1297],Za=[1,1298],es=[2,4,5,10,53,72,76,89,124,146,156,189,230,266,267,290,306,310,335,338,339,396,400,401,404,406,408,409,417,418,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,517,602,764],ts=[2,330],rs=[1,1322],ns=[1,1336],as=[1,1338],ss=[2,487],is=[74,78],os=[10,306,308,310,464,602,764],us=[10,72,78,118,162,168,169,232,245,247,306,310,602,764],cs=[1,1354],ls=[1,1358],hs=[1,1359],ds=[1,1361],fs=[1,1362],ps=[1,1363],bs=[1,1364],Es=[1,1365],gs=[1,1366],ms=[1,1367],vs=[1,1368],Ss=[10,72,74,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,232,245,247,306,310,602,764],Ts=[1,1393],As=[10,72,78,118,162,168,169,245,247,306,310,602,764],ys=[10,72,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,232,245,247,306,310,602,764],Ns=[1,1490],Cs=[1,1492],Rs=[2,4,5,77,143,145,152,156,181,290,291,292,293,302,420,424],Os=[1,1506],ws=[10,72,74,78,162,168,169,245,247,306,310,602,764],Is=[1,1524],xs=[1,1526],Ds=[1,1527],ks=[1,1523],Ls=[1,1522],$s=[1,1521],Ms=[1,1528],Us=[1,1518],_s=[1,1519],Fs=[1,1520],Ps=[1,1545],qs=[2,4,5,10,53,72,89,124,146,156,189,266,267,290,306,310,335,338,339,396,400,401,404,406,408,409,417,418,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,517,602,764],Gs=[1,1556],Vs=[1,1564],Bs=[1,1563],js=[10,72,78,162,168,169,245,247,306,310,602,764],Hs=[10,72,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],Js=[2,4,5,10,72,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],Ys=[1,1621],Ws=[1,1623],Xs=[1,1620],Ks=[1,1622],Qs=[187,193,368,369,370,373],zs=[2,515],Zs=[1,1628],ei=[1,1647],ti=[10,72,78,162,168,169,306,310,602,764],ri=[1,1657],ni=[1,1658],ai=[1,1659],si=[1,1678],ii=[4,10,243,306,310,343,356,602,764],oi=[1,1726],ui=[10,72,74,78,118,162,168,169,239,245,247,306,310,602,764],ci=[2,4,5,77],li=[1,1820],hi=[1,1832],di=[1,1851],fi=[10,72,78,162,168,169,306,310,415,602,764],pi=[10,74,78,230,306,310,602,764],bi={trace:function(){},yy:{},symbols_:{error:2,Literal:3,LITERAL:4,BRALITERAL:5,NonReserved:6,LiteralWithSpaces:7,main:8,Statements:9,EOF:10,Statements_group0:11,AStatement:12,ExplainStatement:13,EXPLAIN:14,QUERY:15,PLAN:16,Statement:17,AlterTable:18,AttachDatabase:19,Call:20,CreateDatabase:21,CreateIndex:22,CreateGraph:23,CreateTable:24,CreateView:25,CreateEdge:26,CreateVertex:27,Declare:28,Delete:29,DetachDatabase:30,DropDatabase:31,DropIndex:32,DropTable:33,DropView:34,If:35,Insert:36,Merge:37,Reindex:38,RenameTable:39,Select:40,ShowCreateTable:41,ShowColumns:42,ShowDatabases:43,ShowIndex:44,ShowTables:45,TruncateTable:46,WithSelect:47,CreateTrigger:48,DropTrigger:49,BeginTransaction:50,CommitTransaction:51,RollbackTransaction:52,EndTransaction:53,UseDatabase:54,Update:55,JavaScript:56,Source:57,Assert:58,While:59,Continue:60,Break:61,BeginEnd:62,Print:63,Require:64,SetVariable:65,ExpressionStatement:66,AddRule:67,Query:68,Echo:69,CreateFunction:70,CreateAggregate:71,WITH:72,WithTablesList:73,COMMA:74,WithTable:75,AS:76,LPAR:77,RPAR:78,SelectClause:79,Select_option0:80,IntoClause:81,FromClause:82,Select_option1:83,WhereClause:84,GroupClause:85,OrderClause:86,LimitClause:87,UnionClause:88,SEARCH:89,Select_repetition0:90,Select_option2:91,PivotClause:92,PIVOT:93,Expression:94,FOR:95,PivotClause_option0:96,PivotClause_option1:97,UNPIVOT:98,IN:99,ColumnsList:100,PivotClause_option2:101,PivotClause2:102,AsList:103,AsLiteral:104,AsPart:105,RemoveClause:106,REMOVE:107,RemoveClause_option0:108,RemoveColumnsList:109,RemoveColumn:110,Column:111,LIKE:112,StringValue:113,ArrowDot:114,ARROW:115,DOT:116,SearchSelector:117,ORDER:118,BY:119,OrderExpressionsList:120,SearchSelector_option0:121,DOTDOT:122,CARET:123,EQ:124,SearchSelector_repetition_plus0:125,SearchSelector_repetition_plus1:126,SearchSelector_option1:127,WHERE:128,OF:129,CLASS:130,NUMBER:131,STRING:132,SLASH:133,VERTEX:134,EDGE:135,EXCLAMATION:136,SHARP:137,MODULO:138,GT:139,LT:140,GTGT:141,LTLT:142,DOLLAR:143,Json:144,AT:145,SET:146,SetColumnsList:147,TO:148,VALUE:149,ROW:150,ExprList:151,COLON:152,PlusStar:153,NOT:154,SearchSelector_repetition2:155,IF:156,SearchSelector_repetition3:157,Aggregator:158,SearchSelector_repetition4:159,SearchSelector_group0:160,SearchSelector_repetition5:161,UNION:162,SearchSelectorList:163,ALL:164,SearchSelector_repetition6:165,ANY:166,SearchSelector_repetition7:167,INTERSECT:168,EXCEPT:169,AND:170,OR:171,PATH:172,RETURN:173,ResultColumns:174,REPEAT:175,SearchSelector_repetition8:176,SearchSelectorList_repetition0:177,SearchSelectorList_repetition1:178,PLUS:179,STAR:180,QUESTION:181,SearchFrom:182,FROM:183,SelectModifier:184,DISTINCT:185,TopClause:186,UNIQUE:187,SelectClause_option0:188,SELECT:189,COLUMN:190,MATRIX:191,TEXTSTRING:192,INDEX:193,RECORDSET:194,TOP:195,NumValue:196,TopClause_option0:197,INTO:198,Table:199,FuncValue:200,ParamValue:201,VarValue:202,FromTablesList:203,JoinTablesList:204,ApplyClause:205,CROSS:206,APPLY:207,OUTER:208,FromTable:209,FromTable_option0:210,FromTable_option1:211,INDEXED:212,INSERTED:213,FromString:214,JoinTable:215,JoinMode:216,JoinTableAs:217,OnClause:218,JoinTableAs_option0:219,JoinTableAs_option1:220,JoinModeMode:221,NATURAL:222,JOIN:223,INNER:224,LEFT:225,RIGHT:226,FULL:227,SEMI:228,ANTI:229,ON:230,USING:231,GROUP:232,GroupExpressionsList:233,HavingClause:234,GroupExpression:235,GROUPING:236,ROLLUP:237,CUBE:238,HAVING:239,CORRESPONDING:240,OrderExpression:241,DIRECTION:242,COLLATE:243,NOCASE:244,LIMIT:245,OffsetClause:246,OFFSET:247,LimitClause_option0:248,FETCH:249,LimitClause_option1:250,LimitClause_option2:251,LimitClause_option3:252,ResultColumn:253,Star:254,AggrValue:255,Op:256,LogicValue:257,NullValue:258,ExistsValue:259,CaseValue:260,CastClause:261,ArrayValue:262,NewClause:263,Expression_group0:264,CURRENT_TIMESTAMP:265,JAVASCRIPT:266,CREATE:267,FUNCTION:268,AGGREGATE:269,NEW:270,CAST:271,ColumnType:272,CONVERT:273,PrimitiveValue:274,OverClause:275,OVER:276,OverPartitionClause:277,OverOrderByClause:278,PARTITION:279,SUM:280,COUNT:281,MIN:282,MAX:283,AVG:284,FIRST:285,LAST:286,AGGR:287,ARRAY:288,FuncValue_option0:289,REPLACE:290,DATEADD:291,DATEDIFF:292,INTERVAL:293,TRUE:294,FALSE:295,NSTRING:296,NULL:297,EXISTS:298,ARRAYLBRA:299,RBRA:300,ParamValue_group0:301,BRAQUESTION:302,CASE:303,WhensList:304,ElseClause:305,END:306,When:307,WHEN:308,THEN:309,ELSE:310,REGEXP:311,TILDA:312,GLOB:313,ESCAPE:314,NOT_LIKE:315,BARBAR:316,MINUS:317,AMPERSAND:318,BAR:319,GE:320,LE:321,EQEQ:322,EQEQEQ:323,NE:324,NEEQEQ:325,NEEQEQEQ:326,CondOp:327,AllSome:328,ColFunc:329,BETWEEN:330,NOT_BETWEEN:331,IS:332,DOUBLECOLON:333,SOME:334,UPDATE:335,SetColumn:336,SetColumn_group0:337,DELETE:338,INSERT:339,Into:340,Values:341,ValuesListsList:342,DEFAULT:343,VALUES:344,ValuesList:345,Value:346,DateValue:347,TemporaryClause:348,TableClass:349,IfNotExists:350,CreateTableDefClause:351,CreateTableOptionsClause:352,TABLE:353,CreateTableOptions:354,CreateTableOption:355,IDENTITY:356,TEMP:357,ColumnDefsList:358,ConstraintsList:359,Constraint:360,ConstraintName:361,PrimaryKey:362,ForeignKey:363,UniqueKey:364,IndexKey:365,Check:366,CONSTRAINT:367,CHECK:368,PRIMARY:369,KEY:370,PrimaryKey_option0:371,ColsList:372,FOREIGN:373,REFERENCES:374,ForeignKey_option0:375,OnForeignKeyClause:376,ParColsList:377,OnDeleteClause:378,OnUpdateClause:379,NO:380,ACTION:381,UniqueKey_option0:382,UniqueKey_option1:383,ColumnDef:384,ColumnConstraintsClause:385,ColumnConstraints:386,SingularColumnType:387,NumberMax:388,ENUM:389,MAXNUM:390,ColumnConstraintsList:391,ColumnConstraint:392,ParLiteral:393,ColumnConstraint_option0:394,ColumnConstraint_option1:395,DROP:396,DropTable_group0:397,IfExists:398,TablesList:399,ALTER:400,RENAME:401,ADD:402,MODIFY:403,ATTACH:404,DATABASE:405,DETACH:406,AsClause:407,USE:408,SHOW:409,VIEW:410,CreateView_option0:411,CreateView_option1:412,SubqueryRestriction:413,READ:414,ONLY:415,OPTION:416,SOURCE:417,ASSERT:418,JsonObject:419,ATLBRA:420,JsonArray:421,JsonValue:422,JsonPrimitiveValue:423,LCUR:424,JsonPropertiesList:425,RCUR:426,JsonElementsList:427,JsonProperty:428,OnOff:429,SetPropsList:430,AtDollar:431,SetProp:432,OFF:433,COMMIT:434,TRANSACTION:435,ROLLBACK:436,BEGIN:437,ElseStatement:438,WHILE:439,CONTINUE:440,BREAK:441,PRINT:442,REQUIRE:443,StringValuesList:444,PluginsList:445,Plugin:446,ECHO:447,DECLARE:448,DeclaresList:449,DeclareItem:450,TRUNCATE:451,MERGE:452,MergeInto:453,MergeUsing:454,MergeOn:455,MergeMatchedList:456,OutputClause:457,MergeMatched:458,MergeNotMatched:459,MATCHED:460,MergeMatchedAction:461,MergeNotMatchedAction:462,TARGET:463,OUTPUT:464,CreateVertex_option0:465,CreateVertex_option1:466,CreateVertex_option2:467,CreateVertexSet:468,SharpValue:469,CONTENT:470,CreateEdge_option0:471,GRAPH:472,GraphList:473,GraphVertexEdge:474,GraphElement:475,GraphVertexEdge_option0:476,GraphVertexEdge_option1:477,GraphElementVar:478,GraphVertexEdge_option2:479,GraphVertexEdge_option3:480,GraphVertexEdge_option4:481,GraphVar:482,GraphAsClause:483,GraphAtClause:484,GraphElement2:485,GraphElement2_option0:486,GraphElement2_option1:487,GraphElement2_option2:488,GraphElement2_option3:489,GraphElement_option0:490,GraphElement_option1:491,GraphElement_option2:492,SharpLiteral:493,GraphElement_option3:494,GraphElement_option4:495,GraphElement_option5:496,ColonLiteral:497,DeleteVertex:498,DeleteVertex_option0:499,DeleteEdge:500,DeleteEdge_option0:501,DeleteEdge_option1:502,DeleteEdge_option2:503,Term:504,COLONDASH:505,TermsList:506,QUESTIONDASH:507,CALL:508,TRIGGER:509,BeforeAfter:510,InsertDeleteUpdate:511,CreateTrigger_option0:512,CreateTrigger_option1:513,BEFORE:514,AFTER:515,INSTEAD:516,REINDEX:517,A:518,ABSENT:519,ABSOLUTE:520,ACCORDING:521,ADA:522,ADMIN:523,ALWAYS:524,ASC:525,ASSERTION:526,ASSIGNMENT:527,ATTRIBUTE:528,ATTRIBUTES:529,BASE64:530,BERNOULLI:531,BLOCKED:532,BOM:533,BREADTH:534,C:535,CASCADE:536,CATALOG:537,CATALOG_NAME:538,CHAIN:539,CHARACTERISTICS:540,CHARACTERS:541,CHARACTER_SET_CATALOG:542,CHARACTER_SET_NAME:543,CHARACTER_SET_SCHEMA:544,CLASS_ORIGIN:545,COBOL:546,COLLATION:547,COLLATION_CATALOG:548,COLLATION_NAME:549,COLLATION_SCHEMA:550,COLUMNS:551,COLUMN_NAME:552,COMMAND_FUNCTION:553,COMMAND_FUNCTION_CODE:554,COMMITTED:555,CONDITION_NUMBER:556,CONNECTION:557,CONNECTION_NAME:558,CONSTRAINTS:559,CONSTRAINT_CATALOG:560,CONSTRAINT_NAME:561,CONSTRAINT_SCHEMA:562,CONSTRUCTOR:563,CONTROL:564,CURSOR_NAME:565,DATA:566,DATETIME_INTERVAL_CODE:567,DATETIME_INTERVAL_PRECISION:568,DB:569,DEFAULTS:570,DEFERRABLE:571,DEFERRED:572,DEFINED:573,DEFINER:574,DEGREE:575,DEPTH:576,DERIVED:577,DESC:578,DESCRIPTOR:579,DIAGNOSTICS:580,DISPATCH:581,DOCUMENT:582,DOMAIN:583,DYNAMIC_FUNCTION:584,DYNAMIC_FUNCTION_CODE:585,EMPTY:586,ENCODING:587,ENFORCED:588,EXCLUDE:589,EXCLUDING:590,EXPRESSION:591,FILE:592,FINAL:593,FLAG:594,FOLLOWING:595,FORTRAN:596,FOUND:597,FS:598,G:599,GENERAL:600,GENERATED:601,GO:602,GOTO:603,GRANTED:604,HEX:605,HIERARCHY:606,ID:607,IGNORE:608,IMMEDIATE:609,IMMEDIATELY:610,IMPLEMENTATION:611,INCLUDING:612,INCREMENT:613,INDENT:614,INITIALLY:615,INPUT:616,INSTANCE:617,INSTANTIABLE:618,INTEGRITY:619,INVOKER:620,ISOLATION:621,K:622,KEY_MEMBER:623,KEY_TYPE:624,LENGTH:625,LEVEL:626,LIBRARY:627,LINK:628,LOCATION:629,LOCATOR:630,M:631,MAP:632,MAPPING:633,MAXVALUE:634,MESSAGE_LENGTH:635,MESSAGE_OCTET_LENGTH:636,MESSAGE_TEXT:637,MINVALUE:638,MORE:639,MUMPS:640,NAME:641,NAMES:642,NAMESPACE:643,NESTING:644,NEXT:645,NFC:646,NFD:647,NFKC:648,NFKD:649,NIL:650,NORMALIZED:651,NULLABLE:652,NULLS:653,OBJECT:654,OCTETS:655,OPTIONS:656,ORDERING:657,ORDINALITY:658,OTHERS:659,OVERRIDING:660,P:661,PAD:662,PARAMETER_MODE:663,PARAMETER_NAME:664,PARAMETER_ORDINAL_POSITION:665,PARAMETER_SPECIFIC_CATALOG:666,PARAMETER_SPECIFIC_NAME:667,PARAMETER_SPECIFIC_SCHEMA:668,PARTIAL:669,PASCAL:670,PASSING:671,PASSTHROUGH:672,PERMISSION:673,PLACING:674,PLI:675,PRECEDING:676,PRESERVE:677,PRIOR:678,PRIVILEGES:679,PUBLIC:680,RECOVERY:681,RELATIVE:682,REPEATABLE:683,REQUIRING:684,RESPECT:685,RESTART:686,RESTORE:687,RESTRICT:688,RETURNED_CARDINALITY:689,RETURNED_LENGTH:690,RETURNED_OCTET_LENGTH:691,RETURNED_SQLSTATE:692,RETURNING:693,ROLE:694,ROUTINE:695,ROUTINE_CATALOG:696,ROUTINE_NAME:697,ROUTINE_SCHEMA:698,ROW_COUNT:699,SCALE:700,SCHEMA:701,SCHEMA_NAME:702,SCOPE_CATALOG:703,SCOPE_NAME:704,SCOPE_SCHEMA:705,SECTION:706,SECURITY:707,SELECTIVE:708,SELF:709,SEQUENCE:710,SERIALIZABLE:711,SERVER:712,SERVER_NAME:713,SESSION:714,SETS:715,SIMPLE:716,SIZE:717,SPACE:718,SPECIFIC_NAME:719,STANDALONE:720,STATE:721,STATEMENT:722,STRIP:723,STRUCTURE:724,STYLE:725,SUBCLASS_ORIGIN:726,T:727,TABLE_NAME:728,TEMPORARY:729,TIES:730,TOKEN:731,TOP_LEVEL_COUNT:732,TRANSACTIONS_COMMITTED:733,TRANSACTIONS_ROLLED_BACK:734,TRANSACTION_ACTIVE:735,TRANSFORM:736,TRANSFORMS:737,TRIGGER_CATALOG:738,TRIGGER_NAME:739,TRIGGER_SCHEMA:740,TYPE:741,UNBOUNDED:742,UNCOMMITTED:743,UNDER:744,UNLINK:745,UNNAMED:746,UNTYPED:747,URI:748,USAGE:749,USER_DEFINED_TYPE_CATALOG:750,USER_DEFINED_TYPE_CODE:751,USER_DEFINED_TYPE_NAME:752,USER_DEFINED_TYPE_SCHEMA:753,VALID:754,VERSION:755,WHITESPACE:756,WORK:757,WRAPPER:758,WRITE:759,XMLDECLARATION:760,XMLSCHEMA:761,YES:762,ZONE:763,SEMICOLON:764,PERCENT:765,ROWS:766,FuncValue_option0_group0:767,$accept:0,$end:1},terminals_:{2:"error",4:"LITERAL",5:"BRALITERAL",10:"EOF",14:"EXPLAIN",15:"QUERY",16:"PLAN",53:"EndTransaction",72:"WITH",74:"COMMA",76:"AS",77:"LPAR",78:"RPAR",89:"SEARCH",93:"PIVOT",95:"FOR",98:"UNPIVOT",99:"IN",107:"REMOVE",112:"LIKE",115:"ARROW",116:"DOT",118:"ORDER",119:"BY",122:"DOTDOT",123:"CARET",124:"EQ",128:"WHERE",129:"OF",130:"CLASS",131:"NUMBER",132:"STRING",133:"SLASH",134:"VERTEX",135:"EDGE",136:"EXCLAMATION",137:"SHARP",138:"MODULO",139:"GT",140:"LT",141:"GTGT",142:"LTLT",143:"DOLLAR",145:"AT",146:"SET",148:"TO",149:"VALUE",150:"ROW",152:"COLON",154:"NOT",156:"IF",162:"UNION",164:"ALL",166:"ANY",168:"INTERSECT",169:"EXCEPT",170:"AND",171:"OR",172:"PATH",173:"RETURN",175:"REPEAT",179:"PLUS",180:"STAR",181:"QUESTION",183:"FROM",185:"DISTINCT",187:"UNIQUE",189:"SELECT",190:"COLUMN",191:"MATRIX",192:"TEXTSTRING",193:"INDEX",194:"RECORDSET",195:"TOP",198:"INTO",206:"CROSS",207:"APPLY",208:"OUTER",212:"INDEXED",213:"INSERTED",222:"NATURAL",223:"JOIN",224:"INNER",225:"LEFT",226:"RIGHT",227:"FULL",228:"SEMI",229:"ANTI",230:"ON",231:"USING",232:"GROUP",236:"GROUPING",237:"ROLLUP",238:"CUBE",239:"HAVING",240:"CORRESPONDING",242:"DIRECTION",243:"COLLATE",244:"NOCASE",245:"LIMIT",247:"OFFSET",249:"FETCH",265:"CURRENT_TIMESTAMP",266:"JAVASCRIPT",267:"CREATE",268:"FUNCTION",269:"AGGREGATE",270:"NEW",271:"CAST",273:"CONVERT",276:"OVER",279:"PARTITION",280:"SUM",281:"COUNT",282:"MIN",283:"MAX",284:"AVG",285:"FIRST",286:"LAST",287:"AGGR",288:"ARRAY",290:"REPLACE",291:"DATEADD",292:"DATEDIFF",293:"INTERVAL",294:"TRUE",295:"FALSE",296:"NSTRING",297:"NULL",298:"EXISTS",299:"ARRAYLBRA",300:"RBRA",302:"BRAQUESTION",303:"CASE",306:"END",308:"WHEN",309:"THEN",310:"ELSE",311:"REGEXP",312:"TILDA",313:"GLOB",314:"ESCAPE",315:"NOT_LIKE",316:"BARBAR",317:"MINUS",318:"AMPERSAND",319:"BAR",320:"GE",321:"LE",322:"EQEQ",323:"EQEQEQ",324:"NE",325:"NEEQEQ",326:"NEEQEQEQ",330:"BETWEEN",331:"NOT_BETWEEN",332:"IS",333:"DOUBLECOLON",334:"SOME",335:"UPDATE",338:"DELETE",339:"INSERT",343:"DEFAULT",344:"VALUES",347:"DateValue",353:"TABLE",356:"IDENTITY",357:"TEMP",367:"CONSTRAINT",368:"CHECK",369:"PRIMARY",370:"KEY",373:"FOREIGN",374:"REFERENCES",380:"NO",381:"ACTION",386:"ColumnConstraints",389:"ENUM",390:"MAXNUM",396:"DROP",400:"ALTER",401:"RENAME",402:"ADD",403:"MODIFY",404:"ATTACH",405:"DATABASE",406:"DETACH",408:"USE",409:"SHOW",410:"VIEW",414:"READ",415:"ONLY",416:"OPTION",417:"SOURCE",418:"ASSERT",420:"ATLBRA",424:"LCUR",426:"RCUR",433:"OFF",434:"COMMIT",435:"TRANSACTION",436:"ROLLBACK",437:"BEGIN",439:"WHILE",440:"CONTINUE",441:"BREAK",442:"PRINT",443:"REQUIRE",447:"ECHO",448:"DECLARE",451:"TRUNCATE",452:"MERGE",460:"MATCHED",463:"TARGET",464:"OUTPUT",470:"CONTENT",472:"GRAPH",505:"COLONDASH",507:"QUESTIONDASH",508:"CALL",509:"TRIGGER",514:"BEFORE",515:"AFTER",516:"INSTEAD",517:"REINDEX",518:"A",519:"ABSENT",520:"ABSOLUTE",521:"ACCORDING",522:"ADA",523:"ADMIN",524:"ALWAYS",525:"ASC",526:"ASSERTION",527:"ASSIGNMENT",528:"ATTRIBUTE",529:"ATTRIBUTES",530:"BASE64",531:"BERNOULLI",532:"BLOCKED",533:"BOM",534:"BREADTH",535:"C",536:"CASCADE",537:"CATALOG",538:"CATALOG_NAME",539:"CHAIN",540:"CHARACTERISTICS",541:"CHARACTERS",542:"CHARACTER_SET_CATALOG",543:"CHARACTER_SET_NAME",544:"CHARACTER_SET_SCHEMA",545:"CLASS_ORIGIN",546:"COBOL",547:"COLLATION",548:"COLLATION_CATALOG",549:"COLLATION_NAME",550:"COLLATION_SCHEMA",551:"COLUMNS",552:"COLUMN_NAME",553:"COMMAND_FUNCTION",554:"COMMAND_FUNCTION_CODE",555:"COMMITTED",556:"CONDITION_NUMBER",557:"CONNECTION",558:"CONNECTION_NAME",559:"CONSTRAINTS",560:"CONSTRAINT_CATALOG",561:"CONSTRAINT_NAME",562:"CONSTRAINT_SCHEMA",563:"CONSTRUCTOR",564:"CONTROL",565:"CURSOR_NAME",566:"DATA",567:"DATETIME_INTERVAL_CODE",568:"DATETIME_INTERVAL_PRECISION",569:"DB",570:"DEFAULTS",571:"DEFERRABLE",572:"DEFERRED",573:"DEFINED",574:"DEFINER",575:"DEGREE",576:"DEPTH",577:"DERIVED",578:"DESC",579:"DESCRIPTOR",580:"DIAGNOSTICS",581:"DISPATCH",582:"DOCUMENT",583:"DOMAIN",584:"DYNAMIC_FUNCTION",585:"DYNAMIC_FUNCTION_CODE",586:"EMPTY",587:"ENCODING",588:"ENFORCED",589:"EXCLUDE",590:"EXCLUDING",591:"EXPRESSION",592:"FILE",593:"FINAL",594:"FLAG",595:"FOLLOWING",596:"FORTRAN",597:"FOUND",598:"FS",599:"G",600:"GENERAL",601:"GENERATED",602:"GO",603:"GOTO",604:"GRANTED",605:"HEX",606:"HIERARCHY",607:"ID",608:"IGNORE",609:"IMMEDIATE",610:"IMMEDIATELY",611:"IMPLEMENTATION",612:"INCLUDING",613:"INCREMENT",614:"INDENT",615:"INITIALLY",616:"INPUT",617:"INSTANCE",618:"INSTANTIABLE",619:"INTEGRITY",620:"INVOKER",621:"ISOLATION",622:"K",623:"KEY_MEMBER",624:"KEY_TYPE",625:"LENGTH",626:"LEVEL",627:"LIBRARY",628:"LINK",629:"LOCATION",630:"LOCATOR",631:"M",632:"MAP",633:"MAPPING",634:"MAXVALUE",635:"MESSAGE_LENGTH",636:"MESSAGE_OCTET_LENGTH",637:"MESSAGE_TEXT",638:"MINVALUE",639:"MORE",640:"MUMPS",641:"NAME",642:"NAMES",643:"NAMESPACE",644:"NESTING",645:"NEXT",646:"NFC",647:"NFD",648:"NFKC",649:"NFKD",650:"NIL",651:"NORMALIZED",652:"NULLABLE",653:"NULLS",654:"OBJECT",655:"OCTETS",656:"OPTIONS",657:"ORDERING",658:"ORDINALITY",659:"OTHERS",660:"OVERRIDING",661:"P",662:"PAD",663:"PARAMETER_MODE",664:"PARAMETER_NAME",665:"PARAMETER_ORDINAL_POSITION",666:"PARAMETER_SPECIFIC_CATALOG",667:"PARAMETER_SPECIFIC_NAME",668:"PARAMETER_SPECIFIC_SCHEMA",669:"PARTIAL",670:"PASCAL",671:"PASSING",672:"PASSTHROUGH",673:"PERMISSION",674:"PLACING",675:"PLI",676:"PRECEDING",677:"PRESERVE",678:"PRIOR",679:"PRIVILEGES",680:"PUBLIC",681:"RECOVERY",682:"RELATIVE",683:"REPEATABLE",684:"REQUIRING",685:"RESPECT",686:"RESTART",687:"RESTORE",688:"RESTRICT",689:"RETURNED_CARDINALITY",690:"RETURNED_LENGTH",691:"RETURNED_OCTET_LENGTH",692:"RETURNED_SQLSTATE",693:"RETURNING",694:"ROLE",695:"ROUTINE",696:"ROUTINE_CATALOG",697:"ROUTINE_NAME",698:"ROUTINE_SCHEMA",699:"ROW_COUNT",700:"SCALE",701:"SCHEMA",702:"SCHEMA_NAME",703:"SCOPE_CATALOG",704:"SCOPE_NAME",705:"SCOPE_SCHEMA",706:"SECTION",707:"SECURITY",708:"SELECTIVE",709:"SELF",710:"SEQUENCE",711:"SERIALIZABLE",712:"SERVER",713:"SERVER_NAME",714:"SESSION",715:"SETS",716:"SIMPLE",717:"SIZE",718:"SPACE",719:"SPECIFIC_NAME",720:"STANDALONE",721:"STATE",722:"STATEMENT",723:"STRIP",724:"STRUCTURE",725:"STYLE",726:"SUBCLASS_ORIGIN",727:"T",728:"TABLE_NAME",729:"TEMPORARY",730:"TIES",731:"TOKEN",732:"TOP_LEVEL_COUNT",733:"TRANSACTIONS_COMMITTED",734:"TRANSACTIONS_ROLLED_BACK",735:"TRANSACTION_ACTIVE",736:"TRANSFORM",737:"TRANSFORMS",738:"TRIGGER_CATALOG",739:"TRIGGER_NAME",740:"TRIGGER_SCHEMA",741:"TYPE",742:"UNBOUNDED",743:"UNCOMMITTED",744:"UNDER",745:"UNLINK",746:"UNNAMED",747:"UNTYPED",748:"URI",749:"USAGE",750:"USER_DEFINED_TYPE_CATALOG",751:"USER_DEFINED_TYPE_CODE",752:"USER_DEFINED_TYPE_NAME",753:"USER_DEFINED_TYPE_SCHEMA",754:"VALID",755:"VERSION",756:"WHITESPACE",757:"WORK",758:"WRAPPER",759:"WRITE",760:"XMLDECLARATION",761:"XMLSCHEMA",762:"YES",763:"ZONE",764:"SEMICOLON",765:"PERCENT",766:"ROWS"},productions_:[0,[3,1],[3,1],[3,2],[7,1],[7,2],[8,2],[9,3],[9,1],[9,1],[13,2],[13,4],[12,1],[17,0],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[47,3],[73,3],[73,1],[75,5],[40,10],[40,4],[92,8],[92,11],[102,4],[104,2],[104,1],[103,3],[103,1],[105,1],[105,3],[106,3],[109,3],[109,1],[110,1],[110,2],[114,1],[114,1],[117,1],[117,5],[117,5],[117,1],[117,2],[117,1],[117,2],[117,2],[117,3],[117,4],[117,4],[117,4],[117,4],[117,4],[117,1],[117,1],[117,1],[117,1],[117,1],[117,1],[117,2],[117,2],[117,2],[117,1],[117,1],[117,1],[117,1],[117,1],[117,1],[117,2],[117,3],[117,4],[117,3],[117,1],[117,4],[117,2],[117,2],[117,4],[117,4],[117,4],[117,4],[117,4],[117,5],[117,4],[117,4],[117,4],[117,4],[117,4],[117,4],[117,4],[117,4],[117,6],[163,3],[163,1],[153,1],[153,1],[153,1],[182,2],[79,4],[79,4],[79,4],[79,3],[184,1],[184,2],[184,2],[184,2],[184,2],[184,2],[184,2],[184,2],[186,3],[186,4],[186,0],[81,0],[81,2],[81,2],[81,2],[81,2],[81,2],[82,2],[82,3],[82,5],[82,0],[205,6],[205,7],[205,6],[205,7],[203,1],[203,3],[209,4],[209,5],[209,3],[209,3],[209,2],[209,3],[209,1],[209,3],[209,2],[209,3],[209,1],[209,1],[209,2],[209,3],[209,1],[209,1],[209,2],[209,3],[209,1],[209,2],[209,3],[214,1],[199,3],[199,1],[204,2],[204,2],[204,1],[204,1],[215,3],[217,1],[217,2],[217,3],[217,3],[217,2],[217,3],[217,4],[217,5],[217,1],[217,2],[217,3],[217,1],[217,2],[217,3],[216,1],[216,2],[221,1],[221,2],[221,2],[221,3],[221,2],[221,3],[221,2],[221,3],[221,2],[221,2],[221,2],[218,2],[218,2],[218,0],[84,0],[84,2],[85,0],[85,4],[233,1],[233,3],[235,5],[235,4],[235,4],[235,1],[234,0],[234,2],[88,0],[88,2],[88,3],[88,2],[88,2],[88,3],[88,4],[88,3],[88,3],[86,0],[86,3],[120,1],[120,3],[241,1],[241,2],[241,3],[241,4],[87,0],[87,3],[87,8],[246,0],[246,2],[174,3],[174,1],[253,3],[253,2],[253,3],[253,2],[253,3],[253,2],[253,1],[254,5],[254,3],[254,1],[111,5],[111,3],[111,3],[111,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,1],[94,3],[94,3],[94,3],[94,1],[94,1],[56,1],[70,5],[71,5],[263,2],[263,2],[261,6],[261,8],[261,6],[261,8],[274,1],[274,1],[274,1],[274,1],[274,1],[274,1],[274,1],[255,5],[255,6],[255,6],[275,0],[275,4],[275,4],[275,5],[277,3],[278,3],[158,1],[158,1],[158,1],[158,1],[158,1],[158,1],[158,1],[158,1],[158,1],[200,5],[200,3],[200,4],[200,4],[200,8],[200,8],[200,8],[200,8],[200,3],[151,1],[151,3],[196,1],[257,1],[257,1],[113,1],[113,1],[258,1],[202,2],[259,4],[262,3],[201,2],[201,2],[201,1],[201,1],[260,5],[260,4],[304,2],[304,1],[307,4],[305,2],[305,0],[256,3],[256,3],[256,3],[256,3],[256,5],[256,3],[256,5],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,5],[256,3],[256,3],[256,3],[256,5],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,3],[256,6],[256,6],[256,3],[256,3],[256,2],[256,2],[256,2],[256,2],[256,2],[256,3],[256,5],[256,6],[256,5],[256,6],[256,4],[256,5],[256,3],[256,4],[256,3],[256,4],[256,3],[256,3],[256,3],[256,3],[256,3],[329,1],[329,1],[329,4],[327,1],[327,1],[327,1],[327,1],[327,1],[327,1],[328,1],[328,1],[328,1],[55,6],[55,4],[147,1],[147,3],[336,3],[336,4],[29,5],[29,3],[36,5],[36,4],[36,7],[36,6],[36,5],[36,4],[36,5],[36,8],[36,7],[36,4],[36,6],[36,7],[341,1],[341,1],[340,0],[340,1],[342,3],[342,1],[342,1],[342,5],[342,3],[342,3],[345,1],[345,3],[346,1],[346,1],[346,1],[346,1],[346,1],[346,1],[100,1],[100,3],[24,9],[24,5],[349,1],[349,1],[352,0],[352,1],[354,2],[354,1],[355,1],[355,3],[355,3],[355,3],[348,0],[348,1],[350,0],[350,3],[351,3],[351,1],[351,2],[359,1],[359,3],[360,2],[360,2],[360,2],[360,2],[360,2],[361,0],[361,2],[366,4],[362,6],[363,9],[377,3],[376,0],[376,2],[378,4],[379,4],[364,6],[365,5],[365,5],[372,1],[372,1],[372,3],[372,3],[358,1],[358,3],[384,3],[384,2],[384,1],[387,6],[387,4],[387,1],[387,4],[272,2],[272,1],[388,1],[388,1],[385,0],[385,1],[391,2],[391,1],[393,3],[392,2],[392,5],[392,3],[392,6],[392,1],[392,2],[392,4],[392,2],[392,1],[392,2],[392,1],[392,1],[392,3],[392,5],[33,4],[399,3],[399,1],[398,0],[398,2],[18,6],[18,6],[18,6],[18,8],[18,6],[39,5],[19,4],[19,7],[19,6],[19,9],[30,3],[21,4],[21,6],[21,9],[21,6],[407,0],[407,2],[54,3],[54,2],[31,4],[31,5],[31,5],[22,8],[22,9],[32,3],[43,2],[43,4],[43,3],[43,5],[45,2],[45,4],[45,4],[45,6],[42,4],[42,6],[44,4],[44,6],[41,4],[41,6],[25,11],[25,8],[413,3],[413,3],[413,5],[34,4],[66,2],[57,2],[58,2],[58,2],[58,4],[144,4],[144,2],[144,2],[144,2],[144,2],[144,1],[144,2],[144,2],[422,1],[422,1],[423,1],[423,1],[423,1],[423,1],[423,1],[423,1],[423,1],[423,3],[419,3],[419,4],[419,2],[421,2],[421,3],[421,1],[425,3],[425,1],[428,3],[428,3],[428,3],[427,3],[427,1],[65,4],[65,3],[65,4],[65,5],[65,5],[65,6],[431,1],[431,1],[430,3],[430,2],[432,1],[432,1],[432,3],[429,1],[429,1],[51,2],[52,2],[50,2],[35,4],[35,3],[438,2],[59,3],[60,1],[61,1],[62,3],[63,2],[63,2],[64,2],[64,2],[446,1],[446,1],[69,2],[444,3],[444,1],[445,3],[445,1],[28,2],[449,1],[449,3],[450,3],[450,4],[450,5],[450,6],[46,3],[37,6],[453,1],[453,2],[454,2],[455,2],[456,2],[456,2],[456,1],[456,1],[458,4],[458,6],[461,1],[461,3],[459,5],[459,7],[459,7],[459,9],[459,7],[459,9],[462,3],[462,6],[462,3],[462,6],[457,0],[457,2],[457,5],[457,4],[457,7],[27,6],[469,2],[468,0],[468,2],[468,2],[468,1],[26,8],[23,3],[23,4],[473,3],[473,1],[474,3],[474,7],[474,6],[474,3],[474,4],[478,1],[478,1],[482,2],[483,3],[484,2],[485,4],[475,4],[475,3],[475,2],[475,1],[497,2],[493,2],[493,2],[498,4],[500,6],[67,3],[67,2],[506,3],[506,1],[504,1],[504,4],[68,2],[20,2],[48,9],[48,8],[48,9],[510,0],[510,1],[510,1],[510,1],[510,2],[511,1],[511,1],[511,1],[49,3],[38,2],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[11,1],[11,1],[80,0],[80,1],[83,0],[83,1],[90,0],[90,2],[91,0],[91,1],[96,0],[96,1],[97,0],[97,1],[101,0],[101,1],[108,0],[108,1],[121,0],[121,1],[125,1],[125,2],[126,1],[126,2],[127,0],[127,1],[155,0],[155,2],[157,0],[157,2],[159,0],[159,2],[160,1],[160,1],[161,0],[161,2],[165,0],[165,2],[167,0],[167,2],[176,0],[176,2],[177,0],[177,2],[178,0],[178,2],[188,0],[188,1],[197,0],[197,1],[210,0],[210,1],[211,0],[211,1],[219,0],[219,1],[220,0],[220,1],[248,0],[248,1],[250,0],[250,1],[251,0],[251,1],[252,0],[252,1],[264,1],[264,1],[767,1],[767,1],[289,0],[289,1],[301,1],[301,1],[337,1],[337,1],[371,0],[371,1],[375,0],[375,1],[382,0],[382,1],[383,0],[383,1],[394,0],[394,1],[395,0],[395,1],[397,1],[397,1],[411,0],[411,1],[412,0],[412,1],[465,0],[465,1],[466,0],[466,1],[467,0],[467,1],[471,0],[471,1],[476,0],[476,1],[477,0],[477,1],[479,0],[479,1],[480,0],[480,1],[481,0],[481,1],[486,0],[486,1],[487,0],[487,1],[488,0],[488,1],[489,0],[489,1],[490,0],[490,1],[491,0],[491,1],[492,0],[492,1],[494,0],[494,1],[495,0],[495,1],[496,0],[496,1],[499,0],[499,2],[501,0],[501,2],[502,0],[502,2],[503,0],[503,2],[512,0],[512,1],[513,0],[513,1]],performAction:function(e,t,r,n,a,i,o){var u=i.length-1;switch(a){case 1:s.options.casesensitive?this.$=i[u]:this.$=i[u].toLowerCase();break;case 2:this.$=g(i[u].substr(1,i[u].length-2));break;case 3:this.$=i[u].toLowerCase();break;case 4:this.$=i[u];break;case 5:this.$=i[u]?i[u-1]+" "+i[u]:i[u-1];break;case 6:return new n.Statements({statements:i[u-1]});case 7:this.$=i[u-2],i[u]&&i[u-2].push(i[u]);break;case 8:case 9:case 70:case 80:case 85:case 143:case 177:case 205:case 206:case 242:case 261:case 273:case 354:case 372:case 451:case 474:case 475:case 479:case 487:case 528:case 529:case 566:case 649:case 659:case 683:case 685:case 687:case 701:case 702:case 732:case 756:this.$=[i[u]];break;case 10:case 11:this.$=i[u],i[u].explain=!0;break;case 12:this.$=i[u],n.exists&&(this.$.exists=n.exists),delete n.exists,n.queries&&(this.$.queries=n.queries),delete n.queries;break;case 13:case 162:case 172:case 237:case 238:case 240:case 248:case 250:case 259:case 267:case 270:case 375:case 491:case 501:case 503:case 515:case 521:case 522:case 567:this.$=void 0;break;case 68:this.$=new n.WithSelect({withs:i[u-1],select:i[u]});break;case 69:case 565:i[u-2].push(i[u]),this.$=i[u-2];break;case 71:this.$={name:i[u-4],select:i[u-1]};break;case 72:n.extend(this.$,i[u-9]),n.extend(this.$,i[u-8]),n.extend(this.$,i[u-7]),n.extend(this.$,i[u-6]),n.extend(this.$,i[u-5]),n.extend(this.$,i[u-4]),n.extend(this.$,i[u-3]),n.extend(this.$,i[u-2]),n.extend(this.$,i[u-1]),n.extend(this.$,i[u]),this.$=i[u-9];break;case 73:this.$=new n.Search({selectors:i[u-2],from:i[u]}),n.extend(this.$,i[u-1]);break;case 74:this.$={pivot:{expr:i[u-5],columnid:i[u-3],inlist:i[u-2],as:i[u]}};break;case 75:this.$={unpivot:{tocolumnid:i[u-8],forcolumnid:i[u-6],inlist:i[u-3],as:i[u]}};break;case 76:case 520:case 549:case 585:case 619:case 636:case 637:case 640:case 662:this.$=i[u-1];break;case 77:case 78:case 86:case 147:case 185:case 247:case 280:case 288:case 289:case 290:case 291:case 292:case 293:case 294:case 295:case 296:case 297:case 298:case 299:case 300:case 301:case 304:case 305:case 320:case 321:case 322:case 323:case 324:case 325:case 374:case 440:case 441:case 442:case 443:case 444:case 445:case 516:case 542:case 546:case 548:case 623:case 624:case 625:case 626:case 627:case 628:case 632:case 634:case 635:case 644:case 660:case 661:case 723:case 738:case 739:case 741:case 742:case 748:case 749:this.$=i[u];break;case 79:case 84:case 731:case 755:this.$=i[u-2],this.$.push(i[u]);break;case 81:this.$={expr:i[u]};break;case 82:this.$={expr:i[u-2],as:i[u]};break;case 83:this.$={removecolumns:i[u]};break;case 87:this.$={like:i[u]};break;case 90:case 104:this.$={srchid:"PROP",args:[i[u]]};break;case 91:this.$={srchid:"ORDERBY",args:i[u-1]};break;case 92:var c=i[u-1];c=c||"ASC",this.$={srchid:"ORDERBY",args:[{expression:new n.Column({columnid:"_"}),direction:c}]};break;case 93:this.$={srchid:"PARENT"};break;case 94:this.$={srchid:"APROP",args:[i[u]]};break;case 95:this.$={selid:"ROOT"};break;case 96:this.$={srchid:"EQ",args:[i[u]]};break;case 97:this.$={srchid:"LIKE",args:[i[u]]};break;case 98:case 99:this.$={selid:"WITH",args:i[u-1]};break;case 100:this.$={srchid:i[u-3].toUpperCase(),args:i[u-1]};break;case 101:this.$={srchid:"WHERE",args:[i[u-1]]};break;case 102:this.$={selid:"OF",args:[i[u-1]]};break;case 103:this.$={srchid:"CLASS",args:[i[u-1]]};break;case 105:this.$={srchid:"NAME",args:[i[u].substr(1,i[u].length-2)]};break;case 106:this.$={srchid:"CHILD"};break;case 107:this.$={srchid:"VERTEX"};break;case 108:this.$={srchid:"EDGE"};break;case 109:this.$={srchid:"REF"};break;case 110:this.$={srchid:"SHARP",args:[i[u]]};break;case 111:this.$={srchid:"ATTR",args:void 0===i[u]?void 0:[i[u]]};break;case 112:this.$={srchid:"ATTR"};break;case 113:this.$={srchid:"OUT"};break;case 114:this.$={srchid:"IN"};break;case 115:this.$={srchid:"OUTOUT"};break;case 116:this.$={srchid:"ININ"};break;case 117:this.$={srchid:"CONTENT"};break;case 118:this.$={srchid:"EX",args:[new n.Json({value:i[u]})]};break;case 119:this.$={srchid:"AT",args:[i[u]]};break;case 120:this.$={srchid:"AS",args:[i[u]]};break;case 121:this.$={srchid:"SET",args:i[u-1]};break;case 122:this.$={selid:"TO",args:[i[u]]};break;case 123:this.$={srchid:"VALUE"};break;case 124:this.$={srchid:"ROW",args:i[u-1]};break;case 125:this.$={srchid:"CLASS",args:[i[u]]};break;case 126:this.$={selid:i[u],args:[i[u-1]]};break;case 127:this.$={selid:"NOT",args:i[u-1]};break;case 128:this.$={selid:"IF",args:i[u-1]};break;case 129:this.$={selid:i[u-3],args:i[u-1]};break;case 130:this.$={selid:"DISTINCT",args:i[u-1]};break;case 131:this.$={selid:"UNION",args:i[u-1]};break;case 132:this.$={selid:"UNIONALL",args:i[u-1]};break;case 133:this.$={selid:"ALL",args:[i[u-1]]};break;case 134:this.$={selid:"ANY",args:[i[u-1]]};break;case 135:this.$={selid:"INTERSECT",args:i[u-1]};break;case 136:this.$={selid:"EXCEPT",args:i[u-1]};break;case 137:this.$={selid:"AND",args:i[u-1]};break;case 138:this.$={selid:"OR",args:i[u-1]};break;case 139:this.$={selid:"PATH",args:[i[u-1]]};break;case 140:this.$={srchid:"RETURN",args:i[u-1]};break;case 141:this.$={selid:"REPEAT",sels:i[u-3],args:i[u-1]};break;case 142:this.$=i[u-2],this.$.push(i[u]);break;case 144:this.$="PLUS";break;case 145:this.$="STAR";break;case 146:this.$="QUESTION";break;case 148:case 149:this.$=new n.Select({columns:i[u],distinct:!0}),n.extend(this.$,i[u-3]),n.extend(this.$,i[u-1]);break;case 150:this.$=new n.Select({columns:i[u],all:!0}),n.extend(this.$,i[u-3]),n.extend(this.$,i[u-1]);break;case 151:i[u]?(this.$=new n.Select({columns:i[u]}),n.extend(this.$,i[u-2]),n.extend(this.$,i[u-1])):this.$=new n.Select({columns:[new n.Column({columnid:"_"})],modifier:"COLUMN"});break;case 152:"SELECT"==i[u]?this.$=void 0:this.$={modifier:i[u]};break;case 153:this.$={modifier:"VALUE"};break;case 154:this.$={modifier:"ROW"};break;case 155:this.$={modifier:"COLUMN"};break;case 156:this.$={modifier:"MATRIX"};break;case 157:this.$={modifier:"TEXTSTRING"};break;case 158:this.$={modifier:"INDEX"};break;case 159:this.$={modifier:"RECORDSET"};break;case 160:this.$={top:i[u-1],percent:void 0!==i[u]||void 0};break;case 161:this.$={top:i[u-1]};break;case 163:case 330:case 523:case 524:case 724:this.$=void 0;break;case 164:case 165:case 166:case 167:this.$={into:i[u]};break;case 168:var l=(d=(d=i[u]).substr(1,d.length-2)).substr(-3).toUpperCase(),h=d.substr(-4).toUpperCase();"#"==d[0]?this.$={into:new n.FuncValue({funcid:"HTML",args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]})}:"XLS"==l||"CSV"==l||"TAB"==l?this.$={into:new n.FuncValue({funcid:l,args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]})}:"XLSX"!=h&&"JSON"!=h||(this.$={into:new n.FuncValue({funcid:h,args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]})});break;case 169:this.$={from:i[u]};break;case 170:this.$={from:i[u-1],joins:i[u]};break;case 171:this.$={from:i[u-2],joins:i[u-1]};break;case 173:this.$=new n.Apply({select:i[u-2],applymode:"CROSS",as:i[u]});break;case 174:this.$=new n.Apply({select:i[u-3],applymode:"CROSS",as:i[u]});break;case 175:this.$=new n.Apply({select:i[u-2],applymode:"OUTER",as:i[u]});break;case 176:this.$=new n.Apply({select:i[u-3],applymode:"OUTER",as:i[u]});break;case 178:case 243:case 452:case 530:case 531:this.$=i[u-2],i[u-2].push(i[u]);break;case 179:this.$=i[u-2],this.$.as=i[u];break;case 180:this.$=i[u-3],this.$.as=i[u];break;case 181:this.$=i[u-1],this.$.as="default";break;case 182:this.$=new n.Json({value:i[u-2]}),i[u-2].as=i[u];break;case 183:this.$=i[u-1],i[u-1].as=i[u];break;case 184:this.$=i[u-2],i[u-2].as=i[u];break;case 186:case 638:case 641:this.$=i[u-2];break;case 187:case 191:case 195:case 198:this.$=i[u-1],i[u-1].as=i[u];break;case 188:case 192:case 196:case 199:this.$=i[u-2],i[u-2].as=i[u];break;case 189:case 190:case 194:case 197:this.$=i[u],i[u].as="default";break;case 193:this.$={inserted:!0};break;case 200:var d,f;if(l=(d=(d=i[u]).substr(1,d.length-2)).substr(-3).toUpperCase(),h=d.substr(-4).toUpperCase(),"#"==d[0])f=new n.FuncValue({funcid:"HTML",args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]});else if("XLS"==l||"CSV"==l||"TAB"==l)f=new n.FuncValue({funcid:l,args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]});else{if("XLSX"!=h&&"JSON"!=h)throw new Error("Unknown string in FROM clause");f=new n.FuncValue({funcid:h,args:[new n.StringValue({value:d}),new n.Json({value:{headers:!0}})]})}this.$=f;break;case 201:"INFORMATION_SCHEMA"==i[u-2]?this.$=new n.FuncValue({funcid:i[u-2],args:[new n.StringValue({value:i[u]})]}):this.$=new n.Table({databaseid:i[u-2],tableid:i[u]});break;case 202:this.$=new n.Table({tableid:i[u]});break;case 203:case 204:this.$=i[u-1],i[u-1].push(i[u]);break;case 207:this.$=new n.Join(i[u-2]),n.extend(this.$,i[u-1]),n.extend(this.$,i[u]);break;case 208:this.$={table:i[u]};break;case 209:this.$={table:i[u-1],as:i[u]};break;case 210:this.$={table:i[u-2],as:i[u]};break;case 211:this.$={json:new n.Json({value:i[u-2],as:i[u]})};break;case 212:this.$={param:i[u-1],as:i[u]};break;case 213:this.$={param:i[u-2],as:i[u]};break;case 214:this.$={select:i[u-2],as:i[u]};break;case 215:this.$={select:i[u-3],as:i[u]};break;case 216:this.$={func:i[u],as:"default"};break;case 217:this.$={func:i[u-1],as:i[u]};break;case 218:this.$={func:i[u-2],as:i[u]};break;case 219:this.$={variable:i[u],as:"default"};break;case 220:this.$={variable:i[u-1],as:i[u]};break;case 221:this.$={variable:i[u-2],as:i[u]};break;case 222:this.$={joinmode:i[u]};break;case 223:this.$={joinmode:i[u-1],natural:!0};break;case 224:case 225:this.$="INNER";break;case 226:case 227:this.$="LEFT";break;case 228:case 229:this.$="RIGHT";break;case 230:case 231:this.$="OUTER";break;case 232:this.$="SEMI";break;case 233:this.$="ANTI";break;case 234:this.$="CROSS";break;case 235:this.$={on:i[u]};break;case 236:case 697:this.$={using:i[u]};break;case 239:this.$={where:new n.Expression({expression:i[u]})};break;case 241:this.$={group:i[u-1]},n.extend(this.$,i[u]);break;case 244:this.$=new n.GroupExpression({type:"GROUPING SETS",group:i[u-1]});break;case 245:this.$=new n.GroupExpression({type:"ROLLUP",group:i[u-1]});break;case 246:this.$=new n.GroupExpression({type:"CUBE",group:i[u-1]});break;case 249:this.$={having:i[u]};break;case 251:this.$={union:i[u]};break;case 252:this.$={unionall:i[u]};break;case 253:this.$={except:i[u]};break;case 254:this.$={intersect:i[u]};break;case 255:this.$={union:i[u],corresponding:!0};break;case 256:this.$={unionall:i[u],corresponding:!0};break;case 257:this.$={except:i[u],corresponding:!0};break;case 258:this.$={intersect:i[u],corresponding:!0};break;case 260:this.$={order:i[u]};break;case 262:this.$=i[u-2],i[u-2].push(i[u]);break;case 263:this.$=new n.Expression({expression:i[u],direction:"ASC"});break;case 264:this.$=new n.Expression({expression:i[u-1],direction:i[u].toUpperCase()});break;case 265:this.$=new n.Expression({expression:i[u-2],direction:"ASC",nocase:!0});break;case 266:this.$=new n.Expression({expression:i[u-3],direction:i[u].toUpperCase(),nocase:!0});break;case 268:this.$={limit:i[u-1]},n.extend(this.$,i[u]);break;case 269:this.$={limit:i[u-2],offset:i[u-6]};break;case 271:this.$={offset:i[u]};break;case 272:case 509:case 533:case 648:case 658:case 682:case 684:case 688:i[u-2].push(i[u]),this.$=i[u-2];break;case 274:case 276:case 278:i[u-2].as=i[u],this.$=i[u-2];break;case 275:case 277:case 279:i[u-1].as=i[u],this.$=i[u-1];break;case 281:this.$=new n.Column({columid:i[u],tableid:i[u-2],databaseid:i[u-4]});break;case 282:this.$=new n.Column({columnid:i[u],tableid:i[u-2]});break;case 283:this.$=new n.Column({columnid:i[u]});break;case 284:this.$=new n.Column({columnid:i[u],tableid:i[u-2],databaseid:i[u-4]});break;case 285:case 286:this.$=new n.Column({columnid:i[u],tableid:i[u-2]});break;case 287:this.$=new n.Column({columnid:i[u]});break;case 302:this.$=new n.DomainValueValue;break;case 303:this.$=new n.Json({value:i[u]});break;case 306:case 307:case 308:n.queries||(n.queries=[]),n.queries.push(i[u-1]),i[u-1].queriesidx=n.queries.length,this.$=i[u-1];break;case 309:this.$=i[u];break;case 310:this.$=new n.FuncValue({funcid:"CURRENT_TIMESTAMP"});break;case 311:this.$=new n.JavaScript({value:i[u].substr(2,i[u].length-4)});break;case 312:this.$=new n.JavaScript({value:'alasql.fn["'+i[u-2]+'"] = '+i[u].substr(2,i[u].length-4)});break;case 313:this.$=new n.JavaScript({value:'alasql.aggr["'+i[u-2]+'"] = '+i[u].substr(2,i[u].length-4)});break;case 314:this.$=new n.FuncValue({funcid:i[u],newid:!0});break;case 315:this.$=i[u],n.extend(this.$,{newid:!0});break;case 316:this.$=new n.Convert({expression:i[u-3]}),n.extend(this.$,i[u-1]);break;case 317:this.$=new n.Convert({expression:i[u-5],style:i[u-1]}),n.extend(this.$,i[u-3]);break;case 318:this.$=new n.Convert({expression:i[u-1]}),n.extend(this.$,i[u-3]);break;case 319:this.$=new n.Convert({expression:i[u-3],style:i[u-1]}),n.extend(this.$,i[u-5]);break;case 326:this.$=new n.FuncValue({funcid:"CURRENT_TIMESTAMP"});break;case 327:1<i[u-2].length&&("MAX"==i[u-4].toUpperCase()||"MIN"==i[u-4].toUpperCase())?this.$=new n.FuncValue({funcid:i[u-4],args:i[u-2]}):this.$=new n.AggrValue({aggregatorid:i[u-4].toUpperCase(),expression:i[u-2].pop(),over:i[u]});break;case 328:this.$=new n.AggrValue({aggregatorid:i[u-5].toUpperCase(),expression:i[u-2],distinct:!0,over:i[u]});break;case 329:this.$=new n.AggrValue({aggregatorid:i[u-5].toUpperCase(),expression:i[u-2],over:i[u]});break;case 331:case 332:this.$=new n.Over,n.extend(this.$,i[u-1]);break;case 333:this.$=new n.Over,n.extend(this.$,i[u-2]),n.extend(this.$,i[u-1]);break;case 334:this.$={partition:i[u]};break;case 335:this.$={order:i[u]};break;case 336:this.$="SUM";break;case 337:this.$="COUNT";break;case 338:this.$="MIN";break;case 339:case 544:this.$="MAX";break;case 340:this.$="AVG";break;case 341:this.$="FIRST";break;case 342:this.$="LAST";break;case 343:this.$="AGGR";break;case 344:this.$="ARRAY";break;case 345:var p=i[u-4],b=i[u-1];1<b.length&&("MIN"==p.toUpperCase()||"MAX"==p.toUpperCase())?this.$=new n.FuncValue({funcid:p,args:b}):s.aggr[i[u-4]]?this.$=new n.AggrValue({aggregatorid:"REDUCE",funcid:p,expression:b.pop(),distinct:"DISTINCT"==i[u-2]}):this.$=new n.FuncValue({funcid:p,args:b});break;case 346:this.$=new n.FuncValue({funcid:i[u-2]});break;case 347:this.$=new n.FuncValue({funcid:"IIF",args:i[u-1]});break;case 348:this.$=new n.FuncValue({funcid:"REPLACE",args:i[u-1]});break;case 349:this.$=new n.FuncValue({funcid:"DATEADD",args:[new n.StringValue({value:i[u-5]}),i[u-3],i[u-1]]});break;case 350:this.$=new n.FuncValue({funcid:"DATEADD",args:[i[u-5],i[u-3],i[u-1]]});break;case 351:this.$=new n.FuncValue({funcid:"DATEDIFF",args:[new n.StringValue({value:i[u-5]}),i[u-3],i[u-1]]});break;case 352:this.$=new n.FuncValue({funcid:"DATEDIFF",args:[i[u-5],i[u-3],i[u-1]]});break;case 353:this.$=new n.FuncValue({funcid:"INTERVAL",args:[i[u-1],new n.StringValue({value:i[u].toLowerCase()})]});break;case 355:i[u-2].push(i[u]),this.$=i[u-2];break;case 356:this.$=new n.NumValue({value:+i[u]});break;case 357:this.$=new n.LogicValue({value:!0});break;case 358:this.$=new n.LogicValue({value:!1});break;case 359:this.$=new n.StringValue({value:i[u].substr(1,i[u].length-2).replace(/(\\\')/g,"'").replace(/(\'\')/g,"'")});break;case 360:this.$=new n.StringValue({value:i[u].substr(2,i[u].length-3).replace(/(\\\')/g,"'").replace(/(\'\')/g,"'")});break;case 361:this.$=new n.NullValue({value:void 0});break;case 362:this.$=new n.VarValue({variable:i[u]});break;case 363:n.exists||(n.exists=[]),this.$=new n.ExistsValue({value:i[u-1],existsidx:n.exists.length}),n.exists.push(i[u-1]);break;case 364:this.$=new n.ArrayValue({value:i[u-1]});break;case 365:case 366:this.$=new n.ParamValue({param:i[u]});break;case 367:void 0===n.question&&(n.question=0),this.$=new n.ParamValue({param:n.question++});break;case 368:void 0===n.question&&(n.question=0),this.$=new n.ParamValue({param:n.question++,array:!0});break;case 369:this.$=new n.CaseValue({expression:i[u-3],whens:i[u-2],elses:i[u-1]});break;case 370:this.$=new n.CaseValue({whens:i[u-2],elses:i[u-1]});break;case 371:case 699:case 700:this.$=i[u-1],this.$.push(i[u]);break;case 373:this.$={when:i[u-2],then:i[u]};break;case 376:case 377:this.$=new n.Op({left:i[u-2],op:"REGEXP",right:i[u]});break;case 378:this.$=new n.Op({left:i[u-2],op:"GLOB",right:i[u]});break;case 379:this.$=new n.Op({left:i[u-2],op:"LIKE",right:i[u]});break;case 380:this.$=new n.Op({left:i[u-4],op:"LIKE",right:i[u-2],escape:i[u]});break;case 381:this.$=new n.Op({left:i[u-2],op:"NOT LIKE",right:i[u]});break;case 382:this.$=new n.Op({left:i[u-4],op:"NOT LIKE",right:i[u-2],escape:i[u]});break;case 383:this.$=new n.Op({left:i[u-2],op:"||",right:i[u]});break;case 384:this.$=new n.Op({left:i[u-2],op:"+",right:i[u]});break;case 385:this.$=new n.Op({left:i[u-2],op:"-",right:i[u]});break;case 386:this.$=new n.Op({left:i[u-2],op:"*",right:i[u]});break;case 387:this.$=new n.Op({left:i[u-2],op:"/",right:i[u]});break;case 388:this.$=new n.Op({left:i[u-2],op:"%",right:i[u]});break;case 389:this.$=new n.Op({left:i[u-2],op:"^",right:i[u]});break;case 390:this.$=new n.Op({left:i[u-2],op:">>",right:i[u]});break;case 391:this.$=new n.Op({left:i[u-2],op:"<<",right:i[u]});break;case 392:this.$=new n.Op({left:i[u-2],op:"&",right:i[u]});break;case 393:this.$=new n.Op({left:i[u-2],op:"|",right:i[u]});break;case 394:case 395:case 397:this.$=new n.Op({left:i[u-2],op:"->",right:i[u]});break;case 396:this.$=new n.Op({left:i[u-4],op:"->",right:i[u-1]});break;case 398:case 399:case 401:this.$=new n.Op({left:i[u-2],op:"!",right:i[u]});break;case 400:this.$=new n.Op({left:i[u-4],op:"!",right:i[u-1]});break;case 402:this.$=new n.Op({left:i[u-2],op:">",right:i[u]});break;case 403:this.$=new n.Op({left:i[u-2],op:">=",right:i[u]});break;case 404:this.$=new n.Op({left:i[u-2],op:"<",right:i[u]});break;case 405:this.$=new n.Op({left:i[u-2],op:"<=",right:i[u]});break;case 406:this.$=new n.Op({left:i[u-2],op:"=",right:i[u]});break;case 407:this.$=new n.Op({left:i[u-2],op:"==",right:i[u]});break;case 408:this.$=new n.Op({left:i[u-2],op:"===",right:i[u]});break;case 409:this.$=new n.Op({left:i[u-2],op:"!=",right:i[u]});break;case 410:this.$=new n.Op({left:i[u-2],op:"!==",right:i[u]});break;case 411:this.$=new n.Op({left:i[u-2],op:"!===",right:i[u]});break;case 412:n.queries||(n.queries=[]),this.$=new n.Op({left:i[u-5],op:i[u-4],allsome:i[u-3],right:i[u-1],queriesidx:n.queries.length}),n.queries.push(i[u-1]);break;case 413:this.$=new n.Op({left:i[u-5],op:i[u-4],allsome:i[u-3],right:i[u-1]});break;case 414:"BETWEEN1"==i[u-2].op?"AND"==i[u-2].left.op?this.$=new n.Op({left:i[u-2].left.left,op:"AND",right:new n.Op({left:i[u-2].left.right,op:"BETWEEN",right1:i[u-2].right,right2:i[u]})}):this.$=new n.Op({left:i[u-2].left,op:"BETWEEN",right1:i[u-2].right,right2:i[u]}):"NOT BETWEEN1"==i[u-2].op?"AND"==i[u-2].left.op?this.$=new n.Op({left:i[u-2].left.left,op:"AND",right:new n.Op({left:i[u-2].left.right,op:"NOT BETWEEN",right1:i[u-2].right,right2:i[u]})}):this.$=new n.Op({left:i[u-2].left,op:"NOT BETWEEN",right1:i[u-2].right,right2:i[u]}):this.$=new n.Op({left:i[u-2],op:"AND",right:i[u]});break;case 415:this.$=new n.Op({left:i[u-2],op:"OR",right:i[u]});break;case 416:this.$=new n.UniOp({op:"NOT",right:i[u]});break;case 417:this.$=new n.UniOp({op:"-",right:i[u]});break;case 418:this.$=new n.UniOp({op:"+",right:i[u]});break;case 419:this.$=new n.UniOp({op:"~",right:i[u]});break;case 420:this.$=new n.UniOp({op:"#",right:i[u]});break;case 421:this.$=new n.UniOp({right:i[u-1]});break;case 422:n.queries||(n.queries=[]),this.$=new n.Op({left:i[u-4],op:"IN",right:i[u-1],queriesidx:n.queries.length}),n.queries.push(i[u-1]);break;case 423:n.queries||(n.queries=[]),this.$=new n.Op({left:i[u-5],op:"NOT IN",right:i[u-1],queriesidx:n.queries.length}),n.queries.push(i[u-1]);break;case 424:this.$=new n.Op({left:i[u-4],op:"IN",right:i[u-1]});break;case 425:this.$=new n.Op({left:i[u-5],op:"NOT IN",right:i[u-1]});break;case 426:this.$=new n.Op({left:i[u-3],op:"IN",right:[]});break;case 427:this.$=new n.Op({left:i[u-4],op:"NOT IN",right:[]});break;case 428:case 430:this.$=new n.Op({left:i[u-2],op:"IN",right:i[u]});break;case 429:case 431:this.$=new n.Op({left:i[u-3],op:"NOT IN",right:i[u]});break;case 432:this.$=new n.Op({left:i[u-2],op:"BETWEEN1",right:i[u]});break;case 433:this.$=new n.Op({left:i[u-2],op:"NOT BETWEEN1",right:i[u]});break;case 434:this.$=new n.Op({op:"IS",left:i[u-2],right:i[u]});break;case 435:this.$=new n.Op({op:"IS",left:i[u-2],right:new n.UniOp({op:"NOT",right:new n.NullValue({value:void 0})})});break;case 436:this.$=new n.Convert({expression:i[u-2]}),n.extend(this.$,i[u]);break;case 437:case 438:this.$=i[u];break;case 439:this.$=i[u-1];break;case 446:this.$="ALL";break;case 447:this.$="SOME";break;case 448:this.$="ANY";break;case 449:this.$=new n.Update({table:i[u-4],columns:i[u-2],where:i[u]});break;case 450:this.$=new n.Update({table:i[u-2],columns:i[u]});break;case 453:this.$=new n.SetColumn({column:i[u-2],expression:i[u]});break;case 454:this.$=new n.SetColumn({variable:i[u-2],expression:i[u],method:i[u-3]});break;case 455:this.$=new n.Delete({table:i[u-2],where:i[u]});break;case 456:this.$=new n.Delete({table:i[u]});break;case 457:this.$=new n.Insert({into:i[u-2],values:i[u]});break;case 458:this.$=new n.Insert({into:i[u-1],values:i[u]});break;case 459:case 461:this.$=new n.Insert({into:i[u-2],values:i[u],orreplace:!0});break;case 460:case 462:this.$=new n.Insert({into:i[u-1],values:i[u],orreplace:!0});break;case 463:this.$=new n.Insert({into:i[u-2],default:!0});break;case 464:this.$=new n.Insert({into:i[u-5],columns:i[u-3],values:i[u]});break;case 465:this.$=new n.Insert({into:i[u-4],columns:i[u-2],values:i[u]});break;case 466:this.$=new n.Insert({into:i[u-1],select:i[u]});break;case 467:this.$=new n.Insert({into:i[u-1],select:i[u],orreplace:!0});break;case 468:this.$=new n.Insert({into:i[u-4],columns:i[u-2],select:i[u]});break;case 473:this.$=[i[u-1]];break;case 476:this.$=i[u-4],i[u-4].push(i[u-1]);break;case 477:case 478:case 480:case 488:this.$=i[u-2],i[u-2].push(i[u]);break;case 489:this.$=new n.CreateTable({table:i[u-4]}),n.extend(this.$,i[u-7]),n.extend(this.$,i[u-6]),n.extend(this.$,i[u-5]),n.extend(this.$,i[u-2]),n.extend(this.$,i[u]);break;case 490:this.$=new n.CreateTable({table:i[u]}),n.extend(this.$,i[u-3]),n.extend(this.$,i[u-2]),n.extend(this.$,i[u-1]);break;case 492:this.$={class:!0};break;case 502:this.$={temporary:!0};break;case 504:this.$={ifnotexists:!0};break;case 505:this.$={columns:i[u-2],constraints:i[u]};break;case 506:this.$={columns:i[u]};break;case 507:this.$={as:i[u]};break;case 508:case 532:this.$=[i[u]];break;case 510:case 511:case 512:case 513:case 514:i[u].constraintid=i[u-1],this.$=i[u];break;case 517:this.$={type:"CHECK",expression:i[u-1]};break;case 518:this.$={type:"PRIMARY KEY",columns:i[u-1],clustered:(i[u-3]+"").toUpperCase()};break;case 519:this.$={type:"FOREIGN KEY",columns:i[u-5],fktable:i[u-2],fkcolumns:i[u-1]};break;case 525:this.$={type:"UNIQUE",columns:i[u-1],clustered:(i[u-3]+"").toUpperCase()};break;case 534:this.$=new n.ColumnDef({columnid:i[u-2]}),n.extend(this.$,i[u-1]),n.extend(this.$,i[u]);break;case 535:this.$=new n.ColumnDef({columnid:i[u-1]}),n.extend(this.$,i[u]);break;case 536:this.$=new n.ColumnDef({columnid:i[u],dbtypeid:""});break;case 537:this.$={dbtypeid:i[u-5],dbsize:i[u-3],dbprecision:+i[u-1]};break;case 538:this.$={dbtypeid:i[u-3],dbsize:i[u-1]};break;case 539:this.$={dbtypeid:i[u]};break;case 540:this.$={dbtypeid:"ENUM",enumvalues:i[u-1]};break;case 541:this.$=i[u-1],i[u-1].dbtypeid+="["+i[u]+"]";break;case 543:case 750:this.$=+i[u];break;case 545:this.$=void 0;break;case 547:n.extend(i[u-1],i[u]),this.$=i[u-1];break;case 550:this.$={primarykey:!0};break;case 551:case 552:this.$={foreignkey:{table:i[u-1],columnid:i[u]}};break;case 553:this.$={identity:{value:i[u-3],step:i[u-1]}};break;case 554:this.$={identity:{value:1,step:1}};break;case 555:case 557:this.$={default:i[u]};break;case 556:this.$={default:i[u-1]};break;case 558:this.$={null:!0};break;case 559:this.$={notnull:!0};break;case 560:this.$={check:i[u]};break;case 561:this.$={unique:!0};break;case 562:this.$={onupdate:i[u]};break;case 563:this.$={onupdate:i[u-1]};break;case 564:this.$=new n.DropTable({tables:i[u],type:i[u-2]}),n.extend(this.$,i[u-1]);break;case 568:this.$={ifexists:!0};break;case 569:this.$=new n.AlterTable({table:i[u-3],renameto:i[u]});break;case 570:this.$=new n.AlterTable({table:i[u-3],addcolumn:i[u]});break;case 571:this.$=new n.AlterTable({table:i[u-3],modifycolumn:i[u]});break;case 572:this.$=new n.AlterTable({table:i[u-5],renamecolumn:i[u-2],to:i[u]});break;case 573:this.$=new n.AlterTable({table:i[u-3],dropcolumn:i[u]});break;case 574:this.$=new n.AlterTable({table:i[u-2],renameto:i[u]});break;case 575:this.$=new n.AttachDatabase({databaseid:i[u],engineid:i[u-2].toUpperCase()});break;case 576:this.$=new n.AttachDatabase({databaseid:i[u-3],engineid:i[u-5].toUpperCase(),args:i[u-1]});break;case 577:this.$=new n.AttachDatabase({databaseid:i[u-2],engineid:i[u-4].toUpperCase(),as:i[u]});break;case 578:this.$=new n.AttachDatabase({databaseid:i[u-5],engineid:i[u-7].toUpperCase(),as:i[u],args:i[u-3]});break;case 579:this.$=new n.DetachDatabase({databaseid:i[u]});break;case 580:this.$=new n.CreateDatabase({databaseid:i[u]}),n.extend(this.$,i[u]);break;case 581:this.$=new n.CreateDatabase({engineid:i[u-4].toUpperCase(),databaseid:i[u-1],as:i[u]}),n.extend(this.$,i[u-2]);break;case 582:this.$=new n.CreateDatabase({engineid:i[u-7].toUpperCase(),databaseid:i[u-4],args:i[u-2],as:i[u]}),n.extend(this.$,i[u-5]);break;case 583:this.$=new n.CreateDatabase({engineid:i[u-4].toUpperCase(),as:i[u],args:[i[u-1]]}),n.extend(this.$,i[u-2]);break;case 584:this.$=void 0;break;case 586:case 587:this.$=new n.UseDatabase({databaseid:i[u]});break;case 588:this.$=new n.DropDatabase({databaseid:i[u]}),n.extend(this.$,i[u-1]);break;case 589:case 590:this.$=new n.DropDatabase({databaseid:i[u],engineid:i[u-3].toUpperCase()}),n.extend(this.$,i[u-1]);break;case 591:this.$=new n.CreateIndex({indexid:i[u-5],table:i[u-3],columns:i[u-1]});break;case 592:this.$=new n.CreateIndex({indexid:i[u-5],table:i[u-3],columns:i[u-1],unique:!0});break;case 593:this.$=new n.DropIndex({indexid:i[u]});break;case 594:this.$=new n.ShowDatabases;break;case 595:this.$=new n.ShowDatabases({like:i[u]});break;case 596:this.$=new n.ShowDatabases({engineid:i[u-1].toUpperCase()});break;case 597:this.$=new n.ShowDatabases({engineid:i[u-3].toUpperCase(),like:i[u]});break;case 598:this.$=new n.ShowTables;break;case 599:this.$=new n.ShowTables({like:i[u]});break;case 600:this.$=new n.ShowTables({databaseid:i[u]});break;case 601:this.$=new n.ShowTables({like:i[u],databaseid:i[u-2]});break;case 602:this.$=new n.ShowColumns({table:i[u]});break;case 603:this.$=new n.ShowColumns({table:i[u-2],databaseid:i[u]});break;case 604:this.$=new n.ShowIndex({table:i[u]});break;case 605:this.$=new n.ShowIndex({table:i[u-2],databaseid:i[u]});break;case 606:this.$=new n.ShowCreateTable({table:i[u]});break;case 607:this.$=new n.ShowCreateTable({table:i[u-2],databaseid:i[u]});break;case 608:this.$=new n.CreateTable({table:i[u-6],view:!0,select:i[u-1],viewcolumns:i[u-4]}),n.extend(this.$,i[u-9]),n.extend(this.$,i[u-7]);break;case 609:this.$=new n.CreateTable({table:i[u-3],view:!0,select:i[u-1]}),n.extend(this.$,i[u-6]),n.extend(this.$,i[u-4]);break;case 613:this.$=new n.DropTable({tables:i[u],view:!0}),n.extend(this.$,i[u-1]);break;case 614:case 760:this.$=new n.ExpressionStatement({expression:i[u]});break;case 615:this.$=new n.Source({url:i[u].value});break;case 616:this.$=new n.Assert({value:i[u]});break;case 617:this.$=new n.Assert({value:i[u].value});break;case 618:this.$=new n.Assert({value:i[u],message:i[u-2]});break;case 620:case 631:case 633:this.$=i[u].value;break;case 621:case 629:this.$=+i[u].value;break;case 622:this.$=!!i[u].value;break;case 630:this.$=""+i[u].value;break;case 639:this.$={};break;case 642:this.$=[];break;case 643:n.extend(i[u-2],i[u]),this.$=i[u-2];break;case 645:this.$={},this.$[i[u-2].substr(1,i[u-2].length-2)]=i[u];break;case 646:case 647:this.$={},this.$[i[u-2]]=i[u];break;case 650:this.$=new n.SetVariable({variable:i[u-2].toLowerCase(),value:i[u]});break;case 651:this.$=new n.SetVariable({variable:i[u-1].toLowerCase(),value:i[u]});break;case 652:this.$=new n.SetVariable({variable:i[u-2],expression:i[u]});break;case 653:this.$=new n.SetVariable({variable:i[u-3],props:i[u-2],expression:i[u]});break;case 654:this.$=new n.SetVariable({variable:i[u-2],expression:i[u],method:i[u-3]});break;case 655:this.$=new n.SetVariable({variable:i[u-3],props:i[u-2],expression:i[u],method:i[u-4]});break;case 656:this.$="@";break;case 657:this.$="$";break;case 663:this.$=!0;break;case 664:this.$=!1;break;case 665:this.$=new n.CommitTransaction;break;case 666:this.$=new n.RollbackTransaction;break;case 667:this.$=new n.BeginTransaction;break;case 668:this.$=new n.If({expression:i[u-2],thenstat:i[u-1],elsestat:i[u]}),i[u-1].exists&&(this.$.exists=i[u-1].exists),i[u-1].queries&&(this.$.queries=i[u-1].queries);break;case 669:this.$=new n.If({expression:i[u-1],thenstat:i[u]}),i[u].exists&&(this.$.exists=i[u].exists),i[u].queries&&(this.$.queries=i[u].queries);break;case 670:this.$=i[u];break;case 671:this.$=new n.While({expression:i[u-1],loopstat:i[u]}),i[u].exists&&(this.$.exists=i[u].exists),i[u].queries&&(this.$.queries=i[u].queries);break;case 672:this.$=new n.Continue;break;case 673:this.$=new n.Break;break;case 674:this.$=new n.BeginEnd({statements:i[u-1]});break;case 675:this.$=new n.Print({exprs:i[u]});break;case 676:this.$=new n.Print({select:i[u]});break;case 677:this.$=new n.Require({paths:i[u]});break;case 678:this.$=new n.Require({plugins:i[u]});break;case 679:case 680:this.$=i[u].toUpperCase();break;case 681:this.$=new n.Echo({expr:i[u]});break;case 686:this.$=new n.Declare({declares:i[u]});break;case 689:this.$={variable:i[u-1]},n.extend(this.$,i[u]);break;case 690:this.$={variable:i[u-2]},n.extend(this.$,i[u]);break;case 691:this.$={variable:i[u-3],expression:i[u]},n.extend(this.$,i[u-2]);break;case 692:this.$={variable:i[u-4],expression:i[u]},n.extend(this.$,i[u-2]);break;case 693:this.$=new n.TruncateTable({table:i[u]});break;case 694:this.$=new n.Merge,n.extend(this.$,i[u-4]),n.extend(this.$,i[u-3]),n.extend(this.$,i[u-2]),n.extend(this.$,{matches:i[u-1]}),n.extend(this.$,i[u]);break;case 695:case 696:this.$={into:i[u]};break;case 698:this.$={on:i[u]};break;case 703:this.$={matched:!0,action:i[u]};break;case 704:this.$={matched:!0,expr:i[u-2],action:i[u]};break;case 705:this.$={delete:!0};break;case 706:this.$={update:i[u]};break;case 707:case 708:this.$={matched:!1,bytarget:!0,action:i[u]};break;case 709:case 710:this.$={matched:!1,bytarget:!0,expr:i[u-2],action:i[u]};break;case 711:this.$={matched:!1,bysource:!0,action:i[u]};break;case 712:this.$={matched:!1,bysource:!0,expr:i[u-2],action:i[u]};break;case 713:this.$={insert:!0,values:i[u]};break;case 714:this.$={insert:!0,values:i[u],columns:i[u-3]};break;case 715:this.$={insert:!0,defaultvalues:!0};break;case 716:this.$={insert:!0,defaultvalues:!0,columns:i[u-3]};break;case 718:this.$={output:{columns:i[u]}};break;case 719:this.$={output:{columns:i[u-3],intovar:i[u],method:i[u-1]}};break;case 720:this.$={output:{columns:i[u-2],intotable:i[u]}};break;case 721:this.$={output:{columns:i[u-5],intotable:i[u-3],intocolumns:i[u-1]}};break;case 722:this.$=new n.CreateVertex({class:i[u-3],sharp:i[u-2],name:i[u-1]}),n.extend(this.$,i[u]);break;case 725:this.$={sets:i[u]};break;case 726:this.$={content:i[u]};break;case 727:this.$={select:i[u]};break;case 728:this.$=new n.CreateEdge({from:i[u-3],to:i[u-1],name:i[u-5]}),n.extend(this.$,i[u]);break;case 729:this.$=new n.CreateGraph({graph:i[u]});break;case 730:this.$=new n.CreateGraph({from:i[u]});break;case 733:this.$=i[u-2],i[u-1]&&(this.$.json=new n.Json({value:i[u-1]})),i[u]&&(this.$.as=i[u]);break;case 734:this.$={source:i[u-6],target:i[u]},i[u-3]&&(this.$.json=new n.Json({value:i[u-3]})),i[u-2]&&(this.$.as=i[u-2]),n.extend(this.$,i[u-4]);break;case 735:this.$={source:i[u-5],target:i[u]},i[u-2]&&(this.$.json=new n.Json({value:i[u-3]})),i[u-1]&&(this.$.as=i[u-2]);break;case 736:this.$={source:i[u-2],target:i[u]};break;case 740:this.$={vars:i[u],method:i[u-1]};break;case 743:case 744:var E=i[u-1];this.$={prop:i[u-3],sharp:i[u-2],name:void 0===E?void 0:E.substr(1,E.length-2),class:i[u]};break;case 745:var m=i[u-1];this.$={sharp:i[u-2],name:void 0===m?void 0:m.substr(1,m.length-2),class:i[u]};break;case 746:var v=i[u-1];this.$={name:void 0===v?void 0:v.substr(1,v.length-2),class:i[u]};break;case 747:this.$={class:i[u]};break;case 753:this.$=new n.AddRule({left:i[u-2],right:i[u]});break;case 754:this.$=new n.AddRule({right:i[u]});break;case 757:this.$=new n.Term({termid:i[u]});break;case 758:this.$=new n.Term({termid:i[u-3],args:i[u-1]});break;case 761:this.$=new n.CreateTrigger({trigger:i[u-6],when:i[u-5],action:i[u-4],table:i[u-2],statement:i[u]}),i[u].exists&&(this.$.exists=i[u].exists),i[u].queries&&(this.$.queries=i[u].queries);break;case 762:this.$=new n.CreateTrigger({trigger:i[u-5],when:i[u-4],action:i[u-3],table:i[u-1],funcid:i[u]});break;case 763:this.$=new n.CreateTrigger({trigger:i[u-6],when:i[u-4],action:i[u-3],table:i[u-5],statement:i[u]}),i[u].exists&&(this.$.exists=i[u].exists),i[u].queries&&(this.$.queries=i[u].queries);break;case 764:case 765:case 767:this.$="AFTER";break;case 766:this.$="BEFORE";break;case 768:this.$="INSTEADOF";break;case 769:this.$="INSERT";break;case 770:this.$="DELETE";break;case 771:this.$="UPDATE";break;case 772:this.$=new n.DropTrigger({trigger:i[u]});break;case 773:this.$=new n.Reindex({indexid:i[u]});break;case 1047:case 1067:case 1069:case 1071:case 1075:case 1077:case 1079:case 1081:case 1083:case 1085:this.$=[];break;case 1048:case 1062:case 1064:case 1068:case 1070:case 1072:case 1076:case 1078:case 1080:case 1082:case 1084:case 1086:i[u-1].push(i[u]);break;case 1061:case 1063:this.$=[i[u]]}},table:[e([10,602,764],t,{8:1,9:2,12:3,13:4,17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,2:r,4:n,5:a,14:i,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),{1:[3]},{10:[1,105],11:106,602:J,764:Y},e(W,[2,8]),e(W,[2,9]),e(X,[2,12]),e(W,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:109,2:r,4:n,5:a,15:[1,110],53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(X,[2,14]),e(X,[2,15]),e(X,[2,16]),e(X,[2,17]),e(X,[2,18]),e(X,[2,19]),e(X,[2,20]),e(X,[2,21]),e(X,[2,22]),e(X,[2,23]),e(X,[2,24]),e(X,[2,25]),e(X,[2,26]),e(X,[2,27]),e(X,[2,28]),e(X,[2,29]),e(X,[2,30]),e(X,[2,31]),e(X,[2,32]),e(X,[2,33]),e(X,[2,34]),e(X,[2,35]),e(X,[2,36]),e(X,[2,37]),e(X,[2,38]),e(X,[2,39]),e(X,[2,40]),e(X,[2,41]),e(X,[2,42]),e(X,[2,43]),e(X,[2,44]),e(X,[2,45]),e(X,[2,46]),e(X,[2,47]),e(X,[2,48]),e(X,[2,49]),e(X,[2,50]),e(X,[2,51]),e(X,[2,52]),e(X,[2,53]),e(X,[2,54]),e(X,[2,55]),e(X,[2,56]),e(X,[2,57]),e(X,[2,58]),e(X,[2,59]),e(X,[2,60]),e(X,[2,61]),e(X,[2,62]),e(X,[2,63]),e(X,[2,64]),e(X,[2,65]),e(X,[2,66]),e(X,[2,67]),{353:[1,111]},{2:r,3:112,4:n,5:a},{2:r,3:114,4:n,5:a,156:K,200:113,290:Q,291:z,292:Z,293:ee},e(te,[2,501],{3:121,348:125,2:r,4:n,5:a,134:re,135:ne,187:[1,123],193:[1,122],268:[1,129],269:[1,130],357:[1,131],405:[1,120],472:[1,124],509:[1,128]}),{145:ae,449:132,450:133},{183:[1,135]},{405:[1,136]},{2:r,3:138,4:n,5:a,130:[1,144],193:[1,139],353:[1,143],397:140,405:[1,137],410:[1,141],509:[1,142]},{2:r,3:168,4:n,5:a,56:165,77:se,94:145,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ve,Be,{340:204,171:[1,205],198:je}),e(Ve,Be,{340:207,198:je}),{2:r,3:219,4:n,5:a,77:He,132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,198:[1,210],199:213,200:215,201:214,202:217,209:209,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge,453:208},{2:r,3:221,4:n,5:a},{353:[1,222]},e(We,[2,1043],{80:223,106:224,107:[1,225]}),e(Xe,[2,1047],{90:226}),{2:r,3:230,4:n,5:a,190:[1,228],193:[1,231],267:[1,227],353:[1,232],405:[1,229]},{353:[1,233]},{2:r,3:236,4:n,5:a,73:234,75:235},e([306,602,764],t,{12:3,13:4,17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,9:238,2:r,4:n,5:a,14:i,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,435:[1,237],436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),{435:[1,239]},{435:[1,240]},{2:r,3:242,4:n,5:a,405:[1,241]},{2:r,3:244,4:n,5:a,199:243},e(Ke,[2,311]),{113:245,132:oe,296:ke},{2:r,3:114,4:n,5:a,113:251,131:ie,132:[1,248],143:ce,144:246,145:Qe,152:de,156:K,181:Ee,196:250,200:255,201:254,257:252,258:253,265:ze,274:247,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:257,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(X,[2,672]),e(X,[2,673]),{2:r,3:168,4:n,5:a,40:259,56:165,77:se,79:75,89:c,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:258,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,184:99,189:f,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:266,4:n,5:a,113:263,132:oe,296:ke,444:261,445:262,446:264,447:Ze},{2:r,3:267,4:n,5:a,143:et,145:tt,431:268},{2:r,3:168,4:n,5:a,56:165,77:se,94:271,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{505:[1,272]},{2:r,3:100,4:n,5:a,504:274,506:273},{2:r,3:114,4:n,5:a,156:K,200:275,290:Q,291:z,292:Z,293:ee},{2:r,3:168,4:n,5:a,56:165,77:se,94:276,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(rt,nt,{186:280,164:[1,279],185:[1,277],187:[1,278],195:at}),e(st,[2,757],{77:[1,282]}),e([2,4,5,10,72,77,78,93,98,107,118,128,131,132,137,143,145,152,154,156,162,164,168,169,179,180,181,183,185,187,195,198,232,245,247,265,266,270,271,273,280,281,282,283,284,285,286,287,288,290,291,292,293,294,295,296,297,298,299,302,303,306,310,312,317,420,424,602,764],[2,152],{149:[1,283],150:[1,284],190:[1,285],191:[1,286],192:[1,287],193:[1,288],194:[1,289]}),e(it,[2,1]),e(it,[2,2]),{6:290,131:[1,439],172:[1,462],245:[1,411],285:[1,373],286:[1,407],370:[1,404],381:[1,295],402:[1,297],410:[1,549],414:[1,471],416:[1,443],417:[1,509],433:[1,442],435:[1,525],440:[1,342],460:[1,418],464:[1,448],470:[1,341],514:[1,307],515:[1,299],516:[1,399],518:[1,291],519:[1,292],520:[1,293],521:[1,294],522:[1,296],523:[1,298],524:[1,300],525:[1,301],526:[1,302],527:[1,303],528:[1,304],529:[1,305],530:[1,306],531:[1,308],532:[1,309],533:[1,310],534:[1,311],535:[1,312],536:[1,313],537:[1,314],538:[1,315],539:[1,316],540:[1,317],541:[1,318],542:[1,319],543:[1,320],544:[1,321],545:[1,322],546:[1,323],547:[1,324],548:[1,325],549:[1,326],550:[1,327],551:[1,328],552:[1,329],553:[1,330],554:[1,331],555:[1,332],556:[1,333],557:[1,334],558:[1,335],559:[1,336],560:[1,337],561:[1,338],562:[1,339],563:[1,340],564:[1,343],565:[1,344],566:[1,345],567:[1,346],568:[1,347],569:[1,348],570:[1,349],571:[1,350],572:[1,351],573:[1,352],574:[1,353],575:[1,354],576:[1,355],577:[1,356],578:[1,357],579:[1,358],580:[1,359],581:[1,360],582:[1,361],583:[1,362],584:[1,363],585:[1,364],586:[1,365],587:[1,366],588:[1,367],589:[1,368],590:[1,369],591:[1,370],592:[1,371],593:[1,372],594:[1,374],595:[1,375],596:[1,376],597:[1,377],598:[1,378],599:[1,379],600:[1,380],601:[1,381],602:[1,382],603:[1,383],604:[1,384],605:[1,385],606:[1,386],607:[1,387],608:[1,388],609:[1,389],610:[1,390],611:[1,391],612:[1,392],613:[1,393],614:[1,394],615:[1,395],616:[1,396],617:[1,397],618:[1,398],619:[1,400],620:[1,401],621:[1,402],622:[1,403],623:[1,405],624:[1,406],625:[1,408],626:[1,409],627:[1,410],628:[1,412],629:[1,413],630:[1,414],631:[1,415],632:[1,416],633:[1,417],634:[1,419],635:[1,420],636:[1,421],637:[1,422],638:[1,423],639:[1,424],640:[1,425],641:[1,426],642:[1,427],643:[1,428],644:[1,429],645:[1,430],646:[1,431],647:[1,432],648:[1,433],649:[1,434],650:[1,435],651:[1,436],652:[1,437],653:[1,438],654:[1,440],655:[1,441],656:[1,444],657:[1,445],658:[1,446],659:[1,447],660:[1,449],661:[1,450],662:[1,451],663:[1,452],664:[1,453],665:[1,454],666:[1,455],667:[1,456],668:[1,457],669:[1,458],670:[1,459],671:[1,460],672:[1,461],673:[1,463],674:[1,464],675:[1,465],676:[1,466],677:[1,467],678:[1,468],679:[1,469],680:[1,470],681:[1,472],682:[1,473],683:[1,474],684:[1,475],685:[1,476],686:[1,477],687:[1,478],688:[1,479],689:[1,480],690:[1,481],691:[1,482],692:[1,483],693:[1,484],694:[1,485],695:[1,486],696:[1,487],697:[1,488],698:[1,489],699:[1,490],700:[1,491],701:[1,492],702:[1,493],703:[1,494],704:[1,495],705:[1,496],706:[1,497],707:[1,498],708:[1,499],709:[1,500],710:[1,501],711:[1,502],712:[1,503],713:[1,504],714:[1,505],715:[1,506],716:[1,507],717:[1,508],718:[1,510],719:[1,511],720:[1,512],721:[1,513],722:[1,514],723:[1,515],724:[1,516],725:[1,517],726:[1,518],727:[1,519],728:[1,520],729:[1,521],730:[1,522],731:[1,523],732:[1,524],733:[1,526],734:[1,527],735:[1,528],736:[1,529],737:[1,530],738:[1,531],739:[1,532],740:[1,533],741:[1,534],742:[1,535],743:[1,536],744:[1,537],745:[1,538],746:[1,539],747:[1,540],748:[1,541],749:[1,542],750:[1,543],751:[1,544],752:[1,545],753:[1,546],754:[1,547],755:[1,548],756:[1,550],757:[1,551],758:[1,552],759:[1,553],760:[1,554],761:[1,555],762:[1,556],763:[1,557]},{1:[2,6]},e(W,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:558,2:r,4:n,5:a,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(ot,[2,1041]),e(ot,[2,1042]),e(W,[2,10]),{16:[1,559]},{2:r,3:244,4:n,5:a,199:560},{405:[1,561]},e(X,[2,760]),{77:ut},{77:[1,563]},{77:ct},{77:[1,565]},{77:[1,566]},{2:r,3:168,4:n,5:a,56:165,77:se,94:567,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ve,lt,{350:568,156:ht}),{405:[1,570]},{2:r,3:571,4:n,5:a},{193:[1,572]},{2:r,3:578,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,183:[1,574],431:585,473:573,474:575,475:576,478:577,482:582,493:579,497:581},{130:[1,589],349:586,353:[1,588],410:[1,587]},{113:591,132:oe,183:[2,1141],296:ke,471:590},e(bt,[2,1135],{465:592,3:593,2:r,4:n,5:a}),{2:r,3:594,4:n,5:a},{4:[1,595]},{4:[1,596]},e(te,[2,502]),e(X,[2,686],{74:[1,597]}),e(Et,[2,687]),{2:r,3:598,4:n,5:a},{2:r,3:244,4:n,5:a,199:599},{2:r,3:600,4:n,5:a},e(Ve,gt,{398:601,156:mt}),{405:[1,603]},{2:r,3:604,4:n,5:a},e(Ve,gt,{398:605,156:mt}),e(Ve,gt,{398:606,156:mt}),{2:r,3:607,4:n,5:a},e(vt,[2,1129]),e(vt,[2,1130]),e(X,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:608,114:625,327:637,2:r,4:n,5:a,53:o,72:u,89:c,99:St,112:Tt,115:At,116:yt,123:Nt,124:Ct,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,146:h,154:Lt,156:d,170:$t,171:Mt,179:Ut,180:_t,189:f,266:p,267:b,290:E,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(Ke,[2,288]),e(Ke,[2,289]),e(Ke,[2,290]),e(Ke,[2,291]),e(Ke,[2,292]),e(Ke,[2,293]),e(Ke,[2,294]),e(Ke,[2,295]),e(Ke,[2,296]),e(Ke,[2,297]),e(Ke,[2,298]),e(Ke,[2,299]),e(Ke,[2,300]),e(Ke,[2,301]),e(Ke,[2,302]),e(Ke,[2,303]),e(Ke,[2,304]),e(Ke,[2,305]),{2:r,3:168,4:n,5:a,26:654,27:653,36:649,40:648,56:165,77:se,79:75,89:c,94:651,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,184:99,189:f,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,264:650,265:ge,266:p,267:[1,655],270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:[1,652],291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,339:S,419:190,420:qe,424:Ge},e(Ke,[2,309]),e(Ke,[2,310]),{77:[1,656]},e([2,4,5,10,53,72,74,76,78,89,93,95,98,99,107,112,115,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],nr,{77:ut,116:[1,657]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:658,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:659,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:661,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:662,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,283]),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,231,232,239,242,243,245,247,249,265,266,267,270,271,273,280,281,282,283,284,285,286,287,288,290,291,292,293,294,295,296,297,298,299,300,302,303,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,415,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764,765,766],[2,356]),e(ar,[2,357]),e(ar,[2,358]),e(ar,sr),e(ar,[2,360]),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,361]),{2:r,3:664,4:n,5:a,131:[1,665],301:663},{2:r,3:666,4:n,5:a},e(ar,[2,367]),e(ar,[2,368]),{2:r,3:667,4:n,5:a,77:ir,113:669,131:ie,132:oe,143:ce,152:de,181:Ee,196:670,201:672,257:671,294:xe,295:De,296:ke,302:Ue,419:673,424:Ge},{77:[1,674]},{2:r,3:168,4:n,5:a,56:165,77:se,94:675,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,304:676,307:677,308:or,312:Fe,317:Pe,419:190,420:qe,424:Ge},{77:[1,679]},{77:[1,680]},e(ur,[2,624]),{2:r,3:695,4:n,5:a,77:cr,111:690,113:688,131:ie,132:oe,143:ce,144:685,145:Qe,152:de,156:K,181:Ee,196:687,200:693,201:692,257:689,258:691,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,300:[1,683],302:Ue,419:190,420:qe,421:681,422:684,423:686,424:Ge,427:682},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:696,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:697,4:n,5:a,156:K,200:698,290:Q,291:z,292:Z,293:ee},{77:[2,336]},{77:[2,337]},{77:[2,338]},{77:[2,339]},{77:[2,340]},{77:[2,341]},{77:[2,342]},{77:[2,343]},{77:[2,344]},{2:r,3:704,4:n,5:a,131:lr,132:hr,425:699,426:[1,700],428:701},{2:r,3:244,4:n,5:a,199:705},{290:[1,706]},e(Ve,[2,472]),{2:r,3:244,4:n,5:a,199:707},{231:[1,709],454:708},{231:[2,695]},{2:r,3:219,4:n,5:a,77:He,132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,199:213,200:215,201:214,202:217,209:710,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},{40:711,79:75,89:c,184:99,189:f},e(dr,[2,1091],{210:712,76:[1,713]}),e(fr,[2,185],{3:714,2:r,4:n,5:a,76:[1,715],154:[1,716]}),e(fr,[2,189],{3:717,2:r,4:n,5:a,76:[1,718]}),e(fr,[2,190],{3:719,2:r,4:n,5:a,76:[1,720]}),e(fr,[2,193]),e(fr,[2,194],{3:721,2:r,4:n,5:a,76:[1,722]}),e(fr,[2,197],{3:723,2:r,4:n,5:a,76:[1,724]}),e([2,4,5,10,72,74,76,78,93,98,118,128,154,162,168,169,183,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],pr,{77:ut,116:br}),e([2,4,5,10,72,74,76,78,93,98,118,128,162,168,169,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,306,310,602,764],[2,200]),e(X,[2,773]),{2:r,3:244,4:n,5:a,199:726},e(Er,gr,{81:727,198:mr}),e(We,[2,1044]),e(vr,[2,1057],{108:729,190:[1,730]}),e([10,78,183,306,310,602,764],gr,{419:190,81:731,117:732,3:733,114:736,144:758,158:768,160:769,2:r,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,115:At,116:yt,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,198:mr,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,420:qe,424:Ge}),{353:[1,782]},{183:[1,783]},e(X,[2,594],{112:[1,784]}),{405:[1,785]},{183:[1,786]},e(X,[2,598],{112:[1,787],183:[1,788]}),{2:r,3:244,4:n,5:a,199:789},{40:790,74:[1,791],79:75,89:c,184:99,189:f},e(hn,[2,70]),{76:[1,792]},e(X,[2,667]),{11:106,306:[1,793],602:J,764:Y},e(X,[2,665]),e(X,[2,666]),{2:r,3:794,4:n,5:a},e(X,[2,587]),{146:[1,795]},e([2,4,5,10,53,72,74,76,77,78,89,95,124,128,143,145,146,148,149,152,154,156,181,183,187,189,230,266,267,290,297,302,306,310,335,338,339,343,344,356,368,369,373,374,396,400,401,402,403,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,514,515,516,517,602,764],pr,{116:br}),e(X,[2,615]),e(X,[2,616]),e(X,[2,617]),e(X,sr,{74:[1,796]}),{77:ir,113:669,131:ie,132:oe,143:ce,152:de,181:Ee,196:670,201:672,257:671,294:xe,295:De,296:ke,302:Ue,419:673,424:Ge},e(dn,[2,320]),e(dn,[2,321]),e(dn,[2,322]),e(dn,[2,323]),e(dn,[2,324]),e(dn,[2,325]),e(dn,[2,326]),e(X,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,114:625,327:637,12:797,2:r,4:n,5:a,53:o,72:u,89:c,99:St,112:Tt,115:At,116:yt,123:Nt,124:Ct,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,146:h,154:Lt,156:d,170:$t,171:Mt,179:Ut,180:_t,189:f,266:p,267:b,290:E,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(X,[2,675],{74:fn}),e(X,[2,676]),e(pn,[2,354],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(X,[2,677],{74:[1,800]}),e(X,[2,678],{74:[1,801]}),e(Et,[2,683]),e(Et,[2,685]),e(Et,[2,679]),e(Et,[2,680]),{114:807,115:At,116:yt,124:[1,802],230:En,429:803,430:804,433:gn},{2:r,3:808,4:n,5:a},e(Ve,[2,656]),e(Ve,[2,657]),e(X,[2,614],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:100,4:n,5:a,504:274,506:809},e(X,[2,754],{74:mn}),e(vn,[2,756]),e(X,[2,759]),e(X,[2,681],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(Sn,nt,{186:811,195:at}),e(Sn,nt,{186:812,195:at}),e(Sn,nt,{186:813,195:at}),e(Tn,[2,1087],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,188:814,174:815,253:816,94:817,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),{77:[1,819],131:ie,196:818},{2:r,3:100,4:n,5:a,504:274,506:820},e(An,[2,153]),e(An,[2,154]),e(An,[2,155]),e(An,[2,156]),e(An,[2,157]),e(An,[2,158]),e(An,[2,159]),e(it,[2,3]),e(it,[2,774]),e(it,[2,775]),e(it,[2,776]),e(it,[2,777]),e(it,[2,778]),e(it,[2,779]),e(it,[2,780]),e(it,[2,781]),e(it,[2,782]),e(it,[2,783]),e(it,[2,784]),e(it,[2,785]),e(it,[2,786]),e(it,[2,787]),e(it,[2,788]),e(it,[2,789]),e(it,[2,790]),e(it,[2,791]),e(it,[2,792]),e(it,[2,793]),e(it,[2,794]),e(it,[2,795]),e(it,[2,796]),e(it,[2,797]),e(it,[2,798]),e(it,[2,799]),e(it,[2,800]),e(it,[2,801]),e(it,[2,802]),e(it,[2,803]),e(it,[2,804]),e(it,[2,805]),e(it,[2,806]),e(it,[2,807]),e(it,[2,808]),e(it,[2,809]),e(it,[2,810]),e(it,[2,811]),e(it,[2,812]),e(it,[2,813]),e(it,[2,814]),e(it,[2,815]),e(it,[2,816]),e(it,[2,817]),e(it,[2,818]),e(it,[2,819]),e(it,[2,820]),e(it,[2,821]),e(it,[2,822]),e(it,[2,823]),e(it,[2,824]),e(it,[2,825]),e(it,[2,826]),e(it,[2,827]),e(it,[2,828]),e(it,[2,829]),e(it,[2,830]),e(it,[2,831]),e(it,[2,832]),e(it,[2,833]),e(it,[2,834]),e(it,[2,835]),e(it,[2,836]),e(it,[2,837]),e(it,[2,838]),e(it,[2,839]),e(it,[2,840]),e(it,[2,841]),e(it,[2,842]),e(it,[2,843]),e(it,[2,844]),e(it,[2,845]),e(it,[2,846]),e(it,[2,847]),e(it,[2,848]),e(it,[2,849]),e(it,[2,850]),e(it,[2,851]),e(it,[2,852]),e(it,[2,853]),e(it,[2,854]),e(it,[2,855]),e(it,[2,856]),e(it,[2,857]),e(it,[2,858]),e(it,[2,859]),e(it,[2,860]),e(it,[2,861]),e(it,[2,862]),e(it,[2,863]),e(it,[2,864]),e(it,[2,865]),e(it,[2,866]),e(it,[2,867]),e(it,[2,868]),e(it,[2,869]),e(it,[2,870]),e(it,[2,871]),e(it,[2,872]),e(it,[2,873]),e(it,[2,874]),e(it,[2,875]),e(it,[2,876]),e(it,[2,877]),e(it,[2,878]),e(it,[2,879]),e(it,[2,880]),e(it,[2,881]),e(it,[2,882]),e(it,[2,883]),e(it,[2,884]),e(it,[2,885]),e(it,[2,886]),e(it,[2,887]),e(it,[2,888]),e(it,[2,889]),e(it,[2,890]),e(it,[2,891]),e(it,[2,892]),e(it,[2,893]),e(it,[2,894]),e(it,[2,895]),e(it,[2,896]),e(it,[2,897]),e(it,[2,898]),e(it,[2,899]),e(it,[2,900]),e(it,[2,901]),e(it,[2,902]),e(it,[2,903]),e(it,[2,904]),e(it,[2,905]),e(it,[2,906]),e(it,[2,907]),e(it,[2,908]),e(it,[2,909]),e(it,[2,910]),e(it,[2,911]),e(it,[2,912]),e(it,[2,913]),e(it,[2,914]),e(it,[2,915]),e(it,[2,916]),e(it,[2,917]),e(it,[2,918]),e(it,[2,919]),e(it,[2,920]),e(it,[2,921]),e(it,[2,922]),e(it,[2,923]),e(it,[2,924]),e(it,[2,925]),e(it,[2,926]),e(it,[2,927]),e(it,[2,928]),e(it,[2,929]),e(it,[2,930]),e(it,[2,931]),e(it,[2,932]),e(it,[2,933]),e(it,[2,934]),e(it,[2,935]),e(it,[2,936]),e(it,[2,937]),e(it,[2,938]),e(it,[2,939]),e(it,[2,940]),e(it,[2,941]),e(it,[2,942]),e(it,[2,943]),e(it,[2,944]),e(it,[2,945]),e(it,[2,946]),e(it,[2,947]),e(it,[2,948]),e(it,[2,949]),e(it,[2,950]),e(it,[2,951]),e(it,[2,952]),e(it,[2,953]),e(it,[2,954]),e(it,[2,955]),e(it,[2,956]),e(it,[2,957]),e(it,[2,958]),e(it,[2,959]),e(it,[2,960]),e(it,[2,961]),e(it,[2,962]),e(it,[2,963]),e(it,[2,964]),e(it,[2,965]),e(it,[2,966]),e(it,[2,967]),e(it,[2,968]),e(it,[2,969]),e(it,[2,970]),e(it,[2,971]),e(it,[2,972]),e(it,[2,973]),e(it,[2,974]),e(it,[2,975]),e(it,[2,976]),e(it,[2,977]),e(it,[2,978]),e(it,[2,979]),e(it,[2,980]),e(it,[2,981]),e(it,[2,982]),e(it,[2,983]),e(it,[2,984]),e(it,[2,985]),e(it,[2,986]),e(it,[2,987]),e(it,[2,988]),e(it,[2,989]),e(it,[2,990]),e(it,[2,991]),e(it,[2,992]),e(it,[2,993]),e(it,[2,994]),e(it,[2,995]),e(it,[2,996]),e(it,[2,997]),e(it,[2,998]),e(it,[2,999]),e(it,[2,1e3]),e(it,[2,1001]),e(it,[2,1002]),e(it,[2,1003]),e(it,[2,1004]),e(it,[2,1005]),e(it,[2,1006]),e(it,[2,1007]),e(it,[2,1008]),e(it,[2,1009]),e(it,[2,1010]),e(it,[2,1011]),e(it,[2,1012]),e(it,[2,1013]),e(it,[2,1014]),e(it,[2,1015]),e(it,[2,1016]),e(it,[2,1017]),e(it,[2,1018]),e(it,[2,1019]),e(it,[2,1020]),e(it,[2,1021]),e(it,[2,1022]),e(it,[2,1023]),e(it,[2,1024]),e(it,[2,1025]),e(it,[2,1026]),e(it,[2,1027]),e(it,[2,1028]),e(it,[2,1029]),e(it,[2,1030]),e(it,[2,1031]),e(it,[2,1032]),e(it,[2,1033]),e(it,[2,1034]),e(it,[2,1035]),e(it,[2,1036]),e(it,[2,1037]),e(it,[2,1038]),e(it,[2,1039]),e(it,[2,1040]),e(W,[2,7]),e(W,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:821,2:r,4:n,5:a,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),{396:[1,825],401:[1,822],402:[1,823],403:[1,824]},{2:r,3:826,4:n,5:a},e(Sn,[2,1111],{289:827,767:829,78:[1,828],164:[1,831],185:[1,830]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:832,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:833,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:834,4:n,5:a,132:[1,835]},{2:r,3:836,4:n,5:a,132:[1,837]},{2:r,3:838,4:n,5:a,99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:839,4:n,5:a},{154:[1,840]},e(yn,lt,{350:841,156:ht}),{230:[1,842]},{2:r,3:843,4:n,5:a},e(X,[2,729],{74:Nn}),{2:r,3:168,4:n,5:a,56:165,77:se,94:845,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(vn,[2,732]),e(Cn,[2,1143],{419:190,476:846,144:847,139:Rn,141:Rn,145:Qe,420:qe,424:Ge}),{139:[1,848],141:[1,849]},e(On,wn,{490:851,493:852,77:[1,850],137:ft}),e(In,[2,1167],{494:853,132:[1,854]}),e(xn,[2,1171],{496:855,497:856,152:pt}),e(xn,[2,747]),e(Dn,[2,739]),{2:r,3:857,4:n,5:a,131:[1,858]},{2:r,3:859,4:n,5:a},{2:r,3:860,4:n,5:a},e(Ve,lt,{350:861,156:ht}),e(Ve,lt,{350:862,156:ht}),e(vt,[2,491]),e(vt,[2,492]),{183:[1,863]},{183:[2,1142]},e(kn,[2,1137],{466:864,469:865,137:[1,866]}),e(bt,[2,1136]),e(Ln,$n,{510:867,95:Mn,230:[1,868],514:Un,515:_n,516:Fn}),{76:[1,873]},{76:[1,874]},{145:ae,450:875},{4:Pn,7:879,76:[1,877],272:876,387:878,389:qn},e(X,[2,456],{128:[1,882]}),e(X,[2,579]),{2:r,3:883,4:n,5:a},{298:[1,884]},e(yn,gt,{398:885,156:mt}),e(X,[2,593]),{2:r,3:244,4:n,5:a,199:887,399:886},{2:r,3:244,4:n,5:a,199:887,399:888},e(X,[2,772]),e(W,[2,669],{438:889,310:[1,890]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:891,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:892,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:893,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:894,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:895,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:896,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:897,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:898,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:899,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:900,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:901,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:902,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:903,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:904,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:905,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:906,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:907,4:n,5:a,77:[1,909],131:ie,156:K,196:908,200:910,290:Q,291:z,292:Z,293:ee},{2:r,3:911,4:n,5:a,77:[1,913],131:ie,156:K,196:912,200:914,290:Q,291:z,292:Z,293:ee},e(Gn,[2,440],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:915,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),e(Gn,[2,441],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:916,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),e(Gn,[2,442],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:917,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),e(Gn,[2,443],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:918,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),e(Gn,Vn,{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:919,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),{2:r,3:168,4:n,5:a,56:165,77:se,94:920,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:921,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Gn,[2,445],{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:922,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),{2:r,3:168,4:n,5:a,56:165,77:se,94:923,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:924,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{164:[1,926],166:[1,928],328:925,334:[1,927]},{2:r,3:168,4:n,5:a,56:165,77:se,94:929,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:930,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:695,4:n,5:a,77:[1,931],111:934,145:Bn,156:K,200:935,202:933,290:Q,291:z,292:Z,293:ee,329:932},{99:[1,937],297:[1,938]},{2:r,3:168,4:n,5:a,56:165,77:se,94:939,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:940,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:941,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{4:Pn,7:879,272:942,387:878,389:qn},e(jn,[2,88]),e(jn,[2,89]),{78:[1,943]},{78:[1,944]},{78:[1,945]},{78:[1,946],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(Ve,Be,{340:207,77:ct,198:je}),{78:[2,1107]},{78:[2,1108]},{134:re,135:ne},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:947,152:de,154:fe,156:K,158:167,164:[1,949],179:pe,180:be,181:Ee,185:[1,948],196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:950,4:n,5:a,149:Hn,180:[1,952]},e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,118,122,128,129,130,131,132,134,135,137,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,314,330,331,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,416],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,332:tr}),e(Jn,[2,417],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,180:_t,312:Pt,316:Vt}),e(Jn,[2,418],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,180:_t,312:Pt,316:Vt}),e(Yn,[2,419],{114:625,327:637,316:Vt}),e(Yn,[2,420],{114:625,327:637,316:Vt}),e(ar,[2,365]),e(ar,[2,1113]),e(ar,[2,1114]),e(ar,[2,366]),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,231,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,362]),{2:r,3:168,4:n,5:a,56:165,77:se,94:953,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ur,[2,620]),e(ur,[2,621]),e(ur,[2,622]),e(ur,[2,623]),e(ur,[2,625]),{40:954,79:75,89:c,184:99,189:f},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,304:955,307:677,308:or,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{305:956,306:Wn,307:957,308:or,310:Xn},e(Kn,[2,372]),{2:r,3:168,4:n,5:a,56:165,77:se,94:959,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:960,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{4:Pn,7:879,272:961,387:878,389:qn},e(ur,[2,626]),{74:[1,963],300:[1,962]},e(ur,[2,642]),e(Qn,[2,649]),e(zn,[2,627]),e(zn,[2,628]),e(zn,[2,629]),e(zn,[2,630]),e(zn,[2,631]),e(zn,[2,632]),e(zn,[2,633]),e(zn,[2,634]),e(zn,[2,635]),{2:r,3:168,4:n,5:a,56:165,77:se,94:964,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e([2,4,5,10,53,72,74,76,78,89,93,95,98,99,107,112,115,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,426,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],nr,{77:ut,116:Zn}),{74:fn,300:[1,966]},e(ea,[2,314],{77:ut}),e(Ke,[2,315]),{74:[1,968],426:[1,967]},e(ur,[2,639]),e(ta,[2,644]),{152:[1,969]},{152:[1,970]},{152:[1,971]},{40:976,77:[1,975],79:75,89:c,143:ce,144:979,145:Qe,149:ra,152:de,181:Ee,184:99,189:f,201:980,302:Ue,341:972,342:973,343:[1,974],344:na,419:190,420:qe,424:Ge},e(Ve,Be,{340:981,198:je}),{77:aa,143:ce,144:979,145:Qe,149:ra,152:de,181:Ee,201:980,302:Ue,341:982,342:983,344:na,419:190,420:qe,424:Ge},{230:[1,986],455:985},{2:r,3:219,4:n,5:a,77:He,132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,199:213,200:215,201:214,202:217,209:987,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},{231:[2,696]},{78:[1,988]},e(fr,[2,1093],{211:989,3:990,2:r,4:n,5:a}),e(dr,[2,1092]),e(fr,[2,183]),{2:r,3:991,4:n,5:a},{212:[1,992]},e(fr,[2,187]),{2:r,3:993,4:n,5:a},e(fr,[2,191]),{2:r,3:994,4:n,5:a},e(fr,[2,195]),{2:r,3:995,4:n,5:a},e(fr,[2,198]),{2:r,3:996,4:n,5:a},{2:r,3:997,4:n,5:a},{148:[1,998]},e(sa,[2,172],{82:999,183:[1,1e3]}),{2:r,3:219,4:n,5:a,132:[1,1005],143:ce,145:[1,1006],152:de,156:K,181:Ee,199:1001,200:1002,201:1003,202:1004,290:Q,291:z,292:Z,293:ee,302:Ue},{2:r,3:1011,4:n,5:a,109:1007,110:1008,111:1009,112:ia},e(vr,[2,1058]),e(oa,[2,1049],{91:1012,182:1013,183:[1,1014]}),e(Xe,[2,1048],{153:1015,179:ua,180:ca,181:la}),e([2,4,5,10,72,74,76,78,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,198,280,281,282,283,284,285,286,287,288,306,310,420,424,602,764],[2,90],{77:[1,1019]}),{119:[1,1020]},e(ha,[2,93]),{2:r,3:1021,4:n,5:a},e(ha,[2,95]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1022,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1023,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,114:736,115:At,116:yt,117:1025,118:Nr,122:Cr,123:Rr,124:Or,125:1024,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{77:[1,1026]},{77:[1,1027]},{77:[1,1028]},{77:[1,1029]},e(ha,[2,104]),e(ha,[2,105]),e(ha,[2,106]),e(ha,[2,107]),e(ha,[2,108]),e(ha,[2,109]),{2:r,3:1030,4:n,5:a},{2:r,3:1031,4:n,5:a,133:[1,1032]},e(ha,[2,113]),e(ha,[2,114]),e(ha,[2,115]),e(ha,[2,116]),e(ha,[2,117]),e(ha,[2,118]),{2:r,3:1033,4:n,5:a,77:ir,113:669,131:ie,132:oe,143:ce,152:de,181:Ee,196:670,201:672,257:671,294:xe,295:De,296:ke,302:Ue,419:673,424:Ge},{145:[1,1034]},{77:[1,1035]},{145:[1,1036]},e(ha,[2,123]),{77:[1,1037]},{2:r,3:1038,4:n,5:a},{77:[1,1039]},{77:[1,1040]},{77:[1,1041]},{77:[1,1042]},{77:[1,1043],164:[1,1044]},{77:[1,1045]},{77:[1,1046]},{77:[1,1047]},{77:[1,1048]},{77:[1,1049]},{77:[1,1050]},{77:[1,1051]},{77:[1,1052]},{77:[1,1053]},{77:[2,1073]},{77:[2,1074]},{2:r,3:244,4:n,5:a,199:1054},{2:r,3:244,4:n,5:a,199:1055},{113:1056,132:oe,296:ke},e(X,[2,596],{112:[1,1057]}),{2:r,3:244,4:n,5:a,199:1058},{113:1059,132:oe,296:ke},{2:r,3:1060,4:n,5:a},e(X,[2,693]),e(X,[2,68]),{2:r,3:236,4:n,5:a,75:1061},{77:[1,1062]},e(X,[2,674]),e(X,[2,586]),{2:r,3:1011,4:n,5:a,111:1065,143:da,145:fa,147:1063,336:1064,337:1066},{144:1069,145:Qe,419:190,420:qe,424:Ge},e(X,[2,671]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1070,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Gn,Vn,{255:146,200:147,256:148,111:149,254:150,196:151,257:152,113:153,258:154,201:155,202:156,259:157,260:158,261:159,144:161,262:162,263:163,56:165,158:167,3:168,419:190,94:1071,2:r,4:n,5:a,77:se,131:ie,132:oe,137:ue,143:ce,145:le,149:he,152:de,154:fe,156:K,179:pe,180:be,181:Ee,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,420:qe,424:Ge}),{113:1072,132:oe,296:ke},{2:r,3:266,4:n,5:a,446:1073,447:Ze},{2:r,3:168,4:n,5:a,56:165,77:se,94:1075,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,230:En,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge,429:1074,433:gn},e(X,[2,651]),{114:1077,115:At,116:yt,124:[1,1076]},e(X,[2,663]),e(X,[2,664]),{2:r,3:1079,4:n,5:a,77:pa,131:ba,432:1078},{114:807,115:At,116:yt,124:[1,1082],430:1083},e(X,[2,753],{74:mn}),{2:r,3:100,4:n,5:a,504:1084},{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,174:1085,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:816,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,174:1086,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:816,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,174:1087,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:816,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Tn,[2,151]),e(Tn,[2,1088],{74:Ea}),e(ga,[2,273]),e(ga,[2,280],{114:625,327:637,3:1090,113:1092,2:r,4:n,5:a,76:[1,1089],99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,131:[1,1091],132:oe,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,296:ke,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(rt,[2,1089],{197:1093,765:[1,1094]}),{131:ie,196:1095},{74:mn,78:[1,1096]},e(W,[2,11]),{148:[1,1097],190:[1,1098]},{190:[1,1099]},{190:[1,1100]},{190:[1,1101]},e(X,[2,575],{76:[1,1103],77:[1,1102]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1104,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ar,[2,346]),e(Sn,[2,1112]),e(Sn,[2,1109]),e(Sn,[2,1110]),{74:fn,78:[1,1105]},{74:fn,78:[1,1106]},{74:[1,1107]},{74:[1,1108]},{74:[1,1109]},{74:[1,1110]},e(ar,[2,353]),e(X,[2,580]),{298:[1,1111]},{2:r,3:1112,4:n,5:a,113:1113,132:oe,296:ke},{2:r,3:244,4:n,5:a,199:1114},{230:[1,1115]},{2:r,3:578,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,431:585,474:1116,475:576,478:577,482:582,493:579,497:581},e(X,[2,730],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(vn,[2,1145],{477:1117,483:1118,76:ma}),e(Cn,[2,1144]),{2:r,3:1122,4:n,5:a,132:dt,137:ft,144:1121,145:Qe,152:pt,419:190,420:qe,424:Ge,475:1120,493:579,497:581},{2:r,3:1122,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,431:585,475:1124,478:1123,482:582,493:579,497:581},{2:r,3:578,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,431:585,473:1125,474:575,475:576,478:577,482:582,493:579,497:581},e(In,[2,1163],{491:1126,132:[1,1127]}),e(On,[2,1162]),e(xn,[2,1169],{495:1128,497:1129,152:pt}),e(In,[2,1168]),e(xn,[2,746]),e(xn,[2,1172]),e(On,[2,749]),e(On,[2,750]),e(xn,[2,748]),e(Dn,[2,740]),{2:r,3:244,4:n,5:a,199:1130},{2:r,3:244,4:n,5:a,199:1131},{2:r,3:168,4:n,5:a,56:165,77:se,94:1132,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(va,[2,1139],{467:1133,113:1134,132:oe,296:ke}),e(kn,[2,1138]),{2:r,3:1135,4:n,5:a},{335:Sa,338:Ta,339:Aa,511:1136},{2:r,3:244,4:n,5:a,199:1140},e(Ln,[2,765]),e(Ln,[2,766]),e(Ln,[2,767]),{129:[1,1141]},{266:[1,1142]},{266:[1,1143]},e(Et,[2,688]),e(Et,[2,689],{124:[1,1144]}),{4:Pn,7:879,272:1145,387:878,389:qn},e([2,4,10,53,72,74,76,77,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,542],{5:[1,1146]}),e([2,5,10,53,72,74,76,78,89,93,95,98,99,107,112,115,116,118,122,123,124,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,230,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,297,300,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,343,356,368,369,373,374,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,539],{4:[1,1148],77:[1,1147]}),{77:[1,1149]},e(ya,[2,4]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1150,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(X,[2,588]),e(yn,[2,568]),{2:r,3:1151,4:n,5:a,113:1152,132:oe,296:ke},e(X,[2,564],{74:Na}),e(Et,[2,566]),e(X,[2,613],{74:Na}),e(X,[2,668]),e(X,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:1154,2:r,4:n,5:a,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(Ca,[2,376],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt,318:jt,319:Ht}),e(Yn,[2,377],{114:625,327:637,316:Vt}),e(Ca,[2,378],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt,318:jt,319:Ht}),e(Ra,[2,379],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,314:[1,1155],316:Vt,317:Bt,318:jt,319:Ht}),e(Ra,[2,381],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,314:[1,1156],316:Vt,317:Bt,318:jt,319:Ht}),e(Ke,[2,383],{114:625,327:637}),e(Jn,[2,384],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,180:_t,312:Pt,316:Vt}),e(Jn,[2,385],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,180:_t,312:Pt,316:Vt}),e(Oa,[2,386],{114:625,327:637,115:At,116:yt,123:Nt,136:Ot,312:Pt,316:Vt}),e(Oa,[2,387],{114:625,327:637,115:At,116:yt,123:Nt,136:Ot,312:Pt,316:Vt}),e(Oa,[2,388],{114:625,327:637,115:At,116:yt,123:Nt,136:Ot,312:Pt,316:Vt}),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,112,118,122,123,124,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,179,180,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,311,313,314,315,317,318,319,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,389],{114:625,327:637,115:At,116:yt,136:Ot,312:Pt,316:Vt}),e(wa,[2,390],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt}),e(wa,[2,391],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt}),e(wa,[2,392],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt}),e(wa,[2,393],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt}),e(ea,[2,394],{77:ut}),e(Ke,[2,395]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1157,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,397]),e(ea,[2,398],{77:ut}),e(Ke,[2,399]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1158,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,401]),e(Ia,[2,402],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,403],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,404],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,405],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e([2,4,5,10,53,72,89,99,124,139,140,146,154,156,170,171,189,266,267,290,306,310,320,321,322,323,324,325,326,330,331,333,335,338,339,396,400,401,404,406,408,409,417,418,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,517,602,764],xa,{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,407],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,408],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,409],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,410],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Ia,[2,411],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),{77:[1,1159]},{77:[2,446]},{77:[2,447]},{77:[2,448]},e(Da,[2,414],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,332:tr}),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,107,118,122,128,129,130,131,132,134,135,137,143,145,146,148,149,150,152,156,162,164,166,168,169,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,314,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,415],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr}),{2:r,3:168,4:n,5:a,40:1160,56:165,77:se,78:[1,1162],79:75,89:c,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1161,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,184:99,189:f,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,428]),e(Ke,[2,430]),e(Ke,[2,437]),e(Ke,[2,438]),{2:r,3:667,4:n,5:a,77:[1,1163]},{2:r,3:695,4:n,5:a,77:[1,1164],111:934,145:Bn,156:K,200:935,202:1166,290:Q,291:z,292:Z,293:ee,329:1165},e(Ke,[2,435]),e(Da,[2,432],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,332:tr}),e(Da,[2,433],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,332:tr}),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,99,107,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,189,198,206,208,222,223,224,225,226,227,228,229,232,239,242,243,245,247,266,267,280,281,282,283,284,285,286,287,288,290,296,300,306,308,309,310,314,320,321,322,323,324,325,326,330,331,332,333,335,338,339,396,400,401,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,464,470,505,507,508,517,602,764],[2,434],{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht}),e(Ke,[2,436]),e(Ke,[2,306]),e(Ke,[2,307]),e(Ke,[2,308]),e(Ke,[2,421]),{74:fn,78:[1,1167]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1168,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1169,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,ka),e(La,[2,286]),e(Ke,[2,282]),{78:[1,1171],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1172]},{305:1173,306:Wn,307:957,308:or,310:Xn},{306:[1,1174]},e(Kn,[2,371]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1175,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,309:[1,1176],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{76:[1,1177],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{74:[1,1178]},e(ur,[2,640]),{2:r,3:695,4:n,5:a,77:cr,111:690,113:688,131:ie,132:oe,143:ce,144:685,145:Qe,152:de,156:K,181:Ee,196:687,200:693,201:692,257:689,258:691,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,300:[1,1179],302:Ue,419:190,420:qe,422:1180,423:686,424:Ge},{78:[1,1181],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:1182,4:n,5:a,149:Hn},e(Ke,[2,364]),e(ur,[2,637]),{2:r,3:704,4:n,5:a,131:lr,132:hr,426:[1,1183],428:1184},{2:r,3:695,4:n,5:a,77:cr,111:690,113:688,131:ie,132:oe,143:ce,144:685,145:Qe,152:de,156:K,181:Ee,196:687,200:693,201:692,257:689,258:691,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue,419:190,420:qe,422:1185,423:686,424:Ge},{2:r,3:695,4:n,5:a,77:cr,111:690,113:688,131:ie,132:oe,143:ce,144:685,145:Qe,152:de,156:K,181:Ee,196:687,200:693,201:692,257:689,258:691,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue,419:190,420:qe,422:1186,423:686,424:Ge},{2:r,3:695,4:n,5:a,77:cr,111:690,113:688,131:ie,132:oe,143:ce,144:685,145:Qe,152:de,156:K,181:Ee,196:687,200:693,201:692,257:689,258:691,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue,419:190,420:qe,422:1187,423:686,424:Ge},{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1188,419:190,420:qe,424:Ge},e($a,[2,458],{74:Ma}),{149:ra,341:1190,344:na},{2:r,3:168,4:n,5:a,56:165,77:se,94:1194,100:1191,111:1193,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,345:1192,419:190,420:qe,424:Ge},e($a,[2,466]),e(Ua,[2,469]),e(Ua,[2,470]),e(_a,[2,474]),e(_a,[2,475]),{2:r,3:244,4:n,5:a,199:1195},{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1196,419:190,420:qe,424:Ge},e($a,[2,462],{74:Ma}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1194,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,345:1192,419:190,420:qe,424:Ge},{308:Fa,456:1197,458:1198,459:1199},{2:r,3:168,4:n,5:a,56:165,77:se,94:1201,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{230:[2,697]},e(fr,[2,181],{3:1202,2:r,4:n,5:a,76:[1,1203]}),e(fr,[2,182]),e(fr,[2,1094]),e(fr,[2,184]),e(fr,[2,186]),e(fr,[2,188]),e(fr,[2,192]),e(fr,[2,196]),e(fr,[2,199]),e([2,4,5,10,53,72,74,76,77,78,89,93,95,98,118,124,128,143,145,146,148,149,152,154,156,162,168,169,181,183,187,189,206,208,222,223,224,225,226,227,228,229,230,231,232,245,247,266,267,290,297,302,306,310,335,338,339,343,344,356,368,369,373,374,396,400,401,402,403,404,406,408,409,417,418,420,424,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,514,515,516,517,602,764],[2,201]),{2:r,3:1204,4:n,5:a},e(Pa,[2,1045],{83:1205,92:1206,93:[1,1207],98:[1,1208]}),{2:r,3:219,4:n,5:a,77:[1,1210],132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,199:213,200:215,201:214,202:217,203:1209,209:1211,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},e(Er,[2,164]),e(Er,[2,165]),e(Er,[2,166]),e(Er,[2,167]),e(Er,[2,168]),{2:r,3:667,4:n,5:a},e(We,[2,83],{74:[1,1212]}),e(qa,[2,85]),e(qa,[2,86]),{113:1213,132:oe,296:ke},e([10,72,74,78,93,98,118,124,128,162,168,169,183,198,206,208,222,223,224,225,226,227,228,229,232,245,247,306,310,602,764],nr,{116:Zn}),e(oa,[2,73]),e(oa,[2,1050]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1214,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ha,[2,126]),e(ha,[2,144]),e(ha,[2,145]),e(ha,[2,146]),{2:r,3:168,4:n,5:a,56:165,77:se,78:[2,1065],94:260,111:149,113:153,127:1215,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1216,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{77:[1,1217]},e(ha,[2,94]),e([2,4,5,10,72,74,76,77,78,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,198,280,281,282,283,284,285,286,287,288,306,310,420,424,602,764],[2,96],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e([2,4,5,10,72,74,76,77,78,112,118,122,124,128,129,130,131,132,134,135,137,139,140,143,145,146,148,149,150,152,154,156,162,164,166,168,169,170,171,172,173,175,181,183,185,187,198,280,281,282,283,284,285,286,287,288,306,310,420,424,602,764],[2,97],{114:625,327:637,99:St,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1218],112:yr,114:736,115:At,116:yt,117:1219,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},e(Ga,[2,1061],{153:1015,179:ua,180:ca,181:la}),{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,114:736,115:At,116:yt,117:1221,118:Nr,122:Cr,123:Rr,124:Or,126:1220,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1222,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1223,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1224,4:n,5:a},e(ha,[2,110]),e(ha,[2,111]),e(ha,[2,112]),e(ha,[2,119]),{2:r,3:1225,4:n,5:a},{2:r,3:1011,4:n,5:a,111:1065,143:da,145:fa,147:1226,336:1064,337:1066},{2:r,3:1227,4:n,5:a},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1228,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ha,[2,125]),e(Ga,[2,1067],{155:1229}),e(Ga,[2,1069],{157:1230}),e(Ga,[2,1071],{159:1231}),e(Ga,[2,1075],{161:1232}),e(Va,Ba,{163:1233,178:1234}),{77:[1,1235]},e(Ga,[2,1077],{165:1236}),e(Ga,[2,1079],{167:1237}),e(Va,Ba,{178:1234,163:1238}),e(Va,Ba,{178:1234,163:1239}),e(Va,Ba,{178:1234,163:1240}),e(Va,Ba,{178:1234,163:1241}),{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,114:736,115:At,116:yt,117:1242,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,174:1243,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:816,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ja,[2,1081],{176:1244}),e(X,[2,606],{183:[1,1245]}),e(X,[2,602],{183:[1,1246]}),e(X,[2,595]),{113:1247,132:oe,296:ke},e(X,[2,604],{183:[1,1248]}),e(X,[2,599]),e(X,[2,600],{112:[1,1249]}),e(hn,[2,69]),{40:1250,79:75,89:c,184:99,189:f},e(X,[2,450],{74:Ha,128:[1,1251]}),e(Ja,[2,451]),{124:[1,1253]},{2:r,3:1254,4:n,5:a},e(Ve,[2,1115]),e(Ve,[2,1116]),e(X,[2,618]),e(pn,[2,355],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(Ia,xa,{114:625,327:637,112:Tt,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,332:tr}),e(Et,[2,682]),e(Et,[2,684]),e(X,[2,650]),e(X,[2,652],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1255,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1079,4:n,5:a,77:pa,131:ba,432:1256},e(Ya,[2,659]),e(Ya,[2,660]),e(Ya,[2,661]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1257,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1258,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{114:1077,115:At,116:yt,124:[1,1259]},e(vn,[2,755]),e(Tn,[2,148],{74:Ea}),e(Tn,[2,149],{74:Ea}),e(Tn,[2,150],{74:Ea}),{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:1260,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1261,4:n,5:a,113:1263,131:[1,1262],132:oe,296:ke},e(ga,[2,275]),e(ga,[2,277]),e(ga,[2,279]),e(rt,[2,160]),e(rt,[2,1090]),{78:[1,1264]},e(st,[2,758]),{2:r,3:1265,4:n,5:a},{2:r,3:1266,4:n,5:a},{2:r,3:1268,4:n,5:a,384:1267},{2:r,3:1268,4:n,5:a,384:1269},{2:r,3:1270,4:n,5:a},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1271,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1272,4:n,5:a},{74:fn,78:[1,1273]},e(ar,[2,347]),e(ar,[2,348]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1274,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1275,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1276,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1277,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(yn,[2,504]),e(X,Wa,{407:1278,76:Xa,77:[1,1279]}),e(X,Wa,{407:1281,76:Xa}),{77:[1,1282]},{2:r,3:244,4:n,5:a,199:1283},e(vn,[2,731]),e(vn,[2,733]),e(vn,[2,1146]),{143:et,145:tt,431:1284},e(Ka,[2,1147],{419:190,479:1285,144:1286,145:Qe,420:qe,424:Ge}),{76:ma,139:[2,1151],481:1287,483:1288},e([10,74,76,78,132,139,145,152,306,310,420,424,602,764],wn,{490:851,493:852,137:ft}),e(vn,[2,736]),e(vn,Rn),{74:Nn,78:[1,1289]},e(xn,[2,1165],{492:1290,497:1291,152:pt}),e(In,[2,1164]),e(xn,[2,745]),e(xn,[2,1170]),e(X,[2,490],{77:[1,1292]}),{76:[1,1294],77:[1,1293]},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,148:[1,1295],154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e($a,Qa,{79:75,184:99,468:1296,40:1299,89:c,146:za,189:f,470:Za}),e(va,[2,1140]),e(kn,[2,723]),{230:[1,1300]},e(es,[2,769]),e(es,[2,770]),e(es,[2,771]),e(Ln,$n,{510:1301,95:Mn,514:Un,515:_n,516:Fn}),e(Ln,[2,768]),e(X,[2,312]),e(X,[2,313]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1302,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Et,[2,690],{124:[1,1303]}),e(ya,[2,541]),{131:[1,1305],388:1304,390:[1,1306]},e(ya,[2,5]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1194,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,345:1307,419:190,420:qe,424:Ge},e(X,[2,455],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(X,[2,589]),e(X,[2,590]),{2:r,3:244,4:n,5:a,199:1308},e(X,[2,670]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1309,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1310,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{78:[1,1311],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1312],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:168,4:n,5:a,40:1313,56:165,77:se,79:75,89:c,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1314,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,184:99,189:f,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{78:[1,1315]},{74:fn,78:[1,1316]},e(Ke,[2,426]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1317,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,40:1318,56:165,77:se,78:[1,1320],79:75,89:c,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1319,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,184:99,189:f,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,429]),e(Ke,[2,431]),e(Ke,ts,{275:1321,276:rs}),{78:[1,1323],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1324],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:1325,4:n,5:a,180:[1,1326]},e(ur,[2,619]),e(Ke,[2,363]),{306:[1,1327]},e(Ke,[2,370]),{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,306:[2,374],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:168,4:n,5:a,56:165,77:se,94:1328,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{4:Pn,7:879,272:1329,387:878,389:qn},{2:r,3:168,4:n,5:a,56:165,77:se,94:1330,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ur,[2,641]),e(Qn,[2,648]),e(zn,[2,636]),e(La,ka),e(ur,[2,638]),e(ta,[2,643]),e(ta,[2,645]),e(ta,[2,646]),e(ta,[2,647]),e($a,[2,457],{74:Ma}),{77:[1,1332],143:ce,144:1333,145:Qe,152:de,181:Ee,201:1334,302:Ue,419:190,420:qe,424:Ge},e($a,[2,463]),{74:ns,78:[1,1335]},{74:as,78:[1,1337]},e([74,78,99,112,115,116,123,124,133,136,138,139,140,141,142,154,170,171,179,180,311,312,313,315,316,317,318,319,320,321,322,323,324,325,326,330,331,332,333],ss),e(is,[2,479],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{40:1341,77:aa,79:75,89:c,143:ce,144:979,145:Qe,149:ra,152:de,181:Ee,184:99,189:f,201:980,302:Ue,341:1339,342:1340,344:na,419:190,420:qe,424:Ge},e($a,[2,461],{74:Ma}),e(X,[2,717],{457:1342,458:1343,459:1344,308:Fa,464:[1,1345]}),e(os,[2,701]),e(os,[2,702]),{154:[1,1347],460:[1,1346]},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,308:[2,698],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(fr,[2,179]),{2:r,3:1348,4:n,5:a},e(X,[2,574]),e(us,[2,238],{84:1349,128:[1,1350]}),e(Pa,[2,1046]),{77:[1,1351]},{77:[1,1352]},e(sa,[2,169],{204:1353,215:1355,205:1356,216:1357,221:1360,74:cs,206:ls,208:hs,222:ds,223:fs,224:ps,225:bs,226:Es,227:gs,228:ms,229:vs}),{2:r,3:219,4:n,5:a,40:711,77:He,79:75,89:c,132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,184:99,189:f,199:213,200:215,201:214,202:217,203:1369,209:1211,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},e(Ss,[2,177]),{2:r,3:1011,4:n,5:a,110:1370,111:1009,112:ia},e(qa,[2,87]),e(oa,[2,147],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{78:[1,1371]},{74:fn,78:[2,1066]},{2:r,3:168,4:n,5:a,56:165,77:se,78:[2,1059],94:1376,111:149,113:153,120:1372,121:1373,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1374,242:[1,1375],254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ha,[2,98]),e(Ga,[2,1062],{153:1015,179:ua,180:ca,181:la}),{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1377],112:yr,114:736,115:At,116:yt,117:1378,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},e(Ga,[2,1063],{153:1015,179:ua,180:ca,181:la}),{78:[1,1379],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1380],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1381]},e(ha,[2,120]),{74:Ha,78:[1,1382]},e(ha,[2,122]),{74:fn,78:[1,1383]},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1384],112:yr,114:736,115:At,116:yt,117:1385,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1386],112:yr,114:736,115:At,116:yt,117:1387,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1388],112:yr,114:736,115:At,116:yt,117:1389,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1390],112:yr,114:736,115:At,116:yt,117:1391,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{74:Ts,78:[1,1392]},e(is,[2,143],{419:190,3:733,114:736,144:758,158:768,160:769,117:1394,2:r,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,115:At,116:yt,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,420:qe,424:Ge}),e(Va,Ba,{178:1234,163:1395}),{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1396],112:yr,114:736,115:At,116:yt,117:1397,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:733,4:n,5:a,72:Sr,76:Tr,77:Ar,78:[1,1398],112:yr,114:736,115:At,116:yt,117:1399,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{74:Ts,78:[1,1400]},{74:Ts,78:[1,1401]},{74:Ts,78:[1,1402]},{74:Ts,78:[1,1403]},{78:[1,1404],153:1015,179:ua,180:ca,181:la},{74:Ea,78:[1,1405]},{2:r,3:733,4:n,5:a,72:Sr,74:[1,1406],76:Tr,77:Ar,112:yr,114:736,115:At,116:yt,117:1407,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,144:758,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,158:768,160:769,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,419:190,420:qe,424:Ge},{2:r,3:1408,4:n,5:a},{2:r,3:1409,4:n,5:a},e(X,[2,597]),{2:r,3:1410,4:n,5:a},{113:1411,132:oe,296:ke},{78:[1,1412]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1413,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1011,4:n,5:a,111:1065,143:da,145:fa,336:1414,337:1066},{2:r,3:168,4:n,5:a,56:165,77:se,94:1415,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{124:[1,1416]},e(X,[2,653],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(Ya,[2,658]),{78:[1,1417],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(X,[2,654],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1418,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ga,[2,272]),e(ga,[2,274]),e(ga,[2,276]),e(ga,[2,278]),e(rt,[2,161]),e(X,[2,569]),{148:[1,1419]},e(X,[2,570]),e(vn,[2,536],{387:878,7:879,272:1420,4:Pn,386:[1,1421],389:qn}),e(X,[2,571]),e(X,[2,573]),{74:fn,78:[1,1422]},e(X,[2,577]),e(ar,[2,345]),{74:[1,1423],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{74:[1,1424],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{74:[1,1425],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{74:[1,1426],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(X,[2,581]),{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1427,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1428,4:n,5:a},e(X,[2,583]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1376,111:149,113:153,120:1429,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1374,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{77:[1,1430]},{2:r,3:1431,4:n,5:a},{76:ma,139:[2,1149],480:1432,483:1433},e(Ka,[2,1148]),{139:[1,1434]},{139:[2,1152]},e(vn,[2,737]),e(xn,[2,744]),e(xn,[2,1166]),{2:r,3:1268,4:n,5:a,76:[1,1437],351:1435,358:1436,384:1438},{2:r,3:1011,4:n,5:a,100:1439,111:1440},{40:1441,79:75,89:c,184:99,189:f},{2:r,3:168,4:n,5:a,56:165,77:se,94:1442,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e($a,[2,722]),{2:r,3:1011,4:n,5:a,111:1065,143:da,145:fa,147:1443,336:1064,337:1066},{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1444,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e($a,[2,727]),{2:r,3:244,4:n,5:a,199:1445},{335:Sa,338:Ta,339:Aa,511:1446},e(Et,[2,691],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1447,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{74:[1,1448],78:[1,1449]},e(is,[2,543]),e(is,[2,544]),{74:as,78:[1,1450]},e(Et,[2,565]),e(Ca,[2,380],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt,318:jt,319:Ht}),e(Ca,[2,382],{114:625,327:637,115:At,116:yt,123:Nt,133:Rt,136:Ot,138:wt,141:Dt,142:kt,179:Ut,180:_t,312:Pt,316:Vt,317:Bt,318:jt,319:Ht}),e(Ke,[2,396]),e(Ke,[2,400]),{78:[1,1451]},{74:fn,78:[1,1452]},e(Ke,[2,422]),e(Ke,[2,424]),{78:[1,1453],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1454]},{74:fn,78:[1,1455]},e(Ke,[2,427]),e(Ke,[2,327]),{77:[1,1456]},e(Ke,ts,{275:1457,276:rs}),e(Ke,ts,{275:1458,276:rs}),e(La,[2,284]),e(Ke,[2,281]),e(Ke,[2,369]),e(Kn,[2,373],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{74:[1,1460],78:[1,1459]},{74:[1,1462],78:[1,1461],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{2:r,3:1325,4:n,5:a},{2:r,3:168,4:n,5:a,56:165,77:se,94:1194,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,345:1463,419:190,420:qe,424:Ge},e(_a,[2,477]),e(_a,[2,478]),{40:1466,77:aa,79:75,89:c,143:ce,144:979,145:Qe,149:ra,152:de,181:Ee,184:99,189:f,201:980,302:Ue,341:1464,342:1465,344:na,419:190,420:qe,424:Ge},{2:r,3:1011,4:n,5:a,111:1467},e(_a,[2,473]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1468,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1469,419:190,420:qe,424:Ge},e($a,[2,460],{74:Ma}),e($a,[2,467]),e(X,[2,694]),e(os,[2,699]),e(os,[2,700]),{2:r,3:168,4:n,5:a,56:165,77:se,94:817,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,174:1470,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,253:816,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{170:[1,1472],309:[1,1471]},{460:[1,1473]},e(fr,[2,180]),e(As,[2,240],{85:1474,232:[1,1475]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1476,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1477,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1478,4:n,5:a},e(sa,[2,170],{216:1357,221:1360,215:1479,205:1480,206:ls,208:hs,222:ds,223:fs,224:ps,225:bs,226:Es,227:gs,228:ms,229:vs}),{2:r,3:219,4:n,5:a,77:He,132:Je,143:ce,144:212,145:le,152:de,156:K,181:Ee,199:213,200:215,201:214,202:217,209:1481,213:Ye,214:218,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},e(ys,[2,205]),e(ys,[2,206]),{2:r,3:219,4:n,5:a,77:[1,1486],143:ce,144:1484,145:le,152:de,156:K,181:Ee,199:1483,200:1487,201:1485,202:1488,217:1482,290:Q,291:z,292:Z,293:ee,302:Ue,419:190,420:qe,424:Ge},{207:[1,1489],223:Ns},{207:[1,1491],223:Cs},e(Rs,[2,222]),{206:[1,1495],208:[1,1494],221:1493,223:fs,224:ps,225:bs,226:Es,227:gs,228:ms,229:vs},e(Rs,[2,224]),{223:[1,1496]},{208:[1,1498],223:[1,1497]},{208:[1,1500],223:[1,1499]},{208:[1,1501]},{223:[1,1502]},{223:[1,1503]},{74:cs,204:1504,205:1356,206:ls,208:hs,215:1355,216:1357,221:1360,222:ds,223:fs,224:ps,225:bs,226:Es,227:gs,228:ms,229:vs},e(qa,[2,84]),e(ha,[2,100]),{74:Os,78:[1,1505]},{78:[1,1507]},e(ws,[2,261]),{78:[2,1060]},e(ws,[2,263],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,242:[1,1508],243:[1,1509],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(ha,[2,99]),e(Ga,[2,1064],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,101]),e(ha,[2,102]),e(ha,[2,103]),e(ha,[2,121]),e(ha,[2,124]),e(ha,[2,127]),e(Ga,[2,1068],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,128]),e(Ga,[2,1070],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,129]),e(Ga,[2,1072],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,130]),e(Ga,[2,1076],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,131]),e(Va,[2,1083],{177:1510}),e(Va,[2,1086],{153:1015,179:ua,180:ca,181:la}),{74:Ts,78:[1,1511]},e(ha,[2,133]),e(Ga,[2,1078],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,134]),e(Ga,[2,1080],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,135]),e(ha,[2,136]),e(ha,[2,137]),e(ha,[2,138]),e(ha,[2,139]),e(ha,[2,140]),{2:r,3:168,4:n,5:a,56:165,77:se,94:260,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,151:1512,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ja,[2,1082],{153:1015,179:ua,180:ca,181:la}),e(X,[2,607]),e(X,[2,603]),e(X,[2,605]),e(X,[2,601]),e(hn,[2,71]),e(X,[2,449],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(Ja,[2,452]),e(Ja,[2,453],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1513,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ya,[2,662]),e(X,[2,655],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:1514,4:n,5:a},e(vn,[2,545],{385:1515,391:1516,392:1517,366:1525,154:Is,187:xs,230:Ds,297:ks,343:Ls,356:$s,368:Ms,369:Us,373:_s,374:Fs}),e(vn,[2,535]),e(X,[2,576],{76:[1,1529]}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1530,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1531,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1532,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1533,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{74:fn,78:[1,1534]},e(X,[2,585]),{74:Os,78:[1,1535]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1376,111:149,113:153,120:1536,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1374,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e([10,74,78,139,306,310,602,764],[2,741]),{139:[1,1537]},{139:[2,1150]},{2:r,3:1122,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,431:585,475:1124,478:1538,482:582,493:579,497:581},{78:[1,1539]},{74:[1,1540],78:[2,506]},{40:1541,79:75,89:c,184:99,189:f},e(is,[2,532]),{74:ns,78:[1,1542]},e(Ss,ss),e(X,[2,1133],{412:1543,413:1544,72:Ps}),e($a,Qa,{79:75,184:99,114:625,327:637,40:1299,468:1546,89:c,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,146:za,154:Lt,170:$t,171:Mt,179:Ut,180:_t,189:f,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr,470:Za}),e($a,[2,725],{74:Ha}),e($a,[2,726],{74:fn}),e([10,53,72,89,124,146,156,189,266,267,290,306,310,335,338,339,396,400,401,404,406,408,409,417,418,434,436,437,439,440,441,442,443,447,448,451,452,505,507,508,517,602,764],[2,1181],{512:1547,3:1548,2:r,4:n,5:a,76:[1,1549]}),e(qs,[2,1183],{513:1550,76:[1,1551]}),e(Et,[2,692],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{131:[1,1552]},e(ya,[2,538]),e(ya,[2,540]),e(Ke,[2,412]),e(Ke,[2,413]),e(Ke,[2,439]),e(Ke,[2,423]),e(Ke,[2,425]),{118:Gs,277:1553,278:1554,279:[1,1555]},e(Ke,[2,328]),e(Ke,[2,329]),e(Ke,[2,316]),{131:[1,1557]},e(Ke,[2,318]),{131:[1,1558]},{74:as,78:[1,1559]},{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1560,419:190,420:qe,424:Ge},e($a,[2,465],{74:Ma}),e($a,[2,468]),e(Ss,[2,488]),e(is,[2,480],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e($a,[2,459],{74:Ma}),e(X,[2,718],{74:Ea,198:[1,1561]}),{335:Vs,338:Bs,461:1562},{2:r,3:168,4:n,5:a,56:165,77:se,94:1565,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{119:[1,1567],170:[1,1568],309:[1,1566]},e(js,[2,259],{86:1569,118:[1,1570]}),{119:[1,1571]},e(us,[2,239],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{95:[1,1572],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{95:[1,1573]},e(ys,[2,203]),e(ys,[2,204]),e(Ss,[2,178]),e(ys,[2,237],{218:1574,230:[1,1575],231:[1,1576]}),e(Hs,[2,208],{3:1577,2:r,4:n,5:a,76:[1,1578]}),e(Js,[2,1095],{219:1579,76:[1,1580]}),{2:r,3:1581,4:n,5:a,76:[1,1582]},{40:1583,79:75,89:c,184:99,189:f},e(Hs,[2,216],{3:1584,2:r,4:n,5:a,76:[1,1585]}),e(Hs,[2,219],{3:1586,2:r,4:n,5:a,76:[1,1587]}),{77:[1,1588]},e(Rs,[2,234]),{77:[1,1589]},e(Rs,[2,230]),e(Rs,[2,223]),{223:Cs},{223:Ns},e(Rs,[2,225]),e(Rs,[2,226]),{223:[1,1590]},e(Rs,[2,228]),{223:[1,1591]},{223:[1,1592]},e(Rs,[2,232]),e(Rs,[2,233]),{78:[1,1593],205:1480,206:ls,208:hs,215:1479,216:1357,221:1360,222:ds,223:fs,224:ps,225:bs,226:Es,227:gs,228:ms,229:vs},e(ha,[2,91]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1376,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1594,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ha,[2,92]),e(ws,[2,264]),{244:[1,1595]},e(is,[2,142],{419:190,3:733,114:736,144:758,158:768,160:769,117:1596,2:r,4:n,5:a,72:Sr,76:Tr,77:Ar,112:yr,115:At,116:yt,118:Nr,122:Cr,123:Rr,124:Or,128:wr,129:Ir,130:xr,131:Dr,132:kr,133:Lr,134:$r,135:Mr,136:Ur,137:_r,138:Fr,139:Pr,140:qr,141:Gr,142:Vr,143:Br,145:jr,146:Hr,148:Jr,149:Yr,150:Wr,152:Xr,154:Kr,156:Qr,162:zr,164:Zr,166:en,168:tn,169:rn,170:nn,171:an,172:sn,173:on,175:un,185:cn,187:ln,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,420:qe,424:Ge}),e(ha,[2,132]),{74:fn,78:[1,1597]},e(Ja,[2,454],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(X,[2,572]),e(vn,[2,534]),e(vn,[2,546],{366:1525,392:1598,154:Is,187:xs,230:Ds,297:ks,343:Ls,356:$s,368:Ms,369:Us,373:_s,374:Fs}),e(dn,[2,548]),{370:[1,1599]},{370:[1,1600]},{2:r,3:244,4:n,5:a,199:1601},e(dn,[2,554],{77:[1,1602]}),{2:r,3:114,4:n,5:a,77:[1,1604],113:251,131:ie,132:oe,143:ce,152:de,156:K,181:Ee,196:250,200:1605,201:254,257:252,258:253,265:ze,274:1603,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue},e(dn,[2,558]),{297:[1,1606]},e(dn,[2,560]),e(dn,[2,561]),{335:[1,1607]},{77:[1,1608]},{2:r,3:1609,4:n,5:a},{78:[1,1610],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1611],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1612],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{78:[1,1613],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(X,Wa,{407:1614,76:Xa}),e(X,[2,591]),{74:Os,78:[1,1615]},{2:r,3:1122,4:n,5:a,132:dt,137:ft,143:et,145:tt,152:pt,431:585,475:1124,478:1616,482:582,493:579,497:581},e(vn,[2,735]),e(X,[2,493],{352:1617,354:1618,355:1619,4:Ys,243:Ws,343:Xs,356:Ks}),e(Qs,zs,{3:1268,359:1624,384:1625,360:1626,361:1627,2:r,4:n,5:a,367:Zs}),{78:[2,507]},{76:[1,1629]},e(X,[2,609]),e(X,[2,1134]),{368:[1,1631],414:[1,1630]},e($a,[2,728]),e(X,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:1632,2:r,4:n,5:a,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(X,[2,762]),e(qs,[2,1182]),e(X,t,{17:5,18:7,19:8,20:9,21:10,22:11,23:12,24:13,25:14,26:15,27:16,28:17,29:18,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:36,48:37,49:38,50:39,51:40,52:41,54:43,55:44,56:45,57:46,58:47,59:48,60:49,61:50,62:51,63:52,64:53,65:54,66:55,67:56,68:57,69:58,70:59,71:60,79:75,504:95,184:99,3:100,12:1633,2:r,4:n,5:a,53:o,72:u,89:c,124:l,146:h,156:d,189:f,266:p,267:b,290:E,335:m,338:v,339:S,396:T,400:A,401:y,404:N,406:C,408:R,409:O,417:w,418:I,434:x,436:D,437:k,439:L,440:$,441:M,442:U,443:_,447:F,448:P,451:q,452:G,505:V,507:B,508:j,517:H}),e(qs,[2,1184]),{78:[1,1634]},{78:[1,1635],118:Gs,278:1636},{78:[1,1637]},{119:[1,1638]},{119:[1,1639]},{78:[1,1640]},{78:[1,1641]},e(_a,[2,476]),e($a,[2,464],{74:Ma}),{2:r,3:244,4:n,5:a,143:et,145:tt,199:1643,431:1642},e(os,[2,703]),e(os,[2,705]),{146:[1,1644]},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,309:[1,1645],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},{339:ei,462:1646},{417:[1,1649],463:[1,1648]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1650,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(ti,[2,267],{87:1651,245:[1,1652],247:[1,1653]}),{119:[1,1654]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,233:1655,235:1656,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1661,4:n,5:a},{2:r,3:1662,4:n,5:a},e(ys,[2,207]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1663,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1011,4:n,5:a,100:1664,111:1440},e(Hs,[2,209]),{2:r,3:1665,4:n,5:a},e(Hs,[2,1097],{220:1666,3:1667,2:r,4:n,5:a}),e(Js,[2,1096]),e(Hs,[2,212]),{2:r,3:1668,4:n,5:a},{78:[1,1669]},e(Hs,[2,217]),{2:r,3:1670,4:n,5:a},e(Hs,[2,220]),{2:r,3:1671,4:n,5:a},{40:1672,79:75,89:c,184:99,189:f},{40:1673,79:75,89:c,184:99,189:f},e(Rs,[2,227]),e(Rs,[2,229]),e(Rs,[2,231]),e(sa,[2,171]),e(ws,[2,262]),e(ws,[2,265],{242:[1,1674]}),e(Va,[2,1084],{153:1015,179:ua,180:ca,181:la}),e(ha,[2,141]),e(dn,[2,547]),e(dn,[2,550]),{374:[1,1675]},e(dn,[2,1127],{395:1676,393:1677,77:si}),{131:ie,196:1679},e(dn,[2,555]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1680,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(dn,[2,557]),e(dn,[2,559]),{2:r,3:114,4:n,5:a,77:[1,1682],113:251,131:ie,132:oe,143:ce,152:de,156:K,181:Ee,196:250,200:255,201:254,257:252,258:253,265:ze,274:1681,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,302:Ue},{2:r,3:168,4:n,5:a,56:165,77:se,94:1683,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(X,[2,578]),e(ar,[2,349]),e(ar,[2,350]),e(ar,[2,351]),e(ar,[2,352]),e(X,[2,582]),e(X,[2,592]),e(vn,[2,734]),e(X,[2,489]),e(X,[2,494],{355:1684,4:Ys,243:Ws,343:Xs,356:Ks}),e(ii,[2,496]),e(ii,[2,497]),{124:[1,1685]},{124:[1,1686]},{124:[1,1687]},{74:[1,1688],78:[2,505]},e(is,[2,533]),e(is,[2,508]),{187:[1,1696],193:[1,1697],362:1689,363:1690,364:1691,365:1692,366:1693,368:Ms,369:[1,1694],370:[1,1698],373:[1,1695]},{2:r,3:1699,4:n,5:a},{40:1700,79:75,89:c,184:99,189:f},{415:[1,1701]},{416:[1,1702]},e(X,[2,761]),e(X,[2,763]),e(ya,[2,537]),e(Ke,[2,331]),{78:[1,1703]},e(Ke,[2,332]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,233:1704,235:1656,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1376,111:149,113:153,120:1705,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1374,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(Ke,[2,317]),e(Ke,[2,319]),{2:r,3:1706,4:n,5:a},e(X,[2,720],{77:[1,1707]}),{2:r,3:1011,4:n,5:a,111:1065,143:da,145:fa,147:1708,336:1064,337:1066},{335:Vs,338:Bs,461:1709},e(os,[2,707]),{77:[1,1711],343:[1,1712],344:[1,1710]},{170:[1,1714],309:[1,1713]},{170:[1,1716],309:[1,1715]},{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,309:[1,1717],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(oa,[2,250],{88:1718,162:[1,1719],168:[1,1721],169:[1,1720]}),{131:ie,196:1722},{131:ie,196:1723},{2:r,3:168,4:n,5:a,56:165,77:se,94:1376,111:149,113:153,120:1724,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,241:1374,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},e(As,[2,248],{234:1725,74:oi,239:[1,1727]}),e(ui,[2,242]),{146:[1,1728]},{77:[1,1729]},{77:[1,1730]},e(ui,[2,247],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{78:[2,1051],96:1731,99:[1,1733],102:1732},{99:[1,1734]},e(ys,[2,235],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),e(ys,[2,236],{74:ns}),e(Hs,[2,210]),e(Hs,[2,211]),e(Hs,[2,1098]),e(Hs,[2,213]),{2:r,3:1735,4:n,5:a,76:[1,1736]},e(Hs,[2,218]),e(Hs,[2,221]),{78:[1,1737]},{78:[1,1738]},e(ws,[2,266]),{2:r,3:244,4:n,5:a,199:1739},e(dn,[2,552]),e(dn,[2,1128]),{2:r,3:1740,4:n,5:a},{74:[1,1741]},{78:[1,1742],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(dn,[2,562]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1743,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{78:[1,1744],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(ii,[2,495]),{2:r,3:1745,4:n,5:a},{131:ie,196:1746},{2:r,3:1747,4:n,5:a},e(Qs,zs,{361:1627,360:1748,367:Zs}),e(vn,[2,510]),e(vn,[2,511]),e(vn,[2,512]),e(vn,[2,513]),e(vn,[2,514]),{370:[1,1749]},{370:[1,1750]},e(ci,[2,1121],{382:1751,370:[1,1752]}),{2:r,3:1753,4:n,5:a},{2:r,3:1754,4:n,5:a},e(Qs,[2,516]),e(X,[2,1131],{411:1755,413:1756,72:Ps}),e(X,[2,610]),e(X,[2,611],{367:[1,1757]}),e(Ke,[2,333]),e([78,118],[2,334],{74:oi}),{74:Os,78:[2,335]},e(X,[2,719]),{2:r,3:1011,4:n,5:a,100:1758,111:1440},e(os,[2,706],{74:Ha}),e(os,[2,704]),{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1759,419:190,420:qe,424:Ge},{2:r,3:1011,4:n,5:a,100:1760,111:1440},{344:[1,1761]},{339:ei,462:1762},{2:r,3:168,4:n,5:a,56:165,77:se,94:1763,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{339:ei,462:1764},{2:r,3:168,4:n,5:a,56:165,77:se,94:1765,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{339:ei,462:1766},e(oa,[2,72]),{40:1767,79:75,89:c,164:[1,1768],184:99,189:f,240:[1,1769]},{40:1770,79:75,89:c,184:99,189:f,240:[1,1771]},{40:1772,79:75,89:c,184:99,189:f,240:[1,1773]},e(ti,[2,270],{246:1774,247:[1,1775]}),{248:1776,249:[2,1099],766:[1,1777]},e(js,[2,260],{74:Os}),e(As,[2,241]),{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,235:1778,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1779,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{77:[1,1780]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,233:1781,235:1656,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,233:1782,235:1656,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{78:[1,1783]},{78:[2,1052]},{77:[1,1784]},{77:[1,1785]},e(Hs,[2,214]),{2:r,3:1786,4:n,5:a},{2:r,3:1787,4:n,5:a,76:[1,1788]},{2:r,3:1789,4:n,5:a,76:[1,1790]},e(dn,[2,1125],{394:1791,393:1792,77:si}),{78:[1,1793]},{131:ie,196:1794},e(dn,[2,556]),{78:[1,1795],99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(dn,[2,517]),e(ii,[2,498]),e(ii,[2,499]),e(ii,[2,500]),e(is,[2,509]),{2:r,3:1797,4:n,5:a,77:[2,1117],371:1796},{77:[1,1798]},{2:r,3:1800,4:n,5:a,77:[2,1123],383:1799},e(ci,[2,1122]),{77:[1,1801]},{77:[1,1802]},e(X,[2,608]),e(X,[2,1132]),e(Qs,zs,{361:1627,360:1803,367:Zs}),{74:ns,78:[1,1804]},e(os,[2,713],{74:Ma}),{74:ns,78:[1,1805]},e(os,[2,715]),e(os,[2,708]),{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,309:[1,1806],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(os,[2,711]),{99:St,112:Tt,114:625,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,309:[1,1807],311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,327:637,330:Zt,331:er,332:tr,333:rr},e(os,[2,709]),e(oa,[2,251]),{40:1808,79:75,89:c,184:99,189:f,240:[1,1809]},{40:1810,79:75,89:c,184:99,189:f},e(oa,[2,253]),{40:1811,79:75,89:c,184:99,189:f},e(oa,[2,254]),{40:1812,79:75,89:c,184:99,189:f},e(ti,[2,268]),{131:ie,196:1813},{249:[1,1814]},{249:[2,1100]},e(ui,[2,243]),e(As,[2,249],{114:625,327:637,99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1660,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,233:1815,235:1656,236:ri,237:ni,238:ai,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{74:oi,78:[1,1816]},{74:oi,78:[1,1817]},e(Pa,[2,1053],{97:1818,104:1819,3:1821,2:r,4:n,5:a,76:li}),{2:r,3:168,4:n,5:a,56:165,77:se,94:1824,103:1822,105:1823,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1011,4:n,5:a,100:1825,111:1440},e(Hs,[2,215]),e(ys,[2,173]),{2:r,3:1826,4:n,5:a},e(ys,[2,175]),{2:r,3:1827,4:n,5:a},e(dn,[2,551]),e(dn,[2,1126]),e(dn,[2,549]),{78:[1,1828]},e(dn,[2,563]),{77:[1,1829]},{77:[2,1118]},{2:r,3:1831,4:n,5:a,132:hi,372:1830},{77:[1,1833]},{77:[2,1124]},{2:r,3:1011,4:n,5:a,100:1834,111:1440},{2:r,3:1011,4:n,5:a,100:1835,111:1440},e(X,[2,612]),e(X,[2,721]),{343:[1,1837],344:[1,1836]},{339:ei,462:1838},{335:Vs,338:Bs,461:1839},e(oa,[2,252]),{40:1840,79:75,89:c,184:99,189:f},e(oa,[2,255]),e(oa,[2,257]),e(oa,[2,258]),e(ti,[2,271]),{131:[2,1101],250:1841,645:[1,1842]},{74:oi,78:[1,1843]},e(ui,[2,245]),e(ui,[2,246]),e(Pa,[2,74]),e(Pa,[2,1054]),{2:r,3:1844,4:n,5:a},e(Pa,[2,78]),{74:[1,1846],78:[1,1845]},e(is,[2,80]),e(is,[2,81],{114:625,327:637,76:[1,1847],99:St,112:Tt,115:At,116:yt,123:Nt,124:bn,133:Rt,136:Ot,138:wt,139:It,140:xt,141:Dt,142:kt,154:Lt,170:$t,171:Mt,179:Ut,180:_t,311:Ft,312:Pt,313:qt,315:Gt,316:Vt,317:Bt,318:jt,319:Ht,320:Jt,321:Yt,322:Wt,323:Xt,324:Kt,325:Qt,326:zt,330:Zt,331:er,332:tr,333:rr}),{74:ns,78:[1,1848]},e(ys,[2,174]),e(ys,[2,176]),e(dn,[2,553]),{2:r,3:1831,4:n,5:a,132:hi,372:1849},{74:di,78:[1,1850]},e(is,[2,528]),e(is,[2,529]),{2:r,3:1011,4:n,5:a,100:1852,111:1440},{74:ns,78:[1,1853]},{74:ns,78:[1,1854]},{77:aa,143:ce,144:979,145:Qe,152:de,181:Ee,201:980,302:Ue,342:1855,419:190,420:qe,424:Ge},{344:[1,1856]},e(os,[2,710]),e(os,[2,712]),e(oa,[2,256]),{131:ie,196:1857},{131:[2,1102]},e(ui,[2,244]),e(Pa,[2,77]),{78:[2,76]},{2:r,3:168,4:n,5:a,56:165,77:se,94:1824,105:1858,111:149,113:153,131:ie,132:oe,137:ue,143:ce,144:161,145:le,149:he,152:de,154:fe,156:K,158:167,179:pe,180:be,181:Ee,196:151,200:147,201:155,202:156,254:150,255:146,256:148,257:152,258:154,259:157,260:158,261:159,262:162,263:163,265:ge,266:p,270:me,271:ve,273:Se,280:Te,281:Ae,282:ye,283:Ne,284:Ce,285:Re,286:Oe,287:we,288:Ie,290:Q,291:z,292:Z,293:ee,294:xe,295:De,296:ke,297:Le,298:$e,299:Me,302:Ue,303:_e,312:Fe,317:Pe,419:190,420:qe,424:Ge},{2:r,3:1859,4:n,5:a},{78:[1,1860]},{74:di,78:[1,1861]},{374:[1,1862]},{2:r,3:1863,4:n,5:a,132:[1,1864]},{74:ns,78:[1,1865]},e(vn,[2,526]),e(vn,[2,527]),e(os,[2,714],{74:Ma}),e(os,[2,716]),e(fi,[2,1103],{251:1866,766:[1,1867]}),e(is,[2,79]),e(is,[2,82]),e(Pa,[2,1055],{3:1821,101:1868,104:1869,2:r,4:n,5:a,76:li}),e(vn,[2,518]),{2:r,3:244,4:n,5:a,199:1870},e(is,[2,530]),e(is,[2,531]),e(vn,[2,525]),e(ti,[2,1105],{252:1871,415:[1,1872]}),e(fi,[2,1104]),e(Pa,[2,75]),e(Pa,[2,1056]),e(pi,[2,1119],{375:1873,377:1874,77:[1,1875]}),e(ti,[2,269]),e(ti,[2,1106]),e(vn,[2,521],{376:1876,378:1877,230:[1,1878]}),e(pi,[2,1120]),{2:r,3:1831,4:n,5:a,132:hi,372:1879},e(vn,[2,519]),{230:[1,1881],379:1880},{338:[1,1882]},{74:di,78:[1,1883]},e(vn,[2,522]),{335:[1,1884]},{380:[1,1885]},e(pi,[2,520]),{380:[1,1886]},{381:[1,1887]},{381:[1,1888]},{230:[2,523]},e(vn,[2,524])],defaultActions:{105:[2,6],194:[2,336],195:[2,337],196:[2,338],197:[2,339],198:[2,340],199:[2,341],200:[2,342],201:[2,343],202:[2,344],209:[2,695],591:[2,1142],653:[2,1107],654:[2,1108],710:[2,696],780:[2,1073],781:[2,1074],926:[2,446],927:[2,447],928:[2,448],987:[2,697],1288:[2,1152],1375:[2,1060],1433:[2,1150],1541:[2,507],1732:[2,1052],1777:[2,1100],1797:[2,1118],1800:[2,1124],1842:[2,1102],1845:[2,76],1887:[2,523]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],a=[],s=this.table,i="",o=0,u=0,c=0,l=a.slice.call(arguments,1),h=Object.create(this.lexer),d={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(d.yy[f]=this.yy[f]);h.setInput(e,d.yy),d.yy.lexer=h,d.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var p=h.yylloc;a.push(p);var b=h.options&&h.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var E,g,m,v,S,T,A,y,N,C,R=function(){var e;return"number"!=typeof(e=h.lex()||1)&&(e=t.symbols_[e]||e),e},O={};;){if(m=r[r.length-1],void 0===(v=this.defaultActions[m]?this.defaultActions[m]:(null==E&&(E=R()),s[m]&&s[m][E]))||!v.length||!v[0]){var w,I="",x=function(e){for(var t=r.length-1,n=0;;){if(2..toString()in s[e])return n;if(0===e||t<2)return!1;e=r[t-=2],++n}};if(c)1!==g&&(w=x(m));else{for(T in w=x(m),N=[],s[m])this.terminals_[T]&&2<T&&N.push("'"+this.terminals_[T]+"'");I=h.showPosition?"Parse error on line "+(o+1)+":\n"+h.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[E]||E)+"'":"Parse error on line "+(o+1)+": Unexpected "+(1==E?"end of input":"'"+(this.terminals_[E]||E)+"'"),this.parseError(I,{text:h.match,token:this.terminals_[E]||E,line:h.yylineno,loc:p,expected:N,recoverable:!1!==w})}if(3==c){if(1===E||1===g)throw new Error(I||"Parsing halted while starting to recover from another error.");u=h.yyleng,i=h.yytext,o=h.yylineno,p=h.yylloc,E=R()}if(!1===w)throw new Error(I||"Parsing halted. No suitable error recovery rule available.");C=w,r.length=r.length-2*C,n.length=n.length-C,a.length=a.length-C,g=2==E?null:E,E=2,m=r[r.length-1],v=s[m]&&s[m][2],c=3}if(v[0]instanceof Array&&1<v.length)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+E);switch(v[0]){case 1:r.push(E),n.push(h.yytext),a.push(h.yylloc),r.push(v[1]),E=null,g?(E=g,g=null):(u=h.yyleng,i=h.yytext,o=h.yylineno,p=h.yylloc,0<c&&c--);break;case 2:if(A=this.productions_[v[1]][1],O.$=n[n.length-A],O._$={first_line:a[a.length-(A||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(A||1)].first_column,last_column:a[a.length-1].last_column},b&&(O._$.range=[a[a.length-(A||1)].range[0],a[a.length-1].range[1]]),void 0!==(S=this.performAction.apply(O,[i,u,o,d.yy,v[1],n,a].concat(l))))return S;A&&(r=r.slice(0,-1*A*2),n=n.slice(0,-1*A),a=a.slice(0,-1*A)),r.push(this.productions_[v[1]][0]),n.push(O.$),a.push(O._$),y=s[r[r.length-2]][r[r.length-1]],r.push(y);break;case 3:return!0}}return!0}},Ei=["A","ABSENT","ABSOLUTE","ACCORDING","ACTION","ADA","ADD","ADMIN","AFTER","ALWAYS","ASC","ASSERTION","ASSIGNMENT","ATTRIBUTE","ATTRIBUTES","BASE64","BEFORE","BERNOULLI","BLOCKED","BOM","BREADTH","C","CASCADE","CATALOG","CATALOG_NAME","CHAIN","CHARACTERISTICS","CHARACTERS","CHARACTER_SET_CATALOG","CHARACTER_SET_NAME","CHARACTER_SET_SCHEMA","CLASS_ORIGIN","COBOL","COLLATION","COLLATION_CATALOG","COLLATION_NAME","COLLATION_SCHEMA","COLUMNS","COLUMN_NAME","COMMAND_FUNCTION","COMMAND_FUNCTION_CODE","COMMITTED","CONDITION_NUMBER","CONNECTION","CONNECTION_NAME","CONSTRAINTS","CONSTRAINT_CATALOG","CONSTRAINT_NAME","CONSTRAINT_SCHEMA","CONSTRUCTOR","CONTENT","CONTINUE","CONTROL","CURSOR_NAME","DATA","DATETIME_INTERVAL_CODE","DATETIME_INTERVAL_PRECISION","DB","DEFAULTS","DEFERRABLE","DEFERRED","DEFINED","DEFINER","DEGREE","DEPTH","DERIVED","DESC","DESCRIPTOR","DIAGNOSTICS","DISPATCH","DOCUMENT","DOMAIN","DYNAMIC_FUNCTION","DYNAMIC_FUNCTION_CODE","EMPTY","ENCODING","ENFORCED","EXCLUDE","EXCLUDING","EXPRESSION","FILE","FINAL","FIRST","FLAG","FOLLOWING","FORTRAN","FOUND","FS","G","GENERAL","GENERATED","GO","GOTO","GRANTED","HEX","HIERARCHY","ID","IGNORE","IMMEDIATE","IMMEDIATELY","IMPLEMENTATION","INCLUDING","INCREMENT","INDENT","INITIALLY","INPUT","INSTANCE","INSTANTIABLE","INSTEAD","INTEGRITY","INVOKER","ISOLATION","K","KEY","KEY_MEMBER","KEY_TYPE","LAST","LENGTH","LEVEL","LIBRARY","LIMIT","LINK","LOCATION","LOCATOR","M","MAP","MAPPING","MATCHED","MAXVALUE","MESSAGE_LENGTH","MESSAGE_OCTET_LENGTH","MESSAGE_TEXT","MINVALUE","MORE","MUMPS","NAME","NAMES","NAMESPACE","NESTING","NEXT","NFC","NFD","NFKC","NFKD","NIL","NORMALIZED","NULLABLE","NULLS","NUMBER","OBJECT","OCTETS","OFF","OPTION","OPTIONS","ORDERING","ORDINALITY","OTHERS","OUTPUT","OVERRIDING","P","PAD","PARAMETER_MODE","PARAMETER_NAME","PARAMETER_ORDINAL_POSITION","PARAMETER_SPECIFIC_CATALOG","PARAMETER_SPECIFIC_NAME","PARAMETER_SPECIFIC_SCHEMA","PARTIAL","PASCAL","PASSING","PASSTHROUGH","PATH","PERMISSION","PLACING","PLI","PRECEDING","PRESERVE","PRIOR","PRIVILEGES","PUBLIC","READ","RECOVERY","RELATIVE","REPEATABLE","REQUIRING","RESPECT","RESTART","RESTORE","RESTRICT","RETURNED_CARDINALITY","RETURNED_LENGTH","RETURNED_OCTET_LENGTH","RETURNED_SQLSTATE","RETURNING","ROLE","ROUTINE","ROUTINE_CATALOG","ROUTINE_NAME","ROUTINE_SCHEMA","ROW_COUNT","SCALE","SCHEMA","SCHEMA_NAME","SCOPE_CATALOG","SCOPE_NAME","SCOPE_SCHEMA","SECTION","SECURITY","SELECTIVE","SELF","SEQUENCE","SERIALIZABLE","SERVER","SERVER_NAME","SESSION","SETS","SIMPLE","SIZE","SOURCE","SPACE","SPECIFIC_NAME","STANDALONE","STATE","STATEMENT","STRIP","STRUCTURE","STYLE","SUBCLASS_ORIGIN","T","TABLE_NAME","TEMPORARY","TIES","TOKEN","TOP_LEVEL_COUNT","TRANSACTION","TRANSACTIONS_COMMITTED","TRANSACTIONS_ROLLED_BACK","TRANSACTION_ACTIVE","TRANSFORM","TRANSFORMS","TRIGGER_CATALOG","TRIGGER_NAME","TRIGGER_SCHEMA","TYPE","UNBOUNDED","UNCOMMITTED","UNDER","UNLINK","UNNAMED","UNTYPED","URI","USAGE","USER_DEFINED_TYPE_CATALOG","USER_DEFINED_TYPE_CODE","USER_DEFINED_TYPE_NAME","USER_DEFINED_TYPE_SCHEMA","VALID","VERSION","VIEW","WHITESPACE","WORK","WRAPPER","WRITE","XMLDECLARATION","XMLSCHEMA","YES","ZONE"];bi.parseError=function(e,t){if(!(t.expected&&-1<t.expected.indexOf("'LITERAL'")&&/[a-zA-Z_][a-zA-Z_0-9]*/.test(t.token)&&-1<Ei.indexOf(t.token)))throw new SyntaxError(e)};var gi={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var a=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,a;if(this.options.backtrack_lexer&&(a={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(a.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var s in a)this[s]=a[s];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),s=0;s<a.length;s++)if((r=this._input.match(this.rules[a[s]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=s,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,a[s])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,a[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return 0<=(e=this.conditionStack.length-1-Math.abs(e||0))?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{"case-insensitive":!0},performAction:function(e,t,r,n){switch(r){case 0:return 266;case 1:return 302;case 2:return 420;case 3:return 299;case 4:case 5:return 5;case 6:case 7:return 296;case 8:case 9:return 132;case 10:return;case 11:break;case 12:return 316;case 13:return 319;case 14:return t.yytext="VALUE",89;case 15:return t.yytext="VALUE",189;case 16:return t.yytext="ROW",189;case 17:return t.yytext="COLUMN",189;case 18:return t.yytext="MATRIX",189;case 19:return t.yytext="INDEX",189;case 20:return t.yytext="RECORDSET",189;case 21:return t.yytext="TEXT",189;case 22:return t.yytext="SELECT",189;case 23:return 520;case 24:return 381;case 25:return 402;case 26:return 515;case 27:return 287;case 28:case 29:return 269;case 30:return 164;case 31:return 400;case 32:return 170;case 33:return 229;case 34:return 166;case 35:return 207;case 36:return 288;case 37:return 76;case 38:return 418;case 39:return 242;case 40:return 404;case 41:return 356;case 42:return 284;case 43:return 514;case 44:return 437;case 45:return 330;case 46:return 441;case 47:return 331;case 48:return 315;case 49:return 119;case 50:return 112;case 51:return 315;case 52:return 112;case 53:return 315;case 54:return 112;case 55:return 315;case 56:return 508;case 57:return 303;case 58:return 271;case 59:return 368;case 60:return 130;case 61:return"CLOSE";case 62:return 243;case 63:case 64:return 190;case 65:return 434;case 66:return 367;case 67:return 470;case 68:return 440;case 69:return 273;case 70:return 240;case 71:return 281;case 72:return 267;case 73:return 206;case 74:return 238;case 75:return 265;case 76:return"CURSOR";case 77:return 405;case 78:return 291;case 79:return 292;case 80:return 448;case 81:return 343;case 82:return 338;case 83:return"DELETED";case 84:return 242;case 85:return 406;case 86:return 185;case 87:return 396;case 88:return 447;case 89:return 135;case 90:return 306;case 91:return 389;case 92:return 310;case 93:return 314;case 94:return 169;case 95:case 96:return 508;case 97:return 298;case 98:return 14;case 99:return 295;case 100:return 249;case 101:return 285;case 102:return 95;case 103:return 373;case 104:return 183;case 105:return 227;case 106:return 268;case 107:return 313;case 108:return 602;case 109:return 472;case 110:return 232;case 111:return 236;case 112:return 239;case 113:return 156;case 114:return 356;case 115:return 332;case 116:return 99;case 117:return 193;case 118:return 212;case 119:return 224;case 120:return 516;case 121:return 339;case 122:return 213;case 123:return 168;case 124:return 293;case 125:return 198;case 126:return 223;case 127:return 370;case 128:return 286;case 129:return"LET";case 130:return 225;case 131:return 112;case 132:return 245;case 133:return 460;case 134:return 191;case 135:return 283;case 136:return 390;case 137:return 282;case 138:return 452;case 139:return 169;case 140:return 403;case 141:return 222;case 142:return 645;case 143:return 270;case 144:return 244;case 145:return 380;case 146:return 154;case 147:return 297;case 148:return 433;case 149:return 230;case 150:return 415;case 151:return 129;case 152:return 247;case 153:return"OPEN";case 154:return 416;case 155:return 171;case 156:return 118;case 157:return 208;case 158:return 276;case 159:return 172;case 160:return 279;case 161:return 765;case 162:return 93;case 163:return 16;case 164:return 369;case 165:return 442;case 166:return 678;case 167:return 15;case 168:return 414;case 169:return 194;case 170:return"REDUCE";case 171:return 374;case 172:return 311;case 173:return 517;case 174:return 682;case 175:return 107;case 176:return 401;case 177:return 175;case 178:return 290;case 179:return 443;case 180:return 687;case 181:case 182:return 173;case 183:return 226;case 184:return 436;case 185:return 237;case 186:return 150;case 187:return 766;case 188:return 405;case 189:return 89;case 190:return 228;case 191:case 192:return 146;case 193:return 409;case 194:return 334;case 195:return 417;case 196:return"STRATEGY";case 197:return"STORE";case 198:return 280;case 199:case 200:return 353;case 201:return 463;case 202:case 203:return 357;case 204:return 192;case 205:return 309;case 206:return"TIMEOUT";case 207:return 148;case 208:return 195;case 209:case 210:return 435;case 211:return 509;case 212:return 294;case 213:return 451;case 214:return 162;case 215:return 187;case 216:return 98;case 217:return 335;case 218:return 408;case 219:return 231;case 220:return 149;case 221:return 344;case 222:return 134;case 223:return 410;case 224:return 308;case 225:return 128;case 226:return 439;case 227:return 72;case 228:return 435;case 229:case 230:return 131;case 231:return 115;case 232:return 137;case 233:return 179;case 234:return 317;case 235:return 180;case 236:return 133;case 237:return 138;case 238:return 326;case 239:return 323;case 240:return 325;case 241:return 322;case 242:return 320;case 243:return 318;case 244:return 319;case 245:return 142;case 246:return 141;case 247:return 139;case 248:return 321;case 249:return 324;case 250:return 140;case 251:return 124;case 252:return 324;case 253:return 77;case 254:return 78;case 255:return 145;case 256:return 424;case 257:return 426;case 258:return 300;case 259:return 505;case 260:return 507;case 261:return 122;case 262:return 116;case 263:return 74;case 264:return 333;case 265:return 152;case 266:return 764;case 267:return 143;case 268:return 181;case 269:return 136;case 270:return 123;case 271:return 312;case 272:return 4;case 273:return 10;case 274:return"INVALID"}},rules:[/^(?:``([^\`])+``)/i,/^(?:\[\?\])/i,/^(?:@\[)/i,/^(?:ARRAY\[)/i,/^(?:\[([^\]])*?\])/i,/^(?:`([^\`])*?`)/i,/^(?:N(['](\\.|[^']|\\')*?['])+)/i,/^(?:X(['](\\.|[^']|\\')*?['])+)/i,/^(?:(['](\\.|[^']|\\')*?['])+)/i,/^(?:(["](\\.|[^"]|\\")*?["])+)/i,/^(?:--(.*?)($|\r\n|\r|\n))/i,/^(?:\s+)/i,/^(?:\|\|)/i,/^(?:\|)/i,/^(?:VALUE\s+OF\s+SEARCH\b)/i,/^(?:VALUE\s+OF\s+SELECT\b)/i,/^(?:ROW\s+OF\s+SELECT\b)/i,/^(?:COLUMN\s+OF\s+SELECT\b)/i,/^(?:MATRIX\s+OF\s+SELECT\b)/i,/^(?:INDEX\s+OF\s+SELECT\b)/i,/^(?:RECORDSET\s+OF\s+SELECT\b)/i,/^(?:TEXT\s+OF\s+SELECT\b)/i,/^(?:SELECT\b)/i,/^(?:ABSOLUTE\b)/i,/^(?:ACTION\b)/i,/^(?:ADD\b)/i,/^(?:AFTER\b)/i,/^(?:AGGR\b)/i,/^(?:AGGREGATE\b)/i,/^(?:AGGREGATOR\b)/i,/^(?:ALL\b)/i,/^(?:ALTER\b)/i,/^(?:AND\b)/i,/^(?:ANTI\b)/i,/^(?:ANY\b)/i,/^(?:APPLY\b)/i,/^(?:ARRAY\b)/i,/^(?:AS\b)/i,/^(?:ASSERT\b)/i,/^(?:ASC\b)/i,/^(?:ATTACH\b)/i,/^(?:AUTO(_)?INCREMENT\b)/i,/^(?:AVG\b)/i,/^(?:BEFORE\b)/i,/^(?:BEGIN\b)/i,/^(?:BETWEEN\b)/i,/^(?:BREAK\b)/i,/^(?:NOT\s+BETWEEN\b)/i,/^(?:NOT\s+LIKE\b)/i,/^(?:BY\b)/i,/^(?:~~\*)/i,/^(?:!~~\*)/i,/^(?:~~)/i,/^(?:!~~)/i,/^(?:ILIKE\b)/i,/^(?:NOT\s+ILIKE\b)/i,/^(?:CALL\b)/i,/^(?:CASE\b)/i,/^(?:CAST\b)/i,/^(?:CHECK\b)/i,/^(?:CLASS\b)/i,/^(?:CLOSE\b)/i,/^(?:COLLATE\b)/i,/^(?:COLUMN\b)/i,/^(?:COLUMNS\b)/i,/^(?:COMMIT\b)/i,/^(?:CONSTRAINT\b)/i,/^(?:CONTENT\b)/i,/^(?:CONTINUE\b)/i,/^(?:CONVERT\b)/i,/^(?:CORRESPONDING\b)/i,/^(?:COUNT\b)/i,/^(?:CREATE\b)/i,/^(?:CROSS\b)/i,/^(?:CUBE\b)/i,/^(?:CURRENT_TIMESTAMP\b)/i,/^(?:CURSOR\b)/i,/^(?:DATABASE(S)?)/i,/^(?:DATEADD\b)/i,/^(?:DATEDIFF\b)/i,/^(?:DECLARE\b)/i,/^(?:DEFAULT\b)/i,/^(?:DELETE\b)/i,/^(?:DELETED\b)/i,/^(?:DESC\b)/i,/^(?:DETACH\b)/i,/^(?:DISTINCT\b)/i,/^(?:DROP\b)/i,/^(?:ECHO\b)/i,/^(?:EDGE\b)/i,/^(?:END\b)/i,/^(?:ENUM\b)/i,/^(?:ELSE\b)/i,/^(?:ESCAPE\b)/i,/^(?:EXCEPT\b)/i,/^(?:EXEC\b)/i,/^(?:EXECUTE\b)/i,/^(?:EXISTS\b)/i,/^(?:EXPLAIN\b)/i,/^(?:FALSE\b)/i,/^(?:FETCH\b)/i,/^(?:FIRST\b)/i,/^(?:FOR\b)/i,/^(?:FOREIGN\b)/i,/^(?:FROM\b)/i,/^(?:FULL\b)/i,/^(?:FUNCTION\b)/i,/^(?:GLOB\b)/i,/^(?:GO\b)/i,/^(?:GRAPH\b)/i,/^(?:GROUP\b)/i,/^(?:GROUPING\b)/i,/^(?:HAVING\b)/i,/^(?:IF\b)/i,/^(?:IDENTITY\b)/i,/^(?:IS\b)/i,/^(?:IN\b)/i,/^(?:INDEX\b)/i,/^(?:INDEXED\b)/i,/^(?:INNER\b)/i,/^(?:INSTEAD\b)/i,/^(?:INSERT\b)/i,/^(?:INSERTED\b)/i,/^(?:INTERSECT\b)/i,/^(?:INTERVAL\b)/i,/^(?:INTO\b)/i,/^(?:JOIN\b)/i,/^(?:KEY\b)/i,/^(?:LAST\b)/i,/^(?:LET\b)/i,/^(?:LEFT\b)/i,/^(?:LIKE\b)/i,/^(?:LIMIT\b)/i,/^(?:MATCHED\b)/i,/^(?:MATRIX\b)/i,/^(?:MAX(\s+)?(?=\())/i,/^(?:MAX(\s+)?(?=(,|\))))/i,/^(?:MIN(\s+)?(?=\())/i,/^(?:MERGE\b)/i,/^(?:MINUS\b)/i,/^(?:MODIFY\b)/i,/^(?:NATURAL\b)/i,/^(?:NEXT\b)/i,/^(?:NEW\b)/i,/^(?:NOCASE\b)/i,/^(?:NO\b)/i,/^(?:NOT\b)/i,/^(?:NULL\b)/i,/^(?:OFF\b)/i,/^(?:ON\b)/i,/^(?:ONLY\b)/i,/^(?:OF\b)/i,/^(?:OFFSET\b)/i,/^(?:OPEN\b)/i,/^(?:OPTION\b)/i,/^(?:OR\b)/i,/^(?:ORDER\b)/i,/^(?:OUTER\b)/i,/^(?:OVER\b)/i,/^(?:PATH\b)/i,/^(?:PARTITION\b)/i,/^(?:PERCENT\b)/i,/^(?:PIVOT\b)/i,/^(?:PLAN\b)/i,/^(?:PRIMARY\b)/i,/^(?:PRINT\b)/i,/^(?:PRIOR\b)/i,/^(?:QUERY\b)/i,/^(?:READ\b)/i,/^(?:RECORDSET\b)/i,/^(?:REDUCE\b)/i,/^(?:REFERENCES\b)/i,/^(?:REGEXP\b)/i,/^(?:REINDEX\b)/i,/^(?:RELATIVE\b)/i,/^(?:REMOVE\b)/i,/^(?:RENAME\b)/i,/^(?:REPEAT\b)/i,/^(?:REPLACE\b)/i,/^(?:REQUIRE\b)/i,/^(?:RESTORE\b)/i,/^(?:RETURN\b)/i,/^(?:RETURNS\b)/i,/^(?:RIGHT\b)/i,/^(?:ROLLBACK\b)/i,/^(?:ROLLUP\b)/i,/^(?:ROW\b)/i,/^(?:ROWS\b)/i,/^(?:SCHEMA(S)?)/i,/^(?:SEARCH\b)/i,/^(?:SEMI\b)/i,/^(?:SET\b)/i,/^(?:SETS\b)/i,/^(?:SHOW\b)/i,/^(?:SOME\b)/i,/^(?:SOURCE\b)/i,/^(?:STRATEGY\b)/i,/^(?:STORE\b)/i,/^(?:SUM\b)/i,/^(?:TABLE\b)/i,/^(?:TABLES\b)/i,/^(?:TARGET\b)/i,/^(?:TEMP\b)/i,/^(?:TEMPORARY\b)/i,/^(?:TEXTSTRING\b)/i,/^(?:THEN\b)/i,/^(?:TIMEOUT\b)/i,/^(?:TO\b)/i,/^(?:TOP\b)/i,/^(?:TRAN\b)/i,/^(?:TRANSACTION\b)/i,/^(?:TRIGGER\b)/i,/^(?:TRUE\b)/i,/^(?:TRUNCATE\b)/i,/^(?:UNION\b)/i,/^(?:UNIQUE\b)/i,/^(?:UNPIVOT\b)/i,/^(?:UPDATE\b)/i,/^(?:USE\b)/i,/^(?:USING\b)/i,/^(?:VALUE\b)/i,/^(?:VALUES\b)/i,/^(?:VERTEX\b)/i,/^(?:VIEW\b)/i,/^(?:WHEN\b)/i,/^(?:WHERE\b)/i,/^(?:WHILE\b)/i,/^(?:WITH\b)/i,/^(?:WORK\b)/i,/^(?:(\d*[.])?\d+[eE]\d+)/i,/^(?:(\d*[.])?\d+)/i,/^(?:->)/i,/^(?:#)/i,/^(?:\+)/i,/^(?:-)/i,/^(?:\*)/i,/^(?:\/)/i,/^(?:%)/i,/^(?:!===)/i,/^(?:===)/i,/^(?:!==)/i,/^(?:==)/i,/^(?:>=)/i,/^(?:&)/i,/^(?:\|)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:<>)/i,/^(?:<)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:\()/i,/^(?:\))/i,/^(?:@)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:\])/i,/^(?::-)/i,/^(?:\?-)/i,/^(?:\.\.)/i,/^(?:\.)/i,/^(?:,)/i,/^(?:::)/i,/^(?::)/i,/^(?:;)/i,/^(?:\$)/i,/^(?:\?)/i,/^(?:!)/i,/^(?:\^)/i,/^(?:~)/i,/^(?:[a-zA-Z_][a-zA-Z_0-9]*)/i,/^(?:$)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274],inclusive:!0}}};function mi(){this.yy={}}return bi.lexer=gi,new((mi.prototype=bi).Parser=mi)}();void 0!==i&&void 0!==t&&(t.parser=u,t.Parser=u.Parser,t.parse=function(){return u.parse.apply(u,arguments)},t.main=function(r){r[1]||e.exit(1);var n=null.readFileSync(null.normalize(r[1]),"utf8");return t.parser.parse(n)},i.main===n&&t.main(e.argv.slice(1))),s.prettyflag=!1,s.pretty=function(e,t){var r=s.prettyflag;s.prettyflag=!t;var n=s.parse(e).toString();return s.prettyflag=r,n};var c=s.utils={};function l(e){return"(y="+e+",y===y?y:undefined)"}function h(e,t){return"(y="+e+',typeof y=="undefined"?undefined:'+t+")"}function d(){return!0}function f(){}function p(e){return e[0]===String.fromCharCode(65279)&&(e=e.substr(1)),e}var b=c.escapeq=function(e){return(""+e).replace(/["'\\\n\r\u2028\u2029]/g,(function(e){switch(e){case'"':case"'":case"\\":return"\\"+e;case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029"}}))},E=c.undoubleq=function(e){return e.replace(/(\')/g,"''")},g=c.doubleq=function(e){return e.replace(/(\'\')/g,"\\'")};c.doubleqq=function(e){return e.replace(/\'/g,"'")},c.global="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==a?a:Function("return this")(),c.isNativeFunction=function(e){return"function"==typeof e&&!!~e.toString().indexOf("[native code]")},c.isWebWorker=function(){try{var e=c.global.importScripts;return c.isNativeFunction(e)}catch(e){return!1}}(),c.isNode=function(){try{return c.isNativeFunction(c.global.process.reallyExit)}catch(e){return!1}}(),c.isBrowser=function(){try{return c.isNativeFunction(c.global.location.reload)}catch(e){return!1}}(),c.isBrowserify=c.isBrowser&&void 0!==e&&e.browser,c.isRequireJS=c.isBrowser&&"function"==typeof i.specified,c.isMeteor="undefined"!=typeof Meteor&&Meteor.release,c.isMeteorClient=c.isMeteorClient=c.isMeteor&&Meteor.isClient,c.isMeteorServer=c.isMeteor&&Meteor.isServer,c.isCordova="object"==typeof cordova,c.isReactNative=!1,c.hasIndexedDB=!!c.global.indexedDB,c.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)};var m=c.loadFile=function(e,t,r,n){var a;if(c.isNode||c.isMeteorServer);else if(c.isCordova)c.global.requestFileSystem(LocalFileSystem.PERSISTENT,0,(function(t){t.root.getFile(e,{create:!1},(function(e){e.file((function(e){var t=new FileReader;t.onloadend=function(e){r(p(this.result))},t.readAsText(e)}))}))}));else if("string"==typeof e)if("#"===e.substr(0,1)&&"undefined"!=typeof document)a=document.querySelector(e).textContent,r(a);else{var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status)r&&r(p(s.responseText));else if(n)return n(s)},s.open("GET",e,t),s.responseType="text",s.send()}else if(e instanceof Event){var i=e.target.files,o=new FileReader;i[0].name,o.onload=function(e){var t=e.target.result;r(p(t))},o.readAsText(i[0])}};function S(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")&&parseInt(e.split("msie")[1])}c.loadBinaryFile=function(e,t,r,n){if(c.isNode||c.isMeteorServer);else if("string"==typeof e){var a=new XMLHttpRequest;a.open("GET",e,t),a.responseType="arraybuffer",a.onload=function(){for(var e=new Uint8Array(a.response),t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);r(t.join(""))},a.send()}else if(e instanceof Event){var s=e.target.files,i=new FileReader;s[0].name,i.onload=function(e){var t=e.target.result;r(t)},i.readAsArrayBuffer(s[0])}else e instanceof Blob&&r(e)},c.removeFile=function(e,t){if(!c.isNode)throw new Error("You can remove files only in Node.js and Apache Cordova")},c.deleteFile=function(e,t){},c.autoExtFilename=function(e,t,r){return r=r||{},"string"!=typeof e||e.match(/^[A-z]+:\/\/|\n|\..{2,4}$/)||0===r.autoExt||!1===r.autoExt?e:e+"."+t},c.fileExists=function(e,t){if(!c.isNode)throw new Error("You can use exists() only in Node.js or Apach Cordova")},c.saveFile=function(e,t,r,n){var a=1;if(void 0===e)a=t,r&&(a=r(a));else if(c.isNode);else if(9===S()){var i=t.replace(/\r\n/g,"&#A;&#D;");i=(i=i.replace(/\n/g,"&#D;")).replace(/\t/g,"&#9;");var o=c.global.open("about:blank","_blank");o.document.write(i),o.document.close(),o.document.execCommand("SaveAs",!1,e),o.close()}else{var u={disableAutoBom:!1};s.utils.extend(u,n);var l=new Blob([t],{type:"text/plain;charset=utf-8"});de(l,e,u.disableAutoBom),r&&(a=r(a))}return a};var T=c.hash=function(e){for(var t=2166136261,r=e.length;r;)t^=e.charCodeAt(--r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t},A=c.arrayUnion=function(e,t){var r=t.slice(0);return e.forEach((function(e){r.indexOf(e)<0&&r.push(e)})),r},y=c.arrayDiff=function(e,t){return e.filter((function(e){return t.indexOf(e)<0}))},N=c.arrayIntersect=function(e,t){var r=[];return e.forEach((function(e){var n=!1;t.forEach((function(t){n=n||e===t})),n&&r.push(e)})),r},C=c.arrayUnionDeep=function(e,t){var r=t.slice(0);return e.forEach((function(e){var t=!1;r.forEach((function(r){t=t||I(e,r)})),t||r.push(e)})),r},R=c.arrayExceptDeep=function(e,t){var r=[];return e.forEach((function(e){var n=!1;t.forEach((function(t){n=n||I(e,t)})),n||r.push(e)})),r},O=c.arrayIntersectDeep=function(e,t){var r=[];return e.forEach((function(e){var n=!1;t.forEach((function(t){n=n||I(e,t,!0)})),n&&r.push(e)})),r},w=c.cloneDeep=function e(t){if(null===t||"object"!=typeof t)return t;if(t instanceof Date)return new Date(t);var r=t.constructor();for(var n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r},I=c.deepEqual=function(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!I(e[r],t[r]))return!1;return!0},x=c.distinctArray=function(e){for(var t={},r=0,n=e.length;r<n;r++)t["object"==typeof e[r]?Object.keys(e[r]).sort().map((function(t){return t+"`"+e[r][t]})).join("`"):e[r]]=e[r];var a=[];for(var s in t)a.push(t[s]);return a},D=c.extend=function(e,t){for(var r in e=e||{},t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},k=c.flatArray=function(e){if(!e||0===e.length)return[];if("object"==typeof e&&e instanceof s.Recordset)return e.data.map((function(t){return t[e.columns[0].columnid]}));var t=Object.keys(e[0])[0];return void 0===t?[]:e.map((function(e){return e[t]}))};function L(){var e=s.private.externalXlsxLib;if(e)return e;if(c.isNode||c.isBrowserify||c.isMeteorServer||(e=c.global.XLSX||null),null===e)throw new Error("Please include the xlsx.js library");return e}function $(e,t,r,n){return new c.global.Promise((function(a,i){s(e,t,(function(e,t){t?i(t):(r&&n&&!1!==s.options.progress&&s.options.progress(r,n),a(e))}))}))}c.arrayOfArrays=function(e){return e.map((function(e){var t=[];for(var r in e)t.push(e[r]);return t}))},Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),c.xlsnc=function(e){var t=String.fromCharCode(65+e%26);return 26<=e&&(e=(e/26|0)-1,t=String.fromCharCode(65+e%26)+t,26<e&&(e=(e/26|0)-1,t=String.fromCharCode(65+e%26)+t)),t},c.xlscn=function(e){var t=e.charCodeAt(0)-65;return 1<e.length&&(t=26*(t+1)+e.charCodeAt(1)-65,2<e.length&&(t=26*(t+1)+e.charCodeAt(2)-65)),t},c.domEmptyChildren=function(e){for(var t=e.childNodes.length;t--;)e.removeChild(e.lastChild)},c.like=function(e,t,r){r=r||"";for(var n=0,a="^";n<e.length;){var s=e[n],i="";n<e.length-1&&(i=e[n+1]),s===r?(a+="\\"+i,n++):"["===s&&"^"===i?(a+="[^",n++):"["===s||"]"===s?a+=s:"%"===s?a+=".*":"_"===s?a+=".":-1<"/.*+?|(){}".indexOf(s)?a+="\\"+s:a+=s,n++}return a+="$",-1<(""+(t||"")).toUpperCase().search(RegExp(a.toUpperCase()))},c.glob=function(e,t){for(var r=0,n="^";r<t.length;){var a=t[r],s="";r<t.length-1&&(s=t[r+1]),"["===a&&"^"===s?(n+="[^",r++):"["===a||"]"===a?n+=a:"*"===a?n+=".*":"?"===a?n+=".":-1<"/.*+?|(){}".indexOf(a)?n+="\\"+a:n+=a,r++}return n+="$",-1<(""+(e||"")).toUpperCase().search(RegExp(n.toUpperCase()))},c.findAlaSQLPath=function(){if(c.isWebWorker)return"";if(c.isMeteorClient)return"/packages/dist/";if(c.isMeteorServer)return"assets/packages/dist/";if(c.isNode)return"";if(c.isBrowser)for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){if("alasql-worker.js"===e[t].src.substr(-16).toLowerCase())return e[t].src.substr(0,e[t].src.length-16);if("alasql-worker.min.js"===e[t].src.substr(-20).toLowerCase())return e[t].src.substr(0,e[t].src.length-20);if("alasql.js"===e[t].src.substr(-9).toLowerCase())return e[t].src.substr(0,e[t].src.length-9);if("alasql.min.js"===e[t].src.substr(-13).toLowerCase())return e[t].src.substr(0,e[t].src.length-13)}return""},s.path=s.utils.findAlaSQLPath(),s.utils.uncomment=function(e){for(var t,r=!1,n=!1,a=!1,s=0,i=(e=("__"+e+"__").split("")).length;s<i;s++){var o="\\"!==e[s-1]||"\\"===e[s-2];r?e[s]===t&&o&&(r=!1):n?"*"===e[s]&&"/"===e[s+1]?(e[s]=e[s+1]="",n=!1,s++):e[s]="":a?("\n"!==e[s+1]&&"\r"!==e[s+1]||(a=!1),e[s]=""):'"'===e[s]||"'"===e[s]?(r=!0,t=e[s]):"["===e[s]&&"@"!==e[s-1]?(r=!0,t="]"):"/"===e[s]&&"*"===e[s+1]&&(n=!(e[s]=""))}return e.join("").slice(2,-2)},s.parser=u,s.parser.parseError=function(e,t){throw new Error("Have you used a reserved keyword without `escaping` it?\n"+e)},s.parse=function(e){return u.parse(s.utils.uncomment(e))},s.engines={},s.databases={},s.databasenum=0,s.options={},s.options.errorlog=!1,s.options.valueof=!1,s.options.dropifnotexists=!1,s.options.datetimeformat="sql",s.options.casesensitive=!0,s.options.logtarget="output",s.options.logprompt=!0,s.options.progress=!1,s.options.modifier=void 0,s.options.columnlookup=10,s.options.autovertex=!0,s.options.usedbo=!0,s.options.autocommit=!0,s.options.cache=!0,s.options.tsql=!0,s.options.mysql=!0,s.options.postgres=!0,s.options.oracle=!0,s.options.sqlite=!0,s.options.orientdb=!0,s.options.nocount=!1,s.options.nan=!1,s.options.joinstar="overwrite",s.vars={},s.declares={},s.prompthistory=[],s.plugins={},s.from={},s.into={},s.fn={},s.aggr={},s.busy=0,s.MAXSQLCACHESIZE=1e4,s.DEFAULTDATABASEID="alasql",s.lastid=0,s.buffer={},s.private={externalXlsxLib:null},s.setXLSX=function(e){s.private.externalXlsxLib=e},s.use=function(e){if(e=e||s.DEFAULTDATABASEID,s.useid!==e){s.useid=e;var t=s.databases[s.useid];s.tables=t.tables,t.resetSqlCache(),s.options.usedbo&&(s.databases.dbo=t)}},s.autoval=function(e,t,r,n){var a=n?s.databases[n]:s.databases[s.useid];if(!a.tables[e])throw new Error("Tablename not found: "+e);if(!a.tables[e].identities[t])throw new Error("Colname not found: "+t);return r?a.tables[e].identities[t].value||null:a.tables[e].identities[t].value-a.tables[e].identities[t].step||null},s.exec=function(e,t,r,n){if("function"==typeof t&&(n=r,r=t,t={}),delete s.error,t=t||{},!s.options.errorlog)return s.dexec(s.useid,e,t,r,n);try{return s.dexec(s.useid,e,t,r,n)}catch(e){s.error=e,r&&r(null,s.error)}},s.dexec=function(e,t,r,n,a){var i,o=s.databases[e];if(s.options.cache&&(i=T(t),(c=o.sqlCache[i])&&o.dbversion===c.dbversion))return c(r,n);var u=s.parse(t);if(u.statements){if(0===u.statements.length)return 0;if(1===u.statements.length){if(u.statements[0].compile){var c;if(!(c=u.statements[0].compile(e,r)))return;return c.sql=t,c.dbversion=o.dbversion,s.options.cache&&(o.sqlCacheSize>s.MAXSQLCACHESIZE&&o.resetSqlCache(),o.sqlCacheSize++,o.sqlCache[i]=c),s.res=c(r,n,a)}return s.precompile(u.statements[0],s.useid,r),s.res=u.statements[0].execute(e,r,n,a)}if(!n)return s.drun(e,u,r,n,a);s.adrun(e,u,r,n,a)}},s.drun=function(e,t,r,n,a){var i=s.useid;i!==e&&s.use(e);for(var o=[],u=0,c=t.statements.length;u<c;u++)if(t.statements[u])if(t.statements[u].compile){var l=t.statements[u].compile(s.useid);o.push(s.res=l(r,null,a))}else s.precompile(t.statements[u],s.useid,r),o.push(s.res=t.statements[u].execute(s.useid,r));return i!==e&&s.use(i),n&&n(o),s.res=o},s.adrun=function(e,t,r,n,a){var i=0,o=t.statements.length;!1!==s.options.progress&&s.options.progress(o,i++);var u=s.useid;u!==e&&s.use(e);var c=[];!function l(h){void 0!==h&&c.push(h);var d=t.statements.shift();d?(d.compile?d.compile(s.useid)(r,l,a):(s.precompile(t.statements[0],s.useid,r),d.execute(s.useid,r,l)),!1!==s.options.progress&&s.options.progress(o,i++)):(u!==e&&s.use(u),n(c))}()},s.compile=function(e,t){t=t||s.useid;var r=s.parse(e);if(1!==r.statements.length)throw new Error("Cannot compile, because number of statements in SQL is not equal to 1");var n=r.statements[0].compile(t);return n.promise=function(e){return new Promise((function(t,r){n(e,(function(e,n){n?r(n):t(e)}))}))},n},c.global.Promise||c.isNode||function(){function s(e){return"function"==typeof e}function i(){return function(){setTimeout(u,1)}}function u(){for(var e=0;e<D;e+=2)(0,F[e])(F[e+1]),F[e]=void 0,F[e+1]=void 0;D=0}function c(){}function l(e){try{return e.then}catch(e){return H.error=e,H}}function h(e,t,r){t.constructor===e.constructor&&r===P&&constructor.resolve===q?function(e,t){t._state===B?p(e,t._result):t._state===j?b(e,t._result):E(t,void 0,(function(t){d(e,t)}),(function(t){b(e,t)}))}(e,t):r===H?b(e,H.error):void 0===r?p(e,t):s(r)?function(e,t,r){k((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?d(e,r):p(e,r))}),(function(t){n||(n=!0,b(e,t))}),e._label);!n&&a&&(n=!0,b(e,a))}),e)}(e,t,r):p(e,t)}function d(e,t){e===t?b(e,new TypeError("You cannot resolve a promise with itself")):function(e){return"function"==typeof e||"object"==typeof e&&null!==e}(t)?h(e,t,l(t)):p(e,t)}function f(e){e._onerror&&e._onerror(e._result),g(e)}function p(e,t){e._state===V&&(e._result=t,e._state=B,0!==e._subscribers.length&&k(g,e))}function b(e,t){e._state===V&&(e._state=j,e._result=t,k(f,e))}function E(e,t,r,n){var a=e._subscribers,s=a.length;e._onerror=null,a[s]=t,a[s+B]=r,a[s+j]=n,0===s&&e._state&&k(g,e)}function g(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,a,s=e._result,i=0;i<t.length;i+=3)n=t[i],a=t[i+r],n?v(r,n,a,s):a(s);e._subscribers.length=0}}function m(){this.error=null}function v(e,t,r,n){var a,i,o,u,c=s(r);if(c){if((a=function(e,t){try{return e(t)}catch(e){return J.error=e,J}}(r,n))===J?(u=!0,i=a.error,a=null):o=!0,t===a)return void b(t,new TypeError("A promises callback cannot return that same promise."))}else a=n,o=!0;t._state!==V||(c&&o?d(t,a):u?b(t,i):e===B?p(t,a):e===j&&b(t,a))}function S(e){e[G]=Y++,e._state=void 0,e._result=void 0,e._subscribers=[]}function T(e){this[G]=Y++,this._result=this._state=void 0,this._subscribers=[],c!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof T?function(e,t){try{t((function(t){d(e,t)}),(function(t){b(e,t)}))}catch(t){b(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function A(e,t){this._instanceConstructor=e,this.promise=new e(c),this.promise[G]||S(this.promise),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?p(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&p(this.promise,this._result))):b(this.promise,new Error("Array Methods must be provided an Array"))}var y,N,C,R,O,w,I,x=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},D=0,k=function(e,t){F[D]=e,F[D+1]=t,2===(D+=2)&&(N?N(u):C())},L="undefined"!=typeof window?window:void 0,$=L||{},M=$.MutationObserver||$.WebKitMutationObserver,U="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),_="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,F=new Array(1e3);C=U?function(){e.nextTick(u)}:M?(O=0,w=new M(u),I=document.createTextNode(""),w.observe(I,{characterData:!0}),function(){I.data=O=++O%2}):_?((R=new MessageChannel).port1.onmessage=u,function(){R.port2.postMessage(0)}):void 0===L?function(){try{return y=null.runOnLoop||null.runOnContext,function(){y(u)}}catch(e){return i()}}():i();var P=function(e,t){var r=this,n=new this.constructor(c);void 0===n[G]&&S(n);var a=r._state;if(a){var s=arguments[a-1];k((function(){v(a,n,s,r._result)}))}else E(r,n,e,t);return n},q=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(c);return d(t,e),t},G=Math.random().toString(36).substring(16),V=void 0,B=1,j=2,H=new m,J=new m,Y=0,W=T;T.all=function(e){return new X(this,e).promise},T.race=function(e){var t=this;return new t(x(e)?function(r,n){for(var a=e.length,s=0;s<a;s++)t.resolve(e[s]).then(r,n)}:function(e,t){t(new TypeError("You must pass an array to race."))})},T.resolve=q,T.reject=function(e){var t=new this(c);return b(t,e),t},T._setScheduler=function(e){N=e},T._setAsap=function(e){k=e},T._asap=k,T.prototype={constructor:T,then:P,catch:function(e){return this.then(null,e)}};var X=A;A.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===V&&r<e;r++)this._eachEntry(t[r],r)},A.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===q){var a=l(e);if(a===P&&e._state!==V)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===W){var s=new r(c);h(s,e,a),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){t(e)})),t)}else this._willSettleAt(n(e),t)},A.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===V&&(this._remaining--,e===j?b(n,r):this._result[t]=r),0===this._remaining&&p(n,this._result)},A.prototype._willSettleAt=function(e,t){var r=this;E(e,void 0,(function(e){r._settledAt(B,t,e)}),(function(e){r._settledAt(j,t,e)}))};var K=function(){var e;if(void 0!==a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=W)},Q={Promise:W,polyfill:K};void 0!==(o=function(){return Q}.call(t,r,t,n))&&(n.exports=o),K()}.call(this),s.promise=function(e,t){if("undefined"==typeof Promise)throw new Error("Please include a Promise/A+ library");if("string"==typeof e)return $(e,t);if(!c.isArray(e)||e.length<1||void 0!==t)throw new Error("Error in .promise parameters");return function(e){if(!(e.length<1)){for(var t,r,n,a=[],s=0;s<e.length;s++){if("string"==typeof(t=e[s])&&(t=[t]),!c.isArray(t)||t.length<1||2<t.length)throw new Error("Error in .promise parameter");r=t[0],n=t[1]||void 0,a.push($(r,n,s,e.length))}return c.global.Promise.all(a)}}(e)};var M=s.Database=function(e){var t=this;if(t===s)if(e){if(t=s.databases[e],!(s.databases[e]=t))throw new Error('Database "'+e+'" not found')}else t=s.databases.alasql,s.options.tsql&&(s.databases.tempdb=s.databases.alasql);return e=e||"db"+s.databasenum++,t.databaseid=e,(s.databases[e]=t).dbversion=0,t.tables={},t.views={},t.triggers={},t.indices={},t.objects={},t.counter=0,t.resetSqlCache(),t};M.prototype.resetSqlCache=function(){this.sqlCache={},this.sqlCacheSize=0},M.prototype.exec=function(e,t,r){return s.dexec(this.databaseid,e,t,r)},M.prototype.autoval=function(e,t,r){return s.autoval(e,t,r,this.databaseid)},M.prototype.transaction=function(e){return e(new s.Transaction(this.databaseid))};var U=s.Transaction=function(e){return this.transactionid=Date.now(),this.databaseid=e,this.commited=!1,this.dbversion=s.databases[e].dbversion,this.bank=JSON.stringify(s.databases[e]),this};U.prototype.commit=function(){this.commited=!0,s.databases[this.databaseid].dbversion=Date.now(),delete this.bank},U.prototype.rollback=function(){if(this.commited)throw new Error("Transaction already commited");s.databases[this.databaseid]=JSON.parse(this.bank),delete this.bank},U.prototype.exec=function(e,t,r){return s.dexec(this.databaseid,e,t,r)},U.prototype.executeSQL=U.prototype.exec;var _=s.Table=function(e){this.data=[],this.columns=[],this.xcolumns={},this.inddefs={},this.indices={},this.uniqs={},this.uniqdefs={},this.identities={},this.checks=[],this.checkfns=[],this.beforeinsert={},this.afterinsert={},this.insteadofinsert={},this.beforedelete={},this.afterdelete={},this.insteadofdelete={},this.beforeupdate={},this.afterupdate={},this.insteadofupdate={},D(this,e)};_.prototype.indexColumns=function(){var e=this;e.xcolumns={},e.columns.forEach((function(t){e.xcolumns[t.columnid]=t}))},s.View=function(e){this.columns=[],this.xcolumns={},this.query=[],D(this,e)};var F=s.Query=function(e){this.alasql=s,this.columns=[],this.xcolumns={},this.selectGroup=[],this.groupColumns={},D(this,e)},P=(s.Recordset=function(e){D(this,e)},u.yy=s.yy={});P.extend=D,P.casesensitive=s.options.casesensitive;var q=P.Base=function(e){return P.extend(this,e)};function G(e,t,r){if(0<=t){var n=r.sources[t];n.data=e,"function"==typeof n.data&&(n.getfn=n.data,n.dontcache=n.getfn.dontcache,"OUTER"!=n.joinmode&&"RIGHT"!=n.joinmode&&"ANTI"!=n.joinmode||(n.dontcache=!1),n.data={})}else r.queriesdata[-t-1]=k(e);if(r.sourceslen--,!(0<r.sourceslen))return V(r)}function V(e){var t,r=e.scope;if(B(e),e.data=[],e.xgroups={},e.groups=[],function e(t,r,n){if(n>=t.sources.length)t.wherefn(r,t.params,s)&&(t.groupfn?t.groupfn(r,t.params,s):t.data.push(t.selectfn(r,t.params,s)));else if(t.sources[n].applyselect)(a=t.sources[n]).applyselect(t.params,(function(s){if(0<s.length)for(var i=0;i<s.length;i++)r[a.alias]=s[i],e(t,r,n+1);else"OUTER"==a.applymode&&(r[a.alias]={},e(t,r,n+1))}),r);else{var a=t.sources[n],i=t.sources[n+1],o=a.alias||a.tableid,u=!1,c=a.data,l=!1;a.getfn&&(!a.getfn||a.dontcache)||"RIGHT"==a.joinmode||"OUTER"==a.joinmode||"ANTI"==a.joinmode||"ix"!=a.optimization||(c=a.ix[a.onleftfn(r,t.params,s)]||[],l=!0);var h=0;if(void 0===c)throw new Error("Data source number "+n+" in undefined");for(var d=c.length;(p=c[h])||!l&&a.getfn&&(p=a.getfn(h))||h<d;)l||!a.getfn||a.dontcache||(c[h]=p),r[o]=p,a.onleftfn&&a.onleftfn(r,t.params,s)!=a.onrightfn(r,t.params,s)||a.onmiddlefn(r,t.params,s)&&("SEMI"!=a.joinmode&&"ANTI"!=a.joinmode&&e(t,r,n+1),"LEFT"!=a.joinmode&&"INNER"!=a.joinmode&&(p._rightjoin=!0),u=!0),h++;if("LEFT"!=a.joinmode&&"OUTER"!=a.joinmode&&"SEMI"!=a.joinmode||u||(r[o]={},e(t,r,n+1)),0==n)for(var f=n+1;f<t.sources.length;f++){if("OUTER"==i.joinmode||"RIGHT"==i.joinmode||"ANTI"==i.joinmode){r[a.alias]={};for(var p,b=0,E=i.data.length;(p=i.data[b])||i.getfn&&(p=i.getfn(b))||b<E;)i.getfn&&!i.dontcache&&(i.data[b]=p),p._rightjoin?delete p._rightjoin:(r[i.alias]=p,e(t,r,f+1)),b++}a=t.sources[f],i=t.sources[f+1]}r[o]=void 0}}(e,r,0),e.groupfn){if(e.data=[],0===e.groups.length){var n={};0<e.selectGroup.length&&e.selectGroup.forEach((function(e){"COUNT"==e.aggregatorid||"SUM"==e.aggregatorid?n[e.nick]=0:n[e.nick]=void 0})),e.groups=[n]}if(0<e.aggrKeys.length){var a="";e.aggrKeys.forEach((function(e){a+="g['"+e.nick+"']=alasql.aggr['"+e.funcid+"'](undefined,g['"+e.nick+"'],3);"}));var i=new Function("g,params,alasql","var y;"+a)}for(var o=0,u=e.groups.length;o<u;o++)if(n=e.groups[o],i&&i(n,e.params,s),!e.havingfn||e.havingfn(n,e.params,s)){var c=e.selectgfn(n,e.params,s);e.data.push(c)}}if(function(e){if(e.distinct){for(var t={},r=Object.keys(e.data[0]||[]),n=0,a=e.data.length;n<a;n++)t[r.map((function(t){return e.data[n][t]})).join("`")]=e.data[n];for(var s in e.data=[],t)e.data.push(t[s])}}(e),e.unionallfn){if(e.corresponding)e.unionallfn.query.modifier||(e.unionallfn.query.modifier=void 0),d=e.unionallfn(e.params);else for(e.unionallfn.query.modifier||(e.unionallfn.query.modifier="RECORDSET"),d=[],u=(f=e.unionallfn(e.params)).data.length,o=0;o<u;o++){for(var l={},h=Math.min(e.columns.length,f.columns.length)-1;0<=h;h--)l[e.columns[h].columnid]=f.data[o][f.columns[h].columnid];d.push(l)}e.data=e.data.concat(d)}else if(e.unionfn){if(e.corresponding)e.unionfn.query.modifier||(e.unionfn.query.modifier="ARRAY"),d=e.unionfn(e.params);else for(e.unionfn.query.modifier||(e.unionfn.query.modifier="RECORDSET"),d=[],u=(f=e.unionfn(e.params)).data.length,o=0;o<u;o++){for(l={},t=Math.min(e.columns.length,f.columns.length),h=0;h<t;h++)l[e.columns[h].columnid]=f.data[o][f.columns[h].columnid];d.push(l)}e.data=C(e.data,d)}else if(e.exceptfn){if(e.corresponding){e.exceptfn.query.modifier||(e.exceptfn.query.modifier="ARRAY");var d=e.exceptfn(e.params)}else{var f;for(e.exceptfn.query.modifier||(e.exceptfn.query.modifier="RECORDSET"),d=[],o=0,u=(f=e.exceptfn(e.params)).data.length;o<u;o++){for(l={},h=Math.min(e.columns.length,f.columns.length)-1;0<=h;h--)l[e.columns[h].columnid]=f.data[o][f.columns[h].columnid];d.push(l)}}e.data=R(e.data,d)}else if(e.intersectfn){if(e.corresponding)e.intersectfn.query.modifier||(e.intersectfn.query.modifier=void 0),d=e.intersectfn(e.params);else for(e.intersectfn.query.modifier||(e.intersectfn.query.modifier="RECORDSET"),d=[],u=(f=e.intersectfn(e.params)).data.length,o=0;o<u;o++){for(l={},t=Math.min(e.columns.length,f.columns.length),h=0;h<t;h++)l[e.columns[h].columnid]=f.data[o][f.columns[h].columnid];d.push(l)}e.data=O(e.data,d)}if(e.orderfn){if(e.explain)var p=Date.now();e.data=e.data.sort(e.orderfn),e.explain&&e.explaination.push({explid:e.explid++,description:"QUERY BY",ms:Date.now()-p})}if(function(e){if(e.limit){var t,r=0;e.offset&&(r=(r=0|e.offset||0)<0?0:r),t=e.percent?(e.data.length*e.limit/100|0)+r:(0|e.limit)+r,e.data=e.data.slice(r,t)}}(e),"undefined"!=typeof angular&&e.removeKeys.push("$$hashKey"),0<e.removeKeys.length){var b=e.removeKeys;if(0<(t=b.length))for(u=e.data.length,o=0;o<u;o++)for(h=0;h<t;h++)delete e.data[o][b[h]];0<e.columns.length&&(e.columns=e.columns.filter((function(e){var t=!1;return b.forEach((function(r){e.columnid==r&&(t=!0)})),!t})))}if(void 0!==e.removeLikeKeys&&0<e.removeLikeKeys.length){var E=e.removeLikeKeys;for(o=0,u=e.data.length;o<u;o++)for(var g in l=e.data[o])for(h=0;h<e.removeLikeKeys.length;h++)s.utils.like(e.removeLikeKeys[h],g)&&delete l[g];0<e.columns.length&&(e.columns=e.columns.filter((function(e){var t=!1;return E.forEach((function(r){s.utils.like(r,e.columnid)&&(t=!0)})),!t})))}if(e.pivotfn&&e.pivotfn(),e.unpivotfn&&e.unpivotfn(),e.intoallfn){var m=e.intoallfn(e.columns,e.cb,e.params,e.alasql);return m}if(e.intofn){for(u=e.data.length,o=0;o<u;o++)e.intofn(e.data[o],o,e.params,e.alasql);return e.cb&&e.cb(e.data.length,e.A,e.B),e.data.length}return m=e.data,e.cb&&(m=e.cb(e.data,e.A,e.B)),m}q.prototype.toString=function(){},q.prototype.toType=function(){},q.prototype.toJS=function(){},q.prototype.compile=f,q.prototype.exec=function(){},q.prototype.compile=f,q.prototype.exec=function(){},P.Statements=function(e){return P.extend(this,e)},P.Statements.prototype.toString=function(){return this.statements.map((function(e){return e.toString()})).join("; ")},P.Statements.prototype.compile=function(e){var t=this.statements.map((function(t){return t.compile(e)}));return 1===t.length?t[0]:function(e,r){var n=t.map((function(t){return t(e)}));return r&&r(n),n}},P.Search=function(e){return P.extend(this,e)},P.Search.prototype.toString=function(){var e="SEARCH ";return this.selectors&&(e+=this.selectors.toString()),this.from&&(e+="FROM "+this.from.toString()),e},P.Search.prototype.toJS=function(e){return"this.queriesfn["+(this.queriesidx-1)+"](this.params,null,"+e+")"},P.Search.prototype.compile=function(e){var t=e,r=this,n=function(e,a){var i;return function(e,t,r){var n,a,i,o,u={},c=w(this.selectors);if(void 0!==c&&0<c.length&&(c&&c[0]&&"PROP"===c[0].srchid&&c[0].args&&c[0].args[0]&&("XML"===c[0].args[0].toUpperCase()?(u.mode="XML",c.shift()):"HTML"===c[0].args[0].toUpperCase()?(u.mode="HTML",c.shift()):"JSON"===c[0].args[0].toUpperCase()&&(u.mode="JSON",c.shift())),0<c.length&&"VALUE"===c[0].srchid&&(u.value=!0,c.shift())),this.from instanceof P.Column){var l=this.from.databaseid||e;a=s.databases[l].tables[this.from.columnid].data}else if(this.from instanceof P.FuncValue&&s.from[this.from.funcid.toUpperCase()]){var h=this.from.args.map((function(e){var r=e.toJS();return new Function("params,alasql","var y;return "+r).bind(this)(t,s)}));a=s.from[this.from.funcid.toUpperCase()].apply(this,h)}else if(void 0===this.from)a=s.databases[e].objects;else{var d=new Function("params,alasql","var y;return "+this.from.toJS());a=d(t,s),"object"==typeof Mongo&&"object"!=typeof Mongo.Collection&&a instanceof Mongo.Collection&&(a=a.find().fetch())}return n=void 0!==c&&0<c.length?function e(r,n,i){var o=r[n];if(o.selid){if("PATH"===o.selid){for(var c=[{node:i,stack:[]}],l={},h=s.databases[s.useid].objects;0<c.length;){var d=c.shift(),f=d.node,p=d.stack;if(0<(I=e(o.args,0,f)).length){if(n+1+1>r.length)return p;var b=[];return p&&0<p.length&&p.forEach((function(t){b=b.concat(e(r,n+1,t))})),b}void 0===l[f.$id]&&(l[f.$id]=!0,f.$out&&0<f.$out.length&&f.$out.forEach((function(e){var t=h[e],r=p.concat(t);r.push(h[t.$out[0]]),c.push({node:h[t.$out[0]],stack:r})})))}return[]}if("NOT"===o.selid)return 0<(g=e(o.args,0,i)).length?[]:n+1+1>r.length?[i]:e(r,n+1,i);if("DISTINCT"===o.selid){if(0===(g=void 0===o.args||0===o.args.length?x(i):e(o.args,0,i)).length)return[];var E=x(g);return n+1+1>r.length?E:e(r,n+1,E)}if("AND"===o.selid)return E=!0,o.args.forEach((function(t){E=E&&0<e(t,0,i).length})),E?n+1+1>r.length?[i]:e(r,n+1,i):[];if("OR"===o.selid)return E=!1,o.args.forEach((function(t){E=E||0<e(t,0,i).length})),E?n+1+1>r.length?[i]:e(r,n+1,i):[];if("ALL"===o.selid)return 0===(g=e(o.args[0],0,i)).length?[]:n+1+1>r.length?g:e(r,n+1,g);if("ANY"===o.selid)return 0===(g=e(o.args[0],0,i)).length?[]:n+1+1>r.length?[g[0]]:e(r,n+1,[g[0]]);if("UNIONALL"===o.selid){var g=[];return o.args.forEach((function(t){g=g.concat(e(t,0,i))})),0===g.length?[]:n+1+1>r.length?g:e(r,n+1,g)}if("UNION"===o.selid)return g=[],o.args.forEach((function(t){g=g.concat(e(t,0,i))})),0===(g=x(g)).length?[]:n+1+1>r.length?g:e(r,n+1,g);if("IF"===o.selid)return 0===(g=e(o.args,0,i)).length?[]:n+1+1>r.length?[i]:e(r,n+1,i);if("REPEAT"===o.selid){var m,v,S=o.args[0].value;v=o.args[1]?o.args[1].value:S,o.args[2]&&(m=o.args[2].variable);var T=[];if(0===S&&(T=n+1+1>r.length?[i]:(m&&(s.vars[m]=0),T.concat(e(r,n+1,i)))),0<v)for(var A=[{value:i,lvl:1}],y=0;0<A.length;){if(g=A[0],A.shift(),g.lvl<=v){m&&(s.vars[m]=g.lvl);var N=e(o.sels,0,g.value);N.forEach((function(e){A.push({value:e,lvl:g.lvl+1})})),g.lvl>=S&&(n+1+1>r.length?T=T.concat(N):N.forEach((function(t){T=T.concat(e(r,n+1,t))})))}if(1e5<++y)throw new Error("Security brake. Number of iterations = "+y)}return T}if("OF"===o.selid){if(n+1+1>r.length)return[i];var C=[];return Object.keys(i).forEach((function(t){s.vars[o.args[0].variable]=t,C=C.concat(e(r,n+1,i[t]))})),C}if("TO"===o.selid){var R=s.vars[o.args[0]],O=[];return(O=void 0!==R?R.slice(0):[]).push(i),n+1+1>r.length?[i]:(s.vars[o.args[0]]=O,C=e(r,n+1,i),s.vars[o.args[0]]=R,C)}if("ARRAY"===o.selid)return 0<(g=e(o.args,0,i)).length?(w=g,n+1+1>r.length?[w]:e(r,n+1,w)):[];if("SUM"===o.selid){if(!(0<(g=e(o.args,0,i)).length))return[];var w=g.reduce((function(e,t){return e+t}),0);return n+1+1>r.length?[w]:e(r,n+1,w)}if("AVG"===o.selid)return 0<(g=e(o.args,0,i)).length?(w=g.reduce((function(e,t){return e+t}),0)/g.length,n+1+1>r.length?[w]:e(r,n+1,w)):[];if("COUNT"===o.selid)return 0<(g=e(o.args,0,i)).length?(w=g.length,n+1+1>r.length?[w]:e(r,n+1,w)):[];if("FIRST"===o.selid)return 0<(g=e(o.args,0,i)).length?(w=g[0],n+1+1>r.length?[w]:e(r,n+1,w)):[];if("LAST"===o.selid)return 0<(g=e(o.args,0,i)).length?(w=g[g.length-1],n+1+1>r.length?[w]:e(r,n+1,w)):[];if("MIN"===o.selid)return 0===(g=e(o.args,0,i)).length?[]:(w=g.reduce((function(e,t){return Math.min(e,t)}),1/0),n+1+1>r.length?[w]:e(r,n+1,w));if("MAX"===o.selid)return 0===(g=e(o.args,0,i)).length?[]:(w=g.reduce((function(e,t){return Math.max(e,t)}),-1/0),n+1+1>r.length?[w]:e(r,n+1,w));if("PLUS"===o.selid){for(T=[],A=e(o.args,0,i).slice(),n+1+1>r.length?T=T.concat(A):A.forEach((function(t){T=T.concat(e(r,n+1,t))})),y=0;0<A.length;)if(g=A.shift(),g=e(o.args,0,g),A=A.concat(g),n+1+1>r.length?T=T.concat(g):g.forEach((function(t){var a=e(r,n+1,t);T=T.concat(a)})),1e5<++y)throw new Error("Security brake. Number of iterations = "+y);return T}if("STAR"===o.selid){for(T=[],T=e(r,n+1,i),A=e(o.args,0,i).slice(),n+1+1>r.length?T=T.concat(A):A.forEach((function(t){T=T.concat(e(r,n+1,t))})),y=0;0<A.length;)if(g=A[0],A.shift(),g=e(o.args,0,g),A=A.concat(g),n+1+1<=r.length&&g.forEach((function(t){T=T.concat(e(r,n+1,t))})),1e5<++y)throw new Error("Loop brake. Number of iterations = "+y);return T}if("QUESTION"===o.selid)return T=(T=[]).concat(e(r,n+1,i)),g=e(o.args,0,i),n+1+1<=r.length&&g.forEach((function(t){T=T.concat(e(r,n+1,t))})),T;if("WITH"!==o.selid){if("ROOT"===o.selid)return n+1+1>r.length?[i]:e(r,n+1,a);throw new Error("Wrong selector "+o.selid)}if(0===(g=e(o.args,0,i)).length)return[];var I={status:1,values:g}}else{if(!o.srchid)throw new Error("Selector not found");I=s.srch[o.srchid.toUpperCase()](i,o.args,u,t)}if(void 0===I&&(I={status:1,values:[i]}),E=[],1===I.status){var D=I.values;if(n+1+1>r.length)E=D;else for(y=0;y<I.values.length;y++)E=E.concat(e(r,n+1,D[y]))}return E}(c,0,a):a,this.into?(void 0!==this.into.args[0]&&(i=new Function("params,alasql","var y;return "+this.into.args[0].toJS())(t,s)),void 0!==this.into.args[1]&&(o=new Function("params,alasql","var y;return "+this.into.args[1].toJS())(t,s)),n=s.into[this.into.funcid.toUpperCase()](i,o,n,[],r)):(u.value&&0<n.length&&(n=n[0]),r&&(n=r(n))),n}.bind(r)(t,e,(function(e){i=j(n.query,e),a&&(i=a(i))})),i};return n.query={},n},s.srch={},s.srch.PROP=function(e,t,r){if("XML"!==r.mode)return"object"!=typeof e||null===e||"object"!=typeof t||void 0===e[t[0]]?{status:-1,values:[]}:{status:1,values:[e[t[0]]]};var n=[];return e.children.forEach((function(e){e.name.toUpperCase()===t[0].toUpperCase()&&n.push(e)})),0<n.length?{status:1,values:n}:{status:-1,values:[]}},s.srch.APROP=function(e,t){return"object"!=typeof e||null===e||"object"!=typeof t||void 0===e[t[0]]?{status:1,values:[void 0]}:{status:1,values:[e[t[0]]]}},s.srch.EQ=function(e,t,r,n){var a=t[0].toJS("x","");return e===new Function("x,alasql,params","return "+a)(e,s,n)?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.LIKE=function(e,t,r,n){var a=t[0].toJS("x",""),i=new Function("x,alasql,params","return "+a);return e.toUpperCase().match(new RegExp("^"+i(e,s,n).toUpperCase().replace(/%/g,".*").replace(/\?|_/g,".")+"$"),"g")?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.ATTR=function(e,t,r){if("XML"===r.mode)return void 0===t?{status:1,values:[e.attributes]}:"object"==typeof e&&"object"==typeof e.attributes&&void 0!==e.attributes[t[0]]?{status:1,values:[e.attributes[t[0]]]}:{status:-1,values:[]};throw new Error("ATTR is not using in usual mode")},s.srch.CONTENT=function(e,t,r){if("XML"===r.mode)return{status:1,values:[e.content]};throw new Error("ATTR is not using in usual mode")},s.srch.SHARP=function(e,t){var r=s.databases[s.useid].objects[t[0]];return void 0!==e&&e===r?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.PARENT=function(){return{status:-1,values:[]}},s.srch.CHILD=function(e,t,r){return"object"==typeof e?Array.isArray(e)?{status:1,values:e}:"XML"===r.mode?{status:1,values:Object.keys(e.children).map((function(t){return e.children[t]}))}:{status:1,values:Object.keys(e).map((function(t){return e[t]}))}:{status:1,values:[]}},s.srch.KEYS=function(e){return"object"==typeof e&&null!==e?{status:1,values:Object.keys(e)}:{status:1,values:[]}},s.srch.WHERE=function(e,t,r,n){var a=t[0].toJS("x","");return new Function("x,alasql,params","return "+a)(e,s,n)?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.NAME=function(e,t){return e.name===t[0]?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.CLASS=function(e,t){return e.$class==t?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.VERTEX=function(e){return"VERTEX"===e.$node?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.INSTANCEOF=function(e,t){return e instanceof s.fn[t[0]]?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.EDGE=function(e){return"EDGE"===e.$node?{status:1,values:[e]}:{status:-1,values:[]}},s.srch.EX=function(e,t,r,n){var a=t[0].toJS("x","");return{status:1,values:[new Function("x,alasql,params","return "+a)(e,s,n)]}},s.srch.RETURN=function(e,t,r,n){var a={};return t&&0<t.length&&t.forEach((function(t){var r=t.toJS("x",""),i=new Function("x,alasql,params","return "+r);void 0===t.as&&(t.as=t.toString()),a[t.as]=i(e,s,n)})),{status:1,values:[a]}},s.srch.REF=function(e){return{status:1,values:[s.databases[s.useid].objects[e]]}},s.srch.OUT=function(e){return e.$out&&0<e.$out.length?{status:1,values:e.$out.map((function(e){return s.databases[s.useid].objects[e]}))}:{status:-1,values:[]}},s.srch.OUTOUT=function(e){if(e.$out&&0<e.$out.length){var t=[];return e.$out.forEach((function(e){var r=s.databases[s.useid].objects[e];r&&r.$out&&0<r.$out.length&&r.$out.forEach((function(e){t=t.concat(s.databases[s.useid].objects[e])}))})),{status:1,values:t}}return{status:-1,values:[]}},s.srch.IN=function(e){return e.$in&&0<e.$in.length?{status:1,values:e.$in.map((function(e){return s.databases[s.useid].objects[e]}))}:{status:-1,values:[]}},s.srch.ININ=function(e){if(e.$in&&0<e.$in.length){var t=[];return e.$in.forEach((function(e){var r=s.databases[s.useid].objects[e];r&&r.$in&&0<r.$in.length&&r.$in.forEach((function(e){t=t.concat(s.databases[s.useid].objects[e])}))})),{status:1,values:t}}return{status:-1,values:[]}},s.srch.AS=function(e,t){return{status:1,values:[s.vars[t[0]]=e]}},s.srch.AT=function(e,t){return{status:1,values:[s.vars[t[0]]]}},s.srch.CLONEDEEP=function(e){return{status:1,values:[w(e)]}},s.srch.SET=function(e,t,r,n){var a=t.map((function(e){return"@"===e.method?"alasql.vars['"+e.variable+"']="+e.expression.toJS("x",""):"$"===e.method?"params['"+e.variable+"']="+e.expression.toJS("x",""):"x['"+e.column.columnid+"']="+e.expression.toJS("x","")})).join(";");return new Function("x,params,alasql",a)(e,n,s),{status:1,values:[e]}},s.srch.ROW=function(e,t,r,n){var a="var y;return [";return a+=t.map((function(e){return e.toJS("x","")})).join(","),a+="]",{status:1,values:[new Function("x,params,alasql",a)(e,n,s)]}},s.srch.D3=function(e){return"VERTEX"!==e.$node&&"EDGE"===e.$node&&(e.source=e.$in[0],e.target=e.$out[0]),{status:1,values:[e]}},s.srch.ORDERBY=function(e,t){return{status:1,values:e.sort(function(e){if(e){if(e&&1===e.length&&e[0].expression&&"function"==typeof e[0].expression){var t=e[0].expression;return function(e,r){var n=t(e),a=t(r);return a<n?1:n===a?0:-1}}var r="",n="";return e.forEach((function(e){var t="";if(e.expression instanceof P.NumValue&&(e.expression=self.columns[e.expression.value-1]),e.expression instanceof P.Column){var a=e.expression.columnid;s.options.valueof&&(t=".valueOf()"),e.nocase&&(t+=".toUpperCase()"),"_"===a?(r+="if(a"+t+("ASC"===e.direction?">":"<")+"b"+t+")return 1;",r+="if(a"+t+"==b"+t+"){"):(r+="if((a['"+a+"']||'')"+t+("ASC"===e.direction?">":"<")+"(b['"+a+"']||'')"+t+")return 1;",r+="if((a['"+a+"']||'')"+t+"==(b['"+a+"']||'')"+t+"){")}else t=".valueOf()",e.nocase&&(t+=".toUpperCase()"),r+="if(("+e.toJS("a","")+"||'')"+t+("ASC"===e.direction?">(":"<(")+e.toJS("b","")+"||'')"+t+")return 1;",r+="if(("+e.toJS("a","")+"||'')"+t+"==("+e.toJS("b","")+"||'')"+t+"){";n+="}"})),r+="return 0;",r+=n+"return -1",new Function("a,b",r)}}(t))}};var B=function(e){for(var t=0,r=e.sources.length;t<r;t++){var n=e.sources[t];if(delete n.ix,0<t&&"ix"==n.optimization&&n.onleftfn&&n.onrightfn){if(n.databaseid&&s.databases[n.databaseid].tables[n.tableid]){s.databases[n.databaseid].tables[n.tableid].indices||(e.database.tables[n.tableid].indices={});var a=s.databases[n.databaseid].tables[n.tableid].indices[T(n.onrightfns+"`"+n.srcwherefns)];!s.databases[n.databaseid].tables[n.tableid].dirty&&a&&(n.ix=a)}if(!n.ix){n.ix={};for(var i,o={},u=0,c=n.data.length;(i=n.data[u])||n.getfn&&(i=n.getfn(u))||u<c;){if(n.getfn&&!n.dontcache&&(n.data[u]=i),o[n.alias||n.tableid]=i,n.srcwherefn(o,e.params,s)){var l=n.onrightfn(o,e.params,s),h=n.ix[l];(h=h||(n.ix[l]=[])).push(i)}u++}n.databaseid&&s.databases[n.databaseid].tables[n.tableid]&&(s.databases[n.databaseid].tables[n.tableid].indices[T(n.onrightfns+"`"+n.srcwherefns)]=n.ix)}}else if(n.wxleftfn){if(s.databases[n.databaseid].engineid||(a=s.databases[n.databaseid].tables[n.tableid].indices[T(n.wxleftfns+"`")]),!s.databases[n.databaseid].tables[n.tableid].dirty&&a)n.ix=a,n.data=n.ix[n.wxrightfn(null,e.params,s)];else{for(n.ix={},o={},u=0,c=n.data.length;(i=n.data[u])||n.getfn&&(i=n.getfn(u))||u<c;)n.getfn&&!n.dontcache&&(n.data[u]=i),o[n.alias||n.tableid]=n.data[u],l=n.wxleftfn(o,e.params,s),(h=(h=n.ix[l])||(n.ix[l]=[])).push(n.data[u]),u++;s.databases[n.databaseid].engineid||(s.databases[n.databaseid].tables[n.tableid].indices[T(n.wxleftfns+"`")]=n.ix)}n.srcwherefns&&(n.data?(o={},n.data=n.data.filter((function(t){return o[n.alias]=t,n.srcwherefn(o,e.params,s)}))):n.data=[])}else if(n.srcwherefns&&!n.dontcache)if(n.data){o={},n.data=n.data.filter((function(t){return o[n.alias]=t,n.srcwherefn(o,e.params,s)})),o={},u=0,c=n.data.length;for(var d=[];(i=n.data[u])||n.getfn&&(i=n.getfn(u))||u<c;)n.getfn&&!n.dontcache&&(n.data[u]=i),o[n.alias]=i,n.srcwherefn(o,e.params,s)&&d.push(i),u++;n.data=d}else n.data=[];n.databaseid&&s.databases[n.databaseid].tables[n.tableid]}};function j(e,t){if(void 0===t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t)return t;var r=e.modifier||s.options.modifier,n=e.columns;if(void 0===n||0==n.length)if(0<t.length){for(var a={},i=Math.min(t.length,s.options.columnlookup||10)-1;0<=i;i--)for(var o in t[i])a[o]=!0;n=Object.keys(a).map((function(e){return{columnid:e}}))}else n=[];if("VALUE"===r)t=0<t.length?(o=n&&0<n.length?n[0].columnid:Object.keys(t[0])[0],t[0][o]):void 0;else if("ROW"===r)if(0<t.length){var u=[];for(var o in t[0])u.push(t[0][o]);t=u}else t=void 0;else if("COLUMN"===r){var c=[];if(0<t.length){o=n&&0<n.length?n[0].columnid:Object.keys(t[0])[0],i=0;for(var l=t.length;i<l;i++)c.push(t[i][o])}t=c}else if("MATRIX"===r){for(c=[],i=0;i<t.length;i++){u=[];for(var h=t[i],d=0;d<n.length;d++)u.push(h[n[d].columnid]);c.push(u)}t=c}else if("INDEX"===r){var f;if(c={},n&&0<n.length)o=n[0].columnid,f=n[1].columnid;else{var p=Object.keys(t[0]);o=p[0],f=p[1]}for(i=0,l=t.length;i<l;i++)c[t[i][o]]=t[i][f];t=c}else if("RECORDSET"===r)t=new s.Recordset({columns:n,data:t});else if("TEXTSTRING"===r){for(o=n&&0<n.length?n[0].columnid:Object.keys(t[0])[0],i=0,l=t.length;i<l;i++)t[i]=t[i][o];t=t.join("\n")}return t}function H(e,t,r){var n="",a=[],i={};return t.forEach((function(t){if(e.ixsources={},e.sources.forEach((function(t){e.ixsources[t.alias]=t})),e.ixsources[t])var o=e.ixsources[t].columns;r&&"json"==s.options.joinstar&&(n+="r['"+t+"']={};"),o&&0<o.length?o.forEach((function(o){if(r&&"underscore"==s.options.joinstar)a.push("'"+t+"_"+o.columnid+"':p['"+t+"']['"+o.columnid+"']");else if(r&&"json"==s.options.joinstar)n+="r['"+t+"']['"+o.columnid+"']=p['"+t+"']['"+o.columnid+"'];";else{var u="p['"+t+"']['"+o.columnid+"']";if(i[o.columnid]){var c=u+" !== undefined ? "+u+" : "+i[o.columnid].value;a[i[o.columnid].id]=i[o.columnid].key+c,i[o.columnid].value=c}else{var l="'"+o.columnid+"':";a.push(l+u),i[o.columnid]={id:a.length-1,value:u,key:l}}}e.selectColumns[b(o.columnid)]=!0;var h={columnid:o.columnid,dbtypeid:o.dbtypeid,dbsize:o.dbsize,dbprecision:o.dbprecision,dbenum:o.dbenum};e.columns.push(h),e.xcolumns[h.columnid]=h})):(n+='var w=p["'+t+'"];for(var k in w){r[k]=w[k]};',e.dirtyColumns=!0)})),{s:a.join(","),sp:n}}P.Select=function(e){return P.extend(this,e)},P.Select.prototype.toString=function(){var e;return e="",this.explain&&(e+="EXPLAIN "),e+="SELECT ",this.modifier&&(e+=this.modifier+" "),this.distinct&&(e+="DISTINCT "),this.top&&(e+="TOP "+this.top.value+" ",this.percent&&(e+="PERCENT ")),e+=this.columns.map((function(e){var t;return t=e.toString(),void 0!==e.as&&(t+=" AS "+e.as),t})).join(", "),this.from&&(e+=" FROM "+this.from.map((function(e){var t;return t=e.toString(),e.as&&(t+=" AS "+e.as),t})).join(",")),this.joins&&(e+=this.joins.map((function(e){var t;if(t=" ",e.joinmode&&(t+=e.joinmode+" "),e.table)t+="JOIN "+e.table.toString();else if(e.select)t+="JOIN ("+e.select.toString()+")";else{if(!(e instanceof s.yy.Apply))throw new Error("Wrong type in JOIN mode");t+=e.toString()}return e.as&&(t+=" AS "+e.as),e.using&&(t+=" USING "+e.using.toString()),e.on&&(t+=" ON "+e.on.toString()),t})).join("")),this.where&&(e+=" WHERE "+this.where.toString()),this.group&&0<this.group.length&&(e+=" GROUP BY "+this.group.map((function(e){return e.toString()})).join(", ")),this.having&&(e+=" HAVING "+this.having.toString()),this.order&&0<this.order.length&&(e+=" ORDER BY "+this.order.map((function(e){return e.toString()})).join(", ")),this.limit&&(e+=" LIMIT "+this.limit.value),this.offset&&(e+=" OFFSET "+this.offset.value),this.union&&(e+=" UNION "+(this.corresponding?"CORRESPONDING ":"")+this.union.toString()),this.unionall&&(e+=" UNION ALL "+(this.corresponding?"CORRESPONDING ":"")+this.unionall.toString()),this.except&&(e+=" EXCEPT "+(this.corresponding?"CORRESPONDING ":"")+this.except.toString()),this.intersect&&(e+=" INTERSECT "+(this.corresponding?"CORRESPONDING ":"")+this.intersect.toString()),e},P.Select.prototype.toJS=function(e){return"alasql.utils.flatArray(this.queriesfn["+(this.queriesidx-1)+"](this.params,null,"+e+"))[0]"},P.Select.prototype.compile=function(e,t){var r=s.databases[e],n=new F;if(n.removeKeys=[],n.aggrKeys=[],n.explain=this.explain,n.explaination=[],n.explid=1,n.modifier=this.modifier,n.database=r,this.compileWhereExists(n),this.compileQueries(n),n.defcols=this.compileDefCols(n,e),n.fromfn=this.compileFrom(n),this.joins&&this.compileJoins(n),n.rownums=[],this.compileSelectGroup0(n),this.group||0<n.selectGroup.length?n.selectgfns=this.compileSelectGroup1(n):n.selectfns=this.compileSelect1(n,t),this.compileRemoveColumns(n),this.where&&this.compileWhereJoins(n),n.wherefn=this.compileWhere(n),(this.group||0<n.selectGroup.length)&&(n.groupfn=this.compileGroup(n)),this.having&&(n.havingfn=this.compileHaving(n)),this.order&&(n.orderfn=this.compileOrder(n,t)),this.group||0<n.selectGroup.length?n.selectgfn=this.compileSelectGroup2(n):n.selectfn=this.compileSelect2(n,t),n.distinct=this.distinct,this.pivot&&(n.pivotfn=this.compilePivot(n)),this.unpivot&&(n.pivotfn=this.compileUnpivot(n)),this.top?n.limit=this.top.value:this.limit&&(n.limit=this.limit.value,this.offset&&(n.offset=this.offset.value)),n.percent=this.percent,n.corresponding=this.corresponding,this.union?(n.unionfn=this.union.compile(e),this.union.order?n.orderfn=this.union.compileOrder(n,t):n.orderfn=null):this.unionall?(n.unionallfn=this.unionall.compile(e),this.unionall.order?n.orderfn=this.unionall.compileOrder(n,t):n.orderfn=null):this.except?(n.exceptfn=this.except.compile(e),this.except.order?n.orderfn=this.except.compileOrder(n,t):n.orderfn=null):this.intersect&&(n.intersectfn=this.intersect.compile(e),this.intersect.order?n.intersectfn=this.intersect.compileOrder(n,t):n.orderfn=null),this.into){if(this.into instanceof P.Table)s.options.autocommit&&s.databases[this.into.databaseid||e].engineid?n.intoallfns='return alasql.engines["'+s.databases[this.into.databaseid||e].engineid+'"].intoTable("'+(this.into.databaseid||e)+'","'+this.into.tableid+'",this.data, columns, cb);':n.intofns="alasql.databases['"+(this.into.databaseid||e)+"'].tables['"+this.into.tableid+"'].data.push(r);";else if(this.into instanceof P.VarValue)n.intoallfns='alasql.vars["'+this.into.variable+'"]=this.data;res=this.data.length;if(cb)res=cb(res);return res;';else if(this.into instanceof P.FuncValue){var a="return alasql.into['"+this.into.funcid.toUpperCase()+"'](";this.into.args&&0<this.into.args.length?(a+=this.into.args[0].toJS()+",",1<this.into.args.length?a+=this.into.args[1].toJS()+",":a+="undefined,"):a+="undefined, undefined,",n.intoallfns=a+"this.data,columns,cb)"}else this.into instanceof P.ParamValue&&(n.intofns="params['"+this.into.param+"'].push(r)");n.intofns?n.intofn=new Function("r,i,params,alasql","var y;"+n.intofns):n.intoallfns&&(n.intoallfn=new Function("columns,cb,params,alasql","var y;"+n.intoallfns))}function i(e,t,r){return n.params=e,function(e,t,r,n,a){e.sources.length,e.sourceslen=e.sources.length;var i,o,u=e.sourceslen;return(e.query=e).A=void 0,e.B=void 0,e.cb=r,e.oldscope=t,e.queriesfn&&(e.sourceslen+=e.queriesfn.length,u+=e.queriesfn.length,e.queriesdata=[],e.queriesfn.forEach((function(t,r){t.query.params=e.params,G([],-r-1,e)}))),i=t?w(t):{},e.scope=i,e.sources.forEach((function(t,r){t.query=e;var n=t.datafn(e,e.params,G,r,s);void 0!==n&&((e.intofn||e.intoallfn)&&Array.isArray(n)&&(n=n.length),o=n),t.queriesdata=e.queriesdata})),0!=e.sources.length&&0!==u||(o=V(e)),o}(n,r,(function(e,r){if(r)return t(r,null);if(0<n.rownums.length)for(var a=0,s=e.length;a<s;a++)for(var i=0,o=n.rownums.length;i<o;i++)e[a][n.rownums[i]]=a+1;var u=j(n,e);return t&&t(u),u}))}return i.query=n,i},P.Select.prototype.execute=function(e,t,r){return this.compile(e)(t,r)},P.ExistsValue=function(e){return P.extend(this,e)},P.ExistsValue.prototype.toString=function(){return"EXISTS("+this.value.toString()+")"},P.ExistsValue.prototype.toType=function(){return"boolean"},P.ExistsValue.prototype.toJS=function(e,t,r){return"this.existsfn["+this.existsidx+"](params,null,"+e+").data.length"},P.Select.prototype.compileWhereExists=function(e){this.exists&&(e.existsfn=this.exists.map((function(t){var r=t.compile(e.database.databaseid);return r.query.modifier="RECORDSET",r})))},P.Select.prototype.compileQueries=function(e){this.queries&&(e.queriesfn=this.queries.map((function(t){var r=t.compile(e.database.databaseid);return r.query.modifier="RECORDSET",r})))},s.precompile=function(e,t,r){e&&(e.params=r,e.queries&&(e.queriesfn=e.queries.map((function(r){var n=r.compile(t||e.database.databaseid);return n.query.modifier="RECORDSET",n}))),e.exists&&(e.existsfn=e.exists.map((function(r){var n=r.compile(t||e.database.databaseid);return n.query.modifier="RECORDSET",n}))))},P.Select.prototype.compileFrom=function(e){e.sources=[],e.aliases={},this.from&&(this.from.forEach((function(t){var r="",n=t.as||t.tableid;if(t instanceof P.Table)e.aliases[n]={tableid:t.tableid,databaseid:t.databaseid||e.database.databaseid,type:"table"};else if(t instanceof P.Select)e.aliases[n]={type:"subquery"};else if(t instanceof P.Search)e.aliases[n]={type:"subsearch"};else if(t instanceof P.ParamValue)e.aliases[n]={type:"paramvalue"};else if(t instanceof P.FuncValue)e.aliases[n]={type:"funcvalue"};else if(t instanceof P.VarValue)e.aliases[n]={type:"varvalue"};else if(t instanceof P.FromData)e.aliases[n]={type:"fromdata"};else if(t instanceof P.Json)e.aliases[n]={type:"json"};else{if(!t.inserted)throw new Error("Wrong table at FROM");e.aliases[n]={type:"inserted"}}var a={alias:n,databaseid:t.databaseid||e.database.databaseid,tableid:t.tableid,joinmode:"INNER",onmiddlefn:d,srcwherefns:"",srcwherefn:d};if(t instanceof P.Table)a.columns=s.databases[a.databaseid].tables[a.tableid].columns,s.options.autocommit&&s.databases[a.databaseid].engineid&&!s.databases[a.databaseid].tables[a.tableid].view?a.datafn=function(e,t,r,n,s){return s.engines[s.databases[a.databaseid].engineid].fromTable(a.databaseid,a.tableid,r,n,e)}:s.databases[a.databaseid].tables[a.tableid].view?a.datafn=function(e,t,r,n,s){var i=s.databases[a.databaseid].tables[a.tableid].select(t);return r&&(i=r(i,n,e)),i}:a.datafn=function(e,t,r,n,s){var i=s.databases[a.databaseid].tables[a.tableid].data;return r&&(i=r(i,n,e)),i};else if(t instanceof P.Select)a.subquery=t.compile(e.database.databaseid),void 0===a.subquery.query.modifier&&(a.subquery.query.modifier="RECORDSET"),a.columns=a.subquery.query.columns,a.datafn=function(e,t,r,n,s){var i;return a.subquery(e.params,(function(t){return i=t.data,r&&(i=r(i,n,e)),i})),i};else if(t instanceof P.Search)a.subsearch=t,a.columns=[],a.datafn=function(e,t,r,n,s){var i;return a.subsearch.execute(e.database.databaseid,e.params,(function(t){return i=t,r&&(i=r(i,n,e)),i})),i};else if(t instanceof P.ParamValue)r="var res = alasql.prepareFromData(params['"+t.param+"']",t.array&&(r+=",true"),r+=");if(cb)res=cb(res,idx,query);return res",a.datafn=new Function("query,params,cb,idx,alasql",r);else if(t.inserted)r="var res = alasql.prepareFromData(alasql.inserted",t.array&&(r+=",true"),r+=");if(cb)res=cb(res,idx,query);return res",a.datafn=new Function("query,params,cb,idx,alasql",r);else if(t instanceof P.Json)r="var res = alasql.prepareFromData("+t.toJS(),t.array&&(r+=",true"),r+=");if(cb)res=cb(res,idx,query);return res",a.datafn=new Function("query,params,cb,idx,alasql",r);else if(t instanceof P.VarValue)r="var res = alasql.prepareFromData(alasql.vars['"+t.variable+"']",t.array&&(r+=",true"),r+=");if(cb)res=cb(res,idx,query);return res",a.datafn=new Function("query,params,cb,idx,alasql",r);else if(t instanceof P.FuncValue)r="var res=alasql.from['"+t.funcid.toUpperCase()+"'](",t.args&&0<t.args.length?(t.args[0]?r+=t.args[0].toJS("query.oldscope")+",":r+="null,",t.args[1]?r+=t.args[1].toJS("query.oldscope")+",":r+="null,"):r+="null,null,",r+="cb,idx,query",r+=");/*if(cb)res=cb(res,idx,query);*/return res",a.datafn=new Function("query, params, cb, idx, alasql",r);else{if(!(t instanceof P.FromData))throw new Error("Wrong table at FROM");a.datafn=function(e,r,n,a,s){var i=t.data;return n&&(i=n(i,a,e)),i}}e.sources.push(a)})),e.defaultTableid=e.sources[0].alias)},s.prepareFromData=function(e,t){var r,n,a=e;if("string"==typeof e){if(a=e.split(/\r?\n/),t)for(r=0,n=a.length;r<n;r++)a[r]=[a[r]]}else if(t)for(a=[],r=0,n=e.length;r<n;r++)a.push([e[r]]);else if("object"==typeof e&&!Array.isArray(e))if("undefined"!=typeof Mongo&&void 0!==Mongo.Collection&&e instanceof Mongo.Collection)a=e.find().fetch();else for(var s in a=[],e)e.hasOwnProperty(s)&&a.push([s,e[s]]);return a},P.Select.prototype.compileJoins=function(e){this.joins.forEach((function(t){var r,n,a;if("CROSS"===t.joinmode){if(t.using||t.on)throw new Error("CROSS JOIN cannot have USING or ON clauses");t.joinmode="INNER"}if(t instanceof P.Apply)return(a={alias:t.as,applymode:t.applymode,onmiddlefn:d,srcwherefns:"",srcwherefn:d,columns:[]}).applyselect=t.select.compile(e.database.databaseid),a.columns=a.applyselect.query.columns,a.datafn=function(e,t,r,n,a){var s;return r&&(s=r(s,n,e)),s},void e.sources.push(a);if(t.table){if(r=t.table,a={alias:t.as||r.tableid,databaseid:r.databaseid||e.database.databaseid,tableid:r.tableid,joinmode:t.joinmode,onmiddlefn:d,srcwherefns:"",srcwherefn:d,columns:[]},!s.databases[a.databaseid].tables[a.tableid])throw new Error("Table '"+a.tableid+"' is not exists in database '"+a.databaseid+"'");a.columns=s.databases[a.databaseid].tables[a.tableid].columns,s.options.autocommit&&s.databases[a.databaseid].engineid?a.datafn=function(e,t,r,n,s){return s.engines[s.databases[a.databaseid].engineid].fromTable(a.databaseid,a.tableid,r,n,e)}:s.databases[a.databaseid].tables[a.tableid].view?a.datafn=function(e,t,r,n,s){var i=s.databases[a.databaseid].tables[a.tableid].select(t);return r&&(i=r(i,n,e)),i}:a.datafn=function(e,t,r,n,s){var i=s.databases[a.databaseid].tables[a.tableid].data;return r&&(i=r(i,n,e)),i},e.aliases[a.alias]={tableid:r.tableid,databaseid:r.databaseid||e.database.databaseid}}else if(t.select)r=t.select,(a={alias:t.as,joinmode:t.joinmode,onmiddlefn:d,srcwherefns:"",srcwherefn:d,columns:[]}).subquery=r.compile(e.database.databaseid),void 0===a.subquery.query.modifier&&(a.subquery.query.modifier="RECORDSET"),a.columns=a.subquery.query.columns,a.datafn=function(e,t,r,n,s){return a.subquery(e.params,null,r,n).data},e.aliases[a.alias]={type:"subquery"};else if(t.param)a={alias:t.as,joinmode:t.joinmode,onmiddlefn:d,srcwherefns:"",srcwherefn:d},n="var res=alasql.prepareFromData(params['"+t.param.param+"']",t.array&&(n+=",true"),n+=");if(cb)res=cb(res, idx, query);return res",a.datafn=new Function("query,params,cb,idx, alasql",n),e.aliases[a.alias]={type:"paramvalue"};else if(t.variable)a={alias:t.as,joinmode:t.joinmode,onmiddlefn:d,srcwherefns:"",srcwherefn:d},n="var res=alasql.prepareFromData(alasql.vars['"+t.variable+"']",t.array&&(n+=",true"),n+=");if(cb)res=cb(res, idx, query);return res",a.datafn=new Function("query,params,cb,idx, alasql",n),e.aliases[a.alias]={type:"varvalue"};else if(t.func){a={alias:t.as,joinmode:t.joinmode,onmiddlefn:d,srcwherefns:"",srcwherefn:d};var i="var res=alasql.from['"+t.func.funcid.toUpperCase()+"'](",o=t.func.args;o&&0<o.length?(o[0]?i+=o[0].toJS("query.oldscope")+",":i+="null,",o[1]?i+=o[1].toJS("query.oldscope")+",":i+="null,"):i+="null,null,",i+="cb,idx,query",i+=");/*if(cb)res=cb(res,idx,query);*/return res",a.datafn=new Function("query, params, cb, idx, alasql",i),e.aliases[a.alias]={type:"funcvalue"}}var u=a.alias;if(t.natural){if(t.using||t.on)throw new Error("NATURAL JOIN cannot have USING or ON clauses");if(0<e.sources.length){var c=e.sources[e.sources.length-1],l=s.databases[c.databaseid].tables[c.tableid],h=s.databases[a.databaseid].tables[a.tableid];if(!l||!h)throw new Error("In this version of Alasql NATURAL JOIN works for tables with predefined columns only");var f=l.columns.map((function(e){return e.columnid})),p=h.columns.map((function(e){return e.columnid}));t.using=N(f,p).map((function(e){return{columnid:e}}))}}if(t.using)c=e.sources[e.sources.length-1],a.onleftfns=t.using.map((function(e){return"p['"+(c.alias||c.tableid)+"']['"+e.columnid+"']"})).join('+"`"+'),a.onleftfn=new Function("p,params,alasql","var y;return "+a.onleftfns),a.onrightfns=t.using.map((function(e){return"p['"+(a.alias||a.tableid)+"']['"+e.columnid+"']"})).join('+"`"+'),a.onrightfn=new Function("p,params,alasql","var y;return "+a.onrightfns),a.optimization="ix";else if(t.on)if(t.on instanceof P.Op&&"="===t.on.op&&!t.on.allsome){var b="",E="",g="",m=!(a.optimization="ix"),v=t.on.left.toJS("p",e.defaultTableid,e.defcols),S=t.on.right.toJS("p",e.defaultTableid,e.defcols);-1<v.indexOf("p['"+u+"']")&&!(-1<S.indexOf("p['"+u+"']"))?(v.match(/p\['.*?'\]/g)||[]).every((function(e){return e==="p['"+u+"']"}))?E=v:m=!0:!(-1<v.indexOf("p['"+u+"']"))&&-1<S.indexOf("p['"+u+"']")&&(S.match(/p\['.*?'\]/g)||[]).every((function(e){return e==="p['"+u+"']"}))?b=v:m=!0,-1<S.indexOf("p['"+u+"']")&&!(-1<v.indexOf("p['"+u+"']"))?(S.match(/p\['.*?'\]/g)||[]).every((function(e){return e==="p['"+u+"']"}))?E=S:m=!0:!(-1<S.indexOf("p['"+u+"']"))&&-1<v.indexOf("p['"+u+"']")&&(v.match(/p\['.*?'\]/g)||[]).every((function(e){return e==="p['"+u+"']"}))?b=S:m=!0,m&&(b=E="",g=t.on.toJS("p",e.defaultTableid,e.defcols),a.optimization="no"),a.onleftfns=b,a.onrightfns=E,a.onmiddlefns=g||"true",a.onleftfn=new Function("p,params,alasql","var y;return "+a.onleftfns),a.onrightfn=new Function("p,params,alasql","var y;return "+a.onrightfns),a.onmiddlefn=new Function("p,params,alasql","var y;return "+a.onmiddlefns)}else a.optimization="no",a.onmiddlefns=t.on.toJS("p",e.defaultTableid,e.defcols),a.onmiddlefn=new Function("p,params,alasql","var y;return "+t.on.toJS("p",e.defaultTableid,e.defcols));e.sources.push(a)}))},P.Select.prototype.compileWhere=function(e){if(this.where){if("function"==typeof this.where)return this.where;var t=this.where.toJS("p",e.defaultTableid,e.defcols);return e.wherefns=t,new Function("p,params,alasql","var y;return "+t)}return function(){return!0}},P.Select.prototype.compileWhereJoins=function(e){},P.Select.prototype.compileGroup=function(e){if(0<e.sources.length)var t=e.sources[0].alias;else t="";var r=e.defcols,n=[[]];this.group&&(n=K(this.group,e));var a=[];n.forEach((function(e){a=A(a,e)})),e.allgroups=a,e.ingroup=[];var s="";return n.forEach((function(n){s+="var g=this.xgroups[";var i=n.map((function(t){var r=t.split("\t")[0],n=t.split("\t")[1];return""===r?"1":(e.ingroup.push(r),n)}));0===i.length&&(i=["''"]),s+=i.join('+"`"+'),s+="];if(!g) {this.groups.push((g=this.xgroups[",s+=i.join('+"`"+'),s+="] = {",s+=n.map((function(e){var t=e.split("\t")[0],r=e.split("\t")[1];return""===t?"":"'"+t+"':"+r+","})).join("");var o=y(a,n);s+=o.map((function(e){return"'"+e.split("\t")[0]+"':null,"})).join("");var u="",c="";void 0!==e.groupStar&&(c+="for(var f in p['"+e.groupStar+"']) {g[f]=p['"+e.groupStar+"'][f];};"),s+=e.selectGroup.map((function(n){var a=n.expression.toJS("p",t,r),s=n.nick;return n instanceof P.AggrValue?(n.distinct&&(u+=",g['$$_VALUES_"+s+"']={},g['$$_VALUES_"+s+"']["+a+"]=true"),"SUM"===n.aggregatorid?"'"+s+"':("+a+")||0,":"MIN"===n.aggregatorid||"MAX"===n.aggregatorid||"FIRST"===n.aggregatorid||"LAST"===n.aggregatorid?"'"+s+"':"+a+",":"ARRAY"===n.aggregatorid?"'"+s+"':["+a+"],":"COUNT"===n.aggregatorid?"*"===n.expression.columnid?"'"+s+"':1,":"'"+s+"':(typeof "+a+' != "undefined")?1:0,':"AVG"===n.aggregatorid?(e.removeKeys.push("_SUM_"+s),e.removeKeys.push("_COUNT_"+s),"'"+s+"':"+a+",'_SUM_"+s+"':("+a+")||0,'_COUNT_"+s+"':(typeof "+a+' != "undefined")?1:0,'):"AGGR"===n.aggregatorid?(u+=",g['"+s+"']="+n.expression.toJS("g",-1),""):"REDUCE"===n.aggregatorid?(e.aggrKeys.push(n),"'"+s+"':alasql.aggr['"+n.funcid+"']("+a+",undefined,1),"):""):""})).join(""),s+="}"+u+",g));"+c+"} else {",s+=e.selectGroup.map((function(e){var n=e.nick,a=e.expression.toJS("p",t,r);if(e instanceof P.AggrValue){var s="",i="";return e.distinct&&(s="if(typeof "+a+'!="undefined" && (!g[\'$$_VALUES_'+n+"']["+a+"])) \t\t\t\t \t\t {",i="g['$$_VALUES_"+n+"']["+a+"]=true;}"),"SUM"===e.aggregatorid?s+"g['"+n+"']+=("+a+"||0);"+i:"COUNT"===e.aggregatorid?"*"===e.expression.columnid?s+"g['"+n+"']++;"+i:s+"if(typeof "+a+'!="undefined") g[\''+n+"']++;"+i:"ARRAY"===e.aggregatorid?s+"g['"+n+"'].push("+a+");"+i:"MIN"===e.aggregatorid?s+"if ((y="+a+") < g['"+n+"']) g['"+n+"'] = y;"+i:"MAX"===e.aggregatorid?s+"if ((y="+a+") > g['"+n+"']) g['"+n+"'] = y;"+i:"FIRST"===e.aggregatorid?"":"LAST"===e.aggregatorid?s+"g['"+n+"']="+a+";"+i:"AVG"===e.aggregatorid?s+"g['_SUM_"+n+"']+=(y="+a+")||0;g['_COUNT_"+n+"']+=(typeof y!=\"undefined\")?1:0;g['"+n+"']=g['_SUM_"+n+"']/g['_COUNT_"+n+"'];"+i:"AGGR"===e.aggregatorid?s+"g['"+n+"']="+e.expression.toJS("g",-1)+";"+i:"REDUCE"===e.aggregatorid?s+"g['"+n+"']=alasql.aggr."+e.funcid+"("+a+",g['"+n+"'],2);"+i:""}return""})).join(""),s+="}"})),new Function("p,params,alasql","var y;"+s)},P.Select.prototype.compileSelect1=function(e,t){var r=this;e.columns=[],e.xcolumns={},e.selectColumns={},e.dirtyColumns=!1;var n="var r={",a="",i=[];return this.columns.forEach((function(n){if(n instanceof P.Column)if("*"===n.columnid)if(n.func)a+="r=params['"+n.param+"'](p['"+e.sources[0].alias+"'],p,params,alasql);";else if(n.tableid)(o=H(e,[n.tableid],!1)).s&&(i=i.concat(o.s)),a+=o.sp;else{var o;(o=H(e,Object.keys(e.aliases),!0)).s&&(i=i.concat(o.s)),a+=o.sp}else{var u=n.tableid,c=n.databaseid||e.sources[0].databaseid||e.database.databaseid;if(u=(u=u||e.defcols[n.columnid])||e.defaultTableid,"_"!==n.columnid?t&&1<t.length&&Array.isArray(t[0])&&1<=t[0].length&&t[0][0].hasOwnProperty("sheetid")?a='var r={};var w=p["'+u+'"];var cols=['+r.columns.map((function(e){return"'"+e.columnid+"'"})).join(",")+"];var colas=["+r.columns.map((function(e){return"'"+(e.as||e.columnid)+"'"})).join(",")+"];for (var i=0;i<Object.keys(p['"+u+"']).length;i++) for(var k=0;k<cols.length;k++){if (!r.hasOwnProperty(i)) r[i]={}; r[i][colas[k]]=w[i][cols[k]];}":i.push("'"+b(n.as||n.columnid)+"':p['"+u+"']['"+n.columnid+"']"):i.push("'"+b(n.as||n.columnid)+"':p['"+u+"']"),e.selectColumns[b(n.as||n.columnid)]=!0,e.aliases[u]&&"table"===e.aliases[u].type){if(!s.databases[c].tables[e.aliases[u].tableid])throw new Error("Table '"+u+"' does not exist in database");var h=s.databases[c].tables[e.aliases[u].tableid].columns,d=s.databases[c].tables[e.aliases[u].tableid].xcolumns;if(d&&0<h.length){var f=d[n.columnid];if(void 0===f)throw new Error("Column does not exist: "+n.columnid);var p={columnid:n.as||n.columnid,dbtypeid:f.dbtypeid,dbsize:f.dbsize,dbpecision:f.dbprecision,dbenum:f.dbenum};e.columns.push(p),e.xcolumns[p.columnid]=p}else p={columnid:n.as||n.columnid},e.columns.push(p),e.xcolumns[p.columnid]=p,e.dirtyColumns=!0}else p={columnid:n.as||n.columnid},e.columns.push(p),e.xcolumns[p.columnid]=p}else n instanceof P.AggrValue?(r.group||(r.group=[""]),n.as||(n.as=b(n.toString())),"SUM"===n.aggregatorid||"MAX"===n.aggregatorid||"MIN"===n.aggregatorid||"FIRST"===n.aggregatorid||"LAST"===n.aggregatorid||"AVG"===n.aggregatorid||"ARRAY"===n.aggregatorid||"REDUCE"===n.aggregatorid?i.push("'"+b(n.as)+"':"+l(n.expression.toJS("p",e.defaultTableid,e.defcols))):"COUNT"===n.aggregatorid&&i.push("'"+b(n.as)+"':1"),p={columnid:n.as||n.columnid||n.toString()},e.columns.push(p),e.xcolumns[p.columnid]=p):(i.push("'"+b(n.as||n.columnid||n.toString())+"':"+l(n.toJS("p",e.defaultTableid,e.defcols))),e.selectColumns[b(n.as||n.columnid||n.toString())]=!0,p={columnid:n.as||n.columnid||n.toString()},e.columns.push(p),e.xcolumns[p.columnid]=p)})),n+(i.join(",")+"};")+a},P.Select.prototype.compileSelect2=function(e,t){var r=e.selectfns;return this.orderColumns&&0<this.orderColumns.length&&this.orderColumns.forEach((function(n,a){var s="$$$"+a;n instanceof P.Column&&e.xcolumns[n.columnid]?r+="r['"+s+"']=r['"+n.columnid+"'];":n instanceof P.ParamValue&&e.xcolumns[t[n.param]]?r+="r['"+s+"']=r['"+t[n.param]+"'];":r+="r['"+s+"']="+n.toJS("p",e.defaultTableid,e.defcols)+";",e.removeKeys.push(s)})),new Function("p,params,alasql","var y;"+r+"return r")},P.Select.prototype.compileSelectGroup0=function(e){var t=this;t.columns.forEach((function(r,n){if(r instanceof P.Column&&"*"===r.columnid)e.groupStar=r.tableid||"default";else{var a;a=r instanceof P.Column?b(r.columnid):b(r.toString(!0));for(var s=0;s<n;s++)if(a===t.columns[s].nick){a=t.columns[s].nick+":"+n;break}r.nick=a,!r.funcid||"ROWNUM"!==r.funcid.toUpperCase()&&"ROW_NUMBER"!==r.funcid.toUpperCase()||e.rownums.push(r.as)}})),this.columns.forEach((function(t){t.findAggregator&&t.findAggregator(e)})),this.having&&this.having.findAggregator&&this.having.findAggregator(e)},P.Select.prototype.compileSelectGroup1=function(e){var t="var r = {};";return this.columns.forEach((function(r){if(r instanceof P.Column&&"*"===r.columnid)return t+="for(var k in g) {r[k]=g[k]};","";var n=r.as;void 0===n&&(n=r instanceof P.Column?b(r.columnid):r.nick),e.groupColumns[n]=r.nick,t+="r['"+n+"']=",t+=l(r.toJS("g",""))+";";for(var a=0;a<e.removeKeys.length;a++)if(e.removeKeys[a]===n){e.removeKeys.splice(a,1);break}})),t},P.Select.prototype.compileSelectGroup2=function(e){var t=e.selectgfns;return this.columns.forEach((function(r){-1<e.ingroup.indexOf(r.nick)&&(t+="r['"+(r.as||r.nick)+"']=g['"+r.nick+"'];")})),this.orderColumns&&0<this.orderColumns.length&&this.orderColumns.forEach((function(r,n){var a="$$$"+n;r instanceof P.Column&&e.groupColumns[r.columnid]?t+="r['"+a+"']=r['"+r.columnid+"'];":t+="r['"+a+"']="+r.toJS("g","")+";",e.removeKeys.push(a)})),new Function("g,params,alasql","var y;"+t+"return r")},P.Select.prototype.compileRemoveColumns=function(e){void 0!==this.removecolumns&&(e.removeKeys=e.removeKeys.concat(this.removecolumns.filter((function(e){return void 0===e.like})).map((function(e){return e.columnid}))),e.removeLikeKeys=this.removecolumns.filter((function(e){return void 0!==e.like})).map((function(e){return e.like.value})))},P.Select.prototype.compileHaving=function(e){if(this.having){var t=this.having.toJS("g",-1);return e.havingfns=t,new Function("g,params,alasql","var y;return "+t)}return function(){return!0}},P.Select.prototype.compileOrder=function(e,t){var r=this;if(r.orderColumns=[],this.order){if(this.order&&1==this.order.length&&this.order[0].expression&&"function"==typeof this.order[0].expression){var n=this.order[0].expression;return function(e,t){var r=n(e),a=n(t);return a<r?1:r==a?0:-1}}var a="",i="";return this.order.forEach((function(n,o){if(n.expression instanceof P.NumValue)var u=r.columns[n.expression.value-1];else u=n.expression;r.orderColumns.push(u);var c,l="$$$"+o,h="";if(n.expression instanceof P.Column){var d=n.expression.columnid;e.xcolumns[d]?"DATE"!=(c=e.xcolumns[d].dbtypeid)&&"DATETIME"!=c&&"DATETIME2"!=c||(h=".valueOf()"):s.options.valueof&&(h=".valueOf()")}n.expression instanceof P.ParamValue&&(d=t[n.expression.param],e.xcolumns[d]?"DATE"!=(c=e.xcolumns[d].dbtypeid)&&"DATETIME"!=c&&"DATETIME2"!=c||(h=".valueOf()"):s.options.valueof&&(h=".valueOf()")),n.nocase&&(h+=".toUpperCase()"),a+="if((a['"+l+"']||'')"+h+("ASC"==n.direction?">":"<")+"(b['"+l+"']||'')"+h+")return 1;",a+="if((a['"+l+"']||'')"+h+"==(b['"+l+"']||'')"+h+"){",i+="}"})),a+="return 0;",a+=i+"return -1",e.orderfns=a,new Function("a,b","var y;"+a)}},P.Select.prototype.compilePivot=function(e){var t,r=this,n=r.pivot.columnid,a=r.pivot.expr.aggregatorid,i=r.pivot.inlist;if(null==(t=r.pivot.expr.expression.hasOwnProperty("columnid")?r.pivot.expr.expression.columnid:r.pivot.expr.expression.expression.columnid))throw"columnid not found";return i=i&&i.map((function(e){return e.expr.columnid})),function(){var e=this,r=e.columns.filter((function(e){return e.columnid!=n&&e.columnid!=t})).map((function(e){return e.columnid})),o=[],u={},c={},l={},h=[];if(e.data.forEach((function(e){if(!i||-1<i.indexOf(e[n])){var d=r.map((function(t){return e[t]})).join("`"),f=c[d];if(f||(f={},c[d]=f,h.push(f),r.forEach((function(t){f[t]=e[t]}))),l[d]||(l[d]={}),l[d][e[n]]?l[d][e[n]]++:l[d][e[n]]=1,u[e[n]]||(u[e[n]]=!0,o.push(e[n])),"SUM"==a||"AVG"==a)void 0===f[e[n]]&&(f[e[n]]=0),f[e[n]]+=+e[t];else if("COUNT"==a)void 0===f[e[n]]&&(f[e[n]]=0),f[e[n]]++;else if("MIN"==a)void 0===f[e[n]]&&(f[e[n]]=e[t]),e[t]<f[e[n]]&&(f[e[n]]=e[t]);else if("MAX"==a)void 0===f[e[n]]&&(f[e[n]]=e[t]),e[t]>f[e[n]]&&(f[e[n]]=e[t]);else if("FIRST"==a)void 0===f[e[n]]&&(f[e[n]]=e[t]);else if("LAST"==a)f[e[n]]=e[t];else{if(!s.aggr[a])throw new Error("Wrong aggregator in PIVOT clause");s.aggr[a](f[e[n]],e[t])}}})),"AVG"==a)for(var d in c){var f=c[d];for(var p in f)-1==r.indexOf(p)&&p!=t&&(f[p]=f[p]/l[d][p])}e.data=h,i&&(o=i);var b=e.columns.filter((function(e){return e.columnid==t}))[0];e.columns=e.columns.filter((function(e){return!(e.columnid==n||e.columnid==t)})),o.forEach((function(t){var r=w(b);r.columnid=t,e.columns.push(r)}))}},P.Select.prototype.compileUnpivot=function(e){var t=this.unpivot.tocolumnid,r=this.unpivot.forcolumnid,n=this.unpivot.inlist.map((function(e){return e.columnid}));return function(){var a=[],s=e.columns.map((function(e){return e.columnid})).filter((function(e){return-1==n.indexOf(e)&&e!=r&&e!=t}));e.data.forEach((function(e){n.forEach((function(n){var i={};s.forEach((function(t){i[t]=e[t]})),i[r]=n,i[t]=e[n],a.push(i)}))})),e.data=a}};var J=function(e,t){for(var r=[],n=0,a=e.length,s=0;s<a+1;s++){for(var i=[],o=0;o<a;o++){if(e[o]instanceof P.Column){e[o].nick=b(e[o].columnid),t.groupColumns[b(e[o].columnid)]=e[o].nick;var u=e[o].nick+"\t"+e[o].toJS("p",t.sources[0].alias,t.defcols)}else t.groupColumns[b(e[o].toString())]=b(e[o].toString()),u=b(e[o].toString())+"\t"+e[o].toJS("p",t.sources[0].alias,t.defcols);n&1<<o&&i.push(u)}r.push(i),n=1+(n<<1)}return r},Y=function(e,t){for(var r=[],n=e.length,a=1<<n,s=0;s<a;s++){for(var i=[],o=0;o<n;o++)s&1<<o&&(i=i.concat(K(e[o],t)));r.push(i)}return r},W=function(e,t){return e.reduce((function(e,r){return e.concat(K(r,t))}),[])},X=function(e,t){for(var r=[],n=0;n<e.length;n++)for(var a=0;a<t.length;a++)r.push(e[n].concat(t[a]));return r};function K(e,t){if(Array.isArray(e)){for(var r=[[]],n=0;n<e.length;n++)if(e[n]instanceof P.Column)e[n].nick=b(e[n].columnid),t.groupColumns[e[n].nick]=e[n].nick,r=r.map((function(r){return r.concat(e[n].nick+"\t"+e[n].toJS("p",t.sources[0].alias,t.defcols))}));else if(e[n]instanceof P.FuncValue)t.groupColumns[b(e[n].toString())]=b(e[n].toString()),r=r.map((function(r){return r.concat(b(e[n].toString())+"\t"+e[n].toJS("p",t.sources[0].alias,t.defcols))}));else if(e[n]instanceof P.GroupExpression)if("ROLLUP"==e[n].type)r=X(r,J(e[n].group,t));else if("CUBE"==e[n].type)r=X(r,Y(e[n].group,t));else{if("GROUPING SETS"!=e[n].type)throw new Error("Unknown grouping function");r=X(r,W(e[n].group,t))}else r=""===e[n]?[["1\t1"]]:r.map((function(r){return t.groupColumns[b(e[n].toString())]=b(e[n].toString()),r.concat(b(e[n].toString())+"\t"+e[n].toJS("p",t.sources[0].alias,t.defcols))}));return r}return e instanceof P.FuncValue?(t.groupColumns[b(e.toString())]=b(e.toString()),[e.toString()+"\t"+e.toJS("p",t.sources[0].alias,t.defcols)]):e instanceof P.Column?(e.nick=b(e.columnid),t.groupColumns[e.nick]=e.nick,[e.nick+"\t"+e.toJS("p",t.sources[0].alias,t.defcols)]):(t.groupColumns[b(e.toString())]=b(e.toString()),[b(e.toString())+"\t"+e.toJS("p",t.sources[0].alias,t.defcols)])}P.Select.prototype.compileDefCols=function(e,t){var r={".":{}};return this.from&&this.from.forEach((function(e){if(r["."][e.as||e.tableid]=!0,e instanceof P.Table){var n=e.as||e.tableid,a=s.databases[e.databaseid||t].tables[e.tableid];if(void 0===a)throw new Error("Table does not exist: "+e.tableid);a.columns&&a.columns.forEach((function(e){r[e.columnid]?r[e.columnid]="-":r[e.columnid]=n}))}else if(e instanceof P.Select);else if(e instanceof P.Search);else if(e instanceof P.ParamValue);else if(e instanceof P.VarValue);else if(e instanceof P.FuncValue);else if(e instanceof P.FromData);else if(e instanceof P.Json);else if(!e.inserted)throw new Error("Unknown type of FROM clause")})),this.joins&&this.joins.forEach((function(e){if(r["."][e.as||e.table.tableid]=!0,e.table){var n=e.table.tableid;e.as&&(n=e.as),n=e.as||e.table.tableid;var a=s.databases[e.table.databaseid||t].tables[e.table.tableid];a.columns&&a.columns.forEach((function(e){r[e.columnid]?r[e.columnid]="-":r[e.columnid]=n}))}else if(e.select);else if(e.param);else if(!e.func)throw new Error("Unknown type of FROM clause")})),r},P.Union=function(e){return P.extend(this,e)},P.Union.prototype.toString=function(){return"UNION"},P.Union.prototype.compile=function(e){return null},P.Apply=function(e){return P.extend(this,e)},P.Apply.prototype.toString=function(){var e=this.applymode+" APPLY ("+this.select.toString()+")";return this.as&&(e+=" AS "+this.as),e},P.Over=function(e){return P.extend(this,e)},P.Over.prototype.toString=function(){var e="OVER (";return this.partition&&(e+="PARTITION BY "+this.partition.toString(),this.order&&(e+=" ")),this.order&&(e+="ORDER BY "+this.order.toString()),e+")"},P.ExpressionStatement=function(e){return P.extend(this,e)},P.ExpressionStatement.prototype.toString=function(){return this.expression.toString()},P.ExpressionStatement.prototype.execute=function(e,t,r){if(this.expression){s.precompile(this,e,t);var n=new Function("params,alasql,p","var y;return "+this.expression.toJS("({})","",null)).bind(this)(t,s);return r&&(n=r(n)),n}},P.Expression=function(e){return P.extend(this,e)},P.Expression.prototype.toString=function(e){var t=this.expression.toString(e);return this.order&&(t+=" "+this.order.toString()),this.nocase&&(t+=" COLLATE NOCASE"),this.direction&&(t+=" "+this.direction),t},P.Expression.prototype.findAggregator=function(e){this.expression.findAggregator&&this.expression.findAggregator(e)},P.Expression.prototype.toJS=function(e,t,r){return this.expression.reduced?"true":this.expression.toJS(e,t,r)},P.Expression.prototype.compile=function(e,t,r){return!!this.reduced||new Function("p","var y;return "+this.toJS(e,t,r))},P.JavaScript=function(e){return P.extend(this,e)},P.JavaScript.prototype.toString=function(){return"``"+this.value+"``"},P.JavaScript.prototype.toJS=function(){return"("+this.value+")"},P.JavaScript.prototype.execute=function(e,t,r){var n=1;return new Function("params,alasql,p",this.value)(t,s),r&&(n=r(n)),n},P.Literal=function(e){return P.extend(this,e)},P.Literal.prototype.toString=function(e){var t=this.value;return this.value1&&(t=this.value1+"."+t),this.alias&&!e&&(t+=" AS "+this.alias),t},P.Join=function(e){return P.extend(this,e)},P.Join.prototype.toString=function(){var e=" ";return this.joinmode&&(e+=this.joinmode+" "),e+"JOIN "+this.table.toString()},P.Table=function(e){return P.extend(this,e)},P.Table.prototype.toString=function(){var e=this.tableid;return this.databaseid&&(e=this.databaseid+"."+e),e},P.View=function(e){return P.extend(this,e)},P.View.prototype.toString=function(){var e=this.viewid;return this.databaseid&&(e=this.databaseid+"."+e),e},P.Op=function(e){return P.extend(this,e)},P.Op.prototype.toString=function(){if("IN"===this.op||"NOT IN"===this.op)return this.left.toString()+" "+this.op+" ("+this.right.toString()+")";if(this.allsome)return this.left.toString()+" "+this.op+" "+this.allsome+" ("+this.right.toString()+")";if("->"!==this.op&&"!"!==this.op)return this.left.toString()+" "+this.op+" "+(this.allsome?this.allsome+" ":"")+this.right.toString();var e=this.left.toString()+this.op;return"string"!=typeof this.right&&"number"!=typeof this.right&&(e+="("),e+=this.right.toString(),"string"!=typeof this.right&&"number"!=typeof this.right&&(e+=")"),e},P.Op.prototype.findAggregator=function(e){this.left&&this.left.findAggregator&&this.left.findAggregator(e),this.right&&this.right.findAggregator&&!this.allsome&&this.right.findAggregator(e)},P.Op.prototype.toType=function(e){if(-1<["-","*","/","%","^"].indexOf(this.op))return"number";if(-1<["||"].indexOf(this.op))return"string";if("+"===this.op){if("string"===this.left.toType(e)||"string"===this.right.toType(e))return"string";if("number"===this.left.toType(e)||"number"===this.right.toType(e))return"number"}return-1<["AND","OR","NOT","=","==","===","!=","!==","!===",">",">=","<","<=","IN","NOT IN","LIKE","NOT LIKE","REGEXP","GLOB"].indexOf(this.op)?"boolean":"BETWEEN"===this.op||"NOT BETWEEN"===this.op||"IS NULL"===this.op||"IS NOT NULL"===this.op?"boolean":this.allsome?"boolean":this.op?"unknown":this.left.toType()},P.Op.prototype.toJS=function(e,t,r){function n(n){return n.toJS&&(n=n.toJS(e,t,r)),"y["+(i.push(n)-1)+"]"}function a(){return n(u.left)}function s(){return n(u.right)}var i=[],o=this.op,u=this;if("="===this.op?o="===":"<>"===this.op?o="!=":"OR"===this.op&&(o="||"),"->"===this.op){var c="("+a()+"||{})";if("string"==typeof this.right)h=c+'["'+this.right+'"]';else if("number"==typeof this.right)h=c+"["+this.right+"]";else if(this.right instanceof P.FuncValue){var l=[];this.right.args&&0!==this.right.args.length&&(l=this.right.args.map(n)),h=c+"['"+this.right.funcid+"']("+l.join(",")+")"}else h=c+"["+s()+"]"}if("!"===this.op&&"string"==typeof this.right&&(h="alasql.databases[alasql.useid].objects["+a()+']["'+this.right+'"]'),"IS"===this.op&&(h="(("+a()+"==null) === ("+s()+"==null))"),"=="===this.op&&(h="alasql.utils.deepEqual("+a()+","+s()+")"),"==="!==this.op&&"!==="!==this.op||(h="("+("!==="===this.op?"!":"")+"(("+a()+").valueOf()===("+s()+").valueOf()))"),"!=="===this.op&&(h="(!alasql.utils.deepEqual("+a()+","+s()+"))"),"||"===this.op&&(h="(''+("+a()+"||'')+("+s()+'||""))'),"LIKE"===this.op||"NOT LIKE"===this.op){var h="("+("NOT LIKE"===this.op?"!":"")+"alasql.utils.like("+s()+","+a();this.escape&&(h+=","+n(this.escape)),h+="))"}if("REGEXP"===this.op&&(h="alasql.stdfn.REGEXP_LIKE("+a()+","+s()+")"),"GLOB"===this.op&&(h="alasql.utils.glob("+a()+","+s()+")"),"BETWEEN"===this.op||"NOT BETWEEN"===this.op){var d=a();h="("+("NOT BETWEEN"===this.op?"!":"")+"(("+n(this.right1)+"<="+d+") && ("+d+"<="+n(this.right2)+")))"}if("IN"===this.op&&(this.right instanceof P.Select?(h="(",h+="alasql.utils.flatArray(this.queriesfn["+this.queriesidx+"](params,null,"+e+"))",h+=".indexOf(",h+=a()+")>-1)"):h=Array.isArray(this.right)?"(["+this.right.map(n).join(",")+"].indexOf("+a()+")>-1)":"("+s()+".indexOf("+a()+")>-1)"),"NOT IN"===this.op&&(this.right instanceof P.Select?(h="(",h+="alasql.utils.flatArray(this.queriesfn["+this.queriesidx+"](params,null,p))",h+=".indexOf(",h+=a()+")<0)"):Array.isArray(this.right)?(h="(["+this.right.map(n).join(",")+"].indexOf(",h+=a()+")<0)"):(h="("+s()+".indexOf(",h+=a()+")==-1)")),"ALL"===this.allsome)if(this.right instanceof P.Select)h="alasql.utils.flatArray(this.query.queriesfn["+this.queriesidx+"](params,null,p))",h+=".every(function(b){return (",h+=a()+")"+o+"b})";else{if(!Array.isArray(this.right))throw new Error("NOT IN operator without SELECT");h=""+(1==this.right.length?n(this.right[0]):"["+this.right.map(n).join(",")+"]"),h+=".every(function(b){return (",h+=a()+")"+o+"b})"}if("SOME"===this.allsome||"ANY"===this.allsome)if(this.right instanceof P.Select)h="alasql.utils.flatArray(this.query.queriesfn["+this.queriesidx+"](params,null,p))",h+=".some(function(b){return (",h+=a()+")"+o+"b})";else{if(!Array.isArray(this.right))throw new Error("SOME/ANY operator without SELECT");h=""+(1==this.right.length?n(this.right[0]):"["+this.right.map(n).join(",")+"]"),h+=".some(function(b){return (",h+=a()+")"+o+"b})"}if("AND"===this.op){if(this.left.reduced){if(this.right.reduced)return"true";h=s()}else this.right.reduced&&(h=a());o="&&"}var f=h||"("+a()+o+s()+")",p="y=[("+i.join("), (")+")]";return"&&"===o||"||"===o||"IS"===o||"IS NULL"===o||"IS NOT NULL"===o?"("+p+", "+f+")":"("+p+", y.some(function(e){return e == null}) ? void 0 : "+f+")"},P.VarValue=function(e){return P.extend(this,e)},P.VarValue.prototype.toString=function(){return"@"+this.variable},P.VarValue.prototype.toType=function(){return"unknown"},P.VarValue.prototype.toJS=function(){return"alasql.vars['"+this.variable+"']"},P.NumValue=function(e){return P.extend(this,e)},P.NumValue.prototype.toString=function(){return this.value.toString()},P.NumValue.prototype.toType=function(){return"number"},P.NumValue.prototype.toJS=function(){return""+this.value},P.StringValue=function(e){return P.extend(this,e)},P.StringValue.prototype.toString=function(){return"'"+this.value.toString()+"'"},P.StringValue.prototype.toType=function(){return"string"},P.StringValue.prototype.toJS=function(){return"'"+b(this.value)+"'"},P.DomainValueValue=function(e){return P.extend(this,e)},P.DomainValueValue.prototype.toString=function(){return"VALUE"},P.DomainValueValue.prototype.toType=function(){return"object"},P.DomainValueValue.prototype.toJS=function(e,t,r){return e},P.ArrayValue=function(e){return P.extend(this,e)},P.ArrayValue.prototype.toString=function(){return"ARRAY[]"},P.ArrayValue.prototype.toType=function(){return"object"},P.ArrayValue.prototype.toJS=function(e,t,r){return"[("+this.value.map((function(n){return n.toJS(e,t,r)})).join("), (")+")]"},P.LogicValue=function(e){return P.extend(this,e)},P.LogicValue.prototype.toString=function(){return this.value?"TRUE":"FALSE"},P.LogicValue.prototype.toType=function(){return"boolean"},P.LogicValue.prototype.toJS=function(){return this.value?"true":"false"},P.NullValue=function(e){return P.extend(this,e)},P.NullValue.prototype.toString=function(){return"NULL"},P.NullValue.prototype.toJS=function(){return"undefined"},P.ParamValue=function(e){return P.extend(this,e)},P.ParamValue.prototype.toString=function(){return"$"+this.param},P.ParamValue.prototype.toJS=function(){return"string"==typeof this.param?"params['"+this.param+"']":"params["+this.param+"]"},P.UniOp=function(e){return P.extend(this,e)},P.UniOp.prototype.toString=function(){var e;return e=void 0,"~"===this.op&&(e=this.op+this.right.toString()),"-"===this.op&&(e=this.op+this.right.toString()),"+"===this.op&&(e=this.op+this.right.toString()),"#"===this.op&&(e=this.op+this.right.toString()),"NOT"===this.op&&(e=this.op+"("+this.right.toString()+")"),null===this.op&&(e="("+this.right.toString()+")"),e||"("+this.right.toString()+")"},P.UniOp.prototype.findAggregator=function(e){this.right.findAggregator&&this.right.findAggregator(e)},P.UniOp.prototype.toType=function(){return"-"===this.op?"number":"+"===this.op?"number":"NOT"===this.op?"boolean":void 0},P.UniOp.prototype.toJS=function(e,t,r){return"~"===this.op?"(~("+this.right.toJS(e,t,r)+"))":"-"===this.op?"(-("+this.right.toJS(e,t,r)+"))":"+"===this.op?"("+this.right.toJS(e,t,r)+")":"NOT"===this.op?"!("+this.right.toJS(e,t,r)+")":"#"===this.op?this.right instanceof P.Column?"(alasql.databases[alasql.useid].objects['"+this.right.columnid+"'])":"(alasql.databases[alasql.useid].objects["+this.right.toJS(e,t,r)+"])":null==this.op?"("+this.right.toJS(e,t,r)+")":void 0},P.Column=function(e){return P.extend(this,e)},P.Column.prototype.toString=function(e){var t;return t=this.columnid==+this.columnid?"["+this.columnid+"]":this.columnid,this.tableid&&(t=+this.columnid===this.columnid?this.tableid+t:this.tableid+"."+t,this.databaseid&&(t=this.databaseid+"."+t)),this.alias&&!e&&(t+=" AS "+this.alias),t},P.Column.prototype.toJS=function(e,t,r){var n="";if(this.tableid||""!==t||r)if("g"===e)n="g['"+this.nick+"']";else if(this.tableid)n="_"!==this.columnid?e+"['"+this.tableid+"']['"+this.columnid+"']":"g"===e?"g['_']":e+"['"+this.tableid+"']";else if(r){var a=r[this.columnid];if("-"===a)throw new Error('Cannot resolve column "'+this.columnid+'" because it exists in two source tables');n=a?"_"!==this.columnid?e+"['"+a+"']['"+this.columnid+"']":e+"['"+a+"']":"_"!==this.columnid?e+"['"+(this.tableid||t)+"']['"+this.columnid+"']":e+"['"+(this.tableid||t)+"']"}else n=-1===t?e+"['"+this.columnid+"']":"_"!==this.columnid?e+"['"+(this.tableid||t)+"']['"+this.columnid+"']":e+"['"+(this.tableid||t)+"']";else n="_"!==this.columnid?e+"['"+this.columnid+"']":"g"===e?"g['_']":e;return n},P.AggrValue=function(e){return P.extend(this,e)},P.AggrValue.prototype.toString=function(e){var t="";return"REDUCE"===this.aggregatorid?t+=this.funcid+"(":t+=this.aggregatorid+"(",this.distinct&&(t+="DISTINCT "),this.expression&&(t+=this.expression.toString()),t+=")",this.over&&(t+=" "+this.over.toString()),this.alias&&!e&&(t+=" AS "+this.alias),t},P.AggrValue.prototype.findAggregator=function(e){var t=b(this.toString())+":"+e.selectGroup.length;if(!(r=!1)){if(!this.nick){this.nick=t;for(var r=!1,n=0;n<e.removeKeys.length;n++)if(e.removeKeys[n]===t){r=!0;break}r||e.removeKeys.push(t)}e.selectGroup.push(this)}},P.AggrValue.prototype.toType=function(){return-1<["SUM","COUNT","AVG","MIN","MAX","AGGR","VAR","STDDEV"].indexOf(this.aggregatorid)?"number":-1<["ARRAY"].indexOf(this.aggregatorid)?"array":-1<["FIRST","LAST"].indexOf(this.aggregatorid)?this.expression.toType():void 0},P.AggrValue.prototype.toJS=function(){var e=this.nick;return void 0===e&&(e=this.toString()),"g['"+e+"']"},P.OrderExpression=function(e){return P.extend(this,e)},P.OrderExpression.prototype.toString=P.Expression.prototype.toString,P.GroupExpression=function(e){return P.extend(this,e)},P.GroupExpression.prototype.toString=function(){return this.type+"("+this.group.toString()+")"},P.FromData=function(e){return P.extend(this,e)},P.FromData.prototype.toString=function(){return this.data?"DATA("+(1e16*Math.random()|0)+")":"?"},P.FromData.prototype.toJS=function(){},P.Select.prototype.exec=function(e,t){this.preparams&&(e=this.preparams.concat(e));var r=s.useid;db=s.databases[r];var n=this.toString(),a=T(n),i=this.compile(r);if(i)return i.sql=n,i.dbversion=db.dbversion,db.sqlCacheSize>s.MAXSQLCACHESIZE&&db.resetSqlCache(),db.sqlCacheSize++,db.sqlCache[a]=i,s.res=i(e,t)},P.Select.prototype.Select=function(){var e=this;if(1<arguments.length)args=Array.prototype.slice.call(arguments);else{if(1!=arguments.length)throw new Error("Wrong number of arguments of Select() function");Array.isArray(arguments[0])?args=arguments[0]:args=[arguments[0]]}return e.columns=[],args.forEach((function(t){if("string"==typeof t)e.columns.push(new P.Column({columnid:t}));else if("function"==typeof t){var r=0;e.preparams?r=e.preparams.length:e.preparams=[],e.preparams.push(t),e.columns.push(new P.Column({columnid:"*",func:t,param:r}))}})),e},P.Select.prototype.From=function(e){var t=this;if(t.from||(t.from=[]),Array.isArray(e)){var r=0;t.preparams?r=t.preparams.length:t.preparams=[],t.preparams.push(e),t.from.push(new P.ParamValue({param:r}))}else{if("string"!=typeof e)throw new Error("Unknown arguments in From() function");t.from.push(new P.Table({tableid:e}))}return t},P.Select.prototype.OrderBy=function(){var e=this;if(e.order=[],0==arguments.length)args=["_"];else if(1<arguments.length)args=Array.prototype.slice.call(arguments);else{if(1!=arguments.length)throw new Error("Wrong number of arguments of Select() function");Array.isArray(arguments[0])?args=arguments[0]:args=[arguments[0]]}return 0<args.length&&args.forEach((function(t){var r=new P.Column({columnid:t});"function"==typeof t&&(r=t),e.order.push(new P.OrderExpression({expression:r,direction:"ASC"}))})),e},P.Select.prototype.Top=function(e){return this.top=new P.NumValue({value:e}),this},P.Select.prototype.GroupBy=function(){var e=this;if(1<arguments.length)args=Array.prototype.slice.call(arguments);else{if(1!=arguments.length)throw new Error("Wrong number of arguments of Select() function");Array.isArray(arguments[0])?args=arguments[0]:args=[arguments[0]]}return e.group=[],args.forEach((function(t){var r=new P.Column({columnid:t});e.group.push(r)})),e},P.Select.prototype.Where=function(e){return"function"==typeof e&&(this.where=e),this},P.FuncValue=function(e){return P.extend(this,e)},P.FuncValue.prototype.toString=function(e){var t="";return s.fn[this.funcid]?t+=this.funcid:s.aggr[this.funcid]?t+=this.funcid:(s.stdlib[this.funcid.toUpperCase()]||s.stdfn[this.funcid.toUpperCase()])&&(t+=this.funcid.toUpperCase()),t+="(",this.args&&0<this.args.length&&(t+=this.args.map((function(e){return e.toString()})).join(",")),t+=")",this.as&&!e&&(t+=" AS "+this.as.toString()),t},P.FuncValue.prototype.execute=function(e,t,r){var n=1;return s.precompile(this,e,t),new Function("params,alasql","var y;return "+this.toJS("","",null))(t,s),r&&(n=r(n)),n},P.FuncValue.prototype.findAggregator=function(e){this.args&&0<this.args.length&&this.args.forEach((function(t){t.findAggregator&&t.findAggregator(e)}))},P.FuncValue.prototype.toJS=function(e,t,r){var n="",a=this.funcid;return!s.fn[a]&&s.stdlib[a.toUpperCase()]?this.args&&0<this.args.length?n+=s.stdlib[a.toUpperCase()].apply(this,this.args.map((function(r){return r.toJS(e,t)}))):n+=s.stdlib[a.toUpperCase()]():(!s.fn[a]&&s.stdfn[a.toUpperCase()]?(this.newid&&(n+="new "),n+="alasql.stdfn."+this.funcid.toUpperCase()+"(",this.args&&0<this.args.length&&(n+=this.args.map((function(n){return n.toJS(e,t,r)})).join(","))):(this.newid&&(n+="new "),n+="alasql.fn."+this.funcid+"(",this.args&&0<this.args.length&&(n+=this.args.map((function(n){return n.toJS(e,t,r)})).join(","))),n+=")"),n};var Q=s.stdlib={},z=s.stdfn={};Q.ABS=function(e){return"Math.abs("+e+")"},Q.CLONEDEEP=function(e){return"alasql.utils.cloneDeep("+e+")"},z.CONCAT=function(){return Array.prototype.slice.call(arguments).join("")},Q.EXP=function(e){return"Math.pow(Math.E,"+e+")"},Q.IIF=function(e,t,r){if(3==arguments.length)return"(("+e+")?("+t+"):("+r+"))";throw new Error("Number of arguments of IFF is not equals to 3")},Q.IFNULL=function(e,t){return"("+e+"||"+t+")"},Q.INSTR=function(e,t){return"(("+e+").indexOf("+t+")+1)"},Q.LEN=Q.LENGTH=function(e){return h(e,"y.length")},Q.LOWER=Q.LCASE=function(e){return h(e,"String(y).toLowerCase()")},Q.LTRIM=function(e){return h(e,'y.replace(/^[ ]+/,"")')},Q.RTRIM=function(e){return h(e,'y.replace(/[ ]+$/,"")')},Q.MAX=Q.GREATEST=function(){return"["+Array.prototype.join.call(arguments,",")+"].reduce(function (a, b) { return a > b ? a : b; })"},Q.MIN=Q.LEAST=function(){return"["+Array.prototype.join.call(arguments,",")+"].reduce(function (a, b) { return a < b ? a : b; })"},Q.SUBSTRING=Q.SUBSTR=Q.MID=function(e,t,r){return 2==arguments.length?h(e,"y.substr("+t+"-1)"):3==arguments.length?h(e,"y.substr("+t+"-1,"+r+")"):void 0},z.REGEXP_LIKE=function(e,t,r){return-1<(e||"").search(RegExp(t,r))},Q.ISNULL=Q.NULLIF=function(e,t){return"("+e+"=="+t+"?undefined:"+e+")"},Q.POWER=function(e,t){return"Math.pow("+e+","+t+")"},Q.RANDOM=function(e){return 0==arguments.length?"Math.random()":"(Math.random()*("+e+")|0)"},Q.ROUND=function(e,t){return 2==arguments.length?"Math.round(("+e+")*Math.pow(10,("+t+")))/Math.pow(10,("+t+"))":"Math.round("+e+")"},Q.CEIL=Q.CEILING=function(e){return"Math.ceil("+e+")"},Q.FLOOR=function(e){return"Math.floor("+e+")"},Q.ROWNUM=function(){return"1"},Q.ROW_NUMBER=function(){return"1"},Q.SQRT=function(e){return"Math.sqrt("+e+")"},Q.TRIM=function(e){return h(e,"y.trim()")},Q.UPPER=Q.UCASE=function(e){return h(e,"String(y).toUpperCase()")},z.CONCAT_WS=function(){var e=Array.prototype.slice.call(arguments);return e.slice(1,e.length).join(e[0])},s.aggr.GROUP_CONCAT=function(e,t,r){return 1===r?""+e:2===r?t+=","+e:t},s.aggr.MEDIAN=function(e,t,r){if(2===r)return null!==e&&t.push(e),t;if(1===r)return null===e?[]:[e];if(!t.length)return t;var n=t.sort((function(e,t){return e===t?0:t<e?1:-1})),a=(n.length+1)/2;return Number.isInteger(a)?n[a-1]:"number"!=typeof n[Math.floor(a-1)]?n[Math.floor(a-1)]:(n[Math.floor(a-1)]+n[Math.ceil(a-1)])/2},s.aggr.QUART=function(e,t,r,n){if(2===r)return null!==e&&t.push(e),t;if(1===r)return null===e?[]:[e];if(!t.length)return t;n=n||1;var a=t.sort((function(e,t){return e===t?0:t<e?1:-1})),s=n*(a.length+1)/4;return Number.isInteger(s)?a[s-1]:a[Math.floor(s)]},s.aggr.QUART2=function(e,t,r){return s.aggr.QUART(e,t,r,2)},s.aggr.QUART3=function(e,t,r){return s.aggr.QUART(e,t,r,3)},s.aggr.VAR=function(e,t,r){if(1===r)return null===e?{arr:[],sum:0}:{arr:[e],sum:e};if(2===r)return null===e||(t.arr.push(e),t.sum+=e),t;for(var n=t.arr.length,a=t.sum/n,s=0,i=0;i<n;i++)s+=(t.arr[i]-a)*(t.arr[i]-a);return s/(n-1)},s.aggr.STDEV=function(e,t,r){return 1===r||2===r?s.aggr.VAR(e,t,r):Math.sqrt(s.aggr.VAR(e,t,r))},s.aggr.VARP=function(e,t,r){if(1==r)return{arr:[e],sum:e};if(2==r)return t.arr.push(e),t.sum+=e,t;for(var n=t.arr.length,a=t.sum/n,s=0,i=0;i<n;i++)s+=(t.arr[i]-a)*(t.arr[i]-a);return s/n},s.aggr.STD=s.aggr.STDDEV=s.aggr.STDEVP=function(e,t,r){return 1==r||2==r?s.aggr.VARP(e,t,r):Math.sqrt(s.aggr.VARP(e,t,r))},s._aggrOriginal=s.aggr,s.aggr={},Object.keys(s._aggrOriginal).forEach((function(e){s.aggr[e]=function(t,r,n){if(3!==n||void 0!==r)return s._aggrOriginal[e].apply(null,arguments)}})),z.REPLACE=function(e,t,r){return(e||"").split(t).join(r)};for(var Z=[],ee=0;ee<256;ee++)Z[ee]=(ee<16?"0":"")+ee.toString(16);z.NEWID=z.UUID=z.GEN_RANDOM_UUID=function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return Z[255&e]+Z[e>>8&255]+Z[e>>16&255]+Z[e>>24&255]+"-"+Z[255&t]+Z[t>>8&255]+"-"+Z[t>>16&15|64]+Z[t>>24&255]+"-"+Z[63&r|128]+Z[r>>8&255]+"-"+Z[r>>16&255]+Z[r>>24&255]+Z[255&n]+Z[n>>8&255]+Z[n>>16&255]+Z[n>>24&255]},P.CaseValue=function(e){return P.extend(this,e)},P.CaseValue.prototype.toString=function(){var e="CASE ";return this.expression&&(e+=this.expression.toString()),this.whens&&(e+=this.whens.map((function(e){return" WHEN "+e.when.toString()+" THEN "+e.then.toString()})).join()),e+" END"},P.CaseValue.prototype.findAggregator=function(e){this.expression&&this.expression.findAggregator&&this.expression.findAggregator(e),this.whens&&0<this.whens.length&&this.whens.forEach((function(t){t.when.findAggregator&&t.when.findAggregator(e),t.then.findAggregator&&t.then.findAggregator(e)})),this.elses&&this.elses.findAggregator&&this.elses.findAggregator(e)},P.CaseValue.prototype.toJS=function(e,t,r){var n="((function("+e+",params,alasql){var y,r;";return this.expression?(n+="v="+this.expression.toJS(e,t,r)+";",n+=(this.whens||[]).map((function(n){return" if(v=="+n.when.toJS(e,t,r)+") {r="+n.then.toJS(e,t,r)+"}"})).join(" else ")):n+=(this.whens||[]).map((function(n){return" if("+n.when.toJS(e,t,r)+") {r="+n.then.toJS(e,t,r)+"}"})).join(" else "),this.elses&&(n+=" else {r="+this.elses.toJS(e,t,r)+"}"),n+";return r;}).bind(this))("+e+",params,alasql)"},P.Json=function(e){return P.extend(this,e)},P.Json.prototype.toString=function(){var e="";return(e+=te(this.value))+""};var te=s.utils.JSONtoString=function(e){var t="";if("string"==typeof e)t='"'+e+'"';else if("number"==typeof e)t=e;else if("boolean"==typeof e)t=e;else{if("object"!=typeof e)throw new Error("2Can not show JSON object "+JSON.stringify(e));if(Array.isArray(e))t+="["+e.map((function(e){return te(e)})).join(",")+"]";else if(!e.toJS||e instanceof P.Json){t="{";var r=[];for(var n in e){var a="";if("string"==typeof n)a+='"'+n+'"';else if("number"==typeof n)a+=n;else{if("boolean"!=typeof n)throw new Error("THis is not ES6... no expressions on left side yet");a+=n}a+=":"+te(e[n]),r.push(a)}t+=r.join(",")+"}"}else{if(!e.toString)throw new Error("1Can not show JSON object "+JSON.stringify(e));t=e.toString()}}return t};function re(e,t,r,n){var a="";if("string"==typeof e)a='"'+e+'"';else if("number"==typeof e)a="("+e+")";else if("boolean"==typeof e)a=e;else{if("object"!=typeof e)throw new Error("2Can not parse JSON object "+JSON.stringify(e));if(Array.isArray(e))a+="["+e.map((function(e){return re(e,t,r,n)})).join(",")+"]";else if(!e.toJS||e instanceof P.Json){a="{";var s=[];for(var i in e){var o="";if("string"==typeof i)o+='"'+i+'"';else if("number"==typeof i)o+=i;else{if("boolean"!=typeof i)throw new Error("THis is not ES6... no expressions on left side yet");o+=i}o+=":"+re(e[i],t,r,n),s.push(o)}a+=s.join(",")+"}"}else{if(!e.toJS)throw new Error("1Can not parse JSON object "+JSON.stringify(e));a=e.toJS(t,r,n)}}return a}P.Json.prototype.toJS=function(e,t,r){return re(this.value,e,t,r)},P.Convert=function(e){return P.extend(this,e)},P.Convert.prototype.toString=function(){var e="CONVERT(";return e+=this.dbtypeid,void 0!==this.dbsize&&(e+="("+this.dbsize,this.dbprecision&&(e+=","+this.dbprecision),e+=")"),e+=","+this.expression.toString(),this.style&&(e+=","+this.style),e+")"},P.Convert.prototype.toJS=function(e,t,r){return"alasql.stdfn.CONVERT("+this.expression.toJS(e,t,r)+',{dbtypeid:"'+this.dbtypeid+'",dbsize:'+this.dbsize+",dbprecision:"+this.dbprecision+",style:"+this.style+"})"},s.stdfn.CONVERT=function(e,t){var r,n=e;if(t.style)switch(r=/\d{8}/.test(n)?new Date(+n.substr(0,4),+n.substr(4,2)-1,+n.substr(6,2)):new Date(n),t.style){case 1:n=("0"+(r.getMonth()+1)).substr(-2)+"/"+("0"+r.getDate()).substr(-2)+"/"+("0"+r.getYear()).substr(-2);break;case 2:n=("0"+r.getYear()).substr(-2)+"."+("0"+(r.getMonth()+1)).substr(-2)+"."+("0"+r.getDate()).substr(-2);break;case 3:n=("0"+r.getDate()).substr(-2)+"/"+("0"+(r.getMonth()+1)).substr(-2)+"/"+("0"+r.getYear()).substr(-2);break;case 4:n=("0"+r.getDate()).substr(-2)+"."+("0"+(r.getMonth()+1)).substr(-2)+"."+("0"+r.getYear()).substr(-2);break;case 5:n=("0"+r.getDate()).substr(-2)+"-"+("0"+(r.getMonth()+1)).substr(-2)+"-"+("0"+r.getYear()).substr(-2);break;case 6:n=("0"+r.getDate()).substr(-2)+" "+r.toString().substr(4,3).toLowerCase()+" "+("0"+r.getYear()).substr(-2);break;case 7:n=r.toString().substr(4,3)+" "+("0"+r.getDate()).substr(-2)+","+("0"+r.getYear()).substr(-2);break;case 8:case 108:n=("0"+r.getHours()).substr(-2)+":"+("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2);break;case 10:n=("0"+(r.getMonth()+1)).substr(-2)+"-"+("0"+r.getDate()).substr(-2)+"-"+("0"+r.getYear()).substr(-2);break;case 11:n=("0"+r.getYear()).substr(-2)+"/"+("0"+(r.getMonth()+1)).substr(-2)+"/"+("0"+r.getDate()).substr(-2);break;case 12:n=("0"+r.getYear()).substr(-2)+("0"+(r.getMonth()+1)).substr(-2)+("0"+r.getDate()).substr(-2);break;case 101:n=("0"+(r.getMonth()+1)).substr(-2)+"/"+("0"+r.getDate()).substr(-2)+"/"+r.getFullYear();break;case 102:n=r.getFullYear()+"."+("0"+(r.getMonth()+1)).substr(-2)+"."+("0"+r.getDate()).substr(-2);break;case 103:n=("0"+r.getDate()).substr(-2)+"/"+("0"+(r.getMonth()+1)).substr(-2)+"/"+r.getFullYear();break;case 104:n=("0"+r.getDate()).substr(-2)+"."+("0"+(r.getMonth()+1)).substr(-2)+"."+r.getFullYear();break;case 105:n=("0"+r.getDate()).substr(-2)+"-"+("0"+(r.getMonth()+1)).substr(-2)+"-"+r.getFullYear();break;case 106:n=("0"+r.getDate()).substr(-2)+" "+r.toString().substr(4,3).toLowerCase()+" "+r.getFullYear();break;case 107:n=r.toString().substr(4,3)+" "+("0"+r.getDate()).substr(-2)+","+r.getFullYear();break;case 110:n=("0"+(r.getMonth()+1)).substr(-2)+"-"+("0"+r.getDate()).substr(-2)+"-"+r.getFullYear();break;case 111:n=r.getFullYear()+"/"+("0"+(r.getMonth()+1)).substr(-2)+"/"+("0"+r.getDate()).substr(-2);break;case 112:n=r.getFullYear()+("0"+(r.getMonth()+1)).substr(-2)+("0"+r.getDate()).substr(-2);break;default:throw new Error("The CONVERT style "+t.style+" is not realized yet.")}var a=t.dbtypeid.toUpperCase();if("Date"==t.dbtypeid)return new Date(n);if("DATE"==a)return(s=new Date(n)).getFullYear()+"."+("0"+(s.getMonth()+1)).substr(-2)+"."+("0"+s.getDate()).substr(-2);if("DATETIME"==a||"DATETIME2"==a){var s,i=(s=new Date(n)).getFullYear()+"."+("0"+(s.getMonth()+1)).substr(-2)+"."+("0"+s.getDate()).substr(-2);return(i+=" "+("0"+s.getHours()).substr(-2)+":"+("0"+s.getMinutes()).substr(-2)+":"+("0"+s.getSeconds()).substr(-2))+"."+("00"+s.getMilliseconds()).substr(-3)}if(-1<["MONEY"].indexOf(a))return(0|(o=+n))+100*o%100/100;if(-1<["BOOLEAN"].indexOf(a))return!!n;if(-1<["INT","INTEGER","SMALLINT","BIGINT","SERIAL","SMALLSERIAL","BIGSERIAL"].indexOf(t.dbtypeid.toUpperCase()))return 0|n;if(-1<["STRING","VARCHAR","NVARCHAR","CHARACTER VARIABLE"].indexOf(t.dbtypeid.toUpperCase()))return t.dbsize?(""+n).substr(0,t.dbsize):""+n;if(-1<["CHAR","CHARACTER","NCHAR"].indexOf(a))return(n+new Array(t.dbsize+1).join(" ")).substr(0,t.dbsize);if(-1<["NUMBER","FLOAT","DECIMAL","NUMERIC"].indexOf(a)){var o=+n;return o=void 0!==t.dbsize?parseFloat(o.toPrecision(t.dbsize)):o,void 0!==t.dbprecision?parseFloat(o.toFixed(t.dbprecision)):o}if(-1<["JSON"].indexOf(a)){if("object"==typeof n)return n;try{return JSON.parse(n)}catch(e){throw new Error("Cannot convert string to JSON")}}return n},P.ColumnDef=function(e){return P.extend(this,e)},P.ColumnDef.prototype.toString=function(){var e=this.columnid;return this.dbtypeid&&(e+=" "+this.dbtypeid),this.dbsize&&(e+="("+this.dbsize,this.dbprecision&&(e+=","+this.dbprecision),e+=")"),this.primarykey&&(e+=" PRIMARY KEY"),this.notnull&&(e+=" NOT NULL"),e},P.CreateTable=function(e){return P.extend(this,e)},P.CreateTable.prototype.toString=function(){var e="CREATE";return this.temporary&&(e+=" TEMPORARY"),this.view?e+=" VIEW":e+=" "+(this.class?"CLASS":"TABLE"),this.ifnotexists&&(e+=" IF  NOT EXISTS"),e+=" "+this.table.toString(),this.viewcolumns&&(e+="("+this.viewcolumns.map((function(e){return e.toString()})).join(",")+")"),this.as?e+=" AS "+this.as:e+=" ("+this.columns.map((function(e){return e.toString()})).join(",")+")",this.view&&this.select&&(e+=" AS "+this.select.toString()),e},P.CreateTable.prototype.execute=function(e,t,r){var n=s.databases[this.table.databaseid||e],a=this.table.tableid;if(!a)throw new Error("Table name is not defined");var i=this.columns,o=this.constraints||[];if(this.ifnotexists&&n.tables[a])return r?r(0):0;if(n.tables[a])throw new Error("Can not create table '"+a+"', because it already exists in the database '"+n.databaseid+"'");var u=n.tables[a]=new s.Table;this.class&&(u.isclass=!0);var c,l=[],h=[];if(i&&i.forEach((function(t){var r=t.dbtypeid;s.fn[r]||(r=r.toUpperCase()),-1<["SERIAL","SMALLSERIAL","BIGSERIAL"].indexOf(r)&&(t.identity={value:1,step:1});var n={columnid:t.columnid,dbtypeid:r,dbsize:t.dbsize,dbprecision:t.dbprecision,notnull:t.notnull,identity:t.identity};if(t.identity&&(u.identities[t.columnid]={value:+t.identity.value,step:+t.identity.step}),t.check&&u.checks.push({id:t.check.constrantid,fn:new Function("r","var y;return "+t.check.expression.toJS("r",""))}),t.default&&l.push("'"+t.columnid+"':"+t.default.toJS("r","")),t.primarykey){var a=u.pk={};a.columns=[t.columnid],a.onrightfns="r['"+t.columnid+"']",a.onrightfn=new Function("r","var y;return "+a.onrightfns),a.hh=T(a.onrightfns),u.uniqs[a.hh]={}}if(t.unique){var i={};u.uk=u.uk||[],u.uk.push(i),i.columns=[t.columnid],i.onrightfns="r['"+t.columnid+"']",i.onrightfn=new Function("r","var y;return "+i.onrightfns),i.hh=T(i.onrightfns),u.uniqs[i.hh]={}}if(t.foreignkey){var o=t.foreignkey.table,c=s.databases[o.databaseid||e].tables[o.tableid];if(void 0===o.columnid){if(!(c.pk.columns&&0<c.pk.columns.length))throw new Error("FOREIGN KEY allowed only to tables with PRIMARY KEYs");o.columnid=c.pk.columns[0]}u.checks.push({fn:function(e){var r={};if(void 0===e[t.columnid])return!0;r[o.columnid]=e[t.columnid];var n=c.pk.onrightfn(r);if(!c.uniqs[c.pk.hh][n])throw new Error("Foreign key violation");return!0}})}t.onupdate&&h.push("r['"+t.columnid+"']="+t.onupdate.toJS("r","")),u.columns.push(n),u.xcolumns[n.columnid]=n})),u.defaultfns=l.join(","),u.onupdatefns=h.join(";"),o.forEach((function(t){var r;if("PRIMARY KEY"===t.type){if(u.pk)throw new Error("Primary key already exists");var n=u.pk={};n.columns=t.columns,n.onrightfns=n.columns.map((function(e){return"r['"+e+"']"})).join("+'`'+"),n.onrightfn=new Function("r","var y;return "+n.onrightfns),n.hh=T(n.onrightfns),u.uniqs[n.hh]={}}else if("CHECK"===t.type)r=new Function("r","var y;return "+t.expression.toJS("r",""));else if("UNIQUE"===t.type){var a={};u.uk=u.uk||[],u.uk.push(a),a.columns=t.columns,a.onrightfns=a.columns.map((function(e){return"r['"+e+"']"})).join("+'`'+"),a.onrightfn=new Function("r","var y;return "+a.onrightfns),a.hh=T(a.onrightfns),u.uniqs[a.hh]={}}else if("FOREIGN KEY"===t.type){var i=u.xcolumns[t.columns[0]],o=t.fktable;t.fkcolumns&&0<t.fkcolumns.length&&(o.columnid=t.fkcolumns[0]);var c=s.databases[o.databaseid||e].tables[o.tableid];void 0===o.columnid&&(o.columnid=c.pk.columns[0]),r=function(e){var t={};if(void 0===e[i.columnid])return!0;t[o.columnid]=e[i.columnid];var r=c.pk.onrightfn(t);if(!c.uniqs[c.pk.hh][r])throw new Error("Foreign key violation");return!0}}r&&u.checks.push({fn:r,id:t.constraintid,fk:"FOREIGN KEY"===t.type})})),this.view&&this.viewcolumns){var d=this;this.viewcolumns.forEach((function(e,t){d.select.columns[t].as=e.columnid}))}return this.view&&this.select&&(u.view=!0,u.select=this.select.compile(this.table.databaseid||e)),n.engineid?s.engines[n.engineid].createTable(this.table.databaseid||e,a,this.ifnotexists,r):(u.insert=function(r,n){var a=s.inserted;s.inserted=[r];var i=this,o=!1,u=!1;for(var c in i.beforeinsert)(b=i.beforeinsert[c])&&(b.funcid?!1===s.fn[b.funcid](r)&&(u=u||!0):b.statement&&!1===b.statement.execute(e)&&(u=u||!0));if(!u){var l=!1;for(c in i.insteadofinsert)l=!0,(b=i.insteadofinsert[c])&&(b.funcid?s.fn[b.funcid](r):b.statement&&b.statement.execute(e));if(!l){for(var h in i.identities){var d=i.identities[h];r[h]=d.value}if(i.checks&&0<i.checks.length&&i.checks.forEach((function(e){if(!e.fn(r))throw new Error("Violation of CHECK constraint "+(e.id||""))})),i.columns.forEach((function(e){if(e.notnull&&void 0===r[e.columnid])throw new Error("Wrong NULL value in NOT NULL column "+e.columnid)})),i.pk){var f=(p=i.pk).onrightfn(r);if(void 0!==i.uniqs[p.hh][f]){if(!n)throw new Error("Cannot insert record, because it already exists in primary key index");o=i.uniqs[p.hh][f]}}if(i.uk&&i.uk.length&&i.uk.forEach((function(e){var t=e.onrightfn(r);if(void 0!==i.uniqs[e.hh][t]){if(!n)throw new Error("Cannot insert record, because it already exists in unique index");o=i.uniqs[e.hh][t]}})),o)i.update((function(e){for(var t in r)e[t]=r[t]}),i.data.indexOf(o),t);else{for(var h in i.data.push(r),i.identities)(d=i.identities[h]).value+=d.step;var p;i.pk&&(f=(p=i.pk).onrightfn(r),i.uniqs[p.hh][f]=r),i.uk&&i.uk.length&&i.uk.forEach((function(e){var t=e.onrightfn(r);i.uniqs[e.hh][t]=r}))}for(var c in i.afterinsert){var b;(b=i.afterinsert[c])&&(b.funcid?s.fn[b.funcid](r):b.statement&&b.statement.execute(e))}s.inserted=a}}},u.delete=function(t){var r=this,n=r.data[t],a=!1;for(var i in r.beforedelete)(u=r.beforedelete[i])&&(u.funcid?!1===s.fn[u.funcid](n)&&(a=a||!0):u.statement&&!1===u.statement.execute(e)&&(a=a||!0));if(a)return!1;var o=!1;for(var i in r.insteadofdelete){var u;o=!0,(u=r.insteadofdelete[i])&&(u.funcid?s.fn[u.funcid](n):u.statement&&u.statement.execute(e))}if(!o){if(this.pk){var c=this.pk,l=c.onrightfn(n);if(void 0===this.uniqs[c.hh][l])throw new Error("Something wrong with primary key index on table");this.uniqs[c.hh][l]=void 0}r.uk&&r.uk.length&&r.uk.forEach((function(e){var t=e.onrightfn(n);if(void 0===r.uniqs[e.hh][t])throw new Error("Something wrong with unique index on table");r.uniqs[e.hh][t]=void 0}))}},u.deleteall=function(){this.data.length=0,this.pk&&(this.uniqs[this.pk.hh]={}),u.uk&&u.uk.length&&u.uk.forEach((function(e){u.uniqs[e.hh]={}}))},u.update=function(t,r,n){var a,i=w(this.data[r]);if(this.pk&&((a=this.pk).pkaddr=a.onrightfn(i,n),void 0===this.uniqs[a.hh][a.pkaddr]))throw new Error("Something wrong with index on table");u.uk&&u.uk.length&&u.uk.forEach((function(e){if(e.ukaddr=e.onrightfn(i),void 0===u.uniqs[e.hh][e.ukaddr])throw new Error("Something wrong with unique index on table")})),t(i,n,s);var o=!1;for(var c in u.beforeupdate)(h=u.beforeupdate[c])&&(h.funcid?!1===s.fn[h.funcid](this.data[r],i)&&(o=o||!0):h.statement&&!1===h.statement.execute(e)&&(o=o||!0));if(o)return!1;var l=!1;for(var c in u.insteadofupdate)l=!0,(h=u.insteadofupdate[c])&&(h.funcid?s.fn[h.funcid](this.data[r],i):h.statement&&h.statement.execute(e));if(!l){if(u.checks&&0<u.checks.length&&u.checks.forEach((function(e){if(!e.fn(i))throw new Error("Violation of CHECK constraint "+(e.id||""))})),u.columns.forEach((function(e){if(e.notnull&&void 0===i[e.columnid])throw new Error("Wrong NULL value in NOT NULL column "+e.columnid)})),this.pk&&(a.newpkaddr=a.onrightfn(i),void 0!==this.uniqs[a.hh][a.newpkaddr]&&a.newpkaddr!==a.pkaddr))throw new Error("Record already exists");for(var c in u.uk&&u.uk.length&&u.uk.forEach((function(e){if(e.newukaddr=e.onrightfn(i),void 0!==u.uniqs[e.hh][e.newukaddr]&&e.newukaddr!==e.ukaddr)throw new Error("Record already exists")})),this.pk&&(this.uniqs[a.hh][a.pkaddr]=void 0,this.uniqs[a.hh][a.newpkaddr]=i),u.uk&&u.uk.length&&u.uk.forEach((function(e){u.uniqs[e.hh][e.ukaddr]=void 0,u.uniqs[e.hh][e.newukaddr]=i})),this.data[r]=i,u.afterupdate){var h;(h=u.afterupdate[c])&&(h.funcid?s.fn[h.funcid](this.data[r],i):h.statement&&h.statement.execute(e))}}},s.options.nocount||(c=1),r&&(c=r(c)),c)},s.fn.Date=Object,s.fn.Date=Date,s.fn.Number=Number,s.fn.String=String,s.fn.Boolean=Boolean,z.EXTEND=s.utils.extend,z.CHAR=String.fromCharCode.bind(String),z.ASCII=function(e){return e.charCodeAt(0)},z.COALESCE=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e]&&("number"!=typeof arguments[e]||!isNaN(arguments[e])))return arguments[e]},z.USER=function(){return"alasql"},z.OBJECT_ID=function(e){return!!s.tables[e]},z.DATE=function(e){return/\d{8}/.test(e)?new Date(+e.substr(0,4),+e.substr(4,2)-1,+e.substr(6,2)):new Date(e)},z.NOW=function(){var e=new Date,t=e.getFullYear()+"."+("0"+(e.getMonth()+1)).substr(-2)+"."+("0"+e.getDate()).substr(-2);return(t+=" "+("0"+e.getHours()).substr(-2)+":"+("0"+e.getMinutes()).substr(-2)+":"+("0"+e.getSeconds()).substr(-2))+"."+("00"+e.getMilliseconds()).substr(-3)},z.GETDATE=z.NOW,z.CURRENT_TIMESTAMP=z.NOW,z.SECOND=function(e){return(e=new Date(e)).getSeconds()},z.MINUTE=function(e){return(e=new Date(e)).getMinutes()},z.HOUR=function(e){return(e=new Date(e)).getHours()},z.DAYOFWEEK=z.WEEKDAY=function(e){return(e=new Date(e)).getDay()},z.DAY=z.DAYOFMONTH=function(e){return(e=new Date(e)).getDate()},z.MONTH=function(e){return(e=new Date(e)).getMonth()+1},z.YEAR=function(e){return(e=new Date(e)).getFullYear()};var ne={year:31536e6,quarter:7884e6,month:2592e6,week:6048e5,day:864e5,dayofyear:864e5,weekday:864e5,hour:36e5,minute:6e4,second:1e3,millisecond:1,microsecond:.001};function ae(e){var t="";if(void 0===e)t+="undefined";else if(Array.isArray(e)){t+="<style>",t+="table {border:1px black solid; border-collapse: collapse; border-spacing: 0px;}",t+="td,th {border:1px black solid; padding-left:5px; padding-right:5px}",t+="th {background-color: #EEE}",t+="</style>",t+="<table>";var r=[];for(var n in e[0])r.push(n);t+="<tr><th>#",r.forEach((function(e){t+="<th>"+e}));for(var a=0,s=e.length;a<s;a++)t+="<tr><th>"+(a+1),r.forEach((function(r){t+="<td> ",e[a][r]==+e[a][r]?(t+='<div style="text-align:right">',void 0===e[a][r]?t+="NULL":t+=e[a][r],t+="</div>"):void 0===e[a][r]?t+="NULL":"string"==typeof e[a][r]?t+=e[a][r]:t+=te(e[a][r])}));t+="</table>"}else t+="<p>"+te(e)+"</p>";return t}function se(e,t,r){if(!(r<=0)){var n=(t-e.scrollTop)/r*10;setTimeout((function(){e.scrollTop!==t&&(e.scrollTop=e.scrollTop+n,se(e,t,r-10))}),10)}}function ie(e,t,r,n,a,i){var o={};function u(e){return e&&!1===s.options.casesensitive?e.toLowerCase():e}r=r||{},s.utils.extend(o,r),void 0===o.headers&&(o.headers=!0),t=s.utils.autoExtFilename(t,"xls",r),s.utils.loadBinaryFile(t,!!n,(function(t){if(t instanceof ArrayBuffer)var r=function(e){for(var t="",r=0,n=10240;r<e.byteLength/n;++r)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n,r*n+n)));return t+String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n)))}(t),c=e.read(btoa(r),{type:"base64"});else c=e.read(t,{type:"binary"});var l,h;l=void 0===o.sheetid?c.SheetNames[0]:"number"==typeof o.sheetid?c.SheetNames[o.sheetid]:o.sheetid;var d=[];if(void 0===o.range?h=c.Sheets[l]["!ref"]:(h=o.range,c.Sheets[l][h]&&(h=c.Sheets[l][h])),h){for(var f=h.split(":"),p=f[0].match(/[A-Z]+/)[0],b=+f[0].match(/[0-9]+/)[0],E=f[1].match(/[A-Z]+/)[0],g=+f[1].match(/[0-9]+/)[0],m={},v=s.utils.xlscn(p),S=s.utils.xlscn(E),T=v;T<=S;T++){var A=s.utils.xlsnc(T);o.headers?c.Sheets[l][A+""+b]?m[A]=u(c.Sheets[l][A+""+b].v):m[A]=u(A):m[A]=A}o.headers&&b++;for(var y=b;y<=g;y++){var N={};for(T=v;T<=S;T++)A=s.utils.xlsnc(T),c.Sheets[l][A+""+y]&&(N[m[A]]=c.Sheets[l][A+""+y].v);d.push(N)}}else d.push([]);0<d.length&&d[d.length-1]&&0==Object.keys(d[d.length-1]).length&&d.pop(),n&&(d=n(d,a,i))}),(function(e){throw e}))}s.stdfn.DATEDIFF=function(e,t,r){return(new Date(r).getTime()-new Date(t).getTime())/ne[e.toLowerCase()]},s.stdfn.DATEADD=function(e,t,r){var n=new Date(r).getTime()+t*ne[e.toLowerCase()];return new Date(n)},s.stdfn.INTERVAL=function(e,t){return e*ne[t.toLowerCase()]},s.stdfn.DATE_ADD=s.stdfn.ADDDATE=function(e,t){var r=new Date(e).getTime()+t;return new Date(r)},s.stdfn.DATE_SUB=s.stdfn.SUBDATE=function(e,t){var r=new Date(e).getTime()-t;return new Date(r)},P.DropTable=function(e){return P.extend(this,e)},P.DropTable.prototype.toString=function(){var e="DROP ";return this.view?e+="VIEW":e+="TABLE",this.ifexists&&(e+=" IF EXISTS"),e+" "+this.tables.toString()},P.DropTable.prototype.execute=function(e,t,r){var n=this.ifexists,a=0,i=0,o=this.tables.length;return this.tables.forEach((function(t){var u=s.databases[t.databaseid||e],c=t.tableid;if(!n||n&&u.tables[c]){if(u.tables[c])u.engineid?s.engines[u.engineid].dropTable(t.databaseid||e,c,n,(function(e){delete u.tables[c],a+=e,++i==o&&r&&r(a)})):(delete u.tables[c],a++,++i==o&&r&&r(a));else if(!s.options.dropifnotexists)throw new Error("Can not drop table '"+t.tableid+"', because it does not exist in the database.")}else++i==o&&r&&r(a)})),a},P.TruncateTable=function(e){return P.extend(this,e)},P.TruncateTable.prototype.toString=function(){return"TRUNCATE TABLE "+this.table.toString()},P.TruncateTable.prototype.execute=function(e,t,r){var n=s.databases[this.table.databaseid||e],a=this.table.tableid;if(n.engineid)return s.engines[n.engineid].truncateTable(this.table.databaseid||e,a,this.ifexists,r);if(!n.tables[a])throw new Error("Cannot truncate table becaues it does not exist");return n.tables[a].data=[],r?r(0):0},P.CreateVertex=function(e){return P.extend(this,e)},P.CreateVertex.prototype.toString=function(){var e="CREATE VERTEX ";return this.class&&(e+=this.class+" "),this.sharp&&(e+="#"+this.sharp+" "),this.sets?e+=this.sets.toString():this.content?e+=this.content.toString():this.select&&(e+=this.select.toString()),e},P.CreateVertex.prototype.toJS=function(e){return"this.queriesfn["+(this.queriesidx-1)+"](this.params,null,"+e+")"},P.CreateVertex.prototype.compile=function(e){var t=e,r=this.sharp;if(void 0!==this.name)var n="x.name="+this.name.toJS(),a=new Function("x",n);if(this.sets&&0<this.sets.length){n=this.sets.map((function(e){return"x['"+e.column.columnid+"']="+e.expression.toJS("x","")})).join(";");var i=new Function("x,params,alasql",n)}return function(e,n){var o,u=s.databases[t],c={$id:void 0!==r?r:u.counter++,$node:"VERTEX"};return o=u.objects[c.$id]=c,a&&a(c),i&&i(c,e,s),n&&(o=n(o)),o}},P.CreateEdge=function(e){return P.extend(this,e)},P.CreateEdge.prototype.toString=function(){var e="CREATE EDGE ";return this.class&&(e+=this.class+" "),e},P.CreateEdge.prototype.toJS=function(e){return"this.queriesfn["+(this.queriesidx-1)+"](this.params,null,"+e+")"},P.CreateEdge.prototype.compile=function(e){var t=e,r=new Function("params,alasql","var y;return "+this.from.toJS()),n=new Function("params,alasql","var y;return "+this.to.toJS());if(void 0!==this.name)var a="x.name="+this.name.toJS(),i=new Function("x",a);if(this.sets&&0<this.sets.length){a=this.sets.map((function(e){return"x['"+e.column.columnid+"']="+e.expression.toJS("x","")})).join(";");var o=new Function("x,params,alasql","var y;"+a)}return function(e,a){var u=0,c=s.databases[t],l={$id:c.counter++,$node:"EDGE"},h=r(e,s),d=n(e,s);return l.$in=[h.$id],l.$out=[d.$id],void 0===h.$out&&(h.$out=[]),h.$out.push(l.$id),d.$in,d.$in.push(l.$id),u=c.objects[l.$id]=l,i&&i(l),o&&o(l,e,s),a&&(u=a(u)),u}},P.CreateGraph=function(e){return P.extend(this,e)},P.CreateGraph.prototype.toString=function(){var e="CREATE GRAPH ";return this.class&&(e+=this.class+" "),e},P.CreateGraph.prototype.execute=function(e,t,r){var n=[];return this.from&&s.from[this.from.funcid]&&(this.graph=s.from[this.from.funcid.toUpperCase()]),this.graph.forEach((function(r){if(r.source){var o={};void 0!==r.as&&(s.vars[r.as]=o),void 0!==r.prop&&(o.name=r.prop),void 0!==r.sharp&&(o.$id=r.sharp),void 0!==r.name&&(o.name=r.name),void 0!==r.class&&(o.$class=r.class);var u,c,l=s.databases[e];if(void 0===o.$id&&(o.$id=l.counter++),o.$node="EDGE",void 0!==r.json&&D(o,new Function("params,alasql","var y;return "+r.json.toJS())(t,s)),r.source.vars)u="object"==typeof(d=s.vars[r.source.vars])?d:l.objects[d];else{var h=r.source.sharp;void 0===h&&(h=r.source.prop),void 0!==(u=s.databases[e].objects[h])||!s.options.autovertex||void 0===r.source.prop&&void 0===r.source.name||void 0===(u=a(r.source.prop||r.source.name))&&(u=i(r.source))}if(r.source.vars){var d;c="object"==typeof(d=s.vars[r.target.vars])?d:l.objects[d]}else{var f=r.target.sharp;void 0===f&&(f=r.target.prop),void 0!==(c=s.databases[e].objects[f])||!s.options.autovertex||void 0===r.target.prop&&void 0===r.target.name||void 0===(c=a(r.target.prop||r.target.name))&&(c=i(r.target))}if(o.$in=[u.$id],o.$out=[c.$id],void 0===u.$out&&(u.$out=[]),u.$out.push(o.$id),void 0===c.$in&&(c.$in=[]),c.$in.push(o.$id),void 0!==(l.objects[o.$id]=o).$class){if(void 0===s.databases[e].tables[o.$class])throw new Error("No such class. Pleace use CREATE CLASS");s.databases[e].tables[o.$class].data.push(o)}n.push(o.$id)}else i(r)})),r&&(n=r(n)),n;function a(e){var t=s.databases[s.useid].objects;for(var r in t)if(t[r].name===e)return t[r]}function i(r){var a={};void 0!==r.as&&(s.vars[r.as]=a),void 0!==r.prop&&(a.$id=r.prop,a.name=r.prop),void 0!==r.sharp&&(a.$id=r.sharp),void 0!==r.name&&(a.name=r.name),void 0!==r.class&&(a.$class=r.class);var i=s.databases[e];if(void 0===a.$id&&(a.$id=i.counter++),a.$node="VERTEX",void 0!==r.json&&D(a,new Function("params,alasql","var y;return "+r.json.toJS())(t,s)),void 0!==(i.objects[a.$id]=a).$class){if(void 0===s.databases[e].tables[a.$class])throw new Error("No such class. Pleace use CREATE CLASS");s.databases[e].tables[a.$class].data.push(a)}return n.push(a.$id),a}},P.CreateGraph.prototype.compile1=function(e){var t=e,r=new Function("params,alasql","var y;return "+this.from.toJS()),n=new Function("params,alasql","var y;return "+this.to.toJS());if(void 0!==this.name)var a="x.name="+this.name.toJS(),i=new Function("x",a);if(this.sets&&0<this.sets.length){a=this.sets.map((function(e){return"x['"+e.column.columnid+"']="+e.expression.toJS("x","")})).join(";");var o=new Function("x,params,alasql","var y;"+a)}return function(e,a){var u=0,c=s.databases[t],l={$id:c.counter++,$node:"EDGE"},h=r(e,s),d=n(e,s);return l.$in=[h.$id],l.$out=[d.$id],void 0===h.$out&&(h.$out=[]),h.$out.push(l.$id),void 0===d.$in&&(d.$in=[]),d.$in.push(l.$id),u=c.objects[l.$id]=l,i&&i(l),o&&o(l,e,s),a&&(u=a(u)),u}},P.AlterTable=function(e){return P.extend(this,e)},P.AlterTable.prototype.toString=function(){var e="ALTER TABLE "+this.table.toString();return this.renameto&&(e+=" RENAME TO "+this.renameto),e},P.AlterTable.prototype.execute=function(e,t,r){if((p=s.databases[e]).dbversion=Date.now(),this.renameto){var n=this.table.tableid,a=this.renameto;if(p.tables[a])throw new Error("Can not rename a table '"+n+"' to '"+a+"', because the table with this name already exists");if(a===n)throw new Error("Can not rename a table '"+n+"' to itself");return p.tables[a]=p.tables[n],delete p.tables[n],r&&r(1),1}if(this.addcolumn){(p=s.databases[this.table.databaseid||e]).dbversion++;var i=this.table.tableid,o=p.tables[i],u=this.addcolumn.columnid;if(o.xcolumns[u])throw new Error('Cannot add column "'+u+'", because it already exists in the table "'+i+'"');var c={columnid:u,dbtypeid:this.dbtypeid,dbsize:this.dbsize,dbprecision:this.dbprecision,dbenum:this.dbenum,defaultfns:null};o.columns.push(c),o.xcolumns[u]=c;for(var l=0,h=o.data.length;l<h;l++)o.data[l][u]=void 0;return r?r(1):1}if(this.modifycolumn){if((p=s.databases[this.table.databaseid||e]).dbversion++,i=this.table.tableid,o=p.tables[i],u=this.modifycolumn.columnid,!o.xcolumns[u])throw new Error('Cannot modify column "'+u+'", because it was not found in the table "'+i+'"');return(c=o.xcolumns[u]).dbtypeid=this.dbtypeid,c.dbsize=this.dbsize,c.dbprecision=this.dbprecision,c.dbenum=this.dbenum,r?r(1):1}if(this.renamecolumn){(p=s.databases[this.table.databaseid||e]).dbversion++,i=this.table.tableid,o=p.tables[i],u=this.renamecolumn;var d=this.to;if(!o.xcolumns[u])throw new Error('Column "'+u+'" is not found in the table "'+i+'"');if(o.xcolumns[d])throw new Error('Column "'+d+'" already exists in the table "'+i+'"');if(u==d)return r?r(0):0;for(var f=0;f<o.columns.length;f++)o.columns[f].columnid==u&&(o.columns[f].columnid=d);for(o.xcolumns[d]=o.xcolumns[u],delete o.xcolumns[u],l=0,h=o.data.length;l<h;l++)o.data[l][d]=o.data[l][u],delete o.data[l][u];return o.data.length}if(this.dropcolumn){var p;(p=s.databases[this.table.databaseid||e]).dbversion++,i=this.table.tableid,o=p.tables[i],u=this.dropcolumn;var b=!1;for(f=0;f<o.columns.length;f++)if(o.columns[f].columnid==u){b=!0,o.columns.splice(f,1);break}if(!b)throw new Error('Cannot drop column "'+u+'", because it was not found in the table "'+i+'"');for(delete o.xcolumns[u],l=0,h=o.data.length;l<h;l++)delete o.data[l][u];return r?r(o.data.length):o.data.length}throw Error("Unknown ALTER TABLE method")},P.CreateIndex=function(e){return P.extend(this,e)},P.CreateIndex.prototype.toString=function(){var e="CREATE";return this.unique&&(e+=" UNIQUE"),(e+=" INDEX "+this.indexid+" ON "+this.table.toString())+"("+this.columns.toString()+")"},P.CreateIndex.prototype.execute=function(e,t,r){var n=s.databases[e],a=this.table.tableid,i=n.tables[a],o=this.indexid;n.indices[o]=a;var u=this.columns.map((function(e){return e.expression.toJS("r","")})).join("+'`'+"),c=new Function("r,params,alasql","return "+u);if(this.unique){i.uniqdefs[o]={rightfns:u};var l=i.uniqs[o]={};if(0<i.data.length)for(var h=0,d=i.data.length;h<d;h++)l[b=u(i.data[h])]||(l[b]={num:0}),l[b].num++}else{var f=T(u);i.inddefs[o]={rightfns:u,hh:f},i.indices[f]={};var p=i.indices[f]={};if(0<i.data.length)for(h=0,d=i.data.length;h<d;h++){var b;p[b=c(i.data[h],t,s)]||(p[b]=[]),p[b].push(i.data[h])}}var E=1;return r&&(E=r(E)),E},P.Reindex=function(e){return P.extend(this,e)},P.Reindex.prototype.toString=function(){return"REINDEX "+this.indexid},P.Reindex.prototype.execute=function(e,t,r){var n=s.databases[e],a=this.indexid,i=n.indices[a];n.tables[i].indexColumns();var o=1;return r&&(o=r(o)),o},P.DropIndex=function(e){return P.extend(this,e)},P.DropIndex.prototype.toString=function(){return"DROP INDEX"+this.indexid},P.DropIndex.prototype.compile=function(e){return this.indexid,function(){return 1}},P.WithSelect=function(e){return P.extend(this,e)},P.WithSelect.prototype.toString=function(){var e="WITH ";return(e+=this.withs.map((function(e){return e.name+" AS ("+e.select.toString()+")"})).join(",")+" ")+this.select.toString()},P.WithSelect.prototype.execute=function(e,t,r){var n=this,a=[];return n.withs.forEach((function(r){a.push(s.databases[e].tables[r.name]),(s.databases[e].tables[r.name]=new _({tableid:r.name})).data=r.select.execute(e,t)})),this.select.execute(e,t,(function(t){return n.withs.forEach((function(t,r){a[r]?s.databases[e].tables[t.name]=a[r]:delete s.databases[e].tables[t.name]})),r&&(t=r(t)),t}))},P.If=function(e){return P.extend(this,e)},P.If.prototype.toString=function(){var e="IF ";return e+=this.expression.toString(),e+=" "+this.thenstat.toString(),this.elsestat&&(e+=" ELSE "+this.thenstat.toString()),e},P.If.prototype.execute=function(e,t,r){var n;return new Function("params,alasql,p","var y;return "+this.expression.toJS("({})","",null)).bind(this)(t,s)?n=this.thenstat.execute(e,t,r):this.elsestat?n=this.elsestat.execute(e,t,r):r&&(n=r(n)),n},P.While=function(e){return P.extend(this,e)},P.While.prototype.toString=function(){var e="WHILE ";return(e+=this.expression.toString())+" "+this.loopstat.toString()},P.While.prototype.execute=function(e,t,r){var n=this,a=[],i=new Function("params,alasql,p","var y;return "+this.expression.toJS());if(r){var o=!1,u=function(c){o?a.push(c):o=!0,setTimeout((function(){i(t,s)?n.loopstat.execute(e,t,u):a=r(a)}),0)};u()}else for(;i(t,s);){var c=n.loopstat.execute(e,t);a.push(c)}return a},P.Break=function(e){return P.extend(this,e)},P.Break.prototype.toString=function(){return"BREAK"},P.Break.prototype.execute=function(e,t,r,n){var a=1;return r&&(a=r(a)),a},P.Continue=function(e){return P.extend(this,e)},P.Continue.prototype.toString=function(){return"CONTINUE"},P.Continue.prototype.execute=function(e,t,r,n){var a=1;return r&&(a=r(a)),a},P.BeginEnd=function(e){return P.extend(this,e)},P.BeginEnd.prototype.toString=function(){return"BEGIN "+this.statements.toString()+" END"},P.BeginEnd.prototype.execute=function(e,t,r,n){var a=this,s=[],i=0;return function n(){a.statements[i].execute(e,t,(function(e){if(s.push(e),++i<a.statements.length)return n();r&&(s=r(s))}))}(),s},P.Insert=function(e){return P.extend(this,e)},P.Insert.prototype.toString=function(){var e="INSERT ";return this.orreplace&&(e+="OR REPLACE "),this.replaceonly&&(e="REPLACE "),e+="INTO "+this.into.toString(),this.columns&&(e+="("+this.columns.toString()+")"),this.values&&(e+=" VALUES "+this.values.toString()),this.select&&(e+=" "+this.select.toString()),e},P.Insert.prototype.toJS=function(e,t,r){return"this.queriesfn["+(this.queriesidx-1)+"](this.params,null,"+e+")"},P.Insert.prototype.compile=function(e){var t=this;e=t.into.databaseid||e;var r=s.databases[e],n=t.into.tableid,a=r.tables[n];if(!a)throw"Table '"+n+"' could not be found";var i,o="",u="",c=(o="db.tables['"+n+"'].dirty=true;","var a,aa=[],x;");if(this.values){this.exists&&(this.existsfn=this.exists.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r}))),this.queries&&(this.queriesfn=this.queries.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r}))),t.values.forEach((function(i){var c=[];t.columns?t.columns.forEach((function(e,t){var r="'"+e.columnid+"':";a.xcolumns&&a.xcolumns[e.columnid]?0<=["INT","FLOAT","NUMBER","MONEY"].indexOf(a.xcolumns[e.columnid].dbtypeid)?r+="(x="+i[t].toJS()+",x==undefined?undefined:+x)":s.fn[a.xcolumns[e.columnid].dbtypeid]?(r+="(new "+a.xcolumns[e.columnid].dbtypeid+"(",r+=i[t].toJS(),r+="))"):r+=i[t].toJS():r+=i[t].toJS(),c.push(r)})):Array.isArray(i)&&a.columns&&0<a.columns.length?a.columns.forEach((function(e,t){var r="'"+e.columnid+"':";0<=["INT","FLOAT","NUMBER","MONEY"].indexOf(e.dbtypeid)?r+="+"+i[t].toJS():s.fn[e.dbtypeid]?(r+="(new "+e.dbtypeid+"(",r+=i[t].toJS(),r+="))"):r+=i[t].toJS(),c.push(r)})):u=re(i),r.tables[n].defaultfns&&c.unshift(r.tables[n].defaultfns),o+=u?"a="+u+";":"a={"+c.join(",")+"};",r.tables[n].isclass&&(o+="var db=alasql.databases['"+e+"'];",o+='a.$class="'+n+'";',o+="a.$id=db.counter++;",o+="db.objects[a.$id]=a;"),r.tables[n].insert?(o+="var db=alasql.databases['"+e+"'];",o+="db.tables['"+n+"'].insert(a,"+(t.orreplace?"true":"false")+");"):o+="aa.push(a);"})),i=c+o,r.tables[n].insert||(o+="alasql.databases['"+e+"'].tables['"+n+"'].data=alasql.databases['"+e+"'].tables['"+n+"'].data.concat(aa);"),r.tables[n].insert&&r.tables[n].isclass?o+="return a.$id;":o+="return "+t.values.length;var l=new Function("db, params, alasql","var y;"+c+o).bind(this)}else if(this.select){this.select.modifier="RECORDSET";var h=this.select.compile(e);if(r.engineid&&s.engines[r.engineid].intoTable)return function(e,t){var a=h(e);return s.engines[r.engineid].intoTable(r.databaseid,n,a.data,null,t)};var d="return alasql.utils.extend(r,{"+a.defaultfns+"})",f=new Function("r,db,params,alasql",d);l=function(e,r,a){var s=h(r).data;if(e.tables[n].insert)for(var i=0,o=s.length;i<o;i++){var u=w(s[i]);f(u,e,r,a),e.tables[n].insert(u,t.orreplace)}else e.tables[n].data=e.tables[n].data.concat(s);return a.options.nocount?void 0:s.length}}else{if(!this.default)throw new Error("Wrong INSERT parameters");var p="db.tables['"+n+"'].data.push({"+a.defaultfns+"});return 1;";l=new Function("db,params,alasql",p)}if(r.engineid&&s.engines[r.engineid].intoTable&&s.options.autocommit)var b=function(e,t){var a=new Function("db,params","var y;"+i+"return aa;")(r,e);return s.engines[r.engineid].intoTable(r.databaseid,n,a,null,t)};else b=function(t,r){var a=s.databases[e];s.options.autocommit&&a.engineid&&s.engines[a.engineid].loadTableData(e,n);var i=l(a,t,s);return s.options.autocommit&&a.engineid&&s.engines[a.engineid].saveTableData(e,n),s.options.nocount&&(i=void 0),r&&r(i),i};return b},P.Insert.prototype.execute=function(e,t,r){return this.compile(e)(t,r)},P.CreateTrigger=function(e){return P.extend(this,e)},P.CreateTrigger.prototype.toString=function(){var e="CREATE TRIGGER "+this.trigger+" ";return this.when&&(e+=this.when+" "),e+=this.action+" ON ",this.table.databaseid&&(e+=this.table.databaseid+"."),(e+=this.table.tableid+" ")+this.statement.toString()},P.CreateTrigger.prototype.execute=function(e,t,r){var n=1,a=this.trigger;e=this.table.databaseid||e;var i=s.databases[e],o=this.table.tableid,u={action:this.action,when:this.when,statement:this.statement,funcid:this.funcid,tableid:this.table.tableid};return"INSERT"==(i.triggers[a]=u).action&&"BEFORE"==u.when?i.tables[o].beforeinsert[a]=u:"INSERT"==u.action&&"AFTER"==u.when?i.tables[o].afterinsert[a]=u:"INSERT"==u.action&&"INSTEADOF"==u.when?i.tables[o].insteadofinsert[a]=u:"DELETE"==u.action&&"BEFORE"==u.when?i.tables[o].beforedelete[a]=u:"DELETE"==u.action&&"AFTER"==u.when?i.tables[o].afterdelete[a]=u:"DELETE"==u.action&&"INSTEADOF"==u.when?i.tables[o].insteadofdelete[a]=u:"UPDATE"==u.action&&"BEFORE"==u.when?i.tables[o].beforeupdate[a]=u:"UPDATE"==u.action&&"AFTER"==u.when?i.tables[o].afterupdate[a]=u:"UPDATE"==u.action&&"INSTEADOF"==u.when&&(i.tables[o].insteadofupdate[a]=u),r&&(n=r(n)),n},P.DropTrigger=function(e){return P.extend(this,e)},P.DropTrigger.prototype.toString=function(){return"DROP TRIGGER "+this.trigger},P.DropTrigger.prototype.execute=function(e,t,r){var n=0,a=s.databases[e],i=this.trigger;if(!a.triggers[i])throw new Error("Trigger not found");var o=a.triggers[i].tableid;if(!o)throw new Error("Trigger Table not found");return n=1,delete a.tables[o].beforeinsert[i],delete a.tables[o].afterinsert[i],delete a.tables[o].insteadofinsert[i],delete a.tables[o].beforedelete[i],delete a.tables[o].afterdelete[i],delete a.tables[o].insteadofdelete[i],delete a.tables[o].beforeupdate[i],delete a.tables[o].afterupdate[i],delete a.tables[o].insteadofupdate[i],delete a.triggers[i],r&&(n=r(n)),n},P.Delete=function(e){return P.extend(this,e)},P.Delete.prototype.toString=function(){var e="DELETE FROM "+this.table.toString();return this.where&&(e+=" WHERE "+this.where.toString()),e},P.Delete.prototype.compile=function(e){e=this.table.databaseid||e;var t,r=this.table.tableid,n=s.databases[e];if(this.where){this.exists&&(this.existsfn=this.exists.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r}))),this.queries&&(this.queriesfn=this.queries.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r})));var a=new Function("r,params,alasql","var y;return ("+this.where.toJS("r","")+")").bind(this);t=function(t,i){if(n.engineid&&s.engines[n.engineid].deleteFromTable)return s.engines[n.engineid].deleteFromTable(e,r,a,t,i);s.options.autocommit&&n.engineid&&("LOCALSTORAGE"==n.engineid||"FILESTORAGE"==n.engineid)&&s.engines[n.engineid].loadTableData(e,r);for(var o=n.tables[r],u=o.data.length,c=[],l=0,h=o.data.length;l<h;l++)a(o.data[l],t,s)?o.delete&&o.delete(l,t,s):c.push(o.data[l]);for(var d in o.data=c,o.afterdelete){var f=o.afterdelete[d];f&&(f.funcid?s.fn[f.funcid]():f.statement&&f.statement.execute(e))}var p=u-o.data.length;return s.options.autocommit&&n.engineid&&("LOCALSTORAGE"==n.engineid||"FILESTORAGE"==n.engineid)&&s.engines[n.engineid].saveTableData(e,r),i&&i(p),p}}else t=function(t,a){s.options.autocommit&&n.engineid&&s.engines[n.engineid].loadTableData(e,r),n.tables[r].dirty=!0;var i=n.tables[r].data.length;for(var o in n.tables[r].data.length=0,n.tables[r].uniqs)n.tables[r].uniqs[o]={};for(var o in n.tables[r].indices)n.tables[r].indices[o]={};return s.options.autocommit&&n.engineid&&s.engines[n.engineid].saveTableData(e,r),a&&a(i),i};return t},P.Delete.prototype.execute=function(e,t,r){return this.compile(e)(t,r)},P.Update=function(e){return P.extend(this,e)},P.Update.prototype.toString=function(){var e="UPDATE "+this.table.toString();return this.columns&&(e+=" SET "+this.columns.toString()),this.where&&(e+=" WHERE "+this.where.toString()),e},P.SetColumn=function(e){return P.extend(this,e)},P.SetColumn.prototype.toString=function(){return this.column.toString()+"="+this.expression.toString()},P.Update.prototype.compile=function(e){e=this.table.databaseid||e;var t=this.table.tableid;if(this.where){this.exists&&(this.existsfn=this.exists.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r}))),this.queries&&(this.queriesfn=this.queries.map((function(t){var r=t.compile(e);return r.query.modifier="RECORDSET",r})));var r=new Function("r,params,alasql","var y;return "+this.where.toJS("r","")).bind(this)}var n=s.databases[e].tables[t].onupdatefns||"";n+=";",this.columns.forEach((function(e){n+="r['"+e.column.columnid+"']="+e.expression.toJS("r","")+";"}));var a=new Function("r,params,alasql","var y;"+n);return function(n,i){var o=s.databases[e];if(o.engineid&&s.engines[o.engineid].updateTable)return s.engines[o.engineid].updateTable(e,t,a,r,n,i);s.options.autocommit&&o.engineid&&s.engines[o.engineid].loadTableData(e,t);var u=o.tables[t];if(!u)throw new Error("Table '"+t+"' not exists");for(var c=0,l=0,h=u.data.length;l<h;l++)r&&!r(u.data[l],n,s)||(u.update?u.update(a,l,n):a(u.data[l],n,s),c++);return s.options.autocommit&&o.engineid&&s.engines[o.engineid].saveTableData(e,t),i&&i(c),c}},P.Update.prototype.execute=function(e,t,r){return this.compile(e)(t,r)},P.Merge=function(e){return P.extend(this,e)},P.Merge.prototype.toString=function(){var e="MERGE ";return e+=this.into.tableid+" ",this.into.as&&(e+="AS "+this.into.as+" "),e+="USING "+this.using.tableid+" ",this.using.as&&(e+="AS "+this.using.as+" "),e+="ON "+this.on.toString()+" ",this.matches.forEach((function(t){e+="WHEN ",t.matched||(e+="NOT "),e+="MATCHED ",t.bytarget&&(e+="BY TARGET "),t.bysource&&(e+="BY SOURCE "),t.expr&&(e+="AND "+t.expr.toString()+" "),e+="THEN ",t.action.delete&&(e+="DELETE "),t.action.insert&&(e+="INSERT ",t.action.columns&&(e+="("+t.action.columns.toString()+") "),t.action.values&&(e+="VALUES ("+t.action.values.toString()+") "),t.action.defaultvalues&&(e+="DEFAULT VALUES ")),t.action.update&&(e+="UPDATE ",e+=t.action.update.map((function(e){return e.toString()})).join(",")+" ")})),e},P.Merge.prototype.execute=function(e,t,r){var n=1;return r&&(n=r(n)),n},P.CreateDatabase=function(e){return P.extend(this,e)},P.CreateDatabase.prototype.toString=function(){var e="CREATE";return this.engineid&&(e+=" "+this.engineid),e+=" DATABASE",this.ifnotexists&&(e+=" IF NOT EXISTS"),e+=" "+this.databaseid,this.args&&0<this.args.length&&(e+="("+this.args.map((function(e){return e.toString()})).join(", ")+")"),this.as&&(e+=" AS "+this.as),e},P.CreateDatabase.prototype.execute=function(e,t,r){if(this.args&&0<this.args.length&&this.args.map((function(e){return new Function("params,alasql","var y;return "+e.toJS())(t,s)})),this.engineid)return s.engines[this.engineid].createDatabase(this.databaseid,this.args,this.ifnotexists,this.as,r);var n=this.databaseid;if(s.databases[n])throw new Error("Database '"+n+"' already exists");new s.Database(n);var a=1;return r?r(a):a},P.AttachDatabase=function(e){return P.extend(this,e)},P.AttachDatabase.prototype.toString=function(e){var t="ATTACH";return this.engineid&&(t+=" "+this.engineid),t+=" DATABASE "+this.databaseid,e&&(t+="(",0<e.length&&(t+=e.map((function(e){return e.toString()})).join(", ")),t+=")"),this.as&&(t+=" AS "+this.as),t},P.AttachDatabase.prototype.execute=function(e,t,r){if(!s.engines[this.engineid])throw new Error('Engine "'+this.engineid+'" is not defined.');return s.engines[this.engineid].attachDatabase(this.databaseid,this.as,this.args,t,r)},P.DetachDatabase=function(e){return P.extend(this,e)},P.DetachDatabase.prototype.toString=function(){return"DETACH DATABASE "+this.databaseid},P.DetachDatabase.prototype.execute=function(e,t,r){if(!s.databases[this.databaseid].engineid)throw new Error('Cannot detach database "'+this.engineid+'", because it was not attached.');var n,a=this.databaseid;if(a===s.DEFAULTDATABASEID)throw new Error("Drop of default database is prohibited");if(s.databases[a])delete s.databases[a],a===s.useid&&s.use(),n=1;else{if(!this.ifexists)throw new Error("Database '"+a+"' does not exist");n=0}return r&&r(n),n},P.UseDatabase=function(e){return P.extend(this,e)},P.UseDatabase.prototype.toString=function(){return"USE DATABASE "+this.databaseid},P.UseDatabase.prototype.execute=function(e,t,r){var n=this.databaseid;if(!s.databases[n])throw new Error("Database '"+n+"' does not exist");return s.use(n),r&&r(1),1},P.DropDatabase=function(e){return P.extend(this,e)},P.DropDatabase.prototype.toString=function(){var e="DROP";return this.ifexists&&(e+=" IF EXISTS"),e+" DATABASE "+this.databaseid},P.DropDatabase.prototype.execute=function(e,t,r){if(this.engineid)return s.engines[this.engineid].dropDatabase(this.databaseid,this.ifexists,r);var n,a=this.databaseid;if(a===s.DEFAULTDATABASEID)throw new Error("Drop of default database is prohibited");if(s.databases[a]){if(s.databases[a].engineid)throw new Error("Cannot drop database '"+a+"', because it is attached. Detach it.");delete s.databases[a],a===s.useid&&s.use(),n=1}else{if(!this.ifexists)throw new Error("Database '"+a+"' does not exist");n=0}return r&&r(n),n},P.Declare=function(e){return P.extend(this,e)},P.Declare.prototype.toString=function(){var e="DECLARE ";return this.declares&&0<this.declares.length&&(e=this.declares.map((function(e){var t="";return t+="@"+e.variable+" ",t+=e.dbtypeid,this.dbsize&&(t+="("+this.dbsize,this.dbprecision&&(t+=","+this.dbprecision),t+=")"),e.expression&&(t+=" = "+e.expression.toString()),t})).join(",")),e},P.Declare.prototype.execute=function(e,t,r){var n=1;return this.declares&&0<this.declares.length&&this.declares.map((function(e){var r=e.dbtypeid;s.fn[r]||(r=r.toUpperCase()),s.declares[e.variable]={dbtypeid:r,dbsize:e.dbsize,dbprecision:e.dbprecision},e.expression&&(s.vars[e.variable]=new Function("params,alasql","return "+e.expression.toJS("({})","",null))(t,s),s.declares[e.variable]&&(s.vars[e.variable]=s.stdfn.CONVERT(s.vars[e.variable],s.declares[e.variable])))})),r&&(n=r(n)),n},P.ShowDatabases=function(e){return P.extend(this,e)},P.ShowDatabases.prototype.toString=function(){var e="SHOW DATABASES";return this.like&&(e+="LIKE "+this.like.toString()),e},P.ShowDatabases.prototype.execute=function(e,t,r){if(this.engineid)return s.engines[this.engineid].showDatabases(this.like,r);var n=this,a=[];for(var i in s.databases)a.push({databaseid:i});return n.like&&a&&0<a.length&&(a=a.filter((function(e){return s.utils.like(n.like.value,e.databaseid)}))),r&&r(a),a},P.ShowTables=function(e){return P.extend(this,e)},P.ShowTables.prototype.toString=function(){var e="SHOW TABLES";return this.databaseid&&(e+=" FROM "+this.databaseid),this.like&&(e+=" LIKE "+this.like.toString()),e},P.ShowTables.prototype.execute=function(e,t,r){var n=s.databases[this.databaseid||e],a=this,i=[];for(var o in n.tables)i.push({tableid:o});return a.like&&i&&0<i.length&&(i=i.filter((function(e){return s.utils.like(a.like.value,e.tableid)}))),r&&r(i),i},P.ShowColumns=function(e){return P.extend(this,e)},P.ShowColumns.prototype.toString=function(){var e="SHOW COLUMNS";return this.table.tableid&&(e+=" FROM "+this.table.tableid),this.databaseid&&(e+=" FROM "+this.databaseid),e},P.ShowColumns.prototype.execute=function(e,t,r){var n=s.databases[this.databaseid||e].tables[this.table.tableid];if(n&&n.columns){var a=n.columns.map((function(e){return{columnid:e.columnid,dbtypeid:e.dbtypeid,dbsize:e.dbsize}}));return r&&r(a),a}return r&&r([]),[]},P.ShowIndex=function(e){return P.extend(this,e)},P.ShowIndex.prototype.toString=function(){var e="SHOW INDEX";return this.table.tableid&&(e+=" FROM "+this.table.tableid),this.databaseid&&(e+=" FROM "+this.databaseid),e},P.ShowIndex.prototype.execute=function(e,t,r){var n=s.databases[this.databaseid||e].tables[this.table.tableid],a=[];if(n&&n.indices)for(var i in n.indices)a.push({hh:i,len:Object.keys(n.indices[i]).length});return r&&r(a),a},P.ShowCreateTable=function(e){return P.extend(this,e)},P.ShowCreateTable.prototype.toString=function(){var e="SHOW CREATE TABLE "+this.table.tableid;return this.databaseid&&(e+=" FROM "+this.databaseid),e},P.ShowCreateTable.prototype.execute=function(e){var t=s.databases[this.databaseid||e].tables[this.table.tableid];if(t){var r="CREATE TABLE "+this.table.tableid+" (",n=[];return t.columns&&(t.columns.forEach((function(e){var t=e.columnid+" "+e.dbtypeid;e.dbsize&&(t+="("+e.dbsize+")"),e.primarykey&&(t+=" PRIMARY KEY"),n.push(t)})),r+=n.join(", ")),r+")"}throw new Error('There is no such table "'+this.table.tableid+'"')},P.SetVariable=function(e){return P.extend(this,e)},P.SetVariable.prototype.toString=function(){var e="SET ";return void 0!==this.value&&(e+=this.variable.toUpperCase()+" "+(this.value?"ON":"OFF")),this.expression&&(e+=this.method+this.variable+" = "+this.expression.toString()),e},P.SetVariable.prototype.execute=function(e,t,r){if(void 0!==this.value){var n=this.value;"ON"==n?n=!0:"OFF"==n&&(n=!1),s.options[this.variable]=n}else if(this.expression){this.exists&&(this.existsfn=this.exists.map((function(t){var r=t.compile(e);return r.query&&!r.query.modifier&&(r.query.modifier="RECORDSET"),r}))),this.queries&&(this.queriesfn=this.queries.map((function(t){var r=t.compile(e);return r.query&&!r.query.modifier&&(r.query.modifier="RECORDSET"),r})));var a=new Function("params,alasql","return "+this.expression.toJS("({})","",null)).bind(this)(t,s);if(s.declares[this.variable]&&(a=s.stdfn.CONVERT(a,s.declares[this.variable])),this.props&&0<this.props.length){if("@"==this.method)var i="alasql.vars['"+this.variable+"']";else i="params['"+this.variable+"']";i+=this.props.map((function(e){return"string"==typeof e?"['"+e+"']":"number"==typeof e?"["+e+"]":"["+e.toJS()+"]"})).join(),new Function("value,params,alasql","var y;"+i+"=value")(a,t,s)}else"@"==this.method?s.vars[this.variable]=a:t[this.variable]=a}return a=1,r&&(a=r(a)),a},s.test=function(e,t,r){if(0!==arguments.length){var n=Date.now();if(1===arguments.length)return r(),void s.con.log(Date.now()-n);2===arguments.length&&(r=t,t=1);for(var a=0;a<t;a++)r();s.con.results[e]=Date.now()-n}else s.log(s.con.results)},s.log=function(e,t){s.useid;var r,n=s.options.logtarget;if(c.isNode&&(n="console"),r="string"==typeof e?s(e,t):e,"console"===n||c.isNode)"string"==typeof e&&s.options.logprompt,Array.isArray(r)&&console.table;else{var a;a="output"===n?document.getElementsByTagName("output")[0]:"string"==typeof n?document.getElementById(n):n;var i="";if("string"==typeof e&&s.options.logprompt&&(i+="<pre><code>"+s.pretty(e)+"</code></pre>"),Array.isArray(r))if(0===r.length)i+="<p>[ ]</p>";else if("object"!=typeof r[0]||Array.isArray(r[0]))for(var o=0,u=r.length;o<u;o++)i+="<p>"+ae(r[o])+"</p>";else i+=ae(r);else i+=ae(r);a.innerHTML+=i}},s.clear=function(){var e=s.options.logtarget;c.isNode||c.isMeteorServer?console.clear:("output"===e?document.getElementsByTagName("output")[0]:"string"==typeof e?document.getElementById(e):e).innerHTML=""},s.write=function(e){var t=s.options.logtarget;c.isNode||c.isMeteorServer?console.log:("output"===t?document.getElementsByTagName("output")[0]:"string"==typeof t?document.getElementById(t):t).innerHTML+=e},s.prompt=function(e,t,r){if(c.isNode)throw new Error("The prompt not realized for Node.js");var n=0;if("string"==typeof e&&(e=document.getElementById(e)),"string"==typeof t&&(t=document.getElementById(t)),t.textContent=s.useid,r){s.prompthistory.push(r),n=s.prompthistory.length;try{var a=Date.now();s.log(r),s.write('<p style="color:blue">'+(Date.now()-a)+" ms</p>")}catch(r){s.write("<p>"+olduseid+"&gt;&nbsp;<b>"+sql+"</b></p>"),s.write('<p style="color:red">'+r+"<p>")}}var i=e.getBoundingClientRect().top+document.getElementsByTagName("body")[0].scrollTop;se(document.getElementsByTagName("body")[0],i,500),e.onkeydown=function(r){if(13===r.which){var a=e.value,i=s.useid;e.value="",s.prompthistory.push(a),n=s.prompthistory.length;try{var o=Date.now();s.log(a),s.write('<p style="color:blue">'+(Date.now()-o)+" ms</p>")}catch(r){s.write("<p>"+i+"&gt;&nbsp;"+s.pretty(a,!1)+"</p>"),s.write('<p style="color:red">'+r+"<p>")}e.focus(),t.textContent=s.useid;var u=e.getBoundingClientRect().top+document.getElementsByTagName("body")[0].scrollTop;se(document.getElementsByTagName("body")[0],u,500)}else 38===r.which?(--n<0&&(n=0),s.prompthistory[n]&&(e.value=s.prompthistory[n],r.preventDefault())):40===r.which&&(++n>=s.prompthistory.length?(n=s.prompthistory.length,e.value=""):s.prompthistory[n]&&(e.value=s.prompthistory[n],r.preventDefault()))}},P.BeginTransaction=function(e){return P.extend(this,e)},P.BeginTransaction.prototype.toString=function(){return"BEGIN TRANSACTION"},P.BeginTransaction.prototype.execute=function(e,t,r){return s.databases[e].engineid?s.engines[s.databases[s.useid].engineid].begin(e,r):(r&&r(1),1)},P.CommitTransaction=function(e){return P.extend(this,e)},P.CommitTransaction.prototype.toString=function(){return"COMMIT TRANSACTION"},P.CommitTransaction.prototype.execute=function(e,t,r){return s.databases[e].engineid?s.engines[s.databases[s.useid].engineid].commit(e,r):(r&&r(1),1)},P.RollbackTransaction=function(e){return P.extend(this,e)},P.RollbackTransaction.prototype.toString=function(){return"ROLLBACK TRANSACTION"},P.RollbackTransaction.prototype.execute=function(e,t,r){return s.databases[e].engineid?s.engines[s.databases[e].engineid].rollback(e,r):(r&&r(1),1)},s.options.tsql&&(s.stdfn.OBJECT_ID=function(e,t){void 0===t&&(t="T"),t=t.toUpperCase();var r=e.split("."),n=s.useid,a=r[0];2==r.length&&(n=r[0],a=r[1]);var i=s.databases[n].tables;for(var o in n=s.databases[n].databaseid,i)if(o==a)return i[o].view&&"V"==t?n+"."+o:i[o].view||"T"!=t?void 0:n+"."+o}),s.options.mysql,(s.options.mysql||s.options.sqlite)&&(s.from.INFORMATION_SCHEMA=function(e,t,r,n,a){if("VIEWS"!=e&&"TABLES"!=e)throw new Error("Unknown INFORMATION_SCHEMA table");var i=[];for(var o in s.databases){var u=s.databases[o].tables;for(var c in u)(u[c].view&&"VIEWS"==e||!u[c].view&&"TABLES"==e)&&i.push({TABLE_CATALOG:o,TABLE_NAME:c})}return r&&(i=r(i,n,a)),i}),s.options.postgres,s.options.oracle,s.options.sqlite,s.into.SQL=function(e,t,r,n,a){var i;"object"==typeof e&&(t=e,e=void 0);var o={};if(s.utils.extend(o,t),void 0===o.tableid)throw new Error("Table for INSERT TO is not defined.");var u="";0===n.length&&"object"==typeof r[0]&&(n=Object.keys(r[0]).map((function(e){return{columnid:e}})));for(var c=0,l=r.length;c<l;c++)u+="INSERT INTO "+t.tableid+"(",u+=n.map((function(e){return e.columnid})).join(","),u+=") VALUES (",u+=n.map((function(e){var t=r[c][e.columnid];return e.typeid?"STRING"!==e.typeid&&"VARCHAR"!==e.typeid&&"NVARCHAR"!==e.typeid&&"CHAR"!==e.typeid&&"NCHAR"!==e.typeid||(t="'"+E(t)+"'"):"string"==typeof t&&(t="'"+E(t)+"'"),t})),u+=");\n";return e=s.utils.autoExtFilename(e,"sql",t),i=s.utils.saveFile(e,u),a&&(i=a(i)),i},s.into.HTML=function(e,t,r,n,a){var s=1;return a&&(s=a(s)),s},s.into.JSON=function(e,t,r,n,a){var i=1;"object"==typeof e&&(t=e,e=void 0);var o=JSON.stringify(r);return e=s.utils.autoExtFilename(e,"json",t),i=s.utils.saveFile(e,o),a&&(i=a(i)),i},s.into.TXT=function(e,t,r,n,a){0===n.length&&0<r.length&&(n=Object.keys(r[0]).map((function(e){return{columnid:e}}))),"object"==typeof e&&(t=e,e=void 0);var i=r.length,o="";if(0<r.length){var u=n[0].columnid;o+=r.map((function(e){return e[u]})).join("\n")}return e=s.utils.autoExtFilename(e,"txt",t),i=s.utils.saveFile(e,o),a&&(i=a(i)),i},s.into.TAB=s.into.TSV=function(e,t,r,n,a){var i={};return s.utils.extend(i,t),i.separator="\t",e=s.utils.autoExtFilename(e,"tab",t),i.autoExt=!1,s.into.CSV(e,i,r,n,a)},s.into.CSV=function(e,t,r,n,a){0===n.length&&0<r.length&&(n=Object.keys(r[0]).map((function(e){return{columnid:e}}))),"object"==typeof e&&(t=e,e=void 0);var i={headers:!0,separator:";",quote:'"',utf8Bom:!0};t&&!t.headers&&void 0!==t.headers&&(i.utf8Bom=!1),s.utils.extend(i,t);var o=r.length,u=i.utf8Bom?"\ufeff":"";return i.headers&&(u+=i.quote+n.map((function(e){return e.columnid.trim()})).join(i.quote+i.separator+i.quote)+i.quote+"\r\n"),r.forEach((function(e){u+=n.map((function(t){var r=e[t.columnid];return""!==i.quote&&(r=(r+"").replace(new RegExp("\\"+i.quote,"g"),i.quote+i.quote)),+r!=r&&(r=i.quote+r+i.quote),r})).join(i.separator)+"\r\n"})),e=s.utils.autoExtFilename(e,"csv",t),o=s.utils.saveFile(e,u,null,{disableAutoBom:!0}),a&&(o=a(o)),o},s.into.XLS=function(e,t,r,n,a){"object"==typeof e&&(t=e,e=void 0);var i={};t&&t.sheets&&(i=t.sheets);var o={headers:!0};void 0!==i.Sheet1?o=i[0]:void 0!==t&&(o=t),void 0===o.sheetid&&(o.sheetid="Sheet1");var u=function(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" \t\txmlns="http://www.w3.org/TR/REC-html40"><head> \t\t<meta charset="utf-8" /> \t\t\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets> ';if(e+=" <x:ExcelWorksheet><x:Name>"+o.sheetid+"</x:Name><x:WorksheetOptions><x:DisplayGridlines/>     </x:WorksheetOptions> \t\t</x:ExcelWorksheet>",e+="</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head>",e+="<body",void 0!==o.style&&(e+=' style="',"function"==typeof o.style?e+=o.style(o):e+=o.style,e+='"'),e+=">",e+="<table>",void 0!==o.caption){var a=o.caption;"string"==typeof a&&(a={title:a}),e+="<caption",void 0!==a.style&&(e+=' style="',"function"==typeof a.style?e+=a.style(o,a):e+=a.style,e+='" '),e+=">",e+=a.title,e+="</caption>"}return void 0!==o.columns?n=o.columns:0==n.length&&0<r.length&&"object"==typeof r[0]&&(n=Array.isArray(r[0])?r[0].map((function(e,t){return{columnid:t}})):Object.keys(r[0]).map((function(e){return{columnid:e}}))),n.forEach((function(e,t){void 0!==o.column&&D(e,o.column),void 0===e.width&&(o.column&&"undefined"!=o.column.width?e.width=o.column.width:e.width="120px"),"number"==typeof e.width&&(e.width=e.width+"px"),void 0===e.columnid&&(e.columnid=t),void 0===e.title&&(e.title=""+e.columnid.trim()),o.headers&&Array.isArray(o.headers)&&(e.title=o.headers[t])})),e+="<colgroups>",n.forEach((function(t){e+='<col style="width: '+t.width+'"></col>'})),e+="</colgroups>",o.headers&&(e+="<thead>",e+="<tr>",n.forEach((function(t,r){e+="<th ",void 0!==t.style&&(e+=' style="',"function"==typeof t.style?e+=t.style(o,t,r):e+=t.style,e+='" '),e+=">",void 0!==t.title&&("function"==typeof t.title?e+=t.title(o,t,r):e+=t.title),e+="</th>"})),e+="</tr>",e+="</thead>"),e+="<tbody>",r&&0<r.length&&r.forEach((function(r,a){if(!(a>o.limit)){e+="<tr";var s={};D(s,o.row),o.rows&&o.rows[a]&&D(s,o.rows[a]),void 0!==s&&void 0!==s.style&&(e+=' style="',"function"==typeof s.style?e+=s.style(o,r,a):e+=s.style,e+='" '),e+=">",n.forEach((function(n,i){var u={};D(u,o.cell),D(u,s.cell),void 0!==o.column&&D(u,o.column.cell),D(u,n.cell),o.cells&&o.cells[a]&&o.cells[a][i]&&D(u,o.cells[a][i]);var c=r[n.columnid];"function"==typeof u.value&&(c=u.value(c,o,r,n,u,a,i));var l=u.typeid;"function"==typeof l&&(l=l(c,o,r,n,u,a,i)),void 0===l&&("number"==typeof c?l="number":"string"==typeof c?l="string":"boolean"==typeof c?l="boolean":"object"==typeof c&&c instanceof Date&&(l="date"));var h="";"money"==l?h='mso-number-format:"\\#\\,\\#\\#0\\\\ __\\.";white-space:normal;':"number"==l?h=" ":"date"==l?h='mso-number-format:"Short Date";':t.types&&t.types[l]&&t.types[l].typestyle&&(h=t.types[l].typestyle),e+="<td style='"+(h=h||'mso-number-format:"\\@";')+"' ",void 0!==u.style&&(e+=' style="',"function"==typeof u.style?e+=u.style(c,o,r,n,a,i):e+=u.style,e+='" '),e+=">";var d=u.format;if(void 0===c)e+="";else if(void 0!==d)if("function"==typeof d)e+=d(c);else{if("string"!=typeof d)throw new Error("Unknown format type. Should be function or string");e+=c}else e+="number"==l||"date"==l?c.toString():"money"==l?(+c).toFixed(2):c;e+="</td>"})),e+="</tr>"}})),e+="</tbody>",e+="</table>",e+="</body>",e+="</html>"}();e=s.utils.autoExtFilename(e,"xls",t);var c=s.utils.saveFile(e,u);return a&&(c=a(c)),c},s.into.XLSXML=function(e,t,r,n,a){t=t||{},"object"==typeof e&&(t=e,e=void 0);var i,o,u={};o=t&&t.sheets?(u=t.sheets,i=r,n):(u.Sheet1=t,i=[r],[n]),e=s.utils.autoExtFilename(e,"xls",t);var c=s.utils.saveFile(e,function(){var e="",r=" </Styles>",n={},a=62;function s(t){var r="";for(var s in t){for(var i in r+="<"+s,t[s])r+=" ","x:"==i.substr(0,2)?r+=i:r+="ss:",r+=i+'="'+t[s][i]+'"';r+="/>"}var o=T(r);return n[o]||(n[o]={styleid:a},e+='<Style ss:ID="s'+a+'">',e+=r,e+="</Style>",a++),"s"+n[o].styleid}function c(e){try{return Object.values(e)}catch(t){return Object.keys(e).map((function(t){return e[t]}))}}var l=0;for(var h in u){var d=u[h],f=void 0!==d.dataidx?d.dataidx:l++,p=c(i[f]),b=void 0;void 0!==d.columns?b=d.columns:(void 0===(b=o[f])||0==b.length&&0<p.length)&&"object"==typeof p[0]&&(b=Array.isArray(p[0])?p[0].map((function(e,t){return{columnid:t}})):Object.keys(p[0]).map((function(e){return{columnid:e}}))),b.forEach((function(e,t){void 0!==d.column&&D(e,d.column),void 0===e.width&&(d.column&&void 0!==d.column.width?e.width=d.column.width:e.width=120),"number"==typeof e.width&&(e.width=e.width),void 0===e.columnid&&(e.columnid=t),void 0===e.title&&(e.title=""+e.columnid.trim()),d.headers&&Array.isArray(d.headers)&&(e.title=d.headers[t])})),r+='<Worksheet ss:Name="'+h+'"> \t  \t\t\t<Table ss:ExpandedColumnCount="'+b.length+'" ss:ExpandedRowCount="'+((d.headers?1:0)+Math.min(p.length,d.limit||p.length))+'" x:FullColumns="1" \t   \t\t\tx:FullRows="1" ss:DefaultColumnWidth="65" ss:DefaultRowHeight="15">',b.forEach((function(e,t){r+='<Column ss:Index="'+(t+1)+'" ss:AutoFitWidth="0" ss:Width="'+e.width+'"/>'})),d.headers&&(r+='<Row ss:AutoFitHeight="0">',b.forEach((function(e,t){if(r+="<Cell ",void 0!==e.style){var n={};"function"==typeof e.style?D(n,e.style(d,e,t)):D(n,e.style),r+='ss:StyleID="'+s(n)+'"'}r+='><Data ss:Type="String">',void 0!==e.title&&("function"==typeof e.title?r+=e.title(d,e,t):r+=e.title),r+="</Data></Cell>"})),r+="</Row>"),p&&0<p.length&&p.forEach((function(e,n){if(!(n>d.limit)){var a={};if(D(a,d.row),d.rows&&d.rows[n]&&D(a,d.rows[n]),r+="<Row ",void 0!==a){var i={};void 0!==a.style&&("function"==typeof a.style?D(i,a.style(d,e,n)):D(i,a.style),r+='ss:StyleID="'+s(i)+'"')}r+=">",b.forEach((function(i,o){var u={};D(u,d.cell),D(u,a.cell),void 0!==d.column&&D(u,d.column.cell),D(u,i.cell),d.cells&&d.cells[n]&&d.cells[n][o]&&D(u,d.cells[n][o]);var c=e[i.columnid];"function"==typeof u.value&&(c=u.value(c,d,e,i,u,n,o));var l=u.typeid;"function"==typeof l&&(l=l(c,d,e,i,u,n,o)),void 0===l&&("number"==typeof c?l="number":"string"==typeof c?l="string":"boolean"==typeof c?l="boolean":"object"==typeof c&&c instanceof Date&&(l="date"));var h="String";"number"==l?h="Number":"date"==l&&(h="Date"),"money"==l||"number"==l||"date"==l||t.types&&t.types[l]&&t.types[l].typestyle&&t.types[l].typestyle,r+="<Cell ";var f={};void 0!==u.style&&("function"==typeof u.style?D(f,u.style(c,d,e,i,n,o)):D(f,u.style),r+='ss:StyleID="'+s(f)+'"'),r+=">",r+='<Data ss:Type="'+h+'">';var p=u.format;if(void 0===c)r+="";else if(void 0!==p)if("function"==typeof p)r+=p(c);else{if("string"!=typeof p)throw new Error("Unknown format type. Should be function or string");r+=c}else r+="number"==l||"date"==l?c.toString():"money"==l?(+c).toFixed(2):c;r+="</Data></Cell>"})),r+="</Row>"}})),r+="</Table></Worksheet>"}return'<?xml version="1.0"?> \t\t<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" \t\t xmlns:o="urn:schemas-microsoft-com:office:office" \t\t xmlns:x="urn:schemas-microsoft-com:office:excel" \t\t xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" \t\t xmlns:html="http://www.w3.org/TR/REC-html40"> \t\t <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"> \t\t </DocumentProperties> \t\t <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"> \t\t  <AllowPNG/> \t\t </OfficeDocumentSettings> \t\t <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"> \t\t  <ActiveSheet>0</ActiveSheet> \t\t </ExcelWorkbook> \t\t <Styles> \t\t  <Style ss:ID="Default" ss:Name="Normal"> \t\t   <Alignment ss:Vertical="Bottom"/> \t\t   <Borders/> \t\t   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="12" ss:Color="#000000"/> \t\t   <Interior/> \t\t   <NumberFormat/> \t\t   <Protection/> \t\t  </Style>'+e+(r+="</Workbook>")}());return a&&(c=a(c)),c},s.into.XLSX=function(e,t,r,n,a){var i=1;I(n,[{columnid:"_"}])&&(r=r.map((function(e){return e._})),n=void 0),e=s.utils.autoExtFilename(e,"xlsx",t);var o=L();"object"==typeof e&&(t=e,e=void 0);var u={SheetNames:[],Sheets:{}};return t.sourcefilename?s.utils.loadBinaryFile(t.sourcefilename,!!a,(function(e){u=o.read(e,{type:"binary"}),l()})):l(),a&&(i=a(i)),i;function l(){"object"==typeof t&&Array.isArray(t)?r&&0<r.length&&r.forEach((function(e,r){h(t[r],e,void 0,r+1)})):h(t,r,n,1),function(){var t;if(void 0===e)i=u;else if(t=L(),c.isNode||c.isMeteorServer)t.writeFile(u,e);else{var r=t.write(u,{bookType:"xlsx",bookSST:!1,type:"binary"});if(9==S())throw new Error("Cannot save XLSX files in IE9. Please use XLS() export function");de(new Blob([function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}(r)],{type:"application/octet-stream"}),e)}}()}function h(e,t,r,n){var a={sheetid:"Sheet "+n,headers:!0};s.utils.extend(a,e);var i=Object.keys(t).length;(!r||0==r.length)&&0<i&&(r=Object.keys(t[0]).map((function(e){return{columnid:e}})));var o={};-1<u.SheetNames.indexOf(a.sheetid)||(u.SheetNames.push(a.sheetid),u.Sheets[a.sheetid]={}),o=u.Sheets[a.sheetid];var c="A1";a.range&&(c=a.range);var l=s.utils.xlscn(c.match(/[A-Z]+/)[0]),h=+c.match(/[0-9]+/)[0]-1;if(u.Sheets[a.sheetid]["!ref"])var d=u.Sheets[a.sheetid]["!ref"],f=s.utils.xlscn(d.match(/[A-Z]+/)[0]),p=+d.match(/[0-9]+/)[0]-1;else f=1,p=1;var b=Math.max(l+r.length,f),E=Math.max(h+i+2,p),g=1+h;u.Sheets[a.sheetid]["!ref"]="A1:"+s.utils.xlsnc(b)+E,a.headers&&(r.forEach((function(e,t){o[s.utils.xlsnc(l+t)+""+g]={v:e.columnid.trim()}})),g++);for(var m=0;m<i;m++)r.forEach((function(e,r){var n={v:t[m][e.columnid]};"number"==typeof t[m][e.columnid]?n.t="n":"string"==typeof t[m][e.columnid]?n.t="s":"boolean"==typeof t[m][e.columnid]?n.t="b":"object"==typeof t[m][e.columnid]&&t[m][e.columnid]instanceof Date&&(n.t="d"),o[s.utils.xlsnc(l+r)+""+g]=n})),g++}},s.from.METEOR=function(e,t,r,n,a){var s=e.find(t).fetch();return r&&(s=r(s,n,a)),s},s.from.TABLETOP=function(e,t,r,n,a){var i=[],o={headers:!0,simpleSheet:!0,key:e};return s.utils.extend(o,t),o.callback=function(e){i=e,r&&(i=r(i,n,a))},Tabletop.init(o),null},s.from.HTML=function(e,t,r,n,a){var i={};s.utils.extend(i,t);var o=document.querySelector(e);if(!o&&"TABLE"!==o.tagName)throw new Error("Selected HTML element is not a TABLE");var u=[],c=i.headers;if(c&&!Array.isArray(c)){c=[];for(var l=o.querySelector("thead tr").children,h=0;h<l.length;h++)l.item(h).style&&"none"===l.item(h).style.display&&i.skipdisplaynone?c.push(void 0):c.push(l.item(h).textContent)}for(var d=o.querySelectorAll("tbody tr"),f=0;f<d.length;f++){var p=d.item(f).children,b={};for(h=0;h<p.length;h++)p.item(h).style&&"none"===p.item(h).style.display&&i.skipdisplaynone||(c?b[c[h]]=p.item(h).textContent:b[h]=p.item(h).textContent);u.push(b)}return r&&(u=r(u,n,a)),u},s.from.RANGE=function(e,t,r,n,a){for(var s=[],i=e;i<=t;i++)s.push(i);return r&&(s=r(s,n,a)),s},s.from.FILE=function(e,t,r,n,a){var i;if("string"==typeof e)i=e;else{if(!(e instanceof Event))throw new Error("Wrong usage of FILE() function");i=e.target.files[0].name}var o=i.split("."),u=o[o.length-1].toUpperCase();if(s.from[u])return s.from[u](e,t,r,n,a);throw new Error("Cannot recognize file type for loading")},s.from.JSON=function(e,t,r,n,a){var i;return e=s.utils.autoExtFilename(e,"json",t),s.utils.loadFile(e,!!r,(function(e){i=JSON.parse(e),r&&(i=r(i,n,a))})),i},s.from.TXT=function(e,t,r,n,a){var i;return e=s.utils.autoExtFilename(e,"txt",t),s.utils.loadFile(e,!!r,(function(e){""===(i=e.split(/\r?\n/))[i.length-1]&&i.pop();for(var t=0,s=i.length;t<s;t++)i[t]==+i[t]&&(i[t]=+i[t]),i[t]=[i[t]];r&&(i=r(i,n,a))})),i},s.from.TAB=s.from.TSV=function(e,t,r,n,a){return(t=t||{}).separator="\t",e=s.utils.autoExtFilename(e,"tab",t),t.autoext=!1,s.from.CSV(e,t,r,n,a)},s.from.CSV=function(e,t,r,n,a){e=""+e;var i,o={separator:",",quote:'"',headers:!0};s.utils.extend(o,t);var u=[];function c(e){var t,s,c=o.separator.charCodeAt(0),l=o.quote.charCodeAt(0),h={},d={},f=[],p=e.length,b=0,E=0;function g(){if(p<=b)return d;if(s)return s=!1,h;var t=b;if(e.charCodeAt(t)===l){for(var r=t;r++<p;)if(e.charCodeAt(r)===l){if(e.charCodeAt(r+1)!==l)break;++r}return b=r+2,13===(n=e.charCodeAt(r+1))?(s=!0,10===e.charCodeAt(r+2)&&++b):10===n&&(s=!0),e.substring(t+1,r).replace(/""/g,'"')}for(;b<p;){var n,a=1;if(10===(n=e.charCodeAt(b++)))s=!0;else if(13===n)s=!0,10===e.charCodeAt(b)&&(++b,++a);else if(n!==c)continue;return e.substring(t,b-a)}return e.substring(t)}for(;(t=g())!==d;){for(var m=[];t!==h&&t!==d;)m.push(t.trim()),t=g();if(o.headers){if(0===E){if("boolean"==typeof o.headers)u=m;else if(Array.isArray(o.headers)){u=o.headers;var v={};u.forEach((function(e,t){v[e]=m[t],void 0!==v[e]&&0!==v[e].length&&v[e].trim()==+v[e]&&(v[e]=+v[e])})),f.push(v)}}else v={},u.forEach((function(e,t){v[e]=m[t],void 0!==v[e]&&0!==v[e].length&&v[e].trim()==+v[e]&&(v[e]=+v[e])})),f.push(v);E++}else f.push(m)}if(i=f,o.headers&&a&&a.sources&&a.sources[n]){var S=a.sources[n].columns=[];u.forEach((function(e){S.push({columnid:e})}))}r&&(i=r(i,n,a))}return new RegExp("\n").test(e)?c(e):(e=s.utils.autoExtFilename(e,"csv",t),s.utils.loadFile(e,!!r,c,a.cb)),i},s.from.XLS=function(e,t,r,n,a){return t=t||{},e=s.utils.autoExtFilename(e,"xls",t),t.autoExt=!1,ie(L(),e,t,r,n,a)},s.from.XLSX=function(e,t,r,n,a){return t=t||{},e=s.utils.autoExtFilename(e,"xlsx",t),t.autoExt=!1,ie(L(),e,t,r,n,a)},s.from.ODS=function(e,t,r,n,a){return t=t||{},e=s.utils.autoExtFilename(e,"ods",t),t.autoExt=!1,ie(L(),e,t,r,n,a)},s.from.XML=function(e,t,r,n,a){var i;return s.utils.loadFile(e,!!r,(function(e){i=function(e){return e=(e=e.trim()).replace(/<!--[\s\S]*?-->/g,""),{declaration:function(){if(r(/^<\?xml\s*/)){for(var e={attributes:{}};!n()&&!a("?>");){var s=t();if(!s)return e;e.attributes[s.name]=s.value}return r(/\?>\s*/),e}}(),root:function e(){var s=r(/^<([\w-:.]+)\s*/);if(s){for(var i,o={name:s[1],attributes:{},children:[]};!(n()||a(">")||a("?>")||a("/>"));){var u=t();if(!u)return o;o.attributes[u.name]=u.value}if(r(/^\s*\/>\s*/))return o;for(r(/\??>\s*/),o.content=function(){var e=r(/^([^<]*)/);return e?e[1]:""}();i=e();)o.children.push(i);return r(/^<\/[\w-:.]+>\s*/),o}}()};function t(){var e=r(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);if(e)return{name:e[1],value:function(e){return e.replace(/^['"]|['"]$/g,"")}(e[2])}}function r(t){var r=e.match(t);if(r)return e=e.slice(r[0].length),r}function n(){return 0==e.length}function a(t){return 0==e.indexOf(t)}}(e).root,r&&(i=r(i,n,a))})),i},s.from.GEXF=function(e,t,r,n,a){var i;return s("SEARCH FROM XML("+e+")",[],(function(e){i=e,r&&(i=r(i))})),i},P.Print=function(e){return P.extend(this,e)},P.Print.prototype.toString=function(){var e="PRINT";return this.statement&&(e+=" "+this.statement.toString()),e},P.Print.prototype.execute=function(e,t,r){var n=this,a=1;return s.precompile(this,e,t),this.exprs&&0<this.exprs.length?this.exprs.map((function(e){var r=new Function("params,alasql,p","var y;return "+e.toJS("({})","",null)).bind(n)(t,s);return te(r)})):this.select&&this.select.execute(e,t),r&&(a=r(a)),a},P.Source=function(e){return P.extend(this,e)},P.Source.prototype.toString=function(){var e="SOURCE";return this.url&&(e+=" '"+this.url+" '"),e},P.Source.prototype.execute=function(e,t,r){var n;return m(this.url,!!r,(function(e){return n=s(e),r&&(n=r(n)),n}),(function(e){throw e})),n},P.Require=function(e){return P.extend(this,e)},P.Require.prototype.toString=function(){var e="REQUIRE";return this.paths&&0<this.paths.length&&(e+=this.paths.map((function(e){return e.toString()})).join(",")),this.plugins&&0<this.plugins.length&&(e+=this.plugins.map((function(e){return e.toUpperCase()})).join(",")),e},P.Require.prototype.execute=function(e,t,r){var n=this,a=0,i="";return this.paths&&0<this.paths.length?this.paths.forEach((function(e){m(e.value,!!r,(function(e){i+=e,++a<n.paths.length||(new Function("params,alasql",i)(t,s),r&&(a=r(a)))}))})):this.plugins&&0<this.plugins.length?this.plugins.forEach((function(e){s.plugins[e]||m(s.path+"/alasql-"+e.toLowerCase()+".js",!!r,(function(o){i+=o,++a<n.plugins.length||(new Function("params,alasql",i)(t,s),s.plugins[e]=!0,r&&(a=r(a)))}))})):r&&(a=r(a)),a},P.Assert=function(e){return P.extend(this,e)},P.Source.prototype.toString=function(){var e="ASSERT";return this.value&&(e+=" "+JSON.stringify(this.value)),e},P.Assert.prototype.execute=function(e){if(!I(s.res,this.value))throw new Error((this.message||"Assert wrong")+": "+JSON.stringify(s.res)+" == "+JSON.stringify(this.value));return 1};var oe=s.engines.WEBSQL=function(){};oe.createDatabase=function(e,t,r,n){var a=openDatabase(e,t[0],t[1],t[2]);if(this.dbid){var i=s.createDatabase(this.dbid);i.engineid="WEBSQL",i.wdbid=e,sb.wdb=i}if(!a)throw new Error('Cannot create WebSQL database "'+databaseid+'"');return n&&n(1),1},oe.dropDatabase=function(e){throw new Error("This is impossible to drop WebSQL database.")},oe.attachDatabase=function(e,t,r,n,a){if(s.databases[t])throw new Error('Unable to attach database as "'+t+'" because it already exists');return alasqlopenDatabase(e,r[0],r[1],r[2]),1};var ue=s.engines.INDEXEDDB=function(){};c.hasIndexedDB&&("function"==typeof c.global.indexedDB.webkitGetDatabaseNames?ue.getDatabaseNames=c.global.indexedDB.webkitGetDatabaseNames.bind(c.global.indexedDB):(ue.getDatabaseNames=function(){var e={},t={contains:function(e){return!0},notsupported:!0};return setTimeout((function(){var r={target:{result:t}};e.onsuccess(r)}),0),e},ue.getDatabaseNamesNotSupported=!0)),ue.showDatabases=function(e,t){ue.getDatabaseNames().onsuccess=function(r){var n=r.target.result;if(ue.getDatabaseNamesNotSupported)throw new Error("SHOW DATABASE is not supported in this browser");var a=[];if(e)var s=new RegExp(e.value.replace(/\%/g,".*"),"g");for(var i=0;i<n.length;i++)e&&!n[i].match(s)||a.push({databaseid:n[i]});t(a)}},ue.createDatabase=function(e,t,r,n,a){var s=c.global.indexedDB;if(r)s.open(e,1).onsuccess=function(e){e.target.result.close(),a&&a(1)};else{var i=s.open(e,1);i.onupgradeneeded=function(e){e.target.transaction.abort()},i.onsuccess=function(t){if(!r)throw new Error('IndexedDB: Cannot create new database "'+e+'" because it already exists');a&&a(0)}}},ue.createDatabase=function(e,t,r,n,a){var s=c.global.indexedDB;if(ue.getDatabaseNamesNotSupported)if(r){var i=!0,o=s.open(e);o.onupgradeneeded=function(e){i=!1},o.onsuccess=function(e){e.target.result.close(),i?a&&a(0):a&&a(1)}}else{var u;(u=s.open(e)).onupgradeneeded=function(e){e.target.transaction.abort()},u.onabort=function(e){a&&a(1)},u.onsuccess=function(t){throw t.target.result.close(),new Error('IndexedDB: Cannot create new database "'+e+'" because it already exists')}}else(u=ue.getDatabaseNames()).onsuccess=function(t){if(t.target.result.contains(e)){if(r)return void(a&&a(0));throw new Error('IndexedDB: Cannot create new database "'+e+'" because it already exists')}s.open(e,1).onsuccess=function(e){e.target.result.close(),a&&a(1)}}},ue.dropDatabase=function(e,t,r){var n=c.global.indexedDB;ue.getDatabaseNames().onsuccess=function(a){if(!a.target.result.contains(e)){if(t)return void(r&&r(0));throw new Error('IndexedDB: Cannot drop new database "'+e+'" because it does not exist')}n.deleteDatabase(e).onsuccess=function(e){r&&r(1)}}},ue.attachDatabase=function(e,t,r,n,a){if(!c.hasIndexedDB)throw new Error("The current browser does not support IndexedDB");var i=c.global.indexedDB;ue.getDatabaseNames().onsuccess=function(r){if(!r.target.result.contains(e))throw new Error('IndexedDB: Cannot attach database "'+e+'" because it does not exist');i.open(e).onsuccess=function(r){var n=r.target.result,i=new s.Database(t||e);i.engineid="INDEXEDDB",i.ixdbid=e,i.tables=[];for(var o=n.objectStoreNames,u=0;u<o.length;u++)i.tables[o[u]]={};r.target.result.close(),a&&a(1)}}},ue.createTable=function(e,t,r,n){var a=c.global.indexedDB,i=s.databases[e].ixdbid;ue.getDatabaseNames().onsuccess=function(r){if(!r.target.result.contains(i))throw new Error('IndexedDB: Cannot create table in database "'+i+'" because it does not exist');var s=a.open(i);s.onversionchange=function(e){e.target.result.close()},s.onsuccess=function(r){var s=r.target.result.version;r.target.result.close();var o=a.open(i,s+1);o.onupgradeneeded=function(e){e.target.result.createObjectStore(t,{autoIncrement:!0})},o.onsuccess=function(e){e.target.result.close(),n&&n(1)},o.onerror=function(e){throw e},o.onblocked=function(r){throw new Error('Cannot create table "'+t+'" because database "'+e+'"  is blocked')}}}},ue.dropTable=function(e,t,r,n){var a=c.global.indexedDB,i=s.databases[e].ixdbid;ue.getDatabaseNames().onsuccess=function(o){if(!o.target.result.contains(i))throw new Error('IndexedDB: Cannot drop table in database "'+i+'" because it does not exist');var u=a.open(i);u.onversionchange=function(e){e.target.result.close()},u.onsuccess=function(o){var u=o.target.result.version;o.target.result.close();var c=a.open(i,u+1);c.onupgradeneeded=function(n){var a=n.target.result;if(a.objectStoreNames.contains(t))a.deleteObjectStore(t),delete s.databases[e].tables[t];else if(!r)throw new Error('IndexedDB: Cannot drop table "'+t+'" because it does not exist')},c.onsuccess=function(e){e.target.result.close(),n&&n(1)},c.onerror=function(e){throw e},c.onblocked=function(r){throw new Error('Cannot drop table "'+t+'" because database "'+e+'" is blocked')}}}},ue.intoTable=function(e,t,r,n,a){var i=c.global.indexedDB,o=s.databases[e].ixdbid;i.open(o).onsuccess=function(e){for(var n=e.target.result,s=n.transaction([t],"readwrite"),i=s.objectStore(t),o=0,u=r.length;o<u;o++)i.add(r[o]);s.oncomplete=function(){n.close(),a&&a(u)}}},ue.fromTable=function(e,t,r,n,a){var i=c.global.indexedDB,o=s.databases[e].ixdbid;i.open(o).onsuccess=function(e){var s=[],i=e.target.result,o=i.transaction([t]).objectStore(t).openCursor();o.onblocked=function(e){},o.onerror=function(e){},o.onsuccess=function(e){var t=e.target.result;t?(s.push(t.value),t.continue()):(i.close(),r&&r(s,n,a))}}},ue.deleteFromTable=function(e,t,r,n,a){var i=c.global.indexedDB,o=s.databases[e].ixdbid;i.open(o).onsuccess=function(e){var s=e.target.result,i=s.transaction([t],"readwrite").objectStore(t).openCursor(),o=0;i.onblocked=function(e){},i.onerror=function(e){},i.onsuccess=function(e){var t=e.target.result;t?(r&&!r(t.value,n)||(t.delete(),o++),t.continue()):(s.close(),a&&a(o))}}},ue.updateTable=function(e,t,r,n,a,i){var o=c.global.indexedDB,u=s.databases[e].ixdbid;o.open(u).onsuccess=function(e){var s=e.target.result,o=s.transaction([t],"readwrite").objectStore(t).openCursor(),u=0;o.onblocked=function(e){},o.onerror=function(e){},o.onsuccess=function(e){var t=e.target.result;if(t){if(!n||n(t.value,a)){var o=t.value;r(o,a),t.update(o),u++}t.continue()}else s.close(),i&&i(u)}}};var ce=s.engines.LOCALSTORAGE=function(){};ce.get=function(e){var t=localStorage.getItem(e);if(void 0!==t){var r;try{r=JSON.parse(t)}catch(e){throw new Error("Cannot parse JSON object from localStorage"+t)}return r}},ce.set=function(e,t){void 0===t?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t))},ce.storeTable=function(e,t){var r=s.databases[e],n=r.tables[t],a={};a.columns=n.columns,a.data=n.data,a.identities=n.identities,ce.set(r.lsdbid+"."+t,a)},ce.restoreTable=function(e,t){var r=s.databases[e],n=ce.get(r.lsdbid+"."+t),a=new s.Table;for(var i in n)a[i]=n[i];return(r.tables[t]=a).indexColumns(),a},ce.removeTable=function(e,t){var r=s.databases[e];localStorage.removeItem(r.lsdbid+"."+t)},ce.createDatabase=function(e,t,r,n,a){var s=1,i=ce.get("alasql");if(r&&i&&i.databases&&i.databases[e])s=0;else{if((i=i||{databases:{}}).databases&&i.databases[e])throw new Error('localStorage: Cannot create new database "'+e+'" because it already exists');i.databases[e]=!0,ce.set("alasql",i),ce.set(e,{databaseid:e,tables:{}})}return a&&(s=a(s)),s},ce.dropDatabase=function(e,t,r){var n=1,a=ce.get("alasql");if(t&&a&&a.databases&&!a.databases[e])n=0;else{if(!a){if(t)return r?r(0):0;throw new Error("There is no any AlaSQL databases in localStorage")}if(a.databases&&!a.databases[e])throw new Error('localStorage: Cannot drop database "'+e+'" because there is no such database');delete a.databases[e],ce.set("alasql",a);var s=ce.get(e);for(var i in s.tables)localStorage.removeItem(e+"."+i);localStorage.removeItem(e)}return r&&(n=r(n)),n},ce.attachDatabase=function(e,t,r,n,a){var i=1;if(s.databases[t])throw new Error('Unable to attach database as "'+t+'" because it already exists');t=t||e;var o=new s.Database(t);if(o.engineid="LOCALSTORAGE",o.lsdbid=e,o.tables=ce.get(e).tables,!s.options.autocommit&&o.tables)for(var u in o.tables)ce.restoreTable(t,u);return a&&(i=a(i)),i},ce.showDatabases=function(e,t){var r=[],n=ce.get("alasql");if(e)var a=new RegExp(e.value.replace(/%/g,".*"),"g");if(n&&n.databases){for(var s in n.databases)r.push({databaseid:s});e&&r&&0<r.length&&(r=r.filter((function(e){return e.databaseid.match(a)})))}return t&&(r=t(r)),r},ce.createTable=function(e,t,r,n){var a=1,i=s.databases[e].lsdbid;if(ce.get(i+"."+t)&&!r)throw new Error('Table "'+t+'" alsready exists in localStorage database "'+i+'"');var o=ce.get(i);return s.databases[e].tables[t],o.tables[t]=!0,ce.set(i,o),ce.storeTable(e,t),n&&(a=n(a)),a},ce.truncateTable=function(e,t,r,n){var a,i=1,o=s.databases[e].lsdbid;if(a=s.options.autocommit?ce.get(o):s.databases[e],!r&&!a.tables[t])throw new Error('Cannot truncate table "'+t+'" in localStorage, because it does not exist');return ce.restoreTable(e,t).data=[],ce.storeTable(e,t),n&&(i=n(i)),i},ce.dropTable=function(e,t,r,n){var a,i=1,o=s.databases[e].lsdbid;if(a=s.options.autocommit?ce.get(o):s.databases[e],!r&&!a.tables[t])throw new Error('Cannot drop table "'+t+'" in localStorage, because it does not exist');return delete a.tables[t],ce.set(o,a),ce.removeTable(e,t),n&&(i=n(i)),i},ce.fromTable=function(e,t,r,n,a){s.databases[e].lsdbid;var i=ce.restoreTable(e,t).data;return r&&(i=r(i,n,a)),i},ce.intoTable=function(e,t,r,n,a){s.databases[e].lsdbid;var i=r.length,o=ce.restoreTable(e,t);for(var u in o.identities){var c=o.identities[u];for(var l in r)r[l][u]=c.value,c.value+=c.step}return o.data||(o.data=[]),o.data=o.data.concat(r),ce.storeTable(e,t),a&&(i=a(i)),i},ce.loadTableData=function(e,t){s.databases[e],s.databases[e].lsdbid,ce.restoreTable(e,t)},ce.saveTableData=function(e,t){var r=s.databases[e],n=s.databases[e].lsdbid;ce.storeTable(n,t),r.tables[t].data=void 0},ce.commit=function(e,t){var r=s.databases[e],n=s.databases[e].lsdbid,a={databaseid:n,tables:{}};if(r.tables)for(var i in r.tables)a.tables[i]=!0,ce.storeTable(e,i);return ce.set(n,a),t?t(1):1},ce.begin=ce.commit,ce.rollback=function(e,t){};var le=s.engines.SQLITE=function(){};le.createDatabase=function(e,t,r,n,a){throw new Error("Connot create SQLITE database in memory. Attach it.")},le.dropDatabase=function(e){throw new Error("This is impossible to drop SQLite database. Detach it.")},le.attachDatabase=function(e,t,r,n,a){if(s.databases[t])throw new Error('Unable to attach database as "'+t+'" because it already exists');if(r[0]&&r[0]instanceof P.StringValue||r[0]instanceof P.ParamValue){if(r[0]instanceof P.StringValue)var i=r[0].value;else r[0]instanceof P.ParamValue&&(i=n[r[0].param]);return s.utils.loadBinaryFile(i,!0,(function(r){var n=new s.Database(t||e);n.engineid="SQLITE",n.sqldbid=e;var i=n.sqldb=new SQL.Database(r);n.tables=[],i.exec("SELECT * FROM sqlite_master WHERE type='table'")[0].values.forEach((function(e){n.tables[e[1]]={};var t=n.tables[e[1]].columns=[],r=s.parse(e[4]).statements[0].columns;r&&0<r.length&&r.forEach((function(e){t.push(e)}))})),a(1)}),(function(e){throw new Error('Cannot open SQLite database file "'+r[0].value+'"')})),1}throw new Error("Cannot attach SQLite database without a file")},le.fromTable=function(e,t,r,n,a){var i=s.databases[e].sqldb.exec("SELECT * FROM "+t),o=a.sources[n].columns=[];0<i[0].columns.length&&i[0].columns.forEach((function(e){o.push({columnid:e})}));var u=[];0<i[0].values.length&&i[0].values.forEach((function(e){var t={};o.forEach((function(r,n){t[r.columnid]=e[n]})),u.push(t)})),r&&r(u,n,a)},le.intoTable=function(e,t,r,n,a){for(var i=s.databases[e].sqldb,o=0,u=r.length;o<u;o++){var c="INSERT INTO "+t+" (",l=r[o],h=Object.keys(l);c+=h.join(","),c+=") VALUES (",c+=h.map((function(e){return v=l[e],"string"==typeof v&&(v="'"+v+"'"),v})).join(","),c+=")",i.exec(c)}var d=u;return a&&a(d),d};var he=s.engines.FILESTORAGE=s.engines.FILE=function(){};if(he.createDatabase=function(e,t,r,n,a){var i=1,o=t[0].value;return s.utils.fileExists(o,(function(e){if(e){if(r)return i=0,a&&(i=a(i)),i;throw new Error("Cannot create new database file, because it already exists")}s.utils.saveFile(o,JSON.stringify({tables:{}}),(function(e){a&&(i=a(i))}))})),i},he.dropDatabase=function(e,t,r){var n,a=e.value;return s.utils.fileExists(a,(function(e){if(e)n=1,s.utils.deleteFile(a,(function(){n=1,r&&(n=r(n))}));else{if(!t)throw new Error("Cannot drop database file, because it does not exist");n=0,r&&(n=r(n))}})),n},he.attachDatabase=function(e,t,r,n,a){var i=1;if(s.databases[t])throw new Error('Unable to attach database as "'+t+'" because it already exists');var o=new s.Database(t||e);return o.engineid="FILESTORAGE",o.filename=r[0].value,m(o.filename,!!a,(function(e){try{o.data=JSON.parse(e)}catch(e){throw new Error("Data in FileStorage database are corrupted")}if(o.tables=o.data.tables,!s.options.autocommit&&o.tables)for(var t in o.tables)o.tables[t].data=o.data[t];a&&(i=a(i))})),i},he.createTable=function(e,t,r,n){var a=s.databases[e];if(a.data[t]&&!r)throw new Error('Table "'+t+'" alsready exists in the database "'+fsdbid+'"');var i=s.databases[e].tables[t];return a.data.tables[t]={columns:i.columns},a.data[t]=[],he.updateFile(e),n&&n(1),1},he.updateFile=function(e){var t=s.databases[e];t.issaving?t.postsave=!0:(t.issaving=!0,t.postsave=!1,s.utils.saveFile(t.filename,JSON.stringify(t.data),(function(){t.issaving=!1,t.postsave&&setTimeout((function(){he.updateFile(e)}),50)})))},he.dropTable=function(e,t,r,n){var a=s.databases[e];if(!r&&!a.tables[t])throw new Error('Cannot drop table "'+t+'" in fileStorage, because it does not exist');return delete a.tables[t],delete a.data.tables[t],delete a.data[t],he.updateFile(e),n&&n(1),1},he.fromTable=function(e,t,r,n,a){var i=s.databases[e].data[t];return r&&(i=r(i,n,a)),i},he.intoTable=function(e,t,r,n,a){var i=s.databases[e],o=r.length,u=i.data[t];return u=u||[],i.data[t]=u.concat(r),he.updateFile(e),a&&a(o),o},he.loadTableData=function(e,t){var r=s.databases[e];r.tables[t].data=r.data[t]},he.saveTableData=function(e,t){var r=s.databases[e];r.data[t]=r.tables[t].data,r.tables[t].data=null,he.updateFile(e)},he.commit=function(e,t){var r=s.databases[e];if(r.tables)for(var n in r.tables)r.data.tables[n]={columns:r.tables[n].columns},r.data[n]=r.tables[n].data;return he.updateFile(e),t?t(1):1},he.begin=he.commit,he.rollback=function(e,t){var r=1,n=s.databases[e];n.dbversion++,function a(){setTimeout((function(){if(n.issaving)return a();s.loadFile(n.filename,!!t,(function(a){for(var i in n.data=a,n.tables={},n.data.tables){var o=new s.Table({columns:n.data.tables[i].columns});D(o,n.data.tables[i]),n.tables[i]=o,s.options.autocommit||(n.tables[i].data=n.data[i]),n.tables[i].indexColumns()}delete s.databases[e],s.databases[e]=new s.Database(e),D(s.databases[e],n),s.databases[e].engineid="FILESTORAGE",s.databases[e].filename=n.filename,t&&(r=t(r))}))}),100)}()},c.isBrowser&&!c.isWebWorker){if(!(s=s||!1))throw new Error("alasql was not found");s.worker=function(){throw new Error("Can find webworker in this enviroment")},"undefined"!=typeof Worker&&(s.worker=function(e,t,r){if(!0===e&&(e=void 0),void 0===e)for(var n=document.getElementsByTagName("script"),a=0;a<n.length;a++){if("alasql-worker.js"===n[a].src.substr(-16).toLowerCase()){e=n[a].src.substr(0,n[a].src.length-16)+"alasql.js";break}if("alasql-worker.min.js"===n[a].src.substr(-20).toLowerCase()){e=n[a].src.substr(0,n[a].src.length-20)+"alasql.min.js";break}if("alasql.js"===n[a].src.substr(-9).toLowerCase()){e=n[a].src;break}if("alasql.min.js"===n[a].src.substr(-13).toLowerCase()){e=n[a].src.substr(0,n[a].src.length-13)+"alasql.min.js";break}}if(void 0===e)throw new Error("Path to alasql.js is not specified");if(!1!==e){var i="importScripts('";i+=e,i+="');self.onmessage = function(event) {alasql(event.data.sql,event.data.params, function(data){postMessage({id:event.data.id, data:data});});}";var o=new Blob([i],{type:"text/plain"});if(s.webworker=new Worker(URL.createObjectURL(o)),s.webworker.onmessage=function(e){var t=e.data.id;s.buffer[t](e.data.data),delete s.buffer[t]},s.webworker.onerror=function(e){throw e},1<arguments.length){var u="REQUIRE "+t.map((function(e){return'"'+e+'"'})).join(",");s(u,[],r)}}else if(!1===e)return void delete s.webworker});var de=de||function(e){if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in n,s=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),o=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},u=function(e){setTimeout((function(){"string"==typeof e?r().revokeObjectURL(e):e.remove()}),4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},l=function(t,l,h){function d(){!function(e,t,r){for(var n=(t=[].concat(t)).length;n--;){var a=e["on"+t[n]];if("function"==typeof a)try{a.call(e,e)}catch(e){o(e)}}}(p,"writestart progress write writeend".split(" "))}h||(t=c(t));var f,p=this,b="application/octet-stream"===t.type;if(p.readyState=p.INIT,a)return f=r().createObjectURL(t),void setTimeout((function(){n.href=f,n.download=l,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(n),d(),u(f),p.readyState=p.DONE}));!function(){if((i||b&&s)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,d()},n.readAsDataURL(t),p.readyState=p.INIT}f=f||r().createObjectURL(t),b?e.location.href=f:e.open(f,"_blank")||(e.location.href=f),p.readyState=p.DONE,d(),u(f)}()},h=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(e,t,r){return new l(e,t||e.name||"download",r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);n.exports?n.exports.saveAs=de:null!==r(54)&&null!==r(55)&&void 0!==(o=function(){return de}.call(t,r,t,n))&&(n.exports=o),c.isCordova||c.isMeteorServer||c.isNode,s.utils.saveAs=de}return new M("alasql"),s.use("alasql"),s},void 0===(o="function"==typeof s?s.apply(t,i):s)||(n.exports=o)}).call(this,r(36),r(19)(e),r(27))},54:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},55:function(e,t){(function(t){e.exports=t}).call(this,{})}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:ca0fee1ac29278e703ebd32e6f41596a', location = 'build/ca0fee1ac29278e703eb.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[14],{1:function(t,n,e){"use strict";var r="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},a=function(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),i.hasOwnProperty(n)?{space:i[n],local:t}:t};function o(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===r&&n.documentElement.namespaceURI===r?n.createElement(t):n.createElementNS(e,t)}}function u(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var s=function(t){var n=a(t);return(n.local?u:o)(n)};function c(){}var f=function(t){return null==t?c:function(){return this.querySelector(t)}};function l(){return[]}var h=function(t){return null==t?l:function(){return this.querySelectorAll(t)}},d=function(t){return function(){return this.matches(t)}},p=function(t){return new Array(t.length)};function y(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}y.prototype={constructor:y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var v="$";function g(t,n,e,r,i,a){for(var o,u=0,s=n.length,c=a.length;u<c;++u)(o=n[u])?(o.__data__=a[u],r[u]=o):e[u]=new y(t,a[u]);for(;u<s;++u)(o=n[u])&&(i[u]=o)}function m(t,n,e,r,i,a,o){var u,s,c,f={},l=n.length,h=a.length,d=new Array(l);for(u=0;u<l;++u)(s=n[u])&&(d[u]=c=v+o.call(s,s.__data__,u,n),c in f?i[u]=s:f[c]=s);for(u=0;u<h;++u)(s=f[c=v+o.call(t,a[u],u,a)])?(r[u]=s,s.__data__=a[u],f[c]=null):e[u]=new y(t,a[u]);for(u=0;u<l;++u)(s=n[u])&&f[d[u]]===s&&(i[u]=s)}function b(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function x(t){return function(){this.removeAttribute(t)}}function _(t){return function(){this.removeAttributeNS(t.space,t.local)}}function w(t,n){return function(){this.setAttribute(t,n)}}function M(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function E(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function P(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}var T=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function C(t){return function(){this.style.removeProperty(t)}}function k(t,n,e){return function(){this.style.setProperty(t,n,e)}}function S(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function A(t,n){return t.style.getPropertyValue(n)||T(t).getComputedStyle(t,null).getPropertyValue(n)}function N(t){return function(){delete this[t]}}function B(t,n){return function(){this[t]=n}}function z(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function D(t){return t.trim().split(/^|\s+/)}function R(t){return t.classList||new O(t)}function O(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function V(t,n){for(var e=R(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function L(t,n){for(var e=R(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function I(t){return function(){V(this,t)}}function q(t){return function(){L(this,t)}}function U(t,n){return function(){(n.apply(this,arguments)?V:L)(this,t)}}O.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function F(){this.textContent=""}function j(t){return function(){this.textContent=t}}function Y(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function X(){this.innerHTML=""}function H(t){return function(){this.innerHTML=t}}function G(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function W(){this.nextSibling&&this.parentNode.appendChild(this)}function $(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function Z(){var t=this.parentNode;t&&t.removeChild(this)}function J(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function K(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var tt={},nt=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(tt={mouseenter:"mouseover",mouseleave:"mouseout"}));function et(t,n,e){return t=rt(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function rt(t,n,e){return function(r){var i=nt;nt=r;try{t.call(this,this.__data__,n,e)}finally{nt=i}}}function it(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function at(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,a=n.length;r<a;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function ot(t,n,e){var r=tt.hasOwnProperty(t.type)?et:rt;return function(i,a,o){var u,s=this.__on,c=r(n,a,o);if(s)for(var f=0,l=s.length;f<l;++f)if((u=s[f]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=e),void(u.value=n);this.addEventListener(t.type,c,e),u={type:t.type,name:t.name,value:n,listener:c,capture:e},s?s.push(u):this.__on=[u]}}function ut(t,n,e,r){var i=nt;t.sourceEvent=nt,nt=t;try{return n.apply(e,r)}finally{nt=i}}function st(t,n,e){var r=T(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function ct(t,n){return function(){return st(this,t,n)}}function ft(t,n){return function(){return st(this,t,n.apply(this,arguments))}}var lt=[null];function ht(t,n){this._groups=t,this._parents=n}function dt(){return new ht([[document.documentElement]],lt)}ht.prototype=dt.prototype={constructor:ht,select:function(t){"function"!=typeof t&&(t=f(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o,u=n[i],s=u.length,c=r[i]=new Array(s),l=0;l<s;++l)(a=u[l])&&(o=t.call(a,a.__data__,l,u))&&("__data__"in a&&(o.__data__=a.__data__),c[l]=o);return new ht(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=h(t));for(var n=this._groups,e=n.length,r=[],i=[],a=0;a<e;++a)for(var o,u=n[a],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(t.call(o,o.__data__,c,u)),i.push(o));return new ht(r,i)},filter:function(t){"function"!=typeof t&&(t=d(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],u=o.length,s=r[i]=[],c=0;c<u;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&s.push(a);return new ht(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),f=-1,this.each((function(t){p[++f]=t})),p;var e,r=n?m:g,i=this._parents,a=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var o=a.length,u=new Array(o),s=new Array(o),c=new Array(o),f=0;f<o;++f){var l=i[f],h=a[f],d=h.length,p=t.call(l,l&&l.__data__,f,i),y=p.length,v=s[f]=new Array(y),b=u[f]=new Array(y);r(l,h,v,b,c[f]=new Array(d),p,n);for(var x,_,w=0,M=0;w<y;++w)if(x=v[w]){for(w>=M&&(M=w+1);!(_=b[M])&&++M<y;);x._next=_||null}}return(u=new ht(u,i))._enter=s,u._exit=c,u},enter:function(){return new ht(this._enter||this._groups.map(p),this._parents)},exit:function(){return new ht(this._exit||this._groups.map(p),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?a.remove():e(a),r&&i?r.merge(i).order():i},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s,c=n[u],f=e[u],l=c.length,h=o[u]=new Array(l),d=0;d<l;++d)(s=c[d]||f[d])&&(h[d]=s);for(;u<r;++u)o[u]=n[u];return new ht(o,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=b);for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var o,u=e[a],s=u.length,c=i[a]=new Array(s),f=0;f<s;++f)(o=u[f])&&(c[f]=o);c.sort(n)}return new ht(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,a=n[e],o=0,u=a.length;o<u;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,n){var e=a(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?_:x:"function"==typeof n?e.local?P:E:e.local?M:w)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?C:"function"==typeof n?S:k)(t,n,null==e?"":e)):A(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?N:"function"==typeof n?z:B)(t,n)):this.node()[t]},classed:function(t,n){var e=D(t+"");if(arguments.length<2){for(var r=R(this.node()),i=-1,a=e.length;++i<a;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?U:n?I:q)(e,n))},text:function(t){return arguments.length?this.each(null==t?F:("function"==typeof t?Y:j)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?G:H)(t)):this.node().innerHTML},raise:function(){return this.each(W)},lower:function(){return this.each($)},append:function(t){var n="function"==typeof t?t:s(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:s(t),r=null==n?Q:"function"==typeof n?n:f(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Z)},clone:function(t){return this.select(t?K:J)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,a=it(t+""),o=a.length;if(!(arguments.length<2)){for(u=n?ot:at,null==e&&(e=!1),r=0;r<o;++r)this.each(u(a[r],n,e));return this}var u=this.node().__on;if(u)for(var s,c=0,f=u.length;c<f;++c)for(r=0,s=u[c];r<o;++r)if((i=a[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,n){return this.each(("function"==typeof n?ft:ct)(t,n))}};var pt=dt,yt=function(t){return"string"==typeof t?new ht([[document.querySelector(t)]],[document.documentElement]):new ht([[t]],lt)},vt=function(t){return yt(s(t).call(document.documentElement))},gt=0;function mt(){return new bt}function bt(){this._="@"+(++gt).toString(36)}bt.prototype=mt.prototype={constructor:bt,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var xt=function(){for(var t,n=nt;t=n.sourceEvent;)n=t;return n},_t=function(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]},wt=function(t){var n=xt();return n.changedTouches&&(n=n.changedTouches[0]),_t(t,n)},Mt=function(t){return"string"==typeof t?new ht([document.querySelectorAll(t)],[document.documentElement]):new ht([null==t?[]:t],lt)},Et=function(t,n,e){arguments.length<3&&(e=n,n=xt().changedTouches);for(var r,i=0,a=n?n.length:0;i<a;++i)if((r=n[i]).identifier===e)return _t(t,r);return null},Pt=function(t,n){null==n&&(n=xt().touches);for(var e=0,r=n?n.length:0,i=new Array(r);e<r;++e)i[e]=_t(t,n[e]);return i};e.d(n,"b",(function(){return vt})),e.d(n,"c",(function(){return s})),e.d(n,"f",(function(){return mt})),e.d(n,"g",(function(){return d})),e.d(n,"h",(function(){return wt})),e.d(n,"i",(function(){return a})),e.d(n,"j",(function(){return i})),e.d(n,"a",(function(){return _t})),e.d(n,"k",(function(){return yt})),e.d(n,"l",(function(){return Mt})),e.d(n,"m",(function(){return pt})),e.d(n,"n",(function(){return f})),e.d(n,"o",(function(){return h})),e.d(n,"p",(function(){return A})),e.d(n,"q",(function(){return Et})),e.d(n,"r",(function(){return Pt})),e.d(n,"s",(function(){return T})),e.d(n,"e",(function(){return nt})),e.d(n,"d",(function(){return ut}))},17:function(t,n,e){"use strict";e.r(n);var r=function(t,n){return t<n?-1:t>n?1:t>=n?0:NaN},i=function(t){var n;return 1===t.length&&(n=t,t=function(t,e){return r(n(t),e)}),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var a=r+i>>>1;t(n[a],e)<0?r=a+1:i=a}return r},right:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var a=r+i>>>1;t(n[a],e)>0?i=a:r=a+1}return r}}};var a=i(r),o=a.right,u=a.left,s=o,c=function(t,n){null==n&&(n=f);for(var e=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);e<r;)a[e]=n(i,i=t[++e]);return a};function f(t,n){return[t,n]}var l=function(t,n,e){var r,i,a,o,u=t.length,s=n.length,c=new Array(u*s);for(null==e&&(e=f),r=a=0;r<u;++r)for(o=t[r],i=0;i<s;++i,++a)c[a]=e(o,n[i]);return c},h=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},d=function(t){return null===t?NaN:+t},p=function(t,n){var e,r,i=t.length,a=0,o=-1,u=0,s=0;if(null==n)for(;++o<i;)isNaN(e=d(t[o]))||(s+=(r=e-u)*(e-(u+=r/++a)));else for(;++o<i;)isNaN(e=d(n(t[o],o,t)))||(s+=(r=e-u)*(e-(u+=r/++a)));if(a>1)return s/(a-1)},y=function(t,n){var e=p(t,n);return e?Math.sqrt(e):e},v=function(t,n){var e,r,i,a=t.length,o=-1;if(null==n){for(;++o<a;)if(null!=(e=t[o])&&e>=e)for(r=i=e;++o<a;)null!=(e=t[o])&&(r>e&&(r=e),i<e&&(i=e))}else for(;++o<a;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=i=e;++o<a;)null!=(e=n(t[o],o,t))&&(r>e&&(r=e),i<e&&(i=e));return[r,i]},g=Array.prototype,m=g.slice,b=g.map,x=function(t){return function(){return t}},_=function(t){return t},w=function(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),a=new Array(i);++r<i;)a[r]=t+r*e;return a},M=Math.sqrt(50),E=Math.sqrt(10),P=Math.sqrt(2),T=function(t,n,e){var r,i,a,o,u=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(o=C(t,n,e))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),n=Math.floor(n/o),a=new Array(i=Math.ceil(n-t+1));++u<i;)a[u]=(t+u)*o;else for(t=Math.floor(t*o),n=Math.ceil(n*o),a=new Array(i=Math.ceil(t-n+1));++u<i;)a[u]=(t-u)/o;return r&&a.reverse(),a};function C(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=M?10:a>=E?5:a>=P?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=M?10:a>=E?5:a>=P?2:1)}function k(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=M?i*=10:a>=E?i*=5:a>=P&&(i*=2),n<t?-i:i}var S=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},A=function(){var t=_,n=v,e=S;function r(r){var i,a,o=r.length,u=new Array(o);for(i=0;i<o;++i)u[i]=t(r[i],i,r);var c=n(u),f=c[0],l=c[1],h=e(u,f,l);Array.isArray(h)||(h=k(f,l,h),h=w(Math.ceil(f/h)*h,l,h));for(var d=h.length;h[0]<=f;)h.shift(),--d;for(;h[d-1]>l;)h.pop(),--d;var p,y=new Array(d+1);for(i=0;i<=d;++i)(p=y[i]=[]).x0=i>0?h[i-1]:f,p.x1=i<d?h[i]:l;for(i=0;i<o;++i)f<=(a=u[i])&&a<=l&&y[s(h,a,0,d)].push(r[i]);return y}return r.value=function(n){return arguments.length?(t="function"==typeof n?n:x(n),r):t},r.domain=function(t){return arguments.length?(n="function"==typeof t?t:x([t[0],t[1]]),r):n},r.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?x(m.call(t)):x(t),r):e},r},N=function(t,n,e){if(null==e&&(e=d),r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,a=Math.floor(i),o=+e(t[a],a,t);return o+(+e(t[a+1],a+1,t)-o)*(i-a)}},B=function(t,n,e){return t=b.call(t,d).sort(r),Math.ceil((e-n)/(2*(N(t,.75)-N(t,.25))*Math.pow(t.length,-1/3)))},z=function(t,n,e){return Math.ceil((e-n)/(3.5*y(t)*Math.pow(t.length,-1/3)))},D=function(t,n){var e,r,i=t.length,a=-1;if(null==n){for(;++a<i;)if(null!=(e=t[a])&&e>=e)for(r=e;++a<i;)null!=(e=t[a])&&e>r&&(r=e)}else for(;++a<i;)if(null!=(e=n(t[a],a,t))&&e>=e)for(r=e;++a<i;)null!=(e=n(t[a],a,t))&&e>r&&(r=e);return r},R=function(t,n){var e,r=t.length,i=r,a=-1,o=0;if(null==n)for(;++a<r;)isNaN(e=d(t[a]))?--i:o+=e;else for(;++a<r;)isNaN(e=d(n(t[a],a,t)))?--i:o+=e;if(i)return o/i},O=function(t,n){var e,i=t.length,a=-1,o=[];if(null==n)for(;++a<i;)isNaN(e=d(t[a]))||o.push(e);else for(;++a<i;)isNaN(e=d(n(t[a],a,t)))||o.push(e);return N(o.sort(r),.5)},V=function(t){for(var n,e,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(e=new Array(o);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--o]=r[n];return e},L=function(t,n){var e,r,i=t.length,a=-1;if(null==n){for(;++a<i;)if(null!=(e=t[a])&&e>=e)for(r=e;++a<i;)null!=(e=t[a])&&r>e&&(r=e)}else for(;++a<i;)if(null!=(e=n(t[a],a,t))&&e>=e)for(r=e;++a<i;)null!=(e=n(t[a],a,t))&&r>e&&(r=e);return r},I=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},q=function(t,n){if(e=t.length){var e,i,a=0,o=0,u=t[o];for(null==n&&(n=r);++a<e;)(n(i=t[a],u)<0||0!==n(u,u))&&(u=i,o=a);return 0===n(u,u)?o:void 0}},U=function(t,n,e){for(var r,i,a=(null==e?t.length:e)-(n=null==n?0:+n);a;)i=Math.random()*a--|0,r=t[a+n],t[a+n]=t[i+n],t[i+n]=r;return t},F=function(t,n){var e,r=t.length,i=-1,a=0;if(null==n)for(;++i<r;)(e=+t[i])&&(a+=e);else for(;++i<r;)(e=+n(t[i],i,t))&&(a+=e);return a},j=function(t){if(!(i=t.length))return[];for(var n=-1,e=L(t,Y),r=new Array(e);++n<e;)for(var i,a=-1,o=r[n]=new Array(i);++a<i;)o[a]=t[a][n];return r};function Y(t){return t.length}var X=function(){return j(arguments)},H=Array.prototype.slice,G=function(t){return t},W=1,$=2,Q=3,Z=4,J=1e-6;function K(t){return"translate("+(t+.5)+",0)"}function tt(t){return"translate(0,"+(t+.5)+")"}function nt(t){return function(n){return+t(n)}}function et(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}function rt(){return!this.__axis}function it(t,n){var e=[],r=null,i=null,a=6,o=6,u=3,s=t===W||t===Z?-1:1,c=t===Z||t===$?"x":"y",f=t===W||t===Q?K:tt;function l(l){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,d=null==i?n.tickFormat?n.tickFormat.apply(n,e):G:i,p=Math.max(a,0)+u,y=n.range(),v=+y[0]+.5,g=+y[y.length-1]+.5,m=(n.bandwidth?et:nt)(n.copy()),b=l.selection?l.selection():l,x=b.selectAll(".domain").data([null]),_=b.selectAll(".tick").data(h,n).order(),w=_.exit(),M=_.enter().append("g").attr("class","tick"),E=_.select("line"),P=_.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(M),E=E.merge(M.append("line").attr("stroke","currentColor").attr(c+"2",s*a)),P=P.merge(M.append("text").attr("fill","currentColor").attr(c,s*p).attr("dy",t===W?"0em":t===Q?"0.71em":"0.32em")),l!==b&&(x=x.transition(l),_=_.transition(l),E=E.transition(l),P=P.transition(l),w=w.transition(l).attr("opacity",J).attr("transform",(function(t){return isFinite(t=m(t))?f(t):this.getAttribute("transform")})),M.attr("opacity",J).attr("transform",(function(t){var n=this.parentNode.__axis;return f(n&&isFinite(n=n(t))?n:m(t))}))),w.remove(),x.attr("d",t===Z||t==$?o?"M"+s*o+","+v+"H0.5V"+g+"H"+s*o:"M0.5,"+v+"V"+g:o?"M"+v+","+s*o+"V0.5H"+g+"V"+s*o:"M"+v+",0.5H"+g),_.attr("opacity",1).attr("transform",(function(t){return f(m(t))})),E.attr(c+"2",s*a),P.attr(c,s*p).text(d),b.filter(rt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===$?"start":t===Z?"end":"middle"),b.each((function(){this.__axis=m}))}return l.scale=function(t){return arguments.length?(n=t,l):n},l.ticks=function(){return e=H.call(arguments),l},l.tickArguments=function(t){return arguments.length?(e=null==t?[]:H.call(t),l):e.slice()},l.tickValues=function(t){return arguments.length?(r=null==t?null:H.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(i=t,l):i},l.tickSize=function(t){return arguments.length?(a=o=+t,l):a},l.tickSizeInner=function(t){return arguments.length?(a=+t,l):a},l.tickSizeOuter=function(t){return arguments.length?(o=+t,l):o},l.tickPadding=function(t){return arguments.length?(u=+t,l):u},l}function at(t){return it(W,t)}function ot(t){return it($,t)}function ut(t){return it(Q,t)}function st(t){return it(Z,t)}var ct={value:function(){}};function ft(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new lt(r)}function lt(t){this._=t}function ht(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function dt(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function pt(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=ct,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}lt.prototype=ft.prototype={constructor:lt,on:function(t,n){var e,r=this._,i=ht(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<o;)if(e=(t=i[a]).type)r[e]=pt(r[e],t.name,n);else if(null==n)for(e in r)r[e]=pt(r[e],t.name,null);return this}for(;++a<o;)if((e=(t=i[a]).type)&&(e=dt(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new lt(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),a=0;a<e;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,e=(r=this._[t]).length;a<e;++a)r[a].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};var yt=ft,vt=e(1);function gt(){vt.e.stopImmediatePropagation()}var mt=function(){vt.e.preventDefault(),vt.e.stopImmediatePropagation()},bt=function(t){var n=t.document.documentElement,e=Object(vt.k)(t).on("dragstart.drag",mt,!0);"onselectstart"in n?e.on("selectstart.drag",mt,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")};function xt(t,n){var e=t.document.documentElement,r=Object(vt.k)(t).on("dragstart.drag",null);n&&(r.on("click.drag",mt,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}var _t=function(t){return function(){return t}};function wt(t,n,e,r,i,a,o,u,s,c){this.target=t,this.type=n,this.subject=e,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=u,this.dy=s,this._=c}function Mt(){return!vt.e.ctrlKey&&!vt.e.button}function Et(){return this.parentNode}function Pt(t){return null==t?{x:vt.e.x,y:vt.e.y}:t}function Tt(){return navigator.maxTouchPoints||"ontouchstart"in this}wt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Ct=function(){var t,n,e,r,i=Mt,a=Et,o=Pt,u=Tt,s={},c=yt("start","drag","end"),f=0,l=0;function h(t){t.on("mousedown.drag",d).filter(u).on("touchstart.drag",v).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(){if(!r&&i.apply(this,arguments)){var o=b("mouse",a.apply(this,arguments),vt.h,this,arguments);o&&(Object(vt.k)(vt.e.view).on("mousemove.drag",p,!0).on("mouseup.drag",y,!0),bt(vt.e.view),gt(),e=!1,t=vt.e.clientX,n=vt.e.clientY,o("start"))}}function p(){if(mt(),!e){var r=vt.e.clientX-t,i=vt.e.clientY-n;e=r*r+i*i>l}s.mouse("drag")}function y(){Object(vt.k)(vt.e.view).on("mousemove.drag mouseup.drag",null),xt(vt.e.view,e),mt(),s.mouse("end")}function v(){if(i.apply(this,arguments)){var t,n,e=vt.e.changedTouches,r=a.apply(this,arguments),o=e.length;for(t=0;t<o;++t)(n=b(e[t].identifier,r,vt.q,this,arguments))&&(gt(),n("start"))}}function g(){var t,n,e=vt.e.changedTouches,r=e.length;for(t=0;t<r;++t)(n=s[e[t].identifier])&&(mt(),n("drag"))}function m(){var t,n,e=vt.e.changedTouches,i=e.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(n=s[e[t].identifier])&&(gt(),n("end"))}function b(t,n,e,r,i){var a,u,l,d=e(n,t),p=c.copy();if(Object(vt.d)(new wt(h,"beforestart",a,t,f,d[0],d[1],0,0,p),(function(){return null!=(vt.e.subject=a=o.apply(r,i))&&(u=a.x-d[0]||0,l=a.y-d[1]||0,!0)})))return function o(c){var y,v=d;switch(c){case"start":s[t]=o,y=f++;break;case"end":delete s[t],--f;case"drag":d=e(n,t),y=f}Object(vt.d)(new wt(h,c,a,t,y,d[0]+u,d[1]+l,d[0]-v[0],d[1]-v[1],p),p.apply,p,[c,r,i])}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:_t(!!t),h):i},h.container=function(t){return arguments.length?(a="function"==typeof t?t:_t(t),h):a},h.subject=function(t){return arguments.length?(o="function"==typeof t?t:_t(t),h):o},h.touchable=function(t){return arguments.length?(u="function"==typeof t?t:_t(!!t),h):u},h.on=function(){var t=c.on.apply(c,arguments);return t===c?h:t},h.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,h):Math.sqrt(l)},h},kt=function(t,n,e){t.prototype=n.prototype=e,e.constructor=t};function St(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function At(){}var Nt="\\s*([+-]?\\d+)\\s*",Bt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dt=/^#([0-9a-f]{3,8})$/,Rt=new RegExp("^rgb\\("+[Nt,Nt,Nt]+"\\)$"),Ot=new RegExp("^rgb\\("+[zt,zt,zt]+"\\)$"),Vt=new RegExp("^rgba\\("+[Nt,Nt,Nt,Bt]+"\\)$"),Lt=new RegExp("^rgba\\("+[zt,zt,zt,Bt]+"\\)$"),It=new RegExp("^hsl\\("+[Bt,zt,zt]+"\\)$"),qt=new RegExp("^hsla\\("+[Bt,zt,zt,Bt]+"\\)$"),Ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ft(){return this.rgb().formatHex()}function jt(){return this.rgb().formatRgb()}function Yt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Dt.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Xt(n):3===e?new $t(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?new $t(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?new $t(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Rt.exec(t))?new $t(n[1],n[2],n[3],1):(n=Ot.exec(t))?new $t(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Vt.exec(t))?Ht(n[1],n[2],n[3],n[4]):(n=Lt.exec(t))?Ht(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=It.exec(t))?Kt(n[1],n[2]/100,n[3]/100,1):(n=qt.exec(t))?Kt(n[1],n[2]/100,n[3]/100,n[4]):Ut.hasOwnProperty(t)?Xt(Ut[t]):"transparent"===t?new $t(NaN,NaN,NaN,0):null}function Xt(t){return new $t(t>>16&255,t>>8&255,255&t,1)}function Ht(t,n,e,r){return r<=0&&(t=n=e=NaN),new $t(t,n,e,r)}function Gt(t){return t instanceof At||(t=Yt(t)),t?new $t((t=t.rgb()).r,t.g,t.b,t.opacity):new $t}function Wt(t,n,e,r){return 1===arguments.length?Gt(t):new $t(t,n,e,null==r?1:r)}function $t(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function Qt(){return"#"+Jt(this.r)+Jt(this.g)+Jt(this.b)}function Zt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Jt(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Kt(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new en(t,n,e,r)}function tn(t){if(t instanceof en)return new en(t.h,t.s,t.l,t.opacity);if(t instanceof At||(t=Yt(t)),!t)return new en;if(t instanceof en)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),a=Math.max(n,e,r),o=NaN,u=a-i,s=(a+i)/2;return u?(o=n===a?(e-r)/u+6*(e<r):e===a?(r-n)/u+2:(n-e)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new en(o,u,s,t.opacity)}function nn(t,n,e,r){return 1===arguments.length?tn(t):new en(t,n,e,null==r?1:r)}function en(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function rn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function an(t,n,e,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*n+(4-6*a+3*o)*e+(1+3*t+3*a-3*o)*r+o*i)/6}kt(At,Yt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ft,formatHex:Ft,formatHsl:function(){return tn(this).formatHsl()},formatRgb:jt,toString:jt}),kt($t,Wt,St(At,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new $t(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qt,formatHex:Qt,formatRgb:Zt,toString:Zt})),kt(en,nn,St(At,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new en(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new en(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new $t(rn(t>=240?t-240:t+120,i,r),rn(t,i,r),rn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var on=function(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,u=r<n-1?t[r+2]:2*a-i;return an((e-r/n)*n,o,i,a,u)}},un=function(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],a=t[r%n],o=t[(r+1)%n],u=t[(r+2)%n];return an((e-r/n)*n,i,a,o,u)}},sn=function(t){return function(){return t}};function cn(t,n){return function(e){return t+e*n}}function fn(t,n){var e=n-t;return e?cn(t,e>180||e<-180?e-360*Math.round(e/360):e):sn(isNaN(t)?n:t)}function ln(t){return 1==(t=+t)?hn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):sn(isNaN(n)?e:n)}}function hn(t,n){var e=n-t;return e?cn(t,e):sn(isNaN(t)?n:t)}var dn=function t(n){var e=ln(n);function r(t,n){var r=e((t=Wt(t)).r,(n=Wt(n)).r),i=e(t.g,n.g),a=e(t.b,n.b),o=hn(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=a(n),t.opacity=o(n),t+""}}return r.gamma=t,r}(1);function pn(t){return function(n){var e,r,i=n.length,a=new Array(i),o=new Array(i),u=new Array(i);for(e=0;e<i;++e)r=Wt(n[e]),a[e]=r.r||0,o[e]=r.g||0,u[e]=r.b||0;return a=t(a),o=t(o),u=t(u),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=u(t),r+""}}}var yn=pn(on),vn=pn(un),gn=function(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(e=0;e<i;++e)a[e]=kn(t[e],n[e]);for(;e<r;++e)o[e]=n[e];return function(t){for(e=0;e<i;++e)o[e]=a[e](t);return o}},mn=function(t,n){var e=new Date;return n-=t=+t,function(r){return e.setTime(t+n*r),e}},bn=function(t,n){return n-=t=+t,function(e){return t+n*e}},xn=function(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=kn(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}},_n=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wn=new RegExp(_n.source,"g");var Mn,En,Pn,Tn,Cn=function(t,n){var e,r,i,a=_n.lastIndex=wn.lastIndex=0,o=-1,u=[],s=[];for(t+="",n+="";(e=_n.exec(t))&&(r=wn.exec(n));)(i=r.index)>a&&(i=n.slice(a,i),u[o]?u[o]+=i:u[++o]=i),(e=e[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:bn(e,r)})),a=wn.lastIndex;return a<n.length&&(i=n.slice(a),u[o]?u[o]+=i:u[++o]=i),u.length<2?s[0]?function(t){return function(n){return t(n)+""}}(s[0].x):function(t){return function(){return t}}(n):(n=s.length,function(t){for(var e,r=0;r<n;++r)u[(e=s[r]).i]=e.x(t);return u.join("")})},kn=function(t,n){var e,r=typeof n;return null==n||"boolean"===r?sn(n):("number"===r?bn:"string"===r?(e=Yt(n))?(n=e,dn):Cn:n instanceof Yt?dn:n instanceof Date?mn:Array.isArray(n)?gn:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?xn:bn)(t,n)},Sn=function(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}},An=function(t,n){var e=fn(+t,+n);return function(t){var n=e(t);return n-360*Math.floor(n/360)}},Nn=function(t,n){return n-=t=+t,function(e){return Math.round(t+n*e)}},Bn=180/Math.PI,zn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Dn=function(t,n,e,r,i,a){var o,u,s;return(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o),(s=t*e+n*r)&&(e-=t*s,r-=n*s),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,s/=u),t*r<n*e&&(t=-t,n=-n,s=-s,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(n,t)*Bn,skewX:Math.atan(s)*Bn,scaleX:o,scaleY:u}};function Rn(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var u=[],s=[];return a=t(a),o=t(o),function(t,r,i,a,o,u){if(t!==i||r!==a){var s=o.push("translate(",null,n,null,e);u.push({i:s-4,x:bn(t,i)},{i:s-2,x:bn(r,a)})}else(i||a)&&o.push("translate("+i+n+a+e)}(a.translateX,a.translateY,o.translateX,o.translateY,u,s),function(t,n,e,a){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),a.push({i:e.push(i(e)+"rotate(",null,r)-2,x:bn(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(a.rotate,o.rotate,u,s),function(t,n,e,a){t!==n?a.push({i:e.push(i(e)+"skewX(",null,r)-2,x:bn(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(a.skewX,o.skewX,u,s),function(t,n,e,r,a,o){if(t!==e||n!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:bn(t,e)},{i:u-2,x:bn(n,r)})}else 1===e&&1===r||a.push(i(a)+"scale("+e+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,u,s),a=o=null,function(t){for(var n,e=-1,r=s.length;++e<r;)u[(n=s[e]).i]=n.x(t);return u.join("")}}}var On=Rn((function(t){return"none"===t?zn:(Mn||(Mn=document.createElement("DIV"),En=document.documentElement,Pn=document.defaultView),Mn.style.transform=t,t=Pn.getComputedStyle(En.appendChild(Mn),null).getPropertyValue("transform"),En.removeChild(Mn),t=t.slice(7,-1).split(","),Dn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),Vn=Rn((function(t){return null==t?zn:(Tn||(Tn=document.createElementNS("http://www.w3.org/2000/svg","g")),Tn.setAttribute("transform",t),(t=Tn.transform.baseVal.consolidate())?(t=t.matrix,Dn(t.a,t.b,t.c,t.d,t.e,t.f)):zn)}),", ",")",")"),Ln=Math.SQRT2;function In(t){return((t=Math.exp(t))+1/t)/2}var qn=function(t,n){var e,r,i=t[0],a=t[1],o=t[2],u=n[0],s=n[1],c=n[2],f=u-i,l=s-a,h=f*f+l*l;if(h<1e-12)r=Math.log(c/o)/Ln,e=function(t){return[i+t*f,a+t*l,o*Math.exp(Ln*t*r)]};else{var d=Math.sqrt(h),p=(c*c-o*o+4*h)/(2*o*2*d),y=(c*c-o*o-4*h)/(2*c*2*d),v=Math.log(Math.sqrt(p*p+1)-p),g=Math.log(Math.sqrt(y*y+1)-y);r=(g-v)/Ln,e=function(t){var n,e=t*r,u=In(v),s=o/(2*d)*(u*(n=Ln*e+v,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[i+s*f,a+s*l,o*u/In(Ln*e+v)]}}return e.duration=1e3*r,e};function Un(t){return function(n,e){var r=t((n=nn(n)).h,(e=nn(e)).h),i=hn(n.s,e.s),a=hn(n.l,e.l),o=hn(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=a(t),n.opacity=o(t),n+""}}}var Fn=Un(fn),jn=Un(hn),Yn=Math.PI/180,Xn=180/Math.PI,Hn=.96422,Gn=1,Wn=.82521,$n=4/29,Qn=6/29,Zn=3*Qn*Qn,Jn=Qn*Qn*Qn;function Kn(t){if(t instanceof ee)return new ee(t.l,t.a,t.b,t.opacity);if(t instanceof fe)return le(t);t instanceof $t||(t=Gt(t));var n,e,r=oe(t.r),i=oe(t.g),a=oe(t.b),o=re((.2225045*r+.7168786*i+.0606169*a)/Gn);return r===i&&i===a?n=e=o:(n=re((.4360747*r+.3850649*i+.1430804*a)/Hn),e=re((.0139322*r+.0971045*i+.7141733*a)/Wn)),new ee(116*o-16,500*(n-o),200*(o-e),t.opacity)}function te(t,n){return new ee(t,0,0,null==n?1:n)}function ne(t,n,e,r){return 1===arguments.length?Kn(t):new ee(t,n,e,null==r?1:r)}function ee(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function re(t){return t>Jn?Math.pow(t,1/3):t/Zn+$n}function ie(t){return t>Qn?t*t*t:Zn*(t-$n)}function ae(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function oe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ue(t){if(t instanceof fe)return new fe(t.h,t.c,t.l,t.opacity);if(t instanceof ee||(t=Kn(t)),0===t.a&&0===t.b)return new fe(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*Xn;return new fe(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function se(t,n,e,r){return 1===arguments.length?ue(t):new fe(e,n,t,null==r?1:r)}function ce(t,n,e,r){return 1===arguments.length?ue(t):new fe(t,n,e,null==r?1:r)}function fe(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}function le(t){if(isNaN(t.h))return new ee(t.l,0,0,t.opacity);var n=t.h*Yn;return new ee(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}function he(t,n){var e=hn((t=ne(t)).l,(n=ne(n)).l),r=hn(t.a,n.a),i=hn(t.b,n.b),a=hn(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=a(n),t+""}}function de(t){return function(n,e){var r=t((n=ce(n)).h,(e=ce(e)).h),i=hn(n.c,e.c),a=hn(n.l,e.l),o=hn(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=a(t),n.opacity=o(t),n+""}}}kt(ee,ne,St(At,{brighter:function(t){return new ee(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ee(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new $t(ae(3.1338561*(n=Hn*ie(n))-1.6168667*(t=Gn*ie(t))-.4906146*(e=Wn*ie(e))),ae(-.9787684*n+1.9161415*t+.033454*e),ae(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),kt(fe,ce,St(At,{brighter:function(t){return new fe(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new fe(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return le(this).rgb()}}));var pe=de(fn),ye=de(hn),ve=-.29227,ge=-.90649,me=1.97294,be=me*ge,xe=1.78277*me,_e=1.78277*ve- -.14861*ge;function we(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof Me)return new Me(t.h,t.s,t.l,t.opacity);t instanceof $t||(t=Gt(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(_e*r+be*n-xe*e)/(_e+be-xe),a=r-i,o=(me*(e-i)-ve*a)/ge,u=Math.sqrt(o*o+a*a)/(me*i*(1-i)),s=u?Math.atan2(o,a)*Xn-120:NaN;return new Me(s<0?s+360:s,u,i,t.opacity)}(t):new Me(t,n,e,null==r?1:r)}function Me(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Ee(t){return function n(e){function r(n,r){var i=t((n=we(n)).h,(r=we(r)).h),a=hn(n.s,r.s),o=hn(n.l,r.l),u=hn(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=a(t),n.l=o(Math.pow(t,e)),n.opacity=u(t),n+""}}return e=+e,r.gamma=n,r}(1)}kt(Me,we,St(At,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Me(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Me(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Yn,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new $t(255*(n+e*(-.14861*r+1.78277*i)),255*(n+e*(ve*r+ge*i)),255*(n+e*(me*r)),this.opacity)}}));var Pe=Ee(fn),Te=Ee(hn);function Ce(t,n){for(var e=0,r=n.length-1,i=n[0],a=new Array(r<0?0:r);e<r;)a[e]=t(i,i=n[++e]);return function(t){var n=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[n](t-n)}}var ke,Se,Ae=function(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e},Ne=0,Be=0,ze=0,De=1e3,Re=0,Oe=0,Ve=0,Le="object"==typeof performance&&performance.now?performance:Date,Ie="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qe(){return Oe||(Ie(Ue),Oe=Le.now()+Ve)}function Ue(){Oe=0}function Fe(){this._call=this._time=this._next=null}function je(t,n,e){var r=new Fe;return r.restart(t,n,e),r}function Ye(){qe(),++Ne;for(var t,n=ke;n;)(t=Oe-n._time)>=0&&n._call.call(null,t),n=n._next;--Ne}function Xe(){Oe=(Re=Le.now())+Ve,Ne=Be=0;try{Ye()}finally{Ne=0,function(){var t,n,e=ke,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ke=n);Se=t,Ge(r)}(),Oe=0}}function He(){var t=Le.now(),n=t-Re;n>De&&(Ve-=n,Re=t)}function Ge(t){Ne||(Be&&(Be=clearTimeout(Be)),t-Oe>24?(t<1/0&&(Be=setTimeout(Xe,t-Le.now()-Ve)),ze&&(ze=clearInterval(ze))):(ze||(Re=Le.now(),ze=setInterval(He,De)),Ne=1,Ie(Xe)))}Fe.prototype=je.prototype={constructor:Fe,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?qe():+e)+(null==n?0:+n),this._next||Se===this||(Se?Se._next=this:ke=this,Se=this),this._call=t,this._time=e,Ge()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ge())}};var We=function(t,n,e){var r=new Fe;return n=null==n?0:+n,r.restart((function(e){r.stop(),t(e+n)}),n,e),r},$e=function(t,n,e){var r=new Fe,i=n;return null==n?(r.restart(t,n,e),r):(n=+n,e=null==e?qe():+e,r.restart((function a(o){o+=i,r.restart(a,i+=n,e),t(o)}),n,e),r)},Qe=yt("start","end","cancel","interrupt"),Ze=[],Je=0,Ke=1,tr=2,nr=3,er=4,rr=5,ir=6,ar=function(t,n,e,r,i,a){var o=t.__transition;if(o){if(e in o)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function a(s){var c,f,l,h;if(e.state!==Ke)return u();for(c in i)if((h=i[c]).name===e.name){if(h.state===nr)return We(a);h.state===er?(h.state=ir,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[c]):+c<n&&(h.state=ir,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[c])}if(We((function(){e.state===nr&&(e.state=er,e.timer.restart(o,e.delay,e.time),o(s))})),e.state=tr,e.on.call("start",t,t.__data__,e.index,e.group),e.state===tr){for(e.state=nr,r=new Array(l=e.tween.length),c=0,f=-1;c<l;++c)(h=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(r[++f]=h);r.length=f+1}}function o(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(u),e.state=rr,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);e.state===rr&&(e.on.call("end",t,t.__data__,e.index,e.group),u())}function u(){for(var r in e.state=ir,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=je((function(t){e.state=Ke,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}),0,e.time)}(t,e,{name:n,index:r,group:i,on:Qe,tween:Ze,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Je})};function or(t,n){var e=sr(t,n);if(e.state>Je)throw new Error("too late; already scheduled");return e}function ur(t,n){var e=sr(t,n);if(e.state>nr)throw new Error("too late; already running");return e}function sr(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}var cr=function(t,n){var e,r,i,a=t.__transition,o=!0;if(a){for(i in n=null==n?null:n+"",a)(e=a[i]).name===n?(r=e.state>tr&&e.state<rr,e.state=ir,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete a[i]):o=!1;o&&delete t.__transition}};function fr(t,n){var e,r;return function(){var i=ur(this,t),a=i.tween;if(a!==e)for(var o=0,u=(r=e=a).length;o<u;++o)if(r[o].name===n){(r=r.slice()).splice(o,1);break}i.tween=r}}function lr(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var a=ur(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:n,value:e},s=0,c=i.length;s<c;++s)if(i[s].name===n){i[s]=u;break}s===c&&i.push(u)}a.tween=i}}function hr(t,n,e){var r=t._id;return t.each((function(){var t=ur(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return sr(t,r).value[n]}}var dr=function(t,n){var e;return("number"==typeof n?bn:n instanceof Yt?dn:(e=Yt(n))?(n=e,dn):Cn)(t,n)};function pr(t){return function(){this.removeAttribute(t)}}function yr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vr(t,n,e){var r,i,a=e+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=n(r=o,e)}}function gr(t,n,e){var r,i,a=e+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=n(r=o,e)}}function mr(t,n,e){var r,i,a;return function(){var o,u,s=e(this);if(null!=s)return(o=this.getAttribute(t))===(u=s+"")?null:o===r&&u===i?a:(i=u,a=n(r=o,s));this.removeAttribute(t)}}function br(t,n,e){var r,i,a;return function(){var o,u,s=e(this);if(null!=s)return(o=this.getAttributeNS(t.space,t.local))===(u=s+"")?null:o===r&&u===i?a:(i=u,a=n(r=o,s));this.removeAttributeNS(t.space,t.local)}}function xr(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttributeNS(t.space,t.local,n(e))}}(t,i)),e}return i._value=n,i}function _r(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttribute(t,n(e))}}(t,i)),e}return i._value=n,i}function wr(t,n){return function(){or(this,t).delay=+n.apply(this,arguments)}}function Mr(t,n){return n=+n,function(){or(this,t).delay=n}}function Er(t,n){return function(){ur(this,t).duration=+n.apply(this,arguments)}}function Pr(t,n){return n=+n,function(){ur(this,t).duration=n}}function Tr(t,n){if("function"!=typeof n)throw new Error;return function(){ur(this,t).ease=n}}function Cr(t,n,e){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?or:ur;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(n,e),o.on=i}}var kr=vt.m.prototype.constructor;function Sr(t){return function(){this.style.removeProperty(t)}}function Ar(t,n,e){var r,i;function a(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&function(t,n,e){return function(r){this.style.setProperty(t,n(r),e)}}(t,a,e)),r}return a._value=n,a}var Nr=0;function Br(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function zr(t){return Object(vt.m)().transition(t)}function Dr(){return++Nr}var Rr=vt.m.prototype;function Or(t){return+t}function Vr(t){return t*t}function Lr(t){return t*(2-t)}function Ir(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function qr(t){return t*t*t}function Ur(t){return--t*t*t+1}function Fr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Br.prototype=zr.prototype={constructor:Br,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Object(vt.n)(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var u,s,c=r[o],f=c.length,l=a[o]=new Array(f),h=0;h<f;++h)(u=c[h])&&(s=t.call(u,u.__data__,h,c))&&("__data__"in u&&(s.__data__=u.__data__),l[h]=s,ar(l[h],n,e,h,l,sr(u,e)));return new Br(a,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Object(vt.o)(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var s,c=r[u],f=c.length,l=0;l<f;++l)if(s=c[l]){for(var h,d=t.call(s,s.__data__,l,c),p=sr(s,e),y=0,v=d.length;y<v;++y)(h=d[y])&&ar(h,n,e,y,d,p);a.push(d),o.push(s)}return new Br(a,o,n,e)},filter:function(t){"function"!=typeof t&&(t=Object(vt.g)(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],u=o.length,s=r[i]=[],c=0;c<u;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&s.push(a);return new Br(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var s,c=n[u],f=e[u],l=c.length,h=o[u]=new Array(l),d=0;d<l;++d)(s=c[d]||f[d])&&(h[d]=s);for(;u<r;++u)o[u]=n[u];return new Br(o,this._parents,this._name,this._id)},selection:function(){return new kr(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Dr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],s=u.length,c=0;c<s;++c)if(o=u[c]){var f=sr(o,n);ar(o,t,e,c,u,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Br(r,this._parents,t,e)},call:Rr.call,nodes:Rr.nodes,node:Rr.node,size:Rr.size,empty:Rr.empty,each:Rr.each,on:function(t,n){var e=this._id;return arguments.length<2?sr(this.node(),e).on.on(t):this.each(Cr(e,t,n))},attr:function(t,n){var e=Object(vt.i)(t),r="transform"===e?Vn:dr;return this.attrTween(t,"function"==typeof n?(e.local?br:mr)(e,r,hr(this,"attr."+t,n)):null==n?(e.local?yr:pr)(e):(e.local?gr:vr)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=Object(vt.i)(t);return this.tween(e,(r.local?xr:_r)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?On:dr;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var a=Object(vt.p)(this,t),o=(this.style.removeProperty(t),Object(vt.p)(this,t));return a===o?null:a===e&&o===r?i:i=n(e=a,r=o)}}(t,r)).on("end.style."+t,Sr(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,a;return function(){var o=Object(vt.p)(this,t),u=e(this),s=u+"";return null==u&&(this.style.removeProperty(t),s=u=Object(vt.p)(this,t)),o===s?null:o===r&&s===i?a:(i=s,a=n(r=o,u))}}(t,r,hr(this,"style."+t,n))).each(function(t,n){var e,r,i,a,o="style."+n,u="end."+o;return function(){var s=ur(this,t),c=s.on,f=null==s.value[o]?a||(a=Sr(n)):void 0;c===e&&i===f||(r=(e=c).copy()).on(u,i=f),s.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,a=e+"";return function(){var o=Object(vt.p)(this,t);return o===a?null:o===r?i:i=n(r=o,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,Ar(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(hr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}));var t},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=sr(this.node(),e).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==n?fr:lr)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?wr:Mr)(n,t)):sr(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Er:Pr)(n,t)):sr(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(Tr(n,t)):sr(this.node(),n).ease},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(a,o){var u={value:o},s={value:function(){0==--i&&a()}};e.each((function(){var e=ur(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(s)),e.on=n}))}))}};var jr=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),Yr=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),Xr=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Hr=Math.PI,Gr=Hr/2;function Wr(t){return 1-Math.cos(t*Gr)}function $r(t){return Math.sin(t*Gr)}function Qr(t){return(1-Math.cos(Hr*t))/2}function Zr(t){return Math.pow(2,10*t-10)}function Jr(t){return 1-Math.pow(2,-10*t)}function Kr(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function ti(t){return 1-Math.sqrt(1-t*t)}function ni(t){return Math.sqrt(1- --t*t)}function ei(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var ri=4/11,ii=6/11,ai=8/11,oi=.75,ui=9/11,si=10/11,ci=.9375,fi=21/22,li=63/64,hi=1/ri/ri;function di(t){return 1-pi(1-t)}function pi(t){return(t=+t)<ri?hi*t*t:t<ai?hi*(t-=ii)*t+oi:t<si?hi*(t-=ui)*t+ci:hi*(t-=fi)*t+li}function yi(t){return((t*=2)<=1?1-pi(1-t):pi(t-1)+1)/2}var vi=function t(n){function e(t){return t*t*((n+1)*t-n)}return n=+n,e.overshoot=t,e}(1.70158),gi=function t(n){function e(t){return--t*t*((n+1)*t+n)+1}return n=+n,e.overshoot=t,e}(1.70158),mi=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(1.70158),bi=2*Math.PI,xi=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=bi);function i(t){return n*Math.pow(2,10*--t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*bi)},i.period=function(e){return t(n,e)},i}(1,.3),_i=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=bi);function i(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*bi)},i.period=function(e){return t(n,e)},i}(1,.3),wi=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=bi);function i(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((r-t)/e):2-n*Math.pow(2,-10*t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*bi)},i.period=function(e){return t(n,e)},i}(1,.3),Mi={time:null,delay:0,duration:250,ease:Fr};function Ei(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return Mi.time=qe(),Mi;return e}vt.m.prototype.interrupt=function(t){return this.each((function(){cr(this,t)}))},vt.m.prototype.transition=function(t){var n,e;t instanceof Br?(n=t._id,t=t._name):(n=Dr(),(e=Mi).time=qe(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],s=u.length,c=0;c<s;++c)(o=u[c])&&ar(o,t,n,c,u,e||Ei(o,n));return new Br(r,this._parents,t,n)};var Pi=[null],Ti=function(t,n){var e,r,i=t.__transition;if(i)for(r in n=null==n?null:n+"",i)if((e=i[r]).state>Ke&&e.name===n)return new Br([[t]],Pi,n,+r);return null},Ci=function(t){return function(){return t}},ki=function(t,n,e){this.target=t,this.type=n,this.selection=e};function Si(){vt.e.stopImmediatePropagation()}var Ai=function(){vt.e.preventDefault(),vt.e.stopImmediatePropagation()},Ni={name:"drag"},Bi={name:"space"},zi={name:"handle"},Di={name:"center"};function Ri(t){return[+t[0],+t[1]]}function Oi(t){return[Ri(t[0]),Ri(t[1])]}var Vi={name:"x",handles:["w","e"].map(Xi),input:function(t,n){return null==t?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Li={name:"y",handles:["n","s"].map(Xi),input:function(t,n){return null==t?null:[[n[0][0],+t[0]],[n[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Ii={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Xi),input:function(t){return null==t?null:Oi(t)},output:function(t){return t}},qi={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ui={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Fi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ji={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Yi={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Xi(t){return{type:t}}function Hi(){return!vt.e.ctrlKey&&!vt.e.button}function Gi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Wi(){return navigator.maxTouchPoints||"ontouchstart"in this}function $i(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Qi(t){var n=t.__brush;return n?n.dim.output(n.selection):null}function Zi(){return ta(Vi)}function Ji(){return ta(Li)}var Ki=function(){return ta(Ii)};function ta(t){var n,e=Gi,r=Hi,i=Wi,a=!0,o=yt(s,"start","brush","end"),u=6;function s(n){var e=n.property("__brush",y).selectAll(".overlay").data([Xi("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",qi.overlay).merge(e).each((function(){var t=$i(this).extent;Object(vt.k)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),n.selectAll(".selection").data([Xi("selection")]).enter().append("rect").attr("class","selection").attr("cursor",qi.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=n.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return qi[t.type]})),n.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=Object(vt.k)(this),n=$i(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?n[1][0]-u/2:n[0][0]-u/2})).attr("y",(function(t){return"s"===t.type[0]?n[1][1]-u/2:n[0][1]-u/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+u:u})).attr("height",(function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+u:u}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function f(t,n,e){return!e&&t.__brush.emitter||new l(t,n)}function l(t,n){this.that=t,this.args=n,this.state=t.__brush,this.active=0}function h(){if((!n||vt.e.touches)&&r.apply(this,arguments)){var e,i,o,u,s,l,h,d,p,y,v,g,m=this,b=vt.e.target.__data__.type,x="selection"===(a&&vt.e.metaKey?b="overlay":b)?Ni:a&&vt.e.altKey?Di:zi,_=t===Li?null:ji[b],w=t===Vi?null:Yi[b],M=$i(m),E=M.extent,P=M.selection,T=E[0][0],C=E[0][1],k=E[1][0],S=E[1][1],A=0,N=0,B=_&&w&&a&&vt.e.shiftKey,z=vt.e.touches?(g=vt.e.changedTouches[0].identifier,function(t){return Object(vt.q)(t,vt.e.touches,g)}):vt.h,D=z(m),R=D,O=f(m,arguments,!0).beforestart();"overlay"===b?(P&&(p=!0),M.selection=P=[[e=t===Li?T:D[0],o=t===Vi?C:D[1]],[s=t===Li?k:e,h=t===Vi?S:o]]):(e=P[0][0],o=P[0][1],s=P[1][0],h=P[1][1]),i=e,u=o,l=s,d=h;var V=Object(vt.k)(m).attr("pointer-events","none"),L=V.selectAll(".overlay").attr("cursor",qi[b]);if(vt.e.touches)O.moved=q,O.ended=F;else{var I=Object(vt.k)(vt.e.view).on("mousemove.brush",q,!0).on("mouseup.brush",F,!0);a&&I.on("keydown.brush",(function(){switch(vt.e.keyCode){case 16:B=_&&w;break;case 18:x===zi&&(_&&(s=l-A*_,e=i+A*_),w&&(h=d-N*w,o=u+N*w),x=Di,U());break;case 32:x!==zi&&x!==Di||(_<0?s=l-A:_>0&&(e=i-A),w<0?h=d-N:w>0&&(o=u-N),x=Bi,L.attr("cursor",qi.selection),U());break;default:return}Ai()}),!0).on("keyup.brush",(function(){switch(vt.e.keyCode){case 16:B&&(y=v=B=!1,U());break;case 18:x===Di&&(_<0?s=l:_>0&&(e=i),w<0?h=d:w>0&&(o=u),x=zi,U());break;case 32:x===Bi&&(vt.e.altKey?(_&&(s=l-A*_,e=i+A*_),w&&(h=d-N*w,o=u+N*w),x=Di):(_<0?s=l:_>0&&(e=i),w<0?h=d:w>0&&(o=u),x=zi),L.attr("cursor",qi[b]),U());break;default:return}Ai()}),!0),bt(vt.e.view)}Si(),cr(m),c.call(m),O.start()}function q(){var t=z(m);!B||y||v||(Math.abs(t[0]-R[0])>Math.abs(t[1]-R[1])?v=!0:y=!0),R=t,p=!0,Ai(),U()}function U(){var t;switch(A=R[0]-D[0],N=R[1]-D[1],x){case Bi:case Ni:_&&(A=Math.max(T-e,Math.min(k-s,A)),i=e+A,l=s+A),w&&(N=Math.max(C-o,Math.min(S-h,N)),u=o+N,d=h+N);break;case zi:_<0?(A=Math.max(T-e,Math.min(k-e,A)),i=e+A,l=s):_>0&&(A=Math.max(T-s,Math.min(k-s,A)),i=e,l=s+A),w<0?(N=Math.max(C-o,Math.min(S-o,N)),u=o+N,d=h):w>0&&(N=Math.max(C-h,Math.min(S-h,N)),u=o,d=h+N);break;case Di:_&&(i=Math.max(T,Math.min(k,e-A*_)),l=Math.max(T,Math.min(k,s+A*_))),w&&(u=Math.max(C,Math.min(S,o-N*w)),d=Math.max(C,Math.min(S,h+N*w)))}l<i&&(_*=-1,t=e,e=s,s=t,t=i,i=l,l=t,b in Ui&&L.attr("cursor",qi[b=Ui[b]])),d<u&&(w*=-1,t=o,o=h,h=t,t=u,u=d,d=t,b in Fi&&L.attr("cursor",qi[b=Fi[b]])),M.selection&&(P=M.selection),y&&(i=P[0][0],l=P[1][0]),v&&(u=P[0][1],d=P[1][1]),P[0][0]===i&&P[0][1]===u&&P[1][0]===l&&P[1][1]===d||(M.selection=[[i,u],[l,d]],c.call(m),O.brush())}function F(){if(Si(),vt.e.touches){if(vt.e.touches.length)return;n&&clearTimeout(n),n=setTimeout((function(){n=null}),500)}else xt(vt.e.view,p),I.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);V.attr("pointer-events","all"),L.attr("cursor",qi.overlay),M.selection&&(P=M.selection),function(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}(P)&&(M.selection=null,c.call(m)),O.end()}}function d(){f(this,arguments).moved()}function p(){f(this,arguments).ended()}function y(){var n=this.__brush||{selection:null};return n.extent=Oi(e.apply(this,arguments)),n.dim=t,n}return s.move=function(n,e){n.selection?n.on("start.brush",(function(){f(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){f(this,arguments).end()})).tween("brush",(function(){var n=this,r=n.__brush,i=f(n,arguments),a=r.selection,o=t.input("function"==typeof e?e.apply(this,arguments):e,r.extent),u=kn(a,o);function s(t){r.selection=1===t&&null===o?null:u(t),c.call(n),i.brush()}return null!==a&&null!==o?s:s(1)})):n.each((function(){var n=this,r=arguments,i=n.__brush,a=t.input("function"==typeof e?e.apply(n,r):e,i.extent),o=f(n,r).beforestart();cr(n),i.selection=null===a?null:a,c.call(n),o.start().brush().end()}))},s.clear=function(t){s.move(t,null)},l.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(n){Object(vt.d)(new ki(s,n,t.output(this.state.selection)),o.apply,o,[n,this.that,this.args])}},s.extent=function(t){return arguments.length?(e="function"==typeof t?t:Ci(Oi(t)),s):e},s.filter=function(t){return arguments.length?(r="function"==typeof t?t:Ci(!!t),s):r},s.handleSize=function(t){return arguments.length?(u=+t,s):u},s.keyModifiers=function(t){return arguments.length?(a=!!t,s):a},s.on=function(){var t=o.on.apply(o,arguments);return t===o?s:t},s}var na=Math.cos,ea=Math.sin,ra=Math.PI,ia=ra/2,aa=2*ra,oa=Math.max;function ua(t){return function(n,e){return t(n.source.value+n.target.value,e.source.value+e.target.value)}}var sa=function(){var t=0,n=null,e=null,r=null;function i(i){var a,o,u,s,c,f,l=i.length,h=[],d=w(l),p=[],y=[],v=y.groups=new Array(l),g=new Array(l*l);for(a=0,c=-1;++c<l;){for(o=0,f=-1;++f<l;)o+=i[c][f];h.push(o),p.push(w(l)),a+=o}for(n&&d.sort((function(t,e){return n(h[t],h[e])})),e&&p.forEach((function(t,n){t.sort((function(t,r){return e(i[n][t],i[n][r])}))})),s=(a=oa(0,aa-t*l)/a)?t:aa/l,o=0,c=-1;++c<l;){for(u=o,f=-1;++f<l;){var m=d[c],b=p[m][f],x=i[m][b],_=o,M=o+=x*a;g[b*l+m]={index:m,subindex:b,startAngle:_,endAngle:M,value:x}}v[m]={index:m,startAngle:u,endAngle:o,value:h[m]},o+=s}for(c=-1;++c<l;)for(f=c-1;++f<l;){var E=g[f*l+c],P=g[c*l+f];(E.value||P.value)&&y.push(E.value<P.value?{source:P,target:E}:{source:E,target:P})}return r?y.sort(r):y}return i.padAngle=function(n){return arguments.length?(t=oa(0,n),i):t},i.sortGroups=function(t){return arguments.length?(n=t,i):n},i.sortSubgroups=function(t){return arguments.length?(e=t,i):e},i.sortChords=function(t){return arguments.length?(null==t?r=null:(r=ua(t))._=t,i):r&&r._},i},ca=Array.prototype.slice,fa=function(t){return function(){return t}},la=Math.PI,ha=2*la,da=ha-1e-6;function pa(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ya(){return new pa}pa.prototype=ya.prototype={constructor:pa,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,a){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var a=this._x1,o=this._y1,u=e-t,s=r-n,c=a-t,f=o-n,l=c*c+f*f;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(f*u-s*c)>1e-6&&i){var h=e-a,d=r-o,p=u*u+s*s,y=h*h+d*d,v=Math.sqrt(p),g=Math.sqrt(l),m=i*Math.tan((la-Math.acos((p+l-y)/(2*v*g)))/2),b=m/g,x=m/v;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*c)+","+(n+b*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>c*d)+","+(this._x1=t+x*u)+","+(this._y1=n+x*s)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,a){t=+t,n=+n,a=!!a;var o=(e=+e)*Math.cos(r),u=e*Math.sin(r),s=t+o,c=n+u,f=1^a,l=a?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+s+","+c:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+s+","+c),e&&(l<0&&(l=l%ha+ha),l>da?this._+="A"+e+","+e+",0,1,"+f+","+(t-o)+","+(n-u)+"A"+e+","+e+",0,1,"+f+","+(this._x1=s)+","+(this._y1=c):l>1e-6&&(this._+="A"+e+","+e+",0,"+ +(l>=la)+","+f+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};var va=ya;function ga(t){return t.source}function ma(t){return t.target}function ba(t){return t.radius}function xa(t){return t.startAngle}function _a(t){return t.endAngle}var wa=function(){var t=ga,n=ma,e=ba,r=xa,i=_a,a=null;function o(){var o,u=ca.call(arguments),s=t.apply(this,u),c=n.apply(this,u),f=+e.apply(this,(u[0]=s,u)),l=r.apply(this,u)-ia,h=i.apply(this,u)-ia,d=f*na(l),p=f*ea(l),y=+e.apply(this,(u[0]=c,u)),v=r.apply(this,u)-ia,g=i.apply(this,u)-ia;if(a||(a=o=va()),a.moveTo(d,p),a.arc(0,0,f,l,h),l===v&&h===g||(a.quadraticCurveTo(0,0,y*na(v),y*ea(v)),a.arc(0,0,y,v,g)),a.quadraticCurveTo(0,0,d,p),a.closePath(),o)return a=null,o+""||null}return o.radius=function(t){return arguments.length?(e="function"==typeof t?t:fa(+t),o):e},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:fa(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:fa(+t),o):i},o.source=function(n){return arguments.length?(t=n,o):t},o.target=function(t){return arguments.length?(n=t,o):n},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o},Ma=e(9),Ea=Array.prototype.slice,Pa=function(t,n){return t-n},Ta=function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r},Ca=function(t){return function(){return t}},ka=function(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=Sa(t,n[r]))return e;return 0};function Sa(t,n){for(var e=n[0],r=n[1],i=-1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],c=s[0],f=s[1],l=t[u],h=l[0],d=l[1];if(Aa(s,l,n))return 0;f>r!=d>r&&e<(h-c)*(r-f)/(d-f)+c&&(i=-i)}return i}function Aa(t,n,e){var r,i,a,o;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],a=e[r],o=n[r],i<=a&&a<=o||o<=a&&a<=i)}var Na=function(){},Ba=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],za=function(){var t=1,n=1,e=S,r=u;function i(t){var n=e(t);if(Array.isArray(n))n=n.slice().sort(Pa);else{var r=v(t),i=r[0],o=r[1];n=k(i,o,n),n=w(Math.floor(i/n)*n,Math.floor(o/n)*n,n)}return n.map((function(n){return a(t,n)}))}function a(e,i){var a=[],u=[];return function(e,r,i){var a,u,s,c,f,l,h=new Array,d=new Array;a=u=-1,c=e[0]>=r,Ba[c<<1].forEach(p);for(;++a<t-1;)s=c,c=e[a+1]>=r,Ba[s|c<<1].forEach(p);Ba[c<<0].forEach(p);for(;++u<n-1;){for(a=-1,c=e[u*t+t]>=r,f=e[u*t]>=r,Ba[c<<1|f<<2].forEach(p);++a<t-1;)s=c,c=e[u*t+t+a+1]>=r,l=f,f=e[u*t+a+1]>=r,Ba[s|c<<1|f<<2|l<<3].forEach(p);Ba[c|f<<3].forEach(p)}a=-1,f=e[u*t]>=r,Ba[f<<2].forEach(p);for(;++a<t-1;)l=f,f=e[u*t+a+1]>=r,Ba[f<<2|l<<3].forEach(p);function p(t){var n,e,r=[t[0][0]+a,t[0][1]+u],s=[t[1][0]+a,t[1][1]+u],c=o(r),f=o(s);(n=d[c])?(e=h[f])?(delete d[n.end],delete h[e.start],n===e?(n.ring.push(s),i(n.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[n.end],n.ring.push(s),d[n.end=f]=n):(n=h[f])?(e=d[c])?(delete h[n.start],delete d[e.end],n===e?(n.ring.push(s),i(n.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[n.start],n.ring.unshift(r),h[n.start=c]=n):h[c]=d[f]={start:c,end:f,ring:[r,s]}}Ba[f<<3].forEach(p)}(e,i,(function(t){r(t,e,i),Ta(t)>0?a.push([t]):u.push(t)})),u.forEach((function(t){for(var n,e=0,r=a.length;e<r;++e)if(-1!==ka((n=a[e])[0],t))return void n.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(n){return 2*n[0]+n[1]*(t+1)*4}function u(e,r,i){e.forEach((function(e){var a,o=e[0],u=e[1],s=0|o,c=0|u,f=r[c*t+s];o>0&&o<t&&s===o&&(a=r[c*t+s-1],e[0]=o+(i-a)/(f-a)-.5),u>0&&u<n&&c===u&&(a=r[(c-1)*t+s],e[1]=u+(i-a)/(f-a)-.5)}))}return i.contour=a,i.size=function(e){if(!arguments.length)return[t,n];var r=Math.ceil(e[0]),a=Math.ceil(e[1]);if(!(r>0&&a>0))throw new Error("invalid size");return t=r,n=a,i},i.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?Ca(Ea.call(t)):Ca(t),i):e},i.smooth=function(t){return arguments.length?(r=t?u:Na,i):r===u},i};function Da(t,n,e){for(var r=t.width,i=t.height,a=1+(e<<1),o=0;o<i;++o)for(var u=0,s=0;u<r+e;++u)u<r&&(s+=t.data[u+o*r]),u>=e&&(u>=a&&(s-=t.data[u-a+o*r]),n.data[u-e+o*r]=s/Math.min(u+1,r-1+a-u,a))}function Ra(t,n,e){for(var r=t.width,i=t.height,a=1+(e<<1),o=0;o<r;++o)for(var u=0,s=0;u<i+e;++u)u<i&&(s+=t.data[o+u*r]),u>=e&&(u>=a&&(s-=t.data[o+(u-a)*r]),n.data[o+(u-e)*r]=s/Math.min(u+1,i-1+a-u,a))}function Oa(t){return t[0]}function Va(t){return t[1]}function La(){return 1}var Ia=function(){var t=Oa,n=Va,e=La,r=960,i=500,a=20,o=2,u=3*a,s=r+2*u>>o,c=i+2*u>>o,f=Ca(20);function l(r){var i=new Float32Array(s*c),l=new Float32Array(s*c);r.forEach((function(r,a,f){var l=+t(r,a,f)+u>>o,h=+n(r,a,f)+u>>o,d=+e(r,a,f);l>=0&&l<s&&h>=0&&h<c&&(i[l+h*s]+=d)})),Da({width:s,height:c,data:i},{width:s,height:c,data:l},a>>o),Ra({width:s,height:c,data:l},{width:s,height:c,data:i},a>>o),Da({width:s,height:c,data:i},{width:s,height:c,data:l},a>>o),Ra({width:s,height:c,data:l},{width:s,height:c,data:i},a>>o),Da({width:s,height:c,data:i},{width:s,height:c,data:l},a>>o),Ra({width:s,height:c,data:l},{width:s,height:c,data:i},a>>o);var d=f(i);if(!Array.isArray(d)){var p=D(i);d=k(0,p,d),(d=w(0,Math.floor(p/d)*d,d)).shift()}return za().thresholds(d).size([s,c])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*o),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,o)-u,t[1]=t[1]*Math.pow(2,o)-u}function v(){return s=r+2*(u=3*a)>>o,c=i+2*u>>o,l}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:Ca(+n),l):t},l.y=function(t){return arguments.length?(n="function"==typeof t?t:Ca(+t),l):n},l.weight=function(t){return arguments.length?(e="function"==typeof t?t:Ca(+t),l):e},l.size=function(t){if(!arguments.length)return[r,i];var n=Math.ceil(t[0]),e=Math.ceil(t[1]);if(!(n>=0||n>=0))throw new Error("invalid size");return r=n,i=e,v()},l.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),v()},l.thresholds=function(t){return arguments.length?(f="function"==typeof t?t:Array.isArray(t)?Ca(Ea.call(t)):Ca(t),l):f},l.bandwidth=function(t){if(!arguments.length)return Math.sqrt(a*(a+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return a=Math.round((Math.sqrt(4*t*t+1)-1)/2),v()},l},qa={},Ua={},Fa=34,ja=10,Ya=13;function Xa(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+"]"})).join(",")+"}")}function Ha(t){var n=Object.create(null),e=[];return t.forEach((function(t){for(var r in t)r in n||e.push(n[r]=r)})),e}function Ga(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function Wa(t){var n,e=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((n=t.getUTCFullYear())<0?"-"+Ga(-n,6):n>9999?"+"+Ga(n,6):Ga(n,4))+"-"+Ga(t.getUTCMonth()+1,2)+"-"+Ga(t.getUTCDate(),2)+(a?"T"+Ga(e,2)+":"+Ga(r,2)+":"+Ga(i,2)+"."+Ga(a,3)+"Z":i?"T"+Ga(e,2)+":"+Ga(r,2)+":"+Ga(i,2)+"Z":r||e?"T"+Ga(e,2)+":"+Ga(r,2)+"Z":"")}var $a=function(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],a=t.length,o=0,u=0,s=a<=0,c=!1;function f(){if(s)return Ua;if(c)return c=!1,qa;var n,r,i=o;if(t.charCodeAt(i)===Fa){for(;o++<a&&t.charCodeAt(o)!==Fa||t.charCodeAt(++o)===Fa;);return(n=o)>=a?s=!0:(r=t.charCodeAt(o++))===ja?c=!0:r===Ya&&(c=!0,t.charCodeAt(o)===ja&&++o),t.slice(i+1,n-1).replace(/""/g,'"')}for(;o<a;){if((r=t.charCodeAt(n=o++))===ja)c=!0;else if(r===Ya)c=!0,t.charCodeAt(o)===ja&&++o;else if(r!==e)continue;return t.slice(i,n)}return s=!0,t.slice(i,a)}for(t.charCodeAt(a-1)===ja&&--a,t.charCodeAt(a-1)===Ya&&--a;(r=f())!==Ua;){for(var l=[];r!==qa&&r!==Ua;)l.push(r),r=f();n&&null==(l=n(l,u++))||i.push(l)}return i}function i(n,e){return n.map((function(n){return e.map((function(t){return o(n[t])})).join(t)}))}function a(n){return n.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?Wa(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,a=r(t,(function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=Xa(t);return function(r,i){return n(e(r),i,t)}}(t,n):Xa(t)}));return a.columns=i||[],a},parseRows:r,format:function(n,e){return null==e&&(e=Ha(n)),[e.map(o).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=Ha(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(a).join("\n")}}},Qa=$a(","),Za=Qa.parse,Ja=Qa.parseRows,Ka=Qa.format,to=Qa.formatBody,no=Qa.formatRows,eo=$a("\t"),ro=eo.parse,io=eo.parseRows,ao=eo.format,oo=eo.formatBody,uo=eo.formatRows;function so(t){for(var n in t){var e,r=t[n].trim();if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if("NaN"===r)r=NaN;else if(isNaN(e=+r)){if(!/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/.test(r))continue;r=new Date(r)}else r=e;else r=null;t[n]=r}return t}function co(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}var fo=function(t,n){return fetch(t,n).then(co)};function lo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}var ho=function(t,n){return fetch(t,n).then(lo)};function po(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var yo=function(t,n){return fetch(t,n).then(po)};function vo(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=void 0),yo(n,e).then((function(n){return t(n,r)}))}}function go(t,n,e,r){3===arguments.length&&"function"==typeof e&&(r=e,e=void 0);var i=$a(t);return yo(n,e).then((function(t){return i.parse(t,r)}))}var mo=vo(Za),bo=vo(ro),xo=function(t,n){return new Promise((function(e,r){var i=new Image;for(var a in n)i[a]=n[a];i.onerror=r,i.onload=function(){e(i)},i.src=t}))};function _o(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}var wo=function(t,n){return fetch(t,n).then(_o)};function Mo(t){return function(n,e){return yo(n,e).then((function(n){return(new DOMParser).parseFromString(n,t)}))}}var Eo=Mo("application/xml"),Po=Mo("text/html"),To=Mo("image/svg+xml"),Co=function(t,n){var e;function r(){var r,i,a=e.length,o=0,u=0;for(r=0;r<a;++r)o+=(i=e[r]).x,u+=i.y;for(o=o/a-t,u=u/a-n,r=0;r<a;++r)(i=e[r]).x-=o,i.y-=u}return null==t&&(t=0),null==n&&(n=0),r.initialize=function(t){e=t},r.x=function(n){return arguments.length?(t=+n,r):t},r.y=function(t){return arguments.length?(n=+t,r):n},r},ko=function(t){return function(){return t}},So=function(){return 1e-6*(Math.random()-.5)};function Ao(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,a,o,u,s,c,f,l,h,d=t._root,p={data:r},y=t._x0,v=t._y0,g=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((c=n>=(a=(y+g)/2))?y=a:g=a,(f=e>=(o=(v+m)/2))?v=o:m=o,i=d,!(d=d[l=f<<1|c]))return i[l]=p,t;if(u=+t._x.call(null,d.data),s=+t._y.call(null,d.data),n===u&&e===s)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(c=n>=(a=(y+g)/2))?y=a:g=a,(f=e>=(o=(v+m)/2))?v=o:m=o}while((l=f<<1|c)==(h=(s>=o)<<1|u>=a));return i[h]=d,i[l]=p,t}var No=function(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i};function Bo(t){return t[0]}function zo(t){return t[1]}function Do(t,n,e){var r=new Ro(null==n?Bo:n,null==e?zo:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Ro(t,n,e,r,i,a){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Oo(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Vo=Do.prototype=Ro.prototype;function Lo(t){return t.x+t.vx}function Io(t){return t.y+t.vy}Vo.copy=function(){var t,n,e=new Ro(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Oo(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Oo(n));return e},Vo.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return Ao(this.cover(n,e),n,e,t)},Vo.addAll=function(t){var n,e,r,i,a=t.length,o=new Array(a),u=new Array(a),s=1/0,c=1/0,f=-1/0,l=-1/0;for(e=0;e<a;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(o[e]=r,u[e]=i,r<s&&(s=r),r>f&&(f=r),i<c&&(c=i),i>l&&(l=i));if(s>f||c>l)return this;for(this.cover(s,c).cover(f,l),e=0;e<a;++e)Ao(this,o[e],u[e],t[e]);return this},Vo.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,a=(r=Math.floor(n))+1;else{for(var o,u,s=i-e,c=this._root;e>t||t>=i||r>n||n>=a;)switch(u=(n<r)<<1|t<e,(o=new Array(4))[u]=c,c=o,s*=2,u){case 0:i=e+s,a=r+s;break;case 1:e=i-s,a=r+s;break;case 2:i=e+s,r=a-s;break;case 3:e=i-s,r=a-s}this._root&&this._root.length&&(this._root=c)}return this._x0=e,this._y0=r,this._x1=i,this._y1=a,this},Vo.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},Vo.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Vo.find=function(t,n,e){var r,i,a,o,u,s,c,f=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],y=this._root;for(y&&p.push(new No(y,f,l,h,d)),null==e?e=1/0:(f=t-e,l=n-e,h=t+e,d=n+e,e*=e);s=p.pop();)if(!(!(y=s.node)||(i=s.x0)>h||(a=s.y0)>d||(o=s.x1)<f||(u=s.y1)<l))if(y.length){var v=(i+o)/2,g=(a+u)/2;p.push(new No(y[3],v,g,o,u),new No(y[2],i,g,v,u),new No(y[1],v,a,o,g),new No(y[0],i,a,v,g)),(c=(n>=g)<<1|t>=v)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=s)}else{var m=t-+this._x.call(null,y.data),b=n-+this._y.call(null,y.data),x=m*m+b*b;if(x<e){var _=Math.sqrt(e=x);f=t-_,l=n-_,h=t+_,d=n+_,r=y.data}}return r},Vo.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var n,e,r,i,a,o,u,s,c,f,l,h,d=this._root,p=this._x0,y=this._y0,v=this._x1,g=this._y1;if(!d)return this;if(d.length)for(;;){if((c=a>=(u=(p+v)/2))?p=u:v=u,(f=o>=(s=(y+g)/2))?y=s:g=s,n=d,!(d=d[l=f<<1|c]))return this;if(!d.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(e?e[h]=d:this._root=d),this):(this._root=i,this)},Vo.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},Vo.root=function(){return this._root},Vo.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},Vo.visit=function(t){var n,e,r,i,a,o,u=[],s=this._root;for(s&&u.push(new No(s,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!t(s=n.node,r=n.x0,i=n.y0,a=n.x1,o=n.y1)&&s.length){var c=(r+a)/2,f=(i+o)/2;(e=s[3])&&u.push(new No(e,c,f,a,o)),(e=s[2])&&u.push(new No(e,r,f,c,o)),(e=s[1])&&u.push(new No(e,c,i,a,f)),(e=s[0])&&u.push(new No(e,r,i,c,f))}return this},Vo.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new No(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,o=n.x0,u=n.y0,s=n.x1,c=n.y1,f=(o+s)/2,l=(u+c)/2;(a=i[0])&&e.push(new No(a,o,u,f,l)),(a=i[1])&&e.push(new No(a,f,u,s,l)),(a=i[2])&&e.push(new No(a,o,l,f,c)),(a=i[3])&&e.push(new No(a,f,l,s,c))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},Vo.x=function(t){return arguments.length?(this._x=t,this):this._x},Vo.y=function(t){return arguments.length?(this._y=t,this):this._y};var qo=function(t){var n,e,r=1,i=1;function a(){for(var t,a,u,s,c,f,l,h=n.length,d=0;d<i;++d)for(a=Do(n,Lo,Io).visitAfter(o),t=0;t<h;++t)u=n[t],f=e[u.index],l=f*f,s=u.x+u.vx,c=u.y+u.vy,a.visit(p);function p(t,n,e,i,a){var o=t.data,h=t.r,d=f+h;if(!o)return n>s+d||i<s-d||e>c+d||a<c-d;if(o.index>u.index){var p=s-o.x-o.vx,y=c-o.y-o.vy,v=p*p+y*y;v<d*d&&(0===p&&(v+=(p=So())*p),0===y&&(v+=(y=So())*y),v=(d-(v=Math.sqrt(v)))/v*r,u.vx+=(p*=v)*(d=(h*=h)/(l+h)),u.vy+=(y*=v)*d,o.vx-=p*(d=1-d),o.vy-=y*d)}}}function o(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function u(){if(n){var r,i,a=n.length;for(e=new Array(a),r=0;r<a;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=ko(null==t?1:+t)),a.initialize=function(t){n=t,u()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(r=+t,a):r},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:ko(+n),u(),a):t},a};function Uo(t){return t.index}function Fo(t,n){var e=t.get(n);if(!e)throw new Error("missing: "+n);return e}var jo=function(t){var n,e,r,i,a,o=Uo,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},s=ko(30),c=1;function f(r){for(var i=0,o=t.length;i<c;++i)for(var u,s,f,l,h,d,p,y=0;y<o;++y)s=(u=t[y]).source,l=(f=u.target).x+f.vx-s.x-s.vx||So(),h=f.y+f.vy-s.y-s.vy||So(),l*=d=((d=Math.sqrt(l*l+h*h))-e[y])/d*r*n[y],h*=d,f.vx-=l*(p=a[y]),f.vy-=h*p,s.vx+=l*(p=1-p),s.vy+=h*p}function l(){if(r){var u,s,c=r.length,f=t.length,l=Object(Ma.c)(r,o);for(u=0,i=new Array(c);u<f;++u)(s=t[u]).index=u,"object"!=typeof s.source&&(s.source=Fo(l,s.source)),"object"!=typeof s.target&&(s.target=Fo(l,s.target)),i[s.source.index]=(i[s.source.index]||0)+1,i[s.target.index]=(i[s.target.index]||0)+1;for(u=0,a=new Array(f);u<f;++u)s=t[u],a[u]=i[s.source.index]/(i[s.source.index]+i[s.target.index]);n=new Array(f),h(),e=new Array(f),d()}}function h(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}return null==t&&(t=[]),f.initialize=function(t){r=t,l()},f.links=function(n){return arguments.length?(t=n,l(),f):t},f.id=function(t){return arguments.length?(o=t,f):o},f.iterations=function(t){return arguments.length?(c=+t,f):c},f.strength=function(t){return arguments.length?(u="function"==typeof t?t:ko(+t),h(),f):u},f.distance=function(t){return arguments.length?(s="function"==typeof t?t:ko(+t),d(),f):s},f};function Yo(t){return t.x}function Xo(t){return t.y}var Ho=10,Go=Math.PI*(3-Math.sqrt(5)),Wo=function(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,u=Object(Ma.c)(),s=je(f),c=yt("tick","end");function f(){l(),c.call("tick",n),e<r&&(s.stop(),c.call("end",n))}function l(r){var s,c,f=t.length;void 0===r&&(r=1);for(var l=0;l<r;++l)for(e+=(a-e)*i,u.each((function(t){t(e)})),s=0;s<f;++s)null==(c=t[s]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return n}function h(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var i=Ho*Math.sqrt(e),a=e*Go;n.x=i*Math.cos(a),n.y=i*Math.sin(a)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function d(n){return n.initialize&&n.initialize(t),n}return null==t&&(t=[]),h(),n={tick:l,restart:function(){return s.restart(f),n},stop:function(){return s.stop(),n},nodes:function(e){return arguments.length?(t=e,h(),u.each(d),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(a=+t,n):a},velocityDecay:function(t){return arguments.length?(o=1-t,n):1-o},force:function(t,e){return arguments.length>1?(null==e?u.remove(t):u.set(t,d(e)),n):u.get(t)},find:function(n,e,r){var i,a,o,u,s,c=0,f=t.length;for(null==r?r=1/0:r*=r,c=0;c<f;++c)(o=(i=n-(u=t[c]).x)*i+(a=e-u.y)*a)<r&&(s=u,r=o);return s},on:function(t,e){return arguments.length>1?(c.on(t,e),n):c.on(t)}}},$o=function(){var t,n,e,r,i=ko(-30),a=1,o=1/0,u=.81;function s(r){var i,a=t.length,o=Do(t,Yo,Xo).visitAfter(f);for(e=r,i=0;i<a;++i)n=t[i],o.visit(l)}function c(){if(t){var n,e,a=t.length;for(r=new Array(a),n=0;n<a;++n)e=t[n],r[e.index]=+i(e,n,t)}}function f(t){var n,e,i,a,o,u=0,s=0;if(t.length){for(i=a=o=0;o<4;++o)(n=t[o])&&(e=Math.abs(n.value))&&(u+=n.value,s+=e,i+=e*n.x,a+=e*n.y);t.x=i/s,t.y=a/s}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=r[n.data.index]}while(n=n.next)}t.value=u}function l(t,i,s,c){if(!t.value)return!0;var f=t.x-n.x,l=t.y-n.y,h=c-i,d=f*f+l*l;if(h*h/u<d)return d<o&&(0===f&&(d+=(f=So())*f),0===l&&(d+=(l=So())*l),d<a&&(d=Math.sqrt(a*d)),n.vx+=f*t.value*e/d,n.vy+=l*t.value*e/d),!0;if(!(t.length||d>=o)){(t.data!==n||t.next)&&(0===f&&(d+=(f=So())*f),0===l&&(d+=(l=So())*l),d<a&&(d=Math.sqrt(a*d)));do{t.data!==n&&(h=r[t.data.index]*e/d,n.vx+=f*h,n.vy+=l*h)}while(t=t.next)}}return s.initialize=function(n){t=n,c()},s.strength=function(t){return arguments.length?(i="function"==typeof t?t:ko(+t),c(),s):i},s.distanceMin=function(t){return arguments.length?(a=t*t,s):Math.sqrt(a)},s.distanceMax=function(t){return arguments.length?(o=t*t,s):Math.sqrt(o)},s.theta=function(t){return arguments.length?(u=t*t,s):Math.sqrt(u)},s},Qo=function(t,n,e){var r,i,a,o=ko(.1);function u(t){for(var o=0,u=r.length;o<u;++o){var s=r[o],c=s.x-n||1e-6,f=s.y-e||1e-6,l=Math.sqrt(c*c+f*f),h=(a[o]-l)*i[o]*t/l;s.vx+=c*h,s.vy+=f*h}}function s(){if(r){var n,e=r.length;for(i=new Array(e),a=new Array(e),n=0;n<e;++n)a[n]=+t(r[n],n,r),i[n]=isNaN(a[n])?0:+o(r[n],n,r)}}return"function"!=typeof t&&(t=ko(+t)),null==n&&(n=0),null==e&&(e=0),u.initialize=function(t){r=t,s()},u.strength=function(t){return arguments.length?(o="function"==typeof t?t:ko(+t),s(),u):o},u.radius=function(n){return arguments.length?(t="function"==typeof n?n:ko(+n),s(),u):t},u.x=function(t){return arguments.length?(n=+t,u):n},u.y=function(t){return arguments.length?(e=+t,u):e},u},Zo=function(t){var n,e,r,i=ko(.1);function a(t){for(var i,a=0,o=n.length;a<o;++a)(i=n[a]).vx+=(r[a]-i.x)*e[a]*t}function o(){if(n){var a,o=n.length;for(e=new Array(o),r=new Array(o),a=0;a<o;++a)e[a]=isNaN(r[a]=+t(n[a],a,n))?0:+i(n[a],a,n)}}return"function"!=typeof t&&(t=ko(null==t?0:+t)),a.initialize=function(t){n=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ko(+t),o(),a):i},a.x=function(n){return arguments.length?(t="function"==typeof n?n:ko(+n),o(),a):t},a},Jo=function(t){var n,e,r,i=ko(.1);function a(t){for(var i,a=0,o=n.length;a<o;++a)(i=n[a]).vy+=(r[a]-i.y)*e[a]*t}function o(){if(n){var a,o=n.length;for(e=new Array(o),r=new Array(o),a=0;a<o;++a)e[a]=isNaN(r[a]=+t(n[a],a,n))?0:+i(n[a],a,n)}}return"function"!=typeof t&&(t=ko(null==t?0:+t)),a.initialize=function(t){n=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ko(+t),o(),a):i},a.y=function(n){return arguments.length?(t="function"==typeof n?n:ko(+n),o(),a):t},a},Ko=function(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]},tu=function(t){return(t=Ko(Math.abs(t)))?t[1]:NaN},nu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function eu(t){if(!(n=nu.exec(t)))throw new Error("invalid format: "+t);var n;return new ru({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function ru(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}eu.prototype=ru.prototype,ru.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var iu,au,ou,uu,su=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(n+1):t},cu=function(t,n){var e=Ko(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},fu={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return cu(100*t,n)},r:cu,s:function(t,n){var e=Ko(t,n);if(!e)return t+"";var r=e[0],i=e[1],a=i-(iu=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ko(t,Math.max(0,n+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},lu=function(t){return t},hu=Array.prototype.map,du=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],pu=function(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?lu:(n=hu.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,u=n[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(t.substring(i-=u,i+u)),!((s+=u+1)>r));)u=n[o=(o+1)%n.length];return a.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?lu:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(hu.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",f=void 0===t.nan?"NaN":t.nan+"";function l(t){var n=(t=eu(t)).fill,e=t.align,l=t.sign,h=t.symbol,d=t.zero,p=t.width,y=t.comma,v=t.precision,g=t.trim,m=t.type;"n"===m?(y=!0,m="g"):fu[m]||(void 0===v&&(v=12),g=!0,m="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",x="$"===h?a:/[%p]/.test(m)?s:"",_=fu[m],w=/[defgprs%]/.test(m);function M(t){var i,a,s,h=b,M=x;if("c"===m)M=_(t)+M,t="";else{var E=(t=+t)<0;if(t=isNaN(t)?f:_(Math.abs(t),v),g&&(t=su(t)),E&&0==+t&&(E=!1),h=(E?"("===l?l:c:"-"===l||"("===l?"":l)+h,M=("s"===m?du[8+iu/3]:"")+M+(E&&"("===l?")":""),w)for(i=-1,a=t.length;++i<a;)if(48>(s=t.charCodeAt(i))||s>57){M=(46===s?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}y&&!d&&(t=r(t,1/0));var P=h.length+t.length+M.length,T=P<p?new Array(p-P+1).join(n):"";switch(y&&d&&(t=r(T+t,T.length?p-M.length:1/0),T=""),e){case"<":t=h+t+M+T;break;case"=":t=h+T+t+M;break;case"^":t=T.slice(0,P=T.length>>1)+h+t+M+T.slice(P);break;default:t=T+h+t+M}return u(t)}return v=void 0===v?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:l,formatPrefix:function(t,n){var e=l(((t=eu(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(tu(n)/3))),i=Math.pow(10,-r),a=du[8+r/3];return function(t){return e(i*t)+a}}}};function yu(t){return au=pu(t),ou=au.format,uu=au.formatPrefix,au}yu({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var vu=function(t){return Math.max(0,-tu(Math.abs(t)))},gu=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tu(n)/3)))-tu(Math.abs(t)))},mu=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,tu(n)-tu(t))+1},bu=function(){return new xu};function xu(){this.reset()}xu.prototype={constructor:xu,reset:function(){this.s=this.t=0},add:function(t){wu(_u,t,this.t),wu(this,_u.s,this.s),this.s?this.t+=_u.t:this.s=_u.t},valueOf:function(){return this.s}};var _u=new xu;function wu(t,n,e){var r=t.s=n+e,i=r-n,a=r-i;t.t=n-a+(e-i)}var Mu=1e-6,Eu=1e-12,Pu=Math.PI,Tu=Pu/2,Cu=Pu/4,ku=2*Pu,Su=180/Pu,Au=Pu/180,Nu=Math.abs,Bu=Math.atan,zu=Math.atan2,Du=Math.cos,Ru=Math.ceil,Ou=Math.exp,Vu=(Math.floor,Math.log),Lu=Math.pow,Iu=Math.sin,qu=Math.sign||function(t){return t>0?1:t<0?-1:0},Uu=Math.sqrt,Fu=Math.tan;function ju(t){return t>1?0:t<-1?Pu:Math.acos(t)}function Yu(t){return t>1?Tu:t<-1?-Tu:Math.asin(t)}function Xu(t){return(t=Iu(t/2))*t}function Hu(){}function Gu(t,n){t&&$u.hasOwnProperty(t.type)&&$u[t.type](t,n)}var Wu={Feature:function(t,n){Gu(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Gu(e[r].geometry,n)}},$u={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Qu(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Qu(e[r],n,0)},Polygon:function(t,n){Zu(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Zu(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Gu(e[r],n)}};function Qu(t,n,e){var r,i=-1,a=t.length-e;for(n.lineStart();++i<a;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function Zu(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Qu(t[e],n,1);n.polygonEnd()}var Ju,Ku,ts,ns,es,rs=function(t,n){t&&Wu.hasOwnProperty(t.type)?Wu[t.type](t,n):Gu(t,n)},is=bu(),as=bu(),os={point:Hu,lineStart:Hu,lineEnd:Hu,polygonStart:function(){is.reset(),os.lineStart=us,os.lineEnd=ss},polygonEnd:function(){var t=+is;as.add(t<0?ku+t:t),this.lineStart=this.lineEnd=this.point=Hu},sphere:function(){as.add(ku)}};function us(){os.point=cs}function ss(){fs(Ju,Ku)}function cs(t,n){os.point=fs,Ju=t,Ku=n,ts=t*=Au,ns=Du(n=(n*=Au)/2+Cu),es=Iu(n)}function fs(t,n){var e=(t*=Au)-ts,r=e>=0?1:-1,i=r*e,a=Du(n=(n*=Au)/2+Cu),o=Iu(n),u=es*o,s=ns*a+u*Du(i),c=u*r*Iu(i);is.add(zu(c,s)),ts=t,ns=a,es=o}var ls=function(t){return as.reset(),rs(t,os),2*as};function hs(t){return[zu(t[1],t[0]),Yu(t[2])]}function ds(t){var n=t[0],e=t[1],r=Du(e);return[r*Du(n),r*Iu(n),Iu(e)]}function ps(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function ys(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function vs(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function gs(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function ms(t){var n=Uu(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}var bs,xs,_s,ws,Ms,Es,Ps,Ts,Cs,ks,Ss=bu(),As={point:Ns,lineStart:zs,lineEnd:Ds,polygonStart:function(){As.point=Rs,As.lineStart=Os,As.lineEnd=Vs,Ss.reset(),os.polygonStart()},polygonEnd:function(){os.polygonEnd(),As.point=Ns,As.lineStart=zs,As.lineEnd=Ds,is<0?(bs=-(_s=180),xs=-(ws=90)):Ss>Mu?ws=90:Ss<-Mu&&(xs=-90),ks[0]=bs,ks[1]=_s},sphere:function(){bs=-(_s=180),xs=-(ws=90)}};function Ns(t,n){Cs.push(ks=[bs=t,_s=t]),n<xs&&(xs=n),n>ws&&(ws=n)}function Bs(t,n){var e=ds([t*Au,n*Au]);if(Ts){var r=ys(Ts,e),i=ys([r[1],-r[0],0],r);ms(i),i=hs(i);var a,o=t-Ms,u=o>0?1:-1,s=i[0]*Su*u,c=Nu(o)>180;c^(u*Ms<s&&s<u*t)?(a=i[1]*Su)>ws&&(ws=a):c^(u*Ms<(s=(s+360)%360-180)&&s<u*t)?(a=-i[1]*Su)<xs&&(xs=a):(n<xs&&(xs=n),n>ws&&(ws=n)),c?t<Ms?Ls(bs,t)>Ls(bs,_s)&&(_s=t):Ls(t,_s)>Ls(bs,_s)&&(bs=t):_s>=bs?(t<bs&&(bs=t),t>_s&&(_s=t)):t>Ms?Ls(bs,t)>Ls(bs,_s)&&(_s=t):Ls(t,_s)>Ls(bs,_s)&&(bs=t)}else Cs.push(ks=[bs=t,_s=t]);n<xs&&(xs=n),n>ws&&(ws=n),Ts=e,Ms=t}function zs(){As.point=Bs}function Ds(){ks[0]=bs,ks[1]=_s,As.point=Ns,Ts=null}function Rs(t,n){if(Ts){var e=t-Ms;Ss.add(Nu(e)>180?e+(e>0?360:-360):e)}else Es=t,Ps=n;os.point(t,n),Bs(t,n)}function Os(){os.lineStart()}function Vs(){Rs(Es,Ps),os.lineEnd(),Nu(Ss)>Mu&&(bs=-(_s=180)),ks[0]=bs,ks[1]=_s,Ts=null}function Ls(t,n){return(n-=t)<0?n+360:n}function Is(t,n){return t[0]-n[0]}function qs(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var Us,Fs,js,Ys,Xs,Hs,Gs,Ws,$s,Qs,Zs,Js,Ks,tc,nc,ec,rc=function(t){var n,e,r,i,a,o,u;if(ws=_s=-(bs=xs=1/0),Cs=[],rs(t,As),e=Cs.length){for(Cs.sort(Is),n=1,a=[r=Cs[0]];n<e;++n)qs(r,(i=Cs[n])[0])||qs(r,i[1])?(Ls(r[0],i[1])>Ls(r[0],r[1])&&(r[1]=i[1]),Ls(i[0],r[1])>Ls(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=0,r=a[e=a.length-1];n<=e;r=i,++n)i=a[n],(u=Ls(r[1],i[0]))>o&&(o=u,bs=i[0],_s=r[1])}return Cs=ks=null,bs===1/0||xs===1/0?[[NaN,NaN],[NaN,NaN]]:[[bs,xs],[_s,ws]]},ic={sphere:Hu,point:ac,lineStart:uc,lineEnd:fc,polygonStart:function(){ic.lineStart=lc,ic.lineEnd=hc},polygonEnd:function(){ic.lineStart=uc,ic.lineEnd=fc}};function ac(t,n){t*=Au;var e=Du(n*=Au);oc(e*Du(t),e*Iu(t),Iu(n))}function oc(t,n,e){js+=(t-js)/++Us,Ys+=(n-Ys)/Us,Xs+=(e-Xs)/Us}function uc(){ic.point=sc}function sc(t,n){t*=Au;var e=Du(n*=Au);tc=e*Du(t),nc=e*Iu(t),ec=Iu(n),ic.point=cc,oc(tc,nc,ec)}function cc(t,n){t*=Au;var e=Du(n*=Au),r=e*Du(t),i=e*Iu(t),a=Iu(n),o=zu(Uu((o=nc*a-ec*i)*o+(o=ec*r-tc*a)*o+(o=tc*i-nc*r)*o),tc*r+nc*i+ec*a);Fs+=o,Hs+=o*(tc+(tc=r)),Gs+=o*(nc+(nc=i)),Ws+=o*(ec+(ec=a)),oc(tc,nc,ec)}function fc(){ic.point=ac}function lc(){ic.point=dc}function hc(){pc(Js,Ks),ic.point=ac}function dc(t,n){Js=t,Ks=n,t*=Au,n*=Au,ic.point=pc;var e=Du(n);tc=e*Du(t),nc=e*Iu(t),ec=Iu(n),oc(tc,nc,ec)}function pc(t,n){t*=Au;var e=Du(n*=Au),r=e*Du(t),i=e*Iu(t),a=Iu(n),o=nc*a-ec*i,u=ec*r-tc*a,s=tc*i-nc*r,c=Uu(o*o+u*u+s*s),f=Yu(c),l=c&&-f/c;$s+=l*o,Qs+=l*u,Zs+=l*s,Fs+=f,Hs+=f*(tc+(tc=r)),Gs+=f*(nc+(nc=i)),Ws+=f*(ec+(ec=a)),oc(tc,nc,ec)}var yc=function(t){Us=Fs=js=Ys=Xs=Hs=Gs=Ws=$s=Qs=Zs=0,rs(t,ic);var n=$s,e=Qs,r=Zs,i=n*n+e*e+r*r;return i<Eu&&(n=Hs,e=Gs,r=Ws,Fs<Mu&&(n=js,e=Ys,r=Xs),(i=n*n+e*e+r*r)<Eu)?[NaN,NaN]:[zu(e,n)*Su,Yu(r/Uu(i))*Su]},vc=function(t){return function(){return t}},gc=function(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e};function mc(t,n){return[Nu(t)>Pu?t+Math.round(-t/ku)*ku:t,n]}function bc(t,n,e){return(t%=ku)?n||e?gc(_c(t),wc(n,e)):_c(t):n||e?wc(n,e):mc}function xc(t){return function(n,e){return[(n+=t)>Pu?n-ku:n<-Pu?n+ku:n,e]}}function _c(t){var n=xc(t);return n.invert=xc(-t),n}function wc(t,n){var e=Du(t),r=Iu(t),i=Du(n),a=Iu(n);function o(t,n){var o=Du(n),u=Du(t)*o,s=Iu(t)*o,c=Iu(n),f=c*e+u*r;return[zu(s*i-f*a,u*e-c*r),Yu(f*i+s*a)]}return o.invert=function(t,n){var o=Du(n),u=Du(t)*o,s=Iu(t)*o,c=Iu(n),f=c*i-s*a;return[zu(s*i+c*a,u*e+f*r),Yu(f*e-u*r)]},o}mc.invert=mc;var Mc=function(t){function n(n){return(n=t(n[0]*Au,n[1]*Au))[0]*=Su,n[1]*=Su,n}return t=bc(t[0]*Au,t[1]*Au,t.length>2?t[2]*Au:0),n.invert=function(n){return(n=t.invert(n[0]*Au,n[1]*Au))[0]*=Su,n[1]*=Su,n},n};function Ec(t,n,e,r,i,a){if(e){var o=Du(n),u=Iu(n),s=r*e;null==i?(i=n+r*ku,a=n-s/2):(i=Pc(o,i),a=Pc(o,a),(r>0?i<a:i>a)&&(i+=r*ku));for(var c,f=i;r>0?f>a:f<a;f-=s)c=hs([o,-u*Du(f),-u*Iu(f)]),t.point(c[0],c[1])}}function Pc(t,n){(n=ds(n))[0]-=t,ms(n);var e=ju(-n[1]);return((-n[2]<0?-e:e)+ku-Mu)%ku}var Tc=function(){var t,n,e=vc([0,0]),r=vc(90),i=vc(6),a={point:function(e,r){t.push(e=n(e,r)),e[0]*=Su,e[1]*=Su}};function o(){var o=e.apply(this,arguments),u=r.apply(this,arguments)*Au,s=i.apply(this,arguments)*Au;return t=[],n=bc(-o[0]*Au,-o[1]*Au,0).invert,Ec(a,u,s,1),o={type:"Polygon",coordinates:[t]},t=n=null,o}return o.center=function(t){return arguments.length?(e="function"==typeof t?t:vc([+t[0],+t[1]]),o):e},o.radius=function(t){return arguments.length?(r="function"==typeof t?t:vc(+t),o):r},o.precision=function(t){return arguments.length?(i="function"==typeof t?t:vc(+t),o):i},o},Cc=function(){var t,n=[];return{point:function(n,e){t.push([n,e])},lineStart:function(){n.push(t=[])},lineEnd:Hu,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}},kc=function(t,n){return Nu(t[0]-n[0])<Mu&&Nu(t[1]-n[1])<Mu};function Sc(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}var Ac=function(t,n,e,r,i){var a,o,u=[],s=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],o=t[n];if(kc(r,o)){for(i.lineStart(),a=0;a<n;++a)i.point((r=t[a])[0],r[1]);i.lineEnd()}else u.push(e=new Sc(r,t,null,!0)),s.push(e.o=new Sc(r,null,e,!1)),u.push(e=new Sc(o,t,null,!1)),s.push(e.o=new Sc(o,null,e,!0))}})),u.length){for(s.sort(n),Nc(u),Nc(s),a=0,o=s.length;a<o;++a)s[a].e=e=!e;for(var c,f,l=u[0];;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(a=0,o=c.length;a<o;++a)i.point((f=c[a])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}c=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}};function Nc(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}var Bc=bu();function zc(t){return Nu(t[0])<=Pu?t[0]:qu(t[0])*((Nu(t[0])+Pu)%ku-Pu)}var Dc=function(t,n){var e=zc(n),r=n[1],i=Iu(r),a=[Iu(e),-Du(e),0],o=0,u=0;Bc.reset(),1===i?r=Tu+Mu:-1===i&&(r=-Tu-Mu);for(var s=0,c=t.length;s<c;++s)if(l=(f=t[s]).length)for(var f,l,h=f[l-1],d=zc(h),p=h[1]/2+Cu,y=Iu(p),v=Du(p),g=0;g<l;++g,d=b,y=_,v=w,h=m){var m=f[g],b=zc(m),x=m[1]/2+Cu,_=Iu(x),w=Du(x),M=b-d,E=M>=0?1:-1,P=E*M,T=P>Pu,C=y*_;if(Bc.add(zu(C*E*Iu(P),v*w+C*Du(P))),o+=T?M+E*ku:M,T^d>=e^b>=e){var k=ys(ds(h),ds(m));ms(k);var S=ys(a,k);ms(S);var A=(T^M>=0?-1:1)*Yu(S[2]);(r>A||r===A&&(k[0]||k[1]))&&(u+=T^M>=0?1:-1)}}return(o<-Mu||o<Mu&&Bc<-Mu)^1&u},Rc=function(t,n,e,r){return function(i){var a,o,u,s=n(i),c=Cc(),f=n(c),l=!1,h={point:d,lineStart:y,lineEnd:v,polygonStart:function(){h.point=g,h.lineStart=m,h.lineEnd=b,o=[],a=[]},polygonEnd:function(){h.point=d,h.lineStart=y,h.lineEnd=v,o=V(o);var t=Dc(a,r);o.length?(l||(i.polygonStart(),l=!0),Ac(o,Vc,t,e,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(n,e){t(n,e)&&i.point(n,e)}function p(t,n){s.point(t,n)}function y(){h.point=p,s.lineStart()}function v(){h.point=d,s.lineEnd()}function g(t,n){u.push([t,n]),f.point(t,n)}function m(){f.lineStart(),u=[]}function b(){g(u[0][0],u[0][1]),f.lineEnd();var t,n,e,r,s=f.clean(),h=c.result(),d=h.length;if(u.pop(),a.push(u),u=null,d)if(1&s){if((n=(e=h[0]).length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else d>1&&2&s&&h.push(h.pop().concat(h.shift())),o.push(h.filter(Oc))}return h}};function Oc(t){return t.length>1}function Vc(t,n){return((t=t.x)[0]<0?t[1]-Tu-Mu:Tu-t[1])-((n=n.x)[0]<0?n[1]-Tu-Mu:Tu-n[1])}var Lc=Rc((function(){return!0}),(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(a,o){var u=a>0?Pu:-Pu,s=Nu(a-e);Nu(s-Pu)<Mu?(t.point(e,r=(r+o)/2>0?Tu:-Tu),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),t.point(a,r),n=0):i!==u&&s>=Pu&&(Nu(e-i)<Mu&&(e-=i*Mu),Nu(a-u)<Mu&&(a-=u*Mu),r=function(t,n,e,r){var i,a,o=Iu(t-e);return Nu(o)>Mu?Bu((Iu(n)*(a=Du(r))*Iu(e)-Iu(r)*(i=Du(n))*Iu(t))/(i*a*o)):(n+r)/2}(e,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),n=0),t.point(e=a,r=o),i=u},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*Tu,r.point(-Pu,i),r.point(0,i),r.point(Pu,i),r.point(Pu,0),r.point(Pu,-i),r.point(0,-i),r.point(-Pu,-i),r.point(-Pu,0),r.point(-Pu,i);else if(Nu(t[0]-n[0])>Mu){var a=t[0]<n[0]?Pu:-Pu;i=e*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(n[0],n[1])}),[-Pu,-Tu]);var Ic=function(t){var n=Du(t),e=6*Au,r=n>0,i=Nu(n)>Mu;function a(t,e){return Du(t)*Du(e)>n}function o(t,e,r){var i=[1,0,0],a=ys(ds(t),ds(e)),o=ps(a,a),u=a[0],s=o-u*u;if(!s)return!r&&t;var c=n*o/s,f=-n*u/s,l=ys(i,a),h=gs(i,c);vs(h,gs(a,f));var d=l,p=ps(h,d),y=ps(d,d),v=p*p-y*(ps(h,h)-1);if(!(v<0)){var g=Uu(v),m=gs(d,(-p-g)/y);if(vs(m,h),m=hs(m),!r)return m;var b,x=t[0],_=e[0],w=t[1],M=e[1];_<x&&(b=x,x=_,_=b);var E=_-x,P=Nu(E-Pu)<Mu;if(!P&&M<w&&(b=w,w=M,M=b),P||E<Mu?P?w+M>0^m[1]<(Nu(m[0]-x)<Mu?w:M):w<=m[1]&&m[1]<=M:E>Pu^(x<=m[0]&&m[0]<=_)){var T=gs(d,(-p+g)/y);return vs(T,h),[m,hs(T)]}}}function u(n,e){var i=r?t:Pu-t,a=0;return n<-i?a|=1:n>i&&(a|=2),e<-i?a|=4:e>i&&(a|=8),a}return Rc(a,(function(t){var n,e,s,c,f;return{lineStart:function(){c=s=!1,f=1},point:function(l,h){var d,p=[l,h],y=a(l,h),v=r?y?0:u(l,h):y?u(l+(l<0?Pu:-Pu),h):0;if(!n&&(c=s=y)&&t.lineStart(),y!==s&&(!(d=o(n,p))||kc(n,d)||kc(p,d))&&(p[0]+=Mu,p[1]+=Mu,y=a(p[0],p[1])),y!==s)f=0,y?(t.lineStart(),d=o(p,n),t.point(d[0],d[1])):(d=o(n,p),t.point(d[0],d[1]),t.lineEnd()),n=d;else if(i&&n&&r^y){var g;v&e||!(g=o(p,n,!0))||(f=0,r?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1])))}!y||n&&kc(n,p)||t.point(p[0],p[1]),n=p,s=y,e=v},lineEnd:function(){s&&t.lineEnd(),n=null},clean:function(){return f|(c&&s)<<1}}}),(function(n,r,i,a){Ec(a,t,e,i,n,r)}),r?[0,-t]:[-Pu,t-Pu])},qc=function(t,n,e,r,i,a){var o,u=t[0],s=t[1],c=0,f=1,l=n[0]-u,h=n[1]-s;if(o=e-u,l||!(o>0)){if(o/=l,l<0){if(o<c)return;o<f&&(f=o)}else if(l>0){if(o>f)return;o>c&&(c=o)}if(o=i-u,l||!(o<0)){if(o/=l,l<0){if(o>f)return;o>c&&(c=o)}else if(l>0){if(o<c)return;o<f&&(f=o)}if(o=r-s,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>c&&(c=o)}if(o=a-s,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<f&&(f=o)}return c>0&&(t[0]=u+c*l,t[1]=s+c*h),f<1&&(n[0]=u+f*l,n[1]=s+f*h),!0}}}}},Uc=1e9,Fc=-Uc;function jc(t,n,e,r){function i(i,a){return t<=i&&i<=e&&n<=a&&a<=r}function a(i,a,u,c){var f=0,l=0;if(null==i||(f=o(i,u))!==(l=o(a,u))||s(i,a)<0^u>0)do{c.point(0===f||3===f?t:e,f>1?r:n)}while((f=(f+u+4)%4)!==l);else c.point(a[0],a[1])}function o(r,i){return Nu(r[0]-t)<Mu?i>0?0:3:Nu(r[0]-e)<Mu?i>0?2:1:Nu(r[1]-n)<Mu?i>0?1:0:i>0?3:2}function u(t,n){return s(t.x,n.x)}function s(t,n){var e=o(t,1),r=o(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(o){var s,c,f,l,h,d,p,y,v,g,m,b=o,x=Cc(),_={point:w,lineStart:function(){_.point=M,c&&c.push(f=[]);g=!0,v=!1,p=y=NaN},lineEnd:function(){s&&(M(l,h),d&&v&&x.rejoin(),s.push(x.result()));_.point=w,v&&b.lineEnd()},polygonStart:function(){b=x,s=[],c=[],m=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=c.length;e<i;++e)for(var a,o,u=c[e],s=1,f=u.length,l=u[0],h=l[0],d=l[1];s<f;++s)a=h,o=d,l=u[s],h=l[0],d=l[1],o<=r?d>r&&(h-a)*(r-o)>(d-o)*(t-a)&&++n:d<=r&&(h-a)*(r-o)<(d-o)*(t-a)&&--n;return n}(),e=m&&n,i=(s=V(s)).length;(e||i)&&(o.polygonStart(),e&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&Ac(s,u,n,a,o),o.polygonEnd());b=o,s=c=f=null}};function w(t,n){i(t,n)&&b.point(t,n)}function M(a,o){var u=i(a,o);if(c&&f.push([a,o]),g)l=a,h=o,d=u,g=!1,u&&(b.lineStart(),b.point(a,o));else if(u&&v)b.point(a,o);else{var s=[p=Math.max(Fc,Math.min(Uc,p)),y=Math.max(Fc,Math.min(Uc,y))],x=[a=Math.max(Fc,Math.min(Uc,a)),o=Math.max(Fc,Math.min(Uc,o))];qc(s,x,t,n,e,r)?(v||(b.lineStart(),b.point(s[0],s[1])),b.point(x[0],x[1]),u||b.lineEnd(),m=!1):u&&(b.lineStart(),b.point(a,o),m=!1)}p=a,y=o,v=u}return _}}var Yc,Xc,Hc,Gc=function(){var t,n,e,r=0,i=0,a=960,o=500;return e={stream:function(e){return t&&n===e?t:t=jc(r,i,a,o)(n=e)},extent:function(u){return arguments.length?(r=+u[0][0],i=+u[0][1],a=+u[1][0],o=+u[1][1],t=n=null,e):[[r,i],[a,o]]}}},Wc=bu(),$c={sphere:Hu,point:Hu,lineStart:function(){$c.point=Zc,$c.lineEnd=Qc},lineEnd:Hu,polygonStart:Hu,polygonEnd:Hu};function Qc(){$c.point=$c.lineEnd=Hu}function Zc(t,n){Yc=t*=Au,Xc=Iu(n*=Au),Hc=Du(n),$c.point=Jc}function Jc(t,n){t*=Au;var e=Iu(n*=Au),r=Du(n),i=Nu(t-Yc),a=Du(i),o=r*Iu(i),u=Hc*e-Xc*r*a,s=Xc*e+Hc*r*a;Wc.add(zu(Uu(o*o+u*u),s)),Yc=t,Xc=e,Hc=r}var Kc=function(t){return Wc.reset(),rs(t,$c),+Wc},tf=[null,null],nf={type:"LineString",coordinates:tf},ef=function(t,n){return tf[0]=t,tf[1]=n,Kc(nf)},rf={Feature:function(t,n){return of(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if(of(e[r].geometry,n))return!0;return!1}},af={Sphere:function(){return!0},Point:function(t,n){return uf(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(uf(e[r],n))return!0;return!1},LineString:function(t,n){return sf(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(sf(e[r],n))return!0;return!1},Polygon:function(t,n){return cf(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(cf(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if(of(e[r],n))return!0;return!1}};function of(t,n){return!(!t||!af.hasOwnProperty(t.type))&&af[t.type](t,n)}function uf(t,n){return 0===ef(t,n)}function sf(t,n){for(var e,r,i,a=0,o=t.length;a<o;a++){if(0===(r=ef(t[a],n)))return!0;if(a>0&&(i=ef(t[a],t[a-1]))>0&&e<=i&&r<=i&&(e+r-i)*(1-Math.pow((e-r)/i,2))<Eu*i)return!0;e=r}return!1}function cf(t,n){return!!Dc(t.map(ff),lf(n))}function ff(t){return(t=t.map(lf)).pop(),t}function lf(t){return[t[0]*Au,t[1]*Au]}var hf=function(t,n){return(t&&rf.hasOwnProperty(t.type)?rf[t.type]:of)(t,n)};function df(t,n,e){var r=w(t,n-Mu,e).concat(n);return function(t){return r.map((function(n){return[t,n]}))}}function pf(t,n,e){var r=w(t,n-Mu,e).concat(n);return function(t){return r.map((function(n){return[n,t]}))}}function yf(){var t,n,e,r,i,a,o,u,s,c,f,l,h=10,d=h,p=90,y=360,v=2.5;function g(){return{type:"MultiLineString",coordinates:m()}}function m(){return w(Ru(r/p)*p,e,p).map(f).concat(w(Ru(u/y)*y,o,y).map(l)).concat(w(Ru(n/h)*h,t,h).filter((function(t){return Nu(t%p)>Mu})).map(s)).concat(w(Ru(a/d)*d,i,d).filter((function(t){return Nu(t%y)>Mu})).map(c))}return g.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},g.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(l(o).slice(1),f(e).reverse().slice(1),l(u).reverse().slice(1))]}},g.extent=function(t){return arguments.length?g.extentMajor(t).extentMinor(t):g.extentMinor()},g.extentMajor=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),u>o&&(t=u,u=o,o=t),g.precision(v)):[[r,u],[e,o]]},g.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],a=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),a>i&&(e=a,a=i,i=e),g.precision(v)):[[n,a],[t,i]]},g.step=function(t){return arguments.length?g.stepMajor(t).stepMinor(t):g.stepMinor()},g.stepMajor=function(t){return arguments.length?(p=+t[0],y=+t[1],g):[p,y]},g.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],g):[h,d]},g.precision=function(h){return arguments.length?(v=+h,s=df(a,i,90),c=pf(n,t,v),f=df(u,o,90),l=pf(r,e,v),g):v},g.extentMajor([[-180,-90+Mu],[180,90-Mu]]).extentMinor([[-180,-80-Mu],[180,80+Mu]])}function vf(){return yf()()}var gf,mf,bf,xf,_f=function(t,n){var e=t[0]*Au,r=t[1]*Au,i=n[0]*Au,a=n[1]*Au,o=Du(r),u=Iu(r),s=Du(a),c=Iu(a),f=o*Du(e),l=o*Iu(e),h=s*Du(i),d=s*Iu(i),p=2*Yu(Uu(Xu(a-r)+o*s*Xu(i-e))),y=Iu(p),v=p?function(t){var n=Iu(t*=p)/y,e=Iu(p-t)/y,r=e*f+n*h,i=e*l+n*d,a=e*u+n*c;return[zu(i,r)*Su,zu(a,Uu(r*r+i*i))*Su]}:function(){return[e*Su,r*Su]};return v.distance=p,v},wf=function(t){return t},Mf=bu(),Ef=bu(),Pf={point:Hu,lineStart:Hu,lineEnd:Hu,polygonStart:function(){Pf.lineStart=Tf,Pf.lineEnd=Sf},polygonEnd:function(){Pf.lineStart=Pf.lineEnd=Pf.point=Hu,Mf.add(Nu(Ef)),Ef.reset()},result:function(){var t=Mf/2;return Mf.reset(),t}};function Tf(){Pf.point=Cf}function Cf(t,n){Pf.point=kf,gf=bf=t,mf=xf=n}function kf(t,n){Ef.add(xf*t-bf*n),bf=t,xf=n}function Sf(){kf(gf,mf)}var Af=Pf,Nf=1/0,Bf=Nf,zf=-Nf,Df=zf;var Rf,Of,Vf,Lf,If={point:function(t,n){t<Nf&&(Nf=t);t>zf&&(zf=t);n<Bf&&(Bf=n);n>Df&&(Df=n)},lineStart:Hu,lineEnd:Hu,polygonStart:Hu,polygonEnd:Hu,result:function(){var t=[[Nf,Bf],[zf,Df]];return zf=Df=-(Bf=Nf=1/0),t}},qf=0,Uf=0,Ff=0,jf=0,Yf=0,Xf=0,Hf=0,Gf=0,Wf=0,$f={point:Qf,lineStart:Zf,lineEnd:tl,polygonStart:function(){$f.lineStart=nl,$f.lineEnd=el},polygonEnd:function(){$f.point=Qf,$f.lineStart=Zf,$f.lineEnd=tl},result:function(){var t=Wf?[Hf/Wf,Gf/Wf]:Xf?[jf/Xf,Yf/Xf]:Ff?[qf/Ff,Uf/Ff]:[NaN,NaN];return qf=Uf=Ff=jf=Yf=Xf=Hf=Gf=Wf=0,t}};function Qf(t,n){qf+=t,Uf+=n,++Ff}function Zf(){$f.point=Jf}function Jf(t,n){$f.point=Kf,Qf(Vf=t,Lf=n)}function Kf(t,n){var e=t-Vf,r=n-Lf,i=Uu(e*e+r*r);jf+=i*(Vf+t)/2,Yf+=i*(Lf+n)/2,Xf+=i,Qf(Vf=t,Lf=n)}function tl(){$f.point=Qf}function nl(){$f.point=rl}function el(){il(Rf,Of)}function rl(t,n){$f.point=il,Qf(Rf=Vf=t,Of=Lf=n)}function il(t,n){var e=t-Vf,r=n-Lf,i=Uu(e*e+r*r);jf+=i*(Vf+t)/2,Yf+=i*(Lf+n)/2,Xf+=i,Hf+=(i=Lf*t-Vf*n)*(Vf+t),Gf+=i*(Lf+n),Wf+=3*i,Qf(Vf=t,Lf=n)}var al=$f;function ol(t){this._context=t}ol.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,ku)}},result:Hu};var ul,sl,cl,fl,ll,hl=bu(),dl={point:Hu,lineStart:function(){dl.point=pl},lineEnd:function(){ul&&yl(sl,cl),dl.point=Hu},polygonStart:function(){ul=!0},polygonEnd:function(){ul=null},result:function(){var t=+hl;return hl.reset(),t}};function pl(t,n){dl.point=yl,sl=fl=t,cl=ll=n}function yl(t,n){fl-=t,ll-=n,hl.add(Uu(fl*fl+ll*ll)),fl=t,ll=n}var vl=dl;function gl(){this._string=[]}function ml(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}gl.prototype={_radius:4.5,_circle:ml(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=ml(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var bl=function(t,n){var e,r,i=4.5;function a(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),rs(t,e(r))),r.result()}return a.area=function(t){return rs(t,e(Af)),Af.result()},a.measure=function(t){return rs(t,e(vl)),vl.result()},a.bounds=function(t){return rs(t,e(If)),If.result()},a.centroid=function(t){return rs(t,e(al)),al.result()},a.projection=function(n){return arguments.length?(e=null==n?(t=null,wf):(t=n).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(n=null,new gl):new ol(n=t),"function"!=typeof i&&r.pointRadius(i),a):n},a.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(n)},xl=function(t){return{stream:_l(t)}};function _l(t){return function(n){var e=new wl;for(var r in t)e[r]=t[r];return e.stream=n,e}}function wl(){}function Ml(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),rs(e,t.stream(If)),n(If.result()),null!=r&&t.clipExtent(r),t}function El(t,n,e){return Ml(t,(function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],a=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),o=+n[0][0]+(r-a*(e[1][0]+e[0][0]))/2,u=+n[0][1]+(i-a*(e[1][1]+e[0][1]))/2;t.scale(150*a).translate([o,u])}),e)}function Pl(t,n,e){return El(t,[[0,0],n],e)}function Tl(t,n,e){return Ml(t,(function(e){var r=+n,i=r/(e[1][0]-e[0][0]),a=(r-i*(e[1][0]+e[0][0]))/2,o=-i*e[0][1];t.scale(150*i).translate([a,o])}),e)}function Cl(t,n,e){return Ml(t,(function(e){var r=+n,i=r/(e[1][1]-e[0][1]),a=-i*e[0][0],o=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([a,o])}),e)}wl.prototype={constructor:wl,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var kl=16,Sl=Du(30*Au),Al=function(t,n){return+n?function(t,n){function e(r,i,a,o,u,s,c,f,l,h,d,p,y,v){var g=c-r,m=f-i,b=g*g+m*m;if(b>4*n&&y--){var x=o+h,_=u+d,w=s+p,M=Uu(x*x+_*_+w*w),E=Yu(w/=M),P=Nu(Nu(w)-1)<Mu||Nu(a-l)<Mu?(a+l)/2:zu(_,x),T=t(P,E),C=T[0],k=T[1],S=C-r,A=k-i,N=m*S-g*A;(N*N/b>n||Nu((g*S+m*A)/b-.5)>.3||o*h+u*d+s*p<Sl)&&(e(r,i,a,o,u,s,C,k,P,x/=M,_/=M,w,y,v),v.point(C,k),e(C,k,P,x,_,w,c,f,l,h,d,p,y,v))}}return function(n){var r,i,a,o,u,s,c,f,l,h,d,p,y={point:v,lineStart:g,lineEnd:b,polygonStart:function(){n.polygonStart(),y.lineStart=x},polygonEnd:function(){n.polygonEnd(),y.lineStart=g}};function v(e,r){e=t(e,r),n.point(e[0],e[1])}function g(){f=NaN,y.point=m,n.lineStart()}function m(r,i){var a=ds([r,i]),o=t(r,i);e(f,l,c,h,d,p,f=o[0],l=o[1],c=r,h=a[0],d=a[1],p=a[2],kl,n),n.point(f,l)}function b(){y.point=v,n.lineEnd()}function x(){g(),y.point=_,y.lineEnd=w}function _(t,n){m(r=t,n),i=f,a=l,o=h,u=d,s=p,y.point=m}function w(){e(f,l,c,h,d,p,i,a,r,o,u,s,kl,n),y.lineEnd=b,b()}return y}}(t,n):function(t){return _l({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)};var Nl=_l({point:function(t,n){this.stream.point(t*Au,n*Au)}});function Bl(t,n,e){function r(r,i){return[n+t*r,e-t*i]}return r.invert=function(r,i){return[(r-n)/t,(e-i)/t]},r}function zl(t,n,e,r){var i=Du(r),a=Iu(r),o=i*t,u=a*t,s=i/t,c=a/t,f=(a*e-i*n)/t,l=(a*n+i*e)/t;function h(t,r){return[o*t-u*r+n,e-u*t-o*r]}return h.invert=function(t,n){return[s*t-c*n+f,l-c*t-s*n]},h}function Dl(t){return Rl((function(){return t}))()}function Rl(t){var n,e,r,i,a,o,u,s,c,f,l=150,h=480,d=250,p=0,y=0,v=0,g=0,m=0,b=0,x=null,_=Lc,w=null,M=wf,E=.5;function P(t){return s(t[0]*Au,t[1]*Au)}function T(t){return(t=s.invert(t[0],t[1]))&&[t[0]*Su,t[1]*Su]}function C(){var t=zl(l,0,0,b).apply(null,n(p,y)),r=(b?zl:Bl)(l,h-t[0],d-t[1],b);return e=bc(v,g,m),u=gc(n,r),s=gc(e,u),o=Al(u,E),k()}function k(){return c=f=null,P}return P.stream=function(t){return c&&f===t?c:c=Nl(function(t){return _l({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(e)(_(o(M(f=t)))))},P.preclip=function(t){return arguments.length?(_=t,x=void 0,k()):_},P.postclip=function(t){return arguments.length?(M=t,w=r=i=a=null,k()):M},P.clipAngle=function(t){return arguments.length?(_=+t?Ic(x=t*Au):(x=null,Lc),k()):x*Su},P.clipExtent=function(t){return arguments.length?(M=null==t?(w=r=i=a=null,wf):jc(w=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),k()):null==w?null:[[w,r],[i,a]]},P.scale=function(t){return arguments.length?(l=+t,C()):l},P.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],C()):[h,d]},P.center=function(t){return arguments.length?(p=t[0]%360*Au,y=t[1]%360*Au,C()):[p*Su,y*Su]},P.rotate=function(t){return arguments.length?(v=t[0]%360*Au,g=t[1]%360*Au,m=t.length>2?t[2]%360*Au:0,C()):[v*Su,g*Su,m*Su]},P.angle=function(t){return arguments.length?(b=t%360*Au,C()):b*Su},P.precision=function(t){return arguments.length?(o=Al(u,E=t*t),k()):Uu(E)},P.fitExtent=function(t,n){return El(P,t,n)},P.fitSize=function(t,n){return Pl(P,t,n)},P.fitWidth=function(t,n){return Tl(P,t,n)},P.fitHeight=function(t,n){return Cl(P,t,n)},function(){return n=t.apply(this,arguments),P.invert=n.invert&&T,C()}}function Ol(t){var n=0,e=Pu/3,r=Rl(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*Au,e=t[1]*Au):[n*Su,e*Su]},i}function Vl(t,n){var e=Iu(t),r=(e+Iu(n))/2;if(Nu(r)<Mu)return function(t){var n=Du(t);function e(t,e){return[t*n,Iu(e)/n]}return e.invert=function(t,e){return[t/n,Yu(e*n)]},e}(t);var i=1+e*(2*r-e),a=Uu(i)/r;function o(t,n){var e=Uu(i-2*r*Iu(n))/r;return[e*Iu(t*=r),a-e*Du(t)]}return o.invert=function(t,n){var e=a-n;return[zu(t,Nu(e))/r*qu(e),Yu((i-(t*t+e*e)*r*r)/(2*r))]},o}var Ll=function(){return Ol(Vl).scale(155.424).center([0,33.6442])},Il=function(){return Ll().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var ql=function(){var t,n,e,r,i,a,o=Il(),u=Ll().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=Ll().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,n){a=[t,n]}};function f(t){var n=t[0],o=t[1];return a=null,e.point(n,o),a||(r.point(n,o),a)||(i.point(n,o),a)}function l(){return t=n=null,f}return f.invert=function(t){var n=o.scale(),e=o.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?s:o).invert(t)},f.stream=function(e){return t&&n===e?t:(r=[o.stream(n=e),u.stream(e),s.stream(e)],i=r.length,t={point:function(t,n){for(var e=-1;++e<i;)r[e].point(t,n)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},f.precision=function(t){return arguments.length?(o.precision(t),u.precision(t),s.precision(t),l()):o.precision()},f.scale=function(t){return arguments.length?(o.scale(t),u.scale(.35*t),s.scale(t),f.translate(o.translate())):o.scale()},f.translate=function(t){if(!arguments.length)return o.translate();var n=o.scale(),a=+t[0],f=+t[1];return e=o.translate(t).clipExtent([[a-.455*n,f-.238*n],[a+.455*n,f+.238*n]]).stream(c),r=u.translate([a-.307*n,f+.201*n]).clipExtent([[a-.425*n+Mu,f+.12*n+Mu],[a-.214*n-Mu,f+.234*n-Mu]]).stream(c),i=s.translate([a-.205*n,f+.212*n]).clipExtent([[a-.214*n+Mu,f+.166*n+Mu],[a-.115*n-Mu,f+.234*n-Mu]]).stream(c),l()},f.fitExtent=function(t,n){return El(f,t,n)},f.fitSize=function(t,n){return Pl(f,t,n)},f.fitWidth=function(t,n){return Tl(f,t,n)},f.fitHeight=function(t,n){return Cl(f,t,n)},f.scale(1070)};function Ul(t){return function(n,e){var r=Du(n),i=Du(e),a=t(r*i);return[a*i*Iu(n),a*Iu(e)]}}function Fl(t){return function(n,e){var r=Uu(n*n+e*e),i=t(r),a=Iu(i),o=Du(i);return[zu(n*a,r*o),Yu(r&&e*a/r)]}}var jl=Ul((function(t){return Uu(2/(1+t))}));jl.invert=Fl((function(t){return 2*Yu(t/2)}));var Yl=function(){return Dl(jl).scale(124.75).clipAngle(179.999)},Xl=Ul((function(t){return(t=ju(t))&&t/Iu(t)}));Xl.invert=Fl((function(t){return t}));var Hl=function(){return Dl(Xl).scale(79.4188).clipAngle(179.999)};function Gl(t,n){return[t,Vu(Fu((Tu+n)/2))]}Gl.invert=function(t,n){return[t,2*Bu(Ou(n))-Tu]};var Wl=function(){return $l(Gl).scale(961/ku)};function $l(t){var n,e,r,i=Dl(t),a=i.center,o=i.scale,u=i.translate,s=i.clipExtent,c=null;function f(){var a=Pu*o(),u=i(Mc(i.rotate()).invert([0,0]));return s(null==c?[[u[0]-a,u[1]-a],[u[0]+a,u[1]+a]]:t===Gl?[[Math.max(u[0]-a,c),n],[Math.min(u[0]+a,e),r]]:[[c,Math.max(u[1]-a,n)],[e,Math.min(u[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),f()):o()},i.translate=function(t){return arguments.length?(u(t),f()):u()},i.center=function(t){return arguments.length?(a(t),f()):a()},i.clipExtent=function(t){return arguments.length?(null==t?c=n=e=r=null:(c=+t[0][0],n=+t[0][1],e=+t[1][0],r=+t[1][1]),f()):null==c?null:[[c,n],[e,r]]},f()}function Ql(t){return Fu((Tu+t)/2)}function Zl(t,n){var e=Du(t),r=t===n?Iu(t):Vu(e/Du(n))/Vu(Ql(n)/Ql(t)),i=e*Lu(Ql(t),r)/r;if(!r)return Gl;function a(t,n){i>0?n<-Tu+Mu&&(n=-Tu+Mu):n>Tu-Mu&&(n=Tu-Mu);var e=i/Lu(Ql(n),r);return[e*Iu(r*t),i-e*Du(r*t)]}return a.invert=function(t,n){var e=i-n,a=qu(r)*Uu(t*t+e*e);return[zu(t,Nu(e))/r*qu(e),2*Bu(Lu(i/a,1/r))-Tu]},a}var Jl=function(){return Ol(Zl).scale(109.5).parallels([30,30])};function Kl(t,n){return[t,n]}Kl.invert=Kl;var th=function(){return Dl(Kl).scale(152.63)};function nh(t,n){var e=Du(t),r=t===n?Iu(t):(e-Du(n))/(n-t),i=e/r+t;if(Nu(r)<Mu)return Kl;function a(t,n){var e=i-n,a=r*t;return[e*Iu(a),i-e*Du(a)]}return a.invert=function(t,n){var e=i-n;return[zu(t,Nu(e))/r*qu(e),i-qu(r)*Uu(t*t+e*e)]},a}var eh=function(){return Ol(nh).scale(131.154).center([0,13.9389])},rh=1.340264,ih=-.081106,ah=893e-6,oh=.003796,uh=Uu(3)/2;function sh(t,n){var e=Yu(uh*Iu(n)),r=e*e,i=r*r*r;return[t*Du(e)/(uh*(rh+3*ih*r+i*(7*ah+9*oh*r))),e*(rh+ih*r+i*(ah+oh*r))]}sh.invert=function(t,n){for(var e,r=n,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=e=(r*(rh+ih*i+a*(ah+oh*i))-n)/(rh+3*ih*i+a*(7*ah+9*oh*i)))*r)*i*i,!(Nu(e)<Eu));++o);return[uh*t*(rh+3*ih*i+a*(7*ah+9*oh*i))/Du(r),Yu(Iu(r)/uh)]};var ch=function(){return Dl(sh).scale(177.158)};function fh(t,n){var e=Du(n),r=Du(t)*e;return[e*Iu(t)/r,Iu(n)/r]}fh.invert=Fl(Bu);var lh=function(){return Dl(fh).scale(144.049).clipAngle(60)};function hh(t,n,e,r){return 1===t&&1===n&&0===e&&0===r?wf:_l({point:function(i,a){this.stream.point(i*t+e,a*n+r)}})}var dh=function(){var t,n,e,r,i,a,o=1,u=0,s=0,c=1,f=1,l=wf,h=null,d=wf;function p(){return r=i=null,a}return a={stream:function(t){return r&&i===t?r:r=l(d(i=t))},postclip:function(r){return arguments.length?(d=r,h=t=n=e=null,p()):d},clipExtent:function(r){return arguments.length?(d=null==r?(h=t=n=e=null,wf):jc(h=+r[0][0],t=+r[0][1],n=+r[1][0],e=+r[1][1]),p()):null==h?null:[[h,t],[n,e]]},scale:function(t){return arguments.length?(l=hh((o=+t)*c,o*f,u,s),p()):o},translate:function(t){return arguments.length?(l=hh(o*c,o*f,u=+t[0],s=+t[1]),p()):[u,s]},reflectX:function(t){return arguments.length?(l=hh(o*(c=t?-1:1),o*f,u,s),p()):c<0},reflectY:function(t){return arguments.length?(l=hh(o*c,o*(f=t?-1:1),u,s),p()):f<0},fitExtent:function(t,n){return El(a,t,n)},fitSize:function(t,n){return Pl(a,t,n)},fitWidth:function(t,n){return Tl(a,t,n)},fitHeight:function(t,n){return Cl(a,t,n)}}};function ph(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}ph.invert=function(t,n){var e,r=n,i=25;do{var a=r*r,o=a*a;r-=e=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-n)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(Nu(e)>Mu&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]};var yh=function(){return Dl(ph).scale(175.295)};function vh(t,n){return[Du(n)*Iu(t),Iu(n)]}vh.invert=Fl(Yu);var gh=function(){return Dl(vh).scale(249.5).clipAngle(90+Mu)};function mh(t,n){var e=Du(n),r=1+Du(t)*e;return[e*Iu(t)/r,Iu(n)/r]}mh.invert=Fl((function(t){return 2*Bu(t)}));var bh=function(){return Dl(mh).scale(250).clipAngle(142)};function xh(t,n){return[Vu(Fu((Tu+n)/2)),-t]}xh.invert=function(t,n){return[-n,2*Bu(Ou(t))-Tu]};var _h=function(){var t=$l(xh),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90]).scale(159.155)};function wh(t,n){return t.parent===n.parent?1:2}function Mh(t,n){return t+n.x}function Eh(t,n){return Math.max(t,n.y)}var Ph=function(){var t=wh,n=1,e=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(n){var e=n.children;e?(n.x=function(t){return t.reduce(Mh,0)/t.length}(e),n.y=function(t){return 1+t.reduce(Eh,0)}(e)):(n.x=a?o+=t(n,a):0,n.y=0,a=n)}));var u=function(t){for(var n;n=t.children;)t=n[0];return t}(i),s=function(t){for(var n;n=t.children;)t=n[n.length-1];return t}(i),c=u.x-t(u,s)/2,f=s.x+t(s,u)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*n,t.y=(i.y-t.y)*e}:function(t){t.x=(t.x-c)/(f-c)*n,t.y=(1-(i.y?t.y/i.y:1))*e})}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i};function Th(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function Ch(t,n){var e,r,i,a,o,u=new Nh(t),s=+t.value&&(u.value=t.value),c=[u];for(null==n&&(n=kh);e=c.pop();)if(s&&(e.value=+e.data.value),(i=n(e.data))&&(o=i.length))for(e.children=new Array(o),a=o-1;a>=0;--a)c.push(r=e.children[a]=new Nh(i[a])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(Ah)}function kh(t){return t.children}function Sh(t){t.data=t.data.data}function Ah(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function Nh(t){this.data=t,this.depth=this.height=0,this.parent=null}Nh.prototype=Ch.prototype={constructor:Nh,count:function(){return this.eachAfter(Th)},each:function(t){var n,e,r,i,a=this,o=[a];do{for(n=o.reverse(),o=[];a=n.pop();)if(t(a),e=a.children)for(r=0,i=e.length;r<i;++r)o.push(e[r])}while(o.length);return this},eachAfter:function(t){for(var n,e,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)a.push(n[e]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r=this,i=[r];r=i.pop();)if(t(r),n=r.children)for(e=n.length-1;e>=0;--e)i.push(n[e]);return this},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;t=e.pop(),n=r.pop();for(;t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each((function(n){t.push(n)})),t},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return Ch(this).eachBefore(Sh)}};var Bh=Array.prototype.slice;var zh=function(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(Bh.call(t))).length,a=[];r<i;)n=t[r],e&&Oh(e,n)?++r:(e=Lh(a=Dh(a,n)),r=0);return e};function Dh(t,n){var e,r;if(Vh(n,t))return[n];for(e=0;e<t.length;++e)if(Rh(n,t[e])&&Vh(Ih(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(Rh(Ih(t[e],t[r]),n)&&Rh(Ih(t[e],n),t[r])&&Rh(Ih(t[r],n),t[e])&&Vh(qh(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function Rh(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function Oh(t,n){var e=t.r-n.r+1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Vh(t,n){for(var e=0;e<n.length;++e)if(!Oh(t,n[e]))return!1;return!0}function Lh(t){switch(t.length){case 1:return{x:(n=t[0]).x,y:n.y,r:n.r};case 2:return Ih(t[0],t[1]);case 3:return qh(t[0],t[1],t[2])}var n}function Ih(t,n){var e=t.x,r=t.y,i=t.r,a=n.x,o=n.y,u=n.r,s=a-e,c=o-r,f=u-i,l=Math.sqrt(s*s+c*c);return{x:(e+a+s/l*f)/2,y:(r+o+c/l*f)/2,r:(l+i+u)/2}}function qh(t,n,e){var r=t.x,i=t.y,a=t.r,o=n.x,u=n.y,s=n.r,c=e.x,f=e.y,l=e.r,h=r-o,d=r-c,p=i-u,y=i-f,v=s-a,g=l-a,m=r*r+i*i-a*a,b=m-o*o-u*u+s*s,x=m-c*c-f*f+l*l,_=d*p-h*y,w=(p*x-y*b)/(2*_)-r,M=(y*v-p*g)/_,E=(d*b-h*x)/(2*_)-i,P=(h*g-d*v)/_,T=M*M+P*P-1,C=2*(a+w*M+E*P),k=w*w+E*E-a*a,S=-(T?(C+Math.sqrt(C*C-4*T*k))/(2*T):k/C);return{x:r+w+M*S,y:i+E+P*S,r:S}}function Uh(t,n,e){var r,i,a,o,u=t.x-n.x,s=t.y-n.y,c=u*u+s*s;c?(i=n.r+e.r,i*=i,o=t.r+e.r,i>(o*=o)?(r=(c+o-i)/(2*c),a=Math.sqrt(Math.max(0,o/c-r*r)),e.x=t.x-r*u-a*s,e.y=t.y-r*s+a*u):(r=(c+i-o)/(2*c),a=Math.sqrt(Math.max(0,i/c-r*r)),e.x=n.x+r*u-a*s,e.y=n.y+r*s+a*u)):(e.x=n.x+e.r,e.y=n.y)}function Fh(t,n){var e=t.r+n.r-1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function jh(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,a=(n.y*e.r+e.y*n.r)/r;return i*i+a*a}function Yh(t){this._=t,this.next=null,this.previous=null}function Xh(t){if(!(i=t.length))return 0;var n,e,r,i,a,o,u,s,c,f,l;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;Uh(e,n,r=t[2]),n=new Yh(n),e=new Yh(e),r=new Yh(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(u=3;u<i;++u){Uh(n._,e._,r=t[u]),r=new Yh(r),s=e.next,c=n.previous,f=e._.r,l=n._.r;do{if(f<=l){if(Fh(s._,r._)){e=s,n.next=e,e.previous=n,--u;continue t}f+=s._.r,s=s.next}else{if(Fh(c._,r._)){(n=c).next=e,e.previous=n,--u;continue t}l+=c._.r,c=c.previous}}while(s!==c.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,a=jh(n);(r=r.next)!==e;)(o=jh(r))<a&&(n=r,a=o);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=zh(n),u=0;u<i;++u)(n=t[u]).x-=r.x,n.y-=r.y;return r.r}var Hh=function(t){return Xh(t),t};function Gh(t){return null==t?null:Wh(t)}function Wh(t){if("function"!=typeof t)throw new Error;return t}function $h(){return 0}var Qh=function(t){return function(){return t}};function Zh(t){return Math.sqrt(t.value)}var Jh=function(){var t=null,n=1,e=1,r=$h;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(Kh(t)).eachAfter(td(r,.5)).eachBefore(nd(1)):i.eachBefore(Kh(Zh)).eachAfter(td($h,1)).eachAfter(td(r,i.r/Math.min(n,e))).eachBefore(nd(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=Gh(n),i):t},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:Qh(+t),i):r},i};function Kh(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function td(t,n){return function(e){if(r=e.children){var r,i,a,o=r.length,u=t(e)*n||0;if(u)for(i=0;i<o;++i)r[i].r+=u;if(a=Xh(r),u)for(i=0;i<o;++i)r[i].r-=u;e.r=a+u}}}function nd(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}var ed=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},rd=function(t,n,e,r,i){for(var a,o=t.children,u=-1,s=o.length,c=t.value&&(r-n)/t.value;++u<s;)(a=o[u]).y0=e,a.y1=i,a.x0=n,a.x1=n+=a.value*c},id=function(){var t=1,n=1,e=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=e,i.x1=t,i.y1=n/a,i.eachBefore(function(t,n){return function(r){r.children&&rd(r,r.x0,t*(r.depth+1)/n,r.x1,t*(r.depth+2)/n);var i=r.x0,a=r.y0,o=r.x1-e,u=r.y1-e;o<i&&(i=o=(i+o)/2),u<a&&(a=u=(a+u)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=u}}(n,a)),r&&i.eachBefore(ed),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(t){return arguments.length?(e=+t,i):e},i},ad="$",od={depth:-1},ud={};function sd(t){return t.id}function cd(t){return t.parentId}var fd=function(){var t=sd,n=cd;function e(e){var r,i,a,o,u,s,c,f=e.length,l=new Array(f),h={};for(i=0;i<f;++i)r=e[i],u=l[i]=new Nh(r),null!=(s=t(r,i,e))&&(s+="")&&(h[c=ad+(u.id=s)]=c in h?ud:u);for(i=0;i<f;++i)if(u=l[i],null!=(s=n(e[i],i,e))&&(s+="")){if(!(o=h[ad+s]))throw new Error("missing: "+s);if(o===ud)throw new Error("ambiguous: "+s);o.children?o.children.push(u):o.children=[u],u.parent=o}else{if(a)throw new Error("multiple roots");a=u}if(!a)throw new Error("no root");if(a.parent=od,a.eachBefore((function(t){t.depth=t.parent.depth+1,--f})).eachBefore(Ah),a.parent=null,f>0)throw new Error("cycle");return a}return e.id=function(n){return arguments.length?(t=Wh(n),e):t},e.parentId=function(t){return arguments.length?(n=Wh(t),e):n},e};function ld(t,n){return t.parent===n.parent?1:2}function hd(t){var n=t.children;return n?n[0]:t.t}function dd(t){var n=t.children;return n?n[n.length-1]:t.t}function pd(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function yd(t,n,e){return t.a.parent===n.parent?t.a:e}function vd(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}vd.prototype=Object.create(Nh.prototype);var gd=function(){var t=ld,n=1,e=1,r=null;function i(i){var s=function(t){for(var n,e,r,i,a,o=new vd(t,0),u=[o];n=u.pop();)if(r=n._.children)for(n.children=new Array(a=r.length),i=a-1;i>=0;--i)u.push(e=n.children[i]=new vd(r[i],i)),e.parent=n;return(o.parent=new vd(null,0)).children=[o],o}(i);if(s.eachAfter(a),s.parent.m=-s.z,s.eachBefore(o),r)i.eachBefore(u);else{var c=i,f=i,l=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>f.x&&(f=t),t.depth>l.depth&&(l=t)}));var h=c===f?1:t(c,f)/2,d=h-c.x,p=n/(f.x+h+d),y=e/(l.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*y}))}return i}function a(n){var e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;if(e){!function(t){for(var n,e=0,r=0,i=t.children,a=i.length;--a>=0;)(n=i[a]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(n);var a=(e[0].z+e[e.length-1].z)/2;i?(n.z=i.z+t(n._,i._),n.m=n.z-a):n.z=a}else i&&(n.z=i.z+t(n._,i._));n.parent.A=function(n,e,r){if(e){for(var i,a=n,o=n,u=e,s=a.parent.children[0],c=a.m,f=o.m,l=u.m,h=s.m;u=dd(u),a=hd(a),u&&a;)s=hd(s),(o=dd(o)).a=n,(i=u.z+l-a.z-c+t(u._,a._))>0&&(pd(yd(u,n,r),n,i),c+=i,f+=i),l+=u.m,c+=a.m,h+=s.m,f+=o.m;u&&!dd(o)&&(o.t=u,o.m+=l-f),a&&!hd(s)&&(s.t=a,s.m+=c-h,r=n)}return r}(n,i,n.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=n,t.y=t.depth*e}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i},md=function(t,n,e,r,i){for(var a,o=t.children,u=-1,s=o.length,c=t.value&&(i-e)/t.value;++u<s;)(a=o[u]).x0=n,a.x1=r,a.y0=e,a.y1=e+=a.value*c},bd=(1+Math.sqrt(5))/2;function xd(t,n,e,r,i,a){for(var o,u,s,c,f,l,h,d,p,y,v,g=[],m=n.children,b=0,x=0,_=m.length,w=n.value;b<_;){s=i-e,c=a-r;do{f=m[x++].value}while(!f&&x<_);for(l=h=f,v=f*f*(y=Math.max(c/s,s/c)/(w*t)),p=Math.max(h/v,v/l);x<_;++x){if(f+=u=m[x].value,u<l&&(l=u),u>h&&(h=u),v=f*f*y,(d=Math.max(h/v,v/l))>p){f-=u;break}p=d}g.push(o={value:f,dice:s<c,children:m.slice(b,x)}),o.dice?rd(o,e,r,i,w?r+=c*f/w:a):md(o,e,r,w?e+=s*f/w:i,a),w-=f,b=x}return g}var _d=function t(n){function e(t,e,r,i,a){xd(n,t,e,r,i,a)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(bd),wd=function(){var t=_d,n=!1,e=1,r=1,i=[0],a=$h,o=$h,u=$h,s=$h,c=$h;function f(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(l),i=[0],n&&t.eachBefore(ed),t}function l(n){var e=i[n.depth],r=n.x0+e,f=n.y0+e,l=n.x1-e,h=n.y1-e;l<r&&(r=l=(r+l)/2),h<f&&(f=h=(f+h)/2),n.x0=r,n.y0=f,n.x1=l,n.y1=h,n.children&&(e=i[n.depth+1]=a(n)/2,r+=c(n)-e,f+=o(n)-e,(l-=u(n)-e)<r&&(r=l=(r+l)/2),(h-=s(n)-e)<f&&(f=h=(f+h)/2),t(n,r,f,l,h))}return f.round=function(t){return arguments.length?(n=!!t,f):n},f.size=function(t){return arguments.length?(e=+t[0],r=+t[1],f):[e,r]},f.tile=function(n){return arguments.length?(t=Wh(n),f):t},f.padding=function(t){return arguments.length?f.paddingInner(t).paddingOuter(t):f.paddingInner()},f.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:Qh(+t),f):a},f.paddingOuter=function(t){return arguments.length?f.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):f.paddingTop()},f.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:Qh(+t),f):o},f.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:Qh(+t),f):u},f.paddingBottom=function(t){return arguments.length?(s="function"==typeof t?t:Qh(+t),f):s},f.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:Qh(+t),f):c},f},Md=function(t,n,e,r,i){var a,o,u=t.children,s=u.length,c=new Array(s+1);for(c[0]=o=a=0;a<s;++a)c[a+1]=o+=u[a].value;!function t(n,e,r,i,a,o,s){if(n>=e-1){var f=u[n];return f.x0=i,f.y0=a,f.x1=o,void(f.y1=s)}var l=c[n],h=r/2+l,d=n+1,p=e-1;for(;d<p;){var y=d+p>>>1;c[y]<h?d=y+1:p=y}h-c[d-1]<c[d]-h&&n+1<d&&--d;var v=c[d]-l,g=r-v;if(o-i>s-a){var m=(i*g+o*v)/r;t(n,d,v,i,a,m,s),t(d,e,g,m,a,o,s)}else{var b=(a*g+s*v)/r;t(n,d,v,i,a,o,b),t(d,e,g,i,b,o,s)}}(0,s,t.value,n,e,r,i)},Ed=function(t,n,e,r,i){(1&t.depth?md:rd)(t,n,e,r,i)},Pd=function t(n){function e(t,e,r,i,a){if((o=t._squarify)&&o.ratio===n)for(var o,u,s,c,f,l=-1,h=o.length,d=t.value;++l<h;){for(s=(u=o[l]).children,c=u.value=0,f=s.length;c<f;++c)u.value+=s[c].value;u.dice?rd(u,e,r,i,r+=(a-r)*u.value/d):md(u,e,r,e+=(i-e)*u.value/d,a),d-=u.value}else t._squarify=o=xd(n,t,e,r,i,a),o.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(bd),Td=function(t){for(var n,e=-1,r=t.length,i=t[r-1],a=0;++e<r;)n=i,i=t[e],a+=n[1]*i[0]-n[0]*i[1];return a/2},Cd=function(t){for(var n,e,r=-1,i=t.length,a=0,o=0,u=t[i-1],s=0;++r<i;)n=u,u=t[r],s+=e=n[0]*u[1]-u[0]*n[1],a+=(n[0]+u[0])*e,o+=(n[1]+u[1])*e;return[a/(s*=3),o/s]},kd=function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])};function Sd(t,n){return t[0]-n[0]||t[1]-n[1]}function Ad(t){for(var n=t.length,e=[0,1],r=2,i=2;i<n;++i){for(;r>1&&kd(t[e[r-2]],t[e[r-1]],t[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}var Nd=function(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(Sd),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var a=Ad(r),o=Ad(i),u=o[0]===a[0],s=o[o.length-1]===a[a.length-1],c=[];for(n=a.length-1;n>=0;--n)c.push(t[r[a[n]][2]]);for(n=+u;n<o.length-s;++n)c.push(t[r[o[n]][2]]);return c},Bd=function(t,n){for(var e,r,i=t.length,a=t[i-1],o=n[0],u=n[1],s=a[0],c=a[1],f=!1,l=0;l<i;++l)e=(a=t[l])[0],(r=a[1])>u!=c>u&&o<(s-e)*(u-r)/(c-r)+e&&(f=!f),s=e,c=r;return f},zd=function(t){for(var n,e,r=-1,i=t.length,a=t[i-1],o=a[0],u=a[1],s=0;++r<i;)n=o,e=u,n-=o=(a=t[r])[0],e-=u=a[1],s+=Math.sqrt(n*n+e*e);return s},Dd=function(){return Math.random()},Rd=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(Dd),Od=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var a;if(null!=r)a=r,r=null;else do{r=2*n()-1,a=2*n()-1,i=r*r+a*a}while(!i||i>1);return t+e*a*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(Dd),Vd=function t(n){function e(){var t=Od.source(n).apply(this,arguments);return function(){return Math.exp(t())}}return e.source=t,e}(Dd),Ld=function t(n){function e(t){return function(){for(var e=0,r=0;r<t;++r)e+=n();return e}}return e.source=t,e}(Dd),Id=function t(n){function e(t){var e=Ld.source(n)(t);return function(){return e()/t}}return e.source=t,e}(Dd),qd=function t(n){function e(t){return function(){return-Math.log(1-n())/t}}return e.source=t,e}(Dd);function Ud(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function Fd(t,n){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(n).domain(t)}return this}var jd=Array.prototype,Yd=jd.map,Xd=jd.slice,Hd={name:"implicit"};function Gd(){var t=Object(Ma.c)(),n=[],e=[],r=Hd;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==Hd)return r;t.set(a,o=n.push(i))}return e[(o-1)%e.length]}return i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=Object(Ma.c)();for(var r,a,o=-1,u=e.length;++o<u;)t.has(a=(r=e[o])+"")||t.set(a,n.push(r));return i},i.range=function(t){return arguments.length?(e=Xd.call(t),i):e.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Gd(n,e).unknown(r)},Ud.apply(i,arguments),i}function Wd(){var t,n,e=Gd().unknown(void 0),r=e.domain,i=e.range,a=[0,1],o=!1,u=0,s=0,c=.5;function f(){var e=r().length,f=a[1]<a[0],l=a[f-0],h=a[1-f];t=(h-l)/Math.max(1,e-u+2*s),o&&(t=Math.floor(t)),l+=(h-l-t*(e-u))*c,n=t*(1-u),o&&(l=Math.round(l),n=Math.round(n));var d=w(e).map((function(n){return l+t*n}));return i(f?d.reverse():d)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),f()):r()},e.range=function(t){return arguments.length?(a=[+t[0],+t[1]],f()):a.slice()},e.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,f()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(o=!!t,f()):o},e.padding=function(t){return arguments.length?(u=Math.min(1,s=+t),f()):u},e.paddingInner=function(t){return arguments.length?(u=Math.min(1,t),f()):u},e.paddingOuter=function(t){return arguments.length?(s=+t,f()):s},e.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),f()):c},e.copy=function(){return Wd(r(),a).round(o).paddingInner(u).paddingOuter(s).align(c)},Ud.apply(f(),arguments)}function $d(){return function t(n){var e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return t(e())},n}(Wd.apply(null,arguments).paddingInner(1))}var Qd=function(t){return function(){return t}},Zd=function(t){return+t},Jd=[0,1];function Kd(t){return t}function tp(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:Qd(isNaN(n)?NaN:.5)}function np(t){var n,e=t[0],r=t[t.length-1];return e>r&&(n=e,e=r,r=n),function(t){return Math.max(e,Math.min(r,t))}}function ep(t,n,e){var r=t[0],i=t[1],a=n[0],o=n[1];return i<r?(r=tp(i,r),a=e(o,a)):(r=tp(r,i),a=e(a,o)),function(t){return a(r(t))}}function rp(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<r;)i[o]=tp(t[o],t[o+1]),a[o]=e(n[o],n[o+1]);return function(n){var e=s(t,n,1,r)-1;return a[e](i[e](n))}}function ip(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ap(){var t,n,e,r,i,a,o=Jd,u=Jd,s=kn,c=Kd;function f(){return r=Math.min(o.length,u.length)>2?rp:ep,i=a=null,l}function l(n){return isNaN(n=+n)?e:(i||(i=r(o.map(t),u,s)))(t(c(n)))}return l.invert=function(e){return c(n((a||(a=r(u,o.map(t),bn)))(e)))},l.domain=function(t){return arguments.length?(o=Yd.call(t,Zd),c===Kd||(c=np(o)),f()):o.slice()},l.range=function(t){return arguments.length?(u=Xd.call(t),f()):u.slice()},l.rangeRound=function(t){return u=Xd.call(t),s=Nn,f()},l.clamp=function(t){return arguments.length?(c=t?np(o):Kd,l):c!==Kd},l.interpolate=function(t){return arguments.length?(s=t,f()):s},l.unknown=function(t){return arguments.length?(e=t,l):e},function(e,r){return t=e,n=r,f()}}function op(t,n){return ap()(t,n)}var up=function(t,n,e,r){var i,a=k(t,n,e);switch((r=eu(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=gu(a,o))||(r.precision=i),uu(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=mu(a,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=vu(a))||(r.precision=i-2*("%"===r.type))}return ou(r)};function sp(t){var n=t.domain;return t.ticks=function(t){var e=n();return T(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return up(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i=n(),a=0,o=i.length-1,u=i[a],s=i[o];return s<u&&(r=u,u=s,s=r,r=a,a=o,o=r),(r=C(u,s,e))>0?r=C(u=Math.floor(u/r)*r,s=Math.ceil(s/r)*r,e):r<0&&(r=C(u=Math.ceil(u*r)/r,s=Math.floor(s*r)/r,e)),r>0?(i[a]=Math.floor(u/r)*r,i[o]=Math.ceil(s/r)*r,n(i)):r<0&&(i[a]=Math.ceil(u*r)/r,i[o]=Math.floor(s*r)/r,n(i)),t},t}function cp(){var t=op(Kd,Kd);return t.copy=function(){return ip(t,cp())},Ud.apply(t,arguments),sp(t)}function fp(t){var n;function e(t){return isNaN(t=+t)?n:t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=Yd.call(n,Zd),e):t.slice()},e.unknown=function(t){return arguments.length?(n=t,e):n},e.copy=function(){return fp(t).unknown(n)},t=arguments.length?Yd.call(t,Zd):[0,1],sp(e)}var lp=function(t,n){var e,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(e=r,r=i,i=e,e=a,a=o,o=e),t[r]=n.floor(a),t[i]=n.ceil(o),t};function hp(t){return Math.log(t)}function dp(t){return Math.exp(t)}function pp(t){return-Math.log(-t)}function yp(t){return-Math.exp(-t)}function vp(t){return isFinite(t)?+("1e"+t):t<0?0:t}function gp(t){return function(n){return-t(-n)}}function mp(t){var n,e,r=t(hp,dp),i=r.domain,a=10;function o(){return n=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}(a),e=function(t){return 10===t?vp:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}(a),i()[0]<0?(n=gp(n),e=gp(e),t(pp,yp)):t(hp,dp),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),u=o[0],s=o[o.length-1];(r=s<u)&&(h=u,u=s,s=h);var c,f,l,h=n(u),d=n(s),p=null==t?10:+t,y=[];if(!(a%1)&&d-h<p){if(h=Math.round(h)-1,d=Math.round(d)+1,u>0){for(;h<d;++h)for(f=1,c=e(h);f<a;++f)if(!((l=c*f)<u)){if(l>s)break;y.push(l)}}else for(;h<d;++h)for(f=a-1,c=e(h);f>=1;--f)if(!((l=c*f)<u)){if(l>s)break;y.push(l)}}else y=T(h,d,Math.min(d-h,p)).map(e);return r?y.reverse():y},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!=typeof i&&(i=ou(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/e(Math.round(n(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(lp(i(),{floor:function(t){return e(Math.floor(n(t)))},ceil:function(t){return e(Math.ceil(n(t)))}}))},r}function bp(){var t=mp(ap()).domain([1,10]);return t.copy=function(){return ip(t,bp()).base(t.base())},Ud.apply(t,arguments),t}function xp(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function _p(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function wp(t){var n=1,e=t(xp(n),_p(n));return e.constant=function(e){return arguments.length?t(xp(n=+e),_p(n)):n},sp(e)}function Mp(){var t=wp(ap());return t.copy=function(){return ip(t,Mp()).constant(t.constant())},Ud.apply(t,arguments)}function Ep(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Pp(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Tp(t){return t<0?-t*t:t*t}function Cp(t){var n=t(Kd,Kd),e=1;function r(){return 1===e?t(Kd,Kd):.5===e?t(Pp,Tp):t(Ep(e),Ep(1/e))}return n.exponent=function(t){return arguments.length?(e=+t,r()):e},sp(n)}function kp(){var t=Cp(ap());return t.copy=function(){return ip(t,kp()).exponent(t.exponent())},Ud.apply(t,arguments),t}function Sp(){return kp.apply(null,arguments).exponent(.5)}function Ap(){var t,n=[],e=[],i=[];function a(){var t=0,r=Math.max(1,e.length);for(i=new Array(r-1);++t<r;)i[t-1]=N(n,t/r);return o}function o(n){return isNaN(n=+n)?t:e[s(i,n)]}return o.invertExtent=function(t){var r=e.indexOf(t);return r<0?[NaN,NaN]:[r>0?i[r-1]:n[0],r<i.length?i[r]:n[n.length-1]]},o.domain=function(t){if(!arguments.length)return n.slice();n=[];for(var e,i=0,o=t.length;i<o;++i)null==(e=t[i])||isNaN(e=+e)||n.push(e);return n.sort(r),a()},o.range=function(t){return arguments.length?(e=Xd.call(t),a()):e.slice()},o.unknown=function(n){return arguments.length?(t=n,o):t},o.quantiles=function(){return i.slice()},o.copy=function(){return Ap().domain(n).range(e).unknown(t)},Ud.apply(o,arguments)}function Np(){var t,n=0,e=1,r=1,i=[.5],a=[0,1];function o(n){return n<=n?a[s(i,n,0,r)]:t}function u(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*e-(t-r)*n)/(r+1);return o}return o.domain=function(t){return arguments.length?(n=+t[0],e=+t[1],u()):[n,e]},o.range=function(t){return arguments.length?(r=(a=Xd.call(t)).length-1,u()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[n,i[0]]:o>=r?[i[r-1],e]:[i[o-1],i[o]]},o.unknown=function(n){return arguments.length?(t=n,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return Np().domain([n,e]).range(a).unknown(t)},Ud.apply(sp(o),arguments)}function Bp(){var t,n=[.5],e=[0,1],r=1;function i(i){return i<=i?e[s(n,i,0,r)]:t}return i.domain=function(t){return arguments.length?(n=Xd.call(t),r=Math.min(n.length,e.length-1),i):n.slice()},i.range=function(t){return arguments.length?(e=Xd.call(t),r=Math.min(n.length,e.length-1),i):e.slice()},i.invertExtent=function(t){var r=e.indexOf(t);return[n[r-1],n[r]]},i.unknown=function(n){return arguments.length?(t=n,i):t},i.copy=function(){return Bp().domain(n).range(e).unknown(t)},Ud.apply(i,arguments)}var zp=new Date,Dp=new Date;function Rp(t,n,e,r){function i(n){return t(n=0===arguments.length?new Date:new Date(+n)),n}return i.floor=function(n){return t(n=new Date(+n)),n},i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,a){var o,u=[];if(e=i.ceil(e),a=null==a?1:Math.floor(a),!(e<r&&a>0))return u;do{u.push(o=new Date(+e)),n(e,a),t(e)}while(o<e&&e<r);return u},i.filter=function(e){return Rp((function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););}))},e&&(i.count=function(n,r){return zp.setTime(+n),Dp.setTime(+r),t(zp),t(Dp),Math.floor(e(zp,Dp))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var Op=Rp((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t,n){return n.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Op.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rp((function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)}),(function(n,e){n.setFullYear(n.getFullYear()+e*t)})):null};var Vp=Op,Lp=Op.range,Ip=Rp((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),qp=Ip,Up=Ip.range,Fp=6e4,jp=6048e5;function Yp(t){return Rp((function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+7*n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fp)/jp}))}var Xp=Yp(0),Hp=Yp(1),Gp=Yp(2),Wp=Yp(3),$p=Yp(4),Qp=Yp(5),Zp=Yp(6),Jp=Xp.range,Kp=Hp.range,ty=Gp.range,ny=Wp.range,ey=$p.range,ry=Qp.range,iy=Zp.range,ay=Rp((function(t){t.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fp)/864e5}),(function(t){return t.getDate()-1})),oy=ay,uy=ay.range,sy=Rp((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-t.getMinutes()*Fp)}),(function(t,n){t.setTime(+t+36e5*n)}),(function(t,n){return(n-t)/36e5}),(function(t){return t.getHours()})),cy=sy,fy=sy.range,ly=Rp((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,n){t.setTime(+t+n*Fp)}),(function(t,n){return(n-t)/Fp}),(function(t){return t.getMinutes()})),hy=ly,dy=ly.range,py=Rp((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,n){t.setTime(+t+1e3*n)}),(function(t,n){return(n-t)/1e3}),(function(t){return t.getUTCSeconds()})),yy=py,vy=py.range,gy=Rp((function(){}),(function(t,n){t.setTime(+t+n)}),(function(t,n){return n-t}));gy.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Rp((function(n){n.setTime(Math.floor(n/t)*t)}),(function(n,e){n.setTime(+n+e*t)}),(function(n,e){return(e-n)/t})):gy:null};var my=gy,by=gy.range;function xy(t){return Rp((function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+7*n)}),(function(t,n){return(n-t)/jp}))}var _y=xy(0),wy=xy(1),My=xy(2),Ey=xy(3),Py=xy(4),Ty=xy(5),Cy=xy(6),ky=_y.range,Sy=wy.range,Ay=My.range,Ny=Ey.range,By=Py.range,zy=Ty.range,Dy=Cy.range,Ry=Rp((function(t){t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+n)}),(function(t,n){return(n-t)/864e5}),(function(t){return t.getUTCDate()-1})),Oy=Ry,Vy=Ry.range,Ly=Rp((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)}),(function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ly.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Rp((function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)}),(function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)})):null};var Iy=Ly,qy=Ly.range;function Uy(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Fy(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function jy(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Yy(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,c=ev(i),f=rv(i),l=ev(a),h=rv(a),d=ev(o),p=rv(o),y=ev(u),v=rv(u),g=ev(s),m=rv(s),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return s[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Mv,e:Mv,f:kv,H:Ev,I:Pv,j:Tv,L:Cv,m:Sv,M:Av,p:function(t){return i[+(t.getHours()>=12)]},Q:ig,s:ag,S:Nv,u:Bv,U:zv,V:Dv,w:Rv,W:Ov,x:null,X:null,y:Vv,Y:Lv,Z:Iv,"%":rg},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return s[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:qv,e:qv,f:Xv,H:Uv,I:Fv,j:jv,L:Yv,m:Hv,M:Gv,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:ig,s:ag,S:Wv,u:$v,U:Qv,V:Zv,w:Jv,W:Kv,x:null,X:null,y:tg,Y:ng,Z:eg,"%":rg},_={a:function(t,n,e){var r=d.exec(n.slice(e));return r?(t.w=p[r[0].toLowerCase()],e+r[0].length):-1},A:function(t,n,e){var r=l.exec(n.slice(e));return r?(t.w=h[r[0].toLowerCase()],e+r[0].length):-1},b:function(t,n,e){var r=g.exec(n.slice(e));return r?(t.m=m[r[0].toLowerCase()],e+r[0].length):-1},B:function(t,n,e){var r=y.exec(n.slice(e));return r?(t.m=v[r[0].toLowerCase()],e+r[0].length):-1},c:function(t,e,r){return E(t,n,e,r)},d:dv,e:dv,f:bv,H:yv,I:yv,j:pv,L:mv,m:hv,M:vv,p:function(t,n,e){var r=c.exec(n.slice(e));return r?(t.p=f[r[0].toLowerCase()],e+r[0].length):-1},Q:_v,s:wv,S:gv,u:av,U:ov,V:uv,w:iv,W:sv,x:function(t,n,r){return E(t,e,n,r)},X:function(t,n,e){return E(t,r,n,e)},y:fv,Y:cv,Z:lv,"%":xv};function w(t,n){return function(e){var r,i,a,o=[],u=-1,s=0,c=t.length;for(e instanceof Date||(e=new Date(+e));++u<c;)37===t.charCodeAt(u)&&(o.push(t.slice(s,u)),null!=(i=Qy[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(a=n[r])&&(r=a(e,i)),o.push(r),s=u+1);return o.push(t.slice(s,u)),o.join("")}}function M(t,n){return function(e){var r,i,a=jy(1900);if(E(a,t,e+="",0)!=e.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=Fy(jy(a.y))).getUTCDay(),r=i>4||0===i?wy.ceil(r):wy(r),r=Oy.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=n(jy(a.y))).getDay(),r=i>4||0===i?Hp.ceil(r):Hp(r),r=oy.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Fy(jy(a.y)).getUTCDay():n(jy(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Fy(a)):n(a)}}function E(t,n,e,r){for(var i,a,o=0,u=n.length,s=e.length;o<u;){if(r>=s)return-1;if(37===(i=n.charCodeAt(o++))){if(i=n.charAt(o++),!(a=_[i in Qy?n.charAt(o++):i])||(r=a(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return b.x=w(e,b),b.X=w(r,b),b.c=w(n,b),x.x=w(e,x),x.X=w(r,x),x.c=w(n,x),{format:function(t){var n=w(t+="",b);return n.toString=function(){return t},n},parse:function(t){var n=M(t+="",Uy);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",x);return n.toString=function(){return t},n},utcParse:function(t){var n=M(t,Fy);return n.toString=function(){return t},n}}}var Xy,Hy,Gy,Wy,$y,Qy={"-":"",_:" ",0:"0"},Zy=/^\s*\d+/,Jy=/^%/,Ky=/[\\^$*+?|[\]().{}]/g;function tv(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<e?new Array(e-a+1).join(n)+i:i)}function nv(t){return t.replace(Ky,"\\$&")}function ev(t){return new RegExp("^(?:"+t.map(nv).join("|")+")","i")}function rv(t){for(var n={},e=-1,r=t.length;++e<r;)n[t[e].toLowerCase()]=e;return n}function iv(t,n,e){var r=Zy.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function av(t,n,e){var r=Zy.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function ov(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function uv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function sv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function cv(t,n,e){var r=Zy.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function fv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function lv(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function hv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function dv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function pv(t,n,e){var r=Zy.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function yv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function vv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function gv(t,n,e){var r=Zy.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function mv(t,n,e){var r=Zy.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function bv(t,n,e){var r=Zy.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function xv(t,n,e){var r=Jy.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function _v(t,n,e){var r=Zy.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function wv(t,n,e){var r=Zy.exec(n.slice(e));return r?(t.Q=1e3*+r[0],e+r[0].length):-1}function Mv(t,n){return tv(t.getDate(),n,2)}function Ev(t,n){return tv(t.getHours(),n,2)}function Pv(t,n){return tv(t.getHours()%12||12,n,2)}function Tv(t,n){return tv(1+oy.count(Vp(t),t),n,3)}function Cv(t,n){return tv(t.getMilliseconds(),n,3)}function kv(t,n){return Cv(t,n)+"000"}function Sv(t,n){return tv(t.getMonth()+1,n,2)}function Av(t,n){return tv(t.getMinutes(),n,2)}function Nv(t,n){return tv(t.getSeconds(),n,2)}function Bv(t){var n=t.getDay();return 0===n?7:n}function zv(t,n){return tv(Xp.count(Vp(t),t),n,2)}function Dv(t,n){var e=t.getDay();return t=e>=4||0===e?$p(t):$p.ceil(t),tv($p.count(Vp(t),t)+(4===Vp(t).getDay()),n,2)}function Rv(t){return t.getDay()}function Ov(t,n){return tv(Hp.count(Vp(t),t),n,2)}function Vv(t,n){return tv(t.getFullYear()%100,n,2)}function Lv(t,n){return tv(t.getFullYear()%1e4,n,4)}function Iv(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+tv(n/60|0,"0",2)+tv(n%60,"0",2)}function qv(t,n){return tv(t.getUTCDate(),n,2)}function Uv(t,n){return tv(t.getUTCHours(),n,2)}function Fv(t,n){return tv(t.getUTCHours()%12||12,n,2)}function jv(t,n){return tv(1+Oy.count(Iy(t),t),n,3)}function Yv(t,n){return tv(t.getUTCMilliseconds(),n,3)}function Xv(t,n){return Yv(t,n)+"000"}function Hv(t,n){return tv(t.getUTCMonth()+1,n,2)}function Gv(t,n){return tv(t.getUTCMinutes(),n,2)}function Wv(t,n){return tv(t.getUTCSeconds(),n,2)}function $v(t){var n=t.getUTCDay();return 0===n?7:n}function Qv(t,n){return tv(_y.count(Iy(t),t),n,2)}function Zv(t,n){var e=t.getUTCDay();return t=e>=4||0===e?Py(t):Py.ceil(t),tv(Py.count(Iy(t),t)+(4===Iy(t).getUTCDay()),n,2)}function Jv(t){return t.getUTCDay()}function Kv(t,n){return tv(wy.count(Iy(t),t),n,2)}function tg(t,n){return tv(t.getUTCFullYear()%100,n,2)}function ng(t,n){return tv(t.getUTCFullYear()%1e4,n,4)}function eg(){return"+0000"}function rg(){return"%"}function ig(t){return+t}function ag(t){return Math.floor(+t/1e3)}function og(t){return Xy=Yy(t),Hy=Xy.format,Gy=Xy.parse,Wy=Xy.utcFormat,$y=Xy.utcParse,Xy}og({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ug=Date.prototype.toISOString?function(t){return t.toISOString()}:Wy("%Y-%m-%dT%H:%M:%S.%LZ");var sg=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:$y("%Y-%m-%dT%H:%M:%S.%LZ"),cg=1e3,fg=60*cg,lg=60*fg,hg=24*lg,dg=7*hg,pg=30*hg,yg=365*hg;function vg(t){return new Date(t)}function gg(t){return t instanceof Date?+t:+new Date(+t)}function mg(t,n,e,r,a,o,u,s,c){var f=op(Kd,Kd),l=f.invert,h=f.domain,d=c(".%L"),p=c(":%S"),y=c("%I:%M"),v=c("%I %p"),g=c("%a %d"),m=c("%b %d"),b=c("%B"),x=c("%Y"),_=[[u,1,cg],[u,5,5*cg],[u,15,15*cg],[u,30,30*cg],[o,1,fg],[o,5,5*fg],[o,15,15*fg],[o,30,30*fg],[a,1,lg],[a,3,3*lg],[a,6,6*lg],[a,12,12*lg],[r,1,hg],[r,2,2*hg],[e,1,dg],[n,1,pg],[n,3,3*pg],[t,1,yg]];function w(i){return(u(i)<i?d:o(i)<i?p:a(i)<i?y:r(i)<i?v:n(i)<i?e(i)<i?g:m:t(i)<i?b:x)(i)}function M(n,e,r,a){if(null==n&&(n=10),"number"==typeof n){var o=Math.abs(r-e)/n,u=i((function(t){return t[2]})).right(_,o);u===_.length?(a=k(e/yg,r/yg,n),n=t):u?(a=(u=_[o/_[u-1][2]<_[u][2]/o?u-1:u])[1],n=u[0]):(a=Math.max(k(e,r,n),1),n=s)}return null==a?n:n.every(a)}return f.invert=function(t){return new Date(l(t))},f.domain=function(t){return arguments.length?h(Yd.call(t,gg)):h().map(vg)},f.ticks=function(t,n){var e,r=h(),i=r[0],a=r[r.length-1],o=a<i;return o&&(e=i,i=a,a=e),e=(e=M(t,i,a,n))?e.range(i,a+1):[],o?e.reverse():e},f.tickFormat=function(t,n){return null==n?w:c(n)},f.nice=function(t,n){var e=h();return(t=M(t,e[0],e[e.length-1],n))?h(lp(e,t)):f},f.copy=function(){return ip(f,mg(t,n,e,r,a,o,u,s,c))},f}var bg=function(){return Ud.apply(mg(Vp,qp,Xp,oy,cy,hy,yy,my,Hy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},xg=Rp((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCMonth(t.getUTCMonth()+n)}),(function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),_g=xg,wg=xg.range,Mg=Rp((function(t){t.setUTCMinutes(0,0,0)}),(function(t,n){t.setTime(+t+36e5*n)}),(function(t,n){return(n-t)/36e5}),(function(t){return t.getUTCHours()})),Eg=Mg,Pg=Mg.range,Tg=Rp((function(t){t.setUTCSeconds(0,0)}),(function(t,n){t.setTime(+t+n*Fp)}),(function(t,n){return(n-t)/Fp}),(function(t){return t.getUTCMinutes()})),Cg=Tg,kg=Tg.range,Sg=function(){return Ud.apply(mg(Iy,_g,_y,Oy,Eg,Cg,yy,my,Wy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function Ag(){var t,n,e,r,i,a=0,o=1,u=Kd,s=!1;function c(n){return isNaN(n=+n)?i:u(0===e?.5:(n=(r(n)-t)*e,s?Math.max(0,Math.min(1,n)):n))}return c.domain=function(i){return arguments.length?(t=r(a=+i[0]),n=r(o=+i[1]),e=t===n?0:1/(n-t),c):[a,o]},c.clamp=function(t){return arguments.length?(s=!!t,c):s},c.interpolator=function(t){return arguments.length?(u=t,c):u},c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(a),n=i(o),e=t===n?0:1/(n-t),c}}function Ng(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Bg(){var t=sp(Ag()(Kd));return t.copy=function(){return Ng(t,Bg())},Fd.apply(t,arguments)}function zg(){var t=mp(Ag()).domain([1,10]);return t.copy=function(){return Ng(t,zg()).base(t.base())},Fd.apply(t,arguments)}function Dg(){var t=wp(Ag());return t.copy=function(){return Ng(t,Dg()).constant(t.constant())},Fd.apply(t,arguments)}function Rg(){var t=Cp(Ag());return t.copy=function(){return Ng(t,Rg()).exponent(t.exponent())},Fd.apply(t,arguments)}function Og(){return Rg.apply(null,arguments).exponent(.5)}function Vg(){var t=[],n=Kd;function e(e){if(!isNaN(e=+e))return n((s(t,e)-1)/(t.length-1))}return e.domain=function(n){if(!arguments.length)return t.slice();t=[];for(var i,a=0,o=n.length;a<o;++a)null==(i=n[a])||isNaN(i=+i)||t.push(i);return t.sort(r),e},e.interpolator=function(t){return arguments.length?(n=t,e):n},e.copy=function(){return Vg(n).domain(t)},Fd.apply(e,arguments)}function Lg(){var t,n,e,r,i,a,o,u=0,s=.5,c=1,f=Kd,l=!1;function h(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-n)*(t<n?r:i),f(l?Math.max(0,Math.min(1,t)):t))}return h.domain=function(o){return arguments.length?(t=a(u=+o[0]),n=a(s=+o[1]),e=a(c=+o[2]),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),h):[u,s,c]},h.clamp=function(t){return arguments.length?(l=!!t,h):l},h.interpolator=function(t){return arguments.length?(f=t,h):f},h.unknown=function(t){return arguments.length?(o=t,h):o},function(o){return a=o,t=o(u),n=o(s),e=o(c),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),h}}function Ig(){var t=sp(Lg()(Kd));return t.copy=function(){return Ng(t,Ig())},Fd.apply(t,arguments)}function qg(){var t=mp(Lg()).domain([.1,1,10]);return t.copy=function(){return Ng(t,qg()).base(t.base())},Fd.apply(t,arguments)}function Ug(){var t=wp(Lg());return t.copy=function(){return Ng(t,Ug()).constant(t.constant())},Fd.apply(t,arguments)}function Fg(){var t=Cp(Lg());return t.copy=function(){return Ng(t,Fg()).exponent(t.exponent())},Fd.apply(t,arguments)}function jg(){return Fg.apply(null,arguments).exponent(.5)}var Yg=function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e},Xg=Yg("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Hg=Yg("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Gg=Yg("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Wg=Yg("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),$g=Yg("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Qg=Yg("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Zg=Yg("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Jg=Yg("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Kg=Yg("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),tm=Yg("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),nm=function(t){return yn(t[t.length-1])},em=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Yg),rm=nm(em),im=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Yg),am=nm(im),om=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Yg),um=nm(om),sm=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Yg),cm=nm(sm),fm=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Yg),lm=nm(fm),hm=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Yg),dm=nm(hm),pm=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Yg),ym=nm(pm),vm=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Yg),gm=nm(vm),mm=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Yg),bm=nm(mm),xm=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Yg),_m=nm(xm),wm=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Yg),Mm=nm(wm),Em=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Yg),Pm=nm(Em),Tm=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Yg),Cm=nm(Tm),km=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Yg),Sm=nm(km),Am=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Yg),Nm=nm(Am),Bm=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Yg),zm=nm(Bm),Dm=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Yg),Rm=nm(Dm),Om=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Yg),Vm=nm(Om),Lm=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Yg),Im=nm(Lm),qm=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Yg),Um=nm(qm),Fm=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Yg),jm=nm(Fm),Ym=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Yg),Xm=nm(Ym),Hm=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Yg),Gm=nm(Hm),Wm=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Yg),$m=nm(Wm),Qm=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Yg),Zm=nm(Qm),Jm=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Yg),Km=nm(Jm),tb=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Yg),nb=nm(tb),eb=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},rb=Te(we(300,.5,0),we(-240,.5,1)),ib=Te(we(-100,.75,.35),we(80,1.5,.8)),ab=Te(we(260,.75,.35),we(80,1.5,.8)),ob=we(),ub=function(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return ob.h=360*t-100,ob.s=1.5-1.5*n,ob.l=.8-.9*n,ob+""},sb=Wt(),cb=Math.PI/3,fb=2*Math.PI/3,lb=function(t){var n;return t=(.5-t)*Math.PI,sb.r=255*(n=Math.sin(t))*n,sb.g=255*(n=Math.sin(t+cb))*n,sb.b=255*(n=Math.sin(t+fb))*n,sb+""},hb=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"};function db(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}var pb=db(Yg("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),yb=db(Yg("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),vb=db(Yg("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),gb=db(Yg("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),mb=function(t){return function(){return t}},bb=Math.abs,xb=Math.atan2,_b=Math.cos,wb=Math.max,Mb=Math.min,Eb=Math.sin,Pb=Math.sqrt,Tb=1e-12,Cb=Math.PI,kb=Cb/2,Sb=2*Cb;function Ab(t){return t>=1?kb:t<=-1?-kb:Math.asin(t)}function Nb(t){return t.innerRadius}function Bb(t){return t.outerRadius}function zb(t){return t.startAngle}function Db(t){return t.endAngle}function Rb(t){return t&&t.padAngle}function Ob(t,n,e,r,i,a,o){var u=t-e,s=n-r,c=(o?a:-a)/Pb(u*u+s*s),f=c*s,l=-c*u,h=t+f,d=n+l,p=e+f,y=r+l,v=(h+p)/2,g=(d+y)/2,m=p-h,b=y-d,x=m*m+b*b,_=i-a,w=h*y-p*d,M=(b<0?-1:1)*Pb(wb(0,_*_*x-w*w)),E=(w*b-m*M)/x,P=(-w*m-b*M)/x,T=(w*b+m*M)/x,C=(-w*m+b*M)/x,k=E-v,S=P-g,A=T-v,N=C-g;return k*k+S*S>A*A+N*N&&(E=T,P=C),{cx:E,cy:P,x01:-f,y01:-l,x11:E*(i/_-1),y11:P*(i/_-1)}}var Vb=function(){var t=Nb,n=Bb,e=mb(0),r=null,i=zb,a=Db,o=Rb,u=null;function s(){var s,c,f,l=+t.apply(this,arguments),h=+n.apply(this,arguments),d=i.apply(this,arguments)-kb,p=a.apply(this,arguments)-kb,y=bb(p-d),v=p>d;if(u||(u=s=va()),h<l&&(c=h,h=l,l=c),h>Tb)if(y>Sb-Tb)u.moveTo(h*_b(d),h*Eb(d)),u.arc(0,0,h,d,p,!v),l>Tb&&(u.moveTo(l*_b(p),l*Eb(p)),u.arc(0,0,l,p,d,v));else{var g,m,b=d,x=p,_=d,w=p,M=y,E=y,P=o.apply(this,arguments)/2,T=P>Tb&&(r?+r.apply(this,arguments):Pb(l*l+h*h)),C=Mb(bb(h-l)/2,+e.apply(this,arguments)),k=C,S=C;if(T>Tb){var A=Ab(T/l*Eb(P)),N=Ab(T/h*Eb(P));(M-=2*A)>Tb?(_+=A*=v?1:-1,w-=A):(M=0,_=w=(d+p)/2),(E-=2*N)>Tb?(b+=N*=v?1:-1,x-=N):(E=0,b=x=(d+p)/2)}var B=h*_b(b),z=h*Eb(b),D=l*_b(w),R=l*Eb(w);if(C>Tb){var O,V=h*_b(x),L=h*Eb(x),I=l*_b(_),q=l*Eb(_);if(y<Cb&&(O=function(t,n,e,r,i,a,o,u){var s=e-t,c=r-n,f=o-i,l=u-a,h=l*s-f*c;if(!(h*h<Tb))return[t+(h=(f*(n-a)-l*(t-i))/h)*s,n+h*c]}(B,z,I,q,V,L,D,R))){var U=B-O[0],F=z-O[1],j=V-O[0],Y=L-O[1],X=1/Eb(((f=(U*j+F*Y)/(Pb(U*U+F*F)*Pb(j*j+Y*Y)))>1?0:f<-1?Cb:Math.acos(f))/2),H=Pb(O[0]*O[0]+O[1]*O[1]);k=Mb(C,(l-H)/(X-1)),S=Mb(C,(h-H)/(X+1))}}E>Tb?S>Tb?(g=Ob(I,q,B,z,h,S,v),m=Ob(V,L,D,R,h,S,v),u.moveTo(g.cx+g.x01,g.cy+g.y01),S<C?u.arc(g.cx,g.cy,S,xb(g.y01,g.x01),xb(m.y01,m.x01),!v):(u.arc(g.cx,g.cy,S,xb(g.y01,g.x01),xb(g.y11,g.x11),!v),u.arc(0,0,h,xb(g.cy+g.y11,g.cx+g.x11),xb(m.cy+m.y11,m.cx+m.x11),!v),u.arc(m.cx,m.cy,S,xb(m.y11,m.x11),xb(m.y01,m.x01),!v))):(u.moveTo(B,z),u.arc(0,0,h,b,x,!v)):u.moveTo(B,z),l>Tb&&M>Tb?k>Tb?(g=Ob(D,R,V,L,l,-k,v),m=Ob(B,z,I,q,l,-k,v),u.lineTo(g.cx+g.x01,g.cy+g.y01),k<C?u.arc(g.cx,g.cy,k,xb(g.y01,g.x01),xb(m.y01,m.x01),!v):(u.arc(g.cx,g.cy,k,xb(g.y01,g.x01),xb(g.y11,g.x11),!v),u.arc(0,0,l,xb(g.cy+g.y11,g.cx+g.x11),xb(m.cy+m.y11,m.cx+m.x11),v),u.arc(m.cx,m.cy,k,xb(m.y11,m.x11),xb(m.y01,m.x01),!v))):u.arc(0,0,l,w,_,v):u.lineTo(D,R)}else u.moveTo(0,0);if(u.closePath(),s)return u=null,s+""||null}return s.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Cb/2;return[_b(r)*e,Eb(r)*e]},s.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:mb(+n),s):t},s.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:mb(+t),s):n},s.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:mb(+t),s):e},s.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mb(+t),s):r},s.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:mb(+t),s):i},s.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:mb(+t),s):a},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:mb(+t),s):o},s.context=function(t){return arguments.length?(u=null==t?null:t,s):u},s};function Lb(t){this._context=t}Lb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var Ib=function(t){return new Lb(t)};function qb(t){return t[0]}function Ub(t){return t[1]}var Fb=function(){var t=qb,n=Ub,e=mb(!0),r=null,i=Ib,a=null;function o(o){var u,s,c,f=o.length,l=!1;for(null==r&&(a=i(c=va())),u=0;u<=f;++u)!(u<f&&e(s=o[u],u,o))===l&&((l=!l)?a.lineStart():a.lineEnd()),l&&a.point(+t(s,u,o),+n(s,u,o));if(c)return a=null,c+""||null}return o.x=function(n){return arguments.length?(t="function"==typeof n?n:mb(+n),o):t},o.y=function(t){return arguments.length?(n="function"==typeof t?t:mb(+t),o):n},o.defined=function(t){return arguments.length?(e="function"==typeof t?t:mb(!!t),o):e},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},jb=function(){var t=qb,n=null,e=mb(0),r=Ub,i=mb(!0),a=null,o=Ib,u=null;function s(s){var c,f,l,h,d,p=s.length,y=!1,v=new Array(p),g=new Array(p);for(null==a&&(u=o(d=va())),c=0;c<=p;++c){if(!(c<p&&i(h=s[c],c,s))===y)if(y=!y)f=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),l=c-1;l>=f;--l)u.point(v[l],g[l]);u.lineEnd(),u.areaEnd()}y&&(v[c]=+t(h,c,s),g[c]=+e(h,c,s),u.point(n?+n(h,c,s):v[c],r?+r(h,c,s):g[c]))}if(d)return u=null,d+""||null}function c(){return Fb().defined(i).curve(o).context(a)}return s.x=function(e){return arguments.length?(t="function"==typeof e?e:mb(+e),n=null,s):t},s.x0=function(n){return arguments.length?(t="function"==typeof n?n:mb(+n),s):t},s.x1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:mb(+t),s):n},s.y=function(t){return arguments.length?(e="function"==typeof t?t:mb(+t),r=null,s):e},s.y0=function(t){return arguments.length?(e="function"==typeof t?t:mb(+t),s):e},s.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mb(+t),s):r},s.lineX0=s.lineY0=function(){return c().x(t).y(e)},s.lineY1=function(){return c().x(t).y(r)},s.lineX1=function(){return c().x(n).y(e)},s.defined=function(t){return arguments.length?(i="function"==typeof t?t:mb(!!t),s):i},s.curve=function(t){return arguments.length?(o=t,null!=a&&(u=o(a)),s):o},s.context=function(t){return arguments.length?(null==t?a=u=null:u=o(a=t),s):a},s},Yb=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},Xb=function(t){return t},Hb=function(){var t=Xb,n=Yb,e=null,r=mb(0),i=mb(Sb),a=mb(0);function o(o){var u,s,c,f,l,h=o.length,d=0,p=new Array(h),y=new Array(h),v=+r.apply(this,arguments),g=Math.min(Sb,Math.max(-Sb,i.apply(this,arguments)-v)),m=Math.min(Math.abs(g)/h,a.apply(this,arguments)),b=m*(g<0?-1:1);for(u=0;u<h;++u)(l=y[p[u]=u]=+t(o[u],u,o))>0&&(d+=l);for(null!=n?p.sort((function(t,e){return n(y[t],y[e])})):null!=e&&p.sort((function(t,n){return e(o[t],o[n])})),u=0,c=d?(g-h*b)/d:0;u<h;++u,v=f)s=p[u],f=v+((l=y[s])>0?l*c:0)+b,y[s]={data:o[s],index:u,value:l,startAngle:v,endAngle:f,padAngle:m};return y}return o.value=function(n){return arguments.length?(t="function"==typeof n?n:mb(+n),o):t},o.sortValues=function(t){return arguments.length?(n=t,e=null,o):n},o.sort=function(t){return arguments.length?(e=t,n=null,o):e},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:mb(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:mb(+t),o):i},o.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:mb(+t),o):a},o},Gb=$b(Ib);function Wb(t){this._curve=t}function $b(t){function n(n){return new Wb(t(n))}return n._curve=t,n}function Qb(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n($b(t)):n()._curve},t}Wb.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var Zb=function(){return Qb(Fb().curve(Gb))},Jb=function(){var t=jb().curve(Gb),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Qb(e())},delete t.lineX0,t.lineEndAngle=function(){return Qb(r())},delete t.lineX1,t.lineInnerRadius=function(){return Qb(i())},delete t.lineY0,t.lineOuterRadius=function(){return Qb(a())},delete t.lineY1,t.curve=function(t){return arguments.length?n($b(t)):n()._curve},t},Kb=function(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]},tx=Array.prototype.slice;function nx(t){return t.source}function ex(t){return t.target}function rx(t){var n=nx,e=ex,r=qb,i=Ub,a=null;function o(){var o,u=tx.call(arguments),s=n.apply(this,u),c=e.apply(this,u);if(a||(a=o=va()),t(a,+r.apply(this,(u[0]=s,u)),+i.apply(this,u),+r.apply(this,(u[0]=c,u)),+i.apply(this,u)),o)return a=null,o+""||null}return o.source=function(t){return arguments.length?(n=t,o):n},o.target=function(t){return arguments.length?(e=t,o):e},o.x=function(t){return arguments.length?(r="function"==typeof t?t:mb(+t),o):r},o.y=function(t){return arguments.length?(i="function"==typeof t?t:mb(+t),o):i},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o}function ix(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function ax(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function ox(t,n,e,r,i){var a=Kb(n,e),o=Kb(n,e=(e+i)/2),u=Kb(r,e),s=Kb(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],u[0],u[1],s[0],s[1])}function ux(){return rx(ix)}function sx(){return rx(ax)}function cx(){var t=rx(ox);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var fx={draw:function(t,n){var e=Math.sqrt(n/Cb);t.moveTo(e,0),t.arc(0,0,e,0,Sb)}},lx={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},hx=Math.sqrt(1/3),dx=2*hx,px={draw:function(t,n){var e=Math.sqrt(n/dx),r=e*hx;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},yx=Math.sin(Cb/10)/Math.sin(7*Cb/10),vx=Math.sin(Sb/10)*yx,gx=-Math.cos(Sb/10)*yx,mx={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=vx*e,i=gx*e;t.moveTo(0,-e),t.lineTo(r,i);for(var a=1;a<5;++a){var o=Sb*a/5,u=Math.cos(o),s=Math.sin(o);t.lineTo(s*e,-u*e),t.lineTo(u*r-s*i,s*r+u*i)}t.closePath()}},bx={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},xx=Math.sqrt(3),_x={draw:function(t,n){var e=-Math.sqrt(n/(3*xx));t.moveTo(0,2*e),t.lineTo(-xx*e,-e),t.lineTo(xx*e,-e),t.closePath()}},wx=Math.sqrt(3)/2,Mx=1/Math.sqrt(12),Ex=3*(Mx/2+1),Px={draw:function(t,n){var e=Math.sqrt(n/Ex),r=e/2,i=e*Mx,a=r,o=e*Mx+e,u=-a,s=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(u,s),t.lineTo(-.5*r-wx*i,wx*r+-.5*i),t.lineTo(-.5*a-wx*o,wx*a+-.5*o),t.lineTo(-.5*u-wx*s,wx*u+-.5*s),t.lineTo(-.5*r+wx*i,-.5*i-wx*r),t.lineTo(-.5*a+wx*o,-.5*o-wx*a),t.lineTo(-.5*u+wx*s,-.5*s-wx*u),t.closePath()}},Tx=[fx,lx,px,bx,mx,_x,Px],Cx=function(){var t=mb(fx),n=mb(64),e=null;function r(){var r;if(e||(e=r=va()),t.apply(this,arguments).draw(e,+n.apply(this,arguments)),r)return e=null,r+""||null}return r.type=function(n){return arguments.length?(t="function"==typeof n?n:mb(n),r):t},r.size=function(t){return arguments.length?(n="function"==typeof t?t:mb(+t),r):n},r.context=function(t){return arguments.length?(e=null==t?null:t,r):e},r},kx=function(){};function Sx(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function Ax(t){this._context=t}Ax.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Sx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Sx(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var Nx=function(t){return new Ax(t)};function Bx(t){this._context=t}Bx.prototype={areaStart:kx,areaEnd:kx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:Sx(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var zx=function(t){return new Bx(t)};function Dx(t){this._context=t}Dx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:Sx(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var Rx=function(t){return new Dx(t)};function Ox(t,n){this._basis=new Ax(t),this._beta=n}Ox.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],a=n[0],o=t[e]-i,u=n[e]-a,s=-1;++s<=e;)r=s/e,this._basis.point(this._beta*t[s]+(1-this._beta)*(i+r*o),this._beta*n[s]+(1-this._beta)*(a+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var Vx=function t(n){function e(t){return 1===n?new Ax(t):new Ox(t,n)}return e.beta=function(n){return t(+n)},e}(.85);function Lx(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function Ix(t,n){this._context=t,this._k=(1-n)/6}Ix.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Lx(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:Lx(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var qx=function t(n){function e(t){return new Ix(t,n)}return e.tension=function(n){return t(+n)},e}(0);function Ux(t,n){this._context=t,this._k=(1-n)/6}Ux.prototype={areaStart:kx,areaEnd:kx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:Lx(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Fx=function t(n){function e(t){return new Ux(t,n)}return e.tension=function(n){return t(+n)},e}(0);function jx(t,n){this._context=t,this._k=(1-n)/6}jx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lx(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Yx=function t(n){function e(t){return new jx(t,n)}return e.tension=function(n){return t(+n)},e}(0);function Xx(t,n,e){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Tb){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>Tb){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*c+t._x1*t._l23_2a-n*t._l12_2a)/f,o=(o*c+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function Hx(t,n){this._context=t,this._alpha=n}Hx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:Xx(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Gx=function t(n){function e(t){return n?new Hx(t,n):new Ix(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function Wx(t,n){this._context=t,this._alpha=n}Wx.prototype={areaStart:kx,areaEnd:kx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:Xx(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var $x=function t(n){function e(t){return n?new Wx(t,n):new Ux(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function Qx(t,n){this._context=t,this._alpha=n}Qx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Xx(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Zx=function t(n){function e(t){return n?new Qx(t,n):new jx(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function Jx(t){this._context=t}Jx.prototype={areaStart:kx,areaEnd:kx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}};var Kx=function(t){return new Jx(t)};function t_(t){return t<0?-1:1}function n_(t,n,e){var r=t._x1-t._x0,i=n-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(e-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(t_(a)+t_(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function e_(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function r_(t,n,e){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*n,a-u,o-u*e,a,o)}function i_(t){this._context=t}function a_(t){this._context=new o_(t)}function o_(t){this._context=t}function u_(t){return new i_(t)}function s_(t){return new a_(t)}function c_(t){this._context=t}function f_(t){var n,e,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,a[n]=4,o[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/a[n-1],a[n]-=e,o[n]-=e*o[n-1];for(i[r-1]=o[r-1]/a[r-1],n=r-2;n>=0;--n)i[n]=(o[n]-i[n+1])/a[n];for(a[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)a[n]=2*t[n+1]-i[n+1];return[i,a]}i_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:r_(this,this._t0,e_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,r_(this,e_(this,e=n_(this,t,n)),e);break;default:r_(this,this._t0,e=n_(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(a_.prototype=Object.create(i_.prototype)).point=function(t,n){i_.prototype.point.call(this,n,t)},o_.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,a){this._context.bezierCurveTo(n,t,r,e,a,i)}},c_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=f_(t),i=f_(n),a=0,o=1;o<e;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],n[o]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var l_=function(t){return new c_(t)};function h_(t,n){this._context=t,this._t=n}h_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}};var d_=function(t){return new h_(t,.5)};function p_(t){return new h_(t,0)}function y_(t){return new h_(t,1)}var v_=function(t,n){if((i=t.length)>1)for(var e,r,i,a=1,o=t[n[0]],u=o.length;a<i;++a)for(r=o,o=t[n[a]],e=0;e<u;++e)o[e][1]+=o[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]},g_=function(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e};function m_(t,n){return t[n]}var b_=function(){var t=mb([]),n=g_,e=v_,r=m_;function i(i){var a,o,u=t.apply(this,arguments),s=i.length,c=u.length,f=new Array(c);for(a=0;a<c;++a){for(var l,h=u[a],d=f[a]=new Array(s),p=0;p<s;++p)d[p]=l=[0,+r(i[p],h,p,i)],l.data=i[p];d.key=h}for(a=0,o=n(f);a<c;++a)f[o[a]].index=a;return e(f,o),f}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:mb(tx.call(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:mb(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?g_:"function"==typeof t?t:mb(tx.call(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?v_:t,i):e},i},x_=function(t,n){if((r=t.length)>0){for(var e,r,i,a=0,o=t[0].length;a<o;++a){for(i=e=0;e<r;++e)i+=t[e][a][1]||0;if(i)for(e=0;e<r;++e)t[e][a][1]/=i}v_(t,n)}},__=function(t,n){if((u=t.length)>0)for(var e,r,i,a,o,u,s=0,c=t[n[0]].length;s<c;++s)for(a=o=0,e=0;e<u;++e)(i=(r=t[n[e]][s])[1]-r[0])>=0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):r[0]=a},w_=function(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],a=i.length;r<a;++r){for(var o=0,u=0;o<e;++o)u+=t[o][r][1]||0;i[r][1]+=i[r][0]=-u/2}v_(t,n)}},M_=function(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,a=0,o=1;o<r;++o){for(var u=0,s=0,c=0;u<i;++u){for(var f=t[n[u]],l=f[o][1]||0,h=(l-(f[o-1][1]||0))/2,d=0;d<u;++d){var p=t[n[d]];h+=(p[o][1]||0)-(p[o-1][1]||0)}s+=l,c+=h*l}e[o-1][1]+=e[o-1][0]=a,s&&(a-=c/s)}e[o-1][1]+=e[o-1][0]=a,v_(t,n)}},E_=function(t){var n=t.map(P_);return g_(t).sort((function(t,e){return n[t]-n[e]}))};function P_(t){for(var n,e=-1,r=0,i=t.length,a=-1/0;++e<i;)(n=+t[e][1])>a&&(a=n,r=e);return r}var T_=function(t){var n=t.map(C_);return g_(t).sort((function(t,e){return n[t]-n[e]}))};function C_(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}var k_=function(t){return T_(t).reverse()},S_=function(t){var n,e,r=t.length,i=t.map(C_),a=E_(t),o=0,u=0,s=[],c=[];for(n=0;n<r;++n)e=a[n],o<u?(o+=i[e],s.push(e)):(u+=i[e],c.push(e));return c.reverse().concat(s)},A_=function(t){return g_(t).reverse()},N_=function(t){return function(){return t}};function B_(t){return t[0]}function z_(t){return t[1]}function D_(){this._=null}function R_(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function O_(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function V_(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function L_(t){for(;t.L;)t=t.L;return t}D_.prototype={constructor:D_,insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=L_(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(O_(this,e),e=(t=e).U),e.C=!1,r.C=!0,V_(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(V_(this,e),e=(t=e).U),e.C=!1,r.C=!0,O_(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,a=t.L,o=t.R;if(e=a?o?L_(o):a:o,i?i.L===t?i.L=e:i.R=e:this._=e,a&&o?(r=e.C,e.C=t.C,e.L=a,a.U=e,e!==o?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=o,o.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,O_(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,V_(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,O_(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,V_(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,O_(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,V_(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var I_=D_;function q_(t,n,e,r){var i=[null,null],a=fw.push(i)-1;return i.left=t,i.right=n,e&&F_(i,t,n,e),r&&F_(i,n,t,r),sw[t.index].halfedges.push(a),sw[n.index].halfedges.push(a),i}function U_(t,n,e){var r=[n,e];return r.left=t,r}function F_(t,n,e,r){t[0]||t[1]?t.left===e?t[1]=r:t[0]=r:(t[0]=r,t.left=n,t.right=e)}function j_(t,n,e,r,i){var a,o=t[0],u=t[1],s=o[0],c=o[1],f=0,l=1,h=u[0]-s,d=u[1]-c;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<f)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>f&&(f=a)}if(a=r-s,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>f&&(f=a)}else if(h>0){if(a<f)return;a<l&&(l=a)}if(a=e-c,d||!(a>0)){if(a/=d,d<0){if(a<f)return;a<l&&(l=a)}else if(d>0){if(a>l)return;a>f&&(f=a)}if(a=i-c,d||!(a<0)){if(a/=d,d<0){if(a>l)return;a>f&&(f=a)}else if(d>0){if(a<f)return;a<l&&(l=a)}return!(f>0||l<1)||(f>0&&(t[0]=[s+f*h,c+f*d]),l<1&&(t[1]=[s+l*h,c+l*d]),!0)}}}}}function Y_(t,n,e,r,i){var a=t[1];if(a)return!0;var o,u,s=t[0],c=t.left,f=t.right,l=c[0],h=c[1],d=f[0],p=f[1],y=(l+d)/2,v=(h+p)/2;if(p===h){if(y<n||y>=r)return;if(l>d){if(s){if(s[1]>=i)return}else s=[y,e];a=[y,i]}else{if(s){if(s[1]<e)return}else s=[y,i];a=[y,e]}}else if(u=v-(o=(l-d)/(p-h))*y,o<-1||o>1)if(l>d){if(s){if(s[1]>=i)return}else s=[(e-u)/o,e];a=[(i-u)/o,i]}else{if(s){if(s[1]<e)return}else s=[(i-u)/o,i];a=[(e-u)/o,e]}else if(h<p){if(s){if(s[0]>=r)return}else s=[n,o*n+u];a=[r,o*r+u]}else{if(s){if(s[0]<n)return}else s=[r,o*r+u];a=[n,o*n+u]}return t[0]=s,t[1]=a,!0}function X_(t,n){var e=t.site,r=n.left,i=n.right;return e===i&&(i=r,r=e),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(e===r?(r=n[1],i=n[0]):(r=n[0],i=n[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function H_(t,n){return n[+(n.left!==t.site)]}function G_(t,n){return n[+(n.left===t.site)]}var W_,$_=[];function Q_(){R_(this),this.x=this.y=this.arc=this.site=this.cy=null}function Z_(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,a=e.site;if(r!==a){var o=i[0],u=i[1],s=r[0]-o,c=r[1]-u,f=a[0]-o,l=a[1]-u,h=2*(s*l-c*f);if(!(h>=-hw)){var d=s*s+c*c,p=f*f+l*l,y=(l*d-c*p)/h,v=(s*p-f*d)/h,g=$_.pop()||new Q_;g.arc=t,g.site=i,g.x=y+o,g.y=(g.cy=v+u)+Math.sqrt(y*y+v*v),t.circle=g;for(var m=null,b=cw._;b;)if(g.y<b.y||g.y===b.y&&g.x<=b.x){if(!b.L){m=b.P;break}b=b.L}else{if(!b.R){m=b;break}b=b.R}cw.insert(m,g),m||(W_=g)}}}}function J_(t){var n=t.circle;n&&(n.P||(W_=n.N),cw.remove(n),$_.push(n),R_(n),t.circle=null)}var K_=[];function tw(){R_(this),this.edge=this.site=this.circle=null}function nw(t){var n=K_.pop()||new tw;return n.site=t,n}function ew(t){J_(t),uw.remove(t),K_.push(t),R_(t)}function rw(t){var n=t.circle,e=n.x,r=n.cy,i=[e,r],a=t.P,o=t.N,u=[t];ew(t);for(var s=a;s.circle&&Math.abs(e-s.circle.x)<lw&&Math.abs(r-s.circle.cy)<lw;)a=s.P,u.unshift(s),ew(s),s=a;u.unshift(s),J_(s);for(var c=o;c.circle&&Math.abs(e-c.circle.x)<lw&&Math.abs(r-c.circle.cy)<lw;)o=c.N,u.push(c),ew(c),c=o;u.push(c),J_(c);var f,l=u.length;for(f=1;f<l;++f)c=u[f],s=u[f-1],F_(c.edge,s.site,c.site,i);s=u[0],(c=u[l-1]).edge=q_(s.site,c.site,null,i),Z_(s),Z_(c)}function iw(t){for(var n,e,r,i,a=t[0],o=t[1],u=uw._;u;)if((r=aw(u,o)-a)>lw)u=u.L;else{if(!((i=a-ow(u,o))>lw)){r>-lw?(n=u.P,e=u):i>-lw?(n=u,e=u.N):n=e=u;break}if(!u.R){n=u;break}u=u.R}!function(t){sw[t.index]={site:t,halfedges:[]}}(t);var s=nw(t);if(uw.insert(n,s),n||e){if(n===e)return J_(n),e=nw(n.site),uw.insert(s,e),s.edge=e.edge=q_(n.site,s.site),Z_(n),void Z_(e);if(e){J_(n),J_(e);var c=n.site,f=c[0],l=c[1],h=t[0]-f,d=t[1]-l,p=e.site,y=p[0]-f,v=p[1]-l,g=2*(h*v-d*y),m=h*h+d*d,b=y*y+v*v,x=[(v*m-d*b)/g+f,(h*b-y*m)/g+l];F_(e.edge,c,p,x),s.edge=q_(c,t,null,x),e.edge=q_(t,p,null,x),Z_(n),Z_(e)}else s.edge=q_(n.site,s.site)}}function aw(t,n){var e=t.site,r=e[0],i=e[1],a=i-n;if(!a)return r;var o=t.P;if(!o)return-1/0;var u=(e=o.site)[0],s=e[1],c=s-n;if(!c)return u;var f=u-r,l=1/a-1/c,h=f/c;return l?(-h+Math.sqrt(h*h-2*l*(f*f/(-2*c)-s+c/2+i-a/2)))/l+r:(r+u)/2}function ow(t,n){var e=t.N;if(e)return aw(e,n);var r=t.site;return r[1]===n?r[0]:1/0}var uw,sw,cw,fw,lw=1e-6,hw=1e-12;function dw(t,n){return n[1]-t[1]||n[0]-t[0]}function pw(t,n){var e,r,i,a=t.sort(dw).pop();for(fw=[],sw=new Array(t.length),uw=new I_,cw=new I_;;)if(i=W_,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===e&&a[1]===r||(iw(a),e=a[0],r=a[1]),a=t.pop();else{if(!i)break;rw(i.arc)}if(function(){for(var t,n,e,r,i=0,a=sw.length;i<a;++i)if((t=sw[i])&&(r=(n=t.halfedges).length)){var o=new Array(r),u=new Array(r);for(e=0;e<r;++e)o[e]=e,u[e]=X_(t,fw[n[e]]);for(o.sort((function(t,n){return u[n]-u[t]})),e=0;e<r;++e)u[e]=n[o[e]];for(e=0;e<r;++e)n[e]=u[e]}}(),n){var o=+n[0][0],u=+n[0][1],s=+n[1][0],c=+n[1][1];!function(t,n,e,r){for(var i,a=fw.length;a--;)Y_(i=fw[a],t,n,e,r)&&j_(i,t,n,e,r)&&(Math.abs(i[0][0]-i[1][0])>lw||Math.abs(i[0][1]-i[1][1])>lw)||delete fw[a]}(o,u,s,c),function(t,n,e,r){var i,a,o,u,s,c,f,l,h,d,p,y,v=sw.length,g=!0;for(i=0;i<v;++i)if(a=sw[i]){for(o=a.site,u=(s=a.halfedges).length;u--;)fw[s[u]]||s.splice(u,1);for(u=0,c=s.length;u<c;)p=(d=G_(a,fw[s[u]]))[0],y=d[1],l=(f=H_(a,fw[s[++u%c]]))[0],h=f[1],(Math.abs(p-l)>lw||Math.abs(y-h)>lw)&&(s.splice(u,0,fw.push(U_(o,d,Math.abs(p-t)<lw&&r-y>lw?[t,Math.abs(l-t)<lw?h:r]:Math.abs(y-r)<lw&&e-p>lw?[Math.abs(h-r)<lw?l:e,r]:Math.abs(p-e)<lw&&y-n>lw?[e,Math.abs(l-e)<lw?h:n]:Math.abs(y-n)<lw&&p-t>lw?[Math.abs(h-n)<lw?l:t,n]:null))-1),++c);c&&(g=!1)}if(g){var m,b,x,_=1/0;for(i=0,g=null;i<v;++i)(a=sw[i])&&(x=(m=(o=a.site)[0]-t)*m+(b=o[1]-n)*b)<_&&(_=x,g=a);if(g){var w=[t,n],M=[t,r],E=[e,r],P=[e,n];g.halfedges.push(fw.push(U_(o=g.site,w,M))-1,fw.push(U_(o,M,E))-1,fw.push(U_(o,E,P))-1,fw.push(U_(o,P,w))-1)}}for(i=0;i<v;++i)(a=sw[i])&&(a.halfedges.length||delete sw[i])}(o,u,s,c)}this.edges=fw,this.cells=sw,uw=cw=fw=sw=null}pw.prototype={constructor:pw,polygons:function(){var t=this.edges;return this.cells.map((function(n){var e=n.halfedges.map((function(e){return H_(n,t[e])}));return e.data=n.site.data,e}))},triangles:function(){var t=[],n=this.edges;return this.cells.forEach((function(e,r){if(a=(i=e.halfedges).length)for(var i,a,o,u,s,c,f=e.site,l=-1,h=n[i[a-1]],d=h.left===f?h.right:h.left;++l<a;)o=d,d=(h=n[i[l]]).left===f?h.right:h.left,o&&d&&r<o.index&&r<d.index&&(s=o,c=d,((u=f)[0]-c[0])*(s[1]-u[1])-(u[0]-s[0])*(c[1]-u[1])<0)&&t.push([f.data,o.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,n,e){for(var r,i,a=this,o=a._found||0,u=a.cells.length;!(i=a.cells[o]);)if(++o>=u)return null;var s=t-i.site[0],c=n-i.site[1],f=s*s+c*c;do{i=a.cells[r=o],o=null,i.halfedges.forEach((function(e){var r=a.edges[e],u=r.left;if(u!==i.site&&u||(u=r.right)){var s=t-u[0],c=n-u[1],l=s*s+c*c;l<f&&(f=l,o=u.index)}}))}while(null!==o);return a._found=r,null==e||f<=e*e?i.site:null}};var yw=function(){var t=B_,n=z_,e=null;function r(r){return new pw(r.map((function(e,i){var a=[Math.round(t(e,i,r)/lw)*lw,Math.round(n(e,i,r)/lw)*lw];return a.index=i,a.data=e,a})),e)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(n){return arguments.length?(t="function"==typeof n?n:N_(+n),r):t},r.y=function(t){return arguments.length?(n="function"==typeof t?t:N_(+t),r):n},r.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},r.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],r):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},r},vw=function(t){return function(){return t}};function gw(t,n,e){this.target=t,this.type=n,this.transform=e}function mw(t,n,e){this.k=t,this.x=n,this.y=e}mw.prototype={constructor:mw,scale:function(t){return 1===t?this:new mw(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new mw(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bw=new mw(1,0,0);function xw(t){for(;!t.__zoom;)if(!(t=t.parentNode))return bw;return t.__zoom}function _w(){vt.e.stopImmediatePropagation()}xw.prototype=mw.prototype;var ww=function(){vt.e.preventDefault(),vt.e.stopImmediatePropagation()};function Mw(){return!vt.e.ctrlKey&&!vt.e.button}function Ew(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Pw(){return this.__zoom||bw}function Tw(){return-vt.e.deltaY*(1===vt.e.deltaMode?.05:vt.e.deltaMode?1:.002)}function Cw(){return navigator.maxTouchPoints||"ontouchstart"in this}function kw(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],a=t.invertY(n[0][1])-e[0][1],o=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var Sw=function(){var t,n,e=Mw,r=Ew,i=kw,a=Tw,o=Cw,u=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],c=250,f=qn,l=yt("start","zoom","end"),h=500,d=150,p=0;function y(t){t.property("__zoom",Pw).on("wheel.zoom",w).on("mousedown.zoom",M).on("dblclick.zoom",E).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,n){return(n=Math.max(u[0],Math.min(u[1],n)))===t.k?t:new mw(n,t.x,t.y)}function g(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new mw(t.k,r,i)}function m(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,n,e){t.on("start.zoom",(function(){x(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,a=x(t,i),o=r.apply(t,i),u=null==e?m(o):"function"==typeof e?e.apply(t,i):e,s=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=t.__zoom,l="function"==typeof n?n.apply(t,i):n,h=f(c.invert(u).concat(s/c.k),l.invert(u).concat(s/l.k));return function(t){if(1===t)t=l;else{var n=h(t),e=s/n[2];t=new mw(e,u[0]-n[0]*e,u[1]-n[1]*e)}a.zoom(null,t)}}))}function x(t,n,e){return!e&&t.__zooming||new _(t,n)}function _(t,n){this.that=t,this.args=n,this.active=0,this.extent=r.apply(t,n),this.taps=0}function w(){if(e.apply(this,arguments)){var t=x(this,arguments),n=this.__zoom,r=Math.max(u[0],Math.min(u[1],n.k*Math.pow(2,a.apply(this,arguments)))),o=Object(vt.h)(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=n.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(n.k===r)return;t.mouse=[o,n.invert(o)],cr(this),t.start()}ww(),t.wheel=setTimeout((function(){t.wheel=null,t.end()}),d),t.zoom("mouse",i(g(v(n,r),t.mouse[0],t.mouse[1]),t.extent,s))}}function M(){if(!n&&e.apply(this,arguments)){var t=x(this,arguments,!0),r=Object(vt.k)(vt.e.view).on("mousemove.zoom",(function(){if(ww(),!t.moved){var n=vt.e.clientX-o,e=vt.e.clientY-u;t.moved=n*n+e*e>p}t.zoom("mouse",i(g(t.that.__zoom,t.mouse[0]=Object(vt.h)(t.that),t.mouse[1]),t.extent,s))}),!0).on("mouseup.zoom",(function(){r.on("mousemove.zoom mouseup.zoom",null),xt(vt.e.view,t.moved),ww(),t.end()}),!0),a=Object(vt.h)(this),o=vt.e.clientX,u=vt.e.clientY;bt(vt.e.view),_w(),t.mouse=[a,this.__zoom.invert(a)],cr(this),t.start()}}function E(){if(e.apply(this,arguments)){var t=this.__zoom,n=Object(vt.h)(this),a=t.invert(n),o=t.k*(vt.e.shiftKey?.5:2),u=i(g(v(t,o),n,a),r.apply(this,arguments),s);ww(),c>0?Object(vt.k)(this).transition().duration(c).call(b,u,n):Object(vt.k)(this).call(y.transform,u)}}function P(){if(e.apply(this,arguments)){var n,r,i,a,o=vt.e.touches,u=o.length,s=x(this,arguments,vt.e.changedTouches.length===u);for(_w(),r=0;r<u;++r)i=o[r],a=[a=Object(vt.q)(this,o,i.identifier),this.__zoom.invert(a),i.identifier],s.touch0?s.touch1||s.touch0[2]===a[2]||(s.touch1=a,s.taps=0):(s.touch0=a,n=!0,s.taps=1+!!t);t&&(t=clearTimeout(t)),n&&(s.taps<2&&(t=setTimeout((function(){t=null}),h)),cr(this),s.start())}}function T(){if(this.__zooming){var n,e,r,a,o=x(this,arguments),u=vt.e.changedTouches,c=u.length;for(ww(),t&&(t=clearTimeout(t)),o.taps=0,n=0;n<c;++n)e=u[n],r=Object(vt.q)(this,u,e.identifier),o.touch0&&o.touch0[2]===e.identifier?o.touch0[0]=r:o.touch1&&o.touch1[2]===e.identifier&&(o.touch1[0]=r);if(e=o.that.__zoom,o.touch1){var f=o.touch0[0],l=o.touch0[1],h=o.touch1[0],d=o.touch1[1],p=(p=h[0]-f[0])*p+(p=h[1]-f[1])*p,y=(y=d[0]-l[0])*y+(y=d[1]-l[1])*y;e=v(e,Math.sqrt(p/y)),r=[(f[0]+h[0])/2,(f[1]+h[1])/2],a=[(l[0]+d[0])/2,(l[1]+d[1])/2]}else{if(!o.touch0)return;r=o.touch0[0],a=o.touch0[1]}o.zoom("touch",i(g(e,r,a),o.extent,s))}}function C(){if(this.__zooming){var t,e,r=x(this,arguments),i=vt.e.changedTouches,a=i.length;for(_w(),n&&clearTimeout(n),n=setTimeout((function(){n=null}),h),t=0;t<a;++t)e=i[t],r.touch0&&r.touch0[2]===e.identifier?delete r.touch0:r.touch1&&r.touch1[2]===e.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var o=Object(vt.k)(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return y.transform=function(t,n,e){var r=t.selection?t.selection():t;r.property("__zoom",Pw),t!==r?b(t,n,e):r.interrupt().each((function(){x(this,arguments).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()}))},y.scaleBy=function(t,n,e){y.scaleTo(t,(function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e}),e)},y.scaleTo=function(t,n,e){y.transform(t,(function(){var t=r.apply(this,arguments),a=this.__zoom,o=null==e?m(t):"function"==typeof e?e.apply(this,arguments):e,u=a.invert(o),c="function"==typeof n?n.apply(this,arguments):n;return i(g(v(a,c),o,u),t,s)}),e)},y.translateBy=function(t,n,e){y.transform(t,(function(){return i(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),r.apply(this,arguments),s)}))},y.translateTo=function(t,n,e,a){y.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,u=null==a?m(t):"function"==typeof a?a.apply(this,arguments):a;return i(bw.translate(u[0],u[1]).scale(o.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,s)}),a)},_.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){Object(vt.d)(new gw(y,t,this.that.__zoom),l.apply,l,[t,this.that,this.args])}},y.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:vw(+t),y):a},y.filter=function(t){return arguments.length?(e="function"==typeof t?t:vw(!!t),y):e},y.touchable=function(t){return arguments.length?(o="function"==typeof t?t:vw(!!t),y):o},y.extent=function(t){return arguments.length?(r="function"==typeof t?t:vw([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):r},y.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],y):[u[0],u[1]]},y.translateExtent=function(t){return arguments.length?(s[0][0]=+t[0][0],s[1][0]=+t[1][0],s[0][1]=+t[0][1],s[1][1]=+t[1][1],y):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},y.constrain=function(t){return arguments.length?(i=t,y):i},y.duration=function(t){return arguments.length?(c=+t,y):c},y.interpolate=function(t){return arguments.length?(f=t,y):f},y.on=function(){var t=l.on.apply(l,arguments);return t===l?y:t},y.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,y):Math.sqrt(p)},y};e.d(n,"version",(function(){return"5.12.0"})),e.d(n,"bisect",(function(){return s})),e.d(n,"bisectRight",(function(){return o})),e.d(n,"bisectLeft",(function(){return u})),e.d(n,"ascending",(function(){return r})),e.d(n,"bisector",(function(){return i})),e.d(n,"cross",(function(){return l})),e.d(n,"descending",(function(){return h})),e.d(n,"deviation",(function(){return y})),e.d(n,"extent",(function(){return v})),e.d(n,"histogram",(function(){return A})),e.d(n,"thresholdFreedmanDiaconis",(function(){return B})),e.d(n,"thresholdScott",(function(){return z})),e.d(n,"thresholdSturges",(function(){return S})),e.d(n,"max",(function(){return D})),e.d(n,"mean",(function(){return R})),e.d(n,"median",(function(){return O})),e.d(n,"merge",(function(){return V})),e.d(n,"min",(function(){return L})),e.d(n,"pairs",(function(){return c})),e.d(n,"permute",(function(){return I})),e.d(n,"quantile",(function(){return N})),e.d(n,"range",(function(){return w})),e.d(n,"scan",(function(){return q})),e.d(n,"shuffle",(function(){return U})),e.d(n,"sum",(function(){return F})),e.d(n,"ticks",(function(){return T})),e.d(n,"tickIncrement",(function(){return C})),e.d(n,"tickStep",(function(){return k})),e.d(n,"transpose",(function(){return j})),e.d(n,"variance",(function(){return p})),e.d(n,"zip",(function(){return X})),e.d(n,"axisTop",(function(){return at})),e.d(n,"axisRight",(function(){return ot})),e.d(n,"axisBottom",(function(){return ut})),e.d(n,"axisLeft",(function(){return st})),e.d(n,"brush",(function(){return Ki})),e.d(n,"brushX",(function(){return Zi})),e.d(n,"brushY",(function(){return Ji})),e.d(n,"brushSelection",(function(){return Qi})),e.d(n,"chord",(function(){return sa})),e.d(n,"ribbon",(function(){return wa})),e.d(n,"nest",(function(){return Ma.d})),e.d(n,"set",(function(){return Ma.e})),e.d(n,"map",(function(){return Ma.c})),e.d(n,"keys",(function(){return Ma.b})),e.d(n,"values",(function(){return Ma.f})),e.d(n,"entries",(function(){return Ma.a})),e.d(n,"color",(function(){return Yt})),e.d(n,"rgb",(function(){return Wt})),e.d(n,"hsl",(function(){return nn})),e.d(n,"lab",(function(){return ne})),e.d(n,"hcl",(function(){return ce})),e.d(n,"lch",(function(){return se})),e.d(n,"gray",(function(){return te})),e.d(n,"cubehelix",(function(){return we})),e.d(n,"contours",(function(){return za})),e.d(n,"contourDensity",(function(){return Ia})),e.d(n,"dispatch",(function(){return yt})),e.d(n,"drag",(function(){return Ct})),e.d(n,"dragDisable",(function(){return bt})),e.d(n,"dragEnable",(function(){return xt})),e.d(n,"dsvFormat",(function(){return $a})),e.d(n,"csvParse",(function(){return Za})),e.d(n,"csvParseRows",(function(){return Ja})),e.d(n,"csvFormat",(function(){return Ka})),e.d(n,"csvFormatBody",(function(){return to})),e.d(n,"csvFormatRows",(function(){return no})),e.d(n,"tsvParse",(function(){return ro})),e.d(n,"tsvParseRows",(function(){return io})),e.d(n,"tsvFormat",(function(){return ao})),e.d(n,"tsvFormatBody",(function(){return oo})),e.d(n,"tsvFormatRows",(function(){return uo})),e.d(n,"autoType",(function(){return so})),e.d(n,"easeLinear",(function(){return Or})),e.d(n,"easeQuad",(function(){return Ir})),e.d(n,"easeQuadIn",(function(){return Vr})),e.d(n,"easeQuadOut",(function(){return Lr})),e.d(n,"easeQuadInOut",(function(){return Ir})),e.d(n,"easeCubic",(function(){return Fr})),e.d(n,"easeCubicIn",(function(){return qr})),e.d(n,"easeCubicOut",(function(){return Ur})),e.d(n,"easeCubicInOut",(function(){return Fr})),e.d(n,"easePoly",(function(){return Xr})),e.d(n,"easePolyIn",(function(){return jr})),e.d(n,"easePolyOut",(function(){return Yr})),e.d(n,"easePolyInOut",(function(){return Xr})),e.d(n,"easeSin",(function(){return Qr})),e.d(n,"easeSinIn",(function(){return Wr})),e.d(n,"easeSinOut",(function(){return $r})),e.d(n,"easeSinInOut",(function(){return Qr})),e.d(n,"easeExp",(function(){return Kr})),e.d(n,"easeExpIn",(function(){return Zr})),e.d(n,"easeExpOut",(function(){return Jr})),e.d(n,"easeExpInOut",(function(){return Kr})),e.d(n,"easeCircle",(function(){return ei})),e.d(n,"easeCircleIn",(function(){return ti})),e.d(n,"easeCircleOut",(function(){return ni})),e.d(n,"easeCircleInOut",(function(){return ei})),e.d(n,"easeBounce",(function(){return pi})),e.d(n,"easeBounceIn",(function(){return di})),e.d(n,"easeBounceOut",(function(){return pi})),e.d(n,"easeBounceInOut",(function(){return yi})),e.d(n,"easeBack",(function(){return mi})),e.d(n,"easeBackIn",(function(){return vi})),e.d(n,"easeBackOut",(function(){return gi})),e.d(n,"easeBackInOut",(function(){return mi})),e.d(n,"easeElastic",(function(){return _i})),e.d(n,"easeElasticIn",(function(){return xi})),e.d(n,"easeElasticOut",(function(){return _i})),e.d(n,"easeElasticInOut",(function(){return wi})),e.d(n,"blob",(function(){return fo})),e.d(n,"buffer",(function(){return ho})),e.d(n,"dsv",(function(){return go})),e.d(n,"csv",(function(){return mo})),e.d(n,"tsv",(function(){return bo})),e.d(n,"image",(function(){return xo})),e.d(n,"json",(function(){return wo})),e.d(n,"text",(function(){return yo})),e.d(n,"xml",(function(){return Eo})),e.d(n,"html",(function(){return Po})),e.d(n,"svg",(function(){return To})),e.d(n,"forceCenter",(function(){return Co})),e.d(n,"forceCollide",(function(){return qo})),e.d(n,"forceLink",(function(){return jo})),e.d(n,"forceManyBody",(function(){return $o})),e.d(n,"forceRadial",(function(){return Qo})),e.d(n,"forceSimulation",(function(){return Wo})),e.d(n,"forceX",(function(){return Zo})),e.d(n,"forceY",(function(){return Jo})),e.d(n,"formatDefaultLocale",(function(){return yu})),e.d(n,"format",(function(){return ou})),e.d(n,"formatPrefix",(function(){return uu})),e.d(n,"formatLocale",(function(){return pu})),e.d(n,"formatSpecifier",(function(){return eu})),e.d(n,"FormatSpecifier",(function(){return ru})),e.d(n,"precisionFixed",(function(){return vu})),e.d(n,"precisionPrefix",(function(){return gu})),e.d(n,"precisionRound",(function(){return mu})),e.d(n,"geoArea",(function(){return ls})),e.d(n,"geoBounds",(function(){return rc})),e.d(n,"geoCentroid",(function(){return yc})),e.d(n,"geoCircle",(function(){return Tc})),e.d(n,"geoClipAntimeridian",(function(){return Lc})),e.d(n,"geoClipCircle",(function(){return Ic})),e.d(n,"geoClipExtent",(function(){return Gc})),e.d(n,"geoClipRectangle",(function(){return jc})),e.d(n,"geoContains",(function(){return hf})),e.d(n,"geoDistance",(function(){return ef})),e.d(n,"geoGraticule",(function(){return yf})),e.d(n,"geoGraticule10",(function(){return vf})),e.d(n,"geoInterpolate",(function(){return _f})),e.d(n,"geoLength",(function(){return Kc})),e.d(n,"geoPath",(function(){return bl})),e.d(n,"geoAlbers",(function(){return Il})),e.d(n,"geoAlbersUsa",(function(){return ql})),e.d(n,"geoAzimuthalEqualArea",(function(){return Yl})),e.d(n,"geoAzimuthalEqualAreaRaw",(function(){return jl})),e.d(n,"geoAzimuthalEquidistant",(function(){return Hl})),e.d(n,"geoAzimuthalEquidistantRaw",(function(){return Xl})),e.d(n,"geoConicConformal",(function(){return Jl})),e.d(n,"geoConicConformalRaw",(function(){return Zl})),e.d(n,"geoConicEqualArea",(function(){return Ll})),e.d(n,"geoConicEqualAreaRaw",(function(){return Vl})),e.d(n,"geoConicEquidistant",(function(){return eh})),e.d(n,"geoConicEquidistantRaw",(function(){return nh})),e.d(n,"geoEqualEarth",(function(){return ch})),e.d(n,"geoEqualEarthRaw",(function(){return sh})),e.d(n,"geoEquirectangular",(function(){return th})),e.d(n,"geoEquirectangularRaw",(function(){return Kl})),e.d(n,"geoGnomonic",(function(){return lh})),e.d(n,"geoGnomonicRaw",(function(){return fh})),e.d(n,"geoIdentity",(function(){return dh})),e.d(n,"geoProjection",(function(){return Dl})),e.d(n,"geoProjectionMutator",(function(){return Rl})),e.d(n,"geoMercator",(function(){return Wl})),e.d(n,"geoMercatorRaw",(function(){return Gl})),e.d(n,"geoNaturalEarth1",(function(){return yh})),e.d(n,"geoNaturalEarth1Raw",(function(){return ph})),e.d(n,"geoOrthographic",(function(){return gh})),e.d(n,"geoOrthographicRaw",(function(){return vh})),e.d(n,"geoStereographic",(function(){return bh})),e.d(n,"geoStereographicRaw",(function(){return mh})),e.d(n,"geoTransverseMercator",(function(){return _h})),e.d(n,"geoTransverseMercatorRaw",(function(){return xh})),e.d(n,"geoRotation",(function(){return Mc})),e.d(n,"geoStream",(function(){return rs})),e.d(n,"geoTransform",(function(){return xl})),e.d(n,"cluster",(function(){return Ph})),e.d(n,"hierarchy",(function(){return Ch})),e.d(n,"pack",(function(){return Jh})),e.d(n,"packSiblings",(function(){return Hh})),e.d(n,"packEnclose",(function(){return zh})),e.d(n,"partition",(function(){return id})),e.d(n,"stratify",(function(){return fd})),e.d(n,"tree",(function(){return gd})),e.d(n,"treemap",(function(){return wd})),e.d(n,"treemapBinary",(function(){return Md})),e.d(n,"treemapDice",(function(){return rd})),e.d(n,"treemapSlice",(function(){return md})),e.d(n,"treemapSliceDice",(function(){return Ed})),e.d(n,"treemapSquarify",(function(){return _d})),e.d(n,"treemapResquarify",(function(){return Pd})),e.d(n,"interpolate",(function(){return kn})),e.d(n,"interpolateArray",(function(){return gn})),e.d(n,"interpolateBasis",(function(){return on})),e.d(n,"interpolateBasisClosed",(function(){return un})),e.d(n,"interpolateDate",(function(){return mn})),e.d(n,"interpolateDiscrete",(function(){return Sn})),e.d(n,"interpolateHue",(function(){return An})),e.d(n,"interpolateNumber",(function(){return bn})),e.d(n,"interpolateObject",(function(){return xn})),e.d(n,"interpolateRound",(function(){return Nn})),e.d(n,"interpolateString",(function(){return Cn})),e.d(n,"interpolateTransformCss",(function(){return On})),e.d(n,"interpolateTransformSvg",(function(){return Vn})),e.d(n,"interpolateZoom",(function(){return qn})),e.d(n,"interpolateRgb",(function(){return dn})),e.d(n,"interpolateRgbBasis",(function(){return yn})),e.d(n,"interpolateRgbBasisClosed",(function(){return vn})),e.d(n,"interpolateHsl",(function(){return Fn})),e.d(n,"interpolateHslLong",(function(){return jn})),e.d(n,"interpolateLab",(function(){return he})),e.d(n,"interpolateHcl",(function(){return pe})),e.d(n,"interpolateHclLong",(function(){return ye})),e.d(n,"interpolateCubehelix",(function(){return Pe})),e.d(n,"interpolateCubehelixLong",(function(){return Te})),e.d(n,"piecewise",(function(){return Ce})),e.d(n,"quantize",(function(){return Ae})),e.d(n,"path",(function(){return va})),e.d(n,"polygonArea",(function(){return Td})),e.d(n,"polygonCentroid",(function(){return Cd})),e.d(n,"polygonHull",(function(){return Nd})),e.d(n,"polygonContains",(function(){return Bd})),e.d(n,"polygonLength",(function(){return zd})),e.d(n,"quadtree",(function(){return Do})),e.d(n,"randomUniform",(function(){return Rd})),e.d(n,"randomNormal",(function(){return Od})),e.d(n,"randomLogNormal",(function(){return Vd})),e.d(n,"randomBates",(function(){return Id})),e.d(n,"randomIrwinHall",(function(){return Ld})),e.d(n,"randomExponential",(function(){return qd})),e.d(n,"scaleBand",(function(){return Wd})),e.d(n,"scalePoint",(function(){return $d})),e.d(n,"scaleIdentity",(function(){return fp})),e.d(n,"scaleLinear",(function(){return cp})),e.d(n,"scaleLog",(function(){return bp})),e.d(n,"scaleSymlog",(function(){return Mp})),e.d(n,"scaleOrdinal",(function(){return Gd})),e.d(n,"scaleImplicit",(function(){return Hd})),e.d(n,"scalePow",(function(){return kp})),e.d(n,"scaleSqrt",(function(){return Sp})),e.d(n,"scaleQuantile",(function(){return Ap})),e.d(n,"scaleQuantize",(function(){return Np})),e.d(n,"scaleThreshold",(function(){return Bp})),e.d(n,"scaleTime",(function(){return bg})),e.d(n,"scaleUtc",(function(){return Sg})),e.d(n,"scaleSequential",(function(){return Bg})),e.d(n,"scaleSequentialLog",(function(){return zg})),e.d(n,"scaleSequentialPow",(function(){return Rg})),e.d(n,"scaleSequentialSqrt",(function(){return Og})),e.d(n,"scaleSequentialSymlog",(function(){return Dg})),e.d(n,"scaleSequentialQuantile",(function(){return Vg})),e.d(n,"scaleDiverging",(function(){return Ig})),e.d(n,"scaleDivergingLog",(function(){return qg})),e.d(n,"scaleDivergingPow",(function(){return Fg})),e.d(n,"scaleDivergingSqrt",(function(){return jg})),e.d(n,"scaleDivergingSymlog",(function(){return Ug})),e.d(n,"tickFormat",(function(){return up})),e.d(n,"schemeCategory10",(function(){return Xg})),e.d(n,"schemeAccent",(function(){return Hg})),e.d(n,"schemeDark2",(function(){return Gg})),e.d(n,"schemePaired",(function(){return Wg})),e.d(n,"schemePastel1",(function(){return $g})),e.d(n,"schemePastel2",(function(){return Qg})),e.d(n,"schemeSet1",(function(){return Zg})),e.d(n,"schemeSet2",(function(){return Jg})),e.d(n,"schemeSet3",(function(){return Kg})),e.d(n,"schemeTableau10",(function(){return tm})),e.d(n,"interpolateBrBG",(function(){return rm})),e.d(n,"schemeBrBG",(function(){return em})),e.d(n,"interpolatePRGn",(function(){return am})),e.d(n,"schemePRGn",(function(){return im})),e.d(n,"interpolatePiYG",(function(){return um})),e.d(n,"schemePiYG",(function(){return om})),e.d(n,"interpolatePuOr",(function(){return cm})),e.d(n,"schemePuOr",(function(){return sm})),e.d(n,"interpolateRdBu",(function(){return lm})),e.d(n,"schemeRdBu",(function(){return fm})),e.d(n,"interpolateRdGy",(function(){return dm})),e.d(n,"schemeRdGy",(function(){return hm})),e.d(n,"interpolateRdYlBu",(function(){return ym})),e.d(n,"schemeRdYlBu",(function(){return pm})),e.d(n,"interpolateRdYlGn",(function(){return gm})),e.d(n,"schemeRdYlGn",(function(){return vm})),e.d(n,"interpolateSpectral",(function(){return bm})),e.d(n,"schemeSpectral",(function(){return mm})),e.d(n,"interpolateBuGn",(function(){return _m})),e.d(n,"schemeBuGn",(function(){return xm})),e.d(n,"interpolateBuPu",(function(){return Mm})),e.d(n,"schemeBuPu",(function(){return wm})),e.d(n,"interpolateGnBu",(function(){return Pm})),e.d(n,"schemeGnBu",(function(){return Em})),e.d(n,"interpolateOrRd",(function(){return Cm})),e.d(n,"schemeOrRd",(function(){return Tm})),e.d(n,"interpolatePuBuGn",(function(){return Sm})),e.d(n,"schemePuBuGn",(function(){return km})),e.d(n,"interpolatePuBu",(function(){return Nm})),e.d(n,"schemePuBu",(function(){return Am})),e.d(n,"interpolatePuRd",(function(){return zm})),e.d(n,"schemePuRd",(function(){return Bm})),e.d(n,"interpolateRdPu",(function(){return Rm})),e.d(n,"schemeRdPu",(function(){return Dm})),e.d(n,"interpolateYlGnBu",(function(){return Vm})),e.d(n,"schemeYlGnBu",(function(){return Om})),e.d(n,"interpolateYlGn",(function(){return Im})),e.d(n,"schemeYlGn",(function(){return Lm})),e.d(n,"interpolateYlOrBr",(function(){return Um})),e.d(n,"schemeYlOrBr",(function(){return qm})),e.d(n,"interpolateYlOrRd",(function(){return jm})),e.d(n,"schemeYlOrRd",(function(){return Fm})),e.d(n,"interpolateBlues",(function(){return Xm})),e.d(n,"schemeBlues",(function(){return Ym})),e.d(n,"interpolateGreens",(function(){return Gm})),e.d(n,"schemeGreens",(function(){return Hm})),e.d(n,"interpolateGreys",(function(){return $m})),e.d(n,"schemeGreys",(function(){return Wm})),e.d(n,"interpolatePurples",(function(){return Zm})),e.d(n,"schemePurples",(function(){return Qm})),e.d(n,"interpolateReds",(function(){return Km})),e.d(n,"schemeReds",(function(){return Jm})),e.d(n,"interpolateOranges",(function(){return nb})),e.d(n,"schemeOranges",(function(){return tb})),e.d(n,"interpolateCividis",(function(){return eb})),e.d(n,"interpolateCubehelixDefault",(function(){return rb})),e.d(n,"interpolateRainbow",(function(){return ub})),e.d(n,"interpolateWarm",(function(){return ib})),e.d(n,"interpolateCool",(function(){return ab})),e.d(n,"interpolateSinebow",(function(){return lb})),e.d(n,"interpolateTurbo",(function(){return hb})),e.d(n,"interpolateViridis",(function(){return pb})),e.d(n,"interpolateMagma",(function(){return yb})),e.d(n,"interpolateInferno",(function(){return vb})),e.d(n,"interpolatePlasma",(function(){return gb})),e.d(n,"create",(function(){return vt.b})),e.d(n,"creator",(function(){return vt.c})),e.d(n,"local",(function(){return vt.f})),e.d(n,"matcher",(function(){return vt.g})),e.d(n,"mouse",(function(){return vt.h})),e.d(n,"namespace",(function(){return vt.i})),e.d(n,"namespaces",(function(){return vt.j})),e.d(n,"clientPoint",(function(){return vt.a})),e.d(n,"select",(function(){return vt.k})),e.d(n,"selectAll",(function(){return vt.l})),e.d(n,"selection",(function(){return vt.m})),e.d(n,"selector",(function(){return vt.n})),e.d(n,"selectorAll",(function(){return vt.o})),e.d(n,"style",(function(){return vt.p})),e.d(n,"touch",(function(){return vt.q})),e.d(n,"touches",(function(){return vt.r})),e.d(n,"window",(function(){return vt.s})),e.d(n,"event",(function(){return vt.e})),e.d(n,"customEvent",(function(){return vt.d})),e.d(n,"arc",(function(){return Vb})),e.d(n,"area",(function(){return jb})),e.d(n,"line",(function(){return Fb})),e.d(n,"pie",(function(){return Hb})),e.d(n,"areaRadial",(function(){return Jb})),e.d(n,"radialArea",(function(){return Jb})),e.d(n,"lineRadial",(function(){return Zb})),e.d(n,"radialLine",(function(){return Zb})),e.d(n,"pointRadial",(function(){return Kb})),e.d(n,"linkHorizontal",(function(){return ux})),e.d(n,"linkVertical",(function(){return sx})),e.d(n,"linkRadial",(function(){return cx})),e.d(n,"symbol",(function(){return Cx})),e.d(n,"symbols",(function(){return Tx})),e.d(n,"symbolCircle",(function(){return fx})),e.d(n,"symbolCross",(function(){return lx})),e.d(n,"symbolDiamond",(function(){return px})),e.d(n,"symbolSquare",(function(){return bx})),e.d(n,"symbolStar",(function(){return mx})),e.d(n,"symbolTriangle",(function(){return _x})),e.d(n,"symbolWye",(function(){return Px})),e.d(n,"curveBasisClosed",(function(){return zx})),e.d(n,"curveBasisOpen",(function(){return Rx})),e.d(n,"curveBasis",(function(){return Nx})),e.d(n,"curveBundle",(function(){return Vx})),e.d(n,"curveCardinalClosed",(function(){return Fx})),e.d(n,"curveCardinalOpen",(function(){return Yx})),e.d(n,"curveCardinal",(function(){return qx})),e.d(n,"curveCatmullRomClosed",(function(){return $x})),e.d(n,"curveCatmullRomOpen",(function(){return Zx})),e.d(n,"curveCatmullRom",(function(){return Gx})),e.d(n,"curveLinearClosed",(function(){return Kx})),e.d(n,"curveLinear",(function(){return Ib})),e.d(n,"curveMonotoneX",(function(){return u_})),e.d(n,"curveMonotoneY",(function(){return s_})),e.d(n,"curveNatural",(function(){return l_})),e.d(n,"curveStep",(function(){return d_})),e.d(n,"curveStepAfter",(function(){return y_})),e.d(n,"curveStepBefore",(function(){return p_})),e.d(n,"stack",(function(){return b_})),e.d(n,"stackOffsetExpand",(function(){return x_})),e.d(n,"stackOffsetDiverging",(function(){return __})),e.d(n,"stackOffsetNone",(function(){return v_})),e.d(n,"stackOffsetSilhouette",(function(){return w_})),e.d(n,"stackOffsetWiggle",(function(){return M_})),e.d(n,"stackOrderAppearance",(function(){return E_})),e.d(n,"stackOrderAscending",(function(){return T_})),e.d(n,"stackOrderDescending",(function(){return k_})),e.d(n,"stackOrderInsideOut",(function(){return S_})),e.d(n,"stackOrderNone",(function(){return g_})),e.d(n,"stackOrderReverse",(function(){return A_})),e.d(n,"timeInterval",(function(){return Rp})),e.d(n,"timeMillisecond",(function(){return my})),e.d(n,"timeMilliseconds",(function(){return by})),e.d(n,"utcMillisecond",(function(){return my})),e.d(n,"utcMilliseconds",(function(){return by})),e.d(n,"timeSecond",(function(){return yy})),e.d(n,"timeSeconds",(function(){return vy})),e.d(n,"utcSecond",(function(){return yy})),e.d(n,"utcSeconds",(function(){return vy})),e.d(n,"timeMinute",(function(){return hy})),e.d(n,"timeMinutes",(function(){return dy})),e.d(n,"timeHour",(function(){return cy})),e.d(n,"timeHours",(function(){return fy})),e.d(n,"timeDay",(function(){return oy})),e.d(n,"timeDays",(function(){return uy})),e.d(n,"timeWeek",(function(){return Xp})),e.d(n,"timeWeeks",(function(){return Jp})),e.d(n,"timeSunday",(function(){return Xp})),e.d(n,"timeSundays",(function(){return Jp})),e.d(n,"timeMonday",(function(){return Hp})),e.d(n,"timeMondays",(function(){return Kp})),e.d(n,"timeTuesday",(function(){return Gp})),e.d(n,"timeTuesdays",(function(){return ty})),e.d(n,"timeWednesday",(function(){return Wp})),e.d(n,"timeWednesdays",(function(){return ny})),e.d(n,"timeThursday",(function(){return $p})),e.d(n,"timeThursdays",(function(){return ey})),e.d(n,"timeFriday",(function(){return Qp})),e.d(n,"timeFridays",(function(){return ry})),e.d(n,"timeSaturday",(function(){return Zp})),e.d(n,"timeSaturdays",(function(){return iy})),e.d(n,"timeMonth",(function(){return qp})),e.d(n,"timeMonths",(function(){return Up})),e.d(n,"timeYear",(function(){return Vp})),e.d(n,"timeYears",(function(){return Lp})),e.d(n,"utcMinute",(function(){return Cg})),e.d(n,"utcMinutes",(function(){return kg})),e.d(n,"utcHour",(function(){return Eg})),e.d(n,"utcHours",(function(){return Pg})),e.d(n,"utcDay",(function(){return Oy})),e.d(n,"utcDays",(function(){return Vy})),e.d(n,"utcWeek",(function(){return _y})),e.d(n,"utcWeeks",(function(){return ky})),e.d(n,"utcSunday",(function(){return _y})),e.d(n,"utcSundays",(function(){return ky})),e.d(n,"utcMonday",(function(){return wy})),e.d(n,"utcMondays",(function(){return Sy})),e.d(n,"utcTuesday",(function(){return My})),e.d(n,"utcTuesdays",(function(){return Ay})),e.d(n,"utcWednesday",(function(){return Ey})),e.d(n,"utcWednesdays",(function(){return Ny})),e.d(n,"utcThursday",(function(){return Py})),e.d(n,"utcThursdays",(function(){return By})),e.d(n,"utcFriday",(function(){return Ty})),e.d(n,"utcFridays",(function(){return zy})),e.d(n,"utcSaturday",(function(){return Cy})),e.d(n,"utcSaturdays",(function(){return Dy})),e.d(n,"utcMonth",(function(){return _g})),e.d(n,"utcMonths",(function(){return wg})),e.d(n,"utcYear",(function(){return Iy})),e.d(n,"utcYears",(function(){return qy})),e.d(n,"timeFormatDefaultLocale",(function(){return og})),e.d(n,"timeFormat",(function(){return Hy})),e.d(n,"timeParse",(function(){return Gy})),e.d(n,"utcFormat",(function(){return Wy})),e.d(n,"utcParse",(function(){return $y})),e.d(n,"timeFormatLocale",(function(){return Yy})),e.d(n,"isoFormat",(function(){return ug})),e.d(n,"isoParse",(function(){return sg})),e.d(n,"now",(function(){return qe})),e.d(n,"timer",(function(){return je})),e.d(n,"timerFlush",(function(){return Ye})),e.d(n,"timeout",(function(){return We})),e.d(n,"interval",(function(){return $e})),e.d(n,"transition",(function(){return zr})),e.d(n,"active",(function(){return Ti})),e.d(n,"interrupt",(function(){return cr})),e.d(n,"voronoi",(function(){return yw})),e.d(n,"zoom",(function(){return Sw})),e.d(n,"zoomTransform",(function(){return xw})),e.d(n,"zoomIdentity",(function(){return bw}))},18:function(t,n,e){"use strict";var r=e(9),i=e(1);n.a=function(){var t=function(){return"n"},n=function(){return[0,0]},e=function(){return" "},a=document.body,o=d(),u=null,s=null,c=null;function f(t){var n;n=t.node(),(u=n?"svg"===n.tagName.toLowerCase()?n:n.ownerSVGElement:null)&&(s=u.createSVGPoint(),a.appendChild(o))}f.show=function(){var r=Array.prototype.slice.call(arguments);r[r.length-1]instanceof SVGElement&&(c=r.pop());var i,o=e.apply(this,r),u=n.apply(this,r),s=t.apply(this,r),d=p(),y=h.length,v=document.documentElement.scrollTop||a.scrollTop,g=document.documentElement.scrollLeft||a.scrollLeft;for(d.html(o).style("opacity",1).style("pointer-events","all");y--;)d.classed(h[y],!1);return i=l.get(s).apply(this),d.classed(s,!0).style("top",i.top+u[0]+v+"px").style("left",i.left+u[1]+g+"px"),f},f.hide=function(){return p().style("opacity",0).style("pointer-events","none"),f},f.attr=function(t,n){if(arguments.length<2&&"string"==typeof t)return p().attr(t);var e=Array.prototype.slice.call(arguments);return i.m.prototype.attr.apply(p(),e),f},f.style=function(t,n){if(arguments.length<2&&"string"==typeof t)return p().style(t);var e=Array.prototype.slice.call(arguments);return i.m.prototype.style.apply(p(),e),f},f.direction=function(n){return arguments.length?(t=null==n?n:v(n),f):t},f.offset=function(t){return arguments.length?(n=null==t?t:v(t),f):n},f.html=function(t){return arguments.length?(e=null==t?t:v(t),f):e},f.rootElement=function(t){return arguments.length?(a=null==t?t:v(t),f):a},f.destroy=function(){return o&&(p().remove(),o=null),f};var l=Object(r.c)({n:function(){var t=y(this);return{top:t.n.y-o.offsetHeight,left:t.n.x-o.offsetWidth/2}},s:function(){var t=y(this);return{top:t.s.y,left:t.s.x-o.offsetWidth/2}},e:function(){var t=y(this);return{top:t.e.y-o.offsetHeight/2,left:t.e.x}},w:function(){var t=y(this);return{top:t.w.y-o.offsetHeight/2,left:t.w.x-o.offsetWidth}},nw:function(){var t=y(this);return{top:t.nw.y-o.offsetHeight,left:t.nw.x-o.offsetWidth}},ne:function(){var t=y(this);return{top:t.ne.y-o.offsetHeight,left:t.ne.x}},sw:function(){var t=y(this);return{top:t.sw.y,left:t.sw.x-o.offsetWidth}},se:function(){var t=y(this);return{top:t.se.y,left:t.se.x}}}),h=l.keys();function d(){var t=Object(i.k)(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function p(){return null==o&&(o=d(),a.appendChild(o)),Object(i.k)(o)}function y(t){for(var n=c||t;null==n.getScreenCTM&&null!=n.parentNode;)n=n.parentNode;var e={},r=n.getScreenCTM(),i=n.getBBox(),a=i.width,o=i.height,u=i.x,f=i.y;return s.x=u,s.y=f,e.nw=s.matrixTransform(r),s.x+=a,e.ne=s.matrixTransform(r),s.y+=o,e.se=s.matrixTransform(r),s.x-=a,e.sw=s.matrixTransform(r),s.y-=o/2,e.w=s.matrixTransform(r),s.x+=a,e.e=s.matrixTransform(r),s.x-=a/2,s.y-=o/2,e.n=s.matrixTransform(r),s.y+=o,e.s=s.matrixTransform(r),e}function v(t){return"function"==typeof t?t:function(){return t}}return f}},42:function(t,n,e){t.exports=function(t,n){"use strict";var e;return t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n,function(e){var r;e.exports,(r=window).DOMParser=window.DOMParser;var i=r.document;function a(t,n){var e;return(e=i.createElement("canvas")).width=t,e.height=n,e}var o,u=function(t,n,e){if(null!=t||null!=n||null!=e){var r=v(e||{});"string"==typeof t&&(t=i.getElementById(t)),null!=t.svg&&t.svg.stop(),t.childNodes&&1==t.childNodes.length&&"OBJECT"==t.childNodes[0].nodeName||(t.svg=r);var a=t.getContext("2d");void 0!==n.documentElement?r.loadXmlDoc(a,n):"<"==n.substr(0,1)?r.loadXml(a,n):r.load(a,n)}else for(var o=i.querySelectorAll("svg"),s=0;s<o.length;s++){var c=o[s],f=i.createElement("canvas");if(void 0!==c.clientWidth&&void 0!==c.clientHeight)f.width=c.clientWidth,f.height=c.clientHeight;else{var l=c.getBoundingClientRect();f.width=l.width,f.height=l.height}c.parentNode.insertBefore(f,c),c.parentNode.removeChild(c);var h=i.createElement("div");h.appendChild(c),u(f,h.innerHTML)}};"undefined"==typeof Element||(void 0!==Element.prototype.matches?o=function(t,n){return t.matches(n)}:void 0!==Element.prototype.webkitMatchesSelector?o=function(t,n){return t.webkitMatchesSelector(n)}:void 0!==Element.prototype.mozMatchesSelector?o=function(t,n){return t.mozMatchesSelector(n)}:void 0!==Element.prototype.msMatchesSelector?o=function(t,n){return t.msMatchesSelector(n)}:void 0!==Element.prototype.oMatchesSelector?o=function(t,n){return t.oMatchesSelector(n)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(o=function(t,n){return $(t).is(n)}),void 0===o&&"undefined"!=typeof Sizzle&&(o=Sizzle.matchesSelector)));var s=/(\[[^\]]+\])/g,c=/(#[^\s\+>~\.\[:]+)/g,f=/(\.[^\s\+>~\.\[:]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,h=/(:[\w-]+\([^\)]*\))/gi,d=/(:[^\s\+>~\.\[:]+)/g,p=/([^\s\+>~\.\[:]+)/g;function y(t){var n=[0,0,0],e=function(e,r){var i=t.match(e);null!=i&&(n[r]+=i.length,t=t.replace(e," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),e(s,1),e(c,0),e(f,1),e(l,2),e(h,1),e(d,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),e(p,2),n.join("")}function v(e){var u={opts:e,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,rootEmSize:12,emSize:12,log:function(){}};1==u.opts.log&&"undefined"!=typeof console&&(u.log=function(t){}),u.init=function(t){var n=0;u.UniqueId=function(){return"canvg"+ ++n},u.Definitions={},u.Styles={},u.StylesSpecificity={},u.Animations=[],u.Images=[],u.ctx=t,u.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,n){this.viewPorts.push({width:t,height:n})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},u.init(),u.ImagesLoaded=function(){for(var t=0;t<u.Images.length;t++)if(!u.Images[t].loaded)return!1;return!0},u.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},u.compressSpaces=function(t){return t.replace(/(?!\u3000)\s+/gm," ")},u.ajax=function(t){var n;return(n=r.XMLHttpRequest?new r.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(n.open("GET",t,!1),n.send(null),n.responseText):null},u.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var n=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,n.loadXml(t,i),n}if(!r.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(n=new ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(t),n;try{var a=e.xmldom?new r.DOMParser(e.xmldom):new r.DOMParser;return a.parseFromString(t,"image/svg+xml")}catch(n){return(a=e.xmldom?new r.DOMParser(e.xmldom):new r.DOMParser).parseFromString(t,"text/xml")}},u.Property=function(t,n){this.name=t,this.value=n},u.Property.prototype.getValue=function(){return this.value},u.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},u.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},u.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},u.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():parseFloat(t)},u.Property.prototype.addOpacity=function(n){var e=this.value;if(null!=n.value&&""!=n.value&&"string"==typeof this.value){var r=new t(this.value);r.ok&&(e="rgba("+r.r+", "+r.g+", "+r.b+", "+n.numValue()+")")}return new u.Property(this.name,e)},u.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),u.Definitions[t]},u.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},u.Property.prototype.getFillStyleDefinition=function(t,n){var e=this.getDefinition();if(null!=e&&e.createGradient)return e.createGradient(u.ctx,t,n);if(null!=e&&e.createPattern){if(e.getHrefAttribute().hasValue()){var r=e.attribute("patternTransform");e=e.getHrefAttribute().getDefinition(),r.hasValue()&&(e.attribute("patternTransform",!0).value=r.value)}return e.createPattern(u.ctx,t,n)}return null},u.Property.prototype.getDPI=function(){return 96},u.Property.prototype.getREM=function(){return u.rootEmSize},u.Property.prototype.getEM=function(){return u.emSize},u.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},u.Property.prototype.isPixels=function(){if(!this.hasValue())return!1;var t=this.value+"";return!!t.match(/px$/)||!!t.match(/^[0-9]+$/)},u.Property.prototype.toPixels=function(t,n){if(!this.hasValue())return 0;var e=this.value+"";if(e.match(/rem$/))return this.numValue()*this.getREM(t);if(e.match(/em$/))return this.numValue()*this.getEM(t);if(e.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(e.match(/px$/))return this.numValue();if(e.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(e.match(/pc$/))return 15*this.numValue();if(e.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(e.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(e.match(/in$/))return this.numValue()*this.getDPI(t);if(e.match(/%$/))return this.numValue()*u.ViewPort.ComputeSize(t);var r=this.numValue();return n&&r<1?r*u.ViewPort.ComputeSize(t):r},u.Property.prototype.toMilliseconds=function(){return this.hasValue()?(this.value+"").match(/ms$/)?this.numValue():1e3*this.numValue():0},u.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var s={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return u.Property.prototype.toTextBaseline=function(){return this.hasValue()?s[this.value]:null},u.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,n,e,r,i,a){var o=null!=a?this.Parse(a):this.CreateFont("","","","","",u.ctx.font);return{fontFamily:i=i||o.fontFamily,fontSize:r||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:e||o.fontWeight,fontVariant:n||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(n){for(var e={},r=u.trim(u.compressSpaces(n||"")).split(" "),i={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},a="",o=0;o<r.length;o++)i.fontStyle||-1==t.Styles.indexOf(r[o])?i.fontVariant||-1==t.Variants.indexOf(r[o])?i.fontWeight||-1==t.Weights.indexOf(r[o])?i.fontSize?"inherit"!=r[o]&&(a+=r[o]):("inherit"!=r[o]&&(e.fontSize=r[o].split("/")[0]),i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=!0):("inherit"!=r[o]&&(e.fontWeight=r[o]),i.fontStyle=i.fontVariant=i.fontWeight=!0):("inherit"!=r[o]&&(e.fontVariant=r[o]),i.fontStyle=i.fontVariant=!0):("inherit"!=r[o]&&(e.fontStyle=r[o]),i.fontStyle=!0);return""!=a&&(e.fontFamily=a),e}},u.ToNumberArray=function(t){for(var n=(t||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[],e=0;e<n.length;e++)n[e]=parseFloat(n[e]);return n},u.Point=function(t,n){this.x=t,this.y=n},u.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},u.Point.prototype.applyTransform=function(t){var n=this.x*t[0]+this.y*t[2]+t[4],e=this.x*t[1]+this.y*t[3]+t[5];this.x=n,this.y=e},u.CreatePoint=function(t){var n=u.ToNumberArray(t);return new u.Point(n[0],n[1])},u.CreatePath=function(t){for(var n=u.ToNumberArray(t),e=[],r=0;r<n.length;r+=2)e.push(new u.Point(n[r],n[r+1]));return e},u.BoundingBox=function(t,n,e,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,n){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=n&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=n,this.y2=n),n<this.y1&&(this.y1=n),n>this.y2&&(this.y2=n))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,n,e,r,i,a){var o=t+2/3*(e-t),u=n+2/3*(r-n),s=o+1/3*(i-t),c=u+1/3*(a-n);this.addBezierCurve(t,n,o,s,u,c,i,a)},this.addBezierCurve=function(t,n,e,r,i,a,o,u){var s=[t,n],c=[e,r],f=[i,a],l=[o,u];this.addPoint(s[0],s[1]),this.addPoint(l[0],l[1]);for(var h=0;h<=1;h++){var d=function(t){return Math.pow(1-t,3)*s[h]+3*Math.pow(1-t,2)*t*c[h]+3*(1-t)*Math.pow(t,2)*f[h]+Math.pow(t,3)*l[h]},p=6*s[h]-12*c[h]+6*f[h],y=-3*s[h]+9*c[h]-9*f[h]+3*l[h],v=3*c[h]-3*s[h];if(0!=y){var g=Math.pow(p,2)-4*v*y;if(!(g<0)){var m=(-p+Math.sqrt(g))/(2*y);0<m&&m<1&&(0==h&&this.addX(d(m)),1==h&&this.addY(d(m)));var b=(-p-Math.sqrt(g))/(2*y);0<b&&b<1&&(0==h&&this.addX(d(b)),1==h&&this.addY(d(b)))}}else{if(0==p)continue;var x=-v/p;0<x&&x<1&&(0==h&&this.addX(d(x)),1==h&&this.addY(d(x)))}}},this.isPointInBox=function(t,n){return this.x1<=t&&t<=this.x2&&this.y1<=n&&n<=this.y2},this.addPoint(t,n),this.addPoint(e,r)},u.Transform=function(t){var n=this;this.Type={},this.Type.translate=function(t){this.p=u.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var n=u.ToNumberArray(t);this.angle=new u.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var n=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=u.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=u.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var n=this.m[0],e=this.m[2],r=this.m[4],i=this.m[1],a=this.m[3],o=this.m[5],u=1/(n*(1*a-0*o)-e*(1*i-0*o)+r*(0*i-0*a));t.transform(u*(1*a-0*o),u*(0*o-1*i),u*(0*r-1*e),u*(1*n-0*r),u*(e*o-r*a),u*(r*i-n*o))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=n.Type.matrix,this.base(t),this.angle=new u.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=n.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=n.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var n=0;n<this.transforms.length;n++)this.transforms[n].apply(t)},this.unapply=function(t){for(var n=this.transforms.length-1;0<=n;n--)this.transforms[n].unapply(t)},this.applyToPoint=function(t){for(var n=0;n<this.transforms.length;n++)this.transforms[n].applyToPoint(t)};for(var e=u.trim(u.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),r=0;r<e.length;r++)if("none"!==e[r]){var i=u.trim(e[r].split("(")[0]),a=e[r].split("(")[1].replace(")",""),o=this.Type[i];if(void 0!==o){var s=new o(a);s.type=i,this.transforms.push(s)}}},u.AspectRatio=function(t,n,e,r,i,a,o,s,c,f){var l=(n=(n=u.compressSpaces(n)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",h=n.split(" ")[1]||"meet",d=e/r,p=i/a,y=Math.min(d,p),v=Math.max(d,p);"meet"==h&&(r*=y,a*=y),"slice"==h&&(r*=v,a*=v),c=new u.Property("refX",c),f=new u.Property("refY",f),c.hasValue()&&f.hasValue()?t.translate(-y*c.toPixels("x"),-y*f.toPixels("y")):(l.match(/^xMid/)&&("meet"==h&&y==p||"slice"==h&&v==p)&&t.translate(e/2-r/2,0),l.match(/YMid$/)&&("meet"==h&&y==d||"slice"==h&&v==d)&&t.translate(0,i/2-a/2),l.match(/^xMax/)&&("meet"==h&&y==p||"slice"==h&&v==p)&&t.translate(e-r,0),l.match(/YMax$/)&&("meet"==h&&y==d||"slice"==h&&v==d)&&t.translate(0,i-a)),"none"==l?t.scale(d,p):"meet"==h?t.scale(y,y):"slice"==h&&t.scale(v,v),t.translate(null==o?0:-o,null==s?0:-s)},u.Element={},u.EmptyProperty=new u.Property("EMPTY",""),u.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,n){var e=this.attributes[t];return null!=e?e:(1==n&&(e=new u.Property(t,""),this.attributes[t]=e),e||u.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return u.EmptyProperty},this.style=function(t,n,e){var r=this.styles[t];if(null!=r)return r;var i=this.attribute(t);if(null!=i&&i.hasValue())return this.styles[t]=i;if(1!=e){var a=this.parent;if(null!=a){var o=a.style(t);if(null!=o&&o.hasValue())return o}}return 1==n&&(r=new u.Property(t,""),this.styles[t]=r),r||u.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var n=this.style("mask").getDefinition();null!=n&&n.apply(t,this)}else if(this.style("filter").hasValue()){var e=this.style("filter").getDefinition();null!=e&&e.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(t){for(var n=0;n<this.children.length;n++)this.children[n].render(t)},this.addChild=function(t,n){var e=t;n&&(e=u.CreateElement(t)),e.parent=this,"title"!=e.type&&this.children.push(e)},this.addStylesFromStyleDefinition=function(){for(var n in u.Styles)if("@"!=n[0]&&o(t,n)){var e=u.Styles[n],r=u.StylesSpecificity[n];if(null!=e)for(var i in e){var a=this.stylesSpecificity[i];void 0===a&&(a="000"),a<=r&&(this.styles[i]=e[i],this.stylesSpecificity[i]=r)}}};var n,e=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var r=0;r<t.attributes.length;r++){var i=t.attributes[r],a=(n=i.nodeName,e.test(n)?n.toLowerCase():n);this.attributes[a]=new u.Property(a,i.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var s=this.attribute("style").value.split(";");for(r=0;r<s.length;r++)if(""!=u.trim(s[r])){var c=s[r].split(":"),f=u.trim(c[0]),l=u.trim(c[1]);this.styles[f]=new u.Property(f,l)}}for(this.attribute("id").hasValue()&&null==u.Definitions[this.attribute("id").value]&&(u.Definitions[this.attribute("id").value]=this),r=0;r<t.childNodes.length;r++){var h=t.childNodes[r];if(1==h.nodeType&&this.addChild(h,!0),this.captureTextNodes&&(3==h.nodeType||4==h.nodeType)){var d=h.value||h.text||h.textContent||"";""!=u.compressSpaces(d)&&this.addChild(new u.Element.tspan(h),!1)}}}},u.Element.RenderedElementBase=function(t){this.base=u.Element.ElementBase,this.base(t),this.calculateOpacity=function(){for(var t=1,n=this;null!=n;){var e=n.style("opacity",!1,!0);e.hasValue()&&(t*=e.numValue()),n=n.parent}return t},this.setContext=function(t,n){if(!n){var e;if(this.style("fill").isUrlDefinition())null!=(e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=e);else if(this.style("fill").hasValue()){var r;"currentColor"==(r=this.style("fill")).value&&(r.value=this.style("color").value),"inherit"!=r.value&&(t.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value)}if(this.style("fill-opacity").hasValue()&&(r=(r=new u.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=r.value),this.style("stroke").isUrlDefinition())null!=(e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=e);else if(this.style("stroke").hasValue()){var i;"currentColor"==(i=this.style("stroke")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("stroke-opacity").hasValue()&&(i=(i=new u.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=i.value),this.style("stroke-width").hasValue()){var a=this.style("stroke-width").toPixels();t.lineWidth=0==a?.001:a}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("paint-order").hasValue()&&(t.paintOrder=this.style("paint-order").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var o=u.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(o):void 0!==t.webkitLineDash?t.webkitLineDash=o:void 0===t.mozDash||1==o.length&&0==o[0]||(t.mozDash=o);var s=this.style("stroke-dashoffset").toPixels();void 0!==t.lineDashOffset?t.lineDashOffset=s:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=s:void 0!==t.mozDashOffset&&(t.mozDashOffset=s)}}if(void 0!==t.font)if(this.style("font").hasValue())t.font=this.style("font").value;else{t.font=u.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();var c=this.style("font-size",!1,!1);c.isPixels()&&(u.emSize=c.toPixels())}if(this.style("transform",!1,!0).hasValue()&&new u.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var f=this.style("clip-path",!1,!0).getDefinition();null!=f&&f.apply(t)}t.globalAlpha=this.calculateOpacity()}},u.Element.RenderedElementBase.prototype=new u.Element.ElementBase,u.Element.PathElementBase=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new u.BoundingBox},this.renderChildren=function(t){this.path(t),u.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition()&&(e=this.style("marker-start").getDefinition()).render(t,n[0][0],n[0][1]),this.style("marker-mid").isUrlDefinition())for(var e=this.style("marker-mid").getDefinition(),r=1;r<n.length-1;r++)e.render(t,n[r][0],n[r][1]);this.style("marker-end").isUrlDefinition()&&(e=this.style("marker-end").getDefinition()).render(t,n[n.length-1][0],n[n.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},u.Element.PathElementBase.prototype=new u.Element.RenderedElementBase,u.SetDefaults=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4},u.Element.svg=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),u.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){if(u.SetDefaults(t),t.canvas.style&&void 0!==t.font&&void 0!==r.getComputedStyle){t.font=r.getComputedStyle(t.canvas).getPropertyValue("font");var n=new u.Property("fontSize",u.Font.Parse(t.font).fontSize);n.hasValue()&&(u.rootEmSize=u.emSize=n.toPixels("y"))}this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=u.ViewPort.width(),i=u.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){e=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var a=0,o=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(a=-this.attribute("refX").toPixels("x"),o=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(a,o),t.lineTo(e,o),t.lineTo(e,i),t.lineTo(a,i),t.closePath(),t.clip())}if(u.ViewPort.SetCurrent(e,i),this.attribute("viewBox").hasValue()){var s=u.ToNumberArray(this.attribute("viewBox").value),c=s[0],f=s[1];e=s[2],i=s[3],u.AspectRatio(t,this.attribute("preserveAspectRatio").value,u.ViewPort.width(),e,u.ViewPort.height(),i,c,f,this.attribute("refX").value,this.attribute("refY").value),u.ViewPort.RemoveCurrent(),u.ViewPort.SetCurrent(s[2],s[3])}}},u.Element.svg.prototype=new u.Element.RenderedElementBase,u.Element.rect=function(t){this.base=u.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y"),a=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=a),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(a=o),a=Math.min(a,r/2),o=Math.min(o,i/2),null!=t){var s=(Math.sqrt(2)-1)/3*4;t.beginPath(),0<i&&0<r&&(t.moveTo(n+a,e),t.lineTo(n+r-a,e),t.bezierCurveTo(n+r-a+s*a,e,n+r,e+o-s*o,n+r,e+o),t.lineTo(n+r,e+i-o),t.bezierCurveTo(n+r,e+i-o+s*o,n+r-a+s*a,e+i,n+r-a,e+i),t.lineTo(n+a,e+i),t.bezierCurveTo(n+a-s*a,e+i,n,e+i-o+s*o,n,e+i-o),t.lineTo(n,e+o),t.bezierCurveTo(n,e+o-s*o,n+a-s*a,e,n+a,e),t.closePath())}return new u.BoundingBox(n,e,n+r,e+i)}},u.Element.rect.prototype=new u.Element.PathElementBase,u.Element.circle=function(t){this.base=u.Element.PathElementBase,this.base(t),this.path=function(t){var n=this.attribute("cx").toPixels("x"),e=this.attribute("cy").toPixels("y"),r=this.attribute("r").toPixels();return null!=t&&0<r&&(t.beginPath(),t.arc(n,e,r,0,2*Math.PI,!1),t.closePath()),new u.BoundingBox(n-r,e-r,n+r,e+r)}},u.Element.circle.prototype=new u.Element.PathElementBase,u.Element.ellipse=function(t){this.base=u.Element.PathElementBase,this.base(t),this.path=function(t){var n=(Math.sqrt(2)-1)/3*4,e=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y"),i=this.attribute("cx").toPixels("x"),a=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(i+e,a),t.bezierCurveTo(i+e,a+n*r,i+n*e,a+r,i,a+r),t.bezierCurveTo(i-n*e,a+r,i-e,a+n*r,i-e,a),t.bezierCurveTo(i-e,a-n*r,i-n*e,a-r,i,a-r),t.bezierCurveTo(i+n*e,a-r,i+e,a-n*r,i+e,a),t.closePath()),new u.BoundingBox(i-e,a-r,i+e,a+r)}},u.Element.ellipse.prototype=new u.Element.PathElementBase,u.Element.line=function(t){this.base=u.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new u.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new u.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var n=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(n[0].x,n[0].y),t.lineTo(n[1].x,n[1].y)),new u.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var t=this.getPoints(),n=t[0].angleTo(t[1]);return[[t[0],n],[t[1],n]]}},u.Element.line.prototype=new u.Element.PathElementBase,u.Element.polyline=function(t){this.base=u.Element.PathElementBase,this.base(t),this.points=u.CreatePath(this.attribute("points").value),this.path=function(t){var n=new u.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var e=1;e<this.points.length;e++)n.addPoint(this.points[e].x,this.points[e].y),null!=t&&t.lineTo(this.points[e].x,this.points[e].y);return n},this.getMarkers=function(){for(var t=[],n=0;n<this.points.length-1;n++)t.push([this.points[n],this.points[n].angleTo(this.points[n+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},u.Element.polyline.prototype=new u.Element.PathElementBase,u.Element.polygon=function(t){this.base=u.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var n=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),n}},u.Element.polygon.prototype=new u.Element.polyline,u.Element.path=function(t){this.base=u.Element.PathElementBase,this.base(t);var n=this.attribute("d").value;n=n.replace(/,/gm," ");for(var e=0;e<2;e++)n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(n=(n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),e=0;e<2;e++)n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=u.compressSpaces(n),n=u.trim(n),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new u.Point(0,0),this.control=new u.Point(0,0),this.current=new u.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new u.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new u.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,n,e){null!=e&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(e)),this.addMarkerAngle(t,null==n?null:n.angleTo(t))},this.addMarkerAngle=function(t,n){this.points.push(t),this.angles.push(n)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var n=t+1;n<this.angles.length;n++)if(null!=this.angles[n]){this.angles[t]=this.angles[n];break}return this.angles}}(n),this.path=function(t){var n=this.PathParser;n.reset();var e=new u.BoundingBox;for(null!=t&&t.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var r=n.getAsCurrentPoint();for(n.addMarker(r),e.addPoint(r.x,r.y),null!=t&&t.moveTo(r.x,r.y),n.start=n.current;!n.isCommandOrEnd();)r=n.getAsCurrentPoint(),n.addMarker(r,n.start),e.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y);break;case"L":case"l":for(;!n.isCommandOrEnd();){var i=n.current;r=n.getAsCurrentPoint(),n.addMarker(r,i),e.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var a=new u.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(a,n.current),n.current=a,e.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();)a=new u.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar()),n.addMarker(a,n.current),n.current=a,e.addPoint(n.current.x,n.current.y),null!=t&&t.lineTo(n.current.x,n.current.y);break;case"C":case"c":for(;!n.isCommandOrEnd();){var o=n.current,s=n.getPoint(),c=n.getAsControlPoint(),f=n.getAsCurrentPoint();n.addMarker(f,c,s),e.addBezierCurve(o.x,o.y,s.x,s.y,c.x,c.y,f.x,f.y),null!=t&&t.bezierCurveTo(s.x,s.y,c.x,c.y,f.x,f.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();)o=n.current,s=n.getReflectedControlPoint(),c=n.getAsControlPoint(),f=n.getAsCurrentPoint(),n.addMarker(f,c,s),e.addBezierCurve(o.x,o.y,s.x,s.y,c.x,c.y,f.x,f.y),null!=t&&t.bezierCurveTo(s.x,s.y,c.x,c.y,f.x,f.y);break;case"Q":case"q":for(;!n.isCommandOrEnd();)o=n.current,c=n.getAsControlPoint(),f=n.getAsCurrentPoint(),n.addMarker(f,c,c),e.addQuadraticCurve(o.x,o.y,c.x,c.y,f.x,f.y),null!=t&&t.quadraticCurveTo(c.x,c.y,f.x,f.y);break;case"T":case"t":for(;!n.isCommandOrEnd();)o=n.current,c=n.getReflectedControlPoint(),n.control=c,f=n.getAsCurrentPoint(),n.addMarker(f,c,c),e.addQuadraticCurve(o.x,o.y,c.x,c.y,f.x,f.y),null!=t&&t.quadraticCurveTo(c.x,c.y,f.x,f.y);break;case"A":case"a":for(;!n.isCommandOrEnd();){o=n.current;var l=n.getScalar(),h=n.getScalar(),d=n.getScalar()*(Math.PI/180),p=n.getScalar(),y=n.getScalar(),v=(f=n.getAsCurrentPoint(),new u.Point(Math.cos(d)*(o.x-f.x)/2+Math.sin(d)*(o.y-f.y)/2,-Math.sin(d)*(o.x-f.x)/2+Math.cos(d)*(o.y-f.y)/2)),g=Math.pow(v.x,2)/Math.pow(l,2)+Math.pow(v.y,2)/Math.pow(h,2);1<g&&(l*=Math.sqrt(g),h*=Math.sqrt(g));var m=(p==y?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(h,2)-Math.pow(l,2)*Math.pow(v.y,2)-Math.pow(h,2)*Math.pow(v.x,2))/(Math.pow(l,2)*Math.pow(v.y,2)+Math.pow(h,2)*Math.pow(v.x,2)));isNaN(m)&&(m=0);var b=new u.Point(m*l*v.y/h,m*-h*v.x/l),x=new u.Point((o.x+f.x)/2+Math.cos(d)*b.x-Math.sin(d)*b.y,(o.y+f.y)/2+Math.sin(d)*b.x+Math.cos(d)*b.y),_=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},w=function(t,n){return(t[0]*n[0]+t[1]*n[1])/(_(t)*_(n))},M=function(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(w(t,n))},E=M([1,0],[(v.x-b.x)/l,(v.y-b.y)/h]),P=[(v.x-b.x)/l,(v.y-b.y)/h],T=[(-v.x-b.x)/l,(-v.y-b.y)/h],C=M(P,T);w(P,T)<=-1&&(C=Math.PI),1<=w(P,T)&&(C=0);var k=1-y?1:-1,S=E+k*(C/2),A=new u.Point(x.x+l*Math.cos(S),x.y+h*Math.sin(S));if(n.addMarkerAngle(A,S-k*Math.PI/2),n.addMarkerAngle(f,S-k*Math.PI),e.addPoint(f.x,f.y),null!=t&&!isNaN(E)&&!isNaN(C)){w=h<l?l:h;var N=h<l?1:l/h,B=h<l?h/l:1;t.translate(x.x,x.y),t.rotate(d),t.scale(N,B),t.arc(0,0,w,E,E+C,1-y),t.scale(1/N,1/B),t.rotate(-d),t.translate(-x.x,-x.y)}}break;case"Z":case"z":null!=t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath(),n.current=n.start}return e},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),n=this.PathParser.getMarkerAngles(),e=[],r=0;r<t.length;r++)e.push([t[r],n[r]]);return e}},u.Element.path.prototype=new u.Element.PathElementBase,u.Element.pattern=function(t){this.base=u.Element.ElementBase,this.base(t),this.createPattern=function(t,n,e){var r=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),o=new u.Element.svg;o.attributes.viewBox=new u.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new u.Property("width",r+"px"),o.attributes.height=new u.Property("height",i+"px"),o.attributes.transform=new u.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var s=a(r,i),c=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&c.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0)),e.hasValue()?this.styles["fill-opacity"]=e:delete this.styles["fill-opacity"];for(var f=-1;f<=1;f++)for(var l=-1;l<=1;l++)c.save(),o.attributes.x=new u.Property("x",f*s.width),o.attributes.y=new u.Property("y",l*s.height),o.render(c),c.restore();return t.createPattern(s,"repeat")}},u.Element.pattern.prototype=new u.Element.ElementBase,u.Element.marker=function(t){this.base=u.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,n,e){if(n){t.translate(n.x,n.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(e),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var r=new u.Element.svg;r.attributes.viewBox=new u.Property("viewBox",this.attribute("viewBox").value),r.attributes.refX=new u.Property("refX",this.attribute("refX").value),r.attributes.refY=new u.Property("refY",this.attribute("refY").value),r.attributes.width=new u.Property("width",this.attribute("markerWidth").value),r.attributes.height=new u.Property("height",this.attribute("markerHeight").value),r.attributes.fill=new u.Property("fill",this.attribute("fill").valueOrDefault("black")),r.attributes.stroke=new u.Property("stroke",this.attribute("stroke").valueOrDefault("none")),r.children=this.children,r.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-e),t.translate(-n.x,-n.y)}}},u.Element.marker.prototype=new u.Element.ElementBase,u.Element.defs=function(t){this.base=u.Element.ElementBase,this.base(t),this.render=function(){}},u.Element.defs.prototype=new u.Element.ElementBase,u.Element.GradientBase=function(t){this.base=u.Element.ElementBase,this.base(t),this.stops=[];for(var n=0;n<this.children.length;n++){var e=this.children[n];"stop"==e.type&&this.stops.push(e)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var n=0;n<this.attributesToInherit.length;n++){var e=this.attributesToInherit[n];!this.attribute(e).hasValue()&&t.attribute(e).hasValue()&&(this.attribute(e,!0).value=t.attribute(e).value)}},this.createGradient=function(t,n,e){var r=this;this.getHrefAttribute().hasValue()&&(r=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(r));var i=function(t){return e.hasValue()?new u.Property("color",t).addOpacity(e).value:t},o=this.getGradient(t,n);if(null==o)return i(r.stops[r.stops.length-1].color);for(var s=0;s<r.stops.length;s++)o.addColorStop(r.stops[s].offset,i(r.stops[s].color));if(this.attribute("gradientTransform").hasValue()){var c=u.ViewPort.viewPorts[0],f=new u.Element.rect;f.attributes.x=new u.Property("x",-u.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new u.Property("y",-u.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new u.Property("width",u.MAX_VIRTUAL_PIXELS),f.attributes.height=new u.Property("height",u.MAX_VIRTUAL_PIXELS);var l=new u.Element.g;l.attributes.transform=new u.Property("transform",this.attribute("gradientTransform").value),l.children=[f];var h=new u.Element.svg;h.attributes.x=new u.Property("x",0),h.attributes.y=new u.Property("y",0),h.attributes.width=new u.Property("width",c.width),h.attributes.height=new u.Property("height",c.height),h.children=[l];var d=a(c.width,c.height),p=d.getContext("2d");return p.fillStyle=o,h.render(p),p.createPattern(d,"no-repeat")}return o}},u.Element.GradientBase.prototype=new u.Element.ElementBase,u.Element.linearGradient=function(t){this.base=u.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,n){var e="objectBoundingBox"==this.gradientUnits()?n.getBoundingBox(t):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits()?e.x()+e.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?e.y()+e.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),a="objectBoundingBox"==this.gradientUnits()?e.x()+e.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),o="objectBoundingBox"==this.gradientUnits()?e.y()+e.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==a&&i==o?null:t.createLinearGradient(r,i,a,o)}},u.Element.linearGradient.prototype=new u.Element.GradientBase,u.Element.radialGradient=function(t){this.base=u.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.attributesToInherit.push("fr"),this.getGradient=function(t,n){var e=n.getBoundingBox(t);this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits()?e.x()+e.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?e.y()+e.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),a=r,o=i;this.attribute("fx").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?e.x()+e.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(o="objectBoundingBox"==this.gradientUnits()?e.y()+e.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u="objectBoundingBox"==this.gradientUnits()?(e.width()+e.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels(),s=this.attribute("fr").toPixels();return t.createRadialGradient(a,o,s,r,i,u)}},u.Element.radialGradient.prototype=new u.Element.GradientBase,u.Element.stop=function(t){this.base=u.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var n=this.style("stop-color",!0);""===n.value&&(n.value="#000"),this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity"))),this.color=n.value},u.Element.stop.prototype=new u.Element.ElementBase,u.Element.AnimateBase=function(t){this.base=u.Element.ElementBase,this.base(t),u.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,n=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(n,!0):this.parent.attribute(n,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var n=!1;if(this.begin<this.duration){var e=this.calcValue();this.attribute("type").hasValue()&&(e=this.attribute("type").value+"("+e+")"),this.getProperty().value=e,n=!0}return n},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=t.progress*(this.values.value.length-1),e=Math.floor(n),r=Math.ceil(n);t.from=new u.Property("from",parseFloat(this.values.value[e])),t.to=new u.Property("to",parseFloat(this.values.value[r])),t.progress=(n-e)/(r-e)}else t.from=this.from,t.to=this.to;return t}},u.Element.AnimateBase.prototype=new u.Element.ElementBase,u.Element.animate=function(t){this.base=u.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress(),n=t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress;return"%"===this.initialUnits&&(n*=100),n+this.initialUnits}},u.Element.animate.prototype=new u.Element.AnimateBase,u.Element.animateColor=function(n){this.base=u.Element.AnimateBase,this.base(n),this.calcValue=function(){var n=this.progress(),e=new t(n.from.value),r=new t(n.to.value);if(e.ok&&r.ok){var i=e.r+(r.r-e.r)*n.progress,a=e.g+(r.g-e.g)*n.progress,o=e.b+(r.b-e.b)*n.progress;return"rgb("+parseInt(i,10)+","+parseInt(a,10)+","+parseInt(o,10)+")"}return this.attribute("from").value}},u.Element.animateColor.prototype=new u.Element.AnimateBase,u.Element.animateTransform=function(t){this.base=u.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),n=u.ToNumberArray(t.from.value),e=u.ToNumberArray(t.to.value),r="",i=0;i<n.length;i++)r+=n[i]+(e[i]-n[i])*t.progress+" ";return r}},u.Element.animateTransform.prototype=new u.Element.animate,u.Element.font=function(t){this.base=u.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var e=this.children[n];"font-face"==e.type?(this.fontFace=e).style("font-family").hasValue()&&(u.Definitions[e.style("font-family").value]=this):"missing-glyph"==e.type?this.missingGlyph=e:"glyph"==e.type&&(""!=e.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[e.unicode]&&(this.glyphs[e.unicode]=[]),this.glyphs[e.unicode][e.arabicForm]=e):this.glyphs[e.unicode]=e)}this.render=function(){}},u.Element.font.prototype=new u.Element.ElementBase,u.Element.fontface=function(t){this.base=u.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},u.Element.fontface.prototype=new u.Element.ElementBase,u.Element.missingglyph=function(t){this.base=u.Element.path,this.base(t),this.horizAdvX=0},u.Element.missingglyph.prototype=new u.Element.path,u.Element.glyph=function(t){this.base=u.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},u.Element.glyph.prototype=new u.Element.path,u.Element.text=function(t){this.captureTextNodes=!0,this.base=u.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var n=this.style("dominant-baseline").toTextBaseline();null==n&&(n=this.style("alignment-baseline").toTextBaseline()),null!=n&&(t.textBaseline=n)},this.initializeCoordinates=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0)},this.getBoundingBox=function(t){this.initializeCoordinates(t);for(var n=null,e=0;e<this.children.length;e++){var r=this.getChildBoundingBox(t,this,this,e);null==n?n=r:n.addBoundingBox(r)}return n},this.renderChildren=function(t){this.initializeCoordinates(t);for(var n=0;n<this.children.length;n++)this.renderChild(t,this,this,n);u.Mouse.checkBoundingBox(this,this.getBoundingBox(t))},this.getAnchorDelta=function(t,n,e){var r=this.style("text-anchor").valueOrDefault("start");if("start"==r)return 0;for(var i=0,a=e;a<n.children.length;a++){var o=n.children[a];if(e<a&&o.attribute("x").hasValue())break;i+=o.measureTextRecursive(t)}return-1*("end"==r?i:i/2)},this.adjustChildCoordinates=function(t,n,e,r){var i=e.children[r];if("function"!=typeof i.measureText)return i;if(i.attribute("x").hasValue()){i.x=i.attribute("x").toPixels("x")+n.getAnchorDelta(t,e,r);var a=i.attribute("text-anchor").valueOrDefault("start");if("start"!==a){var o=i.measureTextRecursive(t);i.x+=-1*("end"==a?o:o/2)}i.attribute("dx").hasValue()&&(i.x+=i.attribute("dx").toPixels("x"))}else i.attribute("dx").hasValue()&&(n.x+=i.attribute("dx").toPixels("x")),i.x=n.x;return n.x=i.x+i.measureText(t),i.attribute("y").hasValue()?(i.y=i.attribute("y").toPixels("y"),i.attribute("dy").hasValue()&&(i.y+=i.attribute("dy").toPixels("y"))):(i.attribute("dy").hasValue()&&(n.y+=i.attribute("dy").toPixels("y")),i.y=n.y),n.y=i.y,i},this.getChildBoundingBox=function(t,n,e,r){var i=this.adjustChildCoordinates(t,n,e,r),a=i.getBoundingBox(t);for(r=0;r<i.children.length;r++){var o=n.getChildBoundingBox(t,n,i,r);a.addBoundingBox(o)}return a},this.renderChild=function(t,n,e,r){var i=this.adjustChildCoordinates(t,n,e,r);for(i.render(t),r=0;r<i.children.length;r++)n.renderChild(t,n,i,r)}},u.Element.text.prototype=new u.Element.RenderedElementBase,u.Element.TextElementBase=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,n,e){var r=n[e],i=null;if(t.isArabic){var a="isolated";(0==e||" "==n[e-1])&&e<n.length-2&&" "!=n[e+1]&&(a="terminal"),0<e&&" "!=n[e-1]&&e<n.length-2&&" "!=n[e+1]&&(a="medial"),0<e&&" "!=n[e-1]&&(e==n.length-1||" "==n[e+1])&&(a="initial"),void 0!==t.glyphs[r]&&null==(i=t.glyphs[r][a])&&"glyph"==t.glyphs[r].type&&(i=t.glyphs[r])}else i=t.glyphs[r];return null==i&&(i=t.missingGlyph),i},this.renderChildren=function(t){var n=this.parent.style("font-family").getDefinition();if(null==n)"stroke"==t.paintOrder?(""!=t.strokeStyle&&t.strokeText(u.compressSpaces(this.getText()),this.x,this.y),""!=t.fillStyle&&t.fillText(u.compressSpaces(this.getText()),this.x,this.y)):(""!=t.fillStyle&&t.fillText(u.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(u.compressSpaces(this.getText()),this.x,this.y));else{var e=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize),r=this.parent.style("font-style").valueOrDefault(u.Font.Parse(u.ctx.font).fontStyle),i=this.getText();n.isRTL&&(i=i.split("").reverse().join(""));for(var a=u.ToNumberArray(this.parent.attribute("dx").value),o=0;o<i.length;o++){var s=this.getGlyph(n,i,o),c=e/n.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(c,-c);var f=t.lineWidth;t.lineWidth=t.lineWidth*n.fontFace.unitsPerEm/e,"italic"==r&&t.transform(1,0,.4,1,0,0),s.render(t),"italic"==r&&t.transform(1,0,-.4,1,0,0),t.lineWidth=f,t.scale(1/c,-1/c),t.translate(-this.x,-this.y),this.x+=e*(s.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,void 0===a[o]||isNaN(a[o])||(this.x+=a[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var n=this.measureText(t),e=0;e<this.children.length;e++)n+=this.children[e].measureTextRecursive(t);return n},this.measureText=function(t){var n=this.parent.style("font-family").getDefinition();if(null!=n){var e=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize),r=0,i=this.getText();n.isRTL&&(i=i.split("").reverse().join(""));for(var a=u.ToNumberArray(this.parent.attribute("dx").value),o=0;o<i.length;o++)r+=(this.getGlyph(n,i,o).horizAdvX||n.horizAdvX)*e/n.fontFace.unitsPerEm,void 0===a[o]||isNaN(a[o])||(r+=a[o]);return r}var s=u.compressSpaces(this.getText());if(!t.measureText)return 10*s.length;t.save(),this.setContext(t,!0);var c=t.measureText(s).width;return t.restore(),c},this.getBoundingBox=function(t){var n=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize);return new u.BoundingBox(this.x,this.y-n,this.x+this.measureText(t),this.y)}},u.Element.TextElementBase.prototype=new u.Element.RenderedElementBase,u.Element.tspan=function(t){this.captureTextNodes=!0,this.base=u.Element.TextElementBase,this.base(t),this.text=u.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},u.Element.tspan.prototype=new u.Element.TextElementBase,u.Element.tref=function(t){this.base=u.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},u.Element.tref.prototype=new u.Element.TextElementBase,u.Element.a=function(t){this.base=u.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var n=0;n<t.childNodes.length;n++)3!=t.childNodes[n].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value||t.childNodes[0].data:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var n=new u.Property("fontSize",u.Font.Parse(u.ctx.font).fontSize);u.Mouse.checkBoundingBox(this,new u.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var e=new u.Element.g;e.children=this.children,e.parent=this,e.render(t)}},this.onclick=function(){r.open(this.getHrefAttribute().value)},this.onmousemove=function(){u.ctx.canvas.style.cursor="pointer"}},u.Element.a.prototype=new u.Element.TextElementBase,u.Element.textPath=function(t){this.base=u.Element.TextElementBase,this.base(t);var n=this.getHrefAttribute().getDefinition();this.text=u.compressSpaces(t.value||t.text||t.textContent||""),this.renderChildren=function(t){this.setTextData(t),t.save();var n=this.parent.style("text-decoration").value,e=this.fontSize(),r=this.glyphInfo,i=t.fillStyle;"underline"===n&&t.beginPath();for(var a=0;a<r.length;a++){var o=r[a].p0,s=r[a].p1,c=r[a].text;t.save(),t.translate(o.x,o.y),t.rotate(r[a].rotation),""!=t.fillStyle&&t.fillText(u.compressSpaces(c),0,0),""!=t.strokeStyle&&t.strokeText(u.compressSpaces(c),0,0),t.restore(),"underline"===n&&(0===a&&t.moveTo(o.x,o.y+e/8),t.lineTo(s.x,s.y+e/5))}"underline"===n&&(t.lineWidth=e/20,t.strokeStyle=i,t.stroke(),t.closePath()),t.restore()},this.path=function(t){var n=this.dataArray;null!=t&&t.beginPath();for(var e=0;e<n.length;e++){var r=n[e].command,i=n[e].points;switch(r){case"L":null!=t&&t.lineTo(i[0],i[1]);break;case"M":null!=t&&t.moveTo(i[0],i[1]);break;case"C":null!=t&&t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":null!=t&&t.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":var a=i[0],o=i[1],u=i[2],s=i[3],c=i[4],f=i[5],l=i[6],h=i[7],d=s<u?u:s,p=s<u?1:u/s,y=s<u?s/u:1;null!=t&&(t.translate(a,o),t.rotate(l),t.scale(p,y),t.arc(0,0,d,c,c+f,1-h),t.scale(1/p,1/y),t.rotate(-l),t.translate(-a,-o));break;case"z":null!=t&&t.closePath()}}},this.getText=function(){return this.text},this.fontSize=function(){return this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize)},this.measureText=function(t,n){var e=this.parent.style("font-family").getDefinition();if(n=n||this.getText(),null!=e){var r=this.fontSize(),i=0;e.isRTL&&(n=n.split("").reverse().join(""));for(var a=u.ToNumberArray(this.parent.attribute("dx").value),o=0;o<n.length;o++)i+=(this.getGlyph(e,n,o).horizAdvX||e.horizAdvX)*r/e.fontFace.unitsPerEm,void 0===a[o]||isNaN(a[o])||(i+=a[o]);return i}var s=u.compressSpaces(n);if(!t.measureText)return 10*s.length;t.save(),this.setContext(t);var c=t.measureText(s).width;return t.restore(),c},this.setTextData=function(t){if(!this.hasOwnProperty("glyphInfo")){var n=this,e=this.getText().split(""),r=this.getText().split(" ").length-1,i=u.ToNumberArray(this.parent.attribute("dx").valueOrDefault("0")),a=0,o=this.parent.style("text-anchor").valueOrDefault("start"),s=this.style("letter-spacing"),c=this.parent.style("letter-spacing");s.hasValue()&&"inherit"!==s.getValue()?s.hasValue()&&"initial"!==s.getValue()&&"unset"!==s.getValue()&&(a=s.toPixels()):a=c.toPixels(),this.letterSpacingCache=[];for(var f=0;f<this.getText().length;f++)this.letterSpacingCache.push(void 0!==i[f]?i[f]:a);var l=this.letterSpacingCache.reduce((function(t,n){return t+n||0}),0);this.textWidth=this.measureText(t),this.textHeight=this.fontSize();var h=Math.max(this.textWidth+l,0);this.glyphInfo=[];var d=this.getPathLength(),p=this.style("startOffset").numValueOrDefault(0)*d,y=0;"middle"!==o&&"center"!==o||(y=-h/2),"end"!==o&&"right"!==o||(y=-h),y+=p;var v=function(e,i){var a,u=n.measureText(t,e);" "===e&&"justify"===o&&h<d&&(u+=(d-h)/r),-1<i&&(y+=(a=(a=i)||0,n.letterSpacingCache[a]||0));var s=n.textHeight/20,c={p0:n.getEquidistantPointOnPath(y,s),p1:n.getEquidistantPointOnPath(y+u,s)};return y+=u,c};for(f=0;f<e.length;f++){var g=v(e[f],f);if(void 0!==g.p0&&void 0!==g.p1){var m=n.getLineLength(g.p0.x,g.p0.y,g.p1.x,g.p1.y),b=n.getPointOnLine(0+m/2,g.p0.x,g.p0.y,g.p1.x,g.p1.y),x=Math.atan2(g.p1.y-g.p0.y,g.p1.x-g.p0.x);this.glyphInfo.push({transposeX:b.x,transposeY:b.y,text:e[f],rotation:x,p0:g.p0,p1:g.p1})}}}},this.parsePathData=function(t){if(this.pathLength=void 0,!t)return[];var n=[],e=t.PathParser;for(e.reset();!e.isEnd();){var r=[],i=null,a=e.current?e.current.x:0,o=e.current?e.current.y:0;e.nextCommand();var s=e.command.toUpperCase();switch(e.command){case"M":case"m":var c=e.getAsCurrentPoint();for(r.push(c.x,c.y),e.start=e.current;!e.isCommandOrEnd();)c=e.getAsCurrentPoint(),r.push(c.x,c.y),i="L";break;case"L":case"l":for(;!e.isCommandOrEnd();)c=e.getAsCurrentPoint(),r.push(c.x,c.y);i="L";break;case"H":case"h":for(;!e.isCommandOrEnd();){var f=new u.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);r.push(f.x,f.y),e.current=f}i="L";break;case"V":case"v":for(;!e.isCommandOrEnd();)f=new u.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),r.push(f.x,f.y),e.current=f;i="L";break;case"C":case"c":for(;!e.isCommandOrEnd();){var l=e.getPoint(),h=e.getAsControlPoint(),d=e.getAsCurrentPoint();r.push(l.x,l.y,h.x,h.y,d.x,d.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)l=e.getReflectedControlPoint(),h=e.getAsControlPoint(),d=e.getAsCurrentPoint(),r.push(l.x,l.y,h.x,h.y,d.x,d.y);i="C";break;case"Q":case"q":for(;!e.isCommandOrEnd();)h=e.getAsControlPoint(),d=e.getAsCurrentPoint(),r.push(h.x,h.y,d.x,d.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)h=e.getReflectedControlPoint(),e.control=h,d=e.getAsCurrentPoint(),r.push(h.x,h.y,d.x,d.y);i="Q";break;case"A":case"a":for(;!e.isCommandOrEnd();){var p=e.current,y=e.getScalar(),v=e.getScalar(),g=e.getScalar()*(Math.PI/180),m=e.getScalar(),b=e.getScalar(),x=(d=e.getAsCurrentPoint(),new u.Point(Math.cos(g)*(p.x-d.x)/2+Math.sin(g)*(p.y-d.y)/2,-Math.sin(g)*(p.x-d.x)/2+Math.cos(g)*(p.y-d.y)/2)),_=Math.pow(x.x,2)/Math.pow(y,2)+Math.pow(x.y,2)/Math.pow(v,2);1<_&&(y*=Math.sqrt(_),v*=Math.sqrt(_));var w=(m==b?-1:1)*Math.sqrt((Math.pow(y,2)*Math.pow(v,2)-Math.pow(y,2)*Math.pow(x.y,2)-Math.pow(v,2)*Math.pow(x.x,2))/(Math.pow(y,2)*Math.pow(x.y,2)+Math.pow(v,2)*Math.pow(x.x,2)));isNaN(w)&&(w=0);var M=new u.Point(w*y*x.y/v,w*-v*x.x/y),E=new u.Point((p.x+d.x)/2+Math.cos(g)*M.x-Math.sin(g)*M.y,(p.y+d.y)/2+Math.sin(g)*M.x+Math.cos(g)*M.y),P=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},T=function(t,n){return(t[0]*n[0]+t[1]*n[1])/(P(t)*P(n))},C=function(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(T(t,n))},k=C([1,0],[(x.x-M.x)/y,(x.y-M.y)/v]),S=[(x.x-M.x)/y,(x.y-M.y)/v],A=[(-x.x-M.x)/y,(-x.y-M.y)/v],N=C(S,A);T(S,A)<=-1&&(N=Math.PI),1<=T(S,A)&&(N=0),0===b&&0<N&&(N-=2*Math.PI),1===b&&N<0&&(N+=2*Math.PI),r=[E.x,E.y,y,v,k,N,g,b]}break;case"Z":case"z":e.current=e.start}"Z"!==s?n.push({command:i||s,points:r,start:{x:a,y:o},pathLength:this.calcLength(a,o,i||s,r)}):n.push({command:"z",points:[],start:void 0,pathLength:0})}return n},this.getPathLength=function(){if(void 0===this.pathLength||null===this.pathLength||isNaN(this.pathLength))for(var t=this.pathLength=0;t<this.dataArray.length;t++)0<this.dataArray[t].pathLength&&(this.pathLength+=this.dataArray[t].pathLength);return this.pathLength},this.getPointOnPath=function(t){var n=0,e=this.getPathLength(),r=void 0;if(!(t<-5e-5||e<t-5e-5))for(var i=0;i<this.dataArray.length;i++){var a=this.dataArray[i];if(!a||!(a.pathLength<5e-5||n+a.pathLength+5e-5<t)){var o=t-n,u=void 0;switch(a.command){case"L":r=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case"A":var s=a.points[4],c=a.points[5],f=a.points[4]+c;if(u=s+o/a.pathLength*c,c<0&&u<f||0<=c&&f<u)break;r=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],u,a.points[6]);break;case"C":1<(u=o/a.pathLength)&&(u=1),r=this.getPointOnCubicBezier(u,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":1<(u=o/a.pathLength)&&(u=1),r=this.getPointOnQuadraticBezier(u,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(void 0!==r&&r!=={})return r;break}n+=a.pathLength}},this.buildEquidistantCache=function(t,n){var e=this.getPathLength();if(n=n||.25,t=t||e/100,this.equidistantCache=this.equidistantCache||{},!this.equidistantCache.hasOwnProperty("points")||this.equidistantCache.step!=t||this.equidistantCache.precision!=n){this.equidistantCache={step:t,precision:n,points:[]};for(var r=0,i=0;i<=e;i+=n){var a=this.getPointOnPath(i),o=this.getPointOnPath(i+n);void 0!==a&&void 0!==o&&t<=(r+=this.getLineLength(a.x,a.y,o.x,o.y))&&(this.equidistantCache.points.push({x:a.x,y:a.y,distance:i}),r-=t)}}},this.getEquidistantPointOnPath=function(t,n,e){if(this.buildEquidistantCache(n,e),!(t<0||5e-5<t-this.getPathLength())){var r=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[r]||void 0}},this.getLineLength=function(t,n,e,r){return Math.sqrt((e-t)*(e-t)+(r-n)*(r-n))},this.getPointOnLine=function(t,n,e,r,i,a,o){void 0===a&&(a=n),void 0===o&&(o=e);var u=(i-e)/(r-n+1e-8),s=Math.sqrt(t*t/(1+u*u));r<n&&(s*=-1);var c,f=u*s;if(r===n)c={x:a,y:o+f};else if((o-e)/(a-n+1e-8)===u)c={x:a+s,y:o+f};else{var l,h,d=this.getLineLength(n,e,r,i);if(d<1e-8)return;var p=(a-n)*(r-n)+(o-e)*(i-e);l=n+(p/=d*d)*(r-n),h=e+p*(i-e);var y=this.getLineLength(a,o,l,h),v=Math.sqrt(t*t-y*y);s=Math.sqrt(v*v/(1+u*u)),r<n&&(s*=-1),c={x:l+s,y:h+(f=u*s)}}return c},this.getPointOnCubicBezier=function(t,n,e,r,i,a,o,u,s){function c(t){return t*t*t}function f(t){return 3*t*t*(1-t)}function l(t){return 3*t*(1-t)*(1-t)}function h(t){return(1-t)*(1-t)*(1-t)}return{x:u*c(t)+a*f(t)+r*l(t)+n*h(t),y:s*c(t)+o*f(t)+i*l(t)+e*h(t)}},this.getPointOnQuadraticBezier=function(t,n,e,r,i,a,o){function u(t){return t*t}function s(t){return 2*t*(1-t)}function c(t){return(1-t)*(1-t)}return{x:a*u(t)+r*s(t)+n*c(t),y:o*u(t)+i*s(t)+e*c(t)}},this.getPointOnEllipticalArc=function(t,n,e,r,i,a){var o=Math.cos(a),u=Math.sin(a),s=e*Math.cos(i),c=r*Math.sin(i);return{x:t+(s*o-c*u),y:n+(s*u+c*o)}},this.calcLength=function(t,n,e,r){var i,a,o,u;switch(e){case"L":return this.getLineLength(t,n,r[0],r[1]);case"C":for(i=0,a=this.getPointOnCubicBezier(0,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),u=.01;u<=1;u+=.01)o=this.getPointOnCubicBezier(u,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),i+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return i;case"Q":for(i=0,a=this.getPointOnQuadraticBezier(0,t,n,r[0],r[1],r[2],r[3]),u=.01;u<=1;u+=.01)o=this.getPointOnQuadraticBezier(u,t,n,r[0],r[1],r[2],r[3]),i+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return i;case"A":i=0;var s=r[4],c=r[5],f=r[4]+c,l=Math.PI/180;if(Math.abs(s-f)<l&&(l=Math.abs(s-f)),a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),c<0)for(u=s-l;f<u;u-=l)o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(u=s+l;u<f;u+=l)o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],f,0),i+this.getLineLength(a.x,a.y,o.x,o.y)}return 0},this.dataArray=this.parsePathData(n)},u.Element.textPath.prototype=new u.Element.TextElementBase,u.Element.image=function(t){this.base=u.Element.RenderedElementBase,this.base(t);var n=this.getHrefAttribute().value;if(""!=n){var e=n.match(/\.svg$/);if(u.Images.push(this),this.loaded=!1,e)this.img=u.ajax(n),this.loaded=!0;else{this.img=i.createElement("img"),1==u.opts.useCORS&&(this.img.crossOrigin="Anonymous");var r=this;this.img.onload=function(){r.loaded=!0},this.img.onerror=function(){u.log('ERROR: image "'+n+'" not found'),r.loaded=!0},this.img.src=n}this.renderChildren=function(t){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),a=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=a&&0!=o&&(t.save(),e?t.drawSvg(this.img,n,i,a,o):(t.translate(n,i),u.AspectRatio(t,this.attribute("preserveAspectRatio").value,a,this.img.width,o,this.img.height,0,0),r.loaded&&(void 0===this.img.complete||this.img.complete)&&t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");return new u.BoundingBox(t,n,t+e,n+r)}}},u.Element.image.prototype=new u.Element.RenderedElementBase,u.Element.g=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(t){for(var n=new u.BoundingBox,e=0;e<this.children.length;e++)n.addBoundingBox(this.children[e].getBoundingBox(t));return n}},u.Element.g.prototype=new u.Element.RenderedElementBase,u.Element.symbol=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.render=function(){}},u.Element.symbol.prototype=new u.Element.RenderedElementBase,u.ParseExternalUrl=function(t){var n=t.match(/url\(('([^']+)'|"([^"]+)"|([^'"\)]+))\)/)||[];return n[2]||n[3]||n[4]},u.Element.style=function(t){this.base=u.Element.ElementBase,this.base(t);for(var n="",e=0;e<t.childNodes.length;e++)n+=t.childNodes[e].data;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var r=(n=u.compressSpaces(n)).split("}");for(e=0;e<r.length;e++)if(""!=u.trim(r[e]))for(var i=r[e].split("{"),a=i[0].split(","),o=i[1].split(";"),s=0;s<a.length;s++){var c=u.trim(a[s]);if(""!=c){for(var f=u.Styles[c]||{},l=0;l<o.length;l++){var h=o[l].indexOf(":"),d=o[l].substr(0,h),p=o[l].substr(h+1,o[l].length-h);null!=d&&null!=p&&(f[u.trim(d)]=new u.Property(u.trim(d),u.trim(p)))}if(u.Styles[c]=f,u.StylesSpecificity[c]=y(c),"@font-face"==c)for(var v=f["font-family"].value.replace(/"/g,""),g=f.src.value.split(","),m=0;m<g.length;m++)if(0<g[m].indexOf('format("svg")')){var b=u.ParseExternalUrl(g[m]);if(b)for(var x=u.parseXml(u.ajax(b)).getElementsByTagName("font"),_=0;_<x.length;_++){var w=u.CreateElement(x[_]);u.Definitions[v]=w}}}}},u.Element.style.prototype=new u.Element.ElementBase,u.Element.use=function(t){this.base=u.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var n=this.getHrefAttribute().getDefinition();this.path=function(t){null!=n&&n.path(t)},this.elementTransform=function(){if(null!=n&&n.style("transform",!1,!0).hasValue())return new u.Transform(n.style("transform",!1,!0).value)},this.getBoundingBox=function(t){if(null!=n)return n.getBoundingBox(t)},this.renderChildren=function(t){if(null!=n){var e=n;"symbol"==n.type&&((e=new u.Element.svg).type="svg",e.attributes.viewBox=new u.Property("viewBox",n.attribute("viewBox").value),e.attributes.preserveAspectRatio=new u.Property("preserveAspectRatio",n.attribute("preserveAspectRatio").value),e.attributes.overflow=new u.Property("overflow",n.attribute("overflow").value),e.children=n.children),"svg"==e.type&&(this.attribute("width").hasValue()&&(e.attributes.width=new u.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(e.attributes.height=new u.Property("height",this.attribute("height").value)));var r=e.parent;e.parent=null,e.render(t),e.parent=r}}},u.Element.use.prototype=new u.Element.RenderedElementBase,u.Element.mask=function(t){this.base=u.Element.ElementBase,this.base(t),this.apply=function(t,n){var e=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==i&&0==o){for(var s=new u.BoundingBox,c=0;c<this.children.length;c++)s.addBoundingBox(this.children[c].getBoundingBox(t));e=Math.floor(s.x1),r=Math.floor(s.y1),i=Math.floor(s.width()),o=Math.floor(s.height())}var f=n.style("mask").value;n.style("mask").value="";var l=a(e+i,r+o),h=l.getContext("2d");u.SetDefaults(h),this.renderChildren(h),new u.Element.feColorMatrix({nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(h,0,0,e+i,r+o);var d=a(e+i,r+o),p=d.getContext("2d");u.SetDefaults(p),n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=h.createPattern(l,"no-repeat"),p.fillRect(0,0,e+i,r+o),t.fillStyle=p.createPattern(d,"no-repeat"),t.fillRect(0,0,e+i,r+o),n.style("mask").value=f},this.render=function(){}},u.Element.mask.prototype=new u.Element.ElementBase,u.Element.clipPath=function(t){this.base=u.Element.ElementBase,this.base(t),this.apply=function(t){var n="undefined"!=typeof CanvasRenderingContext2D,e=t.beginPath,r=t.closePath;n&&(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath=function(){}),e.call(t);for(var i=0;i<this.children.length;i++){var a=this.children[i];if(void 0!==a.path){var o=void 0!==a.elementTransform&&a.elementTransform();!o&&a.style("transform",!1,!0).hasValue()&&(o=new u.Transform(a.style("transform",!1,!0).value)),o&&o.apply(t),a.path(t),n&&(CanvasRenderingContext2D.prototype.closePath=r),o&&o.unapply(t)}}r.call(t),t.clip(),n&&(CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=r)},this.render=function(){}},u.Element.clipPath.prototype=new u.Element.ElementBase,u.Element.filter=function(t){this.base=u.Element.ElementBase,this.base(t),this.apply=function(t,n){var e=n.getBoundingBox(t),r=Math.floor(e.x1),i=Math.floor(e.y1),o=Math.floor(e.width()),s=Math.floor(e.height()),c=n.style("filter").value;n.style("filter").value="";for(var f=0,l=0,h=0;h<this.children.length;h++){var d=this.children[h].extraFilterDistance||0;f=Math.max(f,d),l=Math.max(l,d)}var p=a(o+2*f,s+2*l),y=p.getContext("2d");for(u.SetDefaults(y),y.translate(-r+f,-i+l),n.render(y),h=0;h<this.children.length;h++)"function"==typeof this.children[h].apply&&this.children[h].apply(y,0,0,o+2*f,s+2*l);t.drawImage(p,0,0,o+2*f,s+2*l,r-f,i-l,o+2*f,s+2*l),n.style("filter",!0).value=c},this.render=function(){}},u.Element.filter.prototype=new u.Element.ElementBase,u.Element.feDropShadow=function(t){this.base=u.Element.ElementBase,this.base(t),this.addStylesFromStyleDefinition(),this.apply=function(){}},u.Element.feDropShadow.prototype=new u.Element.ElementBase,u.Element.feMorphology=function(t){this.base=u.Element.ElementBase,this.base(t),this.apply=function(){}},u.Element.feMorphology.prototype=new u.Element.ElementBase,u.Element.feComposite=function(t){this.base=u.Element.ElementBase,this.base(t),this.apply=function(){}},u.Element.feComposite.prototype=new u.Element.ElementBase,u.Element.feColorMatrix=function(t){this.base=u.Element.ElementBase,this.base(t);var n=u.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var e=n[0];n=[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var r=n[0]*Math.PI/180,i=function(t,n,e){return t+Math.cos(r)*n+Math.sin(r)*e};n=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function a(t,n,e,r,i,a){return t[e*r*4+4*n+a]}function o(t,n,e,r,i,a,o){t[e*r*4+4*n+a]=o}function s(t,e){var r=n[t];return r*(r<0?e-255:e)}var c=this.attribute("includeOpacity").hasValue();this.apply=function(t,n,e,r,i){var u=t.getImageData(0,0,r,i);for(e=0;e<i;e++)for(n=0;n<r;n++){var f=a(u.data,n,e,r,0,0),l=a(u.data,n,e,r,0,1),h=a(u.data,n,e,r,0,2),d=a(u.data,n,e,r,0,3),p=s(0,f)+s(1,l)+s(2,h)+s(3,d)+s(4,1),y=s(5,f)+s(6,l)+s(7,h)+s(8,d)+s(9,1),v=s(10,f)+s(11,l)+s(12,h)+s(13,d)+s(14,1),g=s(15,f)+s(16,l)+s(17,h)+s(18,d)+s(19,1);c&&(p=y=v=0,g*=d/255),o(u.data,n,e,r,0,0,p),o(u.data,n,e,r,0,1,y),o(u.data,n,e,r,0,2,v),o(u.data,n,e,r,0,3,g)}t.clearRect(0,0,r,i),t.putImageData(u,0,0)}},u.Element.feColorMatrix.prototype=new u.Element.ElementBase,u.Element.feGaussianBlur=function(t){this.base=u.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,e,r,a,o){n&&void 0!==n.canvasRGBA?(t.canvas.id=u.UniqueId(),t.canvas.style.display="none",i.body.appendChild(t.canvas),n.canvasRGBA(t.canvas,e,r,a,o,this.blurRadius),i.body.removeChild(t.canvas)):u.log("ERROR: StackBlur.js must be included for blur to work")}},u.Element.feGaussianBlur.prototype=new u.Element.ElementBase,u.Element.title=function(){},u.Element.title.prototype=new u.Element.ElementBase,u.Element.desc=function(){},u.Element.desc.prototype=new u.Element.ElementBase,u.Element.MISSING=function(t){u.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},u.Element.MISSING.prototype=new u.Element.ElementBase,u.CreateElement=function(t){var n=t.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var e=null;return(e=void 0!==u.Element[n]?new u.Element[n](t):new u.Element.MISSING(t)).type=t.nodeName,e},u.load=function(t,n){u.loadXml(t,u.ajax(n))},u.loadXml=function(t,n){u.loadXmlDoc(t,u.parseXml(n))},u.loadXmlDoc=function(t,n){u.init(t);var e=function(n){for(var e=t.canvas;e;)n.x-=e.offsetLeft,n.y-=e.offsetTop,e=e.offsetParent;return r.scrollX&&(n.x+=r.scrollX),r.scrollY&&(n.y+=r.scrollY),n};1!=u.opts.ignoreMouse&&(t.canvas.onclick=function(t){var n=e(new u.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));u.Mouse.onclick(n.x,n.y)},t.canvas.onmousemove=function(t){var n=e(new u.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));u.Mouse.onmousemove(n.x,n.y)});var i=u.CreateElement(n.documentElement);i.root=!0,i.addStylesFromStyleDefinition();var a=!0,o=function(){u.ViewPort.Clear(),t.canvas.parentNode?u.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight):u.ViewPort.SetCurrent(800,600),1!=u.opts.ignoreDimensions&&(a||null==u.opts.scaleWidth&&null==u.opts.scaleHeight)&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style&&(t.canvas.style.width=t.canvas.width+"px")),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style&&(t.canvas.style.height=t.canvas.height+"px")));var e=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==u.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(e=i.style("width").toPixels("x"),r=i.style("height").toPixels("y")),u.ViewPort.SetCurrent(e,r),null!=u.opts.offsetX&&(i.attribute("x",!0).value=u.opts.offsetX),null!=u.opts.offsetY&&(i.attribute("y",!0).value=u.opts.offsetY),null!=u.opts.scaleWidth||null!=u.opts.scaleHeight){var o=null,s=null,c=u.ToNumberArray(i.attribute("viewBox").value);null!=u.opts.scaleWidth&&(i.attribute("width").hasValue()?o=i.attribute("width").toPixels("x")/u.opts.scaleWidth:isNaN(c[2])||(o=c[2]/u.opts.scaleWidth)),null!=u.opts.scaleHeight&&(i.attribute("height").hasValue()?s=i.attribute("height").toPixels("y")/u.opts.scaleHeight:isNaN(c[3])||(s=c[3]/u.opts.scaleHeight)),null==o&&(o=s),null==s&&(s=o),i.attribute("width",!0).value=u.opts.scaleWidth,i.attribute("height",!0).value=u.opts.scaleHeight,i.style("transform",!0,!0).value+=" scale("+1/o+","+1/s+")"}1!=u.opts.ignoreClear&&t.clearRect(0,0,e,r),i.render(t),a&&(a=!1,"function"==typeof u.opts.renderCallback&&u.opts.renderCallback(n))},s=!0;u.ImagesLoaded()&&(s=!1,o()),u.intervalID=setInterval((function(){var t=!1;if(s&&u.ImagesLoaded()&&(t=!(s=!1)),1!=u.opts.ignoreMouse&&(t=t||u.Mouse.hasEvents()),1!=u.opts.ignoreAnimation)for(var n=0;n<u.Animations.length;n++){var e=u.Animations[n].update(1e3/u.FRAMERATE);t=t||e}"function"==typeof u.opts.forceRedraw&&1==u.opts.forceRedraw()&&(t=!0),t&&(o(),u.Mouse.runEvents())}),1e3/u.FRAMERATE)},u.stop=function(){u.intervalID&&clearInterval(u.intervalID)},u.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,n){this.events.push({type:"onclick",x:t,y:n,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,n){this.events.push({type:"onmousemove",x:t,y:n,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,n){for(var e=0;e<this.events.length;e++){var r=this.events[e];n.isPointInPath&&n.isPointInPath(r.x,r.y)&&(this.eventElements[e]=t)}},this.checkBoundingBox=function(t,n){if(n)for(var e=0;e<this.events.length;e++){var r=this.events[e];n.isPointInBox(r.x,r.y)&&(this.eventElements[e]=t)}},this.runEvents=function(){u.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var n=this.events[t],e=this.eventElements[t];e;)n.run(e),e=e.parent;this.events=[],this.eventElements=[]}},u}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,n,e,r,i,a){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:n,offsetY:e,scaleWidth:r,scaleHeight:i};for(var s in a)a.hasOwnProperty(s)&&(o[s]=a[s]);u(this.canvas,t,o)}),u._build=v,e.exports=u}(e={exports:{}}),e.exports}(e(47),e(48))},47:function(t,n){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=n[t]||t;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<e.length;r++){var i=e[r].re,a=e[r].process,o=i.exec(t);if(o){var u=a(o);this.r=u[0],this.g=u[1],this.b=u[2],u.length>3&&(this.alpha=u[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),n=this.g.toString(16),e=this.b.toString(16);return 1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),1==e.length&&(e="0"+e),"#"+t+n+e},this.getHelpXML=function(){for(var t=new Array,r=0;r<e.length;r++)for(var i=e[r].example,a=0;a<i.length;a++)t[t.length]=i[a];for(var o in n)t[t.length]=o;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(r=0;r<t.length;r++)try{var s=document.createElement("li"),c=new RGBColor(t[r]),f=document.createElement("div");f.style.cssText="margin: 3px; border: 1px solid black; background:"+c.toHex()+"; color:"+c.toHex(),f.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+t[r]+" -> "+c.toRGB()+" -> "+c.toHex());s.appendChild(f),s.appendChild(l),u.appendChild(s)}catch(t){}return u}}},48:function(t,n,e){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.r(n),e.d(n,"BlurStack",(function(){return h})),e.d(n,"image",(function(){return o})),e.d(n,"canvasRGBA",(function(){return s})),e.d(n,"canvasRGB",(function(){return f})),e.d(n,"imageDataRGBA",(function(){return c})),e.d(n,"imageDataRGB",(function(){return l}));var i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(t,n,e,r){if("string"==typeof t&&(t=document.getElementById(t)),t&&"naturalWidth"in t){var i=t.naturalWidth,a=t.naturalHeight;if("string"==typeof n&&(n=document.getElementById(n)),n&&"getContext"in n){n.style.width=i+"px",n.style.height=a+"px",n.width=i,n.height=a;var o=n.getContext("2d");o.clearRect(0,0,i,a),o.drawImage(t,0,0),isNaN(e)||e<1||(r?s(n,0,0,i,a,e):f(n,0,0,i,a,e))}}}function u(t,n,e,i,a){if("string"==typeof t&&(t=document.getElementById(t)),!(t&&"object"===r(t)&&"getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=t.getContext("2d");try{return o.getImageData(n,e,i,a)}catch(t){throw new Error("unable to access image data: "+t)}}function s(t,n,e,r,i,a){if(!(isNaN(a)||a<1)){a|=0;var o=u(t,n,e,r,i);o=c(o,n,e,r,i,a),t.getContext("2d").putImageData(o,n,e)}}function c(t,n,e,r,o,u){var s,c,f,l,d,p,y,v,g,m,b,x,_,w,M,E,P,T,C,k,S,A,N,B,z,D=t.data,R=2*u+1,O=r-1,V=o-1,L=u+1,I=L*(L+1)/2,q=new h,U=q;for(f=1;f<R;f++)U=U.next=new h,f===L&&(z=U);U.next=q;var F=null,j=null;y=p=0;var Y=i[u],X=a[u];for(c=0;c<o;c++){for(E=P=T=C=v=g=m=b=0,x=L*(k=D[p]),_=L*(S=D[p+1]),w=L*(A=D[p+2]),M=L*(N=D[p+3]),v+=I*k,g+=I*S,m+=I*A,b+=I*N,U=q,f=0;f<L;f++)U.r=k,U.g=S,U.b=A,U.a=N,U=U.next;for(f=1;f<L;f++)l=p+((O<f?O:f)<<2),v+=(U.r=k=D[l])*(B=L-f),g+=(U.g=S=D[l+1])*B,m+=(U.b=A=D[l+2])*B,b+=(U.a=N=D[l+3])*B,E+=k,P+=S,T+=A,C+=N,U=U.next;for(F=q,j=z,s=0;s<r;s++)D[p+3]=N=b*Y>>X,0!==N?(N=255/N,D[p]=(v*Y>>X)*N,D[p+1]=(g*Y>>X)*N,D[p+2]=(m*Y>>X)*N):D[p]=D[p+1]=D[p+2]=0,v-=x,g-=_,m-=w,b-=M,x-=F.r,_-=F.g,w-=F.b,M-=F.a,l=y+((l=s+u+1)<O?l:O)<<2,v+=E+=F.r=D[l],g+=P+=F.g=D[l+1],m+=T+=F.b=D[l+2],b+=C+=F.a=D[l+3],F=F.next,x+=k=j.r,_+=S=j.g,w+=A=j.b,M+=N=j.a,E-=k,P-=S,T-=A,C-=N,j=j.next,p+=4;y+=r}for(s=0;s<r;s++){for(P=T=C=E=g=m=b=v=0,x=L*(k=D[p=s<<2]),_=L*(S=D[p+1]),w=L*(A=D[p+2]),M=L*(N=D[p+3]),v+=I*k,g+=I*S,m+=I*A,b+=I*N,U=q,f=0;f<L;f++)U.r=k,U.g=S,U.b=A,U.a=N,U=U.next;for(d=r,f=1;f<=u;f++)p=d+s<<2,v+=(U.r=k=D[p])*(B=L-f),g+=(U.g=S=D[p+1])*B,m+=(U.b=A=D[p+2])*B,b+=(U.a=N=D[p+3])*B,E+=k,P+=S,T+=A,C+=N,U=U.next,f<V&&(d+=r);for(p=s,F=q,j=z,c=0;c<o;c++)D[(l=p<<2)+3]=N=b*Y>>X,N>0?(N=255/N,D[l]=(v*Y>>X)*N,D[l+1]=(g*Y>>X)*N,D[l+2]=(m*Y>>X)*N):D[l]=D[l+1]=D[l+2]=0,v-=x,g-=_,m-=w,b-=M,x-=F.r,_-=F.g,w-=F.b,M-=F.a,l=s+((l=c+L)<V?l:V)*r<<2,v+=E+=F.r=D[l],g+=P+=F.g=D[l+1],m+=T+=F.b=D[l+2],b+=C+=F.a=D[l+3],F=F.next,x+=k=j.r,_+=S=j.g,w+=A=j.b,M+=N=j.a,E-=k,P-=S,T-=A,C-=N,j=j.next,p+=r}return t}function f(t,n,e,r,i,a){if(!(isNaN(a)||a<1)){a|=0;var o=u(t,n,e,r,i);o=l(o,n,e,r,i,a),t.getContext("2d").putImageData(o,n,e)}}function l(t,n,e,r,o,u){var s,c,f,l,d,p,y,v,g,m,b,x,_,w,M,E,P,T,C,k,S,A=t.data,N=2*u+1,B=r-1,z=o-1,D=u+1,R=D*(D+1)/2,O=new h,V=O;for(f=1;f<N;f++)V=V.next=new h,f===D&&(S=V);V.next=O;var L=null,I=null;y=p=0;var q=i[u],U=a[u];for(c=0;c<o;c++){for(w=M=E=v=g=m=0,b=D*(P=A[p]),x=D*(T=A[p+1]),_=D*(C=A[p+2]),v+=R*P,g+=R*T,m+=R*C,V=O,f=0;f<D;f++)V.r=P,V.g=T,V.b=C,V=V.next;for(f=1;f<D;f++)l=p+((B<f?B:f)<<2),v+=(V.r=P=A[l])*(k=D-f),g+=(V.g=T=A[l+1])*k,m+=(V.b=C=A[l+2])*k,w+=P,M+=T,E+=C,V=V.next;for(L=O,I=S,s=0;s<r;s++)A[p]=v*q>>U,A[p+1]=g*q>>U,A[p+2]=m*q>>U,v-=b,g-=x,m-=_,b-=L.r,x-=L.g,_-=L.b,l=y+((l=s+u+1)<B?l:B)<<2,v+=w+=L.r=A[l],g+=M+=L.g=A[l+1],m+=E+=L.b=A[l+2],L=L.next,b+=P=I.r,x+=T=I.g,_+=C=I.b,w-=P,M-=T,E-=C,I=I.next,p+=4;y+=r}for(s=0;s<r;s++){for(M=E=w=g=m=v=0,b=D*(P=A[p=s<<2]),x=D*(T=A[p+1]),_=D*(C=A[p+2]),v+=R*P,g+=R*T,m+=R*C,V=O,f=0;f<D;f++)V.r=P,V.g=T,V.b=C,V=V.next;for(d=r,f=1;f<=u;f++)p=d+s<<2,v+=(V.r=P=A[p])*(k=D-f),g+=(V.g=T=A[p+1])*k,m+=(V.b=C=A[p+2])*k,w+=P,M+=T,E+=C,V=V.next,f<z&&(d+=r);for(p=s,L=O,I=S,c=0;c<o;c++)A[l=p<<2]=v*q>>U,A[l+1]=g*q>>U,A[l+2]=m*q>>U,v-=b,g-=x,m-=_,b-=L.r,x-=L.g,_-=L.b,l=s+((l=c+D)<z?l:z)*r<<2,v+=w+=L.r=A[l],g+=M+=L.g=A[l+1],m+=E+=L.b=A[l+2],L=L.next,b+=P=I.r,x+=T=I.g,_+=C=I.b,w-=P,M-=T,E-=C,I=I.next,p+=r}return t}var h=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}},9:function(t,n,e){"use strict";function r(){}function i(t,n){var e=new r;if(t instanceof r)t.each((function(t,n){e.set(n,t)}));else if(Array.isArray(t)){var i,a=-1,o=t.length;if(null==n)for(;++a<o;)e.set(a,t[a]);else for(;++a<o;)e.set(n(i=t[a],a,t),i)}else if(t)for(var u in t)e.set(u,t[u]);return e}r.prototype=i.prototype={constructor:r,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};var a=i,o=function(){var t,n,e,r=[],i=[];function o(e,i,u,s){if(i>=r.length)return null!=t&&e.sort(t),null!=n?n(e):e;for(var c,f,l,h=-1,d=e.length,p=r[i++],y=a(),v=u();++h<d;)(l=y.get(c=p(f=e[h])+""))?l.push(f):y.set(c,[f]);return y.each((function(t,n){s(v,n,o(t,i,u,s))})),v}return e={object:function(t){return o(t,0,u,s)},map:function(t){return o(t,0,c,f)},entries:function(t){return function t(e,a){if(++a>r.length)return e;var o,u=i[a-1];return null!=n&&a>=r.length?o=e.entries():(o=[],e.each((function(n,e){o.push({key:e,values:t(n,a)})}))),null!=u?o.sort((function(t,n){return u(t.key,n.key)})):o}(o(t,0,c,f),0)},key:function(t){return r.push(t),e},sortKeys:function(t){return i[r.length-1]=t,e},sortValues:function(n){return t=n,e},rollup:function(t){return n=t,e}}};function u(){return{}}function s(t,n,e){t[n]=e}function c(){return a()}function f(t,n,e){t.set(n,e)}function l(){}var h=a.prototype;function d(t,n){var e=new l;if(t instanceof l)t.each((function(t){e.add(t)}));else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}l.prototype=d.prototype={constructor:l,has:h.has,add:function(t){return this["$"+(t+="")]=t,this},remove:h.remove,clear:h.clear,values:h.keys,size:h.size,empty:h.empty,each:h.each};var p=d,y=function(t){var n=[];for(var e in t)n.push(e);return n},v=function(t){var n=[];for(var e in t)n.push(t[e]);return n},g=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n};e.d(n,"d",(function(){return o})),e.d(n,"e",(function(){return p})),e.d(n,"c",(function(){return a})),e.d(n,"b",(function(){return y})),e.d(n,"f",(function(){return v})),e.d(n,"a",(function(){return g}))}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:e188b520e2a1ddf17ef82b98c062c194', location = 'build/e188b520e2a1ddf17ef8.js' */
(window.webpackJsonpTFAC=window.webpackJsonpTFAC||[]).push([[9],{36:function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var s,a=[],l=!1,f=-1;function h(){l&&s&&(l=!1,s.length?a=s.concat(a):f=-1,a.length&&p())}function p(){if(!l){var t=c(h);l=!0;for(var e=a.length;e;){for(s=a,a=[];++f<e;)s&&s[f].run();f=-1,e=a.length}s=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function w(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new m(t,e)),1!==a.length||l||c(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=w,o.addListener=w,o.once=w,o.off=w,o.removeListener=w,o.removeAllListeners=w,o.emit=w,o.prependListener=w,o.prependOnceListener=w,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:macro-browser-resources', location = 'build/macro-browser.js' */
!function(e){function t(t){for(var n,o,l=t[0],s=t[1],c=t[2],d=0,p=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,l=1;l<r.length;l++){var s=r[l];0!==i[s]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},i={22:0},a=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window.webpackJsonpTFAC=window.webpackJsonpTFAC||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;a.push([82,0,1,3,4,9,14,15,2,6,10,12]),r()}({12:function(e,t){e.exports=jQuery},15:function(e,t){if(window.TFACMacroEditorUI=window.TFACMacroEditorUI||{},void 0===r)var r={};r.subtleButton=function(e,t){return"<div class='aui-button aui-button-subtle' id='button-"+soy.$$escapeHtml(e.id)+'\' style="padding-left: 0"><span class="aui-icon aui-icon-small tf-iconfont-view-table" style="margin-right: 3px"></span>'+soy.$$escapeHtml(e.name)+"</div>"},goog.DEBUG&&(r.subtleButton.soyTemplateName="TFACMacroEditorUI.subtleButton"),r.tableFilterTabs=function(e,t){return'<div class="aui-tabs horizontal-tabs tf-macrobrowser-tabs"><ul class="tabs-menu"><li id="tab-filters" class="menu-item"><a href="#tab-filters-div">'+"Filters"+'</a></li><li id="tab-filter-options" class="menu-item"><a href="#tab-filter-options-div">'+"Filtration"+'</a></li><li id="tab-table-options" class="menu-item"><a href="#tab-table-options-div">'+"Table View"+'</a></li></ul><div class="tabs-pane active-pane"></div></div>'},goog.DEBUG&&(r.tableFilterTabs.soyTemplateName="TFACMacroEditorUI.tableFilterTabs"),r.pivotTabs=function(e,t){return'<div class="aui-tabs horizontal-tabs tf-macrobrowser-tabs"><ul class="tabs-menu"><li id="tab-columns" class="menu-item"><a href="#tab-columns-div">'+"Data Source"+'</a></li><li id="tab-options" class="menu-item"><a href="#tab-options-div">'+"Options"+'</a></li></ul><div class="tabs-pane active-pane"></div></div>'},goog.DEBUG&&(r.pivotTabs.soyTemplateName="TFACMacroEditorUI.pivotTabs"),r.chartTabs=function(e,t){return'<div class="aui-tabs horizontal-tabs tf-macrobrowser-tabs"><ul class="tabs-menu"><li id="tab-columns" class="menu-item"><a href="#tab-columns-div">'+"Settings"+'</a></li><li id="tab-display-options" class="menu-item"><a href="#tab-display-options-div">'+"Look"+'</a></li><li id="tab-advanced-options" class="menu-item"><a href="#tab-advanced-options-div">'+"Adjustments"+'</a></li></ul><div class="tabs-pane active-pane"></div></div>'},goog.DEBUG&&(r.chartTabs.soyTemplateName="TFACMacroEditorUI.chartTabs"),e.exports=r},33:function(e,t,r){},39:function(e,t,r){},40:function(e,t,r){},41:function(e,t,r){(function(e){var n,i,a,o;function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o=function(e){"use strict";function t(e){for(var t;null!=(t=e.next());)if("`"==t&&!e.eat("`"))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null}function r(e){return e.eat("@")&&(e.match(/^session\./),e.match(/^local\./),e.match(/^global\./)),e.eat("'")?(e.match(/^.*'/),"variable-2"):e.eat('"')?(e.match(/^.*"/),"variable-2"):e.eat("`")?(e.match(/^.*`/),"variable-2"):e.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function n(e){return e.eat("N")?"atom":e.match(/^[a-zA-Z.#!?]/)?"variable-2":null}e.defineMode("sql",(function(t,r){var n=r.client||{},l=r.atoms||{false:!0,true:!0,null:!0},s=r.builtin||a(o),c=r.keywords||a(i),u=r.operatorChars||/^[*+\-%<>!=&|~^\/]/,d=r.support||{},p=r.hooks||{},f=r.dateSQL||{date:!0,time:!0,timestamp:!0},h=!1!==r.backslashStringEscapes,m=r.brackets||/^[\{}\(\)\[\]]/,g=r.punctuation||/^[;.,:]/;function v(e,t){var r,i=e.next();if(p[i]){var a=p[i](e,t);if(!1!==a)return a}if(d.hexNumber&&("0"==i&&e.match(/^[xX][0-9a-fA-F]+/)||("x"==i||"X"==i)&&e.match(/^'[0-9a-fA-F]+'/)))return"number";if(d.binaryNumber&&(("b"==i||"B"==i)&&e.match(/^'[01]+'/)||"0"==i&&e.match(/^b[01]+/)))return"number";if(i.charCodeAt(0)>47&&i.charCodeAt(0)<58)return e.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),d.decimallessFloat&&e.match(/^\.(?!\.)/),"number";if("?"==i&&(e.eatSpace()||e.eol()||e.eat(";")))return"variable-3";if("'"==i||'"'==i&&d.doubleQuote)return t.tokenize=(r=i,function(e,t){for(var n,i=!1;null!=(n=e.next());){if(n==r&&!i){t.tokenize=v;break}i=h&&!i&&"\\"==n}return"string"}),t.tokenize(e,t);if((d.nCharCast&&("n"==i||"N"==i)||d.charsetCast&&"_"==i&&e.match(/[a-z][a-z0-9]*/i))&&("'"==e.peek()||'"'==e.peek()))return"keyword";if(d.commentSlashSlash&&"/"==i&&e.eat("/"))return e.skipToEnd(),"comment";if(d.commentHash&&"#"==i||"-"==i&&e.eat("-")&&(!d.commentSpaceRequired||e.eat(" ")))return e.skipToEnd(),"comment";if("/"==i&&e.eat("*"))return t.tokenize=function e(t){return function(r,n){var i=r.match(/^.*?(\/\*|\*\/)/);return i?"/*"==i[1]?n.tokenize=e(t+1):n.tokenize=t>1?e(t-1):v:r.skipToEnd(),"comment"}}(1),t.tokenize(e,t);if("."!=i){if(u.test(i))return e.eatWhile(u),"operator";if(m.test(i))return"bracket";if(g.test(i))return e.eatWhile(g),"punctuation";if("{"==i&&(e.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||e.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";e.eatWhile(/^[_\w\d]/);var o=e.current().toLowerCase();return f.hasOwnProperty(o)&&(e.match(/^( )+'[^']*'/)||e.match(/^( )+"[^"]*"/))?"number":l.hasOwnProperty(o)?"atom":s.hasOwnProperty(o)?"builtin":c.hasOwnProperty(o)?"keyword":n.hasOwnProperty(o)?"string-2":null}return d.zerolessFloat&&e.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":e.match(/^\.+/)?null:d.ODBCdotTable&&e.match(/^[\w\d_]+/)?"variable-2":void 0}function b(e,t,r){t.context={prev:t.context,indent:e.indentation(),col:e.column(),type:r}}return{startState:function(){return{tokenize:v,context:null}},token:function(e,t){if(e.sol()&&t.context&&null==t.context.align&&(t.context.align=!1),t.tokenize==v&&e.eatSpace())return null;var r=t.tokenize(e,t);if("comment"==r)return r;t.context&&null==t.context.align&&(t.context.align=!0);var n=e.current();return"("==n?b(e,t,")"):"["==n?b(e,t,"]"):t.context&&t.context.type==n&&function(e){e.indent=e.context.indent,e.context=e.context.prev}(t),r},indent:function(r,n){var i=r.context;if(!i)return e.Pass;var a=n.charAt(0)==i.type;return i.align?i.col+(a?0:1):i.indent+(a?0:t.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:d.commentSlashSlash?"//":d.commentHash?"#":"--",closeBrackets:"()[]{}''\"\"``"}}));var i="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";function a(e){for(var t={},r=e.split(" "),n=0;n<r.length;++n)t[r[n]]=!0;return t}var o="bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric";e.defineMIME("text/x-sql",{name:"sql",keywords:a(i+"begin"),builtin:a(o),atoms:a("false true null unknown"),dateSQL:a("date time timestamp"),support:a("ODBCdotTable doubleQuote binaryNumber hexNumber")}),e.defineMIME("text/x-mssql",{name:"sql",client:a("$partition binary_checksum checksum connectionproperty context_info current_request_id error_line error_message error_number error_procedure error_severity error_state formatmessage get_filestream_transaction_context getansinull host_id host_name isnull isnumeric min_active_rowversion newid newsequentialid rowcount_big xact_state object_id"),keywords:a(i+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec go if use index holdlock nolock nowait paglock readcommitted readcommittedlock readpast readuncommitted repeatableread rowlock serializable snapshot tablock tablockx updlock with"),builtin:a("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:a("is not null like and or in left right between inner outer join all any some cross unpivot pivot exists"),operatorChars:/^[*+\-%<>!=^\&|\/]/,brackets:/^[\{}\(\)]/,punctuation:/^[;.,:/]/,backslashStringEscapes:!1,dateSQL:a("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":r}}),e.defineMIME("text/x-mysql",{name:"sql",client:a("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:a(i+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:a("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:a("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:a("date time timestamp"),support:a("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":r,"`":t,"\\":n}}),e.defineMIME("text/x-mariadb",{name:"sql",client:a("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:a(i+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:a("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:a("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:a("date time timestamp"),support:a("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":r,"`":t,"\\":n}}),e.defineMIME("text/x-sqlite",{name:"sql",client:a("auth backup bail binary changes check clone databases dbinfo dump echo eqp exit explain fullschema headers help import imposter indexes iotrace limit lint load log mode nullvalue once open output print prompt quit read restore save scanstats schema separator session shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width"),keywords:a(i+"abort action add after all analyze attach autoincrement before begin cascade case cast check collate column commit conflict constraint cross current_date current_time current_timestamp database default deferrable deferred detach each else end escape except exclusive exists explain fail for foreign full glob if ignore immediate index indexed initially inner instead intersect isnull key left limit match natural no notnull null of offset outer plan pragma primary query raise recursive references regexp reindex release rename replace restrict right rollback row savepoint temp temporary then to transaction trigger unique using vacuum view virtual when with without"),builtin:a("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text clob bigint int int2 int8 integer float double char varchar date datetime year unsigned signed numeric real"),atoms:a("null current_date current_time current_timestamp"),operatorChars:/^[*+\-%<>!=&|/~]/,dateSQL:a("date time timestamp datetime"),support:a("decimallessFloat zerolessFloat"),identifierQuote:'"',hooks:{"@":r,":":r,"?":r,$:r,'"':function(e){for(var t;null!=(t=e.next());)if('"'==t&&!e.eat('"'))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null},"`":t}}),e.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:a("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:a("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:a("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:a("commentSlashSlash decimallessFloat"),hooks:{}}),e.defineMIME("text/x-plsql",{name:"sql",client:a("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:a("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:a("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*\/+\-%<>!=~]/,dateSQL:a("date time timestamp"),support:a("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),e.defineMIME("text/x-hive",{name:"sql",keywords:a("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with admin authorization char compact compactions conf cube current current_date current_timestamp day decimal defined dependency directories elem_type exchange file following for grouping hour ignore inner interval jar less logical macro minute month more none noscan over owner partialscan preceding pretty principals protection reload rewrite role roles rollup rows second server sets skewed transactions truncate unbounded unset uri user values window year"),builtin:a("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype key_type utctimestamp value_type varchar"),atoms:a("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:a("date timestamp"),support:a("ODBCdotTable doubleQuote binaryNumber hexNumber")}),e.defineMIME("text/x-pgsql",{name:"sql",client:a("source"),keywords:a(i+"a abort abs absent absolute access according action ada add admin after aggregate alias all allocate also alter always analyse analyze and any are array array_agg array_max_cardinality as asc asensitive assert assertion assignment asymmetric at atomic attach attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli between bigint binary bit bit_length blob blocked bom boolean both breadth by c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain char char_length character character_length character_set_catalog character_set_name character_set_schema characteristics characters check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column column_name columns command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constant constraint constraint_catalog constraint_name constraint_schema constraints constructor contains content continue control conversion convert copy corr corresponding cost count covar_pop covar_samp create cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datatype date datetime_interval_code datetime_interval_precision day db deallocate debug dec decimal declare default defaults deferrable deferred defined definer degree delete delimiter delimiters dense_rank depends depth deref derived desc describe descriptor detach detail deterministic diagnostics dictionary disable discard disconnect dispatch distinct dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain double drop dump dynamic dynamic_function dynamic_function_code each element else elseif elsif empty enable encoding encrypted end end_frame end_partition endexec enforced enum equals errcode error escape event every except exception exclude excluding exclusive exec execute exists exit exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreach foreign fortran forward found frame_row free freeze from fs full function functions fusion g general generated get global go goto grant granted greatest group grouping groups handler having header hex hierarchy hint hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import in include including increment indent index indexes indicator info inherit inherits initially inline inner inout input insensitive insert instance instantiable instead int integer integrity intersect intersection interval into invoker is isnull isolation join k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like like_regex limit link listen ln load local localtime localtimestamp location locator lock locked log logged loop lower m map mapping match matched materialized max max_cardinality maxvalue member merge message message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized not nothing notice notify notnull nowait nth_value ntile null nullable nullif nulls number numeric object occurrences_regex octet_length octets of off offset oids old on only open operator option options or order ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parallel parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password path percent percent_rank percentile_cont percentile_disc perform period permission pg_context pg_datatype_name pg_exception_context pg_exception_detail pg_exception_hint placing plans pli policy portion position position_regex power precedes preceding precision prepare prepared preserve primary print_strict_params prior privileges procedural procedure procedures program public publication query quote raise range rank read reads real reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict result result_oid return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns reverse revoke right role rollback rollup routine routine_catalog routine_name routine_schema routines row row_count row_number rows rowtype rule savepoint scale schema schema_name schemas scope scope_catalog scope_name scope_schema scroll search second section security select selective self sensitive sequence sequences serializable server server_name session session_user set setof sets share show similar simple size skip slice smallint snapshot some source space specific specific_name specifictype sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable stacked standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset subscription substring substring_regex succeeds sum symmetric sysid system system_time system_user t table table_name tables tablesample tablespace temp template temporary text then ties time timestamp timezone_hour timezone_minute to token top_level_count trailing transaction transaction_active transactions_committed transactions_rolled_back transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted union unique unknown unlink unlisten unlogged unnamed unnest until untyped update upper uri usage use_column use_variable user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of values var_pop var_samp varbinary varchar variable_conflict variadic varying verbose version versioning view views volatile warning when whenever where while whitespace width_bucket window with within without work wrapper write xml xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes zone"),builtin:a("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:a("false true null unknown"),operatorChars:/^[*\/+\-%<>!=&|^\/#@?~]/,dateSQL:a("date time timestamp"),support:a("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),e.defineMIME("text/x-gql",{name:"sql",keywords:a("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:a("false true"),builtin:a("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/}),e.defineMIME("text/x-gpsql",{name:"sql",client:a("source"),keywords:a("abort absolute access action active add admin after aggregate all also alter always analyse analyze and any array as asc assertion assignment asymmetric at authorization backward before begin between bigint binary bit boolean both by cache called cascade cascaded case cast chain char character characteristics check checkpoint class close cluster coalesce codegen collate column comment commit committed concurrency concurrently configuration connection constraint constraints contains content continue conversion copy cost cpu_rate_limit create createdb createexttable createrole createuser cross csv cube current current_catalog current_date current_role current_schema current_time current_timestamp current_user cursor cycle data database day deallocate dec decimal declare decode default defaults deferrable deferred definer delete delimiter delimiters deny desc dictionary disable discard distinct distributed do document domain double drop dxl each else enable encoding encrypted end enum errors escape every except exchange exclude excluding exclusive execute exists explain extension external extract false family fetch fields filespace fill filter first float following for force foreign format forward freeze from full function global grant granted greatest group group_id grouping handler hash having header hold host hour identity if ignore ilike immediate immutable implicit in including inclusive increment index indexes inherit inherits initially inline inner inout input insensitive insert instead int integer intersect interval into invoker is isnull isolation join key language large last leading least left level like limit list listen load local localtime localtimestamp location lock log login mapping master match maxvalue median merge minute minvalue missing mode modifies modify month move name names national natural nchar new newline next no nocreatedb nocreateexttable nocreaterole nocreateuser noinherit nologin none noovercommit nosuperuser not nothing notify notnull nowait null nullif nulls numeric object of off offset oids old on only operator option options or order ordered others out outer over overcommit overlaps overlay owned owner parser partial partition partitions passing password percent percentile_cont percentile_disc placing plans position preceding precision prepare prepared preserve primary prior privileges procedural procedure protocol queue quote randomly range read readable reads real reassign recheck recursive ref references reindex reject relative release rename repeatable replace replica reset resource restart restrict returning returns revoke right role rollback rollup rootpartition row rows rule savepoint scatter schema scroll search second security segment select sequence serializable session session_user set setof sets share show similar simple smallint some split sql stable standalone start statement statistics stdin stdout storage strict strip subpartition subpartitions substring superuser symmetric sysid system table tablespace temp template temporary text then threshold ties time timestamp to trailing transaction treat trigger trim true truncate trusted type unbounded uncommitted unencrypted union unique unknown unlisten until update user using vacuum valid validation validator value values varchar variadic varying verbose version view volatile web when where whitespace window with within without work writable write xml xmlattributes xmlconcat xmlelement xmlexists xmlforest xmlparse xmlpi xmlroot xmlserialize year yes zone"),builtin:a("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:a("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:a("date time timestamp"),support:a("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),e.defineMIME("text/x-sparksql",{name:"sql",keywords:a("add after all alter analyze and anti archive array as asc at between bucket buckets by cache cascade case cast change clear cluster clustered codegen collection column columns comment commit compact compactions compute concatenate cost create cross cube current current_date current_timestamp database databases datata dbproperties defined delete delimited deny desc describe dfs directories distinct distribute drop else end escaped except exchange exists explain export extended external false fields fileformat first following for format formatted from full function functions global grant group grouping having if ignore import in index indexes inner inpath inputformat insert intersect interval into is items join keys last lateral lazy left like limit lines list load local location lock locks logical macro map minus msck natural no not null nulls of on optimize option options or order out outer outputformat over overwrite partition partitioned partitions percent preceding principals purge range recordreader recordwriter recover reduce refresh regexp rename repair replace reset restrict revoke right rlike role roles rollback rollup row rows schema schemas select semi separated serde serdeproperties set sets show skewed sort sorted start statistics stored stratify struct table tables tablesample tblproperties temp temporary terminated then to touch transaction transactions transform true truncate unarchive unbounded uncache union unlock unset use using values view when where window with"),builtin:a("tinyint smallint int bigint boolean float double string binary timestamp decimal array map struct uniontype delimited serde sequencefile textfile rcfile inputformat outputformat"),atoms:a("false true null"),operatorChars:/^[*\/+\-%<>!=~&|^]/,dateSQL:a("date time timestamp"),support:a("ODBCdotTable doubleQuote zerolessFloat")}),e.defineMIME("text/x-esper",{name:"sql",client:a("source"),keywords:a("alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit after all and as at asc avedev avg between by case cast coalesce count create current_timestamp day days delete define desc distinct else end escape events every exists false first from full group having hour hours in inner insert instanceof into irstream is istream join last lastweekday left limit like max match_recognize matches median measures metadatasql min minute minutes msec millisecond milliseconds not null offset on or order outer output partition pattern prev prior regexp retain-union retain-intersection right rstream sec second seconds select set some snapshot sql stddev sum then true unidirectional until update variable weekday when where window"),builtin:{},atoms:a("false true null"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:a("time"),support:a("decimallessFloat zerolessFloat binaryNumber hexNumber")})},"object"==l(t)&&"object"==l(e)?o(r(6)):(i=[r(6)],void 0===(a="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=a))}).call(this,r(19)(e))},43:function(e,t){if(window.TableJoinerMacroTemplate=window.TableJoinerMacroTemplate||{},void 0===r)var r={};r.dialog=function(e,t){return'<section id="table-joiner-dialog" class="aui-dialog2 aui-dialog2-xlarge tfac" role="dialog" data-aui-modal="true" data-aui-remove-on-hide="true"'+(e.params.isCloud?"":' style="width: 1000px; height: 534px"')+'><base target="_blank"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">'+(e.isInsert?soy.$$escapeHtml(AJS.format("Insert \u2018{0}\u2019 Macro","Table Transformer")):soy.$$escapeHtml(AJS.format("Edit \u2018{0}\u2019 Macro","Table Transformer")))+'</h2></header><div class="aui-dialog2-content" style="height: 420px">'+r.dialogBody(e)+'</div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary tj-next">'+soy.$$escapeHtml("Next \u003e\u003e")+'</button><button class="aui-button tj-insert">'+(e.isInsert?soy.$$escapeHtml("Insert"):soy.$$escapeHtml("Save"))+'</button><button class="aui-button aui-button-link tj-cancel">'+soy.$$escapeHtml("Cancel")+'</button></div><div class="aui-dialog2-footer-hint"><a href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+Transformer+macro" target="_blank">'+soy.$$escapeHtml("Documentation")+"</a>.&nbsp;<span>"+soy.$$filterNoAutoescape("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Table%2BFilter%2Band%2BCharts%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e.  ")+"</span></div></footer></section>"},goog.DEBUG&&(r.dialog.soyTemplateName="TableJoinerMacroTemplate.dialog"),r.dialogBody=function(e,t){for(var n='<form id="table-joiner-macro" class="aui"><div id="tj-main-tabs" class="aui-tabs vertical-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#tj-wizard">'+soy.$$escapeHtml("Presets")+'</a></li><li class="menu-item"><a href="#tj-sql">'+soy.$$escapeHtml("SQL query")+'</a></li><li class="menu-item"><a href="#tj-options">'+soy.$$escapeHtml("Settings")+'</a></li><li class="menu-item"><a href="#tj-view">'+soy.$$escapeHtml("Options")+'</a></li></ul><div class="tabs-pane active-pane" id="tj-wizard"><p class="desc">'+soy.$$escapeHtml("Please, select one of the presets for merging the tables or lookup and click Next for automatic transformation. Or select Custom transformation for using advanced SQL queries.")+'</p><div id="tj-presets">'+r.preset({colsBefore1:3,rowsBefore1:1,colsBefore2:3,rowsBefore2:1,colsAfter:3,rowsAfter:2,id:"tj-union",orientation:"vertical",title:"Merge tables"})+r.preset({colsBefore1:2,rowsBefore1:3,colsBefore2:2,rowsBefore2:3,colsAfter:3,rowsAfter:3,id:"tj-join",orientation:"horizontal",title:"Lookup tables"})+'<div id="tj-custom" class="tj-preset"><div class="preset-wrapper"><h4>'+soy.$$escapeHtml("Custom transformation")+'</h4></div></div></div><div id="join-column-field-group" class="join-column-field-group field-group'+(0==e.joinColumns.length?" hidden":"")+'"><label for="join-column">'+soy.$$escapeHtml("Match records by")+'</label><select id="join-column-param" class="select" data-param="join-column">',i=e.joinColumns,a=i.length,o=0;o<a;o++){var l=i[o];n+='<option value="'+soy.$$escapeHtml(l)+'" '+(e.params["join-column"]==l?" selected ":"")+">"+soy.$$escapeHtml(l)+"</option>"}return n+='</select><div class="arrow"></div></div><div id="join-column-field-message" class="join-column-field-group aui-message info aui-message-info'+(0==!e.joinColumns.length?" hidden":"")+'"><p>'+soy.$$escapeHtml("Unable to determine column to match records. Please, click \u0022Next\u0022 button and set the SQL.")+'</p><div class="arrow"></div></div></div><div class="tabs-pane" id="tj-sql"><p class="desc">'+soy.$$escapeHtml("The SQL is used to transform source tables. It is either generated by macro when you choose a preset in the macro Wizard, or you can write your own complex query. Tables are named as \u0022T1\u0022, \u0022T2\u0022, \u0022T3\u0022 and so on. Table name variable \u0022T*\u0022 can be used in \u0022UNION\u0022 and \u0022JOIN\u0022 operations when you have a large or uncertain number of tables. Use single quotes to reference table columns.")+'</p><textarea id="sql-param" class="textarea" data-param="sql">'+soy.$$escapeHtml(e.params.sql)+'</textarea><div id="sql-error"></div></div><div class="tabs-pane" id="tj-options"><p class="desc">'+soy.$$escapeHtml("The following settings are used to process non-text values, such as numbers, dates, time duration and so on.")+'</p><div class="field-group"><label for="macro-param-datepattern">'+soy.$$escapeHtml("Date format")+'</label><input id="macro-param-datepattern" class="text" type="text" data-param="dateFormat" '+(e.params.datepattern?' value="'+soy.$$escapeHtml(e.params.datepattern)+'"':"")+'></div><div class="field-group"><label for="separator-param">'+soy.$$escapeHtml("Decimal separator")+'</label><select id="separator-param" class="select" data-param="separator"><option value="." '+("."==e.params.separator?" selected ":"")+">"+soy.$$escapeHtml("Point (.)")+'</option><option value="," '+(","==e.params.separator?" selected ":"")+">"+soy.$$escapeHtml("Comma (,)")+'</option></select></div><div class="field-group"><label for="thousand-separator-param">'+soy.$$escapeHtml("Thousands separator")+'</label><select id="thousand-separator-param" class="select" data-param="thousand-separator"><option value="" '+(e.params["thousand-separator"]?"":" selected ")+'></option><option value="\\u0020" '+(" "==e.params["thousand-separator"]?" selected ":"")+">"+soy.$$escapeHtml("Space ( )")+'</option><option value="," '+(","==e.params["thousand-separator"]?" selected ":"")+">"+soy.$$escapeHtml("Comma (,)")+'</option><option value="." '+("."==e.params["thousand-separator"]?" selected ":"")+">"+soy.$$escapeHtml("Point (.)")+'</option></select></div><div class="field-group"><label for="decimals-param">'+soy.$$escapeHtml("Decimal places")+'</label><input id="decimals-param" class="text" type="text" data-param="decimals" '+(e.params.decimals?'value="'+soy.$$escapeHtml(e.params.decimals)+'"':"")+'></div><div class="field-group" id="macro-param-div-worklog"><label for="worklog-param">'+soy.$$escapeHtml("Set worklog settings")+'</label><input id="macro-param-worklog" class="text" type="text" data-param="worklog" '+(e.params.worklog?' value="'+soy.$$escapeHtml(e.params.worklog)+'"':"")+'></div><div class="field-group" id="macro-param-div-transpose"><label for="macro-param-transpose">'+soy.$$escapeHtml("Transpose tables")+'</label><input id="macro-param-transpose" class="checkbox" type="checkbox" data-param="transpose" '+("true"==e.params.transpose?' checked="checked"':"")+'></div><input id="macro-param-id" class="text tf-always-hidden" type="text" data-param="id" value="'+soy.$$escapeHtml(e.params.id)+'"></div><div class="tabs-pane" id="tj-view"><p class="desc">'+soy.$$escapeHtml("Choose options you want to have.")+'</p><div class="field-group"><label for="show-source-param">'+soy.$$escapeHtml("Show source tables")+'</label><input id="show-source-param" class="checkbox" type="checkbox" data-param="show-source"'+("true"==e.params["show-source"]?'checked="checked"':"")+'></div><div class="field-group"><label for="export-csv-param">'+soy.$$escapeHtml("Export to CSV button")+'</label><input id="export-csv-param" class="checkbox" type="checkbox" data-param="export-csv"'+("true"==e.params["export-csv"]?'checked="checked"':"")+'></div><div class="field-group"><label for="export-pdf-param">'+soy.$$escapeHtml("Export to PDF button")+'</label><input id="export-pdf-param" class="checkbox" type="checkbox" data-param="export-pdf"'+("true"==e.params["export-pdf"]?'checked="checked"':"")+'></div><div class="field-group"><label for="export-word-param">'+soy.$$escapeHtml("Export to Word button")+'</label><input id="export-word-param" class="checkbox" type="checkbox" data-param="export-word"'+("true"==e.params["export-word"]?'checked="checked"':"")+'></div></div></div><div id="tj-preview"><div id="tj-preview-sidebar" title="'+soy.$$escapeHtml("Preview")+'"><div><span class="aui-icon aui-icon-small aui-iconfont-view"></span></div><div id="tj-refresh-preview" title="'+soy.$$escapeHtml("Refresh")+'"><span class="aui-icon aui-icon-small aui-iconfont-build"></span></div></div><div id="tj-preview-content"><span id="tj-preview-spinner"></span><iframe src="'+soy.$$escapeHtml(e.previewSrc)+'"></iframe></div></div></form>'},goog.DEBUG&&(r.dialogBody.soyTemplateName="TableJoinerMacroTemplate.dialogBody"),r.tableExample=function(e,t){for(var r='<div class="table-wrapper"><table class="table-example confluenceTable"><thead><tr>',n=e.cols,i=0;i<n;i++)r+='<th class="confluenceTh"></th>';r+="</tr></thead><tbody>";for(var a=e.rows,o=0;o<a;o++){r+="<tr>";for(var l=e.cols,s=0;s<l;s++)r+='<td class="confluenceTd"></td>';r+="</tr>"}return r+="</tbody></table></div>"},goog.DEBUG&&(r.tableExample.soyTemplateName="TableJoinerMacroTemplate.tableExample"),r.preset=function(e,t){return'<div id="'+soy.$$escapeHtml(e.id)+'" class="tj-preset"><div class="preset-wrapper"><h4>'+soy.$$escapeHtml(e.title)+'</h4><table class="example-container"><tr><td class="dashed '+("vertical"!=e.orientation?"left":"")+'"'+("vertical"==e.orientation?'colspan="3"':"")+">"+r.tableExample({cols:e.colsBefore1,rows:e.rowsBefore1})+("vertical"==e.orientation?'<div class="tj-example-plus">+</div>'+r.tableExample({cols:e.colsBefore2,rows:e.rowsBefore2}):"")+"</td>"+("vertical"!=e.orientation?'<td class="dashed left right">+</td><td class="dashed right">'+r.tableExample({cols:e.colsBefore2,rows:e.rowsBefore2})+"</td>":"")+'</tr><tr><td colspan="3">'+r.arrowDown(null)+'</td></tr><tr><td colspan="3" class="dashed result">'+r.tableExample({cols:e.colsAfter,rows:e.rowsAfter})+"</td></tr></table></div></div>"},goog.DEBUG&&(r.preset.soyTemplateName="TableJoinerMacroTemplate.preset"),r.arrowDown=function(e,t){return'<span class="down-arrow">&#x21e9;</span>'},goog.DEBUG&&(r.arrowDown.soyTemplateName="TableJoinerMacroTemplate.arrowDown"),e.exports=r},6:function(e,t,r){var n,i,a;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a=function(){"use strict";var e=navigator.userAgent,t=navigator.platform,r=/gecko\/\d/i.test(e),n=/MSIE \d/.test(e),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),a=/Edge\/(\d+)/.exec(e),l=n||i||a,s=l&&(n?document.documentMode||6:+(a||i)[1]),c=!a&&/WebKit\//.test(e),u=c&&/Qt\/\d+\.\d+/.test(e),d=!a&&/Chrome\//.test(e),p=/Opera\//.test(e),f=/Apple Computer/.test(navigator.vendor),h=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),m=/PhantomJS/.test(e),g=!a&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),v=/Android/.test(e),b=g||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),y=g||/Mac/.test(t),x=/\bCrOS\b/.test(e),w=/win/i.test(t),S=p&&e.match(/Version\/(\d*\.\d*)/);S&&(S=Number(S[1])),S&&S>=15&&(p=!1,c=!0);var C=y&&(u||p&&(null==S||S<12.11)),T=r||l&&s>=9;function k(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var A,$=function(e,t){var r=e.className,n=k(t).exec(r);if(n){var i=r.slice(n.index+n[0].length);e.className=r.slice(0,n.index)+(i?n[1]+i:"")}};function L(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function _(e,t){return L(e).appendChild(t)}function I(e,t,r,n){var i=document.createElement(e);if(r&&(i.className=r),n&&(i.style.cssText=n),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var a=0;a<t.length;++a)i.appendChild(t[a]);return i}function M(e,t,r,n){var i=I(e,t,r,n);return i.setAttribute("role","presentation"),i}function P(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function O(){var e;try{e=document.activeElement}catch(t){e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function N(e,t){var r=e.className;k(t).test(r)||(e.className+=(r?" ":"")+t)}function D(e,t){for(var r=e.split(" "),n=0;n<r.length;n++)r[n]&&!k(r[n]).test(t)&&(t+=" "+r[n]);return t}A=document.createRange?function(e,t,r,n){var i=document.createRange();return i.setEnd(n||e,r),i.setStart(e,t),i}:function(e,t,r){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}return n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n};var F=function(e){e.select()};function E(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function H(e,t,r){for(var n in t||(t={}),e)!e.hasOwnProperty(n)||!1===r&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function B(e,t,r,n,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var a=n||0,o=i||0;;){var l=e.indexOf("\t",a);if(l<0||l>=t)return o+(t-a);o+=l-a,o+=r-o%r,a=l+1}}g?F=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:l&&(F=function(e){try{e.select()}catch(e){}});var W=function(){this.id=null};function J(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return r;return-1}W.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var j=30,z={toString:function(){return"CodeMirror.Pass"}},R={scroll:!1},q={origin:"*mouse"},U={origin:"+move"};function V(e,t,r){for(var n=0,i=0;;){var a=e.indexOf("\t",n);-1==a&&(a=e.length);var o=a-n;if(a==e.length||i+o>=t)return n+Math.min(o,t-i);if(i+=a-n,n=a+1,(i+=r-i%r)>=t)return n}}var K=[""];function G(e){for(;K.length<=e;)K.push(Q(K)+" ");return K[e]}function Q(e){return e[e.length-1]}function X(e,t){for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function Y(){}function Z(e,t){var r;return Object.create?r=Object.create(e):(Y.prototype=e,r=new Y),t&&H(t,r),r}var ee=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function te(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||ee.test(e))}function re(e,t){return t?!!(t.source.indexOf("\\w")>-1&&te(e))||t.test(e):te(e)}function ne(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var ie=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ae(e){return e.charCodeAt(0)>=768&&ie.test(e)}function oe(e,t,r){for(;(r<0?t>0:t<e.length)&&ae(e.charAt(t));)t+=r;return t}function le(e,t,r){for(var n=t>r?-1:1;;){if(t==r)return t;var i=(t+r)/2,a=n<0?Math.ceil(i):Math.floor(i);if(a==t)return e(a)?t:r;e(a)?r=a:t=a+n}}var se=null;function ce(e,t,r){var n;se=null;for(var i=0;i<e.length;++i){var a=e[i];if(a.from<t&&a.to>t)return i;a.to==t&&(a.from!=a.to&&"before"==r?n=i:se=i),a.from==t&&(a.from!=a.to&&"before"!=r?n=i:se=i)}return null!=n?n:se}var ue=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,n=/[stwN]/,i=/[LRr]/,a=/[Lb1n]/,o=/[1n]/;function l(e,t,r){this.level=e,this.from=t,this.to=r}return function(s,c){var u="ltr"==c?"L":"R";if(0==s.length||"ltr"==c&&!r.test(s))return!1;for(var d,p=s.length,f=[],h=0;h<p;++h)f.push((d=s.charCodeAt(h))<=247?e.charAt(d):1424<=d&&d<=1524?"R":1536<=d&&d<=1785?t.charAt(d-1536):1774<=d&&d<=2220?"r":8192<=d&&d<=8203?"w":8204==d?"b":"L");for(var m=0,g=u;m<p;++m){var v=f[m];"m"==v?f[m]=g:g=v}for(var b=0,y=u;b<p;++b){var x=f[b];"1"==x&&"r"==y?f[b]="n":i.test(x)&&(y=x,"r"==x&&(f[b]="R"))}for(var w=1,S=f[0];w<p-1;++w){var C=f[w];"+"==C&&"1"==S&&"1"==f[w+1]?f[w]="1":","!=C||S!=f[w+1]||"1"!=S&&"n"!=S||(f[w]=S),S=C}for(var T=0;T<p;++T){var k=f[T];if(","==k)f[T]="N";else if("%"==k){var A=void 0;for(A=T+1;A<p&&"%"==f[A];++A);for(var $=T&&"!"==f[T-1]||A<p&&"1"==f[A]?"1":"N",L=T;L<A;++L)f[L]=$;T=A-1}}for(var _=0,I=u;_<p;++_){var M=f[_];"L"==I&&"1"==M?f[_]="L":i.test(M)&&(I=M)}for(var P=0;P<p;++P)if(n.test(f[P])){var O=void 0;for(O=P+1;O<p&&n.test(f[O]);++O);for(var N="L"==(P?f[P-1]:u),D=N==("L"==(O<p?f[O]:u))?N?"L":"R":u,F=P;F<O;++F)f[F]=D;P=O-1}for(var E,H=[],B=0;B<p;)if(a.test(f[B])){var W=B;for(++B;B<p&&a.test(f[B]);++B);H.push(new l(0,W,B))}else{var J=B,j=H.length;for(++B;B<p&&"L"!=f[B];++B);for(var z=J;z<B;)if(o.test(f[z])){J<z&&H.splice(j,0,new l(1,J,z));var R=z;for(++z;z<B&&o.test(f[z]);++z);H.splice(j,0,new l(2,R,z)),J=z}else++z;J<B&&H.splice(j,0,new l(1,J,B))}return"ltr"==c&&(1==H[0].level&&(E=s.match(/^\s+/))&&(H[0].from=E[0].length,H.unshift(new l(0,0,E[0].length))),1==Q(H).level&&(E=s.match(/\s+$/))&&(Q(H).to-=E[0].length,H.push(new l(0,p-E[0].length,p)))),"rtl"==c?H.reverse():H}}();function de(e,t){var r=e.order;return null==r&&(r=e.order=ue(e.text,t)),r}var pe=[],fe=function(e,t,r){if(e.addEventListener)e.addEventListener(t,r,!1);else if(e.attachEvent)e.attachEvent("on"+t,r);else{var n=e._handlers||(e._handlers={});n[t]=(n[t]||pe).concat(r)}};function he(e,t){return e._handlers&&e._handlers[t]||pe}function me(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r,!1);else if(e.detachEvent)e.detachEvent("on"+t,r);else{var n=e._handlers,i=n&&n[t];if(i){var a=J(i,r);a>-1&&(n[t]=i.slice(0,a).concat(i.slice(a+1)))}}}function ge(e,t){var r=he(e,t);if(r.length)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,n)}function ve(e,t,r){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),ge(e,r||t.type,e,t),Ce(t)||t.codemirrorIgnore}function be(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var r=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==J(r,t[n])&&r.push(t[n])}function ye(e,t){return he(e,t).length>0}function xe(e){e.prototype.on=function(e,t){fe(this,e,t)},e.prototype.off=function(e,t){me(this,e,t)}}function we(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Se(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Ce(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Te(e){we(e),Se(e)}function ke(e){return e.target||e.srcElement}function Ae(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),y&&e.ctrlKey&&1==t&&(t=3),t}var $e,Le,_e=function(){if(l&&s<9)return!1;var e=I("div");return"draggable"in e||"dragDrop"in e}();function Ie(e){if(null==$e){var t=I("span","");_(e,I("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&($e=t.offsetWidth<=1&&t.offsetHeight>2&&!(l&&s<8))}var r=$e?I("span",""):I("span","",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function Me(e){if(null!=Le)return Le;var t=_(e,document.createTextNode("AA")),r=A(t,0,1).getBoundingClientRect(),n=A(t,1,2).getBoundingClientRect();return L(e),!(!r||r.left==r.right)&&(Le=n.right-r.right<3)}var Pe,Oe=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,r=[],n=e.length;t<=n;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var a=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=a.indexOf("\r");-1!=o?(r.push(a.slice(0,o)),t+=o+1):(r.push(a),t=i+1)}return r}:function(e){return e.split(/\r\n?|\n/)},Ne=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},De="oncopy"in(Pe=I("div"))||(Pe.setAttribute("oncopy","return;"),"function"==typeof Pe.oncopy),Fe=null,Ee={},He={};function Be(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Ee[e]=t}function We(e){if("string"==typeof e&&He.hasOwnProperty(e))e=He[e];else if(e&&"string"==typeof e.name&&He.hasOwnProperty(e.name)){var t=He[e.name];"string"==typeof t&&(t={name:t}),(e=Z(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return We("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return We("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Je(e,t){t=We(t);var r=Ee[t.name];if(!r)return Je(e,"text/plain");var n=r(e,t);if(je.hasOwnProperty(t.name)){var i=je[t.name];for(var a in i)i.hasOwnProperty(a)&&(n.hasOwnProperty(a)&&(n["_"+a]=n[a]),n[a]=i[a])}if(n.name=t.name,t.helperType&&(n.helperType=t.helperType),t.modeProps)for(var o in t.modeProps)n[o]=t.modeProps[o];return n}var je={};function ze(e,t){H(t,je.hasOwnProperty(e)?je[e]:je[e]={})}function Re(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var r={};for(var n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function qe(e,t){for(var r;e.innerMode&&(r=e.innerMode(t))&&r.mode!=e;)t=r.state,e=r.mode;return r||{mode:e,state:t}}function Ue(e,t,r){return!e.startState||e.startState(t,r)}var Ve=function(e,t,r){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};function Ke(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var r=e;!r.lines;)for(var n=0;;++n){var i=r.children[n],a=i.chunkSize();if(t<a){r=i;break}t-=a}return r.lines[t]}function Ge(e,t,r){var n=[],i=t.line;return e.iter(t.line,r.line+1,(function(e){var a=e.text;i==r.line&&(a=a.slice(0,r.ch)),i==t.line&&(a=a.slice(t.ch)),n.push(a),++i})),n}function Qe(e,t,r){var n=[];return e.iter(t,r,(function(e){n.push(e.text)})),n}function Xe(e,t){var r=t-e.height;if(r)for(var n=e;n;n=n.parent)n.height+=r}function Ye(e){if(null==e.parent)return null;for(var t=e.parent,r=J(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var i=0;n.children[i]!=t;++i)r+=n.children[i].chunkSize();return r+t.first}function Ze(e,t){var r=e.first;e:do{for(var n=0;n<e.children.length;++n){var i=e.children[n],a=i.height;if(t<a){e=i;continue e}t-=a,r+=i.chunkSize()}return r}while(!e.lines);for(var o=0;o<e.lines.length;++o){var l=e.lines[o].height;if(t<l)break;t-=l}return r+o}function et(e,t){return t>=e.first&&t<e.first+e.size}function tt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function rt(e,t,r){if(void 0===r&&(r=null),!(this instanceof rt))return new rt(e,t,r);this.line=e,this.ch=t,this.sticky=r}function nt(e,t){return e.line-t.line||e.ch-t.ch}function it(e,t){return e.sticky==t.sticky&&0==nt(e,t)}function at(e){return rt(e.line,e.ch)}function ot(e,t){return nt(e,t)<0?t:e}function lt(e,t){return nt(e,t)<0?e:t}function st(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function ct(e,t){if(t.line<e.first)return rt(e.first,0);var r=e.first+e.size-1;return t.line>r?rt(r,Ke(e,r).text.length):function(e,t){var r=e.ch;return null==r||r>t?rt(e.line,t):r<0?rt(e.line,0):e}(t,Ke(e,t.line).text.length)}function ut(e,t){for(var r=[],n=0;n<t.length;n++)r[n]=ct(e,t[n]);return r}Ve.prototype.eol=function(){return this.pos>=this.string.length},Ve.prototype.sol=function(){return this.pos==this.lineStart},Ve.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Ve.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Ve.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},Ve.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},Ve.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Ve.prototype.skipToEnd=function(){this.pos=this.string.length},Ve.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},Ve.prototype.backUp=function(e){this.pos-=e},Ve.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Ve.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Ve.prototype.match=function(e,t,r){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}var i=function(e){return r?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},Ve.prototype.current=function(){return this.string.slice(this.start,this.pos)},Ve.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},Ve.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},Ve.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var dt=function(e,t){this.state=e,this.lookAhead=t},pt=function(e,t,r,n){this.state=t,this.doc=e,this.line=r,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1};function ft(e,t,r,n){var i=[e.state.modeGen],a={};St(e,t.text,e.doc.mode,r,(function(e,t){return i.push(e,t)}),a,n);for(var o=r.state,l=function(n){r.baseTokens=i;var l=e.state.overlays[n],s=1,c=0;r.state=!0,St(e,t.text,l.mode,r,(function(e,t){for(var r=s;c<e;){var n=i[s];n>e&&i.splice(s,1,e,i[s+1],n),s+=2,c=Math.min(e,n)}if(t)if(l.opaque)i.splice(r,s-r,e,"overlay "+t),s=r+2;else for(;r<s;r+=2){var a=i[r+1];i[r+1]=(a?a+" ":"")+"overlay "+t}}),a),r.state=o,r.baseTokens=null,r.baseTokenPos=1},s=0;s<e.state.overlays.length;++s)l(s);return{styles:i,classes:a.bgClass||a.textClass?a:null}}function ht(e,t,r){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=mt(e,Ye(t)),i=t.text.length>e.options.maxHighlightLength&&Re(e.doc.mode,n.state),a=ft(e,t,n);i&&(n.state=i),t.stateAfter=n.save(!i),t.styles=a.styles,a.classes?t.styleClasses=a.classes:t.styleClasses&&(t.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function mt(e,t,r){var n=e.doc,i=e.display;if(!n.mode.startState)return new pt(n,!0,t);var a=function(e,t,r){for(var n,i,a=e.doc,o=r?-1:t-(e.doc.mode.innerMode?1e3:100),l=t;l>o;--l){if(l<=a.first)return a.first;var s=Ke(a,l-1),c=s.stateAfter;if(c&&(!r||l+(c instanceof dt?c.lookAhead:0)<=a.modeFrontier))return l;var u=B(s.text,null,e.options.tabSize);(null==i||n>u)&&(i=l-1,n=u)}return i}(e,t,r),o=a>n.first&&Ke(n,a-1).stateAfter,l=o?pt.fromSaved(n,o,a):new pt(n,Ue(n.mode),a);return n.iter(a,t,(function(r){gt(e,r.text,l);var n=l.line;r.stateAfter=n==t-1||n%5==0||n>=i.viewFrom&&n<i.viewTo?l.save():null,l.nextLine()})),r&&(n.modeFrontier=l.line),l}function gt(e,t,r,n){var i=e.doc.mode,a=new Ve(t,e.options.tabSize,r);for(a.start=a.pos=n||0,""==t&&vt(i,r.state);!a.eol();)bt(i,a,r.state),a.start=a.pos}function vt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var r=qe(e,t);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function bt(e,t,r,n){for(var i=0;i<10;i++){n&&(n[0]=qe(e,r).mode);var a=e.token(t,r);if(t.pos>t.start)return a}throw new Error("Mode "+e.name+" failed to advance stream.")}pt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},pt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},pt.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},pt.fromSaved=function(e,t,r){return t instanceof dt?new pt(e,Re(e.mode,t.state),r,t.lookAhead):new pt(e,Re(e.mode,t),r)},pt.prototype.save=function(e){var t=!1!==e?Re(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new dt(t,this.maxLookAhead):t};var yt=function(e,t,r){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=r};function xt(e,t,r,n){var i,a,o=e.doc,l=o.mode,s=Ke(o,(t=ct(o,t)).line),c=mt(e,t.line,r),u=new Ve(s.text,e.options.tabSize,c);for(n&&(a=[]);(n||u.pos<t.ch)&&!u.eol();)u.start=u.pos,i=bt(l,u,c.state),n&&a.push(new yt(u,i,Re(o.mode,c.state)));return n?a:new yt(u,i,c.state)}function wt(e,t){if(e)for(;;){var r=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;e=e.slice(0,r.index)+e.slice(r.index+r[0].length);var n=r[1]?"bgClass":"textClass";null==t[n]?t[n]=r[2]:new RegExp("(?:^|s)"+r[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+r[2])}return e}function St(e,t,r,n,i,a,o){var l=r.flattenSpans;null==l&&(l=e.options.flattenSpans);var s,c=0,u=null,d=new Ve(t,e.options.tabSize,n),p=e.options.addModeClass&&[null];for(""==t&&wt(vt(r,n.state),a);!d.eol();){if(d.pos>e.options.maxHighlightLength?(l=!1,o&&gt(e,t,n,d.pos),d.pos=t.length,s=null):s=wt(bt(r,d,n.state,p),a),p){var f=p[0].name;f&&(s="m-"+(s?f+" "+s:f))}if(!l||u!=s){for(;c<d.start;)i(c=Math.min(d.start,c+5e3),u);u=s}d.start=d.pos}for(;c<d.pos;){var h=Math.min(d.pos,c+5e3);i(h,u),c=h}}var Ct=!1,Tt=!1;function kt(e,t,r){this.marker=e,this.from=t,this.to=r}function At(e,t){if(e)for(var r=0;r<e.length;++r){var n=e[r];if(n.marker==t)return n}}function $t(e,t){for(var r,n=0;n<e.length;++n)e[n]!=t&&(r||(r=[])).push(e[n]);return r}function Lt(e,t){if(t.full)return null;var r=et(e,t.from.line)&&Ke(e,t.from.line).markedSpans,n=et(e,t.to.line)&&Ke(e,t.to.line).markedSpans;if(!r&&!n)return null;var i=t.from.ch,a=t.to.ch,o=0==nt(t.from,t.to),l=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var a=e[i],o=a.marker;if(null==a.from||(o.inclusiveLeft?a.from<=t:a.from<t)||a.from==t&&"bookmark"==o.type&&(!r||!a.marker.insertLeft)){var l=null==a.to||(o.inclusiveRight?a.to>=t:a.to>t);(n||(n=[])).push(new kt(o,a.from,l?null:a.to))}}return n}(r,i,o),s=function(e,t,r){var n;if(e)for(var i=0;i<e.length;++i){var a=e[i],o=a.marker;if(null==a.to||(o.inclusiveRight?a.to>=t:a.to>t)||a.from==t&&"bookmark"==o.type&&(!r||a.marker.insertLeft)){var l=null==a.from||(o.inclusiveLeft?a.from<=t:a.from<t);(n||(n=[])).push(new kt(o,l?null:a.from-t,null==a.to?null:a.to-t))}}return n}(n,a,o),c=1==t.text.length,u=Q(t.text).length+(c?i:0);if(l)for(var d=0;d<l.length;++d){var p=l[d];if(null==p.to){var f=At(s,p.marker);f?c&&(p.to=null==f.to?null:f.to+u):p.to=i}}if(s)for(var h=0;h<s.length;++h){var m=s[h];null!=m.to&&(m.to+=u),null==m.from?At(l,m.marker)||(m.from=u,c&&(l||(l=[])).push(m)):(m.from+=u,c&&(l||(l=[])).push(m))}l&&(l=_t(l)),s&&s!=l&&(s=_t(s));var g=[l];if(!c){var v,b=t.text.length-2;if(b>0&&l)for(var y=0;y<l.length;++y)null==l[y].to&&(v||(v=[])).push(new kt(l[y].marker,null,null));for(var x=0;x<b;++x)g.push(v);g.push(s)}return g}function _t(e){for(var t=0;t<e.length;++t){var r=e[t];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function It(e){var t=e.markedSpans;if(t){for(var r=0;r<t.length;++r)t[r].marker.detachLine(e);e.markedSpans=null}}function Mt(e,t){if(t){for(var r=0;r<t.length;++r)t[r].marker.attachLine(e);e.markedSpans=t}}function Pt(e){return e.inclusiveLeft?-1:0}function Ot(e){return e.inclusiveRight?1:0}function Nt(e,t){var r=e.lines.length-t.lines.length;if(0!=r)return r;var n=e.find(),i=t.find(),a=nt(n.from,i.from)||Pt(e)-Pt(t);if(a)return-a;var o=nt(n.to,i.to)||Ot(e)-Ot(t);return o||t.id-e.id}function Dt(e,t){var r,n=Tt&&e.markedSpans;if(n)for(var i=void 0,a=0;a<n.length;++a)(i=n[a]).marker.collapsed&&null==(t?i.from:i.to)&&(!r||Nt(r,i.marker)<0)&&(r=i.marker);return r}function Ft(e){return Dt(e,!0)}function Et(e){return Dt(e,!1)}function Ht(e,t){var r,n=Tt&&e.markedSpans;if(n)for(var i=0;i<n.length;++i){var a=n[i];a.marker.collapsed&&(null==a.from||a.from<t)&&(null==a.to||a.to>t)&&(!r||Nt(r,a.marker)<0)&&(r=a.marker)}return r}function Bt(e,t,r,n,i){var a=Ke(e,t),o=Tt&&a.markedSpans;if(o)for(var l=0;l<o.length;++l){var s=o[l];if(s.marker.collapsed){var c=s.marker.find(0),u=nt(c.from,r)||Pt(s.marker)-Pt(i),d=nt(c.to,n)||Ot(s.marker)-Ot(i);if(!(u>=0&&d<=0||u<=0&&d>=0)&&(u<=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?nt(c.to,r)>=0:nt(c.to,r)>0)||u>=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?nt(c.from,n)<=0:nt(c.from,n)<0)))return!0}}}function Wt(e){for(var t;t=Ft(e);)e=t.find(-1,!0).line;return e}function Jt(e,t){var r=Ke(e,t),n=Wt(r);return r==n?t:Ye(n)}function jt(e,t){if(t>e.lastLine())return t;var r,n=Ke(e,t);if(!zt(e,n))return t;for(;r=Et(n);)n=r.find(1,!0).line;return Ye(n)+1}function zt(e,t){var r=Tt&&t.markedSpans;if(r)for(var n=void 0,i=0;i<r.length;++i)if((n=r[i]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Rt(e,t,n))return!0}}function Rt(e,t,r){if(null==r.to){var n=r.marker.find(1,!0);return Rt(e,n.line,At(n.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==t.text.length)return!0;for(var i=void 0,a=0;a<t.markedSpans.length;++a)if((i=t.markedSpans[a]).marker.collapsed&&!i.marker.widgetNode&&i.from==r.to&&(null==i.to||i.to!=r.from)&&(i.marker.inclusiveLeft||r.marker.inclusiveRight)&&Rt(e,t,i))return!0}function qt(e){for(var t=0,r=(e=Wt(e)).parent,n=0;n<r.lines.length;++n){var i=r.lines[n];if(i==e)break;t+=i.height}for(var a=r.parent;a;a=(r=a).parent)for(var o=0;o<a.children.length;++o){var l=a.children[o];if(l==r)break;t+=l.height}return t}function Ut(e){if(0==e.height)return 0;for(var t,r=e.text.length,n=e;t=Ft(n);){var i=t.find(0,!0);n=i.from.line,r+=i.from.ch-i.to.ch}for(n=e;t=Et(n);){var a=t.find(0,!0);r-=n.text.length-a.from.ch,r+=(n=a.to.line).text.length-a.to.ch}return r}function Vt(e){var t=e.display,r=e.doc;t.maxLine=Ke(r,r.first),t.maxLineLength=Ut(t.maxLine),t.maxLineChanged=!0,r.iter((function(e){var r=Ut(e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)}))}var Kt=function(e,t,r){this.text=e,Mt(this,t),this.height=r?r(this):1};function Gt(e){e.parent=null,It(e)}Kt.prototype.lineNo=function(){return Ye(this)},xe(Kt);var Qt={},Xt={};function Yt(e,t){if(!e||/^\s*$/.test(e))return null;var r=t.addModeClass?Xt:Qt;return r[e]||(r[e]=e.replace(/\S+/g,"cm-$&"))}function Zt(e,t){var r=M("span",null,null,c?"padding-right: .1px":null),n={pre:M("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var a=i?t.rest[i-1]:t.line,o=void 0;n.pos=0,n.addToken=tr,Me(e.display.measure)&&(o=de(a,e.doc.direction))&&(n.addToken=rr(n.addToken,o)),n.map=[],ir(a,n,ht(e,a,t!=e.display.externalMeasured&&Ye(a))),a.styleClasses&&(a.styleClasses.bgClass&&(n.bgClass=D(a.styleClasses.bgClass,n.bgClass||"")),a.styleClasses.textClass&&(n.textClass=D(a.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Ie(e.display.measure))),0==i?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(c){var l=n.content.lastChild;(/\bcm-tab\b/.test(l.className)||l.querySelector&&l.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return ge(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=D(n.pre.className,n.textClass||"")),n}function er(e){var t=I("span","","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function tr(e,t,r,n,i,a,o){if(t){var c,u=e.splitSpaces?function(e,t){if(e.length>1&&!/  /.test(e))return e;for(var r=t,n="",i=0;i<e.length;i++){var a=e.charAt(i);" "!=a||!r||i!=e.length-1&&32!=e.charCodeAt(i+1)||(a=""),n+=a,r=" "==a}return n}(t,e.trailingSpace):t,d=e.cm.state.specialChars,p=!1;if(d.test(t)){c=document.createDocumentFragment();for(var f=0;;){d.lastIndex=f;var h=d.exec(t),m=h?h.index-f:t.length-f;if(m){var g=document.createTextNode(u.slice(f,f+m));l&&s<9?c.appendChild(I("span",[g])):c.appendChild(g),e.map.push(e.pos,e.pos+m,g),e.col+=m,e.pos+=m}if(!h)break;f+=m+1;var v=void 0;if("\t"==h[0]){var b=e.cm.options.tabSize,y=b-e.col%b;(v=c.appendChild(I("span",G(y),"cm-tab"))).setAttribute("role","presentation"),v.setAttribute("cm-text","\t"),e.col+=y}else"\r"==h[0]||"\n"==h[0]?((v=c.appendChild(I("span","\r"==h[0]?"":"","cm-invalidchar"))).setAttribute("cm-text",h[0]),e.col+=1):((v=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),l&&s<9?c.appendChild(I("span",[v])):c.appendChild(v),e.col+=1);e.map.push(e.pos,e.pos+1,v),e.pos++}}else e.col+=t.length,c=document.createTextNode(u),e.map.push(e.pos,e.pos+t.length,c),l&&s<9&&(p=!0),e.pos+=t.length;if(e.trailingSpace=32==u.charCodeAt(t.length-1),r||n||i||p||a){var x=r||"";n&&(x+=n),i&&(x+=i);var w=I("span",[c],x,a);if(o)for(var S in o)o.hasOwnProperty(S)&&"style"!=S&&"class"!=S&&w.setAttribute(S,o[S]);return e.content.appendChild(w)}e.content.appendChild(c)}}function rr(e,t){return function(r,n,i,a,o,l,s){i=i?i+" cm-force-border":"cm-force-border";for(var c=r.pos,u=c+n.length;;){for(var d=void 0,p=0;p<t.length&&!((d=t[p]).to>c&&d.from<=c);p++);if(d.to>=u)return e(r,n,i,a,o,l,s);e(r,n.slice(0,d.to-c),i,a,null,l,s),a=null,n=n.slice(d.to-c),c=d.to}}}function nr(e,t,r,n){var i=!n&&r.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!n&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",r.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function ir(e,t,r){var n=e.markedSpans,i=e.text,a=0;if(n)for(var o,l,s,c,u,d,p,f=i.length,h=0,m=1,g="",v=0;;){if(v==h){s=c=u=l="",p=null,d=null,v=1/0;for(var b=[],y=void 0,x=0;x<n.length;++x){var w=n[x],S=w.marker;if("bookmark"==S.type&&w.from==h&&S.widgetNode)b.push(S);else if(w.from<=h&&(null==w.to||w.to>h||S.collapsed&&w.to==h&&w.from==h)){if(null!=w.to&&w.to!=h&&v>w.to&&(v=w.to,c=""),S.className&&(s+=" "+S.className),S.css&&(l=(l?l+";":"")+S.css),S.startStyle&&w.from==h&&(u+=" "+S.startStyle),S.endStyle&&w.to==v&&(y||(y=[])).push(S.endStyle,w.to),S.title&&((p||(p={})).title=S.title),S.attributes)for(var C in S.attributes)(p||(p={}))[C]=S.attributes[C];S.collapsed&&(!d||Nt(d.marker,S)<0)&&(d=w)}else w.from>h&&v>w.from&&(v=w.from)}if(y)for(var T=0;T<y.length;T+=2)y[T+1]==v&&(c+=" "+y[T]);if(!d||d.from==h)for(var k=0;k<b.length;++k)nr(t,0,b[k]);if(d&&(d.from||0)==h){if(nr(t,(null==d.to?f+1:d.to)-h,d.marker,null==d.from),null==d.to)return;d.to==h&&(d=!1)}}if(h>=f)break;for(var A=Math.min(f,v);;){if(g){var $=h+g.length;if(!d){var L=$>A?g.slice(0,A-h):g;t.addToken(t,L,o?o+s:s,u,h+L.length==v?c:"",l,p)}if($>=A){g=g.slice(A-h),h=A;break}h=$,u=""}g=i.slice(a,a=r[m++]),o=Yt(r[m++],t.cm.options)}}else for(var _=1;_<r.length;_+=2)t.addToken(t,i.slice(a,a=r[_]),Yt(r[_+1],t.cm.options))}function ar(e,t,r){this.line=t,this.rest=function(e){for(var t,r;t=Et(e);)e=t.find(1,!0).line,(r||(r=[])).push(e);return r}(t),this.size=this.rest?Ye(Q(this.rest))-r+1:1,this.node=this.text=null,this.hidden=zt(e,t)}function or(e,t,r){for(var n,i=[],a=t;a<r;a=n){var o=new ar(e.doc,Ke(e.doc,a),a);n=a+o.size,i.push(o)}return i}var lr=null,sr=null;function cr(e,t){var r=he(e,t);if(r.length){var n,i=Array.prototype.slice.call(arguments,2);lr?n=lr.delayedCallbacks:sr?n=sr:(n=sr=[],setTimeout(ur,0));for(var a=function(e){n.push((function(){return r[e].apply(null,i)}))},o=0;o<r.length;++o)a(o)}}function ur(){var e=sr;sr=null;for(var t=0;t<e.length;++t)e[t]()}function dr(e,t,r,n){for(var i=0;i<t.changes.length;i++){var a=t.changes[i];"text"==a?hr(e,t):"gutter"==a?gr(e,t,r,n):"class"==a?mr(e,t):"widget"==a&&vr(e,t,n)}t.changes=null}function pr(e){return e.node==e.text&&(e.node=I("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),l&&s<8&&(e.node.style.zIndex=2)),e.node}function fr(e,t){var r=e.display.externalMeasured;return r&&r.line==t.line?(e.display.externalMeasured=null,t.measure=r.measure,r.built):Zt(e,t)}function hr(e,t){var r=t.text.className,n=fr(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,mr(e,t)):r&&(t.text.className=r)}function mr(e,t){!function(e,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(r&&(r+=" CodeMirror-linebackground"),t.background)r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null);else if(r){var n=pr(t);t.background=n.insertBefore(I("div",null,r),n.firstChild),e.display.input.setUneditable(t.background)}}(e,t),t.line.wrapClass?pr(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function gr(e,t,r,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=pr(t);t.gutterBackground=I("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),i.insertBefore(t.gutterBackground,t.text)}var a=t.line.gutterMarkers;if(e.options.lineNumbers||a){var o=pr(t),l=t.gutter=I("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(l),o.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(I("div",tt(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),a)for(var s=0;s<e.display.gutterSpecs.length;++s){var c=e.display.gutterSpecs[s].className,u=a.hasOwnProperty(c)&&a[c];u&&l.appendChild(I("div",[u],"CodeMirror-gutter-elt","left: "+n.gutterLeft[c]+"px; width: "+n.gutterWidth[c]+"px"))}}}function vr(e,t,r){t.alignable&&(t.alignable=null);for(var n=t.node.firstChild,i=void 0;n;n=i)i=n.nextSibling,"CodeMirror-linewidget"==n.className&&t.node.removeChild(n);yr(e,t,r)}function br(e,t,r,n){var i=fr(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),mr(e,t),gr(e,t,r,n),yr(e,t,n),t.node}function yr(e,t,r){if(xr(e,t.line,t,r,!0),t.rest)for(var n=0;n<t.rest.length;n++)xr(e,t.rest[n],t,r,!1)}function xr(e,t,r,n,i){if(t.widgets)for(var a=pr(r),o=0,l=t.widgets;o<l.length;++o){var s=l[o],c=I("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),wr(s,c,r,n),e.display.input.setUneditable(c),i&&s.above?a.insertBefore(c,r.gutter||r.text):a.appendChild(c),cr(s,"redraw")}}function wr(e,t,r,n){if(e.noHScroll){(r.alignable||(r.alignable=[])).push(t);var i=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(i-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function Sr(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!P(document.body,e.node)){var r="position: relative;";e.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),_(t.display.measure,I("div",[e.node],null,r))}return e.height=e.node.parentNode.offsetHeight}function Cr(e,t){for(var r=ke(t);r!=e.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==e.sizer&&r!=e.mover)return!0}function Tr(e){return e.lineSpace.offsetTop}function kr(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ar(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=_(e.measure,I("pre","x")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function $r(e){return j-e.display.nativeBarWidth}function Lr(e){return e.display.scroller.clientWidth-$r(e)-e.display.barWidth}function _r(e){return e.display.scroller.clientHeight-$r(e)-e.display.barHeight}function Ir(e,t,r){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(var i=0;i<e.rest.length;i++)if(Ye(e.rest[i])>r)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Mr(e,t,r,n){return Nr(e,Or(e,t),r,n)}function Pr(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[pn(e,t)];var r=e.display.externalMeasured;return r&&t>=r.lineN&&t<r.lineN+r.size?r:void 0}function Or(e,t){var r=Ye(t),n=Pr(e,r);n&&!n.text?n=null:n&&n.changes&&(dr(e,n,r,ln(e)),e.curOp.forceUpdate=!0),n||(n=function(e,t){var r=Ye(t=Wt(t)),n=e.display.externalMeasured=new ar(e.doc,t,r);n.lineN=r;var i=n.built=Zt(e,n);return n.text=i.pre,_(e.display.lineMeasure,i.pre),n}(e,t));var i=Ir(n,t,r);return{line:t,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Nr(e,t,r,n,i){t.before&&(r=-1);var a,o=r+(n||"");return t.cache.hasOwnProperty(o)?a=t.cache[o]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,r){var n=e.options.lineWrapping,i=n&&Lr(e);if(!t.measure.heights||n&&t.measure.width!=i){var a=t.measure.heights=[];if(n){t.measure.width=i;for(var o=t.text.firstChild.getClientRects(),l=0;l<o.length-1;l++){var s=o[l],c=o[l+1];Math.abs(s.bottom-c.bottom)>2&&a.push((s.bottom+c.top)/2-r.top)}}a.push(r.bottom-r.top)}}(e,t.view,t.rect),t.hasHeights=!0),(a=function(e,t,r,n){var i,a=Er(t.map,r,n),o=a.node,c=a.start,u=a.end,d=a.collapse;if(3==o.nodeType){for(var p=0;p<4;p++){for(;c&&ae(t.line.text.charAt(a.coverStart+c));)--c;for(;a.coverStart+u<a.coverEnd&&ae(t.line.text.charAt(a.coverStart+u));)++u;if((i=l&&s<9&&0==c&&u==a.coverEnd-a.coverStart?o.parentNode.getBoundingClientRect():Hr(A(o,c,u).getClientRects(),n)).left||i.right||0==c)break;u=c,c-=1,d="right"}l&&s<11&&(i=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=Fe)return Fe;var t=_(e,I("span","x")),r=t.getBoundingClientRect(),n=A(t,0,1).getBoundingClientRect();return Fe=Math.abs(r.left-n.left)>1}(e))return t;var r=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*r,right:t.right*r,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,i))}else{var f;c>0&&(d=n="right"),i=e.options.lineWrapping&&(f=o.getClientRects()).length>1?f["right"==n?f.length-1:0]:o.getBoundingClientRect()}if(l&&s<9&&!c&&(!i||!i.left&&!i.right)){var h=o.parentNode.getClientRects()[0];i=h?{left:h.left,right:h.left+on(e.display),top:h.top,bottom:h.bottom}:Fr}for(var m=i.top-t.rect.top,g=i.bottom-t.rect.top,v=(m+g)/2,b=t.view.measure.heights,y=0;y<b.length-1&&!(v<b[y]);y++);var x=y?b[y-1]:0,w=b[y],S={left:("right"==d?i.right:i.left)-t.rect.left,right:("left"==d?i.left:i.right)-t.rect.left,top:x,bottom:w};return i.left||i.right||(S.bogus=!0),e.options.singleCursorHeightPerLine||(S.rtop=m,S.rbottom=g),S}(e,t,r,n)).bogus||(t.cache[o]=a)),{left:a.left,right:a.right,top:i?a.rtop:a.top,bottom:i?a.rbottom:a.bottom}}var Dr,Fr={left:0,right:0,top:0,bottom:0};function Er(e,t,r){for(var n,i,a,o,l,s,c=0;c<e.length;c+=3)if(l=e[c],s=e[c+1],t<l?(i=0,a=1,o="left"):t<s?a=1+(i=t-l):(c==e.length-3||t==s&&e[c+3]>t)&&(i=(a=s-l)-1,t>=s&&(o="right")),null!=i){if(n=e[c+2],l==s&&r==(n.insertLeft?"left":"right")&&(o=r),"left"==r&&0==i)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)n=e[2+(c-=3)],o="left";if("right"==r&&i==s-l)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)n=e[(c+=3)+2],o="right";break}return{node:n,start:i,end:a,collapse:o,coverStart:l,coverEnd:s}}function Hr(e,t){var r=Fr;if("left"==t)for(var n=0;n<e.length&&(r=e[n]).left==r.right;n++);else for(var i=e.length-1;i>=0&&(r=e[i]).left==r.right;i--);return r}function Br(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Wr(e){e.display.externalMeasure=null,L(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Br(e.display.view[t])}function Jr(e){Wr(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function jr(){return d&&v?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function zr(){return d&&v?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Rr(e){var t=0;if(e.widgets)for(var r=0;r<e.widgets.length;++r)e.widgets[r].above&&(t+=Sr(e.widgets[r]));return t}function qr(e,t,r,n,i){if(!i){var a=Rr(t);r.top+=a,r.bottom+=a}if("line"==n)return r;n||(n="local");var o=qt(t);if("local"==n?o+=Tr(e.display):o-=e.display.viewOffset,"page"==n||"window"==n){var l=e.display.lineSpace.getBoundingClientRect();o+=l.top+("window"==n?0:zr());var s=l.left+("window"==n?0:jr());r.left+=s,r.right+=s}return r.top+=o,r.bottom+=o,r}function Ur(e,t,r){if("div"==r)return t;var n=t.left,i=t.top;if("page"==r)n-=jr(),i-=zr();else if("local"==r||!r){var a=e.display.sizer.getBoundingClientRect();n+=a.left,i+=a.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:n-o.left,top:i-o.top}}function Vr(e,t,r,n,i){return n||(n=Ke(e.doc,t.line)),qr(e,n,Mr(e,n,t.ch,i),r)}function Kr(e,t,r,n,i,a){function o(t,o){var l=Nr(e,i,t,o?"right":"left",a);return o?l.left=l.right:l.right=l.left,qr(e,n,l,r)}n=n||Ke(e.doc,t.line),i||(i=Or(e,n));var l=de(n,e.doc.direction),s=t.ch,c=t.sticky;if(s>=n.text.length?(s=n.text.length,c="before"):s<=0&&(s=0,c="after"),!l)return o("before"==c?s-1:s,"before"==c);function u(e,t,r){return o(r?e-1:e,1==l[t].level!=r)}var d=ce(l,s,c),p=se,f=u(s,d,"before"==c);return null!=p&&(f.other=u(s,p,"before"!=c)),f}function Gr(e,t){var r=0;t=ct(e.doc,t),e.options.lineWrapping||(r=on(e.display)*t.ch);var n=Ke(e.doc,t.line),i=qt(n)+Tr(e.display);return{left:r,right:r,top:i,bottom:i+n.height}}function Qr(e,t,r,n,i){var a=rt(e,t,r);return a.xRel=i,n&&(a.outside=!0),a}function Xr(e,t,r){var n=e.doc;if((r+=e.display.viewOffset)<0)return Qr(n.first,0,null,!0,-1);var i=Ze(n,r),a=n.first+n.size-1;if(i>a)return Qr(n.first+n.size-1,Ke(n,a).text.length,null,!0,1);t<0&&(t=0);for(var o=Ke(n,i);;){var l=tn(e,o,i,t,r),s=Ht(o,l.ch+(l.xRel>0?1:0));if(!s)return l;var c=s.find(1);if(c.line==i)return c;o=Ke(n,i=c.line)}}function Yr(e,t,r,n){n-=Rr(t);var i=t.text.length,a=le((function(t){return Nr(e,r,t-1).bottom<=n}),i,0);return{begin:a,end:i=le((function(t){return Nr(e,r,t).top>n}),a,i)}}function Zr(e,t,r,n){return r||(r=Or(e,t)),Yr(e,t,r,qr(e,t,Nr(e,r,n),"line").top)}function en(e,t,r,n){return!(e.bottom<=r)&&(e.top>r||(n?e.left:e.right)>t)}function tn(e,t,r,n,i){i-=qt(t);var a=Or(e,t),o=Rr(t),l=0,s=t.text.length,c=!0,u=de(t,e.doc.direction);if(u){var d=(e.options.lineWrapping?nn:rn)(e,t,r,a,u,n,i);l=(c=1!=d.level)?d.from:d.to-1,s=c?d.to:d.from-1}var p,f,h=null,m=null,g=le((function(t){var r=Nr(e,a,t);return r.top+=o,r.bottom+=o,!!en(r,n,i,!1)&&(r.top<=i&&r.left<=n&&(h=t,m=r),!0)}),l,s),v=!1;if(m){var b=n-m.left<m.right-n,y=b==c;g=h+(y?0:1),f=y?"after":"before",p=b?m.left:m.right}else{c||g!=s&&g!=l||g++,f=0==g?"after":g==t.text.length?"before":Nr(e,a,g-(c?1:0)).bottom+o<=i==c?"after":"before";var x=Kr(e,rt(r,g,f),"line",t,a);p=x.left,v=i<x.top||i>=x.bottom}return Qr(r,g=oe(t.text,g,1),f,v,n-p)}function rn(e,t,r,n,i,a,o){var l=le((function(l){var s=i[l],c=1!=s.level;return en(Kr(e,rt(r,c?s.to:s.from,c?"before":"after"),"line",t,n),a,o,!0)}),0,i.length-1),s=i[l];if(l>0){var c=1!=s.level,u=Kr(e,rt(r,c?s.from:s.to,c?"after":"before"),"line",t,n);en(u,a,o,!0)&&u.top>o&&(s=i[l-1])}return s}function nn(e,t,r,n,i,a,o){var l=Yr(e,t,n,o),s=l.begin,c=l.end;/\s/.test(t.text.charAt(c-1))&&c--;for(var u=null,d=null,p=0;p<i.length;p++){var f=i[p];if(!(f.from>=c||f.to<=s)){var h=Nr(e,n,1!=f.level?Math.min(c,f.to)-1:Math.max(s,f.from)).right,m=h<a?a-h+1e9:h-a;(!u||d>m)&&(u=f,d=m)}}return u||(u=i[i.length-1]),u.from<s&&(u={from:s,to:u.to,level:u.level}),u.to>c&&(u={from:u.from,to:c,level:u.level}),u}function an(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Dr){Dr=I("pre");for(var t=0;t<49;++t)Dr.appendChild(document.createTextNode("x")),Dr.appendChild(I("br"));Dr.appendChild(document.createTextNode("x"))}_(e.measure,Dr);var r=Dr.offsetHeight/50;return r>3&&(e.cachedTextHeight=r),L(e.measure),r||1}function on(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=I("span","xxxxxxxxxx"),r=I("pre",[t]);_(e.measure,r);var n=t.getBoundingClientRect(),i=(n.right-n.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function ln(e){for(var t=e.display,r={},n={},i=t.gutters.clientLeft,a=t.gutters.firstChild,o=0;a;a=a.nextSibling,++o){var l=e.display.gutterSpecs[o].className;r[l]=a.offsetLeft+a.clientLeft+i,n[l]=a.clientWidth}return{fixedPos:sn(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:r,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function sn(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function cn(e){var t=an(e.display),r=e.options.lineWrapping,n=r&&Math.max(5,e.display.scroller.clientWidth/on(e.display)-3);return function(i){if(zt(e.doc,i))return 0;var a=0;if(i.widgets)for(var o=0;o<i.widgets.length;o++)i.widgets[o].height&&(a+=i.widgets[o].height);return r?a+(Math.ceil(i.text.length/n)||1)*t:a+t}}function un(e){var t=e.doc,r=cn(e);t.iter((function(e){var t=r(e);t!=e.height&&Xe(e,t)}))}function dn(e,t,r,n){var i=e.display;if(!r&&"true"==ke(t).getAttribute("cm-not-content"))return null;var a,o,l=i.lineSpace.getBoundingClientRect();try{a=t.clientX-l.left,o=t.clientY-l.top}catch(t){return null}var s,c=Xr(e,a,o);if(n&&1==c.xRel&&(s=Ke(e.doc,c.line).text).length==c.ch){var u=B(s,s.length,e.options.tabSize)-s.length;c=rt(c.line,Math.max(0,Math.round((a-Ar(e.display).left)/on(e.display))-u))}return c}function pn(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var r=e.display.view,n=0;n<r.length;n++)if((t-=r[n].size)<0)return n}function fn(e,t,r,n){null==t&&(t=e.doc.first),null==r&&(r=e.doc.first+e.doc.size),n||(n=0);var i=e.display;if(n&&r<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)Tt&&Jt(e.doc,t)<i.viewTo&&mn(e);else if(r<=i.viewFrom)Tt&&jt(e.doc,r+n)>i.viewFrom?mn(e):(i.viewFrom+=n,i.viewTo+=n);else if(t<=i.viewFrom&&r>=i.viewTo)mn(e);else if(t<=i.viewFrom){var a=gn(e,r,r+n,1);a?(i.view=i.view.slice(a.index),i.viewFrom=a.lineN,i.viewTo+=n):mn(e)}else if(r>=i.viewTo){var o=gn(e,t,t,-1);o?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):mn(e)}else{var l=gn(e,t,t,-1),s=gn(e,r,r+n,1);l&&s?(i.view=i.view.slice(0,l.index).concat(or(e,l.lineN,s.lineN)).concat(i.view.slice(s.index)),i.viewTo+=n):mn(e)}var c=i.externalMeasured;c&&(r<c.lineN?c.lineN+=n:t<c.lineN+c.size&&(i.externalMeasured=null))}function hn(e,t,r){e.curOp.viewChanged=!0;var n=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var a=n.view[pn(e,t)];if(null!=a.node){var o=a.changes||(a.changes=[]);-1==J(o,r)&&o.push(r)}}}function mn(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function gn(e,t,r,n){var i,a=pn(e,t),o=e.display.view;if(!Tt||r==e.doc.first+e.doc.size)return{index:a,lineN:r};for(var l=e.display.viewFrom,s=0;s<a;s++)l+=o[s].size;if(l!=t){if(n>0){if(a==o.length-1)return null;i=l+o[a].size-t,a++}else i=l-t;t+=i,r+=i}for(;Jt(e.doc,r)!=r;){if(a==(n<0?0:o.length-1))return null;r+=n*o[a-(n<0?1:0)].size,a+=n}return{index:a,lineN:r}}function vn(e){for(var t=e.display.view,r=0,n=0;n<t.length;n++){var i=t[n];i.hidden||i.node&&!i.changes||++r}return r}function bn(e){e.display.input.showSelection(e.display.input.prepareSelection())}function yn(e,t){void 0===t&&(t=!0);for(var r=e.doc,n={},i=n.cursors=document.createDocumentFragment(),a=n.selection=document.createDocumentFragment(),o=0;o<r.sel.ranges.length;o++)if(t||o!=r.sel.primIndex){var l=r.sel.ranges[o];if(!(l.from().line>=e.display.viewTo||l.to().line<e.display.viewFrom)){var s=l.empty();(s||e.options.showCursorWhenSelecting)&&xn(e,l.head,i),s||Sn(e,l,a)}}return n}function xn(e,t,r){var n=Kr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=r.appendChild(I("div","","CodeMirror-cursor"));if(i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var a=r.appendChild(I("div","","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=n.other.left+"px",a.style.top=n.other.top+"px",a.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function wn(e,t){return e.top-t.top||e.left-t.left}function Sn(e,t,r){var n=e.display,i=e.doc,a=document.createDocumentFragment(),o=Ar(e.display),l=o.left,s=Math.max(n.sizerWidth,Lr(e)-n.sizer.offsetLeft)-o.right,c="ltr"==i.direction;function u(e,t,r,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),a.appendChild(I("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==r?s-e:r)+"px;\n                             height: "+(n-t)+"px"))}function d(t,r,n){var a,o,d=Ke(i,t),p=d.text.length;function f(r,n){return Vr(e,rt(t,r),"div",d,n)}function h(t,r,n){var i=Zr(e,d,null,t),a="ltr"==r==("after"==n)?"left":"right";return f("after"==n?i.begin:i.end-(/\s/.test(d.text.charAt(i.end-1))?2:1),a)[a]}var m=de(d,i.direction);return function(e,t,r,n){if(!e)return n(t,r,"ltr",0);for(var i=!1,a=0;a<e.length;++a){var o=e[a];(o.from<r&&o.to>t||t==r&&o.to==t)&&(n(Math.max(o.from,t),Math.min(o.to,r),1==o.level?"rtl":"ltr",a),i=!0)}i||n(t,r,"ltr")}(m,r||0,null==n?p:n,(function(e,t,i,d){var g="ltr"==i,v=f(e,g?"left":"right"),b=f(t-1,g?"right":"left"),y=null==r&&0==e,x=null==n&&t==p,w=0==d,S=!m||d==m.length-1;if(b.top-v.top<=3){var C=(c?x:y)&&S,T=(c?y:x)&&w?l:(g?v:b).left,k=C?s:(g?b:v).right;u(T,v.top,k-T,v.bottom)}else{var A,$,L,_;g?(A=c&&y&&w?l:v.left,$=c?s:h(e,i,"before"),L=c?l:h(t,i,"after"),_=c&&x&&S?s:b.right):(A=c?h(e,i,"before"):l,$=!c&&y&&w?s:v.right,L=!c&&x&&S?l:b.left,_=c?h(t,i,"after"):s),u(A,v.top,$-A,v.bottom),v.bottom<b.top&&u(l,v.bottom,null,b.top),u(L,b.top,_-L,b.bottom)}(!a||wn(v,a)<0)&&(a=v),wn(b,a)<0&&(a=b),(!o||wn(v,o)<0)&&(o=v),wn(b,o)<0&&(o=b)})),{start:a,end:o}}var p=t.from(),f=t.to();if(p.line==f.line)d(p.line,p.ch,f.ch);else{var h=Ke(i,p.line),m=Ke(i,f.line),g=Wt(h)==Wt(m),v=d(p.line,p.ch,g?h.text.length+1:null).end,b=d(f.line,g?0:null,f.ch).start;g&&(v.top<b.top-2?(u(v.right,v.top,null,v.bottom),u(l,b.top,b.left,b.bottom)):u(v.right,v.top,b.left-v.right,v.bottom)),v.bottom<b.top&&u(l,v.bottom,null,b.top)}r.appendChild(a)}function Cn(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var r=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval((function(){return t.cursorDiv.style.visibility=(r=!r)?"":"hidden"}),e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Tn(e){e.state.focused||(e.display.input.focus(),An(e))}function kn(e){e.state.delayingBlurEvent=!0,setTimeout((function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,$n(e))}),100)}function An(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(ge(e,"focus",e,t),e.state.focused=!0,N(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),c&&setTimeout((function(){return e.display.input.reset(!0)}),20)),e.display.input.receivedFocus()),Cn(e))}function $n(e,t){e.state.delayingBlurEvent||(e.state.focused&&(ge(e,"blur",e,t),e.state.focused=!1,$(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout((function(){e.state.focused||(e.display.shift=!1)}),150))}function Ln(e){for(var t=e.display,r=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var i=t.view[n],a=e.options.lineWrapping,o=void 0,c=0;if(!i.hidden){if(l&&s<8){var u=i.node.offsetTop+i.node.offsetHeight;o=u-r,r=u}else{var d=i.node.getBoundingClientRect();o=d.bottom-d.top,!a&&i.text.firstChild&&(c=i.text.firstChild.getBoundingClientRect().right-d.left-1)}var p=i.line.height-o;if((p>.005||p<-.005)&&(Xe(i.line,o),_n(i.line),i.rest))for(var f=0;f<i.rest.length;f++)_n(i.rest[f]);if(c>e.display.sizerWidth){var h=Math.ceil(c/on(e.display));h>e.display.maxLineLength&&(e.display.maxLineLength=h,e.display.maxLine=i.line,e.display.maxLineChanged=!0)}}}}function _n(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var r=e.widgets[t],n=r.node.parentNode;n&&(r.height=n.offsetHeight)}}function In(e,t,r){var n=r&&null!=r.top?Math.max(0,r.top):e.scroller.scrollTop;n=Math.floor(n-Tr(e));var i=r&&null!=r.bottom?r.bottom:n+e.wrapper.clientHeight,a=Ze(t,n),o=Ze(t,i);if(r&&r.ensure){var l=r.ensure.from.line,s=r.ensure.to.line;l<a?(a=l,o=Ze(t,qt(Ke(t,l))+e.wrapper.clientHeight)):Math.min(s,t.lastLine())>=o&&(a=Ze(t,qt(Ke(t,s))-e.wrapper.clientHeight),o=s)}return{from:a,to:Math.max(o,a+1)}}function Mn(e,t){var r=e.display,n=an(e.display);t.top<0&&(t.top=0);var i=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:r.scroller.scrollTop,a=_r(e),o={};t.bottom-t.top>a&&(t.bottom=t.top+a);var l=e.doc.height+kr(r),s=t.top<n,c=t.bottom>l-n;if(t.top<i)o.scrollTop=s?0:t.top;else if(t.bottom>i+a){var u=Math.min(t.top,(c?l:t.bottom)-a);u!=i&&(o.scrollTop=u)}var d=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:r.scroller.scrollLeft,p=Lr(e)-(e.options.fixedGutter?r.gutters.offsetWidth:0),f=t.right-t.left>p;return f&&(t.right=t.left+p),t.left<10?o.scrollLeft=0:t.left<d?o.scrollLeft=Math.max(0,t.left-(f?0:10)):t.right>p+d-3&&(o.scrollLeft=t.right+(f?0:10)-p),o}function Pn(e,t){null!=t&&(Dn(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function On(e){Dn(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Nn(e,t,r){null==t&&null==r||Dn(e),null!=t&&(e.curOp.scrollLeft=t),null!=r&&(e.curOp.scrollTop=r)}function Dn(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Fn(e,Gr(e,t.from),Gr(e,t.to),t.margin))}function Fn(e,t,r,n){var i=Mn(e,{left:Math.min(t.left,r.left),top:Math.min(t.top,r.top)-n,right:Math.max(t.right,r.right),bottom:Math.max(t.bottom,r.bottom)+n});Nn(e,i.scrollLeft,i.scrollTop)}function En(e,t){Math.abs(e.doc.scrollTop-t)<2||(r||ci(e,{top:t}),Hn(e,t,!0),r&&ci(e),ii(e,100))}function Hn(e,t,r){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),(e.display.scroller.scrollTop!=t||r)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Bn(e,t,r,n){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(r?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n||(e.doc.scrollLeft=t,pi(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Wn(e){var t=e.display,r=t.gutters.offsetWidth,n=Math.round(e.doc.height+kr(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?r:0,docHeight:n,scrollHeight:n+$r(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:r}}var Jn=function(e,t,r){this.cm=r;var n=this.vert=I("div",[I("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=I("div",[I("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n.tabIndex=i.tabIndex=-1,e(n),e(i),fe(n,"scroll",(function(){n.clientHeight&&t(n.scrollTop,"vertical")})),fe(i,"scroll",(function(){i.clientWidth&&t(i.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,l&&s<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Jn.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";var i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=r?n+"px":"0",this.horiz.style.left=e.barLeft+"px";var a=e.viewWidth-e.barLeft-(r?n:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+a)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?n:0,bottom:t?n:0}},Jn.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Jn.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Jn.prototype.zeroWidthHack=function(){var e=y&&!h?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new W,this.disableVert=new W},Jn.prototype.enableZeroWidthBar=function(e,t,r){e.style.pointerEvents="auto",t.set(1e3,(function n(){var i=e.getBoundingClientRect();("vert"==r?document.elementFromPoint(i.right-1,(i.top+i.bottom)/2):document.elementFromPoint((i.right+i.left)/2,i.bottom-1))!=e?e.style.pointerEvents="none":t.set(1e3,n)}))},Jn.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var jn=function(){};function zn(e,t){t||(t=Wn(e));var r=e.display.barWidth,n=e.display.barHeight;Rn(e,t);for(var i=0;i<4&&r!=e.display.barWidth||n!=e.display.barHeight;i++)r!=e.display.barWidth&&e.options.lineWrapping&&Ln(e),Rn(e,Wn(e)),r=e.display.barWidth,n=e.display.barHeight}function Rn(e,t){var r=e.display,n=r.scrollbars.update(t);r.sizer.style.paddingRight=(r.barWidth=n.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=n.bottom)+"px",r.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=n.bottom+"px",r.scrollbarFiller.style.width=n.right+"px"):r.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=n.bottom+"px",r.gutterFiller.style.width=t.gutterWidth+"px"):r.gutterFiller.style.display=""}jn.prototype.update=function(){return{bottom:0,right:0}},jn.prototype.setScrollLeft=function(){},jn.prototype.setScrollTop=function(){},jn.prototype.clear=function(){};var qn={native:Jn,null:jn};function Un(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&$(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new qn[e.options.scrollbarStyle]((function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),fe(t,"mousedown",(function(){e.state.focused&&setTimeout((function(){return e.display.input.focus()}),0)})),t.setAttribute("cm-not-content","true")}),(function(t,r){"horizontal"==r?Bn(e,t):En(e,t)}),e),e.display.scrollbars.addClass&&N(e.display.wrapper,e.display.scrollbars.addClass)}var Vn=0;function Kn(e){var t;e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Vn},t=e.curOp,lr?lr.ops.push(t):t.ownsGroup=lr={ops:[t],delayedCallbacks:[]}}function Gn(e){var t=e.curOp;t&&function(e,t){var r=e.ownsGroup;if(r)try{!function(e){var t=e.delayedCallbacks,r=0;do{for(;r<t.length;r++)t[r].call(null);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(r<t.length)}(r)}finally{lr=null,t(r)}}(t,(function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;!function(e){for(var t=e.ops,r=0;r<t.length;r++)Qn(t[r]);for(var n=0;n<t.length;n++)(i=t[n]).updatedDisplay=i.mustUpdate&&li(i.cm,i.update);for(var i,a=0;a<t.length;a++)Xn(t[a]);for(var o=0;o<t.length;o++)Yn(t[o]);for(var l=0;l<t.length;l++)Zn(t[l])}(e)}))}function Qn(e){var t=e.cm,r=t.display;!function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=$r(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=$r(e)+"px",t.scrollbarsClipped=!0)}(t),e.updateMaxLine&&Vt(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<r.viewFrom||e.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new oi(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Xn(e){var t=e.cm,r=t.display;e.updatedDisplay&&Ln(t),e.barMeasure=Wn(t),r.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Mr(t,r.maxLine,r.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+e.adjustWidthTo+$r(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+e.adjustWidthTo-Lr(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=r.input.prepareSelection())}function Yn(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Bn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var r=e.focus&&e.focus==O();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,r),(e.updatedDisplay||e.startHeight!=t.doc.height)&&zn(t,e.barMeasure),e.updatedDisplay&&di(t,e.barMeasure),e.selectionChanged&&Cn(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),r&&Tn(e.cm)}function Zn(e){var t=e.cm,r=t.display,n=t.doc;e.updatedDisplay&&si(t,e.update),null==r.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=e.scrollTop&&Hn(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&Bn(t,e.scrollLeft,!0,!0),e.scrollToPos&&function(e,t){if(!ve(e,"scrollCursorIntoView")){var r=e.display,n=r.sizer.getBoundingClientRect(),i=null;if(t.top+n.top<0?i=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!m){var a=I("div","",null,"position: absolute;\n                         top: "+(t.top-r.viewOffset-Tr(e.display))+"px;\n                         height: "+(t.bottom-t.top+$r(e)+r.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(a),a.scrollIntoView(i),e.display.lineSpace.removeChild(a)}}}(t,function(e,t,r,n){var i;null==n&&(n=0),e.options.lineWrapping||t!=r||(r="before"==(t=t.ch?rt(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?rt(t.line,t.ch+1,"before"):t);for(var a=0;a<5;a++){var o=!1,l=Kr(e,t),s=r&&r!=t?Kr(e,r):l,c=Mn(e,i={left:Math.min(l.left,s.left),top:Math.min(l.top,s.top)-n,right:Math.max(l.left,s.left),bottom:Math.max(l.bottom,s.bottom)+n}),u=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=c.scrollTop&&(En(e,c.scrollTop),Math.abs(e.doc.scrollTop-u)>1&&(o=!0)),null!=c.scrollLeft&&(Bn(e,c.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(o=!0)),!o)break}return i}(t,ct(n,e.scrollToPos.from),ct(n,e.scrollToPos.to),e.scrollToPos.margin));var i=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(i)for(var o=0;o<i.length;++o)i[o].lines.length||ge(i[o],"hide");if(a)for(var l=0;l<a.length;++l)a[l].lines.length&&ge(a[l],"unhide");r.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&ge(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function ei(e,t){if(e.curOp)return t();Kn(e);try{return t()}finally{Gn(e)}}function ti(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Kn(e);try{return t.apply(e,arguments)}finally{Gn(e)}}}function ri(e){return function(){if(this.curOp)return e.apply(this,arguments);Kn(this);try{return e.apply(this,arguments)}finally{Gn(this)}}}function ni(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Kn(t);try{return e.apply(this,arguments)}finally{Gn(t)}}}function ii(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,E(ai,e))}function ai(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var r=+new Date+e.options.workTime,n=mt(e,t.highlightFrontier),i=[];t.iter(n.line,Math.min(t.first+t.size,e.display.viewTo+500),(function(a){if(n.line>=e.display.viewFrom){var o=a.styles,l=a.text.length>e.options.maxHighlightLength?Re(t.mode,n.state):null,s=ft(e,a,n,!0);l&&(n.state=l),a.styles=s.styles;var c=a.styleClasses,u=s.classes;u?a.styleClasses=u:c&&(a.styleClasses=null);for(var d=!o||o.length!=a.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),p=0;!d&&p<o.length;++p)d=o[p]!=a.styles[p];d&&i.push(n.line),a.stateAfter=n.save(),n.nextLine()}else a.text.length<=e.options.maxHighlightLength&&gt(e,a.text,n),a.stateAfter=n.line%5==0?n.save():null,n.nextLine();if(+new Date>r)return ii(e,e.options.workDelay),!0})),t.highlightFrontier=n.line,t.modeFrontier=Math.max(t.modeFrontier,n.line),i.length&&ei(e,(function(){for(var t=0;t<i.length;t++)hn(e,i[t],"text")}))}}var oi=function(e,t,r){var n=e.display;this.viewport=t,this.visible=In(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Lr(e),this.force=r,this.dims=ln(e),this.events=[]};function li(e,t){var r=e.display,n=e.doc;if(t.editorIsHidden)return mn(e),!1;if(!t.force&&t.visible.from>=r.viewFrom&&t.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==vn(e))return!1;fi(e)&&(mn(e),t.dims=ln(e));var i=n.first+n.size,a=Math.max(t.visible.from-e.options.viewportMargin,n.first),o=Math.min(i,t.visible.to+e.options.viewportMargin);r.viewFrom<a&&a-r.viewFrom<20&&(a=Math.max(n.first,r.viewFrom)),r.viewTo>o&&r.viewTo-o<20&&(o=Math.min(i,r.viewTo)),Tt&&(a=Jt(e.doc,a),o=jt(e.doc,o));var l=a!=r.viewFrom||o!=r.viewTo||r.lastWrapHeight!=t.wrapperHeight||r.lastWrapWidth!=t.wrapperWidth;!function(e,t,r){var n=e.display;0==n.view.length||t>=n.viewTo||r<=n.viewFrom?(n.view=or(e,t,r),n.viewFrom=t):(n.viewFrom>t?n.view=or(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(pn(e,t))),n.viewFrom=t,n.viewTo<r?n.view=n.view.concat(or(e,n.viewTo,r)):n.viewTo>r&&(n.view=n.view.slice(0,pn(e,r)))),n.viewTo=r}(e,a,o),r.viewOffset=qt(Ke(e.doc,r.viewFrom)),e.display.mover.style.top=r.viewOffset+"px";var s=vn(e);if(!l&&0==s&&!t.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var u=function(e){if(e.hasFocus())return null;var t=O();if(!t||!P(e.display.lineDiv,t))return null;var r={activeElt:t};if(window.getSelection){var n=window.getSelection();n.anchorNode&&n.extend&&P(e.display.lineDiv,n.anchorNode)&&(r.anchorNode=n.anchorNode,r.anchorOffset=n.anchorOffset,r.focusNode=n.focusNode,r.focusOffset=n.focusOffset)}return r}(e);return s>4&&(r.lineDiv.style.display="none"),function(e,t,r){var n=e.display,i=e.options.lineNumbers,a=n.lineDiv,o=a.firstChild;function l(t){var r=t.nextSibling;return c&&y&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),r}for(var s=n.view,u=n.viewFrom,d=0;d<s.length;d++){var p=s[d];if(p.hidden);else if(p.node&&p.node.parentNode==a){for(;o!=p.node;)o=l(o);var f=i&&null!=t&&t<=u&&p.lineNumber;p.changes&&(J(p.changes,"gutter")>-1&&(f=!1),dr(e,p,u,r)),f&&(L(p.lineNumber),p.lineNumber.appendChild(document.createTextNode(tt(e.options,u)))),o=p.node.nextSibling}else{var h=br(e,p,u,r);a.insertBefore(h,o)}u+=p.size}for(;o;)o=l(o)}(e,r.updateLineNumbers,t.dims),s>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,function(e){if(e&&e.activeElt&&e.activeElt!=O()&&(e.activeElt.focus(),e.anchorNode&&P(document.body,e.anchorNode)&&P(document.body,e.focusNode))){var t=window.getSelection(),r=document.createRange();r.setEnd(e.anchorNode,e.anchorOffset),r.collapse(!1),t.removeAllRanges(),t.addRange(r),t.extend(e.focusNode,e.focusOffset)}}(u),L(r.cursorDiv),L(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,l&&(r.lastWrapHeight=t.wrapperHeight,r.lastWrapWidth=t.wrapperWidth,ii(e,400)),r.updateLineNumbers=null,!0}function si(e,t){for(var r=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=Lr(e)||(r&&null!=r.top&&(r={top:Math.min(e.doc.height+kr(e.display)-_r(e),r.top)}),t.visible=In(e.display,e.doc,r),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&li(e,t);n=!1){Ln(e);var i=Wn(e);bn(e),zn(e,i),di(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function ci(e,t){var r=new oi(e,t);if(li(e,r)){Ln(e),si(e,r);var n=Wn(e);bn(e),zn(e,n),di(e,n),r.finish()}}function ui(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function di(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+$r(e)+"px"}function pi(e){var t=e.display,r=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=sn(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,a=n+"px",o=0;o<r.length;o++)if(!r[o].hidden){e.options.fixedGutter&&(r[o].gutter&&(r[o].gutter.style.left=a),r[o].gutterBackground&&(r[o].gutterBackground.style.left=a));var l=r[o].alignable;if(l)for(var s=0;s<l.length;s++)l[s].style.left=a}e.options.fixedGutter&&(t.gutters.style.left=n+i+"px")}}function fi(e){if(!e.options.lineNumbers)return!1;var t=e.doc,r=tt(e.options,t.first+t.size-1),n=e.display;if(r.length!=n.lineNumChars){var i=n.measure.appendChild(I("div",[I("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=i.firstChild.offsetWidth,o=i.offsetWidth-a;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(a,n.lineGutter.offsetWidth-o)+1,n.lineNumWidth=n.lineNumInnerWidth+o,n.lineNumChars=n.lineNumInnerWidth?r.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",ui(e.display),!0}return!1}function hi(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var a=e[i],o=null;if("string"!=typeof a&&(o=a.style,a=a.className),"CodeMirror-linenumbers"==a){if(!t)continue;n=!0}r.push({className:a,style:o})}return t&&!n&&r.push({className:"CodeMirror-linenumbers",style:null}),r}function mi(e){var t=e.gutters,r=e.gutterSpecs;L(t),e.lineGutter=null;for(var n=0;n<r.length;++n){var i=r[n],a=i.className,o=i.style,l=t.appendChild(I("div",null,"CodeMirror-gutter "+a));o&&(l.style.cssText=o),"CodeMirror-linenumbers"==a&&(e.lineGutter=l,l.style.width=(e.lineNumWidth||1)+"px")}t.style.display=r.length?"":"none",ui(e)}function gi(e){mi(e.display),fn(e),pi(e)}function vi(e,t,n,i){var a=this;this.input=n,a.scrollbarFiller=I("div",null,"CodeMirror-scrollbar-filler"),a.scrollbarFiller.setAttribute("cm-not-content","true"),a.gutterFiller=I("div",null,"CodeMirror-gutter-filler"),a.gutterFiller.setAttribute("cm-not-content","true"),a.lineDiv=M("div",null,"CodeMirror-code"),a.selectionDiv=I("div",null,null,"position: relative; z-index: 1"),a.cursorDiv=I("div",null,"CodeMirror-cursors"),a.measure=I("div",null,"CodeMirror-measure"),a.lineMeasure=I("div",null,"CodeMirror-measure"),a.lineSpace=M("div",[a.measure,a.lineMeasure,a.selectionDiv,a.cursorDiv,a.lineDiv],null,"position: relative; outline: none");var o=M("div",[a.lineSpace],"CodeMirror-lines");a.mover=I("div",[o],null,"position: relative"),a.sizer=I("div",[a.mover],"CodeMirror-sizer"),a.sizerWidth=null,a.heightForcer=I("div",null,null,"position: absolute; height: "+j+"px; width: 1px;"),a.gutters=I("div",null,"CodeMirror-gutters"),a.lineGutter=null,a.scroller=I("div",[a.sizer,a.heightForcer,a.gutters],"CodeMirror-scroll"),a.scroller.setAttribute("tabIndex","-1"),a.wrapper=I("div",[a.scrollbarFiller,a.gutterFiller,a.scroller],"CodeMirror"),l&&s<8&&(a.gutters.style.zIndex=-1,a.scroller.style.paddingRight=0),c||r&&b||(a.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(a.wrapper):e(a.wrapper)),a.viewFrom=a.viewTo=t.first,a.reportedViewFrom=a.reportedViewTo=t.first,a.view=[],a.renderedView=null,a.externalMeasured=null,a.viewOffset=0,a.lastWrapHeight=a.lastWrapWidth=0,a.updateLineNumbers=null,a.nativeBarWidth=a.barHeight=a.barWidth=0,a.scrollbarsClipped=!1,a.lineNumWidth=a.lineNumInnerWidth=a.lineNumChars=null,a.alignWidgets=!1,a.cachedCharWidth=a.cachedTextHeight=a.cachedPaddingH=null,a.maxLine=null,a.maxLineLength=0,a.maxLineChanged=!1,a.wheelDX=a.wheelDY=a.wheelStartX=a.wheelStartY=null,a.shift=!1,a.selForContextMenu=null,a.activeTouch=null,a.gutterSpecs=hi(i.gutters,i.lineNumbers),mi(a),n.init(a)}oi.prototype.signal=function(e,t){ye(e,t)&&this.events.push(arguments)},oi.prototype.finish=function(){for(var e=0;e<this.events.length;e++)ge.apply(null,this.events[e])};var bi=0,yi=null;function xi(e){var t=e.wheelDeltaX,r=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta),{x:t,y:r}}function wi(e){var t=xi(e);return t.x*=yi,t.y*=yi,t}function Si(e,t){var n=xi(t),i=n.x,a=n.y,o=e.display,l=o.scroller,s=l.scrollWidth>l.clientWidth,u=l.scrollHeight>l.clientHeight;if(i&&s||a&&u){if(a&&y&&c)e:for(var d=t.target,f=o.view;d!=l;d=d.parentNode)for(var h=0;h<f.length;h++)if(f[h].node==d){e.display.currentWheelTarget=d;break e}if(i&&!r&&!p&&null!=yi)return a&&u&&En(e,Math.max(0,l.scrollTop+a*yi)),Bn(e,Math.max(0,l.scrollLeft+i*yi)),(!a||a&&u)&&we(t),void(o.wheelStartX=null);if(a&&null!=yi){var m=a*yi,g=e.doc.scrollTop,v=g+o.wrapper.clientHeight;m<0?g=Math.max(0,g+m-50):v=Math.min(e.doc.height,v+m+50),ci(e,{top:g,bottom:v})}bi<20&&(null==o.wheelStartX?(o.wheelStartX=l.scrollLeft,o.wheelStartY=l.scrollTop,o.wheelDX=i,o.wheelDY=a,setTimeout((function(){if(null!=o.wheelStartX){var e=l.scrollLeft-o.wheelStartX,t=l.scrollTop-o.wheelStartY,r=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,r&&(yi=(yi*bi+r)/(bi+1),++bi)}}),200)):(o.wheelDX+=i,o.wheelDY+=a))}}l?yi=-.53:r?yi=15:d?yi=-.7:f&&(yi=-1/3);var Ci=function(e,t){this.ranges=e,this.primIndex=t};Ci.prototype.primary=function(){return this.ranges[this.primIndex]},Ci.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var r=this.ranges[t],n=e.ranges[t];if(!it(r.anchor,n.anchor)||!it(r.head,n.head))return!1}return!0},Ci.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new Ti(at(this.ranges[t].anchor),at(this.ranges[t].head));return new Ci(e,this.primIndex)},Ci.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Ci.prototype.contains=function(e,t){t||(t=e);for(var r=0;r<this.ranges.length;r++){var n=this.ranges[r];if(nt(t,n.from())>=0&&nt(e,n.to())<=0)return r}return-1};var Ti=function(e,t){this.anchor=e,this.head=t};function ki(e,t,r){var n=e&&e.options.selectionsMayTouch,i=t[r];t.sort((function(e,t){return nt(e.from(),t.from())})),r=J(t,i);for(var a=1;a<t.length;a++){var o=t[a],l=t[a-1],s=nt(l.to(),o.from());if(n&&!o.empty()?s>0:s>=0){var c=lt(l.from(),o.from()),u=ot(l.to(),o.to()),d=l.empty()?o.from()==o.head:l.from()==l.head;a<=r&&--r,t.splice(--a,2,new Ti(d?u:c,d?c:u))}}return new Ci(t,r)}function Ai(e,t){return new Ci([new Ti(e,t||e)],0)}function $i(e){return e.text?rt(e.from.line+e.text.length-1,Q(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function Li(e,t){if(nt(e,t.from)<0)return e;if(nt(e,t.to)<=0)return $i(t);var r=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=$i(t).ch-t.to.ch),rt(r,n)}function _i(e,t){for(var r=[],n=0;n<e.sel.ranges.length;n++){var i=e.sel.ranges[n];r.push(new Ti(Li(i.anchor,t),Li(i.head,t)))}return ki(e.cm,r,e.sel.primIndex)}function Ii(e,t,r){return e.line==t.line?rt(r.line,e.ch-t.ch+r.ch):rt(r.line+(e.line-t.line),e.ch)}function Mi(e){e.doc.mode=Je(e.options,e.doc.modeOption),Pi(e)}function Pi(e){e.doc.iter((function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)})),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,ii(e,100),e.state.modeGen++,e.curOp&&fn(e)}function Oi(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Q(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ni(e,t,r,n){function i(e){return r?r[e]:null}function a(e,r,i){!function(e,t,r,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),It(e),Mt(e,r);var i=n?n(e):1;i!=e.height&&Xe(e,i)}(e,r,i,n),cr(e,"change",e,t)}function o(e,t){for(var r=[],a=e;a<t;++a)r.push(new Kt(c[a],i(a),n));return r}var l=t.from,s=t.to,c=t.text,u=Ke(e,l.line),d=Ke(e,s.line),p=Q(c),f=i(c.length-1),h=s.line-l.line;if(t.full)e.insert(0,o(0,c.length)),e.remove(c.length,e.size-c.length);else if(Oi(e,t)){var m=o(0,c.length-1);a(d,d.text,f),h&&e.remove(l.line,h),m.length&&e.insert(l.line,m)}else if(u==d)if(1==c.length)a(u,u.text.slice(0,l.ch)+p+u.text.slice(s.ch),f);else{var g=o(1,c.length-1);g.push(new Kt(p+u.text.slice(s.ch),f,n)),a(u,u.text.slice(0,l.ch)+c[0],i(0)),e.insert(l.line+1,g)}else if(1==c.length)a(u,u.text.slice(0,l.ch)+c[0]+d.text.slice(s.ch),i(0)),e.remove(l.line+1,h);else{a(u,u.text.slice(0,l.ch)+c[0],i(0)),a(d,p+d.text.slice(s.ch),f);var v=o(1,c.length-1);h>1&&e.remove(l.line+1,h-1),e.insert(l.line+1,v)}cr(e,"change",e,t)}function Di(e,t,r){!function e(n,i,a){if(n.linked)for(var o=0;o<n.linked.length;++o){var l=n.linked[o];if(l.doc!=i){var s=a&&l.sharedHist;r&&!s||(t(l.doc,s),e(l.doc,n,s))}}}(e,null,!0)}function Fi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,un(e),Mi(e),Ei(e),e.options.lineWrapping||Vt(e),e.options.mode=t.modeOption,fn(e)}function Ei(e){("rtl"==e.doc.direction?N:$)(e.display.lineDiv,"CodeMirror-rtl")}function Hi(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Bi(e,t){var r={from:at(t.from),to:$i(t),text:Ge(e,t.from,t.to)};return Ri(e,r,t.from.line,t.to.line+1),Di(e,(function(e){return Ri(e,r,t.from.line,t.to.line+1)}),!0),r}function Wi(e){for(;e.length&&Q(e).ranges;)e.pop()}function Ji(e,t,r,n){var i=e.history;i.undone.length=0;var a,o,l=+new Date;if((i.lastOp==n||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastModTime>l-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(a=function(e,t){return t?(Wi(e.done),Q(e.done)):e.done.length&&!Q(e.done).ranges?Q(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Q(e.done)):void 0}(i,i.lastOp==n)))o=Q(a.changes),0==nt(t.from,t.to)&&0==nt(t.from,o.to)?o.to=$i(t):a.changes.push(Bi(e,t));else{var s=Q(i.done);for(s&&s.ranges||zi(e.sel,i.done),a={changes:[Bi(e,t)],generation:i.generation},i.done.push(a);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(r),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=l,i.lastOp=i.lastSelOp=n,i.lastOrigin=i.lastSelOrigin=t.origin,o||ge(e,"historyAdded")}function ji(e,t,r,n){var i=e.history,a=n&&n.origin;r==i.lastSelOp||a&&i.lastSelOrigin==a&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==a||function(e,t,r,n){var i=t.charAt(0);return"*"==i||"+"==i&&r.ranges.length==n.ranges.length&&r.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,a,Q(i.done),t))?i.done[i.done.length-1]=t:zi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=a,i.lastSelOp=r,n&&!1!==n.clearRedo&&Wi(i.undone)}function zi(e,t){var r=Q(t);r&&r.ranges&&r.equals(e)||t.push(e)}function Ri(e,t,r,n){var i=t["spans_"+e.id],a=0;e.iter(Math.max(e.first,r),Math.min(e.first+e.size,n),(function(r){r.markedSpans&&((i||(i=t["spans_"+e.id]={}))[a]=r.markedSpans),++a}))}function qi(e){if(!e)return null;for(var t,r=0;r<e.length;++r)e[r].marker.explicitlyCleared?t||(t=e.slice(0,r)):t&&t.push(e[r]);return t?t.length?t:null:e}function Ui(e,t){var r=function(e,t){var r=t["spans_"+e.id];if(!r)return null;for(var n=[],i=0;i<t.text.length;++i)n.push(qi(r[i]));return n}(e,t),n=Lt(e,t);if(!r)return n;if(!n)return r;for(var i=0;i<r.length;++i){var a=r[i],o=n[i];if(a&&o)e:for(var l=0;l<o.length;++l){for(var s=o[l],c=0;c<a.length;++c)if(a[c].marker==s.marker)continue e;a.push(s)}else o&&(r[i]=o)}return r}function Vi(e,t,r){for(var n=[],i=0;i<e.length;++i){var a=e[i];if(a.ranges)n.push(r?Ci.prototype.deepCopy.call(a):a);else{var o=a.changes,l=[];n.push({changes:l});for(var s=0;s<o.length;++s){var c=o[s],u=void 0;if(l.push({from:c.from,to:c.to,text:c.text}),t)for(var d in c)(u=d.match(/^spans_(\d+)$/))&&J(t,Number(u[1]))>-1&&(Q(l)[d]=c[d],delete c[d])}}}return n}function Ki(e,t,r,n){if(n){var i=e.anchor;if(r){var a=nt(t,i)<0;a!=nt(r,i)<0?(i=t,t=r):a!=nt(t,r)<0&&(t=r)}return new Ti(i,t)}return new Ti(r||t,t)}function Gi(e,t,r,n,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),ea(e,new Ci([Ki(e.sel.primary(),t,r,i)],0),n)}function Qi(e,t,r){for(var n=[],i=e.cm&&(e.cm.display.shift||e.extend),a=0;a<e.sel.ranges.length;a++)n[a]=Ki(e.sel.ranges[a],t[a],null,i);ea(e,ki(e.cm,n,e.sel.primIndex),r)}function Xi(e,t,r,n){var i=e.sel.ranges.slice(0);i[t]=r,ea(e,ki(e.cm,i,e.sel.primIndex),n)}function Yi(e,t,r,n){ea(e,Ai(t,r),n)}function Zi(e,t,r){var n=e.history.done,i=Q(n);i&&i.ranges?(n[n.length-1]=t,ta(e,t,r)):ea(e,t,r)}function ea(e,t,r){ta(e,t,r),ji(e,e.sel,e.cm?e.cm.curOp.id:NaN,r)}function ta(e,t,r){(ye(e,"beforeSelectionChange")||e.cm&&ye(e.cm,"beforeSelectionChange"))&&(t=function(e,t,r){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var r=0;r<t.length;r++)this.ranges[r]=new Ti(ct(e,t[r].anchor),ct(e,t[r].head))},origin:r&&r.origin};return ge(e,"beforeSelectionChange",e,n),e.cm&&ge(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?ki(e.cm,n.ranges,n.ranges.length-1):t}(e,t,r));var n=r&&r.bias||(nt(t.primary().head,e.sel.primary().head)<0?-1:1);ra(e,ia(e,t,n,!0)),r&&!1===r.scroll||!e.cm||On(e.cm)}function ra(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,be(e.cm)),cr(e,"cursorActivity",e))}function na(e){ra(e,ia(e,e.sel,null,!1))}function ia(e,t,r,n){for(var i,a=0;a<t.ranges.length;a++){var o=t.ranges[a],l=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[a],s=oa(e,o.anchor,l&&l.anchor,r,n),c=oa(e,o.head,l&&l.head,r,n);(i||s!=o.anchor||c!=o.head)&&(i||(i=t.ranges.slice(0,a)),i[a]=new Ti(s,c))}return i?ki(e.cm,i,t.primIndex):t}function aa(e,t,r,n,i){var a=Ke(e,t.line);if(a.markedSpans)for(var o=0;o<a.markedSpans.length;++o){var l=a.markedSpans[o],s=l.marker;if((null==l.from||(s.inclusiveLeft?l.from<=t.ch:l.from<t.ch))&&(null==l.to||(s.inclusiveRight?l.to>=t.ch:l.to>t.ch))){if(i&&(ge(s,"beforeCursorEnter"),s.explicitlyCleared)){if(a.markedSpans){--o;continue}break}if(!s.atomic)continue;if(r){var c=s.find(n<0?1:-1),u=void 0;if((n<0?s.inclusiveRight:s.inclusiveLeft)&&(c=la(e,c,-n,c&&c.line==t.line?a:null)),c&&c.line==t.line&&(u=nt(c,r))&&(n<0?u<0:u>0))return aa(e,c,t,n,i)}var d=s.find(n<0?-1:1);return(n<0?s.inclusiveLeft:s.inclusiveRight)&&(d=la(e,d,n,d.line==t.line?a:null)),d?aa(e,d,t,n,i):null}}return t}function oa(e,t,r,n,i){var a=n||1,o=aa(e,t,r,a,i)||!i&&aa(e,t,r,a,!0)||aa(e,t,r,-a,i)||!i&&aa(e,t,r,-a,!0);return o||(e.cantEdit=!0,rt(e.first,0))}function la(e,t,r,n){return r<0&&0==t.ch?t.line>e.first?ct(e,rt(t.line-1)):null:r>0&&t.ch==(n||Ke(e,t.line)).text.length?t.line<e.first+e.size-1?rt(t.line+1,0):null:new rt(t.line,t.ch+r)}function sa(e){e.setSelection(rt(e.firstLine(),0),rt(e.lastLine()),R)}function ca(e,t,r){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return n.canceled=!0}};return r&&(n.update=function(t,r,i,a){t&&(n.from=ct(e,t)),r&&(n.to=ct(e,r)),i&&(n.text=i),void 0!==a&&(n.origin=a)}),ge(e,"beforeChange",e,n),e.cm&&ge(e.cm,"beforeChange",e.cm,n),n.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:n.from,to:n.to,text:n.text,origin:n.origin}}function ua(e,t,r){if(e.cm){if(!e.cm.curOp)return ti(e.cm,ua)(e,t,r);if(e.cm.state.suppressEdits)return}if(!(ye(e,"beforeChange")||e.cm&&ye(e.cm,"beforeChange"))||(t=ca(e,t,!0))){var n=Ct&&!r&&function(e,t,r){var n=null;if(e.iter(t.line,r.line+1,(function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var r=e.markedSpans[t].marker;!r.readOnly||n&&-1!=J(n,r)||(n||(n=[])).push(r)}})),!n)return null;for(var i=[{from:t,to:r}],a=0;a<n.length;++a)for(var o=n[a],l=o.find(0),s=0;s<i.length;++s){var c=i[s];if(!(nt(c.to,l.from)<0||nt(c.from,l.to)>0)){var u=[s,1],d=nt(c.from,l.from),p=nt(c.to,l.to);(d<0||!o.inclusiveLeft&&!d)&&u.push({from:c.from,to:l.from}),(p>0||!o.inclusiveRight&&!p)&&u.push({from:l.to,to:c.to}),i.splice.apply(i,u),s+=u.length-3}}return i}(e,t.from,t.to);if(n)for(var i=n.length-1;i>=0;--i)da(e,{from:n[i].from,to:n[i].to,text:i?[""]:t.text,origin:t.origin});else da(e,t)}}function da(e,t){if(1!=t.text.length||""!=t.text[0]||0!=nt(t.from,t.to)){var r=_i(e,t);Ji(e,t,r,e.cm?e.cm.curOp.id:NaN),ha(e,t,r,Lt(e,t));var n=[];Di(e,(function(e,r){r||-1!=J(n,e.history)||(ba(e.history,t),n.push(e.history)),ha(e,t,null,Lt(e,t))}))}}function pa(e,t,r){var n=e.cm&&e.cm.state.suppressEdits;if(!n||r){for(var i,a=e.history,o=e.sel,l="undo"==t?a.done:a.undone,s="undo"==t?a.undone:a.done,c=0;c<l.length&&(i=l[c],r?!i.ranges||i.equals(e.sel):i.ranges);c++);if(c!=l.length){for(a.lastOrigin=a.lastSelOrigin=null;;){if(!(i=l.pop()).ranges){if(n)return void l.push(i);break}if(zi(i,s),r&&!i.equals(e.sel))return void ea(e,i,{clearRedo:!1});o=i}var u=[];zi(o,s),s.push({changes:u,generation:a.generation}),a.generation=i.generation||++a.maxGeneration;for(var d=ye(e,"beforeChange")||e.cm&&ye(e.cm,"beforeChange"),p=function(r){var n=i.changes[r];if(n.origin=t,d&&!ca(e,n,!1))return l.length=0,{};u.push(Bi(e,n));var a=r?_i(e,n):Q(l);ha(e,n,a,Ui(e,n)),!r&&e.cm&&e.cm.scrollIntoView({from:n.from,to:$i(n)});var o=[];Di(e,(function(e,t){t||-1!=J(o,e.history)||(ba(e.history,n),o.push(e.history)),ha(e,n,null,Ui(e,n))}))},f=i.changes.length-1;f>=0;--f){var h=p(f);if(h)return h.v}}}}function fa(e,t){if(0!=t&&(e.first+=t,e.sel=new Ci(X(e.sel.ranges,(function(e){return new Ti(rt(e.anchor.line+t,e.anchor.ch),rt(e.head.line+t,e.head.ch))})),e.sel.primIndex),e.cm)){fn(e.cm,e.first,e.first-t,t);for(var r=e.cm.display,n=r.viewFrom;n<r.viewTo;n++)hn(e.cm,n,"gutter")}}function ha(e,t,r,n){if(e.cm&&!e.cm.curOp)return ti(e.cm,ha)(e,t,r,n);if(t.to.line<e.first)fa(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);fa(e,i),t={from:rt(e.first,0),to:rt(t.to.line+i,t.to.ch),text:[Q(t.text)],origin:t.origin}}var a=e.lastLine();t.to.line>a&&(t={from:t.from,to:rt(a,Ke(e,a).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Ge(e,t.from,t.to),r||(r=_i(e,t)),e.cm?function(e,t,r){var n=e.doc,i=e.display,a=t.from,o=t.to,l=!1,s=a.line;e.options.lineWrapping||(s=Ye(Wt(Ke(n,a.line))),n.iter(s,o.line+1,(function(e){if(e==i.maxLine)return l=!0,!0}))),n.sel.contains(t.from,t.to)>-1&&be(e),Ni(n,t,r,cn(e)),e.options.lineWrapping||(n.iter(s,a.line+t.text.length,(function(e){var t=Ut(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,l=!1)})),l&&(e.curOp.updateMaxLine=!0)),function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var r=e.first,n=t-1;n>r;n--){var i=Ke(e,n).stateAfter;if(i&&(!(i instanceof dt)||n+i.lookAhead<t)){r=n+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,r)}}(n,a.line),ii(e,400);var c=t.text.length-(o.line-a.line)-1;t.full?fn(e):a.line!=o.line||1!=t.text.length||Oi(e.doc,t)?fn(e,a.line,o.line+1,c):hn(e,a.line,"text");var u=ye(e,"changes"),d=ye(e,"change");if(d||u){var p={from:a,to:o,text:t.text,removed:t.removed,origin:t.origin};d&&cr(e,"change",e,p),u&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}(e.cm,t,n):Ni(e,t,n),ta(e,r,R)}}function ma(e,t,r,n,i){var a;n||(n=r),nt(n,r)<0&&(r=(a=[n,r])[0],n=a[1]),"string"==typeof t&&(t=e.splitLines(t)),ua(e,{from:r,to:n,text:t,origin:i})}function ga(e,t,r,n){r<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function va(e,t,r,n){for(var i=0;i<e.length;++i){var a=e[i],o=!0;if(a.ranges){a.copied||((a=e[i]=a.deepCopy()).copied=!0);for(var l=0;l<a.ranges.length;l++)ga(a.ranges[l].anchor,t,r,n),ga(a.ranges[l].head,t,r,n)}else{for(var s=0;s<a.changes.length;++s){var c=a.changes[s];if(r<c.from.line)c.from=rt(c.from.line+n,c.from.ch),c.to=rt(c.to.line+n,c.to.ch);else if(t<=c.to.line){o=!1;break}}o||(e.splice(0,i+1),i=0)}}}function ba(e,t){var r=t.from.line,n=t.to.line,i=t.text.length-(n-r)-1;va(e.done,r,n,i),va(e.undone,r,n,i)}function ya(e,t,r,n){var i=t,a=t;return"number"==typeof t?a=Ke(e,st(e,t)):i=Ye(t),null==i?null:(n(a,i)&&e.cm&&hn(e.cm,i,r),a)}function xa(e){this.lines=e,this.parent=null;for(var t=0,r=0;r<e.length;++r)e[r].parent=this,t+=e[r].height;this.height=t}function wa(e){this.children=e;for(var t=0,r=0,n=0;n<e.length;++n){var i=e[n];t+=i.chunkSize(),r+=i.height,i.parent=this}this.size=t,this.height=r,this.parent=null}Ti.prototype.from=function(){return lt(this.anchor,this.head)},Ti.prototype.to=function(){return ot(this.anchor,this.head)},Ti.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},xa.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var r=e,n=e+t;r<n;++r){var i=this.lines[r];this.height-=i.height,Gt(i),cr(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,r){this.height+=r,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,r){for(var n=e+t;e<n;++e)if(r(this.lines[e]))return!0}},wa.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var r=0;r<this.children.length;++r){var n=this.children[r],i=n.chunkSize();if(e<i){var a=Math.min(t,i-e),o=n.height;if(n.removeInner(e,a),this.height-=o-n.height,i==a&&(this.children.splice(r--,1),n.parent=null),0==(t-=a))break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof xa))){var l=[];this.collapse(l),this.children=[new xa(l)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,r){this.size+=t.length,this.height+=r;for(var n=0;n<this.children.length;++n){var i=this.children[n],a=i.chunkSize();if(e<=a){if(i.insertInner(e,t,r),i.lines&&i.lines.length>50){for(var o=i.lines.length%25+25,l=o;l<i.lines.length;){var s=new xa(i.lines.slice(l,l+=25));i.height-=s.height,this.children.splice(++n,0,s),s.parent=this}i.lines=i.lines.slice(0,o),this.maybeSpill()}break}e-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new wa(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var r=J(e.parent.children,e);e.parent.children.splice(r+1,0,t)}else{var n=new wa(e.children);n.parent=e,e.children=[n,t],e=n}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,r){for(var n=0;n<this.children.length;++n){var i=this.children[n],a=i.chunkSize();if(e<a){var o=Math.min(t,a-e);if(i.iterN(e,o,r))return!0;if(0==(t-=o))break;e=0}else e-=a}}};var Sa=function(e,t,r){if(r)for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n]);this.doc=e,this.node=t};function Ca(e,t,r){qt(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Pn(e,r)}Sa.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,r=this.line,n=Ye(r);if(null!=n&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(r.widgets=null);var a=Sr(this);Xe(r,Math.max(0,r.height-a)),e&&(ei(e,(function(){Ca(e,r,-a),hn(e,n,"widget")})),cr(e,"lineWidgetCleared",e,this,n))}},Sa.prototype.changed=function(){var e=this,t=this.height,r=this.doc.cm,n=this.line;this.height=null;var i=Sr(this)-t;i&&(zt(this.doc,n)||Xe(n,n.height+i),r&&ei(r,(function(){r.curOp.forceUpdate=!0,Ca(r,n,i),cr(r,"lineWidgetChanged",r,e,Ye(n))})))},xe(Sa);var Ta=0,ka=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++Ta};function Aa(e,t,r,n,i){if(n&&n.shared)return function(e,t,r,n,i){(n=H(n)).shared=!1;var a=[Aa(e,t,r,n,i)],o=a[0],l=n.widgetNode;return Di(e,(function(e){l&&(n.widgetNode=l.cloneNode(!0)),a.push(Aa(e,ct(e,t),ct(e,r),n,i));for(var s=0;s<e.linked.length;++s)if(e.linked[s].isParent)return;o=Q(a)})),new $a(a,o)}(e,t,r,n,i);if(e.cm&&!e.cm.curOp)return ti(e.cm,Aa)(e,t,r,n,i);var a=new ka(e,i),o=nt(t,r);if(n&&H(n,a,!1),o>0||0==o&&!1!==a.clearWhenEmpty)return a;if(a.replacedWith&&(a.collapsed=!0,a.widgetNode=M("span",[a.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||a.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(a.widgetNode.insertLeft=!0)),a.collapsed){if(Bt(e,t.line,t,r,a)||t.line!=r.line&&Bt(e,r.line,t,r,a))throw new Error("Inserting collapsed marker partially overlapping an existing one");Tt=!0}a.addToHistory&&Ji(e,{from:t,to:r,origin:"markText"},e.sel,NaN);var l,s=t.line,c=e.cm;if(e.iter(s,r.line+1,(function(e){c&&a.collapsed&&!c.options.lineWrapping&&Wt(e)==c.display.maxLine&&(l=!0),a.collapsed&&s!=t.line&&Xe(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new kt(a,s==t.line?t.ch:null,s==r.line?r.ch:null)),++s})),a.collapsed&&e.iter(t.line,r.line+1,(function(t){zt(e,t)&&Xe(t,0)})),a.clearOnEnter&&fe(a,"beforeCursorEnter",(function(){return a.clear()})),a.readOnly&&(Ct=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),a.collapsed&&(a.id=++Ta,a.atomic=!0),c){if(l&&(c.curOp.updateMaxLine=!0),a.collapsed)fn(c,t.line,r.line+1);else if(a.className||a.startStyle||a.endStyle||a.css||a.attributes||a.title)for(var u=t.line;u<=r.line;u++)hn(c,u,"text");a.atomic&&na(c.doc),cr(c,"markerAdded",c,a)}return a}ka.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Kn(e),ye(this,"clear")){var r=this.find();r&&cr(this,"clear",r.from,r.to)}for(var n=null,i=null,a=0;a<this.lines.length;++a){var o=this.lines[a],l=At(o.markedSpans,this);e&&!this.collapsed?hn(e,Ye(o),"text"):e&&(null!=l.to&&(i=Ye(o)),null!=l.from&&(n=Ye(o))),o.markedSpans=$t(o.markedSpans,l),null==l.from&&this.collapsed&&!zt(this.doc,o)&&e&&Xe(o,an(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var c=Wt(this.lines[s]),u=Ut(c);u>e.display.maxLineLength&&(e.display.maxLine=c,e.display.maxLineLength=u,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&fn(e,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&na(e.doc)),e&&cr(e,"markerCleared",e,this,n,i),t&&Gn(e),this.parent&&this.parent.clear()}},ka.prototype.find=function(e,t){var r,n;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var a=this.lines[i],o=At(a.markedSpans,this);if(null!=o.from&&(r=rt(t?a:Ye(a),o.from),-1==e))return r;if(null!=o.to&&(n=rt(t?a:Ye(a),o.to),1==e))return n}return r&&{from:r,to:n}},ka.prototype.changed=function(){var e=this,t=this.find(-1,!0),r=this,n=this.doc.cm;t&&n&&ei(n,(function(){var i=t.line,a=Ye(t.line),o=Pr(n,a);if(o&&(Br(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!zt(r.doc,i)&&null!=r.height){var l=r.height;r.height=null;var s=Sr(r)-l;s&&Xe(i,i.height+s)}cr(n,"markerChanged",n,e)}))},ka.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=J(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ka.prototype.detachLine=function(e){if(this.lines.splice(J(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},xe(ka);var $a=function(e,t){this.markers=e,this.primary=t;for(var r=0;r<e.length;++r)e[r].parent=this};function La(e){return e.findMarks(rt(e.first,0),e.clipPos(rt(e.lastLine())),(function(e){return e.parent}))}function _a(e){for(var t=function(t){var r=e[t],n=[r.primary.doc];Di(r.primary.doc,(function(e){return n.push(e)}));for(var i=0;i<r.markers.length;i++){var a=r.markers[i];-1==J(n,a.doc)&&(a.parent=null,r.markers.splice(i--,1))}},r=0;r<e.length;r++)t(r)}$a.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();cr(this,"clear")}},$a.prototype.find=function(e,t){return this.primary.find(e,t)},xe($a);var Ia=0,Ma=function e(t,r,n,i,a){if(!(this instanceof e))return new e(t,r,n,i,a);null==n&&(n=0),wa.call(this,[new xa([new Kt("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var o=rt(n,0);this.sel=Ai(o),this.history=new Hi(null),this.id=++Ia,this.modeOption=r,this.lineSep=i,this.direction="rtl"==a?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),Ni(this,{from:o,to:o,text:t}),ea(this,Ai(o),R)};Ma.prototype=Z(wa.prototype,{constructor:Ma,iter:function(e,t,r){r?this.iterN(e-this.first,t-e,r):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var r=0,n=0;n<t.length;++n)r+=t[n].height;this.insertInner(e-this.first,t,r)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Qe(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:ni((function(e){var t=rt(this.first,0),r=this.first+this.size-1;ua(this,{from:t,to:rt(r,Ke(this,r).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Nn(this.cm,0,0),ea(this,Ai(t),R)})),replaceRange:function(e,t,r,n){ma(this,e,t=ct(this,t),r=r?ct(this,r):t,n)},getRange:function(e,t,r){var n=Ge(this,ct(this,e),ct(this,t));return!1===r?n:n.join(r||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(et(this,e))return Ke(this,e)},getLineNumber:function(e){return Ye(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Ke(this,e)),Wt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return ct(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ni((function(e,t,r){Yi(this,ct(this,"number"==typeof e?rt(e,t||0):e),null,r)})),setSelection:ni((function(e,t,r){Yi(this,ct(this,e),ct(this,t||e),r)})),extendSelection:ni((function(e,t,r){Gi(this,ct(this,e),t&&ct(this,t),r)})),extendSelections:ni((function(e,t){Qi(this,ut(this,e),t)})),extendSelectionsBy:ni((function(e,t){Qi(this,ut(this,X(this.sel.ranges,e)),t)})),setSelections:ni((function(e,t,r){if(e.length){for(var n=[],i=0;i<e.length;i++)n[i]=new Ti(ct(this,e[i].anchor),ct(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),ea(this,ki(this.cm,n,t),r)}})),addSelection:ni((function(e,t,r){var n=this.sel.ranges.slice(0);n.push(new Ti(ct(this,e),ct(this,t||e))),ea(this,ki(this.cm,n,n.length-1),r)})),getSelection:function(e){for(var t,r=this.sel.ranges,n=0;n<r.length;n++){var i=Ge(this,r[n].from(),r[n].to());t=t?t.concat(i):i}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],r=this.sel.ranges,n=0;n<r.length;n++){var i=Ge(this,r[n].from(),r[n].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[n]=i}return t},replaceSelection:function(e,t,r){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=e;this.replaceSelections(n,t,r||"+input")},replaceSelections:ni((function(e,t,r){for(var n=[],i=this.sel,a=0;a<i.ranges.length;a++){var o=i.ranges[a];n[a]={from:o.from(),to:o.to(),text:this.splitLines(e[a]),origin:r}}for(var l=t&&"end"!=t&&function(e,t,r){for(var n=[],i=rt(e.first,0),a=i,o=0;o<t.length;o++){var l=t[o],s=Ii(l.from,i,a),c=Ii($i(l),i,a);if(i=l.to,a=c,"around"==r){var u=e.sel.ranges[o],d=nt(u.head,u.anchor)<0;n[o]=new Ti(d?c:s,d?s:c)}else n[o]=new Ti(s,s)}return new Ci(n,e.sel.primIndex)}(this,n,t),s=n.length-1;s>=0;s--)ua(this,n[s]);l?Zi(this,l):this.cm&&On(this.cm)})),undo:ni((function(){pa(this,"undo")})),redo:ni((function(){pa(this,"redo")})),undoSelection:ni((function(){pa(this,"undo",!0)})),redoSelection:ni((function(){pa(this,"redo",!0)})),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,r=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++r;return{undo:t,redo:r}},clearHistory:function(){this.history=new Hi(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Vi(this.history.done),undone:Vi(this.history.undone)}},setHistory:function(e){var t=this.history=new Hi(this.history.maxGeneration);t.done=Vi(e.done.slice(0),null,!0),t.undone=Vi(e.undone.slice(0),null,!0)},setGutterMarker:ni((function(e,t,r){return ya(this,e,"gutter",(function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=r,!r&&ne(n)&&(e.gutterMarkers=null),!0}))})),clearGutter:ni((function(e){var t=this;this.iter((function(r){r.gutterMarkers&&r.gutterMarkers[e]&&ya(t,r,"gutter",(function(){return r.gutterMarkers[e]=null,ne(r.gutterMarkers)&&(r.gutterMarkers=null),!0}))}))})),lineInfo:function(e){var t;if("number"==typeof e){if(!et(this,e))return null;if(t=e,!(e=Ke(this,e)))return null}else if(null==(t=Ye(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:ni((function(e,t,r){return ya(this,e,"gutter"==t?"gutter":"class",(function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(k(r).test(e[n]))return!1;e[n]+=" "+r}else e[n]=r;return!0}))})),removeLineClass:ni((function(e,t,r){return ya(this,e,"gutter"==t?"gutter":"class",(function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",i=e[n];if(!i)return!1;if(null==r)e[n]=null;else{var a=i.match(k(r));if(!a)return!1;var o=a.index+a[0].length;e[n]=i.slice(0,a.index)+(a.index&&o!=i.length?" ":"")+i.slice(o)||null}return!0}))})),addLineWidget:ni((function(e,t,r){return function(e,t,r,n){var i=new Sa(e,r,n),a=e.cm;return a&&i.noHScroll&&(a.display.alignWidgets=!0),ya(e,t,"widget",(function(t){var r=t.widgets||(t.widgets=[]);if(null==i.insertAt?r.push(i):r.splice(Math.min(r.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,a&&!zt(e,t)){var n=qt(t)<e.scrollTop;Xe(t,t.height+Sr(i)),n&&Pn(a,i.height),a.curOp.forceUpdate=!0}return!0})),a&&cr(a,"lineWidgetAdded",a,i,"number"==typeof t?t:Ye(t)),i}(this,e,t,r)})),removeLineWidget:function(e){e.clear()},markText:function(e,t,r){return Aa(this,ct(this,e),ct(this,t),r,r&&r.type||"range")},setBookmark:function(e,t){var r={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return Aa(this,e=ct(this,e),e,r,"bookmark")},findMarksAt:function(e){var t=[],r=Ke(this,(e=ct(this,e)).line).markedSpans;if(r)for(var n=0;n<r.length;++n){var i=r[n];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,r){e=ct(this,e),t=ct(this,t);var n=[],i=e.line;return this.iter(e.line,t.line+1,(function(a){var o=a.markedSpans;if(o)for(var l=0;l<o.length;l++){var s=o[l];null!=s.to&&i==e.line&&e.ch>=s.to||null==s.from&&i!=e.line||null!=s.from&&i==t.line&&s.from>=t.ch||r&&!r(s.marker)||n.push(s.marker.parent||s.marker)}++i})),n},getAllMarks:function(){var e=[];return this.iter((function(t){var r=t.markedSpans;if(r)for(var n=0;n<r.length;++n)null!=r[n].from&&e.push(r[n].marker)})),e},posFromIndex:function(e){var t,r=this.first,n=this.lineSeparator().length;return this.iter((function(i){var a=i.text.length+n;if(a>e)return t=e,!0;e-=a,++r})),ct(this,rt(r,t))},indexFromPos:function(e){var t=(e=ct(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var r=this.lineSeparator().length;return this.iter(this.first,e.line,(function(e){t+=e.text.length+r})),t},copy:function(e){var t=new Ma(Qe(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,r=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<r&&(r=e.to);var n=new Ma(Qe(this,t,r),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.find(),a=e.clipPos(i.from),o=e.clipPos(i.to);if(nt(a,o)){var l=Aa(e,a,o,n.primary,n.primary.type);n.markers.push(l),l.parent=n}}}(n,La(this)),n},unlinkDoc:function(e){if(e instanceof Lo&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),_a(La(this));break}if(e.history==this.history){var r=[e.id];Di(e,(function(e){return r.push(e.id)}),!0),e.history=new Hi(null),e.history.done=Vi(this.history.done,r),e.history.undone=Vi(this.history.undone,r)}},iterLinkedDocs:function(e){Di(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Oe(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:ni((function(e){var t;"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter((function(e){return e.order=null})),this.cm&&ei(t=this.cm,(function(){Ei(t),fn(t)})))}))}),Ma.prototype.eachLine=Ma.prototype.iter;var Pa=0;function Oa(e){var t=this;if(Na(t),!ve(t,e)&&!Cr(t.display,e)){we(e),l&&(Pa=+new Date);var r=dn(t,e,!0),n=e.dataTransfer.files;if(r&&!t.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,a=Array(i),o=0,s=function(e,n){if(!t.options.allowDropFileTypes||-1!=J(t.options.allowDropFileTypes,e.type)){var l=new FileReader;l.onload=ti(t,(function(){var e=l.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),a[n]=e,++o==i){var s={from:r=ct(t.doc,r),to:r,text:t.doc.splitLines(a.join(t.doc.lineSeparator())),origin:"paste"};ua(t.doc,s),Zi(t.doc,Ai(r,$i(s)))}})),l.readAsText(e)}},c=0;c<i;++c)s(n[c],c);else{if(t.state.draggingText&&t.doc.sel.contains(r)>-1)return t.state.draggingText(e),void setTimeout((function(){return t.display.input.focus()}),20);try{var u=e.dataTransfer.getData("Text");if(u){var d;if(t.state.draggingText&&!t.state.draggingText.copy&&(d=t.listSelections()),ta(t.doc,Ai(r,r)),d)for(var p=0;p<d.length;++p)ma(t.doc,"",d[p].anchor,d[p].head,"drag");t.replaceSelection(u,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Na(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Da(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),r=[],n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&r.push(i)}r.length&&r[0].operation((function(){for(var t=0;t<r.length;t++)e(r[t])}))}}var Fa=!1;function Ea(){var e;Fa||(fe(window,"resize",(function(){null==e&&(e=setTimeout((function(){e=null,Da(Ha)}),100))})),fe(window,"blur",(function(){return Da($n)})),Fa=!0)}function Ha(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Ba={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Wa=0;Wa<10;Wa++)Ba[Wa+48]=Ba[Wa+96]=String(Wa);for(var Ja=65;Ja<=90;Ja++)Ba[Ja]=String.fromCharCode(Ja);for(var ja=1;ja<=12;ja++)Ba[ja+111]=Ba[ja+63235]="F"+ja;var za={};function Ra(e){var t,r,n,i,a=e.split(/-(?!$)/);e=a[a.length-1];for(var o=0;o<a.length-1;o++){var l=a[o];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else{if(!/^s(hift)?$/i.test(l))throw new Error("Unrecognized modifier name: "+l);n=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function qa(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if("..."==n){delete e[r];continue}for(var i=X(r.split(" "),Ra),a=0;a<i.length;a++){var o=void 0,l=void 0;a==i.length-1?(l=i.join(" "),o=n):(l=i.slice(0,a+1).join(" "),o="...");var s=t[l];if(s){if(s!=o)throw new Error("Inconsistent bindings for "+l)}else t[l]=o}delete e[r]}for(var c in t)e[c]=t[c];return e}function Ua(e,t,r,n){var i=(t=Qa(t)).call?t.call(e,n):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&r(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Ua(e,t.fallthrough,r,n);for(var a=0;a<t.fallthrough.length;a++){var o=Ua(e,t.fallthrough[a],r,n);if(o)return o}}}function Va(e){var t="string"==typeof e?e:Ba[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Ka(e,t,r){var n=e;return t.altKey&&"Alt"!=n&&(e="Alt-"+e),(C?t.metaKey:t.ctrlKey)&&"Ctrl"!=n&&(e="Ctrl-"+e),(C?t.ctrlKey:t.metaKey)&&"Cmd"!=n&&(e="Cmd-"+e),!r&&t.shiftKey&&"Shift"!=n&&(e="Shift-"+e),e}function Ga(e,t){if(p&&34==e.keyCode&&e.char)return!1;var r=Ba[e.keyCode];return null!=r&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(r=e.code),Ka(r,e,t))}function Qa(e){return"string"==typeof e?za[e]:e}function Xa(e,t){for(var r=e.doc.sel.ranges,n=[],i=0;i<r.length;i++){for(var a=t(r[i]);n.length&&nt(a.from,Q(n).to)<=0;){var o=n.pop();if(nt(o.from,a.from)<0){a.from=o.from;break}}n.push(a)}ei(e,(function(){for(var t=n.length-1;t>=0;t--)ma(e.doc,"",n[t].from,n[t].to,"+delete");On(e)}))}function Ya(e,t,r){var n=oe(e.text,t+r,r);return n<0||n>e.text.length?null:n}function Za(e,t,r){var n=Ya(e,t.ch,r);return null==n?null:new rt(t.line,n,r<0?"after":"before")}function eo(e,t,r,n,i){if(e){var a=de(r,t.doc.direction);if(a){var o,l=i<0?Q(a):a[0],s=i<0==(1==l.level)?"after":"before";if(l.level>0||"rtl"==t.doc.direction){var c=Or(t,r);o=i<0?r.text.length-1:0;var u=Nr(t,c,o).top;o=le((function(e){return Nr(t,c,e).top==u}),i<0==(1==l.level)?l.from:l.to-1,o),"before"==s&&(o=Ya(r,o,1))}else o=i<0?l.to:l.from;return new rt(n,o,s)}}return new rt(n,i<0?r.text.length:0,i<0?"before":"after")}za.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},za.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},za.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},za.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},za.default=y?za.macDefault:za.pcDefault;var to={selectAll:sa,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),R)},killLine:function(e){return Xa(e,(function(t){if(t.empty()){var r=Ke(e.doc,t.head.line).text.length;return t.head.ch==r&&t.head.line<e.lastLine()?{from:t.head,to:rt(t.head.line+1,0)}:{from:t.head,to:rt(t.head.line,r)}}return{from:t.from(),to:t.to()}}))},deleteLine:function(e){return Xa(e,(function(t){return{from:rt(t.from().line,0),to:ct(e.doc,rt(t.to().line+1,0))}}))},delLineLeft:function(e){return Xa(e,(function(e){return{from:rt(e.from().line,0),to:e.from()}}))},delWrappedLineLeft:function(e){return Xa(e,(function(t){var r=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:r},"div"),to:t.from()}}))},delWrappedLineRight:function(e){return Xa(e,(function(t){var r=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div");return{from:t.from(),to:n}}))},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(rt(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(rt(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy((function(t){return ro(e,t.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy((function(t){return no(e,t.head)}),{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy((function(t){return function(e,t){var r=Ke(e.doc,t),n=function(e){for(var t;t=Et(e);)e=t.find(1,!0).line;return e}(r);return n!=r&&(t=Ye(n)),eo(!0,e,r,t,-1)}(e,t.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:r},"div")}),U)},goLineLeft:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:r},"div")}),U)},goLineLeftSmart:function(e){return e.extendSelectionsBy((function(t){var r=e.cursorCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:r},"div");return n.ch<e.getLine(n.line).search(/\S/)?no(e,t.head):n}),U)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],r=e.listSelections(),n=e.options.tabSize,i=0;i<r.length;i++){var a=r[i].from(),o=B(e.getLine(a.line),a.ch,n);t.push(G(n-o%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return ei(e,(function(){for(var t=e.listSelections(),r=[],n=0;n<t.length;n++)if(t[n].empty()){var i=t[n].head,a=Ke(e.doc,i.line).text;if(a)if(i.ch==a.length&&(i=new rt(i.line,i.ch-1)),i.ch>0)i=new rt(i.line,i.ch+1),e.replaceRange(a.charAt(i.ch-1)+a.charAt(i.ch-2),rt(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var o=Ke(e.doc,i.line-1).text;o&&(i=new rt(i.line,1),e.replaceRange(a.charAt(0)+e.doc.lineSeparator()+o.charAt(o.length-1),rt(i.line-1,o.length-1),i,"+transpose"))}r.push(new Ti(i,i))}e.setSelections(r)}))},newlineAndIndent:function(e){return ei(e,(function(){for(var t=e.listSelections(),r=t.length-1;r>=0;r--)e.replaceRange(e.doc.lineSeparator(),t[r].anchor,t[r].head,"+input");t=e.listSelections();for(var n=0;n<t.length;n++)e.indentLine(t[n].from().line,null,!0);On(e)}))},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function ro(e,t){var r=Ke(e.doc,t),n=Wt(r);return n!=r&&(t=Ye(n)),eo(!0,e,n,t,1)}function no(e,t){var r=ro(e,t.line),n=Ke(e.doc,r.line),i=de(n,e.doc.direction);if(!i||0==i[0].level){var a=Math.max(0,n.text.search(/\S/)),o=t.line==r.line&&t.ch<=a&&t.ch;return rt(r.line,o?0:a,r.sticky)}return r}function io(e,t,r){if("string"==typeof t&&!(t=to[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),r&&(e.display.shift=!1),i=t(e)!=z}finally{e.display.shift=n,e.state.suppressEdits=!1}return i}var ao=new W;function oo(e,t,r,n){var i=e.state.keySeq;if(i){if(Va(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:ao.set(50,(function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())})),lo(e,i+" "+t,r,n))return!0}return lo(e,t,r,n)}function lo(e,t,r,n){var i=function(e,t,r){for(var n=0;n<e.state.keyMaps.length;n++){var i=Ua(t,e.state.keyMaps[n],r,e);if(i)return i}return e.options.extraKeys&&Ua(t,e.options.extraKeys,r,e)||Ua(t,e.options.keyMap,r,e)}(e,t,n);return"multi"==i&&(e.state.keySeq=t),"handled"==i&&cr(e,"keyHandled",e,t,r),"handled"!=i&&"multi"!=i||(we(r),Cn(e)),!!i}function so(e,t){var r=Ga(t,!0);return!!r&&(t.shiftKey&&!e.state.keySeq?oo(e,"Shift-"+r,t,(function(t){return io(e,t,!0)}))||oo(e,r,t,(function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return io(e,t)})):oo(e,r,t,(function(t){return io(e,t)})))}var co=null;function uo(e){var t=this;if(t.curOp.focus=O(),!ve(t,e)){l&&s<11&&27==e.keyCode&&(e.returnValue=!1);var r=e.keyCode;t.display.shift=16==r||e.shiftKey;var n=so(t,e);p&&(co=n?r:null,!n&&88==r&&!De&&(y?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=r||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){var t=e.display.lineDiv;function r(e){18!=e.keyCode&&e.altKey||($(t,"CodeMirror-crosshair"),me(document,"keyup",r),me(document,"mouseover",r))}N(t,"CodeMirror-crosshair"),fe(document,"keyup",r),fe(document,"mouseover",r)}(t)}}function po(e){16==e.keyCode&&(this.doc.sel.shift=!1),ve(this,e)}function fo(e){var t=this;if(!(Cr(t.display,e)||ve(t,e)||e.ctrlKey&&!e.altKey||y&&e.metaKey)){var r=e.keyCode,n=e.charCode;if(p&&r==co)return co=null,void we(e);if(!p||e.which&&!(e.which<10)||!so(t,e)){var i=String.fromCharCode(null==n?r:n);"\b"!=i&&(function(e,t,r){return oo(e,"'"+r+"'",t,(function(t){return io(e,t,!0)}))}(t,e,i)||t.display.input.onKeyPress(e))}}}var ho,mo,go=function(e,t,r){this.time=e,this.pos=t,this.button=r};function vo(e){var t=this,r=t.display;if(!(ve(t,e)||r.activeTouch&&r.input.supportsTouch()))if(r.input.ensurePolled(),r.shift=e.shiftKey,Cr(r,e))c||(r.scroller.draggable=!1,setTimeout((function(){return r.scroller.draggable=!0}),100));else if(!xo(t,e)){var n=dn(t,e),i=Ae(e),a=n?function(e,t){var r=+new Date;return mo&&mo.compare(r,e,t)?(ho=mo=null,"triple"):ho&&ho.compare(r,e,t)?(mo=new go(r,e,t),ho=null,"double"):(ho=new go(r,e,t),mo=null,"single")}(n,i):"single";window.focus(),1==i&&t.state.selectingText&&t.state.selectingText(e),n&&function(e,t,r,n,i){var a="Click";return"double"==n?a="Double"+a:"triple"==n&&(a="Triple"+a),oo(e,Ka(a=(1==t?"Left":2==t?"Middle":"Right")+a,i),i,(function(t){if("string"==typeof t&&(t=to[t]),!t)return!1;var n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n=t(e,r)!=z}finally{e.state.suppressEdits=!1}return n}))}(t,i,n,a,e)||(1==i?n?function(e,t,r,n){l?setTimeout(E(Tn,e),0):e.curOp.focus=O();var i,a=function(e,t,r){var n=e.getOption("configureMouse"),i=n?n(e,t,r):{};if(null==i.unit){var a=x?r.shiftKey&&r.metaKey:r.altKey;i.unit=a?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==i.extend||e.doc.extend)&&(i.extend=e.doc.extend||r.shiftKey),null==i.addNew&&(i.addNew=y?r.metaKey:r.ctrlKey),null==i.moveOnDrag&&(i.moveOnDrag=!(y?r.altKey:r.ctrlKey)),i}(e,r,n),o=e.doc.sel;e.options.dragDrop&&_e&&!e.isReadOnly()&&"single"==r&&(i=o.contains(t))>-1&&(nt((i=o.ranges[i]).from(),t)<0||t.xRel>0)&&(nt(i.to(),t)>0||t.xRel<0)?function(e,t,r,n){var i=e.display,a=!1,o=ti(e,(function(t){c&&(i.scroller.draggable=!1),e.state.draggingText=!1,me(i.wrapper.ownerDocument,"mouseup",o),me(i.wrapper.ownerDocument,"mousemove",u),me(i.scroller,"dragstart",d),me(i.scroller,"drop",o),a||(we(t),n.addNew||Gi(e.doc,r,null,null,n.extend),c||l&&9==s?setTimeout((function(){i.wrapper.ownerDocument.body.focus(),i.input.focus()}),20):i.input.focus())})),u=function(e){a=a||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},d=function(){return a=!0};c&&(i.scroller.draggable=!0),e.state.draggingText=o,o.copy=!n.moveOnDrag,i.scroller.dragDrop&&i.scroller.dragDrop(),fe(i.wrapper.ownerDocument,"mouseup",o),fe(i.wrapper.ownerDocument,"mousemove",u),fe(i.scroller,"dragstart",d),fe(i.scroller,"drop",o),kn(e),setTimeout((function(){return i.input.focus()}),20)}(e,n,t,a):function(e,t,r,n){var i=e.display,a=e.doc;we(t);var o,l,s=a.sel,c=s.ranges;if(n.addNew&&!n.extend?(l=a.sel.contains(r),o=l>-1?c[l]:new Ti(r,r)):(o=a.sel.primary(),l=a.sel.primIndex),"rectangle"==n.unit)n.addNew||(o=new Ti(r,r)),r=dn(e,t,!0,!0),l=-1;else{var u=bo(e,r,n.unit);o=n.extend?Ki(o,u.anchor,u.head,n.extend):u}n.addNew?-1==l?(l=c.length,ea(a,ki(e,c.concat([o]),l),{scroll:!1,origin:"*mouse"})):c.length>1&&c[l].empty()&&"char"==n.unit&&!n.extend?(ea(a,ki(e,c.slice(0,l).concat(c.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),s=a.sel):Xi(a,l,o,q):(l=0,ea(a,new Ci([o],0),q),s=a.sel);var d=r;function p(t){if(0!=nt(d,t))if(d=t,"rectangle"==n.unit){for(var i=[],c=e.options.tabSize,u=B(Ke(a,r.line).text,r.ch,c),p=B(Ke(a,t.line).text,t.ch,c),f=Math.min(u,p),h=Math.max(u,p),m=Math.min(r.line,t.line),g=Math.min(e.lastLine(),Math.max(r.line,t.line));m<=g;m++){var v=Ke(a,m).text,b=V(v,f,c);f==h?i.push(new Ti(rt(m,b),rt(m,b))):v.length>b&&i.push(new Ti(rt(m,b),rt(m,V(v,h,c))))}i.length||i.push(new Ti(r,r)),ea(a,ki(e,s.ranges.slice(0,l).concat(i),l),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y,x=o,w=bo(e,t,n.unit),S=x.anchor;nt(w.anchor,S)>0?(y=w.head,S=lt(x.from(),w.anchor)):(y=w.anchor,S=ot(x.to(),w.head));var C=s.ranges.slice(0);C[l]=function(e,t){var r=t.anchor,n=t.head,i=Ke(e.doc,r.line);if(0==nt(r,n)&&r.sticky==n.sticky)return t;var a=de(i);if(!a)return t;var o=ce(a,r.ch,r.sticky),l=a[o];if(l.from!=r.ch&&l.to!=r.ch)return t;var s,c=o+(l.from==r.ch==(1!=l.level)?0:1);if(0==c||c==a.length)return t;if(n.line!=r.line)s=(n.line-r.line)*("ltr"==e.doc.direction?1:-1)>0;else{var u=ce(a,n.ch,n.sticky),d=u-o||(n.ch-r.ch)*(1==l.level?-1:1);s=u==c-1||u==c?d<0:d>0}var p=a[c+(s?-1:0)],f=s==(1==p.level),h=f?p.from:p.to,m=f?"after":"before";return r.ch==h&&r.sticky==m?t:new Ti(new rt(r.line,h,m),n)}(e,new Ti(ct(a,S),y)),ea(a,ki(e,C,l),q)}}var f=i.wrapper.getBoundingClientRect(),h=0;function m(t){e.state.selectingText=!1,h=1/0,t&&(we(t),i.input.focus()),me(i.wrapper.ownerDocument,"mousemove",g),me(i.wrapper.ownerDocument,"mouseup",v),a.history.lastSelOrigin=null}var g=ti(e,(function(t){0!==t.buttons&&Ae(t)?function t(r){var o=++h,l=dn(e,r,!0,"rectangle"==n.unit);if(l)if(0!=nt(l,d)){e.curOp.focus=O(),p(l);var s=In(i,a);(l.line>=s.to||l.line<s.from)&&setTimeout(ti(e,(function(){h==o&&t(r)})),150)}else{var c=r.clientY<f.top?-20:r.clientY>f.bottom?20:0;c&&setTimeout(ti(e,(function(){h==o&&(i.scroller.scrollTop+=c,t(r))})),50)}}(t):m(t)})),v=ti(e,m);e.state.selectingText=v,fe(i.wrapper.ownerDocument,"mousemove",g),fe(i.wrapper.ownerDocument,"mouseup",v)}(e,n,t,a)}(t,n,a,e):ke(e)==r.scroller&&we(e):2==i?(n&&Gi(t.doc,n),setTimeout((function(){return r.input.focus()}),20)):3==i&&(T?t.display.input.onContextMenu(e):kn(t)))}}function bo(e,t,r){if("char"==r)return new Ti(t,t);if("word"==r)return e.findWordAt(t);if("line"==r)return new Ti(rt(t.line,0),ct(e.doc,rt(t.line+1,0)));var n=r(e,t);return new Ti(n.from,n.to)}function yo(e,t,r,n){var i,a;if(t.touches)i=t.touches[0].clientX,a=t.touches[0].clientY;else try{i=t.clientX,a=t.clientY}catch(t){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&we(t);var o=e.display,l=o.lineDiv.getBoundingClientRect();if(a>l.bottom||!ye(e,r))return Ce(t);a-=l.top-o.viewOffset;for(var s=0;s<e.display.gutterSpecs.length;++s){var c=o.gutters.childNodes[s];if(c&&c.getBoundingClientRect().right>=i)return ge(e,r,e,Ze(e.doc,a),e.display.gutterSpecs[s].className,t),Ce(t)}}function xo(e,t){return yo(e,t,"gutterClick",!0)}function wo(e,t){Cr(e.display,t)||function(e,t){return!!ye(e,"gutterContextMenu")&&yo(e,t,"gutterContextMenu",!1)}(e,t)||ve(e,t,"contextmenu")||T||e.display.input.onContextMenu(t)}function So(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Jr(e)}go.prototype.compare=function(e,t,r){return this.time+400>e&&0==nt(t,this.pos)&&r==this.button};var Co={toString:function(){return"CodeMirror.Init"}},To={},ko={};function Ao(e,t,r){if(!t!=!(r&&r!=Co)){var n=e.display.dragFunctions,i=t?fe:me;i(e.display.scroller,"dragstart",n.start),i(e.display.scroller,"dragenter",n.enter),i(e.display.scroller,"dragover",n.over),i(e.display.scroller,"dragleave",n.leave),i(e.display.scroller,"drop",n.drop)}}function $o(e){e.options.lineWrapping?(N(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):($(e.display.wrapper,"CodeMirror-wrap"),Vt(e)),un(e),fn(e),Jr(e),setTimeout((function(){return zn(e)}),100)}function Lo(e,t){var r=this;if(!(this instanceof Lo))return new Lo(e,t);this.options=t=t?H(t):{},H(To,t,!1);var n=t.value;"string"==typeof n?n=new Ma(n,t.mode,null,t.lineSeparator,t.direction):t.mode&&(n.modeOption=t.mode),this.doc=n;var i=new Lo.inputStyles[t.inputStyle](this),a=this.display=new vi(e,n,i,t);for(var o in a.wrapper.CodeMirror=this,So(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Un(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new W,keySeq:null,specialChars:null},t.autofocus&&!b&&a.input.focus(),l&&s<11&&setTimeout((function(){return r.display.input.reset(!0)}),20),function(e){var t=e.display;fe(t.scroller,"mousedown",ti(e,vo)),fe(t.scroller,"dblclick",l&&s<11?ti(e,(function(t){if(!ve(e,t)){var r=dn(e,t);if(r&&!xo(e,t)&&!Cr(e.display,t)){we(t);var n=e.findWordAt(r);Gi(e.doc,n.anchor,n.head)}}})):function(t){return ve(e,t)||we(t)}),fe(t.scroller,"contextmenu",(function(t){return wo(e,t)}));var r,n={end:0};function i(){t.activeTouch&&(r=setTimeout((function(){return t.activeTouch=null}),1e3),(n=t.activeTouch).end=+new Date)}function a(e,t){if(null==t.left)return!0;var r=t.left-e.left,n=t.top-e.top;return r*r+n*n>400}fe(t.scroller,"touchstart",(function(i){if(!ve(e,i)&&!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(i)&&!xo(e,i)){t.input.ensurePolled(),clearTimeout(r);var a=+new Date;t.activeTouch={start:a,moved:!1,prev:a-n.end<=300?n:null},1==i.touches.length&&(t.activeTouch.left=i.touches[0].pageX,t.activeTouch.top=i.touches[0].pageY)}})),fe(t.scroller,"touchmove",(function(){t.activeTouch&&(t.activeTouch.moved=!0)})),fe(t.scroller,"touchend",(function(r){var n=t.activeTouch;if(n&&!Cr(t,r)&&null!=n.left&&!n.moved&&new Date-n.start<300){var o,l=e.coordsChar(t.activeTouch,"page");o=!n.prev||a(n,n.prev)?new Ti(l,l):!n.prev.prev||a(n,n.prev.prev)?e.findWordAt(l):new Ti(rt(l.line,0),ct(e.doc,rt(l.line+1,0))),e.setSelection(o.anchor,o.head),e.focus(),we(r)}i()})),fe(t.scroller,"touchcancel",i),fe(t.scroller,"scroll",(function(){t.scroller.clientHeight&&(En(e,t.scroller.scrollTop),Bn(e,t.scroller.scrollLeft,!0),ge(e,"scroll",e))})),fe(t.scroller,"mousewheel",(function(t){return Si(e,t)})),fe(t.scroller,"DOMMouseScroll",(function(t){return Si(e,t)})),fe(t.wrapper,"scroll",(function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0})),t.dragFunctions={enter:function(t){ve(e,t)||Te(t)},over:function(t){ve(e,t)||(function(e,t){var r=dn(e,t);if(r){var n=document.createDocumentFragment();xn(e,r,n),e.display.dragCursor||(e.display.dragCursor=I("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),_(e.display.dragCursor,n)}}(e,t),Te(t))},start:function(t){return function(e,t){if(l&&(!e.state.draggingText||+new Date-Pa<100))Te(t);else if(!ve(e,t)&&!Cr(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!f)){var r=I("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",p&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),p&&r.parentNode.removeChild(r)}}(e,t)},drop:ti(e,Oa),leave:function(t){ve(e,t)||Na(e)}};var o=t.input.getField();fe(o,"keyup",(function(t){return po.call(e,t)})),fe(o,"keydown",ti(e,uo)),fe(o,"keypress",ti(e,fo)),fe(o,"focus",(function(t){return An(e,t)})),fe(o,"blur",(function(t){return $n(e,t)}))}(this),Ea(),Kn(this),this.curOp.forceUpdate=!0,Fi(this,n),t.autofocus&&!b||this.hasFocus()?setTimeout(E(An,this),20):$n(this),ko)ko.hasOwnProperty(o)&&ko[o](r,t[o],Co);fi(this),t.finishInit&&t.finishInit(this);for(var u=0;u<_o.length;++u)_o[u](r);Gn(this),c&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}Lo.defaults=To,Lo.optionHandlers=ko;var _o=[];function Io(e,t,r,n){var i,a=e.doc;null==r&&(r="add"),"smart"==r&&(a.mode.indent?i=mt(e,t).state:r="prev");var o=e.options.tabSize,l=Ke(a,t),s=B(l.text,null,o);l.stateAfter&&(l.stateAfter=null);var c,u=l.text.match(/^\s*/)[0];if(n||/\S/.test(l.text)){if("smart"==r&&((c=a.mode.indent(i,l.text.slice(u.length),l.text))==z||c>150)){if(!n)return;r="prev"}}else c=0,r="not";"prev"==r?c=t>a.first?B(Ke(a,t-1).text,null,o):0:"add"==r?c=s+e.options.indentUnit:"subtract"==r?c=s-e.options.indentUnit:"number"==typeof r&&(c=s+r),c=Math.max(0,c);var d="",p=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/o);f;--f)p+=o,d+="\t";if(p<c&&(d+=G(c-p)),d!=u)return ma(a,d,rt(t,0),rt(t,u.length),"+input"),l.stateAfter=null,!0;for(var h=0;h<a.sel.ranges.length;h++){var m=a.sel.ranges[h];if(m.head.line==t&&m.head.ch<u.length){var g=rt(t,u.length);Xi(a,h,new Ti(g,g));break}}}Lo.defineInitHook=function(e){return _o.push(e)};var Mo=null;function Po(e){Mo=e}function Oo(e,t,r,n,i){var a=e.doc;e.display.shift=!1,n||(n=a.sel);var o=+new Date-200,l="paste"==i||e.state.pasteIncoming>o,s=Oe(t),c=null;if(l&&n.ranges.length>1)if(Mo&&Mo.text.join("\n")==t){if(n.ranges.length%Mo.text.length==0){c=[];for(var u=0;u<Mo.text.length;u++)c.push(a.splitLines(Mo.text[u]))}}else s.length==n.ranges.length&&e.options.pasteLinesPerSelection&&(c=X(s,(function(e){return[e]})));for(var d=e.curOp.updateInput,p=n.ranges.length-1;p>=0;p--){var f=n.ranges[p],h=f.from(),m=f.to();f.empty()&&(r&&r>0?h=rt(h.line,h.ch-r):e.state.overwrite&&!l?m=rt(m.line,Math.min(Ke(a,m.line).text.length,m.ch+Q(s).length)):l&&Mo&&Mo.lineWise&&Mo.text.join("\n")==t&&(h=m=rt(h.line,0)));var g={from:h,to:m,text:c?c[p%c.length]:s,origin:i||(l?"paste":e.state.cutIncoming>o?"cut":"+input")};ua(e.doc,g),cr(e,"inputRead",e,g)}t&&!l&&Do(e,t),On(e),e.curOp.updateInput<2&&(e.curOp.updateInput=d),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function No(e,t){var r=e.clipboardData&&e.clipboardData.getData("Text");if(r)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||ei(t,(function(){return Oo(t,r,0,null,"paste")})),!0}function Do(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var r=e.doc.sel,n=r.ranges.length-1;n>=0;n--){var i=r.ranges[n];if(!(i.head.ch>100||n&&r.ranges[n-1].head.line==i.head.line)){var a=e.getModeAt(i.head),o=!1;if(a.electricChars){for(var l=0;l<a.electricChars.length;l++)if(t.indexOf(a.electricChars.charAt(l))>-1){o=Io(e,i.head.line,"smart");break}}else a.electricInput&&a.electricInput.test(Ke(e.doc,i.head.line).text.slice(0,i.head.ch))&&(o=Io(e,i.head.line,"smart"));o&&cr(e,"electricInput",e,i.head.line)}}}function Fo(e){for(var t=[],r=[],n=0;n<e.doc.sel.ranges.length;n++){var i=e.doc.sel.ranges[n].head.line,a={anchor:rt(i,0),head:rt(i+1,0)};r.push(a),t.push(e.getRange(a.anchor,a.head))}return{text:t,ranges:r}}function Eo(e,t,r,n){e.setAttribute("autocorrect",r?"":"off"),e.setAttribute("autocapitalize",n?"":"off"),e.setAttribute("spellcheck",!!t)}function Ho(){var e=I("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=I("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return c?e.style.width="1000px":e.setAttribute("wrap","off"),g&&(e.style.border="1px solid black"),Eo(e),t}function Bo(e,t,r,n,i){var a=t,o=r,l=Ke(e,t.line);function s(n){var a,o;if(null==(a=i?function(e,t,r,n){var i=de(t,e.doc.direction);if(!i)return Za(t,r,n);r.ch>=t.text.length?(r.ch=t.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after");var a=ce(i,r.ch,r.sticky),o=i[a];if("ltr"==e.doc.direction&&o.level%2==0&&(n>0?o.to>r.ch:o.from<r.ch))return Za(t,r,n);var l,s=function(e,r){return Ya(t,e instanceof rt?e.ch:e,r)},c=function(r){return e.options.lineWrapping?(l=l||Or(e,t),Zr(e,t,l,r)):{begin:0,end:t.text.length}},u=c("before"==r.sticky?s(r,-1):r.ch);if("rtl"==e.doc.direction||1==o.level){var d=1==o.level==n<0,p=s(r,d?1:-1);if(null!=p&&(d?p<=o.to&&p<=u.end:p>=o.from&&p>=u.begin)){var f=d?"before":"after";return new rt(r.line,p,f)}}var h=function(e,t,n){for(var a=function(e,t){return t?new rt(r.line,s(e,1),"before"):new rt(r.line,e,"after")};e>=0&&e<i.length;e+=t){var o=i[e],l=t>0==(1!=o.level),c=l?n.begin:s(n.end,-1);if(o.from<=c&&c<o.to)return a(c,l);if(c=l?o.from:s(o.to,-1),n.begin<=c&&c<n.end)return a(c,l)}},m=h(a+n,n,u);if(m)return m;var g=n>0?u.end:s(u.begin,-1);return null==g||n>0&&g==t.text.length||!(m=h(n>0?0:i.length-1,n,c(g)))?null:m}(e.cm,l,t,r):Za(l,t,r))){if(n||(o=t.line+r)<e.first||o>=e.first+e.size||(t=new rt(o,t.ch,t.sticky),!(l=Ke(e,o))))return!1;t=eo(i,e.cm,l,t.line,r)}else t=a;return!0}if("char"==n)s();else if("column"==n)s(!0);else if("word"==n||"group"==n)for(var c=null,u="group"==n,d=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(r<0)||s(!p);p=!1){var f=l.text.charAt(t.ch)||"\n",h=re(f,d)?"w":u&&"\n"==f?"n":!u||/\s/.test(f)?null:"p";if(!u||p||h||(h="s"),c&&c!=h){r<0&&(r=1,s(),t.sticky="after");break}if(h&&(c=h),r>0&&!s(!p))break}var m=oa(e,t,a,o,!0);return it(a,m)&&(m.hitSide=!0),m}function Wo(e,t,r,n){var i,a,o=e.doc,l=t.left;if("page"==n){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(s-.5*an(e.display),3);i=(r>0?t.bottom:t.top)+r*c}else"line"==n&&(i=r>0?t.bottom+3:t.top-3);for(;(a=Xr(e,l,i)).outside;){if(r<0?i<=0:i>=o.height){a.hitSide=!0;break}i+=5*r}return a}var Jo=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new W,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function jo(e,t){var r=Pr(e,t.line);if(!r||r.hidden)return null;var n=Ke(e.doc,t.line),i=Ir(r,n,t.line),a=de(n,e.doc.direction),o="left";a&&(o=ce(a,t.ch)%2?"right":"left");var l=Er(i.map,t.ch,o);return l.offset="right"==l.collapse?l.end:l.start,l}function zo(e,t){return t&&(e.bad=!0),e}function Ro(e,t,r){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[r]))return zo(e.clipPos(rt(e.display.viewTo-1)),!0);t=null,r=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var a=e.display.view[i];if(a.node==n)return qo(a,t,r)}}function qo(e,t,r){var n=e.text.firstChild,i=!1;if(!t||!P(n,t))return zo(rt(Ye(e.line),0),!0);if(t==n&&(i=!0,t=n.childNodes[r],r=0,!t)){var a=e.rest?Q(e.rest):e.line;return zo(rt(Ye(a),a.text.length),i)}var o=3==t.nodeType?t:null,l=t;for(o||1!=t.childNodes.length||3!=t.firstChild.nodeType||(o=t.firstChild,r&&(r=o.nodeValue.length));l.parentNode!=n;)l=l.parentNode;var s=e.measure,c=s.maps;function u(t,r,n){for(var i=-1;i<(c?c.length:0);i++)for(var a=i<0?s.map:c[i],o=0;o<a.length;o+=3){var l=a[o+2];if(l==t||l==r){var u=Ye(i<0?e.line:e.rest[i]),d=a[o]+n;return(n<0||l!=t)&&(d=a[o+(n?1:0)]),rt(u,d)}}}var d=u(o,l,r);if(d)return zo(d,i);for(var p=l.nextSibling,f=o?o.nodeValue.length-r:0;p;p=p.nextSibling){if(d=u(p,p.firstChild,0))return zo(rt(d.line,d.ch-f),i);f+=p.textContent.length}for(var h=l.previousSibling,m=r;h;h=h.previousSibling){if(d=u(h,h.firstChild,-1))return zo(rt(d.line,d.ch+m),i);m+=h.textContent.length}}Jo.prototype.init=function(e){var t=this,r=this,n=r.cm,i=r.div=e.lineDiv;function a(e){if(!ve(n,e)){if(n.somethingSelected())Po({lineWise:!1,text:n.getSelections()}),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=Fo(n);Po({lineWise:!0,text:t.text}),"cut"==e.type&&n.operation((function(){n.setSelections(t.ranges,0,R),n.replaceSelection("",null,"cut")}))}if(e.clipboardData){e.clipboardData.clearData();var a=Mo.text.join("\n");if(e.clipboardData.setData("Text",a),e.clipboardData.getData("Text")==a)return void e.preventDefault()}var o=Ho(),l=o.firstChild;n.display.lineSpace.insertBefore(o,n.display.lineSpace.firstChild),l.value=Mo.text.join("\n");var s=document.activeElement;F(l),setTimeout((function(){n.display.lineSpace.removeChild(o),s.focus(),s==i&&r.showPrimarySelection()}),50)}}Eo(i,n.options.spellcheck,n.options.autocorrect,n.options.autocapitalize),fe(i,"paste",(function(e){ve(n,e)||No(e,n)||s<=11&&setTimeout(ti(n,(function(){return t.updateFromDOM()})),20)})),fe(i,"compositionstart",(function(e){t.composing={data:e.data,done:!1}})),fe(i,"compositionupdate",(function(e){t.composing||(t.composing={data:e.data,done:!1})})),fe(i,"compositionend",(function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)})),fe(i,"touchstart",(function(){return r.forceCompositionEnd()})),fe(i,"input",(function(){t.composing||t.readFromDOMSoon()})),fe(i,"copy",a),fe(i,"cut",a)},Jo.prototype.prepareSelection=function(){var e=yn(this.cm,!1);return e.focus=this.cm.state.focused,e},Jo.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},Jo.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Jo.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),i=n.from(),a=n.to();if(t.display.viewTo==t.display.viewFrom||i.line>=t.display.viewTo||a.line<t.display.viewFrom)e.removeAllRanges();else{var o=Ro(t,e.anchorNode,e.anchorOffset),l=Ro(t,e.focusNode,e.focusOffset);if(!o||o.bad||!l||l.bad||0!=nt(lt(o,l),i)||0!=nt(ot(o,l),a)){var s=t.display.view,c=i.line>=t.display.viewFrom&&jo(t,i)||{node:s[0].measure.map[2],offset:0},u=a.line<t.display.viewTo&&jo(t,a);if(!u){var d=s[s.length-1].measure,p=d.maps?d.maps[d.maps.length-1]:d.map;u={node:p[p.length-1],offset:p[p.length-2]-p[p.length-3]}}if(c&&u){var f,h=e.rangeCount&&e.getRangeAt(0);try{f=A(c.node,c.offset,u.offset,u.node)}catch(e){}f&&(!r&&t.state.focused?(e.collapse(c.node,c.offset),f.collapsed||(e.removeAllRanges(),e.addRange(f))):(e.removeAllRanges(),e.addRange(f)),h&&null==e.anchorNode?e.addRange(h):r&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},Jo.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation((function(){return e.cm.curOp.selectionChanged=!0}))}),20)},Jo.prototype.showMultipleSelections=function(e){_(this.cm.display.cursorDiv,e.cursors),_(this.cm.display.selectionDiv,e.selection)},Jo.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},Jo.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return P(this.div,t)},Jo.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Jo.prototype.blur=function(){this.div.blur()},Jo.prototype.getField=function(){return this.div},Jo.prototype.supportsTouch=function(){return!0},Jo.prototype.receivedFocus=function(){var e=this;this.selectionInEditor()?this.pollSelection():ei(this.cm,(function(){return e.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,(function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}))},Jo.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},Jo.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(v&&d&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var r=Ro(t,e.anchorNode,e.anchorOffset),n=Ro(t,e.focusNode,e.focusOffset);r&&n&&ei(t,(function(){ea(t.doc,Ai(r,n),R),(r.bad||n.bad)&&(t.curOp.selectionChanged=!0)}))}}},Jo.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,r,n=this.cm,i=n.display,a=n.doc.sel.primary(),o=a.from(),l=a.to();if(0==o.ch&&o.line>n.firstLine()&&(o=rt(o.line-1,Ke(n.doc,o.line-1).length)),l.ch==Ke(n.doc,l.line).text.length&&l.line<n.lastLine()&&(l=rt(l.line+1,0)),o.line<i.viewFrom||l.line>i.viewTo-1)return!1;o.line==i.viewFrom||0==(e=pn(n,o.line))?(t=Ye(i.view[0].line),r=i.view[0].node):(t=Ye(i.view[e].line),r=i.view[e-1].node.nextSibling);var s,c,u=pn(n,l.line);if(u==i.view.length-1?(s=i.viewTo-1,c=i.lineDiv.lastChild):(s=Ye(i.view[u+1].line)-1,c=i.view[u+1].node.previousSibling),!r)return!1;for(var d=n.doc.splitLines(function(e,t,r,n,i){var a="",o=!1,l=e.doc.lineSeparator(),s=!1;function c(){o&&(a+=l,s&&(a+=l),o=s=!1)}function u(e){e&&(c(),a+=e)}function d(t){if(1==t.nodeType){var r=t.getAttribute("cm-text");if(r)return void u(r);var a,p=t.getAttribute("cm-marker");if(p){var f=e.findMarks(rt(n,0),rt(i+1,0),(g=+p,function(e){return e.id==g}));return void(f.length&&(a=f[0].find(0))&&u(Ge(e.doc,a.from,a.to).join(l)))}if("false"==t.getAttribute("contenteditable"))return;var h=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;h&&c();for(var m=0;m<t.childNodes.length;m++)d(t.childNodes[m]);/^(pre|p)$/i.test(t.nodeName)&&(s=!0),h&&(o=!0)}else 3==t.nodeType&&u(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var g}for(;d(t),t!=r;)t=t.nextSibling,s=!1;return a}(n,r,c,t,s)),p=Ge(n.doc,rt(t,0),rt(s,Ke(n.doc,s).text.length));d.length>1&&p.length>1;)if(Q(d)==Q(p))d.pop(),p.pop(),s--;else{if(d[0]!=p[0])break;d.shift(),p.shift(),t++}for(var f=0,h=0,m=d[0],g=p[0],v=Math.min(m.length,g.length);f<v&&m.charCodeAt(f)==g.charCodeAt(f);)++f;for(var b=Q(d),y=Q(p),x=Math.min(b.length-(1==d.length?f:0),y.length-(1==p.length?f:0));h<x&&b.charCodeAt(b.length-h-1)==y.charCodeAt(y.length-h-1);)++h;if(1==d.length&&1==p.length&&t==o.line)for(;f&&f>o.ch&&b.charCodeAt(b.length-h-1)==y.charCodeAt(y.length-h-1);)f--,h++;d[d.length-1]=b.slice(0,b.length-h).replace(/^\u200b+/,""),d[0]=d[0].slice(f).replace(/\u200b+$/,"");var w=rt(t,f),S=rt(s,p.length?Q(p).length-h:0);return d.length>1||d[0]||nt(w,S)?(ma(n.doc,d,w,S,"+input"),!0):void 0},Jo.prototype.ensurePolled=function(){this.forceCompositionEnd()},Jo.prototype.reset=function(){this.forceCompositionEnd()},Jo.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Jo.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()}),80))},Jo.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||ei(this.cm,(function(){return fn(e.cm)}))},Jo.prototype.setUneditable=function(e){e.contentEditable="false"},Jo.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||ti(this.cm,Oo)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},Jo.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},Jo.prototype.onContextMenu=function(){},Jo.prototype.resetPosition=function(){},Jo.prototype.needsContentAttribute=!0;var Uo=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new W,this.hasSelection=!1,this.composing=null};Uo.prototype.init=function(e){var t=this,r=this,n=this.cm;this.createField(e);var i=this.textarea;function a(e){if(!ve(n,e)){if(n.somethingSelected())Po({lineWise:!1,text:n.getSelections()});else{if(!n.options.lineWiseCopyCut)return;var t=Fo(n);Po({lineWise:!0,text:t.text}),"cut"==e.type?n.setSelections(t.ranges,null,R):(r.prevInput="",i.value=t.text.join("\n"),F(i))}"cut"==e.type&&(n.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),g&&(i.style.width="0px"),fe(i,"input",(function(){l&&s>=9&&t.hasSelection&&(t.hasSelection=null),r.poll()})),fe(i,"paste",(function(e){ve(n,e)||No(e,n)||(n.state.pasteIncoming=+new Date,r.fastPoll())})),fe(i,"cut",a),fe(i,"copy",a),fe(e.scroller,"paste",(function(t){if(!Cr(e,t)&&!ve(n,t)){if(!i.dispatchEvent)return n.state.pasteIncoming=+new Date,void r.focus();var a=new Event("paste");a.clipboardData=t.clipboardData,i.dispatchEvent(a)}})),fe(e.lineSpace,"selectstart",(function(t){Cr(e,t)||we(t)})),fe(i,"compositionstart",(function(){var e=n.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}})),fe(i,"compositionend",(function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)}))},Uo.prototype.createField=function(e){this.wrapper=Ho(),this.textarea=this.wrapper.firstChild},Uo.prototype.prepareSelection=function(){var e=this.cm,t=e.display,r=e.doc,n=yn(e);if(e.options.moveInputWithCursor){var i=Kr(e,r.sel.primary().head,"div"),a=t.wrapper.getBoundingClientRect(),o=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+o.top-a.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+o.left-a.left))}return n},Uo.prototype.showSelection=function(e){var t=this.cm.display;_(t.cursorDiv,e.cursors),_(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Uo.prototype.reset=function(e){if(!this.contextMenuPending&&!this.composing){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var r=t.getSelection();this.textarea.value=r,t.state.focused&&F(this.textarea),l&&s>=9&&(this.hasSelection=r)}else e||(this.prevInput=this.textarea.value="",l&&s>=9&&(this.hasSelection=null))}},Uo.prototype.getField=function(){return this.textarea},Uo.prototype.supportsTouch=function(){return!1},Uo.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!b||O()!=this.textarea))try{this.textarea.focus()}catch(e){}},Uo.prototype.blur=function(){this.textarea.blur()},Uo.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Uo.prototype.receivedFocus=function(){this.slowPoll()},Uo.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){e.poll(),e.cm.state.focused&&e.slowPoll()}))},Uo.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,(function r(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,r))}))},Uo.prototype.poll=function(){var e=this,t=this.cm,r=this.textarea,n=this.prevInput;if(this.contextMenuPending||!t.state.focused||Ne(r)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=r.value;if(i==n&&!t.somethingSelected())return!1;if(l&&s>=9&&this.hasSelection===i||y&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var a=i.charCodeAt(0);if(8203!=a||n||(n=""),8666==a)return this.reset(),this.cm.execCommand("undo")}for(var o=0,c=Math.min(n.length,i.length);o<c&&n.charCodeAt(o)==i.charCodeAt(o);)++o;return ei(t,(function(){Oo(t,i.slice(o),n.length-o,null,e.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?r.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},Uo.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Uo.prototype.onKeyPress=function(){l&&s>=9&&(this.hasSelection=null),this.fastPoll()},Uo.prototype.onContextMenu=function(e){var t=this,r=t.cm,n=r.display,i=t.textarea;t.contextMenuPending&&t.contextMenuPending();var a=dn(r,e),o=n.scroller.scrollTop;if(a&&!p){r.options.resetSelectionOnContextMenu&&-1==r.doc.sel.contains(a)&&ti(r,ea)(r.doc,Ai(a),R);var u,d=i.style.cssText,f=t.wrapper.style.cssText,h=t.wrapper.offsetParent.getBoundingClientRect();t.wrapper.style.cssText="position: static",i.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-h.top-5)+"px; left: "+(e.clientX-h.left-5)+"px;\n      z-index: 1000; background: "+(l?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",c&&(u=window.scrollY),n.input.focus(),c&&window.scrollTo(null,u),n.input.reset(),r.somethingSelected()||(i.value=t.prevInput=" "),t.contextMenuPending=g,n.selForContextMenu=r.doc.sel,clearTimeout(n.detectingSelectAll),l&&s>=9&&m(),T?(Te(e),fe(window,"mouseup",(function e(){me(window,"mouseup",e),setTimeout(g,20)}))):setTimeout(g,50)}function m(){if(null!=i.selectionStart){var e=r.somethingSelected(),a=""+(e?i.value:"");i.value="",i.value=a,t.prevInput=e?"":"",i.selectionStart=1,i.selectionEnd=a.length,n.selForContextMenu=r.doc.sel}}function g(){if(t.contextMenuPending==g&&(t.contextMenuPending=!1,t.wrapper.style.cssText=f,i.style.cssText=d,l&&s<9&&n.scrollbars.setScrollTop(n.scroller.scrollTop=o),null!=i.selectionStart)){(!l||l&&s<9)&&m();var e=0;n.detectingSelectAll=setTimeout((function a(){n.selForContextMenu==r.doc.sel&&0==i.selectionStart&&i.selectionEnd>0&&""==t.prevInput?ti(r,sa)(r):e++<10?n.detectingSelectAll=setTimeout(a,500):(n.selForContextMenu=null,n.input.reset())}),200)}}},Uo.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},Uo.prototype.setUneditable=function(){},Uo.prototype.needsContentAttribute=!1,function(e){var t=e.optionHandlers;function r(r,n,i,a){e.defaults[r]=n,i&&(t[r]=a?function(e,t,r){r!=Co&&i(e,t,r)}:i)}e.defineOption=r,e.Init=Co,r("value","",(function(e,t){return e.setValue(t)}),!0),r("mode",null,(function(e,t){e.doc.modeOption=t,Mi(e)}),!0),r("indentUnit",2,Mi,!0),r("indentWithTabs",!1),r("smartIndent",!0),r("tabSize",4,(function(e){Pi(e),Jr(e),fn(e)}),!0),r("lineSeparator",null,(function(e,t){if(e.doc.lineSep=t,t){var r=[],n=e.doc.first;e.doc.iter((function(e){for(var i=0;;){var a=e.text.indexOf(t,i);if(-1==a)break;i=a+t.length,r.push(rt(n,a))}n++}));for(var i=r.length-1;i>=0;i--)ma(e.doc,t,r[i],rt(r[i].line,r[i].ch+t.length))}})),r("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,(function(e,t,r){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),r!=Co&&e.refresh()})),r("specialCharPlaceholder",er,(function(e){return e.refresh()}),!0),r("electricChars",!0),r("inputStyle",b?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),r("spellcheck",!1,(function(e,t){return e.getInputField().spellcheck=t}),!0),r("autocorrect",!1,(function(e,t){return e.getInputField().autocorrect=t}),!0),r("autocapitalize",!1,(function(e,t){return e.getInputField().autocapitalize=t}),!0),r("rtlMoveVisually",!w),r("wholeLineUpdateBefore",!0),r("theme","default",(function(e){So(e),gi(e)}),!0),r("keyMap","default",(function(e,t,r){var n=Qa(t),i=r!=Co&&Qa(r);i&&i.detach&&i.detach(e,n),n.attach&&n.attach(e,i||null)})),r("extraKeys",null),r("configureMouse",null),r("lineWrapping",!1,$o,!0),r("gutters",[],(function(e,t){e.display.gutterSpecs=hi(t,e.options.lineNumbers),gi(e)}),!0),r("fixedGutter",!0,(function(e,t){e.display.gutters.style.left=t?sn(e.display)+"px":"0",e.refresh()}),!0),r("coverGutterNextToScrollbar",!1,(function(e){return zn(e)}),!0),r("scrollbarStyle","native",(function(e){Un(e),zn(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)}),!0),r("lineNumbers",!1,(function(e,t){e.display.gutterSpecs=hi(e.options.gutters,t),gi(e)}),!0),r("firstLineNumber",1,gi,!0),r("lineNumberFormatter",(function(e){return e}),gi,!0),r("showCursorWhenSelecting",!1,bn,!0),r("resetSelectionOnContextMenu",!0),r("lineWiseCopyCut",!0),r("pasteLinesPerSelection",!0),r("selectionsMayTouch",!1),r("readOnly",!1,(function(e,t){"nocursor"==t&&($n(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)})),r("disableInput",!1,(function(e,t){t||e.display.input.reset()}),!0),r("dragDrop",!0,Ao),r("allowDropFileTypes",null),r("cursorBlinkRate",530),r("cursorScrollMargin",0),r("cursorHeight",1,bn,!0),r("singleCursorHeightPerLine",!0,bn,!0),r("workTime",100),r("workDelay",100),r("flattenSpans",!0,Pi,!0),r("addModeClass",!1,Pi,!0),r("pollInterval",100),r("undoDepth",200,(function(e,t){return e.doc.history.undoDepth=t})),r("historyEventDelay",1250),r("viewportMargin",10,(function(e){return e.refresh()}),!0),r("maxHighlightLength",1e4,Pi,!0),r("moveInputWithCursor",!0,(function(e,t){t||e.display.input.resetPosition()})),r("tabindex",null,(function(e,t){return e.display.input.getField().tabIndex=t||""})),r("autofocus",null),r("direction","ltr",(function(e,t){return e.doc.setDirection(t)}),!0),r("phrases",null)}(Lo),function(e){var t=e.optionHandlers,r=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,r){var n=this.options,i=n[e];n[e]==r&&"mode"!=e||(n[e]=r,t.hasOwnProperty(e)&&ti(this,t[e])(this,r,i),ge(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Qa(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,r=0;r<t.length;++r)if(t[r]==e||t[r].name==e)return t.splice(r,1),!0},addOverlay:ri((function(t,r){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");!function(e,t,r){for(var n=0,i=r(t);n<e.length&&r(e[n])<=i;)n++;e.splice(n,0,t)}(this.state.overlays,{mode:n,modeSpec:t,opaque:r&&r.opaque,priority:r&&r.priority||0},(function(e){return e.priority})),this.state.modeGen++,fn(this)})),removeOverlay:ri((function(e){for(var t=this.state.overlays,r=0;r<t.length;++r){var n=t[r].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(r,1),this.state.modeGen++,void fn(this)}})),indentLine:ri((function(e,t,r){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),et(this.doc,e)&&Io(this,e,t,r)})),indentSelection:ri((function(e){for(var t=this.doc.sel.ranges,r=-1,n=0;n<t.length;n++){var i=t[n];if(i.empty())i.head.line>r&&(Io(this,i.head.line,e,!0),r=i.head.line,n==this.doc.sel.primIndex&&On(this));else{var a=i.from(),o=i.to(),l=Math.max(r,a.line);r=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var s=l;s<r;++s)Io(this,s,e);var c=this.doc.sel.ranges;0==a.ch&&t.length==c.length&&c[n].from().ch>0&&Xi(this.doc,n,new Ti(a,c[n].to()),R)}}})),getTokenAt:function(e,t){return xt(this,e,t)},getLineTokens:function(e,t){return xt(this,rt(e),t,!0)},getTokenTypeAt:function(e){e=ct(this.doc,e);var t,r=ht(this,Ke(this.doc,e.line)),n=0,i=(r.length-1)/2,a=e.ch;if(0==a)t=r[2];else for(;;){var o=n+i>>1;if((o?r[2*o-1]:0)>=a)i=o;else{if(!(r[2*o+1]<a)){t=r[2*o+2];break}n=o+1}}var l=t?t.indexOf("overlay "):-1;return l<0?t:0==l?null:t.slice(0,l-1)},getModeAt:function(t){var r=this.doc.mode;return r.innerMode?e.innerMode(r,this.getTokenAt(t).state).mode:r},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!r.hasOwnProperty(t))return n;var i=r[t],a=this.getModeAt(e);if("string"==typeof a[t])i[a[t]]&&n.push(i[a[t]]);else if(a[t])for(var o=0;o<a[t].length;o++){var l=i[a[t][o]];l&&n.push(l)}else a.helperType&&i[a.helperType]?n.push(i[a.helperType]):i[a.name]&&n.push(i[a.name]);for(var s=0;s<i._global.length;s++){var c=i._global[s];c.pred(a,this)&&-1==J(n,c.val)&&n.push(c.val)}return n},getStateAfter:function(e,t){var r=this.doc;return mt(this,(e=st(r,null==e?r.first+r.size-1:e))+1,t).state},cursorCoords:function(e,t){var r=this.doc.sel.primary();return Kr(this,null==e?r.head:"object"==o(e)?ct(this.doc,e):e?r.from():r.to(),t||"page")},charCoords:function(e,t){return Vr(this,ct(this.doc,e),t||"page")},coordsChar:function(e,t){return Xr(this,(e=Ur(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Ur(this,{top:e,left:0},t||"page").top,Ze(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,r){var n,i=!1;if("number"==typeof e){var a=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>a&&(e=a,i=!0),n=Ke(this.doc,e)}else n=e;return qr(this,n,{top:0,left:0},t||"page",r||i).top+(i?this.doc.height-qt(n):0)},defaultTextHeight:function(){return an(this.display)},defaultCharWidth:function(){return on(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,r,n,i){var a,o,l,s=this.display,c=(e=Kr(this,ct(this.doc,e))).bottom,u=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==n)c=e.top;else if("above"==n||"near"==n){var d=Math.max(s.wrapper.clientHeight,this.doc.height),p=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>d)&&e.top>t.offsetHeight?c=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=d&&(c=e.bottom),u+t.offsetWidth>p&&(u=p-t.offsetWidth)}t.style.top=c+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),r&&(a=this,o={left:u,top:c,right:u+t.offsetWidth,bottom:c+t.offsetHeight},null!=(l=Mn(a,o)).scrollTop&&En(a,l.scrollTop),null!=l.scrollLeft&&Bn(a,l.scrollLeft))},triggerOnKeyDown:ri(uo),triggerOnKeyPress:ri(fo),triggerOnKeyUp:po,triggerOnMouseDown:ri(vo),execCommand:function(e){if(to.hasOwnProperty(e))return to[e].call(null,this)},triggerElectric:ri((function(e){Do(this,e)})),findPosH:function(e,t,r,n){var i=1;t<0&&(i=-1,t=-t);for(var a=ct(this.doc,e),o=0;o<t&&!(a=Bo(this.doc,a,i,r,n)).hitSide;++o);return a},moveH:ri((function(e,t){var r=this;this.extendSelectionsBy((function(n){return r.display.shift||r.doc.extend||n.empty()?Bo(r.doc,n.head,e,t,r.options.rtlMoveVisually):e<0?n.from():n.to()}),U)})),deleteH:ri((function(e,t){var r=this.doc.sel,n=this.doc;r.somethingSelected()?n.replaceSelection("",null,"+delete"):Xa(this,(function(r){var i=Bo(n,r.head,e,t,!1);return e<0?{from:i,to:r.head}:{from:r.head,to:i}}))})),findPosV:function(e,t,r,n){var i=1,a=n;t<0&&(i=-1,t=-t);for(var o=ct(this.doc,e),l=0;l<t;++l){var s=Kr(this,o,"div");if(null==a?a=s.left:s.left=a,(o=Wo(this,s,i,r)).hitSide)break}return o},moveV:ri((function(e,t){var r=this,n=this.doc,i=[],a=!this.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy((function(o){if(a)return e<0?o.from():o.to();var l=Kr(r,o.head,"div");null!=o.goalColumn&&(l.left=o.goalColumn),i.push(l.left);var s=Wo(r,l,e,t);return"page"==t&&o==n.sel.primary()&&Pn(r,Vr(r,s,"div").top-l.top),s}),U),i.length)for(var o=0;o<n.sel.ranges.length;o++)n.sel.ranges[o].goalColumn=i[o]})),findWordAt:function(e){var t=Ke(this.doc,e.line).text,r=e.ch,n=e.ch;if(t){var i=this.getHelper(e,"wordChars");"before"!=e.sticky&&n!=t.length||!r?++n:--r;for(var a=t.charAt(r),o=re(a,i)?function(e){return re(e,i)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!re(e)};r>0&&o(t.charAt(r-1));)--r;for(;n<t.length&&o(t.charAt(n));)++n}return new Ti(rt(e.line,r),rt(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?N(this.display.cursorDiv,"CodeMirror-overwrite"):$(this.display.cursorDiv,"CodeMirror-overwrite"),ge(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==O()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:ri((function(e,t){Nn(this,e,t)})),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-$r(this)-this.display.barHeight,width:e.scrollWidth-$r(this)-this.display.barWidth,clientHeight:_r(this),clientWidth:Lr(this)}},scrollIntoView:ri((function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:rt(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?function(e,t){Dn(e),e.curOp.scrollToPos=t}(this,e):Fn(this,e.from,e.to,e.margin)})),setSize:ri((function(e,t){var r=this,n=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&Wr(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,(function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){hn(r,i,"widget");break}++i})),this.curOp.forceUpdate=!0,ge(this,"refresh",this)})),operation:function(e){return ei(this,e)},startOperation:function(){return Kn(this)},endOperation:function(){return Gn(this)},refresh:ri((function(){var e=this.display.cachedTextHeight;fn(this),this.curOp.forceUpdate=!0,Jr(this),Nn(this,this.doc.scrollLeft,this.doc.scrollTop),ui(this.display),(null==e||Math.abs(e-an(this.display))>.5)&&un(this),ge(this,"refresh",this)})),swapDoc:ri((function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Fi(this,e),Jr(this),this.display.input.reset(),Nn(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,cr(this,"swapDoc",this,t),t})),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},xe(e),e.registerHelper=function(t,n,i){r.hasOwnProperty(t)||(r[t]=e[t]={_global:[]}),r[t][n]=i},e.registerGlobalHelper=function(t,n,i,a){e.registerHelper(t,n,a),r[t]._global.push({pred:i,val:a})}}(Lo);var Vo="iter insert remove copy getEditor constructor".split(" ");for(var Ko in Ma.prototype)Ma.prototype.hasOwnProperty(Ko)&&J(Vo,Ko)<0&&(Lo.prototype[Ko]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ma.prototype[Ko]));return xe(Ma),Lo.inputStyles={textarea:Uo,contenteditable:Jo},Lo.defineMode=function(e){Lo.defaults.mode||"null"==e||(Lo.defaults.mode=e),Be.apply(this,arguments)},Lo.defineMIME=function(e,t){He[e]=t},Lo.defineMode("null",(function(){return{token:function(e){return e.skipToEnd()}}})),Lo.defineMIME("text/plain","null"),Lo.defineExtension=function(e,t){Lo.prototype[e]=t},Lo.defineDocExtension=function(e,t){Ma.prototype[e]=t},Lo.fromTextArea=function(e,t){if((t=t?H(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var r=O();t.autofocus=r==e||null!=e.getAttribute("autofocus")&&r==document.body}function n(){e.value=l.getValue()}var i;if(e.form&&(fe(e.form,"submit",n),!t.leaveSubmitMethodAlone)){var a=e.form;i=a.submit;try{var o=a.submit=function(){n(),a.submit=i,a.submit(),a.submit=o}}catch(e){}}t.finishInit=function(t){t.save=n,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,n(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(me(e.form,"submit",n),"function"==typeof e.form.submit&&(e.form.submit=i))}},e.style.display="none";var l=Lo((function(t){return e.parentNode.insertBefore(t,e.nextSibling)}),t);return l},function(e){e.off=me,e.on=fe,e.wheelEventPixels=wi,e.Doc=Ma,e.splitLines=Oe,e.countColumn=B,e.findColumn=V,e.isWordChar=te,e.Pass=z,e.signal=ge,e.Line=Kt,e.changeEnd=$i,e.scrollbarModel=qn,e.Pos=rt,e.cmpPos=nt,e.modes=Ee,e.mimeModes=He,e.resolveMode=We,e.getMode=Je,e.modeExtensions=je,e.extendMode=ze,e.copyState=Re,e.startState=Ue,e.innerMode=qe,e.commands=to,e.keyMap=za,e.keyName=Ga,e.isModifierKey=Va,e.lookupKey=Ua,e.normalizeKeyMap=qa,e.StringStream=Ve,e.SharedTextMarker=$a,e.TextMarker=ka,e.LineWidget=Sa,e.e_preventDefault=we,e.e_stopPropagation=Se,e.e_stop=Te,e.addClass=N,e.contains=P,e.rmClass=$,e.keyNames=Ba}(Lo),Lo.version="5.47.0",Lo},"object"===o(t)&&void 0!==e?e.exports=a():void 0===(i="function"==typeof(n=a)?n.call(t,r,t,e):n)||(e.exports=i)},71:function(e,t,r){},72:function(e,t,r){(function(e){var n,i,a,o;function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o=function(e){var t=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),r=e.Pos,n={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function i(e){return e&&e.bracketRegex||/[(){}[\]]/}function a(e,t,a){var l=e.getLineHandle(t.line),s=t.ch-1,c=a&&a.afterCursor;null==c&&(c=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var u=i(a),d=!c&&0<=s&&u.test(l.text.charAt(s))&&n[l.text.charAt(s)]||u.test(l.text.charAt(s+1))&&n[l.text.charAt(++s)];if(!d)return null;var p=">"==d.charAt(1)?1:-1;if(a&&a.strict&&0<p!=(s==t.ch))return null;var f=e.getTokenTypeAt(r(t.line,s+1)),h=o(e,r(t.line,s+(0<p?1:0)),p,f||null,a);return null==h?null:{from:r(t.line,s),to:h&&h.pos,match:h&&h.ch==d.charAt(0),forward:0<p}}function o(e,t,a,o,l){for(var s=l&&l.maxScanLineLength||1e4,c=l&&l.maxScanLines||1e3,u=[],d=i(l),p=0<a?Math.min(t.line+c,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-c),f=t.line;f!=p;f+=a){var h=e.getLine(f);if(h){var m=0<a?0:h.length-1,g=0<a?h.length:-1;if(!(h.length>s))for(f==t.line&&(m=t.ch-(a<0?1:0));m!=g;m+=a){var v=h.charAt(m);if(d.test(v)&&(void 0===o||e.getTokenTypeAt(r(f,m+1))==o)){var b=n[v];if(b&&">"==b.charAt(1)==0<a)u.push(v);else{if(!u.length)return{pos:r(f,m),ch:v};u.pop()}}}}}return f-a!=(0<a?e.lastLine():e.firstLine())&&null}function s(e,n,i){for(var o=e.state.matchBrackets.maxHighlightLineLength||1e3,l=[],s=e.listSelections(),c=0;c<s.length;c++){var u=s[c].empty()&&a(e,s[c].head,i);if(u&&e.getLine(u.from.line).length<=o){var d=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";l.push(e.markText(u.from,r(u.from.line,u.from.ch+1),{className:d})),u.to&&e.getLine(u.to.line).length<=o&&l.push(e.markText(u.to,r(u.to.line,u.to.ch+1),{className:d}))}}if(l.length){t&&e.state.focused&&e.focus();var p=function(){e.operation((function(){for(var e=0;e<l.length;e++)l[e].clear()}))};if(!n)return p;setTimeout(p,800)}}function c(e){e.operation((function(){e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null),e.state.matchBrackets.currentlyHighlighted=s(e,!1,e.state.matchBrackets)}))}e.defineOption("matchBrackets",!1,(function(t,r,n){n&&n!=e.Init&&(t.off("cursorActivity",c),t.state.matchBrackets&&t.state.matchBrackets.currentlyHighlighted&&(t.state.matchBrackets.currentlyHighlighted(),t.state.matchBrackets.currentlyHighlighted=null)),r&&(t.state.matchBrackets="object"==l(r)?r:{},t.on("cursorActivity",c))})),e.defineExtension("matchBrackets",(function(){s(this,!0)})),e.defineExtension("findMatchingBracket",(function(e,t,r){return(r||"boolean"==typeof t)&&(t=r?(r.strict=t,r):t?{strict:!0}:null),a(this,e,t)})),e.defineExtension("scanForBracket",(function(e,t,r,n){return o(this,e,t,r,n)}))},"object"==l(t)&&"object"==l(e)?o(r(6)):(i=[r(6)],void 0===(a="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=a))}).call(this,r(19)(e))},73:function(e,t,r){(function(e){var n,i,a,o;function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o=function(e){"use strict";var t="CodeMirror-hint-active";function r(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var r=this;e.on("cursorActivity",this.activityFunc=function(){r.cursorActivity()})}e.showHint=function(e,t,r){if(!t)return e.showHint(r);r&&r.async&&(t.async=!0);var n={hint:t};if(r)for(var i in r)n[i]=r[i];return e.showHint(n)},e.defineExtension("showHint",(function(t){t=function(e,t,r){var n=e.options.hintOptions,i={};for(var a in c)i[a]=c[a];if(n)for(var a in n)void 0!==n[a]&&(i[a]=n[a]);if(r)for(var a in r)void 0!==r[a]&&(i[a]=r[a]);return i.hint.resolve&&(i.hint=i.hint.resolve(e,t)),i}(this,this.getCursor("start"),t);var n=this.listSelections();if(!(1<n.length)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(var i=0;i<n.length;i++)if(n[i].head.line!=n[i].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var a=this.state.completionActive=new r(this,t);a.options.hint&&(e.signal(this,"startCompletion",this),a.update(!0))}})),e.defineExtension("closeHint",(function(){this.state.completionActive&&this.state.completionActive.close()}));var n=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},i=window.cancelAnimationFrame||clearTimeout;function a(e){return"string"==typeof e?e:e.text}function o(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function l(r,n){this.completion=r,this.data=n,this.picked=!1;var i=this,l=r.cm,s=l.getInputField().ownerDocument,c=s.defaultView||s.parentWindow,u=this.hints=s.createElement("ul"),d=r.cm.options.theme;u.className="CodeMirror-hints "+d,this.selectedHint=n.selectedHint||0;for(var p=n.list,f=0;f<p.length;++f){var h=u.appendChild(s.createElement("li")),m=p[f],g="CodeMirror-hint"+(f!=this.selectedHint?"":" "+t);null!=m.className&&(g=m.className+" "+g),h.className=g,m.render?m.render(h,n,m):h.appendChild(s.createTextNode(m.displayText||a(m))),h.hintId=f}var v=r.options.container||s.body,b=l.cursorCoords(r.options.alignWithWord?n.from:null),y=b.left,x=b.bottom,w=!0,S=0,C=0;if(v!==s.body){var T=(-1!==["absolute","relative","fixed"].indexOf(c.getComputedStyle(v).position)?v:v.offsetParent).getBoundingClientRect(),k=s.body.getBoundingClientRect();S=T.left-k.left,C=T.top-k.top}u.style.left=y-S+"px",u.style.top=x-C+"px";var A=c.innerWidth||Math.max(s.body.offsetWidth,s.documentElement.offsetWidth),$=c.innerHeight||Math.max(s.body.offsetHeight,s.documentElement.offsetHeight);v.appendChild(u);var L=u.getBoundingClientRect(),_=L.bottom-$,I=u.scrollHeight>u.clientHeight+1,M=l.getScrollInfo();if(0<_){var P=L.bottom-L.top;if(0<b.top-(b.bottom-L.top)-P)u.style.top=(x=b.top-P-C)+"px",w=!1;else if($<P){u.style.height=$-5+"px",u.style.top=(x=b.bottom-L.top-C)+"px";var O=l.getCursor();n.from.ch!=O.ch&&(b=l.cursorCoords(O),u.style.left=(y=b.left-S)+"px",L=u.getBoundingClientRect())}}var N,D=L.right-A;if(0<D&&(L.right-L.left>A&&(u.style.width=A-5+"px",D-=L.right-L.left-A),u.style.left=(y=b.left-D-S)+"px"),I)for(var F=u.firstChild;F;F=F.nextSibling)F.style.paddingRight=l.display.nativeBarWidth+"px";return l.addKeyMap(this.keyMap=function(e,t){var r={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(1-t.menuSize(),!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close};/Mac/.test(navigator.platform)&&(r["Ctrl-P"]=function(){t.moveFocus(-1)},r["Ctrl-N"]=function(){t.moveFocus(1)});var n=e.options.customKeys,i=n?{}:r;function a(e,n){var a;a="string"!=typeof n?function(e){return n(e,t)}:r.hasOwnProperty(n)?r[n]:n,i[e]=a}if(n)for(var o in n)n.hasOwnProperty(o)&&a(o,n[o]);var l=e.options.extraKeys;if(l)for(var o in l)l.hasOwnProperty(o)&&a(o,l[o]);return i}(r,{moveFocus:function(e,t){i.changeActive(i.selectedHint+e,t)},setFocus:function(e){i.changeActive(e)},menuSize:function(){return i.screenAmount()},length:p.length,close:function(){r.close()},pick:function(){i.pick()},data:n})),r.options.closeOnUnfocus&&(l.on("blur",this.onBlur=function(){N=setTimeout((function(){r.close()}),100)}),l.on("focus",this.onFocus=function(){clearTimeout(N)})),l.on("scroll",this.onScroll=function(){var e=l.getScrollInfo(),t=l.getWrapperElement().getBoundingClientRect(),n=x+M.top-e.top,i=n-(c.pageYOffset||(s.documentElement||s.body).scrollTop);if(w||(i+=u.offsetHeight),i<=t.top||i>=t.bottom)return r.close();u.style.top=n+"px",u.style.left=y+M.left-e.left+"px"}),e.on(u,"dblclick",(function(e){var t=o(u,e.target||e.srcElement);t&&null!=t.hintId&&(i.changeActive(t.hintId),i.pick())})),e.on(u,"click",(function(e){var t=o(u,e.target||e.srcElement);t&&null!=t.hintId&&(i.changeActive(t.hintId),r.options.completeOnSingleClick&&i.pick())})),e.on(u,"mousedown",(function(){setTimeout((function(){l.focus()}),20)})),e.signal(n,"select",p[this.selectedHint],u.childNodes[this.selectedHint]),!0}function s(e,t,r,n){if(e.async)e(t,n,r);else{var i=e(t,r);i&&i.then?i.then(n):n(i)}}r.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,r){var n=t.list[r];n.hint?n.hint(this.cm,t,n):this.cm.replaceRange(a(n),n.from||t.from,n.to||t.to,"complete"),e.signal(t,"pick",n),this.close()},cursorActivity:function(){this.debounce&&(i(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||!e.ch||this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var r=this;this.debounce=n((function(){r.update()})),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick){var t=this,r=++this.tick;s(this.options.hint,this.cm,this.options,(function(n){t.tick==r&&t.finishUpdate(n,e)}))}},finishUpdate:function(t,r){this.data&&e.signal(this.data,"update");var n=this.widget&&this.widget.picked||r&&this.options.completeSingle;this.widget&&this.widget.close(),(this.data=t)&&t.list.length&&(n&&1==t.list.length?this.pick(t,0):(this.widget=new l(this,t),e.signal(t,"shown")))}},l.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(r,n){if(r>=this.data.list.length?r=n?this.data.list.length-1:0:r<0&&(r=n?0:this.data.list.length-1),this.selectedHint!=r){var i=this.hints.childNodes[this.selectedHint];i&&(i.className=i.className.replace(" "+t,"")),(i=this.hints.childNodes[this.selectedHint=r]).className+=" "+t,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],i)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",{resolve:function(t,r){var n,i=t.getHelpers(r,"hint");if(i.length){var a=function(e,t,r){var n=function(e,t){if(!e.somethingSelected())return t;for(var r=[],n=0;n<t.length;n++)t[n].supportsSelection&&r.push(t[n]);return r}(e,i);!function i(a){if(a==n.length)return t(null);s(n[a],e,r,(function(e){e&&0<e.list.length?t(e):i(a+1)}))}(0)};return a.async=!0,a.supportsSelection=!0,a}return(n=t.getHelper(t.getCursor(),"hintWords"))?function(t){return e.hint.fromList(t,{words:n})}:e.hint.anyword?function(t,r){return e.hint.anyword(t,r)}:function(){}}}),e.registerHelper("hint","fromList",(function(t,r){var n,i=t.getCursor(),a=t.getTokenAt(i),o=e.Pos(i.line,a.start),l=i;a.start<i.ch&&/\w/.test(a.string.charAt(i.ch-a.start-1))?n=a.string.substr(0,i.ch-a.start):(n="",o=i);for(var s=[],c=0;c<r.words.length;c++){var u=r.words[c];u.slice(0,n.length)==n&&s.push(u)}if(s.length)return{list:s,from:o,to:l}})),e.commands.autocomplete=e.showHint;var c={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)},"object"==l(t)&&"object"==l(e)?o(r(6)):(i=[r(6)],void 0===(a="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=a))}).call(this,r(19)(e))},74:function(e,t,r){(function(e){var n,i,a;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){"object"==o(t)&&"object"==o(e)?l(r(6),r(41)):(i=[r(6),r(41)],void 0===(a="function"==typeof(n=l)?n.apply(t,i):n)||(e.exports=a))}((function(e){"use strict";var t,r,n,i,a={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},l=e.Pos,s=e.cmpPos;function c(e){return"[object Array]"==Object.prototype.toString.call(e)}function u(e){return"string"==typeof e?e:e.text}function d(e,t){return c(t)&&(t={columns:t}),t.text||(t.text=e),t}function p(e){return t[e.toUpperCase()]}function f(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function h(e,t){var r=e.length,n=u(t).substr(0,r);return e.toUpperCase()===n.toUpperCase()}function m(e,t,r,n){if(c(r))for(var i=0;i<r.length;i++)h(t,r[i])&&e.push(n(r[i]));else for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];h(t,o=o&&!0!==o?o.displayText?{text:o.text,displayText:o.displayText}:o.text:a)&&e.push(n(o))}}function g(e){"."==e.charAt(0)&&(e=e.substr(1));for(var t=e.split(i+i),r=0;r<t.length;r++)t[r]=t[r].replace(new RegExp(i,"g"),"");return t.join(i)}function v(e){for(var t=u(e).split("."),r=0;r<t.length;r++)t[r]=i+t[r].replace(new RegExp(i,"g"),i+i)+i;var n=t.join(".");return"string"==typeof e?n:((e=f(e)).text=n,e)}function b(e,t){for(var r=e.split(/\s+/),n=0;n<r.length;n++)r[n]&&t(r[n].replace(/[,;]/g,""))}function y(e,t){for(var r=t.doc,n=r.getValue(),i=e.toUpperCase(),o="",c="",u=[],d={start:l(0,0),end:l(t.lastLine(),t.getLineHandle(t.lastLine()).length)},f=n.indexOf(a.QUERY_DIV);-1!=f;)u.push(r.posFromIndex(f)),f=n.indexOf(a.QUERY_DIV,f+1);u.unshift(l(0,0)),u.push(l(t.lastLine(),t.getLineHandle(t.lastLine()).text.length));for(var h=null,m=t.getCursor(),g=0;g<u.length;g++){if((null==h||s(m,h)>0)&&s(m,u[g])<=0){d={start:h,end:u[g]};break}h=u[g]}if(d.start){var v=r.getRange(d.start,d.end,!1);for(g=0;g<v.length&&(b(v[g],(function(e){var t=e.toUpperCase();t===i&&p(o)&&(c=o),t!==a.ALIAS_KEYWORD&&(o=e)})),!c);g++);}return c}e.registerHelper("hint","sql",(function(a,s){t=function(e){var t={};if(c(e))for(var r=e.length-1;r>=0;r--){var n=e[r];t[u(n).toUpperCase()]=d(u(n),n)}else if(e)for(var i in e)t[i.toUpperCase()]=d(i,e[i]);return t}(s&&s.tables);var h=s&&s.defaultTable,b=s&&s.disableKeywords;r=h&&p(h),n=function(t){var r=t.doc.modeOption;return"sql"===r&&(r="text/x-sql"),e.resolveMode(r).keywords}(a),i=function(t){var r=t.doc.modeOption;return"sql"===r&&(r="text/x-sql"),e.resolveMode(r).identifierQuote||"`"}(a),h&&!r&&(r=y(h,a)),(r=r||[]).columns&&(r=r.columns);var x,w,S,C=a.getCursor(),T=[],k=a.getTokenAt(C);if(k.end>C.ch&&(k.end=C.ch,k.string=k.string.slice(0,C.ch-k.start)),k.string.match(/^[.`"\w@]\w*$/)?(S=k.string,x=k.start,w=k.end):(x=w=C.ch,S=""),"."==S.charAt(0)||S.charAt(0)==i)x=function(e,n,a,o){for(var s=!1,c=[],u=n.start,d=!0;d;)d="."==n.string.charAt(0),s=s||n.string.charAt(0)==i,u=n.start,c.unshift(g(n.string)),"."==(n=o.getTokenAt(l(e.line,n.start))).string&&(d=!0,n=o.getTokenAt(l(e.line,n.start)));var h=c.join(".");m(a,h,t,(function(e){return s?v(e):e})),m(a,h,r,(function(e){return s?v(e):e})),h=c.pop();var b=c.join("."),x=!1,w=b;if(!p(b)){var S=b;(b=y(b,o))!==S&&(x=!0)}var C=p(b);return C&&C.columns&&(C=C.columns),C&&m(a,h,C,(function(e){var t=b;return 1==x&&(t=w),"string"==typeof e?e=t+"."+e:(e=f(e)).text=t+"."+e.text,s?v(e):e})),u}(C,k,T,a);else{var A=function(e,t){return"object"==o(e)?e.className=t:e={text:e,className:t},e};m(T,S,r,(function(e){return A(e,"CodeMirror-hint-table CodeMirror-hint-default-table")})),m(T,S,t,(function(e){return A(e,"CodeMirror-hint-table")})),b||m(T,S,n,(function(e){return A(e.toUpperCase(),"CodeMirror-hint-keyword")}))}return{list:T,from:l(C.line,x),to:l(C.line,w)}}))}))}).call(this,r(19)(e))},75:function(e,t,r){(function(e){var n,i,a;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){"object"==o(t)&&"object"==o(e)?l(r(6)):(i=[r(6)],void 0===(a="function"==typeof(n=l)?n.apply(t,i):n)||(e.exports=a))}((function(e){"use strict";e.modeInfo=[{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]}];for(var t=0;t<e.modeInfo.length;t++){var r=e.modeInfo[t];r.mimes&&(r.mime=r.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var r=0;r<e.modeInfo.length;r++){var n=e.modeInfo[r];if(n.mime==t)return n;if(n.mimes)for(var i=0;i<n.mimes.length;i++)if(n.mimes[i]==t)return n}return/\+xml$/.test(t)?e.findModeByMIME("application/xml"):/\+json$/.test(t)?e.findModeByMIME("application/json"):void 0},e.findModeByExtension=function(t){for(var r=0;r<e.modeInfo.length;r++){var n=e.modeInfo[r];if(n.ext)for(var i=0;i<n.ext.length;i++)if(n.ext[i]==t)return n}},e.findModeByFileName=function(t){for(var r=0;r<e.modeInfo.length;r++){var n=e.modeInfo[r];if(n.file&&n.file.test(t))return n}var i=t.lastIndexOf("."),a=i>-1&&t.substring(i+1,t.length);if(a)return e.findModeByExtension(a)},e.findModeByName=function(t){t=t.toLowerCase();for(var r=0;r<e.modeInfo.length;r++){var n=e.modeInfo[r];if(n.name.toLowerCase()==t)return n;if(n.alias)for(var i=0;i<n.alias.length;i++)if(n.alias[i].toLowerCase()==t)return n}}}))}).call(this,r(19)(e))},76:function(e,t,r){},77:function(e,t,r){},82:function(e,t,r){"use strict";r.r(t);r(28),r(29),r(39),r(33),r(71),r(40);function n(e,t,r,n){var i="tfac-"+n+"-"+t;$("."+i).removeClass(i);var a=r[e];if(a){var o=a[n+"Params"];if(o){var l=o.map((function(e){return"#macro-param-div-"+e}));$(l.join(",")).addClass(i)}}}function i(e){e&&$.each(e,(function(e,t){$("#macro-param-div-"+e).find("label").text(t)}))}var a={initSelects:function(e,t){$.each(e,(function(r){var a=$("#macro-param-"+r),o=e[r];!function(e,t){e.find("option").each((function(){var e=$(this),r=e.attr("value");e.text(t[r].title)}))}(a,o),function(e,t,r,a){e.change((function(){var r=e.val();n(r,a,t,"hidden"),n(r,a,t,"shown"),function(e,t,r){r.__default&&i(r.__default.labels);i(r[e].labels)}(r,0,t)})).val(r[a]||Object.keys(t)[0]).trigger("change")}(a,o,t,r)}))}};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"transformElements",value:function(e){this.initSelects(e)}},{key:"initSelects",value:function(e){var t={source:{url:{title:"URL",hiddenParams:["attachment"]},attachment:{title:"Attachment",hiddenParams:["url","auth-type","login","password","header"]}},"auth-type":{basic:{title:"Login and password",hiddenParams:["header"]},header:{title:"Custom",hiddenParams:["login","password"]}}};a.initSelects(t,e)}}])&&o(t.prototype,r),n&&o(t,n),e}(),s=function(){};s.prototype.beforeParamsSet=function(e){var t;return $("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Table%2BFilter%2Band%2BCharts%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e.  "),(new l).transformElements(e),(t=$("#macro-param-attachment")).addClass("autocomplete-attachment").attr("data-template","{wikiLink}").attr("data-none-message","Nothing found"),Confluence.Binder.autocompleteAttachment(t.parent()),t.bind("selected.autocomplete-content",(function(e,r){var n=r.content.wikiLink.substring(1,r.content.wikiLink.length-1);if(AJS.params.spaceKey===r.content.space.key){n=n.replace("".concat(AJS.params.spaceKey,":"),"");var i=r.content.datePath?"/".concat(r.content.datePath,"/").concat(r.content.parentTitle):r.content.parentTitle;AJS.params.pageTitle===i&&(n=n.replace("".concat(AJS.params.pageTitle,"^"),""))}t.val(n)})),function(e){var t=e&&e.password?e.password:"";$("#macro-param-password").replaceWith('<input type="password" class="text macro-param-input" id="macro-param-password" value="'.concat(t,'">'))}(e),e};var c=s,u=function(){};u.prototype.beforeParamsSet=function(e){return function(e){var t=$("#macro-param-labels");e&&e.labels&&t.val(e.labels);t.auiSelect2(Confluence.UI.Components.LabelPicker.build({separator:",",queryOpts:{spaceKey:AJS.Meta.get("space-key")}}))}(e),function(e){var t={type:{this:{title:"Current page",hiddenParams:["page","labels","labels-operator","space"]},page:{title:"Specific page",hiddenParams:["copytable","labels","labels-operator","space"]},"page-children":{title:"Page and child pages",hiddenParams:["copytable","labels","labels-operator","space"]},"page-descendants":{title:"Page and all descendants",hiddenParams:["copytable","labels","labels-operator","space"]},labels:{title:"Pages with labels",hiddenParams:["copytable","page"]}},"labels-operator":{OR:{title:"at least one label"},AND:{title:"all the labels above"}}};a.initSelects(t,e)}(e),e};var d=u,p=r(0),f=r(4),h=r.n(f),m=r(3),g=r(2),v=r(5),b=r.n(v),y=r(15),x=r.n(y);function w(e,t,r){return e[t.type+t.field]||e[t.type]||r}function S(e,t,r){var n;return function(e,t){var r=e.find("input"),n=e.find("label");r.hide(),n.hide(),e.prepend(x.a.subtleButton({id:t,name:n.text()})),$("#inline-dialog-"+t).remove(),function(e){$("#macro-insert-container .macro-input-fields").scroll((function(){$("#inline-dialog-"+e).hide()}));var t=$.fn.hide;$.fn.hide=function(){return"macro-browser-dialog"==this.attr("id")&&$("#inline-dialog-"+e).hide(),t.apply(this,arguments)}}(t)}(e,t.dialogName),t.container=(r||$(document)).find("#button-"+t.dialogName),t.bindsCallback=(n=t.bindsCallback,function(e){"function"==typeof n&&n(e),function(e,t){$(".macro-param-div .aui-button-subtle:not(#button-"+e+")").removeClass("active"),$(".aui-inline-dialog:not(#inline-dialog-"+e+")").hide(),t.popup.css("z-index","5000"),$(".tf-macrobrowser-tabs .menu-item:not(.active-tab)").click((function(){return t.hide(),!1})),$("#button-"+e).click((function(){if($(this).hasClass("active"))return t.hide(),!1}))}(t.dialogName,e)}),m.a.initAJSDialog(t)}function C(e,t,r){e.find("div.field-group").find("select, .simple-input, .range, .checkbox").each((function(){var e=$(this),n=e.data("type"),i="global"==n||"hideColumns"==n?"":e.prev().text();if(e.hasClass("checkbox"))t.values[n+i]=e.is(":checked");else if(e.hasClass("simple-input"))t.values[n+i]=r?e.val():e.val().replace(/,/g,"");else if(e.hasClass("range")){var a=e.find(".from").val(),o=e.find(".to").val();if(t.locale&&e.hasClass("dates"))try{a=p.a.dateToUTCTimestamp(a,t.dateFormat,t.locale),o=p.a.dateToUTCTimestamp(o,t.dateFormat,t.locale)}catch(e){}t.values[n+i]=(a+"->"+o).replace(/,/g,"")}else{var l=[];e.find("option:selected").each((function(){l.push(this.textContent.replace(/,/g,""))})),t.values[n+i]=l.join("&&")}}))}var T={initMacroBrowserChartColorsDialog:function(e,t){var r;return S(t,{dialogName:"tf-chart-colors",dialogId:"tf-chart-colors",options:{persistent:!0,width:220,gravity:"w"},getContent:function(){r=[],e.updatePieKeys();var t=e.TableChart.getChartColorLabels(),n=[];return t.forEach((function(t,i){var a=e.colors[i%e.colors.length];r.push(a),n.push({color:a,field:t,id:"tf-chart-colors",variant:m.a.FIELD_VARIANTS.COLORS})})),b.a.inlineDialog({clazz:"tf-chart-colors-dialog",name:"chart-colors",inputs:n,dialogId:"tf-chart-colors"})},applyCallback:function(){p.a.chartColors.forEach((function(e){-1==$.inArray(e,r)&&r.push(e)})),e.colors=r},bindsCallback:function(e){e.popup.find(".tfc-color:not(.selected)").on("click",(function(){var t=$(this);r[t.data("index")]=t.data("color"),e.popup.find("button .tfc-color").eq(t.data("index")).css("background",t.data("color")).attr("data-color",t.data("color"))}))}})},initMacroBrowserInterpolationDialog:function(e,t){var r="tf-interpolation-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:250,gravity:"w"},getContent:function(){var t=[];return e.chartKeys.forEach((function(r,n){e.savedInterpolation[r]||(e.savedInterpolation[r]=e.defaultInterpolation?e.defaultInterpolation:"Linear"),t.push({field:r,value:e.savedInterpolation[r],variant:m.a.FIELD_VARIANTS.INTERPOLATION_SELECT})})),b.a.inlineDialog({clazz:r,name:"interpolation",inputs:t,dialogId:r})},applyCallback:function(t){var r=[];t.popup.find("form").find("select").each((function(t,n){var i=$(n),a=i.val();e.savedInterpolation[i.data("name")]=a,r.push(a)})),$("#macro-param-interpolation").val(r.join(","))}})},initMacroBrowserLineSettingsDialog:function(e,t){var r="tf-line-settings-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:250,gravity:"w"},getContent:function(){var t=[];return e.chartKeys.forEach((function(r,n){e.savedLineSettings[r]||(e.savedLineSettings[r]={type:"solid",width:1.5}),t.push({field:r,value:e.savedLineSettings[r],variant:m.a.FIELD_VARIANTS.LINE_SETTINGS})})),b.a.inlineDialog({clazz:r,name:"line-settings",inputs:t,dialogId:r})},applyCallback:function(t){var r=[];t.popup.find("form").find(".field-group").each((function(t,n){var i=$(n),a=i.find("label").text(),o=Math.abs(parseFloat(i.find("input").val())),l=i.find("select").val();e.savedLineSettings[a]={type:l,width:o},r.push(l+"-"+o.toString())})),$("#macro-param-line-settings").val(r.join(","))}})},initMacroBrowserWorklogDialog:function(e,t){var r="tf-worklog-dialog",n=(t||$(document)).find("#macro-param-div-worklog"),i=n.find("#macro-param-worklog").val(e||g.a.getStoredValue("tf-worklog")||"365|5|8|y w d h m|y w d h m");return S(n,{dialogName:r,dialogId:r,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=i.val().split("|");isNaN(e[2])&&e.unshift(365),e.length<5&&(e[4]="y w d h m");var t=e[4].split(" ");t.length<5&&t.unshift("y");var n=[{field:"Days in year",value:e[0],type:"number",variant:m.a.FIELD_VARIANTS.NUMBER,min:1,max:366},{field:"Days in week",value:e[1],type:"number",variant:m.a.FIELD_VARIANTS.NUMBER,min:1,max:7},{field:"Hours in day",value:e[2],type:"number",variant:m.a.FIELD_VARIANTS.NUMBER,min:1,max:24},{field:"Time format",value:[e[3]],type:"single-select",variant:m.a.FIELD_VARIANTS.SINGLE_SELECT,selects:["y w d h m","w d h m","y w d h","w d h","d h m","d h","d","h m","h"],fakeSelects:[]},{field:"Year shortening",value:t[0],type:"text",variant:m.a.FIELD_VARIANTS.TEXT,help:"https://docs.stiltsoft.com/display/TFAC/FAQ?from=macro#FAQ-Whydomacrosprocessmyworklogvaluesincorrectly?"},{field:"Week shortening",value:t[1],type:"text",variant:m.a.FIELD_VARIANTS.TEXT,help:"https://docs.stiltsoft.com/display/TFAC/FAQ?from=macro#FAQ-Whydomacrosprocessmyworklogvaluesincorrectly?"},{field:"Day shortening",value:t[2],type:"text",variant:m.a.FIELD_VARIANTS.TEXT,help:"https://docs.stiltsoft.com/display/TFAC/FAQ?from=macro#FAQ-Whydomacrosprocessmyworklogvaluesincorrectly?"},{field:"Hour shortening",value:t[3],type:"text",variant:m.a.FIELD_VARIANTS.TEXT,help:"https://docs.stiltsoft.com/display/TFAC/FAQ?from=macro#FAQ-Whydomacrosprocessmyworklogvaluesincorrectly?"},{field:"Minute shortening",value:t[4],type:"text",variant:m.a.FIELD_VARIANTS.TEXT,help:"https://docs.stiltsoft.com/display/TFAC/FAQ?from=macro#FAQ-Whydomacrosprocessmyworklogvaluesincorrectly?"}];return b.a.inlineDialog({clazz:r,name:"worklog",inputs:n,dialogId:r})},applyCallback:function(e){var t=[],r=e.popup.find("form");t.push(r.find("input").eq(0).val()),t.push(r.find("input").eq(1).val()),t.push(r.find("input").eq(2).val()),t.push(r.find("select").val());var n=[];n.push(r.find("input").eq(3).val().trim()||"y"),n.push(r.find("input").eq(4).val().trim()||"w"),n.push(r.find("input").eq(5).val().trim()||"d"),n.push(r.find("input").eq(6).val().trim()||"h"),n.push(r.find("input").eq(7).val().trim()||"m"),t.push(n.join(" ")),t=t.join("|"),i.val(t),g.a.storeValue("tf-worklog",t)}},t)},initMacroBrowserDefaultValueDialog:function(e,t){var r="tf-default-value-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:250,gravity:"w"},getContent:function(){var t=[];return e.getSelectedFilters().forEach((function(r){var n,i,a=[],o=[];if(m.a.isAllColumnsFilter(r.type))n=e.defaults[r.type]||"",m.a.isMultiSelectFilter(r.type)&&(n=n.split("&&"),a=e.tableColumns.slice());else if(n=e.defaults[r.type+r.field]||"",m.a.isMultiSelectFilter(r.type)&&(a=e.getSelectFilterOptions(r.field,r.isIcon,e),n=n.split("&&"),$.each(a,(function(e,t){""==t&&(a[e]="-Empty-")})),$.each(n,(function(e,t){""!=t&&-1==$.inArray(t,a)&&o.push(t)}))),m.a.isRangeFilter(r.type)&&n){var l=n.split("->");n=l[0],i=l[1],r.isDate&&(n=p.a.convertToDate(n,e.dateFormatInput.val(),e.locale),i=p.a.convertToDate(i,e.dateFormatInput.val(),e.locale))}t.push({field:r.field,value:n,valueTo:i,selects:a,fakeSelects:o,type:r.type,isMultiple:!0,isIcon:r.isIcon,isDate:r.isDate,variant:m.a.fieldTypeToVariant(r.type)})})),b.a.inlineDialog({clazz:r,name:"default-value",inputs:t,dialogId:r})},applyCallback:function(t){C(t.popup.find("form"),{values:e.defaults,locale:e.locale,dateFormat:e.dateFormatInput.val()},!1)},bindsCallback:function(t){p.a.initChosen(t.popup),p.a.initDatePickerLocalisations(e.locale),t.popup.find(".date").each((function(){$(this).datePicker({overrideBrowserDefault:!0,dateFormat:e.dateFormatInput.val()||"yy-mm-dd",languageCode:e.locale})}))}})},initMacroBrowserCellWidthDialog:function(e,t){var r="tf-cell-width-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:200,gravity:"w"},getContent:function(){var t=[];return e.getSelectedFilters().forEach((function(r){m.a.isRangeFilter(r.type)||t.push({field:r.field,value:w(e.widths,r,""),type:r.type,variant:m.a.FIELD_VARIANTS.NUMBER})})),b.a.inlineDialog({clazz:r,name:"cell-width",inputs:t,dialogId:r})},applyCallback:function(t){C(t.popup.find("form"),{values:e.widths},!1)}})},initMacroBrowserInverseFilterDialog:function(e,t){var r="tf-inverse-filter-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:200,gravity:"w"},getContent:function(){var t=[];return e.getSelectedFilters().forEach((function(r){t.push({field:r.field,value:w(e.inverse,r,!1),type:r.type,variant:m.a.FIELD_VARIANTS.CHECKBOX})})),b.a.inlineDialog({clazz:r,name:"inverse-filter",inputs:t,dialogId:r})},applyCallback:function(t){C(t.popup.find("form"),{values:e.inverse},!1)}})},initMacroBrowserFilterLabelsDialog:function(e,t){var r="tf-filter-labels-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:200,gravity:"w"},getContent:function(){var t=[];return e.getSelectedFilters().forEach((function(r){t.push({field:r.field,value:w(e.labels,r,r.field),type:r.type,variant:m.a.FIELD_VARIANTS.TEXT})})),b.a.inlineDialog({clazz:r,name:"filter-labels",inputs:t,dialogId:r})},applyCallback:function(t){C(t.popup.find("form"),{values:e.labels},!0)}})},initMacroBrowserTotalRowDialog:function(e,t){var r="tf-total-row-dialog";return S(t,{dialogName:r,dialogId:r,options:{persistent:!0,width:200,gravity:"w"},getContent:function(){var t=[],n=[],i=["","Sum","Average","Multiplication","Min","Max","Count","Count not empty"];return e.tables.forEach((function(e){e.length&&(n=$.merge(n,e[0]))})),e.body.find("tr:first-child").find("th.tf-numbering, th.tf-sparkline-header, th.total-col").each((function(){var e=$.inArray(this.textContent.trim(),n);e>=0&&n.splice(e,1)})),n.forEach((function(r,n){t.push({field:r,value:[e.totalRow[n]||""],type:"single-select",selects:i,fakeSelects:[],variant:m.a.FIELD_VARIANTS.SINGLE_SELECT})})),b.a.inlineDialog({clazz:r,name:"total-row",inputs:t,dialogId:r})},applyCallback:function(t){var r=[];t.popup.find("form").find("div.field-group").find("select").each((function(){r.push($(this).find("option:selected").text())})),e.totalRow=r,e.totalRowInput.val(r.join(",")).trigger("change")}})}},k={initDateFormatInput:function(e,t){k.initDateFormatInputInContainer(e,t,$(document))},initDateFormatInputInContainer:function(e,t,r){var n=r.find("#macro-param-datepattern").val(e.datepattern||e.dateFormat||g.a.getStoredValue("tf-dateformat")||p.a.getLocaleDateFormat("yy-mm-dd"));p.a.dateFormatAutocomplete(n,t)},bindPreview:function(e,t){var r=null;new MutationObserver((function(n){n.some((function(n){if(n.addedNodes.length){var i=$(n.addedNodes);!p.a.isIgnoreUpdateNode(i)&&(p.a.hasRowForUpdate(i)||p.a.hasTableForUpdate(i)||p.a.hasCharsForUpdate(i,n.target))&&(clearTimeout(r),r=setTimeout((function(){r=null,t(e)}),100))}}))})).observe(e[0],{childList:!0,subtree:!0})}},A=k,L=r(11),_=(r(72),r(73),r(74),r(75),r(76),r(77),r(6)),I=r.n(_),M=r(43),P=r.n(M),O={unionQuery:"SELECT * FROM T*",joinQuery:"SELECT * FROM T1 OUTER JOIN T* ON T1.? = T*.?",textAreaEditor:null,showDialog:function(e,t,r,n,i){this.previewSrc=i?i():"",this.isInsert=null==e.params.sql,e.params.sql||(e.params.sql=this.unionQuery);var a="true"===e.params.transpose;this.tablesNRows=this.getTables(e.bodyView,a),this.commonColumns=p.a.getCommonColumns(this.tablesNRows.tables,p.a.textNViewType);var o=e.params["join-column"];o&&-1===this.commonColumns.indexOf(o)&&this.commonColumns.push(o),this.dialog=$(P.a.dialog({params:e.params,isInsert:this.isInsert,joinColumns:this.commonColumns,previewSrc:this.previewSrc})),AJS.dialog2(this.dialog).show(),this.initElements(e.params.isCloud),this.bindButtons(e,t,r),this.initTabs(),this.bindInputs(e.params),this.initWizard(e.params),this.setButtons(),this.jsons=this.getJSONs(),this.bindPreview(e,n),this.setPreview(e.bodyView),this.refreshPreview(e,n)},initElements:function(e){this.sqlInput=this.dialog.find("#sql-param"),this.joinColumnWraps=this.dialog.find(".join-column-field-group"),this.joinColumnWrapper=this.dialog.find("#join-column-field-group"),this.joinColumnMessage=this.dialog.find("#join-column-field-message"),this.joinColumnSelect=this.joinColumnWrapper.find("#join-column-param"),this.unionPreset=this.dialog.find("#tj-union"),this.joinPreset=this.dialog.find("#tj-join"),this.customPreset=this.dialog.find("#tj-custom"),this.presets=this.dialog.find(".tj-preset"),this.msg=this.dialog.find("#sql-error"),this.nextBtn=e?AP.dialog.getButton("next-btn"):this.dialog.find(".tj-next"),this.saveBtn=this.dialog.find(".tj-insert"),this.previewSpinner=this.dialog.find("#tj-preview-spinner"),this.initIframe()},initIframe:function(){this.iframe=this.dialog.find("#tj-preview-content iframe")[0],this.iframeDoc=this.iframe.contentDocument||this.iframe.contentWindow.document},bindButtons:function(e,t,r){var n=this;function i(){var e=n.getActivePane();e.is("#tj-sql")?AJS.tabs.change(n.dialog.find('a[href="#tj-options"]')):e.is("#tj-wizard")&&(n.customPreset.hasClass("active")||n.joinPreset.hasClass("active")&&!n.commonColumns.length)?AJS.tabs.change(n.dialog.find('a[href="#tj-sql"]')):AJS.tabs.change(n.dialog.find('a[href="#tj-view"]')),n.setButtons()}e.params.isCloud?AP.events.on("dialog.button.click",(function(e){"next-btn"===e.button.name&&i()})):(n.saveBtn.click((function(){n.textAreaEditor=null,e.params=n.getParams(n.dialog),t(e),AJS.dialog2(n.dialog).hide()})),n.dialog.find(".tj-cancel").click((function(){n.textAreaEditor=null,AJS.dialog2(n.dialog).hide(),r()})),n.nextBtn.click((function(){i()})))},bindInputs:function(e){var t,r=this;r.sqlInput.bind("input",(function(){clearTimeout(t),t=setTimeout((function(){var e=r.getParams();r.validateSQL(e),r.selectPreset(e)}),1e3)})),r.joinColumnSelect.change((function(){r.sqlInput.val(r.getJoinQuery(r.joinColumnSelect.val())).trigger("change")})),r.dialog.find("#macro-param-transpose").change((function(){r.tablesNRows.tables=p.a.transpose(r.tablesNRows.tables),r.updateColumns()})),A.initDateFormatInputInContainer(e,r.dialog.find("#tj-options"),r.dialog),T.initMacroBrowserWorklogDialog(e.worklog,r.dialog)},bindPreview:function(e,t){var r=this,n=r.dialog.find("#tj-preview"),i=n.find("#tj-preview-sidebar"),a=i.find("#tj-refresh-preview"),o=r.getParams();i.click((function(){n.hasClass("expanded")||JSON.stringify(o)===JSON.stringify(r.getParams())||(o=r.refreshPreview(e,t)),n.toggleClass("expanded")})),a.click((function(){if(n.hasClass("expanded"))return o=r.refreshPreview(e,t),!1})),r.dialog.find("#tj-main-tabs").click((function(){n.removeClass("expanded")}))},initWizard:function(e){var t=this;t.selectPreset(e),t.presets.click((function(){var r=$(this);if(!r.hasClass("active")){var n=t.getParams();if(t.customPreset.hasClass("active")){t.msg.empty();var i=n.sql;i!==t.unionQuery&&i!==t.getJoinQuery(n["join-column"])&&t.customPreset.data("sql",i)}t.presets.removeClass("active"),r.addClass("active"),r.is(t.joinPreset)?(t.sqlInput.val(t.getJoinQuery(n["join-column"])).trigger("change"),t.joinColumnWraps.addClass("active")):(t.joinColumnWraps.removeClass("active"),r.is(t.unionPreset)?t.sqlInput.val(t.unionQuery).trigger("change"):r.is(t.customPreset)&&r.data("sql")&&(t.sqlInput.val(r.data("sql")).trigger("change"),t.validateSQL(e))),t.setButtons()}})).dblclick((function(){e.isCloud?AP.events.emit("dialog.button.click",{button:{name:"next-btn"}}):t.nextBtn.click()}))},initTabs:function(){var e=this;AJS.tabs.setup(),e.dialog.bind("tabSelect",(function(){e.setButtons()}))},bindMenuItem:function(e){var t=this;if(e){var r={attributes:!0,attributeOldValue:!1,characterData:!1,characterDataOldValue:!1,childList:!1,subtree:!1,attributeFilter:["class"]},n=new MutationObserver((function(e){e.forEach((function(e){e.target.className.indexOf("active-tab")>-1&&t.setButtons()}))}));$(".menu-item").each((function(){n.observe(this,r)}))}},selectPreset:function(e){this.presets.removeClass("active"),this.joinColumnWraps.removeClass("active"),this.unionQuery===e.sql?this.unionPreset.addClass("active"):this.getJoinQuery(e["join-column"])===e.sql?(this.joinPreset.addClass("active"),this.joinColumnWraps.addClass("active")):e.sql&&this.customPreset.addClass("active")},setButtons:function(){var e=this.getActivePane();e.is("#tj-view")?(this.nextBtn.hide(),this.saveBtn.addClass("aui-button-primary")):(this.nextBtn.show(),this.saveBtn.removeClass("aui-button-primary"),e.is("#tj-sql")&&this.initHighlightTextArea())},refreshPreview:function(e,t){var r=this;return $(r.iframe).replaceWith('<iframe src="'+r.previewSrc+'"></iframe>'),r.initIframe(),$(r.iframe).hide(),r.previewSpinner.show(),e.params=r.getParams(),t(e,(function(e){r.setPreview(e)})),e.params},setPreview:function(e){var t=this;t.initIframe();var r=$(t.iframeDoc);function n(e){p.a.normalizeTable(p.a.getTableNodes(e));var r=t.getParams().transpose;t.tablesNRows=p.a.getTablesAndRows(e,p.a.textNViewType,null,r),t.updateColumns()}t.iframe.onload=function(){var e=r.find(".tj-source").eq(0);e.length&&(t.previewSpinner.hide(),n(e),A.bindPreview(e,n),p.a.addIframe(e,"tj-source",n)),$(t.iframe).show()},t.iframeDoc.write(e),t.iframeDoc.close()},updateColumns:function(){var e=O;e.jsons=e.getJSONs(),e.commonColumns=p.a.getCommonColumns(e.tablesNRows.tables,p.a.textNViewType),e.joinColumnSelect.find("option:not(selected)").remove();var t=e.joinColumnSelect.val();e.commonColumns.forEach((function(r){r!==t&&e.joinColumnSelect.append($("<option></option>").text(r).attr("value",r))}));var r=null!=t||e.commonColumns.length>0;e.joinColumnWrapper.toggleClass("hidden",!r),e.joinColumnMessage.toggleClass("hidden",r)},getActivePane:function(){return this.dialog.find(".active-pane")},getTables:function(e,t){return e=-1===e.indexOf("<body")?$('<div class="tj-source"></div>').html(e):$(e.substring(e.indexOf("<body"),e.indexOf("</body"))).find(".tj-source"),p.a.normalizeTable(p.a.getTableNodes(e)),p.a.getTablesAndRows(e,p.a.textNViewType,{skip:["tf-hidden-column","pivot-hidden-column"],include:["pivot-export"]},t)},getJSONs:function(){var e=O.getParams(),t=L.a.convertTablesToJSON(this.tablesNRows,{separator:e.separator||".",worklog:p.a.getWorklog(e.worklog),dateFormat:e.dateFormat||"yy-mm-dd"});return L.a.prepareAlaSql(t,e),t},validateSQL:function(e){var t;if(e.sql.trim())try{e.sql=e.sql.replace(/\\\\/g,"\\"),e.worklog=p.a.getWorklog(e.worklog),h.a.compile(L.a.normalizeSql(e,this.jsons))}catch(e){(t=e.message).length>200&&(t=t.substring(0,200).trim()+"")}else t="Please, specify SQL query.";return this.msg.empty(),t&&AJS.messages.error(this.msg,{body:t,closeable:!0}),!t},getParams:function(){var e={};return this.dialog.find("[data-param]").each((function(){var t,r=$(this);t=r.is(".checkbox")?r.is(":checked"):(r.val()||"").trim(),e[r.data("param")]=t})),e},getJoinQuery:function(e){return e?this.joinQuery.replace(/\?/g,"'"+e+"'"):this.joinQuery},getHintOptions:function(){var e={},t=this.jsons.jsons;return $.each(t,(function(r){e[r]=t[r].columns.map((function(e){var t=L.a.unescapeColumn(e.text).replace(/'/g,"\\\\'");return-1!==t.indexOf("`")?"["+t+"]":"'"+t+"'"}))})),e},initHighlightTextArea:function(){var e=this;if(null===e.textAreaEditor){e.textAreaEditor=I.a.fromTextArea(e.sqlInput[0],{mode:{name:"text/x-sql",keywords:{abs:!0,add:!0,after:!0,all:!0,alter:!0,and:!0,any:!0,as:!0,asc:!0,at:!0,avg:!0,begin:!0,between:!0,by:!0,case:!0,cast:!0,check:!0,close:!0,coalesce:!0,column:!0,commit:!0,constraint:!0,constraints:!0,corresponding:!0,count:!0,create:!0,cross:!0,cube:!0,current_timestamp:!0,date:!0,day:!0,declare:!0,default:!0,delete:!0,desc:!0,distinct:!0,double:!0,drop:!0,else:!0,end:!0,escape:!0,except:!0,execute:!0,exists:!0,false:!0,first:!0,foreign:!0,from:!0,full:!0,get:!0,global:!0,group:!0,grouping:!0,having:!0,hour:!0,identity:!0,if:!0,in:!0,inner:!0,insert:!0,intersect:!0,into:!0,is:!0,join:!0,left:!0,like:!0,max:!0,min:!0,minute:!0,month:!0,natural:!0,new:!0,not:!0,null:!0,nullif:!0,of:!0,offset:!0,on:!0,or:!0,order:!0,out:!0,outer:!0,percent:!0,precision:!0,primary:!0,range:!0,references:!0,return:!0,returns:!0,right:!0,rollback:!0,rollup:!0,row:!0,schema:!0,search:!0,second:!0,select:!0,set:!0,sets:!0,some:!0,substring:!0,sum:!0,table:!0,temporary:!0,then:!0,time:!0,timestamp:!0,to:!0,trigger:!0,trim:!0,true:!0,union:!0,unique:!0,update:!0,upper:!0,using:!0,value:!0,values:!0,var_pop:!0,var_samp:!0,varchar:!0,view:!0,when:!0,where:!0,while:!0,with:!0,work:!0,year:!0,formatdate:!0,array:!0,greatest:!0,least:!0,replace:!0,formattime:!0,formatworklog:!0,formatnumber:!0,median:!0,stdev:!0,stddev:!0,var:!0,varp:!0,ceil:!0,exp:!0,floor:!0,ifnull:!0,iif:!0,instr:!0,isnull:!0,lcase:!0,length:!0,mid:!0,power:!0,random:!0,round:!0,rownum:!0,sqrt:!0,substr:!0,ucase:!0,weekday:!0,subdate:!0,regexp_like:!0,now:!0,interval:!0,date_sub:!0,date_add:!0,datediff:!0}},indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,hintOptions:{tables:e.getHintOptions()}}),e.textAreaEditor.on("change",(function(t){t.save(),e.sqlInput.trigger("input")})),e.sqlInput.bind("change",(function(){e.textAreaEditor.getDoc().setValue(e.sqlInput.val())}));var t=[38,40],r=[37,39],n=!1;e.textAreaEditor.on("keyup",(function(e,i){i.ctrlKey&&32===i.keyCode&&(n=!n),27===i.keyCode&&(n=!1),t.indexOf(i.keyCode)>-1||!n&&r.indexOf(i.keyCode)>-1||e.state.completionActive||13===i.keyCode||27===i.keyCode||I.a.commands.autocomplete(e,null,{completeSingle:!1})})),e.textAreaEditor.on("mousedown",(function(e){n=!1,e.state.completionActive&&e.state.completionActive.close()}))}else e.textAreaEditor.refresh()}},N=O,D={convertStorageToView:function(e,t){return e.indexOf(' data-macro-name="')>=0&&e.indexOf(' data-macro-parameters="')>=0&&$.ajax({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/api/contentbody/convert/storage",contentType:"application/json",dataType:"json",data:JSON.stringify({value:e,representation:"editor"}),success:function(t){e=t.value}}),(e.indexOf("<ac:structured-macro")>=0||e.indexOf("<time")>=0)&&$.ajax({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({contentId:p.a.getContentId(),macro:{body:e,name:t||"table-filter"}}),success:function(t){e=t}}),e},showTabsParam:function(e){p.a.hasTabs($(e))||-1!==e.indexOf("macro 'spreadsheets'")||$("#macro-param-div-tabs").addClass("tf-very-hidden-param")}},F=function(e){if(!e.body){var t=tinymce.activeEditor.selection.getContent();$("<div></div>").html(t).children().length?e.body=t:e.body=""}e.bodyHtml=e.body,e.bodyView=D.convertStorageToView(e.body,e.name),e.params=e.params?e.params:{},e.params.id=(new Date).getTime()+"_"+p.a.hashCode(e.bodyView),N.showDialog(e,E,H,B,W),AJS.MacroBrowser.dialog&&(AJS.MacroBrowser.dialog.activeMetadata=null)};function E(e){tinymce.confluence.macrobrowser.macroBrowserComplete(e)}function H(){tinymce.confluence.macrobrowser.macroBrowserCancel()}function B(e,t){var r={contentId:p.a.getContentId(),macroName:e.name,params:e.params,body:e.bodyHtml,successCallback:function(e){t(e)},errorCallback:function(e){AJS.logError(e)}};AJS.MacroBrowser.Rest.fetchMacroPreviewData(r)}function W(){return AJS.params.staticResourceUrlPrefix+"/blank.html"}var J=AJS.MacroBrowser.previewOnload;AJS.MacroBrowser.previewOnload=function(e){if(AJS.MacroBrowser.dialog&&AJS.MacroBrowser.dialog.activeMetadata)return J(e)};var j=function(){this.tables=[],this.iconTables=[],this.tableColumns=[],this.sortColumns=[],this.columnSelect=null,this.userfilterSelect=null,this.numberfilterSelect=null,this.datefilterSelect=null,this.iconfilterSelect=null,this.sortSelect=null,this.columnParams=[],this.userfilterParams=[],this.numberfilterParams=[],this.datefilterParams=[],this.iconfilterParams=[],this.sortParams=[],this.dateFormatInput=null,this.dateFormatContainer=null,this.separatorContainer=null,this.tfBody="",this.defaults={},this.widths={},this.inverse={},this.gotBody=!1,this.order={},this.labels={},this.totalRow=[],this.locale=AJS.Meta.get("user-locale").replace("-","_")};function z(e,t){return!!e.val()&&-1!==e.val().indexOf(t)}j.prototype.getMacroDetails=function(e){var t=this;t.columnParams=[],t.userfilterParams=[],t.numberfilterParams=[],t.datefilterParams=[],t.iconfilterParams=[],t.sortParams=[],t.chosenUpdated=!1,t.gotBody=!0,t.tfBody=e,t.body=$('<div><div class="tablefilter-table-wrapper">'+e+"</div></div>"),t.tables=p.a.getTables(t.body),t.iconTables=p.a.getTables(t.body,p.a.visualType),t.tableColumns=p.a.getColumns(t.tables),t.sortColumns=[],$.each(t.tableColumns,(function(e,r){$.trim(r).length&&(t.sortColumns.push(r+" "),t.sortColumns.push(r+" "))}))},j.prototype.transformElements=function(e){var t=this,r={thousandSeparator:{"":{title:""},"\\u0020":{title:"Space ( )"},".":{title:"Point (.)"},",":{title:"Comma (,)"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},isOR:{AND:{title:"AND"},OR:{title:"OR"}},numbering:{"":{title:""},"Dynamic Ascending":{title:"Dynamic Ascending"},"Static Ascending":{title:"Static Ascending"},"Dynamic Descending":{title:"Dynamic Descending"},"Static Descending":{title:"Static Descending"}},totalcol:{"":{title:"",hiddenParams:["totalColName","thousandSeparator"]},Sum:{title:"Sum",shownParams:["thousandSeparator"]},Average:{title:"Average",shownParams:["thousandSeparator"]},Multiplication:{title:"Multiplication",shownParams:["thousandSeparator"]},Min:{title:"Min",shownParams:["thousandSeparator"]},Max:{title:"Max",shownParams:["thousandSeparator"]}}};$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Table%2BFilter%2Band%2BCharts%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e.  "),$("#macro-param-div-id").hide();var n=$("#macro-param-limitHeight");n.replaceWith(n.clone().attr("type","number").attr("min","0")),n=$("#macro-param-limitHeight");var i=$("#macro-param-fixedCols");i.replaceWith(i.clone().attr("type","number").attr("min","0"));var o=[],l=[],s=[],c=[],u=[],d=[];null!=e.column&&(o=e.column.split(",")),null!=e.userfilter&&(l=e.userfilter.split(",")),e.sort&&(e.sort=e.sort.replace(/ \(\u200DDesc\)/g," ").replace(/ \(\u200DAsc\)/g," "),d=e.sort.split(",")),null!=e.iconfilter&&(u=e.iconfilter.split(",")),null!=e.totalrow?t.totalRow=e.totalrow.split(","):t.totalRow=[],e.limitHeight="true"==e.limitHeight?1:e.limitHeight,function(e){e.globalFilter&&$("#macro-param-globalFilter").prop("checked",!0);e.hideColumns&&$("#macro-param-hideColumns").prop("checked",!0);e.hidePane&&$("#macro-param-hidePane").prop("checked",!0);e.hidelabels&&$("#macro-param-hidelabels").prop("checked",!0);e.hideControls&&$("#macro-param-hideControls").prop("checked",!0);e.disableSave&&$("#macro-param-disableSave").prop("checked",!0);e.separator&&$("#macro-param-separator").val(e.separator);e.showNRows&&"all"!=e.showNRows&&$("#macro-param-showNRows").val(e.showNRows);e.numbering&&$("#macro-param-numbering").val(e.numbering);e.limitHeight&&$("#macro-param-limitHeight").val(e.limitHeight);e.fixedCols&&$("#macro-param-fixedCols").val(e.fixedCols);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.isOR&&$("#macro-param-isOR").val(e.isOR);e.totalcol&&$("#macro-param-totalcol").val(e.totalcol);e.totalColName&&$("#macro-param-totalColName").val(e.totalColName);e.totalrow&&$("#macro-param-totalrow").val(e.totalrow);e.totalRowName&&$("#macro-param-totalRowName").val(e.totalRowName);"true"==e.disabled&&$("#macro-param-disabled").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.updateSelectOptions&&$("#macro-param-updateSelectOptions").prop("checked",!0)}(e),t.separatorContainer=$("#macro-param-div-separator"),t.dateFormatInput=$("#macro-param-datepattern"),t.totalRowInput=$("#macro-param-totalrow"),null!=e.datefilter&&(c=e.datefilter.split(",")),null!=e.numberfilter&&(s=e.numberfilter.split(",")),!e.worklog&&g.a.getStoredValue("tf-updateSelectOptions")&&(e.updateSelectOptions=!0);var f=$("#macro-param-updateSelectOptions").change((function(){f.is(":checked")?g.a.storeValue("tf-updateSelectOptions",!0):g.a.removeValue("tf-updateSelectOptions")}));A.initDateFormatInput(e),T.initMacroBrowserWorklogDialog(e.worklog);var h=$("#macro-param-column"),m=$("#macro-param-userfilter"),v=$("#macro-param-datefilter"),b=$("#macro-param-numberfilter"),y=$("#macro-param-iconfilter"),w=$("#macro-param-sort"),S=$.merge([],o);$.merge(S,l),$.merge(S,c),$.merge(S,s),$.merge(S,u),$.each(S,(function(e,r){var n=$.trim(r.replace(/\/g,",")).replace("","");-1==$.inArray(n,t.tableColumns)&&(t.tableColumns.push(n),t.sortColumns.push(n+" "),t.sortColumns.push(n+" "))})),$.each(d,(function(e,r){var n=$.trim(r.replace(/\/g,","));-1==$.inArray(n,t.sortColumns)&&t.sortColumns.push(n)})),t.tableColumns.sort(),t.sortColumns.sort(),t.columnSelect=t.createSelect(h,t.tableColumns,o,t.columnParams),t.userfilterSelect=t.createSelect(m,t.tableColumns,l,t.userfilterParams),t.datefilterSelect=t.createSelect(v,t.tableColumns,c,t.datefilterParams),t.numberfilterSelect=t.createSelect(b,t.tableColumns,s,t.numberfilterParams),t.iconfilterSelect=t.createSelect(y,t.tableColumns,u,t.iconfilterParams),t.sortSelect=t.createSelect(w,t.sortColumns,d,t.sortParams),t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),p.a.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),p.a.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),p.a.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),p.a.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),T.initMacroBrowserDefaultValueDialog(t,$("#macro-param-div-default")),T.initMacroBrowserCellWidthDialog(t,$("#macro-param-div-cell-width")),T.initMacroBrowserInverseFilterDialog(t,$("#macro-param-div-inverse")),T.initMacroBrowserFilterLabelsDialog(t,$("#macro-param-div-labels")),T.initMacroBrowserTotalRowDialog(t,$("#macro-param-div-totalrow"));var C=e.default?e.default.split(","):[],k=e["cell-width"]?e["cell-width"].split(","):[],L=e.inverse?e.inverse.split(","):[],_=e.order?e.order.split(","):[],I=e.labels?e.labels.split(""):[],M=0,P=0,O=0,N=0,D=0;p.a.i18nFilterValues(C),t.order.select_=[],$.each(o,(function(e,r){var n=r.replace("","");t.defaults["select_"+n]=C.length>M?C[M++]:"",t.inverse["select_"+n]=L.length>N&&"true"==L[N++],t.widths["select_"+n]=k.length>P?k[P++]:"",t.labels["select_"+n]=I.length>O?I[O++]:"",t.order.select_.push(_.length>D?parseInt(_[D++]):D++)})),t.order.freetext_=[],$.each(l,(function(e,r){var n=r.replace("","");t.defaults["freetext_"+n]=C.length>M?C[M++]:"",t.inverse["freetext_"+n]=L.length>N&&"true"==L[N++],t.widths["freetext_"+n]=k.length>P?k[P++]:"",t.labels["freetext_"+n]=I.length>O?I[O++]:"",t.order.freetext_.push(_.length>D?parseInt(_[D++]):D++)})),t.order.number_=[],$.each(s,(function(e,r){var n=r.replace("","");t.defaults["number_"+n]=C.length>M?C[M++]:"",t.inverse["number_"+n]=L.length>N&&"true"==L[N++],t.labels["number_"+n]=I.length>O?I[O++]:"",t.order.number_.push(_.length>D?parseInt(_[D++]):D++)})),t.order.date_=[],$.each(c,(function(e,r){var n=r.replace("","");t.defaults["date_"+n]=C.length>M?C[M++]:"",t.inverse["date_"+n]=L.length>N&&"true"==L[N++],t.labels["date_"+n]=I.length>O?I[O++]:"",t.order.date_.push(_.length>D?parseInt(_[D++]):D++)})),t.order.global=[],e.globalFilter&&(t.defaults.global=C.length>M?C[M++]:"",t.inverse.global=L.length>N&&"true"==L[N++],t.widths.global=k.length>P?k[P++]:"",t.labels.global=I.length>O?I[O++]:"",t.order.global.push(_.length>D?parseInt(_[D++]):D+++u.length)),t.order.hideColumns=[],e.hideColumns&&(t.defaults.hideColumns=C.length>M?C[M++]:"",t.inverse.hideColumns=L.length>N&&"true"==L[N++],t.widths.hideColumns=k.length>P?k[P++]:"",t.labels.hideColumns=I.length>O?I[O++]:"",t.order.hideColumns.push(_.length>D?parseInt(_[D++]):D+++u.length)),t.order.icon=[],$.each(u,(function(e,r){var n=r.replace("","");t.defaults["icon"+n]=C.length>M?C[M++]:"",t.inverse["icon"+n]=L.length>N&&"true"==L[N++],t.widths["icon"+n]=k.length>P?k[P++]:"",t.labels["icon"+n]=I.length>O?I[O++]:"",t.order.icon.push(_.length>D?parseInt(_[D++]):D++-t.order.hideColumns.length-t.order.global.length)})),t.columnSelect.one("chosen:showing_dropdown",(function(){t.columnSelect.click()}));var F=$("#macro-param-sparkline"),E=$("#macro-param-sparkName");E.val("Sparkline");var H=E.parent();H.addClass("tf-always-hidden"),e.sparkline&&"false"!==e.sparkline&&(F.prop("checked",!0),H.removeClass("tf-always-hidden"),E.val(e.sparkName)),F.change((function(){$(this).prop("checked")?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),H.removeClass("tf-always-hidden")):H.addClass("tf-always-hidden")}));var B=$("#macro-param-heightValue"),W=B.parent();W.addClass("tf-always-hidden"),e.limitHeight&&(n.val(e.limitHeight),W.removeClass("tf-always-hidden"),B.val(e.heightValue)),n.bind("keyup keydown change",(function(){n.val()>0?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),W.removeClass("tf-always-hidden")):W.addClass("tf-always-hidden")})),t.totaRowNameInput=$("#macro-param-div-totalRowName"),t.thousandSeparatorSelect=$("#macro-param-div-thousandSeparator"),t.totalRowInput.change((function(){t.totalRowInput.val().replace(/,/g,"")?(t.totaRowNameInput.removeClass("tf-always-hidden"),t.thousandSeparatorSelect.removeClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.addClass("tfac-shown-totalrow")):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.removeClass("tfac-shown-totalrow"))})),e.totalrow&&e.totalrow.replace(/,/g,"")?t.thousandSeparatorSelect.addClass("tfac-shown-totalrow"):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow")),a.initSelects(r,e),function(e){$("#macro-param-div-column").before(x.a.tableFilterTabs());var t=[$("#macro-param-div-column"),$("#macro-param-div-userfilter"),$("#macro-param-div-numberfilter"),$("#macro-param-div-datefilter"),$("#macro-param-div-iconfilter"),$("#macro-param-div-globalFilter"),$("#macro-param-div-hideColumns")],r=[$("#macro-param-div-separator"),$("#macro-param-div-datepattern"),$("#macro-param-div-default"),$("#macro-param-div-cell-width"),$("#macro-param-div-inverse"),$("#macro-param-div-disableSave"),$("#macro-param-div-hidelabels"),$("#macro-param-div-hidePane"),$("#macro-param-div-hideControls"),$("#macro-param-div-isOR"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-labels"),$("#macro-param-div-disabled"),$("#macro-param-div-worklog"),$("#macro-param-div-updateSelectOptions"),$("#macro-param-div-tabs")],n=[$("#macro-param-div-showNRows"),$("#macro-param-div-numbering"),$("#macro-param-div-sort"),$("#macro-param-div-fixedCols"),$("#macro-param-div-limitHeight"),$("#macro-param-div-sparkline"),$("#macro-param-div-sparkName"),$("#macro-param-div-totalrow"),$("#macro-param-div-totalcol"),$("#macro-param-div-totalColName"),$("#macro-param-div-totalRowName"),$("#macro-param-div-thousandSeparator"),$("#macro-param-div-heightValue")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var i=$("#tab-filters"),a=$("#tab-filter-options"),o=$("#tab-table-options"),l=[i,a,o];function s(e){r(e[0],"in");for(var t=1;t<e.length;t++)r(e[t],"out");function r(e,t){for(var r=0;r<e.length;r++)"in"==t?e[r].show():e[r].hide()}}function c(e){e.hasClass("active-tab")||(l.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}i.click((function(){c(i),s([t,r,n])})),a.click((function(){c(a),s([r,t,n])})),o.click((function(){c(o),s([n,t,r])})),i.trigger("click")}(t.isCloud)},j.prototype.createSelect=function(e,t,r,n){e.hide(),$.each(r,(function(e,t){n.push($.trim(t))})),$.each(r,(function(e,t){r[e]=$.trim(t.replace(/\/g,",")).replace("","")}));var i=$("<select multiple/>");$.each(t,(function(t,n){var a=-1==$.inArray(n,r)?"":'selected="selected" ',o="";if(e.is("#macro-param-sort")){var l=n;l=-1!=l.indexOf("")?l.replace("",""):l.replace("",""),-1!=$.inArray(l,r)&&(o='style="display: none"')}i.append($("<option "+a+o+"></option>").text(n))})),e.after(i),i.chosenTF({no_results_text:"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!0}).change((function(t,r){if(null!=r.selected){if(i.find("option").filter((function(){return this.textContent===r.selected})).prop("selected",!0),""==(l=r.selected)&&(l=""),n.push(l.replace(/\,/g,"")),e.is("#macro-param-sort")){s=-1!=(s=r.selected).indexOf("")?s.replace("",""):s.replace("",""),i.find("option").filter((function(){return this.textContent==s})).hide(),i.trigger("chosen:updated");for(var a=i.parent().find("ul.chosen-choices"),o=n.length-1;o>=0;o--)a.prepend(a.find("li").filter((function(){return this.textContent==n[o].replace(/\/g,",")})))}}else if(null!=r.deselected){var l;if($(this).find("option").filter((function(){return this.textContent==r.deselected})).prop("selected",!1),""==(l=r.deselected)&&(l=""),n.splice($.inArray(l.replace(/\,/g,""),n),1),e.is("#macro-param-sort")){var s;s=-1!=(s=r.deselected).indexOf("")?s.replace("",""):s.replace("",""),i.find("option").filter((function(){return this.textContent==s})).show(),i.trigger("chosen:updated");for(a=i.parent().find("ul.chosen-choices"),o=n.length-1;o>=0;o--)a.prepend(a.find("li").filter((function(e){return this.textContent==n[o].replace(/\/g,",")})))}}e.val(n.join(","))}));var a=p.a.sortSelectedOptions(i,n);return a.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){n=[],a.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),n.push(e.replace(/\,/g,""))})),e.val(n.join(","))}}),i},j.prototype.getSelectFilterOptions=function(e,t){var r=this,n=[],i=[],a=!0,o=$("#macro-param-ddSeparator").val().replace(/\,/g,"").replace(/\\u0020/g," ");return $.each(r.tables,(function(l,s){$.each(s[0],(function(c,u){if(e.toLocaleLowerCase()==u.toLocaleLowerCase()){var d=t?r.iconTables[l]:s;if($.each(d,(function(e,r){if(0!==e)if(t&&r[c]){var l=$(r[c]);l.filter("img").each((function(){var e=p.a.clearStringLowerCase(this.src);-1===$.inArray(e,i)&&(i.push(e),n.push(this.outerHTML))})),l.filter("ul").length&&a&&(a=!1,-1===$.inArray('<ul class="inline-task-list"><li></li></ul>',i)&&(n.push('<ul class="inline-task-list"><li></li></ul>'),i.push('<ul class="inline-task-list"><li></li></ul>')),-1===$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',i)&&(n.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),i.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else if(null!=r[c]){var s=r[c].replace(/\,/g,"");(s=o?s.split(o):[s]).forEach((function(e){e=e.trim(),-1===$.inArray(e,n)&&n.push(e)}))}})),!t&&-1===$.inArray("@currentUser",n)){var f=c+1;r.body.find("table").eq(l).find("tr td:nth-child("+f+"), tr th:nth-child("+f+")").find(".confluence-userlink, ri\\:user").length&&n.push("@currentUser")}}}))})),n},j.prototype.updateColumns=function(e){var t=this;function r(e){t.body=e;var r=!1,n=!1;p.a.normalizeTable(p.a.getTableNodes(e)),t.tables=p.a.getTables(e),t.iconTables=p.a.getTables(e,p.a.visualType),$.each(t.tables,(function(e,i){$.each(i[0],(function(e,i){if(-1==$.inArray(i,t.tableColumns)&&(r=!0,t.tableColumns.push(i),t.columnSelect.append($("<option></option>").val(i).text(i)),t.userfilterSelect.append($("<option></option>").val(i).text(i)),t.datefilterSelect.append($("<option></option>").val(i).text(i)),t.numberfilterSelect.append($("<option></option>").val(i).text(i)),t.iconfilterSelect.append($("<option></option>").val(i).text(i))),$.trim(i).length){if(-1==$.inArray(i+" ",t.sortColumns)){n=!0,t.sortColumns.push(i+" ");var a="";z(t.sortSelect,i+" ")&&(a=' style="display:none"'),t.sortSelect.append($("<option"+a+"></option>").val(i+" ").text(i+" "))}if(-1==$.inArray(i+" ",t.sortColumns)){n=!0,t.sortColumns.push(i+" ");a="";z(t.sortSelect,i+" ")&&(a=' style="display:none"'),t.sortSelect.append($("<option"+a+"></option>").val(i+" ").text(i+" "))}}}))})),r&&(p.a.sortSelectOptions(t.columnSelect),p.a.sortSelectOptions(t.userfilterSelect),p.a.sortSelectOptions(t.datefilterSelect),p.a.sortSelectOptions(t.numberfilterSelect),p.a.sortSelectOptions(t.iconfilterSelect),t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),p.a.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),p.a.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),p.a.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams)),n&&(p.a.sortSelectOptions(t.sortSelect),t.sortSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.sortSelect,t.sortParams))}t.body=e,A.bindPreview(e,r),p.a.addIframe(t.body,"tablefilter-table-wrapper",r),r(e)},j.prototype.getComputationalParams=function(e){var t=null!=e.column?e.column.split(","):[],r=null!=e.userfilter?e.userfilter.split(","):[],n=null!=e.numberfilter?e.numberfilter.split(","):[],i=null!=e.datefilter?e.datefilter.split(","):[],a=null!=e.iconfilter?e.iconfilter.split(","):[],o=[],l=[],s=[],c=[],u=[],d={},f=0;return f=h(this,t,"select_"),f=h(this,r,"freetext_"),f=h(this,n,"number_"),f=h(this,i,"date_"),e.globalFilter&&(f=h(this,[""],"global")),e.hideColumns&&(f=h(this,[""],"hideColumns")),h(this,a,"icon",(e.globalFilter?1:0)+(e.hideColumns?1:0)),u.slice().sort((function(e,t){return e-t})).forEach((function(e,t){u[$.inArray(e,u)]=t})),p.a.unI18nFilterValues(o),e.default=o.join(","),e["cell-width"]=l.join(","),e.inverse=s.join(","),e.labels=c.join(""),e.order=u.join(","),e;function h(e,t,r,n){return $.each(t,(function(t,i){var a=$.trim(i.replace(/\/g,",")).replace("","");o.push(e.defaults[r+a]),"number_"!=r&&"date_"!=r&&l.push(e.widths[r+a]),s.push(e.inverse[r+a]),c.push(e.labels[r+a]);var p=e.order[r][t];if(null==p){if(0==u.length)p=0;else{f=0;var h=u.length-1;"icon"==r&&0==t&&(h-=n),p=h>=0?u[h]+1:0}var m=p-f,g=m;$.each(d,(function(e,t){g>e&&(m-=t)})),d[m]?d[m]++:d[m]=1,u.forEach((function(e,t){e>=p-f&&t<u.length-f&&(u[t]+=1)})),f++}else{f=0;for(var v=p;v>=0;v--)d[v]&&(p+=d[v])}u.push(p)})),f}},j.prototype.getSelectedFilters=function(){var e=[];if($("div.macro-param-div:not(#macro-param-div-sort) .chosen-choices .search-choice").each((function(){var t=$(this),r=t.parents("#macro-param-div-column").length>0,n=t.parents("#macro-param-div-datefilter").length>0,i=t.parents("#macro-param-div-numberfilter").length>0,a=t.parents("#macro-param-div-userfilter").length>0,o=t.parents("#macro-param-div-iconfilter").length>0,l=o?"icon":n?"date_":i?"number_":a?"freetext_":"select_";e.push({field:t.text(),isSelect:r,isDate:n,isNumber:i,isText:a,isIcon:o,type:l})})),$("#macro-param-globalFilter").prop("checked")){var t="Global filter";e.push({field:t,type:"global"})}if($("#macro-param-hideColumns").prop("checked")){var r="Columns to hide";e.push({field:r,type:"hideColumns"})}return e};var R,q=j,U=function(){this.tableFilterMacro=new q};U.prototype.getMacroDetailsFromSelectedMacro=function(e,t){var r=R.tableFilterMacro;R.bodyView=D.convertStorageToView(t.body),r.getMacroDetails(R.bodyView),D.showTabsParam(R.bodyView)},U.prototype.postPreview=function(e){R.tableFilterMacro.updateColumns($(e).contents().find(".tablefilter-table-wrapper"))},U.prototype.beforeParamsSet=function(e){var t=R.tableFilterMacro;return t.gotBody||R.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,"true"==e.numbering?e.numbering="Dynamic Ascending":"Dynamic"==e.numbering&&(e.numbering="Dynamic Ascending"),e.id=(new Date).getTime()+"_"+p.a.hashCode(t.tfBody),t.transformElements(e),""==e.column&&(e.column=""),""==e.userfilter&&(e.userfilter=""),""==e.iconfilter&&(e.iconfilter=""),""==e.datefilter&&(e.datefilter=""),""==e.numberfilter&&(e.numberfilter=""),D.showTabsParam(R.bodyView),e},U.prototype.beforeParamsRetrieved=function(e){var t=R.tableFilterMacro;return t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),p.a.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),p.a.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),p.a.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),p.a.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),e.limitHeight=$("#macro-param-limitHeight").val(),t.getComputationalParams(e)};var V=R=new U,K=r(30),G=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.aggregateSelect=null,this.typeSelect=null,this.tfBody="",this.columnParams=[],this.aggregateParams=[],this.isPivot=!1,this.gotBody=!1,this.transpose=!1,this.colors=[],this.pieKeys=[],this.savedInterpolation={},this.savedLineSettings={},this.isCloud=!1};function Q(e,t,r,n,i,a){e.hide();var o=$("<select multiple/>");return $.each(r,(function(e,r){r=$.trim(r).replace("",""),-1==$.inArray(r,t)&&t.push(r)})),t.sort(),$.each(t,(function(e,t){o.append($("<option></option>").text(t))})),$.each(n,(function(e,r){r=$.trim(r).replace("",""),-1==$.inArray(r,t)&&(t.push(r),o.append($("<option></option>").text(r)))})),e.after(o),function(e,t,r,n,i){$("#macro-param-type");e.chosenTF({no_results_text:"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!0}).change((function(n,a){if(null!=a.selected)e.find("option").filter((function(){return this.textContent==a.selected})).prop("selected",!0),""==(o=a.selected)&&(o=""),r.push(o);else if(null!=a.deselected){var o;e.find("option").filter((function(){return this.textContent==a.deselected})).prop("selected",!1),""==(o=a.deselected)&&(o=""),r.splice($.inArray(o,r),1)}t.val(r.join("")),i&&i.updatePieKeys()}));var a=p.a.sortSelectedOptions(e,r);a.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var e=r.slice();r.length=0,a.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),r.push(e)}));var i=n.slice();e.forEach((function(e,t){var a=$.inArray(e,r);a>=0&&i.length>a&&(n[a]=i[t])})),t.val(r.join(""))}});var o=[];r.forEach((function(e){o.push(e.replace("",""))})),e.val(o),e.trigger("chosen:updated"),t.val(r.join(""))}(o,e,r,i,a),o}function X(e){e.hasClass("chart-browser-hidden")||e.addClass("chart-browser-hidden")}function Y(e){e.hasClass("chart-browser-hidden")&&e.removeClass("chart-browser-hidden")}G.prototype.getMacroDetails=function(e,t,r,n){this.isCloud=n,this.transpose="Horizontal"==t.dataorientation,this.gotBody=!0,this.isPivot=r||!1,this.tfBody=e,this.initTableChart(t),this.setTables(this.tfBody),this.tables=this.TableChart.tables,this.tableColumns=p.a.getColumns(this.tables)},G.prototype.transformElements=function(e){var t=this,r={type:{Pie:{title:"Pie",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle","barColoringType"]},Donut:{title:"Donut",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle","barColoringType"]},Column:{title:"Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Stacked Column":{title:"Stacked Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},Bar:{title:"Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Stacked Bar":{title:"Stacked Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Bubble Pie":{title:"Bubble Pie",hiddenParams:["line-settings","is3d","trendline","interpolation","xlog","log","barColoringType","outerLabels"],labels:{column:"X-axis and Y-axis columns",xtitle:"X-axis label",ytitle:"Y-axis label"}},Line:{title:"Line",hiddenParams:["datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Area:{title:"Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Area":{title:"Stacked Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Line":{title:"Time Line",hiddenParams:["xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Area":{title:"Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Time Area":{title:"Stacked Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Gantt:{title:"Gantt",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","legend","scalestep","interpolation","minvalue","maxvalue","outerLabels"],labels:{ytitle:"Date axis label",xscalestep:"Scale step",xminvalue:"Minimal value",xmaxvalue:"Maximal value"}},Radar:{title:"Radar",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","xscalestep","interpolation","minvalue","barColoringType","datepattern","xminvalue","xmaxvalue","xtitle","ytitle","outerLabels"]},__default:{labels:{aggregation:"Values column",column:"Labels column",xtitle:"Row axis label",log:"Logarithmic scale",xscalestep:"Scale X step",xminvalue:"Minimal X value",xmaxvalue:"Maximal X value",scalestep:"Scale step",minvalue:"Minimal value",maxvalue:"Maximal value",ytitle:"Value axis label"}}},barColoringType:{mono:{title:"Single color",hiddenParams:[]},multi:{title:"Multicolor",hiddenParams:[]}}};if(!e.version&&!e.formatVersion&&(e.version=2,e.formatVersion=2,e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0))){var n=e.column;e.column=e.aggregation,e.aggregation=n}e.type&&e.type.indexOf("3D ")>=0&&(e.type=e.type.replace("3D ",""),e.is3d=!0),e.barColoringType||(e.barColoringType="Gantt"===e.type?"multi":"mono"),$("#macro-param-legend").find("option").each((function(){var e=$(this);"none"==e.attr("value")?e.text("None"):"right"==e.attr("value")?e.text("Right"):e.text("Bottom")})),t.transpose="Horizontal"==e.dataorientation,$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Table%2BFilter%2Band%2BCharts%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e.  "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split(""),$.each(t.columnParams,(function(e,r){t.columnParams[e]=$.trim(r)}))):t.columnParams=t.tableColumns.length?[p.a.getRawColumns(t.tables)[0]]:[],e.aggregation?(t.aggregateParams=e.aggregation.split(""),$.each(t.aggregateParams,(function(e,r){t.aggregateParams[e]=$.trim(r)}))):t.aggregateParams=t.tableColumns.length>1?[p.a.getRawColumns(t.tables)[1]]:[],e.colors&&(t.colors=e.colors.split(",")),p.a.chartColors.forEach((function(e){-1==$.inArray(e,t.colors)&&t.colors.push(e)})),e.pieKeys&&(t.pieKeys=e.pieKeys.split("")),t.defaultInterpolation=null,2!=e.version&&2!=e.formatVersion||(e.version=3,e.formatVersion=3,t.defaultInterpolation=e.interpolation?e.interpolation:"Linear","false"===e.innerlabels?e.innerlabels="None":e.type&&"Pie"!==e.type&&-1===e.type.indexOf("Donut")||(e.innerlabels="Percentage")),function(e){(e.dateFormat||e.datepattern)&&$("#macro-param-datepattern").val(e.dateFormat||e.datepattern);(e["tfc-height"]||e.height)&&$("#macro-param-tfc-height").val(e["tfc-height"]||e.height);(e["tfc-width"]||e.width)&&$("#macro-param-tfc-width").val(e["tfc-width"]||e.width);(e.separator||e.decimalSeparator)&&$("#macro-param-separator").val(e.separator||e.decimalSeparator);"true"!=e.hide&&"true"!=e.hideSource||$("#macro-param-hide").prop("checked",!0);"true"!=e.hideControls&&"true"!=e.hidecontrols||$("#macro-param-hidecontrols").prop("checked",!0);e.dataorientation&&$("#macro-param-dataorientation").val(e.dataorientation);"false"==e.grid?$("#macro-param-grid").prop("checked",!1):$("#macro-param-grid").prop("checked",!0);"string"==typeof e.legend?"false"==e.legend?e.legend="none":"true"==e.legend&&(e.legend="right"):e.legend||void 0===e.legend?e.legend="right":e.legend="none";$("#macro-param-legend").val(e.legend),e.minvalue&&$("#macro-param-minvalue").val(e.minvalue);e.maxvalue&&$("#macro-param-maxvalue").val(e.maxvalue);e.xminvalue&&$("#macro-param-xminvalue").val(e.xminvalue);e.xmaxvalue&&$("#macro-param-xmaxvalue").val(e.xmaxvalue);e.scalestep&&$("#macro-param-scalestep").val(e.scalestep);e.xscalestep&&$("#macro-param-xscalestep").val(e.xscalestep);e.title&&$("#macro-param-title").val(e.title);e.xtitle&&$("#macro-param-xtitle").val(e.xtitle);e.ytitle&&$("#macro-param-ytitle").val(e.ytitle);e.align&&$("#macro-param-align").val(e.align);"true"==e.log&&$("#macro-param-log").prop("checked",!0);"true"==e.xlog&&$("#macro-param-xlog").prop("checked",!0);e.innerlabels&&$("#macro-param-innerlabels").val(e.innerlabels);e.outerLabels&&$("#macro-param-outerLabels").val(e.outerLabels);"true"==e.trendline&&$("#macro-param-trendline").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.is3d&&$("#macro-param-is3d").prop("checked",!0);e.interpolation&&$("#macro-param-interpolation").val(e.interpolation);e["line-settings"]&&$("#macro-param-line-settings").val(e["line-settings"]);e.barColoringType&&$("#macro-param-barColoringType").val(e.barColoringType)}(e);var i=$("#macro-param-column"),o=$("#macro-param-aggregation");t.columnSelect=Q(i,t.tableColumns,t.columnParams,t.aggregateParams,[],t),t.aggregateSelect=Q(o,t.tableColumns,t.aggregateParams,[],t.colors,t),t.typeSelect=$("#macro-param-type"),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),t.dateFormatInput=$("#macro-param-datepattern"),A.initDateFormatInput(e),T.initMacroBrowserWorklogDialog(e.worklog);var l=$("#macro-param-div-colors"),s=$("#macro-param-div-column"),c=$("#macro-param-div-aggregation"),u=$("#macro-param-div-scalestep"),d=$("#macro-param-div-xscalestep"),f=$("#macro-param-div-type"),h=$("#macro-param-div-maxvalue");u.find(".macro-param-desc").addClass("chart-browser-hidden");var m="Gantt"===e.type;t.typeSelect.change((function(){var e=!0,r=t.typeSelect.val().indexOf("Bar")>=0||t.typeSelect.val().indexOf("Column")>=0;t.isGantt="Gantt"===t.typeSelect.val(),t.isBubblePie="Bubble Pie"===t.typeSelect.val(),t.isMultipleChoice=r||t.typeSelect.val().indexOf("Line")>=0||t.typeSelect.val().indexOf("Area")>=0||t.isGantt,u.find(".macro-param-desc").text("For scale X enter number of days (X), months (Xm) or years (Xy)"),t.isBubblePie?Y(u.find(".macro-param-desc").text("For time scales enter number of hours (Xh/Yh), days (X/Y), months (Xm/Ym) or years (Xy/Yy)").removeClass("gantt")):t.typeSelect.val().indexOf("Time")>=0?Y(u.find(".macro-param-desc").removeClass("gantt")):(t.isGantt?Y(u.find(".macro-param-desc").addClass("gantt")):X(u.find(".macro-param-desc")),e="Line"===t.typeSelect.val()||"Area"===t.typeSelect.val()||"Stacked Area"===t.typeSelect.val()),t.isPivot&&(X(s),t.tableColumns.length>2?c.show():X(c)),(t.isGantt?!m:m)&&(m&&t.columnParams.length>1&&(t.columnParams.length=1,t.columnSelect.find("option:selected").removeAttr("selected"),t.columnSelect.find("option").filter((function(){return this.textContent==t.columnParams[0]})).attr("selected","selected"),i.val(t.columnParams[0]),t.columnSelect.trigger("chosen:updated")),m=t.isGantt),d.removeClass("gantt"),f.removeClass("short"),e||t.isBubblePie?u.addClass("multiple").css("display",""):(t.isGantt?d.addClass("gantt"):f.addClass("short"),u.removeClass("multiple")),-1!==t.typeSelect.val().indexOf("Radar")?h.addClass("wide"):h.removeClass("wide")})),e.type||(e.type="Pie"),a.initSelects(r,e),$("#macro-param-dataorientation").change((function(){t.transpose="Horizontal"==$(this).val(),t.tables=p.a.transpose(t.tables),t.tableColumns=p.a.getColumns(t.tables);var e=p.a.getRawColumns(t.tables);t.columnSelect.find("option").remove(),t.aggregateSelect.find("option").remove(),t.columnParams.length=0,t.aggregateParams.length=0,$.each(t.tableColumns,(function(e,r){t.columnSelect.append($("<option></option>").text(r)),t.aggregateSelect.append($("<option></option>").text(r))})),t.columnSelect.val(e[0]).trigger("change",{selected:e[0]}).trigger("chosen:updated"),t.aggregateSelect.val(e[1]).trigger("change",{selected:e[1]}).trigger("chosen:updated")})),t.barColoringTypeSelect=$("#macro-param-barColoringType").change((function(){t.updatePieKeys()})),t.TableChart.typeSelect=t.typeSelect,t.updatePieKeys(),T.initMacroBrowserChartColorsDialog(t,l),t.isCloud||(t.initInterpolationDialog(e),t.initLineSettingsDialog(e)),function(){$("#macro-param-div-type").before(x.a.chartTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-aggregation"),$("#macro-param-div-type"),$("#macro-param-div-is3d")],t=[$("#macro-param-div-tfc-height"),$("#macro-param-div-tfc-width"),$("#macro-param-div-colors"),$("#macro-param-div-align"),$("#macro-param-div-legend"),$("#macro-param-div-grid"),$("#macro-param-div-hide"),$("#macro-param-div-hidecontrols"),$("#macro-param-div-title"),$("#macro-param-div-xtitle"),$("#macro-param-div-barColoringType"),$("#macro-param-div-ytitle"),$("#macro-param-div-innerlabels"),$("#macro-param-div-outerLabels"),$("#macro-param-div-line-settings")],r=[$("#macro-param-div-datepattern"),$("#macro-param-div-separator"),$("#macro-param-div-dataorientation"),$("#macro-param-div-xminvalue"),$("#macro-param-div-xmaxvalue"),$("#macro-param-div-minvalue"),$("#macro-param-div-maxvalue"),$("#macro-param-div-xscalestep"),$("#macro-param-div-scalestep"),$("#macro-param-div-log"),$("#macro-param-div-xlog"),$("#macro-param-div-interpolation"),$("#macro-param-div-trendline"),$("#macro-param-div-worklog"),$("#macro-param-div-tabs")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var n=$("#tab-columns"),i=$("#tab-display-options"),a=$("#tab-advanced-options"),o=[n,i,a];function l(e){r(e[0],"in");for(var t=1;t<e.length;t++)r(e[t],"out");function r(e,t){for(var r=0;r<e.length;r++)"in"==t?e[r].removeClass("chart-browser-hidden-by-tab"):e[r].addClass("chart-browser-hidden-by-tab")}}function s(e){e.hasClass("active-tab")||(o.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}n.click((function(){n.hasClass("active-tab")||(s(n),l([e,t,r]))})),i.click((function(){i.hasClass("active-tab")||(s(i),l([t,e,r]))})),a.click((function(){a.hasClass("active-tab")||(s(a),l([r,e,t]))})),n.trigger("click")}()},G.prototype.initInterpolationDialog=function(e){var t=this,r=[];if(t.defaultInterpolation)t.chartKeys.forEach((function(e,n){t.savedInterpolation[e]=t.defaultInterpolation,r.push(t.defaultInterpolation)}));else{var n=e.interpolation?e.interpolation.split(","):[];t.chartKeys.forEach((function(e,i){var a=i<n.length?n[i]:"Linear";t.savedInterpolation[e]=a,r.push(a)}))}e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0)&&(e.interpolation=r.join(",")),T.initMacroBrowserInterpolationDialog(t,$("#macro-param-div-interpolation"))},G.prototype.initLineSettingsDialog=function(e){var t=this,r=[],n=e["line-settings"]?e["line-settings"].split(","):[];t.chartKeys.forEach((function(e,i){var a=i<n.length?{type:n[i].split("-")[0],width:n[i].split("-")[1]}:{type:"solid",width:1.5};t.savedLineSettings[e]=a,r.push(a.type+"-"+a.width.toString())})),e.type&&e.type.indexOf("Line")>=0&&(e["line-settings"]=r.join(",")),T.initMacroBrowserLineSettingsDialog(t,$("#macro-param-div-line-settings"))},G.prototype.initTableChart=function(e){this.TableChart=new K.a({macroId:"editor",columns:e.column,aggregation:e.aggregation,dateFormat:e.datepattern,separator:e.separator,pageId:0,dataorientation:e.dataorientation,colors:e.colors,pieKeys:e.pieKeys,worklog:e.worklog,sessionId:0,barColoringType:e.barColoringType}),this.TableChart.content=$(),this.TableChart.is3DWrapper=$()},G.prototype.updatePieKeys=function(){this.TableChart.barColoringType=this.barColoringTypeSelect.val(),this.TableChart.colors=this.colors,this.TableChart.colorKeyMap=this.TableChart.setColorKeyMap({},this.pieKeys,this.colors),this.TableChart.columns=this.columnParams.slice(),this.TableChart.aggregation=this.aggregateParams.slice(),this.TableChart.transpose=this.transpose,this.TableChart.dateFormat=this.dateFormatInput.val(),this.TableChart.getType(),this.TableChart.resetDateFormats();var e=p.a.getRawColumns(this.TableChart.tables);1===this.TableChart.columns.length&&-1===e.indexOf(this.TableChart.columns[0])&&(this.TableChart.columns=[]),1===this.TableChart.aggregation.length&&-1===e.indexOf(this.TableChart.aggregation[0])&&(this.TableChart.aggregation=[]),0==this.TableChart.columns.length&&void 0!==e[0]&&this.TableChart.columns.push(e[0]),this.TableChart.isPivot?0==this.TableChart.aggregation.length&&void 0!==e[e.length-1]&&this.TableChart.aggregation.push(e[e.length-1]):0==this.TableChart.aggregation.length&&this.TableChart.aggregation.push(e[1]),this.TableChart.calculate(),this.pieKeys=this.TableChart.pieKeys,this.colors=this.TableChart.colors,this.chartKeys=this.TableChart.chartKeys},G.prototype.getTrimmedColors=function(){var e=this.colors.slice(0,this.TableChart.getAllChartColorLabels().length);return e.length?e:this.colors},G.prototype.setTables=function(e){this.TableChart.chartBody=$('<div class="chart-body">'+e+"</div>"),this.TableChart.checkPivotContent(),this.TableChart.getOriginalTable()},G.prototype.updateColumns=function(e,t){var r=this;function n(e){var n,i=!1;r.setTables(t?e:e.html());var a=p.a.getRelevantRows(r.TableChart.rows,r.transpose);r.tables=[];var o=r.TableChart.tables;$.each(o,(function(e,t){var n=[];$.each(t,(function(t,r){a[e][t]&&n.push(r)})),r.tables.push(n)})),$.each(r.tables,(function(e,t){$.each(t[0],(function(e,t){if(n=!1,t=$.trim(t),-1==$.inArray(t,r.tableColumns)){i=!0,r.tableColumns.push(t);var a=r.columnParams&&$.inArray(t,r.columnParams)>=0||!r.columnParams&&0==e;r.isPivot&&0==r.columnParams.length&&(r.columnParams.push(t),a=!0,n=!0);var o=a?'selected="selected"':"";r.columnSelect.append($("<option "+o+"></option>").text(t)),a=!r.aggregateParams&&0==e||r.aggregateParams&&$.inArray(t,r.aggregateParams)>=0,r.isPivot&&0==r.aggregateParams.length&&!n&&(r.aggregateParams.push(t),a=!0),o=a?'selected="selected"':"",r.aggregateSelect.append($("<option "+o+"></option>").text(t))}}))})),r.isPivot&&r.tableColumns.length>2&&($("#macro-param-div-aggregation").removeClass("chart-browser-hidden"),r.typeSelect.find("option").each((function(){var e=$(this);"Line"!=e.val()&&"Area"!=e.val()&&"Stacked Area"!=e.val()||e.show()}))),i&&(r.columnSelect.trigger("chosen:updated"),r.aggregateSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(r.columnSelect,r.columnParams),p.a.sortSelectedOptions(r.aggregateSelect,r.aggregateParams)),r.typeSelect.trigger("change"),r.updatePieKeys()}A.bindPreview(e,n),p.a.addIframe(e,"chart-body",(function(e){r.updateColumns(e.parent())})),n(e)};var Z,ee=G,te=!1,re=function(){this.tableChartMacro=null};function ne(e){return null==e.tableChartMacro&&(e.tableChartMacro=new ee),e.tableChartMacro}re.prototype.getMacroDetailsFromSelectedMacro=function(e,t){te=!1,Z.bodyView=D.convertStorageToView(t.body),ne(Z).getMacroDetails(Z.bodyView,t.params,!1),D.showTabsParam(Z.bodyView)},re.prototype.beforeParamsRetrieved=function(e){var t=Z.tableChartMacro;return te||(t.columnSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),te=!0),e.colors=t.getTrimmedColors().join(","),e.pieKeys=t.pieKeys.join(""),e},re.prototype.postPreview=function(e){Z.tableChartMacro.updateColumns($(e).contents().find(".chart-body"))},re.prototype.beforeParamsSet=function(e){$(".tfc-container").remove();var t=ne(Z);return t.gotBody||Z.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent(),params:e}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+p.a.hashCode(t.tfBody),D.showTabsParam(Z.bodyView),e};var ie=Z=new re,ae=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.rowSelect=null,this.aggregateSelect=null,this.tfBody="",this.typeParams=[],this.columnParams=[],this.rowParams=[],this.aggregateParams=[],this.sortColumns=[],this.gotBody=!1};function oe(e,t,r,n,i){e.hide();var a=[];r.forEach((function(e){a.push(e.replace("",""))}));var o=$("<select multiple/>");return $.each(a,(function(e,r){r=$.trim(r),-1==$.inArray(r,t)&&t.push(r)})),t.sort(),$.each(t,(function(e,t){var r=-1==$.inArray(t,a)?"":'selected="selected" ';o.append($("<option "+r+"></option>").text(t))})),e.after(o),le(o,e,r,n,i),o}function le(e,t,r,n,i){e.chosenTF({no_results_text:n?"No matches found. Press \u0027Enter\u0027 to add":"No matches for",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:n}).change((function(n,a){if(null!=a.selected)e.find("option").filter((function(){return this.textContent==a.selected})).prop("selected",!0),""==(o=a.selected)&&(o=""),r.push(o);else if(null!=a.deselected){var o;e.find("option").filter((function(){return this.textContent==a.deselected})).prop("selected",!1),""==(o=a.deselected)&&(o=""),r.splice($.inArray(o,r),1)}if("macro-param-column"==t.attr("id")){var l=i.sortSelect.parent();null!=e.val()&&e.val().length>1&&!l.hasClass("tf-always-hidden")?l.addClass("tf-always-hidden"):(null==e.val()||e.val().length<=1)&&l.removeClass("tf-always-hidden")}i.updateSortOptions(),t.val(r.join(""))}));var a=p.a.sortSelectedOptions(e,r);a.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){r.length=0,a.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e=""),r.push(e)})),t.val(r.join(""))}})}ae.prototype.getMacroDetails=function(e){this.gotBody=!0,this.tfBody=e;var t=$('<div class="original-table">'+e+"</div>");this.tables=p.a.getTables(t,p.a.textType,"tf-numbering"),this.tableColumns=p.a.getColumns(this.tables)},ae.prototype.transformElements=function(e){var t=this;if($("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Table%2BFilter%2Band%2BCharts%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e.  "),$("#macro-param-div-id").hide(),$("#macro-param-div-vvpattern").find("option").each((function(){var e=$(this);"v"==e.attr("value")?e.text("Number"):"p"==e.attr("value")?e.text("Percentage"):"vp"==e.attr("value")?e.text("Number (Percentage)"):e.text("Percentage (Number)")})),e.column?(t.columnParams=e.column.split(""),$.each(t.columnParams,(function(e,r){t.columnParams[e]=$.trim(r)}))):t.columnParams=[],e.row?(t.rowParams=e.row.split(""),$.each(t.rowParams,(function(e,r){t.rowParams[e]=$.trim(r)}))):t.rowParams=[],e.aggregation?(t.aggregateParams=e.aggregation.split(""),$.each(t.aggregateParams,(function(e,r){t.aggregateParams[e]=$.trim(r)}))):t.aggregateParams=[],t.typeParams=["Count"],e.type&&(t.typeParams=e.type.split("")),e.version||2==t.columnParams.length&&(t.rowParams=[t.columnParams[1]],t.columnParams.length=1),e.sort&&(e.sort=e.sort.replace(" (Desc)"," ").replace(" (Asc)"," ").split(",")),!e.version||1==e.version){e.version=2;var r=t.typeParams[t.typeParams.length-1];"Count"==r||0==t.aggregateParams.length?e.sort=r+" ":e.sort=r+" of "+t.aggregateParams[t.aggregateParams.length-1]+" "}!function(e){(e.decimalSeparator||e.decimalseparator)&&$("#macro-param-decimalseparator").val(e.decimalSeparator||e.decimalseparator);e.decimals&&$("#macro-param-decimals").val(e.decimals);e.separator&&$("#macro-param-separator").val(e.separator);"true"==e.showrawdata&&$("#macro-param-showrawdata").prop("checked",!0);"true"==e.hidePane&&$("#macro-param-hidePane").prop("checked",!0);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.dateaccuracy&&$("#macro-param-dateaccuracy").val(e.dateaccuracy);"true"==e.hideTotal&&$("#macro-param-hideTotal").prop("checked",!0);e.numberaccuracy&&$("#macro-param-numberaccuracy").val(e.numberaccuracy);e.literalseparator&&$("#macro-param-literalseparator").val(e.literalseparator);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.vvpattern&&$("#macro-param-vvpattern").val(e.vvpattern)}(e);var n=$.merge([],t.columnParams);$.merge(n,t.rowParams),$.merge(n,t.aggregateParams),$.each(n,(function(e,r){r=r.replace("",""),-1==$.inArray(r,t.tableColumns)&&t.tableColumns.push(r)})),t.columnSelect=oe($("#macro-param-column"),t.tableColumns,t.columnParams,!0,t),t.rowSelect=oe($("#macro-param-row"),t.tableColumns,t.rowParams,!0,t),t.aggregateSelect=oe($("#macro-param-aggregation"),t.tableColumns,t.aggregateParams,!0,t),t.sortSelect=$("#macro-param-sort"),t.sortSelect.chosenTF(),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),A.initDateFormatInput(e),T.initMacroBrowserWorklogDialog(e.worklog),p.a.inputAutocomplete($("#macro-param-literalseparator"),null,[{label:"None",value:""},{label:"Comma",value:", "},{label:"Semicolon",value:"; "},{label:"Space",value:"\\u0020"},{label:"Line break",value:"\\n"},{label:"Bulleted list",value:"<ul>"},{label:"Numbered list",value:"<ol>"}]);var i=$("#macro-param-type");i.attr("multiple","multiple"),i.find("option").each((function(){var e=$(this);-1==$.inArray(e.text(),t.typeParams)?e.prop("selected",!1):e.prop("selected",!0)})),le(i,$("<input>"),t.typeParams,!1,t),function(){$("#macro-param-div-column").before(x.a.pivotTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-row"),$("#macro-param-div-aggregation"),$("#macro-param-div-type")],t=[$("#macro-param-div-sort"),$("#macro-param-div-decimalseparator"),$("#macro-param-div-separator"),$("#macro-param-div-decimals"),$("#macro-param-div-showrawdata"),$("#macro-param-div-hidePane"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-vvpattern"),$("#macro-param-div-datepattern"),$("#macro-param-div-dateaccuracy"),$("#macro-param-div-numberaccuracy"),$("#macro-param-div-worklog"),$("#macro-param-div-hideTotal"),$("#macro-param-div-tabs"),$("#macro-param-div-literalseparator")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var r=$("#tab-columns"),n=$("#tab-options"),i=[r,n];function a(e){function t(e,t){for(var r=0;r<e.length;r++)"in"==t?e[r].show():e[r].hide()}t(e[0],"in"),t(e[1],"out")}function o(e){e.hasClass("active-tab")||(i.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}r.click((function(){o(r),a([e,t])})),n.click((function(){o(n),a([t,e])})),r.trigger("click")}(),t.updateSortOptions(e.sort);var a=$("#macro-param-div-literalseparator");-1===t.typeParams.indexOf("Literal")&&a.addClass("tf-always-hidden"),i.change((function(){-1===t.typeParams.indexOf("Literal")?a.addClass("tf-always-hidden"):a.removeClass("tf-always-hidden")})),i.on("chosen:showing_dropdown",(function(){$(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750)})),2==e.version&&($("#macro-param-literalseparator").val(", "),e.version=3)},ae.prototype.updateSortOptions=function(e){var t=this,r=e||t.sortSelect.val();function n(e,r,o){var l=p.a.getCellPosition(o,t.rowParams[r]);null!=l?$.each(o,(function(s,c){0!=s&&(r+1<t.rowParams.length?(n(e+" "+c[l],r+1,i(o,l,c[l])),n(e,r+1,i(o,l,c[l]))):a(e+" "+c[l]))})):r+1<t.rowParams.length&&n(e,r+1,o),a(e)}function i(e,t,r){var n=[];return $.each(e,(function(e,i){0!=e&&i[t]!=r||n.push(i)})),n}function a(e){$.trim(e).length&&(-1==$.inArray(e+" ",t.sortColumns)&&t.sortColumns.push(e+" "),-1==$.inArray(e+" ",t.sortColumns)&&t.sortColumns.push(e+" "))}t.sortColumns=[],t.sortSelect.empty().append('<option selected="selected" value="false"></option>').append('<option value="-as_is-">'+"Preserve the original sorting order"+"</option>"),t.columnParams.length<=1&&(a(t.columnParams[0]),$.each(t.tables,(function(e,r){$.each(t.typeParams,(function(e,i){t.rowParams.length>0?"Count"==i?n(i,0,r):$.each(t.aggregateParams,(function(e,t){n(i+" of "+t,0,r)})):"Count"==i?a(i):$.each(t.aggregateParams,(function(e,t){a(i+" of "+t)}))}))}))),$.each(t.sortColumns.sort(),(function(e,r){t.sortSelect.append($("<option></option>").val(r).text(r))})),t.sortSelect.val(r),t.sortSelect.trigger("chosen:updated")},ae.prototype.updateColumns=function(e){var t=this;function r(e){var r=!1;p.a.normalizeTable(e),t.tables=p.a.getTables(e,p.a.textType,"tf-numbering"),$.each(t.tables,(function(e,n){$.each(n[0],(function(e,n){-1==$.inArray(n,t.tableColumns)&&(r=!0,t.tableColumns.push(n),t.columnSelect.append($("<option></option>").val(n).text(n)),t.rowSelect.append($("<option></option>").val(n).text(n)),t.aggregateSelect.append($("<option></option>").val(n).text(n)))}))})),r&&(p.a.sortSelectOptions(t.columnSelect),p.a.sortSelectOptions(t.rowSelect),p.a.sortSelectOptions(t.aggregateSelect),t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.rowSelect,t.rowParams),p.a.sortSelectedOptions(t.aggregateSelect,t.aggregateParams))}t.body=e,A.bindPreview(e,r),p.a.addIframe(e,"original-table",(function(e){r(e.parent())})),r(e)};var se,ce=ae,ue=!1,de=function(){this.pivotTableMacro=new ce};de.prototype.getMacroDetailsFromSelectedMacro=function(e,t){ue=!1,se.bodyView=D.convertStorageToView(t.body),se.pivotTableMacro.getMacroDetails(se.bodyView),D.showTabsParam(se.bodyView)},de.prototype.postPreview=function(e){se.pivotTableMacro.updateColumns($(e).contents().find(".original-table"))},de.prototype.beforeParamsSet=function(e){var t=se.pivotTableMacro;return t.gotBody||se.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+p.a.hashCode(t.tfBody),D.showTabsParam(se.bodyView),e},de.prototype.beforeParamsRetrieved=function(e){var t=se.pivotTableMacro;return ue||(t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),p.a.sortSelectedOptions(t.columnSelect,t.columnParams),p.a.sortSelectedOptions(t.rowSelect,t.rowParams),p.a.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),ue=!0),e.type=t.typeParams.join(""),e};var pe=se=new de;AJS.toInit((function(){AJS.MacroBrowser.setMacroJsOverride("csv-table",new c),AJS.MacroBrowser.setMacroJsOverride("table-excerpt-include",new d),AJS.MacroBrowser.setMacroJsOverride("table-joiner",{opener:F}),AJS.MacroBrowser.setMacroJsOverride("table-filter",V),AJS.MacroBrowser.setMacroJsOverride("table-chart",ie),AJS.MacroBrowser.setMacroJsOverride("pivot-table",pe)}))}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.masterdetail:master-details-macro-browser', location = 'com/atlassian/confluence/extra/masterdetail/js/macro-browser-options.js' */
AJS.toInit(function(a){AJS.MacroBrowser.setMacroJsOverride("detailssummary",{fields:{cqlSelect2CustomOptions:{maximumSelectionSize:"60"}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
/**
 * Provides custom behaviour in the macro browser for the code macro.
 */
(function($) {

    var CodeMacroConfig = function() {};

    CodeMacroConfig.prototype.fields = {
        "string" : {
            "language" : function(param, options) {

                var paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var input = $("select", paramDiv);

                // we need to do some trickery when the value is first set, and when the value is subsequently changed,
                // so set this up.
                if (options == null)
                    options = {};
                options.setValue = function(value) {

                    var targetOption = input.find("option[value='" + value + "']");
                    if (targetOption.length == 0) {
                        var option = $("<option/>");
                        option.val(value);
                        option.text(value);
                        input.append(option);
                    }
                };

                bindAsyncDropDown(input);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    AJS.MacroBrowser.Macros["code"] = new CodeMacroConfig();

    /**
     * Populates an HTML Select element with the list of configured syntax highlighters.
     * @param dropDown JQuery selector for the HTML select element to be populated.
     */
    function bindAsyncDropDown(dropDown) {
        // Load the languages from Confluence
        getLanguagesAsync(function(languages) {
                    if (!languages.length)
                    {
                        AJS.log("Configured code macro languages result was not in the expected format.");
                        return;
                    }

                    var currentValue = dropDown.val();

                    dropDown.empty();
                    dropDown.append($("<option/>").attr("value", ""));

                    $.each(languages, function(index, lang) {
                        var option = $("<option />");
                        option.val(lang.aliases[0]);
                        option.text(lang.friendlyName);

                        dropDown.append(option);
                    });

                    // restore the currently selected value.
                    dropDown.val(currentValue);
                },
                function(xhr, textStatus, errorThrown) {
                    AJS.log("Failed to retrieve syntax highlighters from Confluence " + textStatus + " - " + errorThrown);
                });
    }

    /**
     * Asynchronously retrieves the current set of syntax highlighters currently installed for the Code macro.
     *
     * @param successHandler Callback to invoke if the retrieval is successful
     * @param errorHandler Callback to invoke if the retrieval fails.
     */
    function getLanguagesAsync(successHandler, errorHandler) {
        AJS.$.ajax({
            async: true,
            url: AJS.contextPath() + "/plugins/newcode/getlanguages.action",
            dataType: "json",
            timeout: 10000, // 10 seconds,
            error: function(xhr, textStatus, errorThrown) {
                if (errorHandler && typeof(errorHandler) == "function") {
                    errorHandler(xhr, textStatus, errorThrown);
                }
            },
            success: function(data) {
                if (successHandler && typeof(successHandler) == "function") {
                    successHandler(data);
                }
            }
        });
    }
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'soy/button-macro.soy' */
// This file was automatically generated from button-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HandyButtonMacro.
 */

if (typeof HandyButtonMacro == 'undefined') { var HandyButtonMacro = {}; }


HandyButtonMacro.colorDropDown = function(opt_data, opt_ignored) {
  return '<button id="handy-button-dd" class="aui-button aui-dropdown2-trigger" aria-owns="handy-button-colors" aria-haspopup="true"><a data-color="Blue"><span class="handy-button-color-preview" style="background: #3572b0;"></span>' + soy.$$escapeHtml('Blue') + '</a></button><div id="handy-button-colors" class="aui-style-default aui-dropdown2" style="z-index: 10000"><ul><li><a data-color="Blue"><span class="handy-button-color-preview" style="background: #3572b0;"></span>' + soy.$$escapeHtml('Blue') + '</a></li><li><a data-color="Green"><span class="handy-button-color-preview" style="background: #14892c;"></span>' + soy.$$escapeHtml('Green') + '</a></li><li><a data-color="Red"><span class="handy-button-color-preview" style="background: #d04437;"></span>' + soy.$$escapeHtml('Red') + '</a></li><li><a data-color="Yellow"><span class="handy-button-color-preview" style="background: #f6c342;"></span>' + soy.$$escapeHtml('Yellow') + '</a></li><li><a data-color="Gray"><span class="handy-button-color-preview" style="background: #f5f5f5; color: black; font-weight: bold;"></span>' + soy.$$escapeHtml('Gray') + '</a></li></ul></div>';
};
if (goog.DEBUG) {
  HandyButtonMacro.colorDropDown.soyTemplateName = 'HandyButtonMacro.colorDropDown';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'soy/reminder-utils.soy' */
// This file was automatically generated from reminder-utils.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HandyReminderUtils.
 */

if (typeof HandyReminderUtils == 'undefined') { var HandyReminderUtils = {}; }


HandyReminderUtils.recipientUser = function(opt_data, opt_ignored) {
  return '<tr id="' + soy.$$escapeHtml(opt_data.key) + '" class="reminder-raw" data-type="user"><td><a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeHtml(opt_data.name) + '" class="url fn confluence-userlink" data-username="' + soy.$$escapeHtml(opt_data.name) + '"><img class="recipient-icon" src="' + soy.$$escapeHtml(opt_data.avatar) + '">' + soy.$$escapeHtml(opt_data.fullName) + '</a></td><td class="reminder-remove-cell"><span class="aui-icon aui-icon-small aui-iconfont-delete reminder-remove" title="' + soy.$$escapeHtml('Remove') + '"></span></td></tr>';
};
if (goog.DEBUG) {
  HandyReminderUtils.recipientUser.soyTemplateName = 'HandyReminderUtils.recipientUser';
}


HandyReminderUtils.recipientGroup = function(opt_data, opt_ignored) {
  return '<tr id="' + soy.$$escapeHtml(opt_data.name) + '" class="reminder-raw" data-type="group"><td><img class="recipient-icon" src="' + soy.$$escapeHtml("") + '/images/icons/avatar_group_48.png">' + soy.$$escapeHtml(opt_data.name) + '</td><td class="reminder-remove-cell"><span class="aui-icon aui-icon-small aui-iconfont-delete reminder-remove" title="' + soy.$$escapeHtml('Remove') + '"></span></td></tr>';
};
if (goog.DEBUG) {
  HandyReminderUtils.recipientGroup.soyTemplateName = 'HandyReminderUtils.recipientGroup';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'soy/reminder-macro.soy' */
// This file was automatically generated from reminder-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HandyReminderMacro.
 */

if (typeof HandyReminderMacro == 'undefined') { var HandyReminderMacro = {}; }


HandyReminderMacro.desc = function(opt_data, opt_ignored) {
  return '<textarea id="macro-param-desc" rows="4" class="textarea macro-param-input"/>';
};
if (goog.DEBUG) {
  HandyReminderMacro.desc.soyTemplateName = 'HandyReminderMacro.desc';
}


HandyReminderMacro.recipientsContainer = function(opt_data, opt_ignored) {
  return '<table class="reminder-recipients-container"></table>';
};
if (goog.DEBUG) {
  HandyReminderMacro.recipientsContainer.soyTemplateName = 'HandyReminderMacro.recipientsContainer';
}


HandyReminderMacro.sendTestMail = function(opt_data, opt_ignored) {
  return '<span id="handy-remind-test-mail">' + soy.$$escapeHtml('Send test email') + '</span>';
};
if (goog.DEBUG) {
  HandyReminderMacro.sendTestMail.soyTemplateName = 'HandyReminderMacro.sendTestMail';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/button-macro-browser.js' */
(function ($, AnalyticsExtender) {

    var HandyButtonMacroJsOverride = function () {
    };

    HandyButtonMacroJsOverride.prototype.beforeParamsSet = function (params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        var colorSelect = $('#macro-param-color').hide();
        colorSelect.before(HandyButtonMacro.colorDropDown());

        var colorBtn = $('#handy-button-dd');
        var as = $('#handy-button-colors a');
        as.mouseup(function () {
            var a = $(this);
            a.data('events').click = [];
            colorSelect.find('option:contains(' + a.data('color') + ')').prop('selected', true);
            var clone = a.clone();
            colorBtn.html(clone);
            clone.mouseup(function () {
                clone.data('events').click = [];
            });
        });

        if (params['color']) {
            colorBtn.html(as.filter('[data-color="' + params['color'] + '"]').clone());
        }

        colorBtn.find('a').mouseup(function () {
            $(this).data('events').click = [];
        });

        $('#macro-browser-dialog').find('.button-panel-button.ok, .button-panel-cancel-link').one('click', function () {
            if (colorBtn.hasClass('active')) {
                colorBtn.trigger("aui-button-invoke");
            }
        });

        HandyButtonEditor.bindAutocompleteUrlInput($('#macro-param-link'));

        return params;
    };
    var instance = AnalyticsExtender.extend(new HandyButtonMacroJsOverride());
    AJS.MacroBrowser.setMacroJsOverride("button-handy", instance);

})(AJS.$, require('stiltsoft/handy-macros/analytics/client/extender'));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/status-macro-browser.js' */
(function ($, AnalyticsExtender) {

    window.HandyStatusMacroReloader = {};

    var handyStatusMacroJsOverride;

    var HandyStatusMacroJsOverride = function () {
    };

    HandyStatusMacroJsOverride.prototype.beforeParamsRetrieved = function (params) {
        var self = handyStatusMacroJsOverride;

        self.statusMacro.macroParams = params;
        self.statusMacro.labelled = params.labelled;
        self.statusMacro.prefix = params.prefix;
        HandyStatusMacroReloader.params = params;
        self.statusMacro.saveMacro();
        return {"Status": self.statusMacro.statusSelect.find('option:selected').text(), "id": params['id']};
    };

    HandyStatusMacroJsOverride.prototype.postPreview = function (iframe) {
        $(iframe).contents().find('[id="main"]:eq(1)').remove();
    };

    HandyStatusMacroJsOverride.prototype.beforeParamsSet = function (params) {
        $('.hmc-fr').remove();
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        var self = handyStatusMacroJsOverride;

        HandyStatusMacroReloader.params = params;
        HandyStatusMacroReloader.beforeParamsSet = self.beforeParamsSet;
        var paramWrappers = $('#macro-param-div-set, #macro-param-div-status, #macro-param-div-outline, #macro-param-div-labelled, #macro-param-div-prefix');
        paramWrappers.show().parent().find('.aui-message').remove();
        $('#macro-param-div-config').remove();

        var globalConfig = AJS.params.isAdmin ? ' ' + AJS.format("or \u003ca href=\u0022{0}/admin/plugins/status-macro/config.action\u0022 target=\u0022_blank\u0022\u003eglobal statuses\u003c/a\u003e", Confluence.getContextPath()) : '';
        var spaceConfig = AJS.params.isSpaceAdmin ? ' ' + AJS.format("or \u003ca href=\u0022{0}/plugins/handy-macros/space-settings.action?key={1}\u0022 target=\u0022_blank\u0022\u003espace statuses\u003c/a\u003e.", Confluence.getContextPath(), AJS.params.spaceKey) : '';
        var config = AJS.format("Configure \u003ca href=\u0022{0}/users/status-macro.action\u0022 target=\u0022_blank\u0022\u003epersonal statuses\u003c/a\u003e", Confluence.getContextPath()) + spaceConfig + globalConfig;

        var emptyStatuses = function () {
            AJS.messages.warning(paramWrappers.hide().parent(), {
                title: "Warning!",
                body: "No statuses configured for this macro. Please, " + config.toLowerCase()
            });
        };

        if (!params['id']) {
            $.ajax({
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                type: 'POST',
                cache: false,
                async: false,
                url: Confluence.getContextPath() + '/rest/status-macro/1.0/status/create-macro',
                dataType: 'json',
                data: {
                    contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                    spaceKey: AJS.params.spaceKey
                },
                success: function (data) {
                    if (!data) {
                        emptyStatuses();
                    } else {
                        params['id'] = data.id;
                    }
                }
            });
        }

        if (!params['id']) {
            return params;
        }

        $('#macro-param-div-id').hide().after('<div id="macro-param-div-config" class="macro-param-div">' + config + '</div>')
            .find('input').val(params['id']);

        self.statusMacro = new HandyStatusMacro();
        self.statusMacro.init(
            function () {
                $('#macro-browser-preview-link').click();
            }, function () {
                var form = paramWrappers.hide().parent();
                AJS.messages.warning(form, {
                    body: AJS.format("Your license for Handy Macros add-on has expired. Please \u003ca class=\u0022handy-license\u0022 href=\u0022{0}/plugins/servlet/upm#manage/com.stiltsoft.confluence.handy.macros\u0022\u003egenerate a trial license or purchase\u003c/a\u003e the product.", Confluence.getContextPath()),
                    closeable: false
                });
            }, function (data) {
                AJS.MacroBrowser.paramChanged();
                if (data.length === 0) {
                    emptyStatuses();
                }
            }, function () {
                AJS.messages.error($('#macro-param-div-set'), {
                    title: "Error!",
                    body: "Error occurred: unable to retrieve data from server. See logs for details"
                });
            }, AJS.MacroBrowser.paramChanged, false, function (data) {
                params['id'] = data;
            });

        self.statusMacro.macroParams = params;
        self.statusMacro.setSelect = $('#macro-param-set');
        self.statusMacro.statusSelect = $('#macro-param-status');
        self.statusMacro.outlineInput = $('#macro-param-outline');
        self.statusMacro.bindInputEvents();
        self.statusMacro.initInputs();
        params.labelled = self.statusMacro.labelled;
        params.prefix = self.statusMacro.prefix;

        var prefixWrapper = $('#macro-param-div-prefix');
        var labelledCheckBox = $('#macro-param-labelled').change(function () {
            if (labelledCheckBox.is(':checked')) {
                prefixWrapper.show();
            } else {
                prefixWrapper.hide();
            }
        });

        if (!params.labelled) {
            prefixWrapper.hide();
        }

        return params;
    };

    handyStatusMacroJsOverride = new HandyStatusMacroJsOverride();

    var instance = AnalyticsExtender.extend(handyStatusMacroJsOverride);

    AJS.MacroBrowser.setMacroJsOverride("status-handy", instance);

})(AJS.$, require('stiltsoft/handy-macros/analytics/client/extender'));

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/timestamp-macro-browser.js' */
(function ($, AnalyticsExtender) {

    var TimestampMacroJsOverride = function () {
    };

    TimestampMacroJsOverride.prototype.beforeParamsSet = function (params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        var format = $('#macro-param-format').change(function() {
            setCookie('handy-ts-format', format.val());
            $('#macro-browser-preview-link').click();
        });

        if (params.time === undefined) {
            $.ajax({
                async: false,
                cache: false,
                type: "GET",
                contentType: "application/json; charset=utf-8",
                url: AJS.params.contextPath + "/rest/status-macro/1.0/current-time",
                dataType: "json",
                success: function (data) {
                    params.time = data;
                },
                error: function() {
                    params.time = new Date().getTime();
                },
                timeout: 90000
            });
        }

        if (!params.format) {
            params.format = getCookie('handy-ts-format') || 'dd.MM.yyyy HH:mm';
        }

        dateFormatAutocomplete(format);

        return params;
    };

    var instance = AnalyticsExtender.extend(new TimestampMacroJsOverride());

    AJS.MacroBrowser.setMacroJsOverride('timestamp', instance);

    function setCookie(name, value) {
        document.cookie = name + "=" + encodeURIComponent(value) + "; max-age=" + 60 * 60 * 24 * 3000;
    }

    function getCookie(name) {
        var cookie = document.cookie;
        if (cookie.length !== 0) {
            var re = new RegExp('[; ]' + name + '=([^\\s;]*)');
            var matcher = (' ' + document.cookie).match(re);
            if (matcher) {
                return decodeURIComponent(matcher[1]);
            }
        }
        return '';
    }

    function dateFormatAutocomplete(input, parent) {
        inputAutocomplete(input, parent, [
            {label: "dd.MM.yyyy HH:mm (25.09.2019 12:42)", value: "dd.MM.yyyy HH:mm"},
            {label: "dd.MM.yyyy HH:mm:ss (25.09.2019 12:42)", value: "dd.MM.yyyy HH:mm:ss"},
            {label: "MM/dd/yyyy hh:mm a (09/25/2019 12:42 PM)", value: "MM/dd/yyyy hh:mm a"},
            {label: "MMM dd, yyyy hh:mm a (Sep 25, 2019 01:02 PM)", value: "MMM dd, yyyy hh:mm a"},
            {label: "dd.MM.yyyy (25.09.2019)", value: "dd.MM.yyyy"},
            {label: "MM/dd/yyyy (09/25/2019)", value: "MM/dd/yyyy"},
            {label: "MMM dd, yyyy (Sep 25, 2019)", value: "MMM dd, yyyy"},
            {label: "HH:mm (13:16)", value: "HH:mm"},
            {label: "HH:mm:ss (13:16:45)", value: "HH:mm"},
            {label: "hh:mm a (13:16 PM)", value: "hh:mm a"}
        ]);
    }

    function inputAutocomplete(input, parent, options, onChange) {
        input.autocomplete(
            {
                source: options,
                minLength: 0,
                appendTo: parent,
                change: onChange,
                select: function () {
                    input.trigger('selected');
                },
                classes: {
                    "ui-autocomplete": "hm"
                }
            }
            );
        input.focus(function() {
            input.autocomplete("search", "");
        }).change(onChange);
        var widget = input.autocomplete("widget");
        if (widget) {
            widget.click(function (e) {
                e.stopPropagation();
            });
        } else {
            WRM.require('com.stiltsoft.confluence.handy.macros:jquery-autocomplete-resources', function() {
                inputAutocomplete(input, parent, options, onChange);
            });
        }
    }

})(AJS.$,require('stiltsoft/handy-macros/analytics/client/extender'));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/reminder-utils.js' */
(function($) {

    window.ReminderUtils = function(id, descInput, dateInput, hoursInput, minutesInput, lastDateInput, recipientsInput,
                                    typeSelect, activeInput, showDescInput, showDateInput, amountInput, dayOfWeekInput, recipientsContainer,
                                    saveBtn, contentId) {
        this.id = id;
        this.descInput = descInput;
        this.dateInput = dateInput;
        this.hoursInput = hoursInput;
        this.minutesInput = minutesInput;
        this.lastDateInput = lastDateInput;
        this.recipientsInput = recipientsInput;
        this.typeSelect = typeSelect;
        this.activeInput = activeInput;
        this.showDescInput = showDescInput;
        this.showDateInput = showDateInput;
        this.amountInput = amountInput;
        this.dayOfWeekInput = dayOfWeekInput;
        this.recipientsContainer = recipientsContainer;
        this.contentId = contentId;
        this.saveBtn = saveBtn;
    };

    ReminderUtils.prototype.initInputs = function() {
        var self = this;

        Confluence.Binder.autocompleteUserOrGroup(self.recipientsInput.parent());
        self.recipientsInput.bind("selected.autocomplete-user-or-group", function(e, data) {
            self.recipientsInput.val('');
            var recipient;
            var recipients =  self.recipientsContainer.find('tr[data-type="' + data.content.type + '"]');
            if (data.content.type == 'user') {
                if (recipients.filter('[id="' + data.content.userKey + '"]').length) {
                    return;
                }

                recipient = HandyReminderUtils.recipientUser({
                    name: data.content.username,
                    fullName: data.content.title,
                    key: data.content.userKey,
                    avatar: data.content.thumbnailLink.href
                });
            } else {
                if (recipients.filter('[id="' + data.content.name + '"]').length) {
                    return;
                }

                recipient = HandyReminderUtils.recipientGroup({name: data.content.name});
            }
            self.recipientsContainer.append(recipient);
            Confluence.Binder.userHover();
            self.dateInput.trigger('change');
        });
        $('.reminder-remove').die('click').live('click', function() {
            $(this).parents('.reminder-raw').remove();
            self.dateInput.trigger('change');
        });

        var minDate = $.datepicker.formatDate("dd.mm.yy", new Date());
        self.dateInput.attr('min', minDate);
        self.lastDateInput.attr('min', self.dateInput.val() || minDate);

        var lastDatePicker;
        if (self.dateInput.datePicker) {
            self.dateInput.datePicker({overrideBrowserDefault: true, dateFormat: "dd.mm.yy"});
            lastDatePicker = self.lastDateInput.datePicker({overrideBrowserDefault: true, dateFormat: "dd.mm.yy"});
        } else {
            self.dateInput.datepicker({dateFormat: "dd.mm.yy", minDate: new Date()});
            self.lastDateInput.datepicker({dateFormat: "dd.mm.yy", minDate: $.datepicker.parseDate("dd.mm.yy", self.dateInput.val() || minDate)});
            $('#ui-datepicker-div').click(function(e) {e.stopPropagation()});
        }

        self.typeSelect.change(function() {
            var amountWrapper = self.amountInput.parents('#macro-param-div-amount');
            var index = self.typeSelect.find('option:selected').index();
            if (index === 0) {
                self.lastDateInput.parents('#macro-param-div-lastdate').fadeOut().hide();
                amountWrapper.fadeOut().hide();
                self.showDateInput.parents('#macro-param-div-show-date').fadeIn().show();
            } else {
                self.lastDateInput.parents('#macro-param-div-lastdate').fadeIn().show();
                amountWrapper.fadeIn().show();
                self.showDateInput.parents('#macro-param-div-show-date').fadeOut().hide();
                self.showDateInput.prop('checked', false);
            }

            if (index === 4) {
                self.dayOfWeekInput.parents('#macro-param-div-day-of-week').fadeIn().show();
            } else {
                self.dayOfWeekInput.parents('#macro-param-div-day-of-week').fadeOut().hide();
            }

            var label = amountWrapper.find('label, .handy-reminder-label');
            switch (index) {
                case 1:
                    label.text("Remind every Nth day");
                    break;
                case 2:
                    label.text("Remind every Nth working day");
                    break;
                case 3:
                    label.text("Remind every Nth week");
                    break;
                case 4:
                    label.text("Remind every Nth month");
                    break;
                case 5:
                    label.text("Remind every Nth year");
                    break;
            }
        });

        self.dateInput.bind('input change keyup', function() {
            var val = self.dateInput.val().trim();
            if (val) {
                try {
                    var date = $.datepicker.parseDate("dd.mm.yy", val);
                    self.saveBtn.prop('disabled', false);
                    if (self.lastDateInput.attr('min') != self.dateInput.val()) {
                        var lastVal = self.lastDateInput.val();
                        self.lastDateInput.attr('min', self.dateInput.val() || minDate);
                        if (lastDatePicker) {
                            lastDatePicker.reset();
                            self.lastDateInput.val(lastVal);
                        } else {
                            self.lastDateInput.datepicker('option', 'minDate', $.datepicker.parseDate("dd.mm.yy", self.dateInput.val() || minDate));
                        }
                    }
                    self.setDayOfWeek(date);
                } catch(e) {
                    self.saveBtn.prop('disabled', true);
                }
            } else {
                self.saveBtn.prop('disabled', true);
            }
        });

        self.hoursInput.add(self.minutesInput).change(function() {
            self.dateInput.trigger('change');
        });

        self.showDescInput.add(self.showDateInput).change(function() {
            self.saveBtn.prop('disabled', false);
        });

        self.amountInput.bind('input', function () {
            self.dateInput.trigger('change');
        });

        self.dayOfWeekInput.change(function () {
            var selected = self.dayOfWeekInput.find('option:selected');
            self.dayOfWeekInput.attr('data-dow', selected.attr('data-dow'));
            self.dayOfWeekInput.attr('data-dn', selected.attr('data-dn'));
            self.saveBtn.prop('disabled', false);
        });

        self.setDayOfWeek();
    };

    ReminderUtils.prototype.setDayOfWeek = function (date) {
        var self = this;

        if (!date) {
            try {
                date = $.datepicker.parseDate("dd.mm.yy", self.dateInput.val().trim());
            } catch (e) {
                date = new Date();
            }
        }

        var dayOfMonth = date.getDate();
        var dn = self.dayOfWeekInput.attr('data-dn');
        var isDOW = self.dayOfWeekInput.attr('data-dow') > 0;
        var dayOfWeek = date.getDay() + 1;
        var dayNumber = Math.ceil(date.getDate() / 7);
        var dayNumberText;
        var shouldAddLatDayOption = false;

        switch (dayNumber) {
            case 1:
                dayNumberText = "first";
                break;
            case 2:
                dayNumberText = "second";
                break;
            case 3:
                dayNumberText = "third";
                break;
            case 4:
                var daysInMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
                shouldAddLatDayOption = daysInMonth - dayOfMonth < 7;
                dayNumberText = "fourth";
                break;
            default:
                dayNumberText = "last";
        }
        var dayOfWeekText;
        switch (dayOfWeek) {
            case 1:
                dayOfWeekText = "Sunday";
                break;
            case 2:
                dayOfWeekText = "Monday";
                break;
            case 3:
                dayOfWeekText = "Tuesday";
                break;
            case 4:
                dayOfWeekText = "Wednesday";
                break;
            case 5:
                dayOfWeekText = "Thursday";
                break;
            case 6:
                dayOfWeekText = "Friday";
                break;
            case 7:
                dayOfWeekText = "Saturday";
                break;
        }

        var selected = isDOW ? '' : 'selected=""selected"';
        self.dayOfWeekInput.empty();
        self.dayOfWeekInput.append('<option data-dow="" data-dn="" ' + selected + '>' +
            AJS.format("day {0}", dayOfMonth) + '</option>');
        
        selected = !(isDOW && (!shouldAddLatDayOption || dn == 4)) ? '' : 'selected=""selected"';
        self.dayOfWeekInput.append('<option data-dow="' + dayOfWeek + '" data-dn="' + dayNumber + '" ' + selected + '>' +
            AJS.format("the {0} {1}", dayNumberText, dayOfWeekText) + '</option>');

        if (shouldAddLatDayOption) {
            dayNumberText = "last";
            selected = !(isDOW && dn == 5) ? '' : 'selected=""selected"';
            self.dayOfWeekInput.append('<option data-dow="' + dayOfWeek + '" data-dn="5" ' + selected + '>' +
                AJS.format("the {0} {1}", dayNumberText, dayOfWeekText) + '</option>');
        }

        self.dayOfWeekInput.change();
    };

    ReminderUtils.prototype.saveMacro = function() {
        var self = this;

        var users = [];
        self.recipientsContainer.find('tr[data-type="user"]').each(function() {
            users.push($(this).attr('id'));
        });

        var groups = [];
        self.recipientsContainer.find('tr[data-type="group"]').each(function() {
            groups.push($(this).attr('id'));
        });

        var lastDate;
        try {
            var date = $.datepicker.parseDate("dd.mm.yy", self.lastDateInput.val());
            date.setHours(23, 59, 59, 0);
            lastDate = date.getTime();
        } catch (e) {}

        var nextDate = $.datepicker.parseDate("dd.mm.yy", self.dateInput.val());
        nextDate.setHours(self.hoursInput.val(), self.minutesInput.val() - 5, 0, 0);

        var amount = self.amountInput.val();
        amount = parseInt(amount);
        amount = isNaN(amount) ? 1 : amount;

        var error = false;
        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'POST',
            cache: false,
            async: false,
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/reminder/change-macro',
            dataType: 'json',
            data: {
                contentId: self.contentId,
                id: self.id,
                users: users,
                groups: groups,
                date: nextDate.getTime(),
                lastDate: lastDate,
                type: self.typeSelect.find('option:selected').index(),
                amount: amount,
                desc: self.descInput.val(),
                paused: !self.activeInput.is(':checked'),
                showDesc: self.showDescInput.is(':checked'),
                showDate: self.showDateInput.is(':checked'),
                dayOfWeek: self.dayOfWeekInput.attr('data-dow') || undefined,
                dayNumber: self.dayOfWeekInput.attr('data-dn') || undefined
            },
            error: function (xhr) {
                error = xhr;
            }
        });

        return error;
    };

})(AJS.$ || window.Zepto || $);




}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/reminder-macro-browser.js' */
(function($, AnalyticsExtender) {

    var reminderUtils;
    var HandyReminderMacroJsOverride = function() {
    };

    HandyReminderMacroJsOverride.prototype.beforeParamsRetrieved = function(params) {
        reminderUtils.saveMacro();
        return params;
    };

    HandyReminderMacroJsOverride.prototype.beforeParamsSet = function(params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        $('#macro-param-div-time-m label').text(':');

        var showLicenseError = function() {
            var form = $('#macro-param-div-date, #macro-param-div-type, #macro-param-div-description, ' +
                '#macro-param-div-recipients, #macro-param-div-active, #macro-param-div-show-desc, ' +
                '#macro-param-div-lastdate, #macro-param-div-amount, #macro-param-div-show-date').hide().parent();
            AJS.messages.warning(form, {
                body: AJS.format("Your license for Handy Macros add-on has expired. Please \u003ca class=\u0022handy-license\u0022 href=\u0022{0}/plugins/servlet/upm#manage/com.stiltsoft.confluence.handy.macros\u0022\u003egenerate a trial license or purchase\u003c/a\u003e the product.", Confluence.getContextPath()),
                closeable: false
            });
        };

        if (!params['id']) {
            $.ajax({
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                type: 'POST',
                cache: false,
                async: false,
                url: Confluence.getContextPath() + '/rest/status-macro/1.0/reminder/create-macro',
                dataType: 'json',
                data: {
                    contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                    users: [],
                    groups: [],
                    date: new Date().setHours(7, 55, 0, 0) + 24*60*60*1000,
                    type: 0,
                    desc: '',
                    paused: false
                },
                success: function(data) {
                    if (!data) {
                        showLicenseError();
                    } else {
                        params['id'] = data;
                    }
                }
            });
        }

        var id = params['id'];

        if (!id) {
            return params;
        }

        var descInput = $(HandyReminderMacro.desc());
        var dateInput = $('#macro-param-date');
        var hoursInput = $('#macro-param-time-h');
        var minutesInput = $('#macro-param-time-m');
        var lastDateInput = $('#macro-param-lastdate');
        var recipientsInput = $('#macro-param-recipients');
        var typeSelect = $('#macro-param-type');
        var recipientsContainer = $(HandyReminderMacro.recipientsContainer());
        var pauseInput = $('#macro-param-active');
        var showDescInput = $('#macro-param-show-desc');
        var showDateInput = $('#macro-param-show-date');
        var amountInput = $('#macro-param-amount');
        var dayOfWeekInput = $('#macro-param-day-of-week');

        $('#macro-param-description').replaceWith(descInput);

        recipientsInput.val('').addClass('autocomplete-user-or-group').attr('data-none-message', "Not found");
        recipientsInput.parent().append(recipientsContainer);

        reminderUtils = new ReminderUtils(id, descInput, dateInput, hoursInput, minutesInput, lastDateInput, recipientsInput,
            typeSelect, pauseInput, showDescInput, showDateInput, amountInput, dayOfWeekInput, recipientsContainer, $('.button-panel-button.ok'),
            AJS.params.contentId ? AJS.params.contentId : undefined);

        $.ajax({
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            type: 'GET',
            cache: false,
            async: false,
            url: Confluence.getContextPath() + '/rest/status-macro/1.0/reminder/get-macro',
            dataType: 'json',
            data: {
                contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                id: id
            },
            success: function(data) {
                if (!data.licensed) {
                    showLicenseError()
                } else {
                    descInput.val(data.desc);
                    var date = new Date(data.date + 300000);
                    params['date'] = $.datepicker.formatDate("dd.mm.yy", date);
                    params['time-h'] = date.getHours();
                    params['time-m'] = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();
                    params['lastdate'] = data.lastDate ? $.datepicker.formatDate("dd.mm.yy", new Date(data.lastDate)) : '';
                    params['type'] = typeSelect.find('option').eq(data.type).prop('selected', true).text();
                    params['active'] = !data.paused;
                    params['show-desc'] = data.showDesc;
                    params['show-date'] = data.showDate;
                    params['amount'] = data.amount;

                    dayOfWeekInput.attr('data-dow', data.dayOfWeek).attr('data-dn', data.dayNumber);
                    dateInput.val(params['date']).trigger('change');
                    reminderUtils.initInputs();

                    typeSelect.trigger('change');

                    data.users.forEach(function(user) {
                        recipientsContainer.append(HandyReminderUtils.recipientUser({
                            name: user.name,
                            fullName: user.fullName,
                            key: user.key,
                            avatar: Confluence.getContextPath() + user.avatarUrl
                        }));
                    });
                    Confluence.Binder.userHover();

                    data.groups.forEach(function(group) {
                        recipientsContainer.append(HandyReminderUtils.recipientGroup({name: group}));
                    });
                }
            }
        });

        var sendTestMail = $(HandyReminderMacro.sendTestMail());
        $('#macro-param-div-active').after(sendTestMail);
        var mailMessageDiv = $('<div></div>');
        sendTestMail.after(mailMessageDiv);

        sendTestMail.click(function() {
            $.ajax({
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                type: 'POST',
                cache: false,
                async: false,
                url: Confluence.getContextPath() + '/rest/status-macro/1.0/reminder/test-mail',
                dataType: 'json',
                data: {
                    contentId: AJS.params.contentId ? AJS.params.contentId : undefined,
                    id: id,
                    text: descInput.val(),
                    title: $('#content-title').val(),
                    space: AJS.params.spaceKey
                },
                success: function() {
                    AJS.messages.info(mailMessageDiv, {
                        body: "Test reminder mail was sent to your email.",
                        closeable: true
                    });
                }
            });

            return false;
        });

        var timer = null;
        dateInput.add(lastDateInput).bind('input change', function() {
            if (timer) {
                clearTimeout(timer);
            }
            timer = setTimeout(function() {
                $('#macro-browser-preview-link').click();
            }, 330);
        });

        typeSelect.add(pauseInput).add(showDescInput).add(dayOfWeekInput).add(showDateInput).change(function() {
            $('#macro-browser-preview-link').click();
        });

        return params;
    };

    var instance = AnalyticsExtender.extend(new HandyReminderMacroJsOverride());

    AJS.MacroBrowser.setMacroJsOverride("handy-reminder", instance);

})(AJS.$,require('stiltsoft/handy-macros/analytics/client/extender'));

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/carousel-macro-browser.js' */
(function($, AnalyticsExtender) {

    var HandyCarouselMacroJsOverride = function() {
    };

    HandyCarouselMacroJsOverride.prototype.beforeParamsSet = function(params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        var ratioDiv = $('#macro-param-div-ratio');
        var itemsDiv = $('#macro-param-div-items');
        var presetSelect = $('#macro-param-preset');
        presetSelect.change(function() {
            if (presetSelect.val() === "Slider") {
                itemsDiv.fadeOut();
                ratioDiv.fadeOut();
            } else {
                itemsDiv.fadeIn();
                ratioDiv.fadeIn();
            }
        });

        if (params['preset'] === 'Slider') {
            itemsDiv.hide();
            ratioDiv.hide();
        }

        return params;
    };

    var instance = AnalyticsExtender.extend(new HandyCarouselMacroJsOverride());

    AJS.MacroBrowser.setMacroJsOverride("handy-carousel", instance);

})(AJS.$,require('stiltsoft/handy-macros/analytics/client/extender'));



}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/social-macro-browser.js' */
(function ($, AnalyticsExtender) {

    var SocialMacroJsOverride = function () {
    };

    SocialMacroJsOverride.prototype.beforeParamsSet = function (params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        var twitterParams = $('#macro-param-div-text, #macro-param-div-tags');

        var typeSelect = $('#macro-param-type');
        typeSelect.change(function () {
            if (typeSelect.val() === 'Twitter') {
                twitterParams.show();
            } else {
                twitterParams.hide();
            }
        });

        if (params.type !== 'Twitter') {
            twitterParams.hide();
        }

        if (!params.link) {
            params.link = AJS.params.baseUrl + "/pages/viewpage.action?pageId=" + AJS.params.contentId;
        }

        return params;
    };

    var instance = AnalyticsExtender.extend(new SocialMacroJsOverride());

    AJS.MacroBrowser.setMacroJsOverride("social-handy", instance);

})(AJS.$, require('stiltsoft/handy-macros/analytics/client/extender'));



}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/task-report-macro.js' */
(function($) {

    AJS.bind("init.rte", function() {

        function setUpTaskReport(jsOverride) {
            var beforeParamsSet = jsOverride.beforeParamsSet;

            jsOverride.beforeParamsSet = function (params) {
                var select = $('#macro-param-pageSize');
                var input = $('<input class="text macro-param-input" id="macro-param-pageSize">');
                select.after(input);
                input.val(params["pageSize"]);
                select.remove();

                if (typeof beforeParamsSet === "function") {
                    return beforeParamsSet(params);
                }
                return params;
            }
        }

        function checkTaskReportReady(i) {
            var jsOverride = AJS.MacroBrowser.Macros["tasks-report-macro"];
            if (jsOverride) {
                setUpTaskReport(jsOverride);
            } else if (i < 10) {
                setTimeout(function () {
                    checkTaskReportReady(++i);
                }, 500);
            }
        }

        checkTaskReportReady(0);
    });

})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/post-organizer-macro-browser.js' */
(function($, AnalyticsExtender) {

    const selects ={
        'type': {
            'child-pages': {
                title: "Child pages",
                hiddenParams: ['content-type', 'labels', 'space', 'limit', 'sort']
            },
            'search': {
                title: "Pages by labels",
                hiddenParams: []
            },
            'custom': {
                title: "Custom content",
                hiddenParams: ['content-type', 'labels', 'space', 'limit', 'sort', 'text-source', 'text-length', 'image-source', 'image-name']
            }
        },
        'content-type': {
            'all': {
                title: "Pages and blog posts",
                hiddenParams: []
            },
            'pages': {
                title: "Pages",
                hiddenParams: []
            },
            'blog-posts': {
                title: "Blog posts",
                hiddenParams: []
            }
        },
        'view': {
            'fixed': {
                title: "Fixed number of columns",
                hiddenParams: ['column-width']
            },
            'responsive': {
                title: "Fixed column width",
                hiddenParams: ['columns-number']
            }
        },
        'sort': {
            'date': {
                title: "Creation date",
                hiddenParams: []
            },
            'title': {
                title: "Title",
                hiddenParams: []
            }
        },
        'text-source': {
            'beginning': {
                title: "Top of the page",
                hiddenParams: []
            },
            'excerpt': {
                title: "The Excerpt macro",
                hiddenParams: ['text-length', 'image-source', 'image-name']
            }
        },
        'image-source': {
            'first': {
                title: "The first image",
                hiddenParams: ['image-name']
            },
            'name': {
                title: "Specific image on the page",
                hiddenParams: []
            },
            'none': {
                title: "No image",
                hiddenParams: ['image-name']
            },
        }
    };

    const MacroJsOverride = function () {
    };

    MacroJsOverride.prototype.beforeParamsSet = function(params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        $.each(selects, function (selectName) {
            const select = $('#macro-param-' + selectName);
            const selectOpts = selects[selectName];
            setSelectOptionNames(select, selectOpts);
            bindSelect(select, selectOpts, params, selectName);
        });

        initLabelsInput(params);

        return params;
    };

    function setSelectOptionNames(select, options) {
        select.find('option').each(function () {
            const option = $(this);
            const value = option.text().trim();
            option.attr('value', value);
            option.text(options[value].title);
        });
    }

    function bindSelect(select, options, params, selectName) {
        select.change(function() {
            const hiddenClass = 'hpo-hidden-' + selectName;
            $('.' + hiddenClass).removeClass(hiddenClass);
            const option = options[select.val()];
            if (option) {
                const ids = option.hiddenParams.map(function (type) {
                    return '#macro-param-div-' + type;
                });
                $(ids.join(',')).addClass(hiddenClass);
            }
        }).val(params[selectName] || Object.keys(options)[0]).trigger('change');
    }

    function initLabelsInput(params) {
        var labelsInput = $('#macro-param-labels');

        if (params && params.labels) {
            labelsInput.val(params.labels);
        }

        labelsInput.auiSelect2(Confluence.UI.Components.LabelPicker.build({
            separator : ",",
            queryOpts : {
                spaceKey : AJS.Meta.get('space-key')
            }
        }));
    }

    var instance = AnalyticsExtender.extend(new MacroJsOverride());

    AJS.MacroBrowser.setMacroJsOverride("handy-post-organizer", instance);

})(AJS.$,require('stiltsoft/handy-macros/analytics/client/extender'));




}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.handy.macros:handy-macro-browser-resource', location = 'js/macro-browser/post-organizer-content-macro-browser.js' */
(function($) {

    var MacroJsOverride = function() {
    };

    MacroJsOverride.prototype.beforeParamsSet = function(params) {
        $('#macro-browser-dialog .macro-desc .macro-doco-link').before("\u003cspan class=\u0022hmc-fr\u0022\u003ePost \u003ca href=\u0022https://stiltsoft.customercase.com/forums/handy-macros-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://stiltsoft.customercase.com/forums/support-requests/ideas/create?from=macro&category=Handy%2BMacros%2Bfor%2BConfluence\u0022\u003eIssue\u003c/a\u003e. \u003c/span\u003e");

        HandyButtonEditor.bindAutocompleteUrlInput($('#macro-param-link'));

        return params;
    };

    AJS.MacroBrowser.setMacroJsOverride("handy-post-organizer-content", new MacroJsOverride());

})(AJS.$);



}catch(e){WRMCB(e)};